import{_ as O}from"./B3bXavcp.js";import{r as p,B as y,C as T,D as z,o as M,c as H,b as e,w as t,F as P,z as R,E as W,G as L,x as v,A as h,H as b,I as Y,J as G,d as J,a as l,K}from"./CEcjV3pO.js";import{a as X}from"./BTq0eClo.js";import{_ as Z,V as q,a as Q}from"./CzZ78c4r.js";import{V as f,_ as D}from"./BmFevr56.js";import{_ as ee}from"./37abXc2X.js";import{_ as te}from"./L4ZI-Rra.js";import{V as d}from"./-hbS-8gM.js";import{V as ae}from"./CGewRB4S.js";import{V as oe}from"./DaSl91MG.js";import{V as C}from"./CHDcHAgM.js";const se=l("img",{src:Q},null,-1),le=l("img",{style:{cursor:"pointer"},src:D,alt:"Excluir"},null,-1),ie=[le],ne=l("img",{style:{cursor:"pointer"},src:ee,alt:"Salvar"},null,-1),re=[ne],ce=l("img",{class:"btn-pointer",src:te,alt:"Excluir"},null,-1),de=l("img",{class:"mt-15",src:D,alt:"Sair"},null,-1),ue={__name:"Testamento",setup(me){const n=p(null),g=p([]),u=p(""),m=p(!1),r=p(1),E=y("auth_token").value,I=y("user-data").value.nome,S=`${R().public.managemant}/uploadFaceId`,{$toast:V}=T(),k=async()=>{const a=await navigator.mediaDevices.enumerateDevices();g.value=a.filter(o=>o.kind==="videoinput").map(o=>({deviceId:o.deviceId,label:o.label||`Camera ${g.value.length+1}`}))},B=async()=>{m.value=!0;try{await navigator.mediaDevices.getUserMedia({video:!0}),await k()}catch(a){console.error("Erro ao acessar dispositivos de mídia:",a)}},w=()=>{m.value=!1;const a=n.value.srcObject;a&&a.getTracks().forEach(i=>i.stop())},N=async()=>{if(u.value){const a=await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:u.value}}});n.value.srcObject=a}},$=async()=>{const a=document.createElement("canvas"),o=a.getContext("2d"),i=n.value.videoWidth,s=n.value.videoHeight,c=i*r.value,x=s*r.value,j=(i-c)/2,A=(s-x)/2;a.width=i,a.height=s,o.drawImage(n.value,j,A,c,x),a.toBlob(async F=>{const _=new FormData;_.append("file",F,`${I}.jpg`),_.append("pessoa_token",E),_.append("bucket","cartorio-teste");const{status:U}=await X(S,{method:"POST",body:_},"$YOrtzEAAm0");U.value==="success"?(V.success("Imagem enviada!"),w()):V.error("Erro ao enviar imagem para o sistema.")},"image/jpeg")};return z(async()=>{try{await navigator.mediaDevices.getUserMedia({video:!0}),await k()}catch(a){console.error("Erro ao acessar dispositivos de mídia:",a)}}),(a,o)=>{const i=O;return M(),H(P,null,[e(f,{class:"d-flex align-items-center justify-space-between"},{default:t(()=>[e(d,{cols:"auto"},{default:t(()=>[e(W,{src:Z,width:500,class:"mr-4"})]),_:1}),e(L),e(d,{cols:"auto"},{default:t(()=>[e(ae,{"max-width":"700",modelValue:v(m),"onUpdate:modelValue":o[2]||(o[2]=s=>h(m)?m.value=s:null)},{activator:t(({props:s})=>[e(b,Y(s,{variant:"outlined",style:{width:"300px",height:"300px"},onClick:B}),{default:t(()=>[se]),_:2},1040)]),default:t(({isActive:s})=>[e(oe,{title:"Biometria"},{default:t(()=>[e(f,null,{default:t(()=>[e(d,null,{default:t(()=>[e(G,{items:v(g),modelValue:v(u),"onUpdate:modelValue":o[0]||(o[0]=c=>h(u)?u.value=c:null),"item-title":"label","item-value":"deviceId",label:"Selecionar Webcam"},null,8,["items","modelValue"])]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(d,null,{default:t(()=>[e(b,{onClick:N},{default:t(()=>[J("Exibir")]),_:1})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(C,{style:{overflow:"hidden"}},{default:t(()=>[e(d,null,{default:t(()=>[l("video",{class:"ml-3",ref_key:"video",ref:n,width:"640",height:"480",autoplay:"",style:K({transform:`scale(${v(r)})`,transformOrigin:"center center"})},null,4)]),_:1})]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(q,{modelValue:v(r),"onUpdate:modelValue":o[1]||(o[1]=c=>h(r)?r.value=c:null),min:1,max:3,step:"0.1",label:"Zoom"},null,8,["modelValue"])]),_:1}),e(f,{class:"mt-10 justify-space-around"},{default:t(()=>[l("div",{onClick:w},ie),l("div",{onClick:$},re)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[ce]),_:1})]),_:1}),e(i,{to:"/pessoas/registros"},{default:t(()=>[de]),_:1})],64)}}},Ee=ue;export{Ee as default};
