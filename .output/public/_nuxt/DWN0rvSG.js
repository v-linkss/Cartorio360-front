import{_ as se}from"./DpCeEJ0T.js";import{u as ee,B as te,G as oe,r as d,C as ie,o as M,E as re,w as t,b as e,v as o,V as Z,z as H,d as J,s as ae,m as X,H as ne,a as h,c as W,I as xe,L as Re,n as Fe,M as Ie,K as $e,F as ke,g as Ue,N as be,t as de}from"./D4w0Um61.js";import{V as P,u as y}from"./EzF2ViKA.js";import{V as O}from"./DchoNiw3.js";import{V as me}from"./BbQ_dt4-.js";import{V as ce}from"./B3M9qL7_.js";import{_ as Be,d as Ne}from"./AZy17BeW.js";import{_ as Le,a as Ge,b as He,T as Je,W as Ke,S as We,r as we,D as Ce,c as Ee,d as Xe,e as Ye}from"./Bks9_PI0.js";import{_ as pe}from"./ByLE7rcr.js";import{_ as le}from"./BVz1G1IN.js";import{_ as Qe,a as fe,b as _e}from"./DEa8RWDQ.js";import{V as ve}from"./B87Hb9QJ.js";import{V as Ve,a as ge}from"./sd7ddyXz.js";import{c as Ze,r as et,u as tt}from"./BJRXm3Gf.js";import{_ as he}from"./CdP3NN9a.js";const Ot={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(Y){const p=Y,{$toast:x}=ee(),f=ae(),b=te(),c=oe(),$=`${f.public.managemant}/updateAtos`,F=d(p.item_situacoes),C=ie({dt_abertura:p.item_dados[0].dt_abertura||null,status:p.item_dados[0].status||null,mne:p.item_dados[0].mne||null});async function B(){const{data:_,error:i,status:A}=await y(`${$}/${c.query.ato_id}`,{method:"PUT",body:{status:C.status,mne:C.mne,dt_abertura:C.dt_abertura}},"$EIT5jtTUdX");A.value==="success"&&x.success("Ato Atualizado com sucesso")}const z=()=>{const _=c.query.origem||"criar",i=c.query.id;_==="atualizar"?b.push(`/os/atualizar/${i}`):b.push("/os/criar-registro")};return(_,i)=>{const A=se;return M(),re(ce,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(O,{cols:"3"},{default:t(()=>[e(me,{label:"Situação",modelValue:o(C).status,"onUpdate:modelValue":i[0]||(i[0]=w=>o(C).status=w),items:o(F),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(O,{cols:"5"},{default:t(()=>[e(Z,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:o(C).mne,"onUpdate:modelValue":i[1]||(i[1]=w=>o(C).mne=w)},null,8,["modelValue"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(O,{cols:"2"},{default:t(()=>[e(Z,{modelValue:o(C).dt_abertura,"onUpdate:modelValue":i[2]||(i[2]=w=>o(C).dt_abertura=w),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(P,{class:"mb-3"},{default:t(()=>[e(A,{onClick:z},{default:t(()=>[e(H,{size:"large",color:"red"},{default:t(()=>i[3]||(i[3]=[J("Voltar")])),_:1})]),_:1}),e(H,{class:"ml-10",onClick:B,size:"large",color:"green"},{default:t(()=>i[4]||(i[4]=[J("Atualizar")])),_:1})]),_:1})]),_:1})}}},ot=["onClick"],at=["onClick"],st=["onClick"],rt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},nt={key:1,src:_e,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},lt=["onClick"],Mt={__name:"Partes",async setup(Y){let p,x;const f=te(),b=oe(),c=ae(),{$toast:$}=ee(),F=`${c.public.managemant}/pesquisarPessoas`,C=`${c.public.managemant}/listarPapeis`,B=`${c.public.managemant}/getLinkTipo`,z=`${c.public.managemant}/createAtosPessoa`,_=`${c.public.managemant}/updateAtosPessoa`,i=`${c.public.managemant}/getAtosPessoaById`,A=`${c.public.managemant}/download`,w=d(X("user-data").value.cartorio_token),V=d([]),D=d([]),q=d([]),I=d(!1),N=d(!1),m=d(!1),v=d(!1),L=d(null),s=d(null),r=d(null),T=d(null),a=d(null),l=d(b.query.tipo_ato_token),k=d(null),S=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],u=ie({papeis:null,nome:null,pessoa:null,documento:null}),{data:j}=([p,x]=ne(()=>y(C,{method:"POST",body:{tipo_ato_token:b.query.tipo_ato_token}},"$acoiTIUp00")),p=await p,x(),p);q.value=j.value;const R=async()=>{const{data:g}=await y(`${i}/${b.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),U=(Q=>Q.map(G=>({...G,pessoa:{...G.pessoa,documento:G.pessoa.doc_identificacao},papel:{...G.partes_tipos}})))(g.value);D.value=U};R();async function ye(){try{const{data:g,error:n}=await y(F,{method:"POST",body:{cartorio_token:w.value,documento:u.documento,nome:u.nome}},"$pr30MyPXfY");g.value.length>0?(V.value=g.value,u.pessoa=V.value[0]):V.value=[]}catch(g){console.error("Erro na requisição",g)}}const Pe=()=>{N.value=!0},Ae=async()=>{await R()},Te=async()=>{await R()},qe=async()=>{const g={pessoa:u.pessoa,papel:q.value.find(K=>K.id===u.papeis),representante:{nome:null}},n=await y(`${i}/${b.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const K of n.data.value)if(K.pessoa_id===u.pessoa.id&&K.ato_id===Number(b.query.ato_id)&&K.tipo_parte_id===u.papeis){$.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:U,error:Q,status:G}=await y(z,{method:"POST",body:{ato_id:Number(b.query.ato_id),pessoa_id:u.pessoa.id,tipo_parte_id:u.papeis,user_id:X("user-data").value.usuario_id}},"$18isAgOJxG");G.value==="success"?(g.id=U.value.id,$.success("Pessoa Registrada com Sucesso!"),D.value.push(g)):$.error(Q.value.message)},ze=async g=>{var K;if(m.value=!0,k.value=null,!g.pessoa.id)return;const{data:n}=await y(B,{method:"POST",body:{tipo:"ficha",id:g.pessoa.id}},"$hmDzSF3F61");if(!((K=n.value)!=null&&K.link))return;const{data:U}=await y(A,{method:"POST",body:{bucket:"qvgjz",path:n.value.link}},"$l09I6nLRfk"),Q=n.value.link,G=U.value;/\.(tr7|tiff)$/i.test(Q)?k.value=G:fotoRender.value=`data:image/jpeg;base64,${G}`},Oe=g=>{const n=D.value.filter(U=>U.pessoa.id!==g.pessoa.id).map(U=>({id:U.pessoa.id,nome:U.pessoa.nome}));r.value=g.id,L.value=n,I.value=!0,s.value=g.pessoa.nome,a.value=g.pessoa.id},Me=g=>{v.value=!0,T.value=g.id,s.value=g.pessoa.nome};async function De(g){g.excluido=!g.excluido;try{await y(`${_}/${g.id}`,{method:"PUT",body:JSON.stringify({excluido:g.excluido})},"$PUt0nEhmBF")}catch(n){console.error("Erro ao excluir pessoa:",n)}}const Se=()=>{const g=b.query.origem||"criar",n=b.query.id;g==="atualizar"?f.push(`/os/atualizar/${n}`):f.push("/os/criar-registro")};return(g,n)=>{const U=Be,Q=Ge,G=He,K=Ne,je=se;return M(),re(ce,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(O,{cols:"3"},{default:t(()=>[e(Z,{label:"Documento",modelValue:o(u).documento,"onUpdate:modelValue":n[0]||(n[0]=E=>o(u).documento=E)},null,8,["modelValue"])]),_:1}),e(O,{cols:"4"},{default:t(()=>[e(Z,{label:"Pessoa",modelValue:o(u).nome,"onUpdate:modelValue":n[1]||(n[1]=E=>o(u).nome=E)},null,8,["modelValue"])]),_:1}),h("div",null,[h("img",{class:"mt-1",src:pe,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:ye})]),h("div",null,[h("img",{class:"mt-1 ml-2",src:le,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Pe})])]),_:1}),e(P,null,{default:t(()=>[e(O,{cols:"4"},{default:t(()=>[e(me,{label:"Selecione a Pessoa",modelValue:o(u).pessoa,"onUpdate:modelValue":n[2]||(n[2]=E=>o(u).pessoa=E),items:o(V),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(O,{cols:"3"},{default:t(()=>[e(me,{label:"Papel",modelValue:o(u).papeis,"onUpdate:modelValue":n[3]||(n[3]=E=>o(u).papeis=E),items:o(q),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),h("div",null,[h("img",{class:"mt-1",src:le,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:qe})])]),_:1}),e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(ve,{style:{height:"465px"},headers:S,items:o(D)},{"item.actions":t(({item:E})=>[e(P,null,{default:t(()=>[h("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ue=>ze(E),title:"Visualizar Ficha"},n[9]||(n[9]=[h("img",{style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar"},null,-1)]),8,ot),h("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ue=>Me(E),class:"mr-2",title:"Alterar Papel"},n[10]||(n[10]=[h("img",{style:{width:"30px",height:"30px"},src:Qe,alt:"Visualizar"},null,-1)]),8,at),h("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ue=>De(E),title:"Deletar Pessoa"},[E.excluido?(M(),W("img",rt)):(M(),W("img",nt))],8,st),h("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ue=>Oe(E),title:"Selecionar Representante"},n[11]||(n[11]=[h("img",{style:{width:"30px",height:"30px"},src:Le,alt:"Visualizar"},null,-1)]),8,lt)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(U,{show:o(N),onClose:n[4]||(n[4]=E=>N.value=!1)},null,8,["show"]),e(Q,{representante_nome:o(s),representantes:o(L),ato_id:o(r),show:o(I),onClose:n[5]||(n[5]=E=>I.value=!1),onUpdateRepresentante:Te},null,8,["representante_nome","representantes","ato_id","show"]),e(G,{representante_nome:o(s),ato_token:o(l),ato_id:o(T),show:o(v),onClose:n[6]||(n[6]=E=>v.value=!1),onUpdatePapel:Ae},null,8,["representante_nome","ato_token","ato_id","show"]),e(Ve,{modelValue:o(m),"onUpdate:modelValue":n[8]||(n[8]=E=>xe(m)?m.value=E:null),width:"600"},{default:t(()=>[e(ge,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(K,{"tiff-url":o(k)},null,8,["tiff-url"]),e(H,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:n[7]||(n[7]=E=>m.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(P,null,{default:t(()=>[e(je,{onClick:Se},{default:t(()=>[e(H,{size:"large",color:"red"},{default:t(()=>n[12]||(n[12]=[J("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},it={key:0,class:"loading-overlay"},ct="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Dt={__name:"Minuta",emits:["page","doc"],setup(Y,{emit:p}){Re("DocumentEditorContainer",[Je,Ke,We]);const x=ae(),{$toast:f}=ee(),b=te(),c=oe(),$=p;we(`${x.public.docEditor}`);const F=`${x.public.managemant}/download`,C=`${x.public.managemant}/atos/files`,B=`${x.public.managemant}/subitituirModelo`,z=`${x.public.managemant}/upload`,_=d(null),i=d(!1),A=d("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),w=d(!1),V=async a=>{try{const l=await fetch(a);if(!l.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await l.blob()}catch(l){return console.error(l),f.error("Erro ao carregar o documento inicial."),null}},D=async()=>{try{const{data:a}=await y(`${C}/${c.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return a.value.link_ato}catch(a){console.error("Erro ao carregar o documento:",a),f.error(a)}},q=async()=>{w.value=!0;try{const a=await D(),{data:l,status:k}=await y(F,{method:"POST",body:{bucket:"qvgjz",path:a}},"$dvNFfvmIJC"),S=l.value,u=await V(S);if(u){const j=new FileReader;j.onload=()=>{const R=j.result;_.value.ej2Instances.documentEditor.open(R),$("doc",R)},j.readAsText(u)}}catch{f.error("Erro ao carregar o documento.")}finally{w.value=!1}},I=async()=>{const l=await _.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),k=new FileReader;k.onload=()=>{const S=k.result,j=_.value.ej2Instances.documentEditor.pageCount;$("page",j),$("doc",S)},k.readAsText(l)},N=async()=>{w.value=!0;try{const l=await _.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),k=new FormData;k.append("file",l,"anexo.sfdt"),k.append("cartorio_token",X("user-data").value.cartorio_token),k.append("token",c.query.ato_token_edit),k.append("tipo","ato_minuta");const{data:S,status:u}=await y(z,{method:"POST",body:k},"$xv11VtUdMy");if(u.value==="success"){f.success("Documento enviado!");const R=_.value.ej2Instances.documentEditor.pageCount;I(),$("page",R)}else f.error("Erro ao enviar documento para o sistema.")}catch(a){f.error("Erro ao salvar documento."),console.error(a)}finally{w.value=!1}},m=()=>{i.value=!1,v()},v=async()=>{r(!0);try{await L(),r(!0);const{data:a,status:l}=await y(B,{method:"POST",body:{ato_token:c.query.ato_token_edit}},"$zyzWHTXTBW");a.value&&s(a.value)}catch(a){console.error("Erro ao gerar a minuta:",a),f.error("Ocorreu um erro ao gerar a minuta.")}finally{r(!1)}},L=async()=>{try{const{data:a}=await y(F,{method:"POST",body:{bucket:"qvgjz",path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),l=await V(a.value);if(l){const k=new FileReader;k.onload=()=>{const S=k.result;_.value.ej2Instances.documentEditor.open(S),$("doc",S)},k.readAsText(l)}}catch(a){console.error("Erro ao carregar o modelo de minuta:",a),f.error("Falha ao carregar o modelo de minuta.")}},s=a=>{const l=_.value.ej2Instances.documentEditor,k=S=>{for(const[u,j]of Object.entries(S))if(/^<<.+>>$/.test(u))try{l.search.findAll(u),l.search.searchResults.length>0&&l.search.searchResults.replaceAll(j)}catch(R){console.error(`Erro ao substituir o marcador ${u}:`,R)}else if(u==="partes"&&Array.isArray(j)&&j.length>0)for(const R of j)typeof R=="object"&&k(R)};k(a)},r=a=>{w.value=a},T=()=>{const a=c.query.origem||"criar",l=c.query.id;a==="atualizar"?b.push(`/os/atualizar/${l}`):b.push("/os/criar-registro")};return Fe(async()=>{await q(),I()}),(a,l)=>{const k=se,S=Ee;return M(),W(ke,null,[e(o(Ce),{height:"900px",ref_key:"documentEditorContainer",ref:_,serviceUrl:ct,enableToolbar:!0,enableWordExport:!0},null,512),o(w)?(M(),W("div",it,[e(Ie,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):$e("",!0),e(P,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e(k,{class:"mr-4"},{default:t(()=>[e(H,{size:"large",onClick:T,color:"red"},{default:t(()=>l[2]||(l[2]=[J("Voltar")])),_:1})]),_:1}),e(H,{size:"large",color:"green",onClick:N,disabled:o(w)},{default:t(()=>l[3]||(l[3]=[J("Atualizar")])),_:1},8,["disabled"]),e(H,{class:"ml-4",size:"large",color:"blue",onClick:l[0]||(l[0]=u=>i.value=!0)},{default:t(()=>l[4]||(l[4]=[J("Gerar Minuta")])),_:1})]),_:1}),e(S,{onConfirm:m,condMessage:o(A),show:o(i),onClose:l[1]||(l[1]=u=>i.value=!1)},null,8,["condMessage","show"])],64)}}},ut=["innerHTML"],St={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},setup(Y){const p=Y,x=ae();we(`${x.public.docEditor}`);const{$toast:f}=ee(),b=te(),c=oe(),$=`${x.public.managemant}/download`,F=`${x.public.managemant}/atos/files`,C=`${x.public.managemant}/lavrarAto`,B=d("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),z=d(!1),_=d(null),i=d(null),A=d(null),w=async m=>{try{const v=await fetch(m);if(!v.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await v.blob()}catch(v){return console.error(v),f.error("Erro ao carregar o documento inicial."),null}},V=async()=>{try{const{data:m}=await y(`${F}/${c.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return m.value.link_ato}catch(m){console.error("Erro ao carregar o documento:",m),f.error(m)}},D=async()=>{try{const m=await V(),{data:v,status:L}=await y($,{method:"POST",body:{bucket:"qvgjz",path:m}},"$7ljqltMqa0"),s=v.value,r=await w(s);if(r){const T=new FileReader;T.onload=()=>{const a=T.result;A.value.ej2Instances.documentEditor.open(a)},T.readAsText(r)}}catch{f.error("Erro ao carregar o documento.")}};D();const q=async()=>{try{const{data:m,status:v}=await y(C,{method:"POST",body:{ato_token:c.query.ato_token_edit,qtd_paginas:p.pages}},"$OWxZSQkyX8");v.value==="success"?(_.value=m.value,i.value=m.value[0].selo,f.success("Ato lavrado com sucesso!")):f.error("Falha ao lavrar o ato.")}catch{f.error("Erro ao conectar com o servidor.")}},I=()=>{z.value=!1,q()},N=()=>{const m=c.query.origem||"criar",v=c.query.id;m==="atualizar"?b.push(`/os/atualizar/${v}`):b.push("/os/criar-registro")};return Ue(()=>p.document,(m,v)=>{D()}),(m,v)=>{const L=Ee;return M(),W(ke,null,[e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(o(Ce),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:A,height:"850px",width:"850px"},null,512)]),_:1}),e(O,null,{default:t(()=>[h("img",{onClick:v[0]||(v[0]=s=>z.value=!0),style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Xe}),o(_)?(M(),re(ge,{key:0,width:"360px",class:"mr-16"},{default:t(()=>[e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(be,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[J(" Livro: "+de(o(_)[0].livro_numero),1)]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(be,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[J(" Folhas : "+de(o(_)[0].pagina_inicial)+" Á "+de(o(_)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),h("div",{style:{border:"1px solid black","border-radius":"8px","padding-bottom":"20px","margin-top":"-10px"},class:"ml-2 mb-2 mr-2",innerHTML:o(i)},null,8,ut)]),_:1})):$e("",!0)]),_:1})]),_:1}),e(H,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:N},{default:t(()=>v[2]||(v[2]=[J("Voltar")])),_:1}),e(L,{show:o(z),condMessage:o(B),onClose:v[1]||(v[1]=s=>z.value=!1),onConfirm:I},null,8,["show","condMessage"])],64)}}},dt=["onClick"],mt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},pt={key:1,src:_e,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},jt={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(Y){let p,x;const f=te(),b=oe(),c=ae(),{$toast:$}=ee(),F=`${c.public.managemant}/listarEscrevente`;`${c.public.managemant}`;const C=`${c.public.managemant}/createAtosObservacao`,B=`${c.public.managemant}/updateAtosObservacao`,z=`${c.public.managemant}/getAtosObservacaoById`,_=d(X("user-data").value.cartorio_token),i=d([]),A=d([]),w=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],V=ie({observacao:""}),D={observacao:{required:Ze.withMessage("O campo é obrigatório",et)}},q=tt(D,V),{data:I}=([p,x]=ne(()=>y(`${z}/${b.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),p=await p,x(),p);i.value=I.value.map(s=>({...s,created:he(s.created,"dd/mm/yyyy hh:mm")}));async function N(){if(V.observacao.trim()===""){$.error("O campo de observação está vazio.");return}if(await q.value.$validate()){const{data:s,error:r,status:T}=await y(C,{method:"POST",body:{ato_id:b.query.ato_id,observacao:V.observacao,user_id:X("user-data").value.usuario_id}},"$gnHMo4uCXD");T.value==="success"&&(i.value.push({created:he(s.value.created,"dd/mm/yyyy hh:mm"),observacao:s.value.observacao,id:s.value.id,escrevente:X("user-data").value.nome}),V.observacao="",$.success("Observação registrada com sucesso"))}else $.error("Preencha os campos obrigatórios.")}async function m(s){s.excluido=!s.excluido;try{await y(`${B}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$sP9AKdd3Ky")}catch(r){console.error("Erro ao excluir observação:",r)}}const{data:v}=([p,x]=ne(()=>y(F,{method:"POST",body:{cartorio_token:_}},"$HL9pndqGh0")),p=await p,x(),p);A.value=v.value[0].func_json_escreventes;const L=()=>{const s=b.query.origem||"criar",r=b.query.id;s==="atualizar"?f.push(`/os/atualizar/${r}`):f.push("/os/criar-registro")};return(s,r)=>{const T=se;return M(),re(ce,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(Z,{label:"Observação",modelValue:V.observacao,"onUpdate:modelValue":r[0]||(r[0]=a=>V.observacao=a),required:"","error-messages":o(q).observacao.$errors.length>0?o(q).observacao.$errors.map(a=>a.$message):[],onBlur:o(q).observacao.$touch,onInput:o(q).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),h("div",null,[h("img",{class:"btn-pointer ml-2",src:le,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:N})])]),_:1}),e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(ve,{style:{height:"465px"},headers:w,items:i.value},{"item.actions":t(({item:a})=>[h("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:l=>m(a),title:"Deletar Observação"},[a.excluido?(M(),W("img",mt)):(M(),W("img",pt))],8,dt)]),_:1},8,["items"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(T,{onClick:L},{default:t(()=>[e(H,{size:"large",color:"red"},{default:t(()=>r[1]||(r[1]=[J("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},ft=["onClick"],_t=["onClick"],vt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},gt={key:1,src:_e,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Rt={__name:"Anexos",async setup(Y){let p,x;const f=ae(),{$toast:b}=ee(),c=te(),$=oe(),F=`${f.public.biometria}/run-scanner`,C=`${f.public.managemant}/atos_anexos`,B=`${f.public.managemant}/atos_anexos`,z=`${f.public.managemant}/atos_anexos`,_=d(!1),i=d([]),A=ie({descricao:""}),w=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:V}=([p,x]=ne(()=>y(`${z}/${$.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),p=await p,x(),p);i.value=V.value;async function D(){try{await q(),await I()}catch(s){console.error("Erro ao executar scanner ou listar arquivos:",s)}}async function q(){try{const{data:s}=await y(F,{method:"GET"},"$KttjFhHivJ")}catch(s){b.error("Erro ao acionar o scanner:",s)}}async function I(){try{const{data:s,status:r}=await y("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:$.query.ato_token_edit,cartorio_token:X("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(s){console.error("Erro ao enviar o arquivo:",s)}}const N=async()=>{_.value=!0},m=async()=>{const{data:s,error:r,status:T}=await y(C,{method:"POST",body:{ato_id:$.query.ato_id,descricao:A.descricao,user_id:X("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");T.value==="success"&&(b.success("Anexo registrado com sucesso!"),i.value.push(s.value))};async function v(s){s.excluido=!s.excluido;try{await y(`${B}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$cdoFBGO0Ti")}catch(r){console.error("Erro ao excluir pessoa:",r)}}const L=()=>{const s=$.query.origem||"criar",r=$.query.id;s==="atualizar"?c.push(`/os/atualizar/${r}`):c.push("/os/criar-registro")};return(s,r)=>{const T=se;return M(),re(ce,null,{default:t(()=>[e(P,null,{default:t(()=>[e(O,{cols:"5"},{default:t(()=>[e(Z,{modelValue:o(A).descricao,"onUpdate:modelValue":r[0]||(r[0]=a=>o(A).descricao=a),label:"Descrição"},null,8,["modelValue"])]),_:1}),h("div",{onClick:D,title:"Escanear"},r[3]||(r[3]=[h("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ye,alt:"Escanear"},null,-1)])),h("div",{onClick:m,title:"Criar"},r[4]||(r[4]=[h("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:le,alt:"Criar"},null,-1)]))]),_:1}),e(ve,{headers:w,items:o(i),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:a})=>[e(P,null,{default:t(()=>[h("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:l=>N(a),title:"Visualizar Anexo"},r[5]||(r[5]=[h("img",{style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar"},null,-1)]),8,ft),h("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:l=>v(a),title:"Deletar Pessoa"},[a.excluido?(M(),W("img",vt)):(M(),W("img",gt))],8,_t)]),_:2},1024)]),_:1},8,["items"]),e(Ve,{modelValue:o(_),"onUpdate:modelValue":r[2]||(r[2]=a=>xe(_)?_.value=a:null),width:"600"},{default:t(()=>[e(ge,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(H,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:r[1]||(r[1]=a=>_.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(T,{onClick:L},{default:t(()=>[e(H,{size:"large",color:"red"},{default:t(()=>r[6]||(r[6]=[J("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Ot as _,Mt as a,Dt as b,St as c,jt as d,Rt as e};
