import{V as fe,c as Te}from"./Df1JnvoM.js";import{V as ue}from"./B1QlpduE.js";import{a as xe,V as ie}from"./CsvDmfyO.js";import{V as ge}from"./CNAhoa1f.js";import{J as be,u as Ve,r as m,f as ae,g as re,v as ne,H as ve,h as we,j as o,o as y,c as D,b as e,O as Ie,k as N,w as t,V as h,a as M,t as Pe,l as Q,x as W,d as q,m as $e,i as Oe,p as qe,B as de}from"./3hSeR7tm.js";import{_ as ye}from"./CPMUJqZZ.js";import{_ as ke}from"./C5yULtSW.js";import{_ as Be}from"./CDjUwj-E.js";import{c as A,r as R,u as Ue}from"./CdIX132f.js";import{u as S}from"./CD8enlbm.js";import{V as O}from"./O1FZJCZ9.js";import{V as f}from"./wLA6tcdh.js";import{V as ze}from"./BwBDuhcD.js";import{V as Z}from"./DEaNoEbY.js";import{d as Ee}from"./DlNhTTzP.js";import{_ as he}from"./BVz1G1IN.js";import{_ as Ne}from"./W_mG0VC8.js";import{_ as je}from"./QK6l60P8.js";import{_ as Ae,a as De}from"./DJvq3mCv.js";import{V as Le}from"./BpunZM1E.js";const Re={key:0,class:"d-flex justify-center"},Fe={key:0,class:"text-error text-caption mt-1"},Ce={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(E,{emit:j}){let n,_;const v=E,w=j,U=be(),u=$e(),{$toast:I}=Ve(),{id:$}=U.params,k=`${u.public.managemant}/atos_bens`,B=`${u.public.managemant}/atos_bens`,T=`${u.public.managemant}/atos_bens`,V=`${u.public.managemant}/registro_imoveis`,F=`${u.public.managemant}/natureza_imoveis`,H=`${u.public.managemant}/tipo_logradouros`,x=`${u.public.managemant}/situacao_imoveis`,b=`${u.public.managemant}/listarCidades`,z=`${u.public.managemant}/listarTipoBens`,P=m(ae("user-data").value.cartorio_token),G=m(ae("user-data").value.usuario_id).value,X=m([]),K=m([]),me=m([]),ee=m([]),te=m([]),C=m([]),Y=m(!0),r=re({tabvalores_tipo_regimovel_id:null,registro_cartorio:null,registro_matricula:null,matricula_letra:null,tabvalores_nat_imovel_id:null,cib:null,tabvalores_tipologradouro_id:null,tipo_id:null,descricao:null,inscricao_estadual:null,tabvalores_situacao_imoveis_id:null,vlr_avaliacao:null,vlr_mercado:null,valor_mercado:"0.00",aliq_itbi:null,vlr_itbi:null,user_id:G,ato_id:Number(U.query.ato_id)||Number(v.ato_id)}),le=re({...r}),J={descricao:{required:A.withMessage("O campo é obrigatório",R)},tipo_id:{required:A.withMessage("O campo é obrigatório",R)},registro_matricula:{required:A.withMessage("O campo é obrigatório",R)},inscricao_estadual:{required:A.withMessage("O campo é obrigatório",R)},vlr_avaliacao:{required:A.withMessage("O campo é obrigatório",R),notZero:A.withMessage("O valor não pode ser zero",c=>!!c&&Number(c.toString().replace(/,/g,""))>0)}},d=Ue(J,r),se=async()=>{var g,s,i,oe;if(!await d.value.$validate()){I.error("Preencha todos os campos obrigatórios!");return}const a={...r,vlr_avaliacao:(g=r.vlr_avaliacao)==null?void 0:g.replace(/,/g,""),vlr_mercado:(s=r.vlr_mercado)==null?void 0:s.replace(/,/g,""),aliq_itbi:(i=r.aliq_itbi)==null?void 0:i.replace(/,/g,""),vlr_itbi:(oe=r.vlr_itbi)==null?void 0:oe.replace(/,/g,"")},{data:p,status:l}=await S(`${k}`,{method:"POST",body:a},"$0Mdv6RF9cH");l.value==="success"&&(I.success("Imovel criado com sucesso!"),w("saved",{id:p.value.id,token:p.value.token,ato_id:p.value.ato_id}))},{data:ce}=([n,_]=ne(()=>S(`${z}`,{method:"POST",body:{cartorio_token:P.value,imoveis:!0}},"$H1S2cTYpdB")),n=await n,_(),n);if(C.value=ce.value,v.isUpdate===!0){const{data:c}=([n,_]=ne(()=>S(`${B}/${v.imovel_id}`,{method:"GET"},"$jHrIlABk8l")),n=await n,_(),n);c.value&&Object.keys(r).forEach(a=>{c.value[a]!==void 0&&(r[a]=c.value[a])}),Object.assign(le,r)}async function L(){try{const[c,a,p,l,g]=await Promise.all([$fetch(F),$fetch(V),$fetch(x),$fetch(H),$fetch(b)]);K.value=c,X.value=a,te.value=p,me.value=l,ee.value=g}catch(c){console.error("Erro ao carregar os dados de imoveis pessoa:",c)}finally{Y.value=!1}}const pe=async c=>{const a={};if(Object.keys(r).forEach(l=>{r[l]!==le[l]&&(a[l]=r[l])}),["vlr_avaliacao","vlr_mercado","aliq_itbi","vlr_itbi"].forEach(l=>{var g;a[l]&&(a[l]=(g=a[l])==null?void 0:g.toString().replace(/,/g,""))}),Object.keys(a).length===0)return;const{status:p}=await S(`${T}/${c}`,{method:"PUT",body:a},"$BZjXR26AL9");p.value==="success"&&(I.success("Imovel Atualizado com sucesso!"),w("close-modal"))},_e=()=>{w("close-modal"),w("refresh-list")};return ve([()=>r.vlr_avaliacao?r.vlr_avaliacao.replace(/,/g,""):"0",()=>r.aliq_itbi?r.aliq_itbi.replace(/,/g,""):"0"],([c,a])=>{r.vlr_itbi=(Number(c)*Number(a)/100).toFixed(2)}),we(()=>{$||v.ato_id?L():Y.value=!1}),(c,a)=>{const p=ye,l=ke,g=Be;return o(Y)?(y(),D("div",Re,[e(Ie,{indeterminate:"",class:"loading-spinner",size:"64"})])):(y(),N(ue,{key:1},{default:t(()=>[e(O,null,{default:t(()=>[e(f,{class:"mt-2",cols:"12"},{default:t(()=>[e(ze,{label:"Descrição",modelValue:o(r).descricao,"onUpdate:modelValue":a[0]||(a[0]=s=>o(r).descricao=s),"error-messages":o(d).descricao.$errors.map(s=>s.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(f,{cols:"3"},{default:t(()=>[e(Z,{label:"Tipo de Registro",modelValue:o(r).tabvalores_tipo_regimovel_id,"onUpdate:modelValue":a[1]||(a[1]=s=>o(r).tabvalores_tipo_regimovel_id=s),items:o(X),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[e(h,{label:"Cartório",modelValue:o(r).registro_cartorio,"onUpdate:modelValue":a[2]||(a[2]=s=>o(r).registro_cartorio=s)},null,8,["modelValue"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[e(h,{label:"Matricula",modelValue:o(r).registro_matricula,"onUpdate:modelValue":a[3]||(a[3]=s=>o(r).registro_matricula=s),"error-messages":o(d).registro_matricula.$errors.map(s=>s.$message)},null,8,["modelValue","error-messages"])]),_:1}),e(f,null,{default:t(()=>[e(h,{label:"Letra",modelValue:o(r).matricula_letra,"onUpdate:modelValue":a[4]||(a[4]=s=>o(r).matricula_letra=s)},null,8,["modelValue"])]),_:1}),e(f,{cols:"4"},{default:t(()=>[e(Z,{label:"Natureza",modelValue:o(r).tabvalores_nat_imovel_id,"onUpdate:modelValue":a[5]||(a[5]=s=>o(r).tabvalores_nat_imovel_id=s),items:o(K),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(f,{cols:"2"},{default:t(()=>[e(h,{label:"CIB",modelValue:o(r).cib,"onUpdate:modelValue":a[6]||(a[6]=s=>o(r).cib=s)},null,8,["modelValue"])]),_:1}),e(f,{cols:"3"},{default:t(()=>[e(Z,{modelValue:o(r).tipo_id,"onUpdate:modelValue":a[7]||(a[7]=s=>o(r).tipo_id=s),items:o(C),label:"Tipo de imovel","item-title":"descricao","item-value":"id","error-messages":o(d).tipo_id.$errors.map(s=>s.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(f,{cols:"3"},{default:t(()=>[e(h,{label:"Inscrição Municipal",modelValue:o(r).inscricao_estadual,"onUpdate:modelValue":a[8]||(a[8]=s=>o(r).inscricao_estadual=s),"error-messages":o(d).inscricao_estadual.$errors.map(s=>s.$message)},null,8,["modelValue","error-messages"])]),_:1}),e(f,{cols:"4"},{default:t(()=>[e(Z,{label:"Situação",items:o(te),"item-title":"descricao","item-value":"id",modelValue:o(r).tabvalores_situacao_imoveis_id,"onUpdate:modelValue":a[9]||(a[9]=s=>o(r).tabvalores_situacao_imoveis_id=s)},null,8,["items","modelValue"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(f,{cols:"2"},{default:t(()=>{var s;return[a[15]||(a[15]=M("label",null,"Valor Avaliação",-1)),e(p,{label:"Valor Avaliação",modelValue:o(r).vlr_avaliacao,"onUpdate:modelValue":a[10]||(a[10]=i=>o(r).vlr_avaliacao=i)},null,8,["modelValue"]),o(d).vlr_avaliacao.$error?(y(),D("div",Fe,Pe((s=o(d).vlr_avaliacao.$errors[0])==null?void 0:s.$message),1)):Q("",!0)]}),_:1}),e(f,{cols:"2"},{default:t(()=>[a[16]||(a[16]=M("label",null,"Valor Mercado",-1)),e(p,{label:"Valor Mercado",modelValue:o(r).vlr_mercado,"onUpdate:modelValue":a[11]||(a[11]=s=>o(r).vlr_mercado=s)},null,8,["modelValue"])]),_:1}),e(f,{cols:"1"},{default:t(()=>[a[17]||(a[17]=M("label",null,"%ITB",-1)),e(p,{label:"%ITB",modelValue:o(r).aliq_itbi,"onUpdate:modelValue":a[12]||(a[12]=s=>o(r).aliq_itbi=s)},null,8,["modelValue"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[a[18]||(a[18]=M("label",null,"Valor ITB",-1)),e(p,{label:"Valor ITB",modelValue:o(r).vlr_itbi,"onUpdate:modelValue":a[13]||(a[13]=s=>o(r).vlr_itbi=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(O,{class:"mt-10"},{default:t(()=>[e(l,{onClick:_e},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>a[19]||(a[19]=[q("Voltar")])),_:1})]),_:1}),E.isUpdate?(y(),N(W,{key:0,class:"ml-5",size:"large",color:"green",onClick:a[14]||(a[14]=s=>pe(v.imovel_id))},{default:t(()=>a[20]||(a[20]=[q("Atualizar")])),_:1})):(y(),N(g,{key:1,class:"ml-5",onSave:se},{default:t(()=>a[21]||(a[21]=[q(" Salvar ")])),_:1}))]),_:1})]),_:1}))}}},He={key:0,class:"d-flex justify-center"},Me={__name:"Enderecos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(E,{emit:j}){let n,_;const v=E,w=j,U=be(),u=$e(),{$toast:I}=Ve(),{id:$}=U.params,k=`${u.public.managemant}/atos_bens`,B=`${u.public.managemant}/atos_bens`,T=`${u.public.managemant}/registro_imoveis`,V=`${u.public.managemant}/natureza_imoveis`,F=`${u.public.managemant}/tipo_logradouros`,H=`${u.public.managemant}/situacao_imoveis`,x=`${u.public.auth}/service/gerencia/cep`,b=`${u.public.managemant}/listarCidades`,z=`${u.public.managemant}/listarTipoBens`,P=m(ae("user-data").value.cartorio_token),G=m(ae("user-data").value.usuario_id).value,K=ae("auth_token").value,me=m(!1),ee=m([]),te=m([]),C=m([]),Y=m([]),r=m([]),le=m([]),J=m(!0),d=re({end_cidade_id:null,end_quadra:null,end_lote:null,tabvalores_tipologradouro_id:null,end_logradouro:null,end_logradouro_numero:null,end_bairro:null,end_cep:null,end_complemento:null,user_id:G,ato_id:Number(U.query.ato_id)||Number(v.ato_id)}),se=re({...d}),ce={end_logradouro_numero:{required:A.withMessage("",R)},end_cep:{required:A.withMessage("O campo é obrigatório",R)},end_bairro:{required:A.withMessage("O campo é obrigatório",R)},end_cidade_id:{required:A.withMessage("O campo é obrigatório",R)},tabvalores_tipologradouro_id:{required:A.withMessage("O campo é obrigatório",R)}},L=Ue(ce,d),{data:pe}=([n,_]=ne(()=>S(`${z}`,{method:"POST",body:{cartorio_token:P.value,imoveis:!0}},"$W62VZQp5Tx")),n=await n,_(),n);if(le.value=pe.value,v.isUpdate===!0){const{data:p}=([n,_]=ne(()=>S(`${k}/${v.imovel_id}`,{method:"GET"},"$uGMUgsxHFk")),n=await n,_(),n);p.value&&Object.keys(d).forEach(l=>{p.value[l]!==void 0&&(d[l]=p.value[l])}),Object.assign(se,d)}async function _e(){try{const[p,l,g,s,i]=await Promise.all([$fetch(V),$fetch(T),$fetch(H),$fetch(F),$fetch(b)]);te.value=p,ee.value=l,r.value=g,C.value=s,Y.value=i}catch(p){console.error("Erro ao carregar os dados de imoveis pessoa:",p)}finally{J.value=!1}}const c=async p=>{if(me.value=!0,!v.isUpdate&&!await L.value.$validate()){I.error("Preencha todos os campos obrigatórios!");return}const l={};if(Object.keys(d).forEach(s=>{d[s]!==se[s]&&(l[s]=d[s])}),Object.keys(l).length===0)return;const{status:g}=await S(`${B}/${p}`,{method:"PUT",body:l},"$JWP9Pf1MfJ");g.value==="success"&&I.success("Imovel Atualizado com sucesso!")},a=()=>{w("close-modal"),w("refresh-list")};return ve(()=>d.end_cep,async p=>{if(p&&p.length===8)try{const{data:l,error:g}=await S(`${x}/${p}`,{headers:{Authorization:K}},"$b99zbpjYFS");if(g.value){console.error("Erro ao buscar CEP:",g.value),I.error("Erro ao buscar CEP no servidor.");return}if(l.value.logradouro&&l.value.bairro&&l.value.localidade&&l.value.uf){d.end_logradouro=l.value.logradouro,d.end_bairro=l.value.bairro,d.end_complemento=l.value.complemento;let s=`${l.value.localidade}/${l.value.uf}`.toUpperCase();const i=Y.value.find(oe=>oe.descricao===s);i?d.end_cidade_id=i.id:I.error("Cidade não encontrada na lista!")}else I.error("CEP não retornou dados válidos!")}catch(l){console.error("Erro inesperado:",l),I.error("Erro inesperado. Verifique sua conexão.")}}),we(()=>{$||v.ato_id||v.imovel_id?_e():J.value=!1}),(p,l)=>{const g=ke,s=Oe("mask");return o(J)?(y(),D("div",He,[e(Ie,{indeterminate:"",class:"loading-spinner",size:"64"})])):(y(),N(ue,{key:1,style:{height:"500px"},class:"mt-2"},{default:t(()=>[e(O,null,{default:t(()=>[e(f,{cols:"2"},{default:t(()=>[qe(e(h,{label:"CEP",modelValue:o(d).end_cep,"onUpdate:modelValue":l[0]||(l[0]=i=>o(d).end_cep=i),modelModifiers:{trim:!0},"error-messages":o(L).end_cep.$errors.map(i=>i.$message)},null,8,["modelValue","error-messages"]),[[s,"########"]])]),_:1}),e(f,{cols:"5"},{default:t(()=>[e(Z,{label:"Cidade",modelValue:o(d).end_cidade_id,"onUpdate:modelValue":l[1]||(l[1]=i=>o(d).end_cidade_id=i),items:o(Y),"item-title":"descricao","item-value":"id","error-messages":o(L).end_cidade_id.$errors.map(i=>i.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[e(h,{label:"Quadra",modelValue:o(d).end_quadra,"onUpdate:modelValue":l[2]||(l[2]=i=>o(d).end_quadra=i)},null,8,["modelValue"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[e(h,{label:"Lote",modelValue:o(d).end_lote,"onUpdate:modelValue":l[3]||(l[3]=i=>o(d).end_lote=i)},null,8,["modelValue"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(f,{cols:"4"},{default:t(()=>[e(Z,{label:"Tipo de Logradouro",modelValue:o(d).tabvalores_tipologradouro_id,"onUpdate:modelValue":l[4]||(l[4]=i=>o(d).tabvalores_tipologradouro_id=i),items:o(C),"item-title":"descricao","item-value":"id","error-messages":o(L).tabvalores_tipologradouro_id.$errors.map(i=>i.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(f,{cols:"6"},{default:t(()=>[e(h,{label:"Logradouro",modelValue:o(d).end_logradouro,"onUpdate:modelValue":l[5]||(l[5]=i=>o(d).end_logradouro=i)},null,8,["modelValue"])]),_:1}),e(f,{cols:"1"},{default:t(()=>[e(h,{label:"N*",modelValue:o(d).end_logradouro_numero,"onUpdate:modelValue":l[6]||(l[6]=i=>o(d).end_logradouro_numero=i),"error-messages":o(L).end_logradouro_numero.$errors.map(i=>i.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(f,{cols:"6"},{default:t(()=>[e(h,{label:"Bairro",modelValue:o(d).end_bairro,"onUpdate:modelValue":l[7]||(l[7]=i=>o(d).end_bairro=i),"error-messages":o(L).end_bairro.$errors.map(i=>i.$message)},null,8,["modelValue","error-messages"])]),_:1}),e(f,{cols:"5"},{default:t(()=>[e(h,{label:"Complemento",modelValue:o(d).end_complemento,"onUpdate:modelValue":l[8]||(l[8]=i=>o(d).end_complemento=i)},null,8,["modelValue"])]),_:1})]),_:1}),e(O,{class:"mt-10 justify-start"},{default:t(()=>[e(g,{onClick:a},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>l[11]||(l[11]=[q("Voltar")])),_:1})]),_:1}),E.isUpdate?(y(),N(W,{key:0,class:"ml-5",size:"large",color:"green",onClick:l[9]||(l[9]=i=>c(v.imovel_id))},{default:t(()=>l[12]||(l[12]=[q("Atualizar")])),_:1})):(y(),N(W,{key:1,class:"ml-5",size:"large",color:"green",onClick:l[10]||(l[10]=i=>c(v.imovel_id))},{default:t(()=>l[13]||(l[13]=[q("Salvar")])),_:1}))]),_:1})]),_:1}))}}},Ge={class:"ml-4"},Ye={__name:"Partes",props:{show:Boolean,ato_token:String,ato_id:Number,partes_imovel:Object},emits:["close","update-imovel"],setup(E,{emit:j}){const n=E,_=m(n.show),v=be(),w=$e(),{$toast:U}=Ve(),u=`${w.public.managemant}/bens_pessoa`,I=`${w.public.managemant}/listarPapeis`,$=m([]),k=re({percentual:null,tipo_parte_id:null}),B=m({}),T=j;ve(()=>n.show,async x=>{_.value=x,x&&(await F(),k.tipo_parte_id=n.partes_imovel.partes_tipos.descricao||null,k.percentual=n.partes_imovel.percentual.replace(/,/g,"")||null,B.value={tipo_parte_id:k.tipo_parte_id,percentual:k.percentual.replace(/,/g,"")})});const V=()=>{_.value=!1,T("close")},F=async()=>{const{data:x}=await S(I,{method:"POST",body:{tipo_ato_token:v.query.tipo_ato_token}},"$IjSu4kwy4b");$.value=x.value},H=async()=>{const x={};Object.keys(k).forEach(z=>{let P=k[z];z==="tipo_parte_id"&&P&&(P=P.id),P!==B.value[z]&&(x[z]=P)}),x.percentual&&(x.percentual=x.percentual.toString().replace(/,/g,""));const{status:b}=await S(`${u}/${n.partes_imovel.id}`,{method:"PUT",body:x},"$QkvGl1R6ZY");b.value==="success"&&(U.success("Parte Atualizada com Sucesso!"),T("update-imovel",x),V())};return(x,b)=>{const z=ye;return y(),N(ge,{persistent:"",modelValue:o(_),"onUpdate:modelValue":b[2]||(b[2]=P=>de(_)?_.value=P:null),"max-width":"800"},{default:t(()=>[e(fe,null,{default:t(()=>[e(ue,null,{default:t(()=>[e(O,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:t(()=>[M("h1",Ge," Altere o papel para: "+Pe(n.partes_imovel.pessoa.nome),1)]),_:1}),b[4]||(b[4]=M("hr",{class:"mb-5"},null,-1)),e(O,null,{default:t(()=>[e(f,{cols:"8"},{default:t(()=>[e(Z,{class:"mt-6",label:"Selecione o Papel",modelValue:o(k).tipo_parte_id,"onUpdate:modelValue":b[0]||(b[0]=P=>o(k).tipo_parte_id=P),items:o($),"item-title":"descricao","item-value":"descricao","return-object":""},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[b[3]||(b[3]=M("label",null,"%",-1)),e(z,{modelValue:o(k).percentual,"onUpdate:modelValue":b[1]||(b[1]=P=>o(k).percentual=P)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Te,null,{default:t(()=>[e(W,{style:{"background-color":"red",color:"white"},onClick:V},{default:t(()=>b[5]||(b[5]=[q("Voltar")])),_:1}),e(W,{style:{"background-color":"green",color:"white"},onClick:H},{default:t(()=>b[6]||(b[6]=[q("Salvar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Je=["onClick"],Qe=["onClick"],Ze=["onClick"],We={key:0,style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar",title:"Reativar"},Xe={key:1,src:De,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Se={__name:"Partes",props:{ato_token:{type:String},ato_token_selected:{type:String},ato_id:{type:Number},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(E,{emit:j}){let n,_;const v=E,w=j,U=be(),u=$e(),{$toast:I}=Ve(),$=`${u.public.managemant}/partes_atos`,k=`${u.public.managemant}/listarPapeis`,B=`${u.public.managemant}/getLinkTipo`,T=`${u.public.managemant}/bens_pessoa`,V=`${u.public.managemant}/bens_pessoa`,F=`${u.public.managemant}/bens_pessoa`,H=`${u.public.managemant}/download`,x=m(null),b=m([]),z=m([]),P=m([]),G=m(!1),X=m(!1),K=m(null),me=m(U.query.tipo_ato_token),ee=m(null),te=[{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"%",align:"start",key:"percentual"},{value:"actions"}],C=re({papeis:null,percentual:null}),{data:Y}=([n,_]=ne(()=>S(k,{method:"POST"},"$X6FDd5A6WK")),n=await n,_(),n);P.value=Y.value;const r=async()=>{const{data:c}=await S(`${V}/${v.imovel_id}`,{method:"GET"},"$Dyv7lSgcqT"),p=(l=>l.map(g=>({...g,pessoa:{...g.pessoa,documento:g.pessoa.doc_identificacao},papel:{...g.partes_tipos}})))(c.value);z.value=p};r();const le=async()=>{await r()},{data:J,status:d}=([n,_]=ne(()=>S($,{method:"POST",body:{ato_token:v.ato_token||U.query.ato_token_edit}},"$Ir36YwSBFY")),n=await n,_(),n);b.value=J.value&&Object.keys(J.value).length===0?[]:J.value;const se=async()=>{const c={pessoa:{nome:C.pessoa.pessoa_nome},papel:P.value.find(l=>l.id===C.papeis),percentual:C.percentual},{data:a,status:p}=await S(T,{method:"POST",body:{bem_id:v.imovel_id,ato_id:Number(U.query.ato_id),pessoa_id:C.pessoa.pessoa_id,tipo_parte_id:C.papeis,user_id:ae("user-data").value.usuario_id,percentual:C.percentual.replace(/,/g,"")}},"$z4QOGPyvCc");p.value==="success"&&(c.id=a.value.id,I.success("Pessoa Registrada com Sucesso!"),z.value.push(c))},ce=async c=>{var s;if(G.value=!0,ee.value=null,!c.pessoa.id)return;const{data:a}=await S(B,{method:"POST",body:{tipo:"ficha",id:c.pessoa.id}},"$XYnqHmowsR");if(!((s=a.value)!=null&&s.link))return;const{data:p}=await S(H,{method:"POST",body:{bucket:ae("user-data").value.cartorio_token,path:a.value.link}},"$63DgHOk5hC"),l=a.value.link,g=p.value;/\.(tr7|tiff)$/i.test(l)?ee.value=g:fotoRender.value=`data:image/jpeg;base64,${g}`},L=c=>{X.value=!0,x.value=c,K.value=c.id};async function pe(c){c.excluido=!c.excluido;try{await S(`${F}/${c.id}`,{method:"PUT",body:JSON.stringify({excluido:c.excluido})},"$3fKfAn4Pra")}catch(a){console.error("Erro ao excluir pessoa:",a)}}const _e=()=>{w("close-modal"),w("refresh-list")};return(c,a)=>{const p=ye,l=Ye,g=Ee,s=ke;return y(),N(ue,{style:{height:"500px"}},{default:t(()=>[e(O,null,{default:t(()=>[e(f,{class:"mt-6",cols:"4"},{default:t(()=>[e(Z,{label:"Selecione a Pessoa",modelValue:o(C).pessoa,"onUpdate:modelValue":a[0]||(a[0]=i=>o(C).pessoa=i),items:o(b),"item-title":"pessoa_nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(f,{class:"mt-6",cols:"3"},{default:t(()=>[e(Z,{label:"Papel",modelValue:o(C).papeis,"onUpdate:modelValue":a[1]||(a[1]=i=>o(C).papeis=i),items:o(P),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"1"},{default:t(()=>[a[6]||(a[6]=M("label",null,"%",-1)),e(p,{modelValue:o(C).percentual,"onUpdate:modelValue":a[2]||(a[2]=i=>o(C).percentual=i)},null,8,["modelValue"])]),_:1}),M("div",null,[M("img",{class:"mt-7",src:he,style:{width:"40px",cursor:"pointer"},title:"Criar Imovel",onClick:se})])]),_:1}),e(O,null,{default:t(()=>[e(f,null,{default:t(()=>[e(Le,{style:{height:"350px"},headers:te,items:o(z)},{"item.actions":t(({item:i})=>[e(O,null,{default:t(()=>[M("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:oe=>ce(i),title:"Visualizar Ficha"},a[7]||(a[7]=[M("img",{style:{width:"30px",height:"30px"},src:Ne,alt:"Visualizar"},null,-1)]),8,Je),M("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:oe=>L(i),class:"mr-2",title:"Alterar Papel"},a[8]||(a[8]=[M("img",{style:{width:"30px",height:"30px"},src:je,alt:"Visualizar"},null,-1)]),8,Qe),M("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:oe=>pe(i),title:"Deletar Pessoa"},[i.excluido?(y(),D("img",We)):(y(),D("img",Xe))],8,Ze)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(l,{partes_imovel:o(x),ato_token:o(me),ato_id:o(K),show:o(X),onClose:a[3]||(a[3]=i=>X.value=!1),onUpdateImovel:le},null,8,["partes_imovel","ato_token","ato_id","show"]),e(ge,{modelValue:o(G),"onUpdate:modelValue":a[5]||(a[5]=i=>de(G)?G.value=i:null),width:"600"},{default:t(()=>[e(fe,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(g,{"tiff-url":o(ee)},null,8,["tiff-url"]),e(W,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:a[4]||(a[4]=i=>G.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(O,{class:"mt-5"},{default:t(()=>[e(s,{onClick:_e},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>a[9]||(a[9]=[q("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},Ke={key:0},eo={key:1},oo={key:2},Po={__name:"Cadastro",props:{show:Boolean,imovel_id:Number,ato_token:String,ato_id:Number,ato_token_selected:String},emits:["close","refresh"],setup(E,{emit:j}){const n=E,_=m("dados"),v=m(n.show),w=m(null),U=m(null),u=m(!1),I=j;ve(()=>n.show,T=>{v.value=T});const $=T=>{u.value=!0,U.value=T.ato_id,w.value=T.id},k=()=>{v.value=!1,u.value=!1,I("close")},B=()=>{I("refresh")};return(T,V)=>{const F=Ce,H=Me,x=Se;return y(),N(ge,{persistent:"",modelValue:o(v),"onUpdate:modelValue":V[1]||(V[1]=b=>de(v)?v.value=b:null),"max-width":"1000"},{default:t(()=>[e(fe,{style:{height:"650px"}},{default:t(()=>[e(ue,null,{default:t(()=>[V[5]||(V[5]=M("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Cadastro de imoveis ",-1)),e(xe,{modelValue:o(_),"onUpdate:modelValue":V[0]||(V[0]=b=>de(_)?_.value=b:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(ie,{value:"dados"},{default:t(()=>V[2]||(V[2]=[q("Dados")])),_:1}),o(u)?(y(),N(ie,{key:0,value:"enderecos"},{default:t(()=>V[3]||(V[3]=[q("Endereco")])),_:1})):Q("",!0),o(u)?(y(),N(ie,{key:1,value:"partes"},{default:t(()=>V[4]||(V[4]=[q("Partes")])),_:1})):Q("",!0)]),_:1},8,["modelValue"]),o(_)==="dados"?(y(),D("div",Ke,[e(F,{onRefreshList:B,ato_id:n.ato_id,onSaved:$,onCloseModal:k},null,8,["ato_id"])])):Q("",!0),o(_)==="enderecos"&&o(u)?(y(),D("div",eo,[e(H,{onRefreshList:B,isUpdate:!1,ato_id:o(U),ato_token:n.ato_token,imovel_id:o(w),onCloseModal:k},null,8,["ato_id","ato_token","imovel_id"])])):Q("",!0),o(_)==="partes"&&o(u)?(y(),D("div",oo,[e(x,{onRefreshList:B,imovel_id:o(w),ato_token:n.ato_token,ato_id:n.ato_id,ato_token_selected:n.ato_token_selected,onCloseModal:k},null,8,["imovel_id","ato_token","ato_id","ato_token_selected"])])):Q("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},ao={key:0},to={key:1},lo={key:2},Uo={__name:"Atualizar",props:{show:Boolean,imovel_id:Number,ato_token_selected:String},emits:["close","refresh"],setup(E,{emit:j}){const n=E,_=m("dados"),v=m(n.show),w=j;ve(()=>n.show,I=>{v.value=I});const U=()=>{v.value=!1,w("close")},u=()=>{w("refresh")};return(I,$)=>{const k=Ce,B=Me,T=Se;return y(),N(ge,{persistent:"",modelValue:o(v),"onUpdate:modelValue":$[1]||($[1]=V=>de(v)?v.value=V:null),"max-width":"1000"},{default:t(()=>[e(fe,{style:{height:"650px"}},{default:t(()=>[e(ue,null,{default:t(()=>[$[5]||($[5]=M("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Atualizar imovel ",-1)),e(xe,{modelValue:o(_),"onUpdate:modelValue":$[0]||($[0]=V=>de(_)?_.value=V:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(ie,{value:"dados"},{default:t(()=>$[2]||($[2]=[q("Dados")])),_:1}),e(ie,{value:"enderecos"},{default:t(()=>$[3]||($[3]=[q("Endereço")])),_:1}),e(ie,{value:"partes"},{default:t(()=>$[4]||($[4]=[q("Partes")])),_:1})]),_:1},8,["modelValue"]),o(_)==="dados"?(y(),D("div",ao,[e(k,{onRefreshList:u,isUpdate:!0,imovel_id:n.imovel_id,onCloseModal:U},null,8,["imovel_id"])])):Q("",!0),o(_)==="enderecos"?(y(),D("div",to,[e(B,{onRefreshList:u,isUpdate:!0,imovel_id:n.imovel_id,onCloseModal:U},null,8,["imovel_id"])])):Q("",!0),o(_)==="partes"?(y(),D("div",lo,[e(T,{imovel_id:n.imovel_id,ato_token_selected:n.ato_token_selected,onCloseModal:U},null,8,["imovel_id","ato_token_selected"])])):Q("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{Po as _,Uo as a};
