import{_ as uo}from"./CqI_nb7P.js";import{_ as co,a as mo}from"./BeczrYij.js";import{_ as po}from"./CmKmEV8Z.js";import{_ as _o}from"./BM2cVuSS.js";import{_ as F}from"./B_Gkvw8t.js";import{_ as vo}from"./DE1Jp4UM.js";import{_ as fo}from"./BBy1vgWz.js";import{_ as yo}from"./DEz6L5st.js";import{_ as ko,u as Vo,r as u,e as $,f as bo,g as go,n as $o,h as ho,c as wo,b as n,w as r,a as s,i as l,j as So,k as Ao,F as Co,l as xo,o as L,m as k,V as c,p as Do,q as x}from"./lXQ7b3du.js";import{u as Oo}from"./CU7QEufJ.js";import{u as _}from"./Dmr4rgiu.js";import{f as h}from"./B0IxRygJ.js";import{V as Uo}from"./C5RY8UZm.js";import{V as To}from"./kKYPUUuk.js";import{V as D}from"./DjK0vvIP.js";import{V as i}from"./D8ZmHRsW.js";import{V as O}from"./aBje7zLP.js";import"./nZEA19Cz.js";import"./107di9lY.js";import"./r3XG2wD4.js";import"./lS3DYVRv.js";import"./BDFDMeCY.js";import"./D0wU2pAd.js";import"./DyaGO_cW.js";import"./BVz1G1IN.js";import"./DJvq3mCv.js";import"./F8zxlvSZ.js";import"./CjdHb2zB.js";import"./DqUkBuGe.js";const Po={style:{width:"1300px",margin:"0 auto"}},No={style:{display:"flex",gap:"4px","justify-content":"center"}},Eo=["onClick"],qo=["onClick"],Mo=["onClick","title"],Ro=["onClick"],Io=["title"],zo=["onClick"],Fo={__name:"index",setup(Lo){const p=xo(),{$toast:f}=Vo(),J=`${p.public.managemant}/listarUsuarios`,j=`${p.public.managemant}/listar_tipo_atos`,B=`${p.public.managemant}/cancela_lavratura`,H=`${p.public.biometria}/run-scanner?format=pdf`,X=`${p.public.envioDoc}/upload`;`${p.public.managemant}`;const U=`${p.public.managemant}/pesquisaAtos`,{redirectTo:T}=Oo(),V=u($("auth_token").value)||null,w=u($("user-data").value.cartorio_token)||null,S=u(!1),b=u([]),P=u([]),N=u([]),Y=u(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),E=u(!1),A=u(!1),q=u(""),G=u(null),K=u({}),C=u(!1),M=u(null),e=bo({numero:null,data_inicio:R(),data_fim:R(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:V.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),Q=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:a=>a.protocolo?`${a.id}
${a.protocolo}`:`${a.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:a=>a.dt_abertura?`${a.dt_abertura}
${a.apresentante_cpf}`:`${a.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:a=>a.dt_lavratura?`${a.dt_lavratura}
${a.apresentante_nome}`:`${a.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:a=>a.situacao?`${a.situacao}
${a.ato_servico}`:`${a.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function R(){const a=new Date,o=a.getFullYear(),d=String(a.getMonth()+1).padStart(2,"0");return`${String(a.getDate()).padStart(2,"0")}-${d}-${o}`}function v(a){if(!a)return null;const[o,d,m]=a.split("/");return`${m}-${d}-${o}`}async function I(){const a=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(a),{data:d}=await _(U,{method:"POST",body:{cartorio_token:$("user-data").value.cartorio_token,usuario_token:o.usuario_token||V.value,data_fim:v(o==null?void 0:o.data_fim),data_inicio:v(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");d.value.length>0&&(b.value=d.value.map(m=>({...m,dt_lavratura:m.dt_lavratura?h(m.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:h(m.dt_abertura,"dd/mm/yyyy")})))}async function W(){const{data:a}=await _(J,{method:"POST",body:{cartorio_token:w.value}},"$hvipqUJYtS");P.value=a.value}async function Z(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(e));const{data:a}=await _(U,{method:"POST",body:{cartorio_token:w.value,numero_os:e.numero||null,data_inicio:v(e.data_inicio)||null,data_fim:v(e.data_fim)||null,data_lavratura_inicio:v(e.data_lavratura_inicio)||null,data_lavratura_fim:v(e.data_lavratura_fim)||null,protocolo:e.protocolo||null,livro:e.livro||null,folha:e.folha||null,situacao:e.situacao||null,usuario_token:e.usuario_token,selo:e.selo||null,ato_tipo_token:e.ato_tipo_token,parte:e.parte||null}},"$OjamgBH6nj");a.value.length>0?b.value=a.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?h(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?h(o.dt_abertura,"dd/mm/yyyy"):null})):(b.value=[],f.error("Não existe ato Registrado!"))}catch(a){console.error("Erro na requisição",a)}}const oo=a=>{T({item:a,id:a.id,numeroOs:a.numero_os,origem:"vizualizar-lista"})};async function ao(){const{data:a,error:o}=await _(j,{method:"POST",body:{cartorio_token:w.value,usuario_token:V.value,tipo_retorno:"servico_ato"}},"$QxIfw0Zxe4");N.value=a.value}const to=a=>{M.value=a,C.value=!0},z=async a=>{const{data:o,status:d}=await _(B,{method:"POST",body:{ato_token:a,user_token:V.value,cancelar_selo:!1}},"$ceiptlfDNO");d.value==="success"&&o.value[0].status==="OK"?f.success("Lavratura cancelada com sucesso!"):o.value[0].status==="ERRO"&&(A.value=!0,q.value=o.value[0].status_mensagem)},eo=a=>{T({item:a,id:a.id,numeroOs:a.numero_os,origem:"atualizar-lista"})},lo=async a=>{try{await ro(),await no(a)}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}};async function no(a){try{const{status:o,data:d}=await _(X,{method:"POST",body:{tipo:"ato_livro",token:a,cartorio_token:$("user-data").value.cartorio_token}},"$zTNfED00Fu");o.value==="success"&&f.success("Arquivo enviado com sucesso!")}catch(o){f.error(o),console.error("Erro ao enviar o arquivo:",o)}}async function ro(){try{const{data:a}=await _(H,{method:"GET"},"$hJse5XXJsY")}catch(a){f.error("Erro ao acionar o scanner:",a)}}return go(()=>{$o(async()=>{const a=sessionStorage.getItem("pesquisaAto");if(a){const o=JSON.parse(a);Object.assign(e,o)}await I()})}),W(),ao(),(a,o)=>{const d=uo,m=co,so=po,io=_o,y=ho("mask");return L(),wo(Co,null,[n(Uo,{class:"mt-5"},{default:r(()=>[n(D,{class:"mb-5"},{default:r(()=>o[19]||(o[19]=[s("h1",null,"Atos",-1)])),_:1}),n(D,null,{default:r(()=>[n(i,{cols:"2"},{default:r(()=>[k(n(c,{modelValue:l(e).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=t=>l(e).data_inicio=t),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),n(i,{cols:"2"},{default:r(()=>[k(n(c,{modelValue:l(e).data_fim,"onUpdate:modelValue":o[1]||(o[1]=t=>l(e).data_fim=t),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),n(i,{cols:"2"},{default:r(()=>[k(n(c,{modelValue:l(e).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=t=>l(e).data_lavratura_inicio=t),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),n(i,{cols:"2"},{default:r(()=>[k(n(c,{modelValue:l(e).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=t=>l(e).data_lavratura_fim=t),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),n(i,{cols:"2"},{default:r(()=>[n(c,{modelValue:l(e).numero,"onUpdate:modelValue":o[4]||(o[4]=t=>l(e).numero=t),label:"N° OS"},null,8,["modelValue"])]),_:1}),n(i,{cols:"2"},{default:r(()=>[n(c,{modelValue:l(e).selo,"onUpdate:modelValue":o[5]||(o[5]=t=>l(e).selo=t),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),n(D,null,{default:r(()=>[n(i,{cols:"2"},{default:r(()=>[n(c,{modelValue:l(e).protocolo,"onUpdate:modelValue":o[6]||(o[6]=t=>l(e).protocolo=t),label:"Protocolo"},null,8,["modelValue"])]),_:1}),n(i,{cols:"2"},{default:r(()=>[k(n(c,{modelValue:l(e).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=t=>l(e).apresentante_cpf=t),label:"CPF",dense:""},null,8,["modelValue"]),[[y,"###.###.###-##"]])]),_:1}),n(i,{cols:"3"},{default:r(()=>[n(c,{modelValue:l(e).parte,"onUpdate:modelValue":o[8]||(o[8]=t=>l(e).parte=t),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),n(i,{cols:"3"},{default:r(()=>[n(O,{modelValue:l(e).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=t=>l(e).ato_tipo_token=t),items:l(N),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),n(i,{cols:"2"},{default:r(()=>[n(O,{items:l(P),modelValue:l(e).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=t=>l(e).usuario_token=t),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),n(i,{cols:"3"},{default:r(()=>[n(O,{modelValue:l(e).situacao,"onUpdate:modelValue":o[11]||(o[11]=t=>l(e).situacao=t),items:l(Y),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),n(i,{cols:"1"},{default:r(()=>[n(c,{modelValue:l(e).livro,"onUpdate:modelValue":o[12]||(o[12]=t=>l(e).livro=t),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),n(i,{cols:"1"},{default:r(()=>[n(c,{modelValue:l(e).folha,"onUpdate:modelValue":o[13]||(o[13]=t=>l(e).folha=t),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),n(i,null,{default:r(()=>[s("div",null,[s("img",{onClick:Z,style:{width:"40px",height:"40px",cursor:"pointer"},src:F,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),s("div",Po,[o[23]||(o[23]=s("hr",{class:"mt-5 mb-5"},null,-1)),n(To,{headers:Q,items:l(b),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":r(({item:t})=>[s("div",No,[s("div",{onClick:g=>oo({id:t.id,tipo:`${t.tipo_servico} - ${t.tipo_ato}`,token:t.token,tipo_token:t.tipo_token,rota:t.rota,numero_os:t.numero_os}),title:"Visualizar"},o[20]||(o[20]=[s("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:F,alt:"Visualizar"},null,-1)]),8,Eo),s("div",{onClick:g=>to(t.token),title:"Reimprimir"},o[21]||(o[21]=[s("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:mo,alt:"Reimprimir"},null,-1)]),8,qo),s("div",{class:Do({disabled:!t.btn_editar}),onClick:g=>t.btn_editar?eo({id:t.id,tipo:`${t.tipo_servico} - ${t.tipo_ato}`,token:t.token,tipo_token:t.tipo_token,rota:t.rota,numero_os:t.numero_os}):null,title:t.btn_editar?"Editar":"Desabilitado"},[s("img",{style:x({cursor:t.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:vo,alt:"Editar"},null,4)],10,Mo),s("div",{onClick:g=>t.btn_cancelar?z(t.token):null,title:"Excluir",style:x({cursor:t.btn_cancelar?"pointer":"not-allowed"})},[s("img",{style:x({width:"30px",height:"30px",cursor:t.btn_cancelar?"pointer":"not-allowed",opacity:t.btn_cancelar?"1":"0.5"}),src:fo,alt:"Cancelar",title:t.btn_cancelar?"Cancelar":"Não permitido"},null,12,Io)],12,Ro),s("div",{onClick:g=>lo(t.token)},o[22]||(o[22]=[s("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:yo,alt:"escanear",title:"escanear"},null,-1)]),8,zo)])]),_:1},8,["items"])]),l(S)?(L(),So(d,{key:0,show:l(S),servicos:a.dadosData.servicos||[],tiposAtos:a.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=t=>S.value=!1),onUpdateAto:a.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):Ao("",!0),n(m,{show:l(C),ato_token:l(M),onClose:o[15]||(o[15]=t=>C.value=!1)},null,8,["show","ato_token"]),n(so,{show:l(E),numero_os:l(G),ordem:l(K),onClose:o[16]||(o[16]=t=>E.value=!1),onRefreshValue:o[17]||(o[17]=t=>I())},null,8,["show","numero_os","ordem"]),n(io,{show:l(A),condMessage:l(q),onClose:o[18]||(o[18]=t=>A.value=!1),onConfirm:z},null,8,["show","condMessage"])],64)}}},ka=ko(Fo,[["__scopeId","data-v-c3fb4e64"]]);export{ka as default};
