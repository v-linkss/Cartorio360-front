import{r as A,n as ee,D as T,F as ae,h as G,G as oe,H as le,o as g,A as y,w as s,b as a,d as h,q as e,P as te,c as se,t as ie,C as j,s as u,I as M,a as w,v as L,x as H,V as de,y as z}from"./DL0PSLYG.js";import{a as re,u as X}from"./Bo4RXxsJ.js";import{_ as ne}from"./ToPptOUL.js";import{c as N,r as q,u as me,V as R,_ as ue}from"./DGJdVWVy.js";import{c as ce}from"./B-jQkRLz.js";import{a as J,b as K,V as Q,c as pe}from"./BJl_kupK.js";import{V as fe}from"./Ba6ELvVp.js";import{V as v}from"./D8o7uwAv.js";import{V as d}from"./CD2qQs_F.js";const _e={key:1},Pe={__name:"RegistroPessoas",props:{show:Boolean},emits:["close"],async setup(k,{emit:P}){let c,B;const b=k,r=A(b.show),p=P,{$toast:f}=ee(),_=H(),I=`${_.public.managemant}/createPessoa`,C=`${_.public.managemant}/listarEstadoCivil`,n=`${_.public.managemant}/listarCapacidadeCivil`,$=`${_.public.managemant}/listarCidades`,F={nome:"",nome_pai:"",nome_mae:"",profissao:"",local_trabalho:"",data_nascimento:"",doc_identificacao:"",cpf_pai:"",cpf_mae:"",tipo_pessoa:"FISICA",tabvalores_estadocivil_id:"",tabvalores_capacidadecivil_id:"",cidade_natural_id:"",cartorio_id:T("user-data").value.cartorio_id,user_id:T("user-data").value.usuario_id},t=ae({...F});G(()=>b.show,i=>{r.value=i});const D=()=>{r.value=!1,p("close")};function U(i){if(i)return i.replace(/[.\-]/g,"");i=null}const{data:x,pending:Ve,status:E,error:O}=([c,B]=oe(async()=>re("cliente-dados",async()=>{const[i,l,V]=await Promise.all([$fetch(C),$fetch(n),$fetch($)]);return{estadoCivilItems:i,capacidadeCivilItems:l,cidadeNascimentoItems:V}})),c=await c,B(),c),W={nome:{required:N.withMessage("O campo é obrigatorio",q)},nome_mae:{required:N.withMessage("O campo é obrigatorio",q)},doc_identificacao:{required:N.withMessage("O campo é obrigatorio",q),cpf:ce}},m=me(W,t);async function Y(){if(await m.value.$validate()){const i={...t};for(const S in i)i[S]===""&&(i[S]=null);const l={...i,doc_identificacao:U(t.doc_identificacao),cpf_pai:U(t.cpf_pai),cpf_mae:U(t.cpf_mae)},{data:V,error:o,status:Z}=await X(I,{method:"POST",body:l},"$BiOjXVCR5N");Z.value==="error"&&o.value.statusCode===500?f.error("Erro ao cadastrar pessoa,o CPF já está cadastrado."):(f.success("Pessoa cadastrada com sucesso!"),D())}else f.error("Erro ao cadastrar pessoa, preencha os campos obrigatorios.")}return(i,l)=>{const V=le("mask");return g(),y(Q,{persistent:"",modelValue:e(r),"onUpdate:modelValue":l[13]||(l[13]=o=>L(r)?r.value=o:null),"max-width":"1000"},{default:s(()=>[a(J,null,{default:s(()=>[a(K,{class:"text-h5 mt-3"},{default:s(()=>[h("Criar Pessoa")]),_:1}),e(E)==="pending"?(g(),y(te,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):e(O)?(g(),se("div",_e,ie(e(O).message),1)):j("",!0),e(E)==="success"?(g(),y(fe,{key:2,class:"mt-5"},{default:s(()=>[a(v,null,{default:s(()=>[a(d,{cols:"12",md:"8"},{default:s(()=>[a(u,{modelValue:e(t).nome,"onUpdate:modelValue":l[0]||(l[0]=o=>e(t).nome=o),"error-messages":e(m).nome.$errors.map(o=>o.$message),label:"Nome",required:"",onBlur:e(m).nome.$touch,onInput:e(m).nome.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[M(a(u,{modelValue:e(t).doc_identificacao,"onUpdate:modelValue":l[1]||(l[1]=o=>e(t).doc_identificacao=o),"error-messages":e(m).doc_identificacao.$errors.map(o=>o.$message),label:"CPF",required:"",onBlur:e(m).doc_identificacao.$touch,onInput:e(m).doc_identificacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),[[V,"###.###.###-##"]])]),_:1})]),_:1}),a(v,null,{default:s(()=>[a(d,{cols:"12",md:"4"},{default:s(()=>[a(R,{modelValue:e(t).tabvalores_estadocivil_id,"onUpdate:modelValue":l[2]||(l[2]=o=>e(t).tabvalores_estadocivil_id=o),items:e(x).estadoCivilItems,"item-title":"descricao","item-value":"id",label:"Estado Civil"},null,8,["modelValue","items"])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[a(u,{modelValue:e(t).profissao,"onUpdate:modelValue":l[3]||(l[3]=o=>e(t).profissao=o),label:"Profissão"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[a(u,{modelValue:e(t).local_trabalho,"onUpdate:modelValue":l[4]||(l[4]=o=>e(t).local_trabalho=o),label:"Local de trabalho"},null,8,["modelValue"])]),_:1})]),_:1}),a(v,null,{default:s(()=>[a(d,{cols:"12",md:"4"},{default:s(()=>[a(u,{modelValue:e(t).data_nascimento,"onUpdate:modelValue":l[5]||(l[5]=o=>e(t).data_nascimento=o),type:"date","prepend-icon":"",label:"Data de nascimento"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[a(R,{modelValue:e(t).tabvalores_capacidadecivil_id,"onUpdate:modelValue":l[6]||(l[6]=o=>e(t).tabvalores_capacidadecivil_id=o),items:e(x).capacidadeCivilItems,label:"Capacidade Civil","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[a(R,{modelValue:e(t).cidade_natural_id,"onUpdate:modelValue":l[7]||(l[7]=o=>e(t).cidade_natural_id=o),items:e(x).cidadeNascimentoItems,label:"Cidade de nascimento","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),a(v,null,{default:s(()=>[a(d,{cols:"12",md:"4"},{default:s(()=>[M(a(u,{modelValue:e(t).cpf_pai,"onUpdate:modelValue":l[8]||(l[8]=o=>e(t).cpf_pai=o),modelModifiers:{date:!0},label:"CPF do Pai"},null,8,["modelValue"]),[[V,"###.###.###-##"]])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[a(u,{modelValue:e(t).nome_pai,"onUpdate:modelValue":l[9]||(l[9]=o=>e(t).nome_pai=o),modelModifiers:{date:!0},label:"Nome do Pai"},null,8,["modelValue"])]),_:1})]),_:1}),a(v,null,{default:s(()=>[a(d,{cols:"12",md:"4"},{default:s(()=>[M(a(u,{modelValue:e(t).cpf_mae,"onUpdate:modelValue":l[10]||(l[10]=o=>e(t).cpf_mae=o),modelModifiers:{date:!0},label:"CPF da Mãe"},null,8,["modelValue"]),[[V,"###.###.###-##"]])]),_:1}),a(d,{cols:"12",md:"4"},{default:s(()=>[a(u,{modelValue:e(t).nome_mae,"onUpdate:modelValue":l[11]||(l[11]=o=>e(t).nome_mae=o),modelModifiers:{date:!0},"error-messages":e(m).nome_mae.$errors.map(o=>o.$message),label:"Nome da Mãe",required:"",onBlur:e(m).nome_mae.$touch,onInput:e(m).nome_mae.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),a(v,null,{default:s(()=>[w("div",null,[w("img",{class:"ml-5",style:{cursor:"pointer"},src:ne,alt:"Sair",onClick:D})]),w("div",null,[w("img",{style:{cursor:"pointer"},class:"ml-5",src:ue,onClick:l[12]||(l[12]=o=>Y())})])]),_:1})]),_:1})):j("",!0)]),_:1})]),_:1},8,["modelValue"])}}},Be={__name:"FichaCard",props:{show:Boolean,item:Object},emits:["close","confirmar"],setup(k,{emit:P}){const c=k,b=`${H().public.managemant}/getPessoaById`,r=A(c.show),p=A(),f=P;G(()=>c.show,async n=>{r.value=n,await I()});const _=()=>{f("confirmar"),C()},I=async()=>{try{const{data:n}=await X(`${b}/${c.item.id}`,{method:"GET"},"$4omB3S9Tg3");n.value&&n.value.link_ficha?p.value=`data:image/jpeg;base64,${n.value.link_ficha}`:p.value=null}catch(n){console.error("Erro ao buscar a imagem da ficha:",n)}},C=()=>{r.value=!1,p.value=null,f("close")};return(n,$)=>(g(),y(Q,{persistent:"",modelValue:e(r),"onUpdate:modelValue":$[0]||($[0]=F=>L(r)?r.value=F:null),"max-width":"700"},{default:s(()=>[a(J,null,{default:s(()=>[a(K,{class:"text-h5"},{default:s(()=>[h("Ficha de Firma")]),_:1}),a(de,{src:e(p)},null,8,["src"]),a(pe,null,{default:s(()=>[a(z,{style:{"background-color":"#429946",color:"white"},onClick:_},{default:s(()=>[h("Reconhecer")]),_:1}),a(z,{style:{"background-color":"red",color:"white"},onClick:C},{default:s(()=>[h("Voltar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{Pe as _,Be as a};
