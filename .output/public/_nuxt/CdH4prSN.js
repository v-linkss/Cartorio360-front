import{_ as P}from"./CjWcJ0pB.js";import{_ as q}from"./D8j2CE4o.js";import{_ as F}from"./BI6xqaZ7.js";import{_ as M,u as N,r as l,e as v,f as O,c as D,b as o,w as r,a as e,i as n,F as E,k as R,o as T,s as I}from"./DocoAQKL.js";import{u as f}from"./Cvx8zdu2.js";import{f as y}from"./B0IxRygJ.js";import{V as L}from"./DcknbuxL.js";import{V as B}from"./D4E_y4tl.js";import{V as h}from"./B9iCPK4m.js";import{V as x}from"./BSDvzSLA.js";import"./BozcXUgZ.js";import"./COd1z7Ka.js";import"./CXFWiv6o.js";import"./CfnjFqkD.js";import"./BsdO4JMn.js";import"./DTe9xx4m.js";import"./DKETEyTG.js";import"./D9fOi_Mf.js";import"./BiBQLpS5.js";import"./CqZJ2IID.js";const j={style:{width:"1300px",margin:"0 auto"}},z={style:{display:"flex",gap:"4px","justify-content":"center"}},U=["disabled","onClick"],G={__name:"index",setup(H){const d=R(),{$toast:c}=N(),g=`${d.public.managemant}/cancela_lavratura`,b=`${d.public.managemant}/pesquisaAtos`,k=l(v("auth_token").value)||null,C=l(v("user-data").value.cartorio_token)||null,m=l([]),i=l(!1),p=l(""),_=l(null),u=O({protocolo:null}),V=[{title:"Protocolo",value:"protocolo"},{title:"Data lavratura/Parte",value:"dt_lavratura"},{title:"Situação/Serviço",key:"situacaoServico",value:t=>t.situacao?`${t.situacao}
${t.ato_servico}`:`${t.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];async function w(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(u));const{data:t}=await f(b,{method:"POST",body:{cartorio_token:C.value,protocolo:u.protocolo||null}},"$EsIaDpdnSx");t.value.length>0?m.value=t.value.map(a=>({...a,dt_lavratura:a.dt_lavratura?y(a.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:a.dt_abertura?y(a.dt_abertura,"dd/mm/yyyy"):null})):(m.value=[],c.error("Não existe ato Registrado!"))}catch(t){console.error("Erro na requisição",t)}}const $=t=>{_.value=t,p.value="Tem certeza que deseja cancelar este ato?",i.value=!0},S=async()=>{const{data:t,status:a}=await f(g,{method:"POST",body:{ato_token:_.value,user_token:k.value,cancelar_selo:!1}},"$Xx0FGnNZIU");a.value==="success"&&t.value[0].status==="OK"?(c.success("Lavratura cancelada com sucesso!"),i.value=!1):t.value[0].status==="ERRO"&&c.error("erro ao cancelar ato")};return(t,a)=>{const A=P;return T(),D(E,null,[o(L,{class:"mt-5"},{default:r(()=>[o(h,{class:"mb-5"},{default:r(()=>a[2]||(a[2]=[e("h1",null,"Cancelamento de Lavratura",-1)])),_:1}),o(h,null,{default:r(()=>[o(x,{cols:"2"},{default:r(()=>[o(I,{modelValue:n(u).protocolo,"onUpdate:modelValue":a[0]||(a[0]=s=>n(u).protocolo=s),label:"Protocolo"},null,8,["modelValue"])]),_:1}),o(x,null,{default:r(()=>[e("div",null,[e("img",{onClick:w,style:{width:"40px",height:"40px",cursor:"pointer"},src:q,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),e("div",j,[a[4]||(a[4]=e("hr",{class:"mt-5 mb-5"},null,-1)),o(B,{headers:V,items:n(m),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":r(({item:s})=>[e("div",z,[e("div",{disabled:!s.btn_cancelar,onClick:J=>s.btn_cancelar?$(s.token):null,title:"Excluir"},a[3]||(a[3]=[e("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:F,alt:"Cancelar",title:"Cancelar"},null,-1)]),8,U)])]),_:1},8,["items"])]),o(A,{show:n(i),condMessage:n(p),onClose:a[1]||(a[1]=s=>i.value=!1),onConfirm:S},null,8,["show","condMessage"])],64)}}},_a=M(G,[["__scopeId","data-v-d50eb60d"]]);export{_a as default};
