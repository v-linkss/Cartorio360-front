import{_ as te}from"./DYCjZhxV.js";import{a as oe,_ as ae}from"./QnbEUYi2.js";import{_ as se}from"./_vTTP42X.js";import{_ as re}from"./BVz1G1IN.js";import{_ as ne}from"./DlI8Qddj.js";import{_ as ie}from"./CV_4hpUE.js";import{_ as le,a as ue}from"./DJvq3mCv.js";import{c as E,r as T,u as pe}from"./yghpo_da.js";import{u as de,O as me,m as ce,r as u,n as k,p as _e,H as B,v as fe,y as w,w as n,A as ve,o as c,b as r,a as i,t as ge,x as a,B as ke,V as C,G as xe,E as he,c as I,I as $e,d as ye}from"./Dlqmy1RL.js";import{u as O}from"./C_GLwl2T.js";import{f as Ve}from"./DYWSHECu.js";import{V as be}from"./DAKMzE7Y.js";import{V as x}from"./BKuoGoND.js";import{V as h}from"./wTX4dFQI.js";import{V as we}from"./syGi6Sh6.js";import{V as Ce}from"./Dwnwy4ft.js";import"./R8R8AvG3.js";import"./Ce67EB2p.js";import"./BN1Q8xcp.js";import"./jc2lIy5z.js";import"./C5gnfu47.js";import"./B1Y6quKv.js";import"./BLWE23di.js";const Oe={style:{color:"red","margin-left":"30px"}},Ae=["onClick"],Re=["onClick"],ze=["onClick","title"],Ee=["disabled","onClick"],Te={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:le,alt:"Visualizar",title:"Reativar"},Be={key:1,src:ue,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},st={__name:"[id]",async setup(Ie){let l,_;const{$toast:A}=de(),U=me(),{id:d}=U.params,$=ce(),f=ve(),S=`${f.public.managemant}/updateOrdensServico`,q=`${f.public.managemant}/getOrdensServicoById`,P=`${f.public.managemant}/listarAtos`,D=`${f.public.managemant}/updateAtos`,N=u(k("user-data").value.cartorio_id),F=u(k("user-data").value.usuario_id),M=u(k("user-service").value.token).value||null,G=u(k("user-data").value.cartorio_token).value,y=u([]),V=u(!1),R=u(null),m=u(null),s=_e({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),L=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],H=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],K={apresentante_nome:{required:E.withMessage("O campo é obrigatorio",T)},apresentante_cpf:{required:E.withMessage("O campo é obrigatorio",T)}},p=pe(K,s);function W(e){if(e)return e.replace(/[.\-]/g,"");e=null}const X=e=>{R.value=e,V.value=!0},Y=e=>{(e.rota==="/fontes/atos/ato-com-bem/geral"||e.rota==="/fontes/atos/ato-sem-bem/geral")&&$.push({path:`/fontes/atos/atos-com-bem/atualizar/${e.id}`,query:{origem:"vizualizar",id:d,ato_id:e.id,tipo_ato_token:e.tipo_token,tipo_ato:e.tipo,ato_token_edit:e.token,numero_os:m.value,usa_imoveis:e.usa_imoveis}})},Z=e=>{(e.usa_imoveis||!e.usa_imoveis)&&$.push({path:`/fontes/atos/atos-com-bem/atualizar/${e.id}`,query:{origem:"atualizar",id:d,ato_id:e.id,tipo_ato_token:e.tipo_token,tipo_ato:e.tipo,ato_token_edit:e.token,numero_os:m.value,usa_imoveis:e.usa_imoveis}})};async function j(){const e={apresentante_cpf:W(s.apresentante_cpf),apresentante_nome:s.apresentante_nome,user_id:F.value,cartorio_id:N.value},{error:o,status:g}=await O(`${S}/${d}`,{method:"PUT",body:e},"$Fud06ay483");g.value==="error"&&o.value.statusCode===500?A.error("Erro ao cadastrar ordem,erro no sistema."):(A.success("Ordem Atualizada com sucesso!"),$.push({path:"/os/lista"}))}const{data:v}=([l,_]=B(()=>O(`${q}/${d}`,{method:"GET"},"$wPUkUpDvPf")),l=await l,_(),l);m.value=v.value.numero,s.nacionalidade=v.value.estrangeiro,s.apresentante_cpf=v.value.apresentante_cpf,s.apresentante_nome=v.value.apresentante_nome;const{data:z}=([l,_]=B(()=>O(P,{method:"POST",body:{cartorio_token:G,ordemserv_token:M}},"$YXZ55K3IUf")),l=await l,_(),l);async function J(e){e.excluido=!e.excluido;try{await Ve(`${D}/${e.id}`,{method:"PUT",body:{excluido:e.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}return z.value.length>0?y.value=z.value:y.value=[],(e,o)=>{const g=te,Q=ae,ee=fe("mask");return c(),w(be,{class:"mt-5"},{default:n(()=>[r(x,{class:"mb-5"},{default:n(()=>[o[6]||(o[6]=i("h1",null,"Ordem de Serviço nº",-1)),i("h1",Oe,ge(a(m)),1)]),_:1}),r(x,null,{default:n(()=>[r(h,{md:"3"},{default:n(()=>[r(we,{label:"Nacionalidade",items:H,modelValue:a(s).nacionalidade,"onUpdate:modelValue":o[0]||(o[0]=t=>a(s).nacionalidade=t)},null,8,["modelValue"])]),_:1}),r(h,{md:"2"},{default:n(()=>[a(s).nacionalidade==="brasileiro"?ke((c(),w(C,{key:0,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":o[1]||(o[1]=t=>a(s).apresentante_cpf=t),label:"CPF",required:"","error-messages":a(p).apresentante_cpf.$errors.map(t=>t.$message),onBlur:a(p).apresentante_cpf.$touch,onInput:a(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[ee,"###.###.###-##"]]):(c(),w(C,{key:1,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":o[2]||(o[2]=t=>a(s).apresentante_cpf=t),label:"Documento",required:"","error-messages":a(p).apresentante_cpf.$errors.map(t=>t.$message),onBlur:a(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),r(h,{md:"4"},{default:n(()=>[r(C,{modelValue:a(s).apresentante_nome,"onUpdate:modelValue":o[3]||(o[3]=t=>a(s).apresentante_nome=t),label:"Nome Apresentante",required:"","error-messages":a(p).apresentante_nome.$errors.map(t=>t.$message),onInput:a(p).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),r(h,null,{default:n(()=>[i("div",null,[i("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:se,alt:"Salvar",onClick:o[4]||(o[4]=t=>j())})])]),_:1})]),_:1}),r(x,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:n(()=>[o[10]||(o[10]=i("h1",{class:"ml-5"},"Atos",-1)),r(g,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:a(d),numeroOs:a(m)}}},{default:n(()=>o[7]||(o[7]=[i("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:re,alt:"novo"},null,-1)])),_:1},8,["to"]),r(Ce,{headers:L,items:a(y),"item-key":"id"},{"item.actions":n(({item:t})=>[r(x,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:n(()=>[i("div",{onClick:b=>Y(t),title:"Visualizar"},o[8]||(o[8]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ne,alt:"Visualizar"},null,-1)]),8,Ae),i("div",{onClick:b=>X(t.token),title:"Reimprimir"},o[9]||(o[9]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:oe,alt:"Reimprimir"},null,-1)]),8,Re),i("div",{class:he({disabled:!t.btn_editar}),onClick:b=>t.btn_editar?Z({id:t.id,tipo:t.tipo,token:t.token,tipo_token:t.tipo_token,usa_imoveis:t.usa_imoveis}):null,title:t.btn_editar?"Editar":"Desabilitado"},[i("img",{style:xe({cursor:t.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ie,alt:"Editar"},null,4)],10,ze),i("div",{disabled:!t.btn_cancelar,onClick:b=>t.btn_cancelar?J(t):null,title:"Excluir"},[t.excluido?(c(),I("img",Te)):(c(),I("img",Be))],8,Ee)]),_:2},1024)]),_:1},8,["items"]),r(Q,{show:a(V),ato_token:a(R),onClose:o[5]||(o[5]=t=>V.value=!1)},null,8,["show","ato_token"])]),_:1}),r(g,{to:"/os/lista"},{default:n(()=>[r($e,{size:"large",color:"red"},{default:n(()=>o[11]||(o[11]=[ye("Voltar")])),_:1})]),_:1})]),_:1})}}};export{st as default};
