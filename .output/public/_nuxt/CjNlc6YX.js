import{_ as O}from"./6RYVis8C.js";import{r as d,u as U,f as I,g as j,o as _,c as h,b as e,w as l,a as g,s as v,i as r,V as $,d as E,N as P,j as q,F as G,k as R,e as T,A as K,h as N}from"./BFubt5K-.js";import{u as M}from"./DO0JiUxm.js";import{V as H,c as J}from"./BAz72YtY.js";import{V as z}from"./B9P8d4Wk.js";import{V as A}from"./Cn46jq14.js";import{V as y}from"./CCJ0H2nG.js";import{V as W}from"./kJoZuS00.js";import{_ as Y,a as Z}from"./DJvq3mCv.js";import{f as Q}from"./B0IxRygJ.js";import{V as X}from"./0HI9nnWz.js";import"./BjBE1yu7.js";import"./CGSGkCFE.js";import"./CJw_lHYf.js";import"./BcLYmS-Z.js";import"./DS_gXmtl.js";import"./Q4Fj7ezm.js";import"./DXFSGs24.js";import"./BU3oJa_R.js";const ee={__name:"ImportaSelos",props:{show:Boolean,ato_token:String,ato_id:Number,representante_nome:String},emits:["close","update-papel"],setup(B,{emit:w}){const p=B,i=d(p.show),m=R(),{$toast:b}=U(),o=d(!1),V=d(""),C=`${m.public.ws}/fornecer_selos_por_lote`,x=`${m.public.managemant}/fornecer_selos`,a=d(!1),t=I({nuLote:null}),f=w;j(()=>p.show,async c=>{i.value=c});const s=()=>{i.value=!1,f("close")},D=async()=>{a.value=!0;try{const{data:c,error:n,status:L}=await M(C,{method:"POST",body:{user:"56415451472",pass:"Ra961206",statusSelo:"D",nuLote:t.nuLote},onResponseError({response:u}){var k;const S=((k=u._data)==null?void 0:k.details)||"Erro ao buscar lote de selos.";V.value=S,o.value=!0,console.error("Erro forneceSeloPorLote:",S)}},"$Z1bKGPif1c");if(L.value==="success"){const u=c.value.selos,{data:S,error:k,status:F}=await M(x,{method:"POST",body:{tipo_id:1,cartorio_id:T("user-data").value.cartorio_id,selos:u,user_id:T("user-data").value.usuario_id}},"$Kr3yBtlYBF");F.value==="success"&&(b.success("Selos importados com sucesso"),s())}}catch(c){console.error("Erro ao importar selos:",c)}finally{a.value=!1}};return(c,n)=>{const L=O;return _(),h(G,null,[e(W,{persistent:"",modelValue:r(i),"onUpdate:modelValue":n[1]||(n[1]=u=>q(i)?i.value=u:null),"max-width":"800"},{default:l(()=>[e(H,null,{default:l(()=>[e(z,null,{default:l(()=>[e(A,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:l(()=>[e(y,null,{default:l(()=>n[3]||(n[3]=[g("h1",{class:"ml-4"},"Importar selos do lote",-1),g("p",{class:"ml-4 mt-3"}," Informe o codigo do lote para realizar a importação ",-1)])),_:1})]),_:1}),n[4]||(n[4]=g("hr",{class:"mb-5"},null,-1)),e(v,{label:"Lote",modelValue:r(t).nuLote,"onUpdate:modelValue":n[0]||(n[0]=u=>r(t).nuLote=u),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(J,null,{default:l(()=>[e($,{style:{"background-color":"red",color:"white"},onClick:s},{default:l(()=>n[5]||(n[5]=[E(" Voltar ")])),_:1}),e($,{style:{"background-color":"green",color:"white"},loading:r(a),disabled:r(a),onClick:D},{loader:l(()=>[e(P,{indeterminate:"",color:"white",size:"24"})]),default:l(()=>[n[6]||(n[6]=E(" Importar "))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(L,{show:r(o),errorMessage:r(V),onClose:n[2]||(n[2]=u=>o.value=!1)},null,8,["show","errorMessage"])],64)}}},oe={class:"d-flex flex-column"},te=["onClick"],ae={key:0,style:{width:"30px",height:"30px"},src:Y,alt:"Visualizar",title:"Reativar"},se={key:1,src:Z,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Le={__name:"index",setup(B){const w=R(),p=d([]),i=d(!1),m=d(!1),b=`${w.public.managemant}/selos`,o=I({dt_compra:"",numero:"",lote_compra:"",sequencia:"",sigla:""}),V=[{title:"Data de compra",value:"dt_compra"},{title:"Selo",value:"numero"},{title:"Valor de compra",value:"lote_compra"}],C=async()=>{m.value=!0;try{const{data:a,error:t,status:f}=await M(b,{method:"GET"},"$g9WNETx7rH");f.value==="success"?p.value=Array.isArray(a.value)?a.value.map(s=>({...s,dt_compra:s.dt_compra?Q(s.dt_compra,"dd/mm/yyyy"):null})):[]:console.error(t)}catch(a){console.error("Erro ao buscar selos:",a)}finally{m.value=!1}},x=K(()=>p.value.filter(a=>(!o.dt_compra||a.dt_compra.toLowerCase().includes(o.dt_compra.toLowerCase()))&&(!o.numero||a.numero.toLowerCase().includes(o.numero.toLowerCase()))&&(!o.lote_compra||a.lote_compra.toLowerCase().includes(o.lote_compra.toLowerCase()))&&(!o.sequencia||a.sequencia.toLowerCase().includes(o.sequencia.toLowerCase()))&&(!o.sigla||a.sigla.toLowerCase().includes(o.sigla.toLowerCase()))));return C(),(a,t)=>{const f=ee;return r(m)?(_(),N(P,{key:0,class:"d-flex justify-center align-center",indeterminate:"",size:"64",style:{position:"absolute",top:"40%",left:"50%"}})):(_(),N(z,{key:1,class:"mt-5"},{default:l(()=>[g("div",oe,[e($,{class:"mb-10 mt-auto align-self-end",color:"green",size:"large",onClick:t[0]||(t[0]=s=>i.value=!0)},{default:l(()=>t[5]||(t[5]=[E(" Importar Selos TJ ")])),_:1})]),e(A,{class:"mb-4",style:{gap:"10rem"}},{default:l(()=>[e(y,{cols:"12",md:"2"},{default:l(()=>[e(v,{modelValue:r(o).dt_compra,"onUpdate:modelValue":t[1]||(t[1]=s=>r(o).dt_compra=s),label:"Data de Compra","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:l(()=>[e(v,{modelValue:r(o).numero,"onUpdate:modelValue":t[2]||(t[2]=s=>r(o).numero=s),label:"Selo","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:l(()=>[e(v,{modelValue:r(o).lote_compra,"onUpdate:modelValue":t[3]||(t[3]=s=>r(o).lote_compra=s),label:"Valor de Compra","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(X,{density:"compact",headers:V,items:r(x),"item-key":"selo"},{"item.actions":l(({item:s})=>[g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:D=>a.deleteObservacao(s),title:"Deletar Observação"},[s.excluido?(_(),h("img",ae)):(_(),h("img",se))],8,te)]),_:1},8,["items"]),e(f,{show:r(i),onClose:t[4]||(t[4]=s=>i.value=!1)},null,8,["show"])]),_:1}))}}};export{Le as default};
