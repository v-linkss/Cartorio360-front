import{_ as pe}from"./gZBbaLrE.js";import{m as se,G as ue,J as re,r as s,H as fe,o as f,p as L,w as t,b as o,s as e,V as ie,v as H,d as X,K as B,q as ne,u as R,z as Ue,n as me,a as T,c as N,O as Je,y as Le,P as Be,F as $e,g as Ve,Q as Ce,t as ye,B as be}from"./BOL4noSq.js";import{u as b}from"./TzX8YZO0.js";import{V as I}from"./bqpzMvxx.js";import{V as J}from"./DQU5PUT0.js";import{V as ce}from"./BRVU7TxM.js";import{V as ve}from"./Cl_P9YfM.js";import{_ as Ye}from"./B-MW_edR.js";import{_ as We,a as Ze,b as Qe,T as Xe,W as Ge,S as He,D as ze,c as Ke,d as eo,e as oo,f as to}from"./iXGMLIb4.js";import{_ as ao,r as Se}from"./BtDMyT_G.js";import{_ as Ae}from"./Ds1k55_2.js";import{_ as _e}from"./BVz1G1IN.js";import{_ as so}from"./CGmexNvx.js";import{_ as ro}from"./CJWoGetl.js";import{_ as he,a as xe}from"./DJvq3mCv.js";import{V as we}from"./C5FAYfot.js";import{_ as Te}from"./BzreZzC5.js";import{V as Ee,c as no}from"./CPO4BRHb.js";import{c as Pe,r as De,u as Me}from"./Bni1fX-8.js";import{f as ke}from"./B0IxRygJ.js";import{V as lo}from"./BTXPcqnv.js";const et={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(oe){const y=oe,{$toast:E}=se(),h=ne(),u=ue(),d=re(),_=`${h.public.managemant}/updateAtos`,x=s(y.item_situacoes),Z=s(d.query.origem==="vizualizar"),P=fe({dt_abertura:y.item_dados[0].dt_abertura||null,status:y.item_dados[0].status||null,mne:y.item_dados[0].mne||null});async function Q(){const{data:z,error:A,status:q}=await b(`${_}/${d.query.ato_id}`,{method:"PUT",body:{status:P.status,mne:P.mne,dt_abertura:P.dt_abertura}},"$EIT5jtTUdX");q.value==="success"&&E.success("Ato Atualizado com sucesso")}const V=()=>{const z=d.query.origem||"criar",A=d.query.id;z==="atualizar"||z==="vizualizar"?u.push(`/os/atualizar/${A}`):u.push("/os/criar-registro")};return(z,A)=>{const q=pe;return f(),L(ve,null,{default:t(()=>[o(I,{class:"mt-5"},{default:t(()=>[o(J,{cols:"3"},{default:t(()=>[o(ce,{label:"Situação",modelValue:e(P).status,"onUpdate:modelValue":A[0]||(A[0]=v=>e(P).status=v),items:e(x),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),o(I,null,{default:t(()=>[o(J,{cols:"5"},{default:t(()=>[o(ie,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:e(P).mne,"onUpdate:modelValue":A[1]||(A[1]=v=>e(P).mne=v)},null,8,["modelValue"])]),_:1})]),_:1}),o(I,null,{default:t(()=>[o(J,{cols:"2"},{default:t(()=>[o(ie,{modelValue:e(P).dt_abertura,"onUpdate:modelValue":A[2]||(A[2]=v=>e(P).dt_abertura=v),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),o(I,{class:"mb-3"},{default:t(()=>[o(q,{onClick:V},{default:t(()=>[o(H,{size:"large",color:"red"},{default:t(()=>A[3]||(A[3]=[X("Voltar")])),_:1})]),_:1}),e(Z)?B("",!0):(f(),L(H,{key:0,class:"ml-10",onClick:Q,size:"large",color:"green"},{default:t(()=>A[4]||(A[4]=[X("Atualizar")])),_:1}))]),_:1})]),_:1})}}},io={key:0},co=["onClick"],uo={key:0,style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar"},mo={key:1,style:{width:"30px",height:"30px"},src:so,alt:"Visualizar"},po=["onClick"],fo=["onClick"],vo={key:0,style:{width:"30px",height:"30px"},src:he,alt:"Visualizar",title:"Reativar"},yo={key:1,src:xe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},_o=["onClick"],ot={__name:"Partes",async setup(oe){let y,E;const h=ue(),u=re(),d=ne(),{$toast:_}=se(),x=`${d.public.managemant}/pesquisarPessoas`,Z=`${d.public.managemant}/listarPapeis`,P=`${d.public.managemant}/createAtosPessoa`,Q=`${d.public.managemant}/updateAtosPessoa`,V=`${d.public.managemant}/getAtosPessoaById`,z=`${d.public.managemant}/download`,A=s(R("user-data").value.cartorio_token),q=s(u.query.origem==="vizualizar"),v=s([]),C=s({}),S=s([]),U=s([]),$=s(!1),D=s(!1),m=s(!1),j=s(!1),K=s(null),w=s(null),O=s(null),G=s(null),r=s(null),i=s(u.query.tipo_ato_token),n=s(null),c=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],l=fe({papeis:null,nome:null,pessoa:null,documento:null});Ue(()=>{var g;return((g=l.pessoa)==null?void 0:g.link_ficha)||!1});const{data:M}=([y,E]=me(()=>b(Z,{method:"POST",body:{tipo_ato_token:u.query.tipo_ato_token}},"$acoiTIUp00")),y=await y,E(),y);U.value=M.value;const a=async()=>{const{data:g}=await b(`${V}/${u.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),ee=(de=>de.map(te=>({...te,pessoa:{...te.pessoa,documento:te.pessoa.doc_identificacao},papel:{...te.partes_tipos}})))(g.value);S.value=ee};a();async function k(){try{const{data:g,error:p}=await b(x,{method:"POST",body:{cartorio_token:A.value,documento:l.documento,nome:l.nome}},"$pr30MyPXfY");g.value.length>0?(v.value=g.value,l.pessoa=v.value[0]):v.value=[]}catch(g){console.error("Erro na requisição",g)}}const Y=()=>{D.value=!0},W=async()=>{await a()},le=async()=>{await a()},Oe=async()=>{const g={pessoa:l.pessoa,papel:U.value.find(ae=>ae.id===l.papeis),representante:{nome:null}},p=await b(`${V}/${u.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const ae of p.data.value)if(ae.pessoa_id===l.pessoa.id&&ae.ato_id===Number(u.query.ato_id)&&ae.tipo_parte_id===l.papeis){_.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:ee,error:de,status:te}=await b(P,{method:"POST",body:{ato_id:Number(u.query.ato_id),pessoa_id:l.pessoa.id,tipo_parte_id:l.papeis,user_id:R("user-data").value.usuario_id}},"$18isAgOJxG");te.value==="success"?(g.id=ee.value.id,_.success("Pessoa Registrada com Sucesso!"),S.value.push(g)):_.error(de.value.message)},qe=async g=>{m.value=!0;const{data:p}=await b(z,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:g.pessoa.link_ficha}},"$hmDzSF3F61");n.value=p.value,C.value=g.pessoa},Re=g=>{const p=S.value.filter(ee=>ee.pessoa.id!==g.pessoa.id).map(ee=>({id:ee.pessoa.id,nome:ee.pessoa.nome}));O.value=g.id,K.value=p,$.value=!0,w.value=g.pessoa.nome,r.value=g.pessoa.id},je=g=>{j.value=!0,G.value=g.id,w.value=g.pessoa.nome};async function Fe(g){g.excluido=!g.excluido;try{await b(`${Q}/${g.id}`,{method:"PUT",body:JSON.stringify({excluido:g.excluido})},"$l09I6nLRfk")}catch(p){console.error("Erro ao excluir pessoa:",p)}}const Ne=()=>{const g=u.query.origem||"criar",p=u.query.id;g==="atualizar"||g==="vizualizar"?h.push(`/os/atualizar/${p}`):h.push("/os/criar-registro")};return(g,p)=>{const ee=Ye,de=Ze,te=Qe,ae=ao,Ie=pe;return f(),L(ve,null,{default:t(()=>[e(q)?B("",!0):(f(),L(I,{key:0,class:"mt-5"},{default:t(()=>[o(J,{cols:"3"},{default:t(()=>[o(ie,{label:"Documento",modelValue:e(l).documento,"onUpdate:modelValue":p[0]||(p[0]=F=>e(l).documento=F)},null,8,["modelValue"])]),_:1}),o(J,{cols:"4"},{default:t(()=>[o(ie,{label:"Pessoa",modelValue:e(l).nome,"onUpdate:modelValue":p[1]||(p[1]=F=>e(l).nome=F)},null,8,["modelValue"])]),_:1}),T("div",null,[T("img",{class:"mt-1",src:Ae,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:k})]),T("div",null,[T("img",{class:"mt-1 ml-2",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Y})])]),_:1})),e(q)?B("",!0):(f(),L(I,{key:1},{default:t(()=>[o(J,{cols:"4"},{default:t(()=>[o(ce,{label:"Selecione a Pessoa",modelValue:e(l).pessoa,"onUpdate:modelValue":p[2]||(p[2]=F=>e(l).pessoa=F),items:e(v),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),o(J,{cols:"3"},{default:t(()=>[o(ce,{label:"Papel",modelValue:e(l).papeis,"onUpdate:modelValue":p[3]||(p[3]=F=>e(l).papeis=F),items:e(U),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(q)?B("",!0):(f(),N("div",io,[T("img",{class:"mt-1",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Oe})]))]),_:1})),o(I,null,{default:t(()=>[o(J,null,{default:t(()=>[o(we,{style:{height:"465px"},headers:c,items:e(S)},{"item.actions":t(({item:F})=>[e(q)?B("",!0):(f(),L(I,{key:0},{default:t(()=>[T("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-1",onClick:ge=>qe(F),title:"Visualizar Ficha"},[F.pessoa.link_ficha?(f(),N("img",uo)):(f(),N("img",mo))],8,co),T("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ge=>je(F),class:"mr-1",title:"Alterar Papel"},p[8]||(p[8]=[T("img",{style:{width:"30px",height:"30px"},src:ro,alt:"Visualizar"},null,-1)]),8,po),T("div",{class:"mr-1",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ge=>Fe(F),title:"Deletar Pessoa"},[F.excluido?(f(),N("img",vo)):(f(),N("img",yo))],8,fo),T("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-1",onClick:ge=>Re(F),title:"Selecionar Representante"},p[9]||(p[9]=[T("img",{style:{width:"30px",height:"30px"},src:We,alt:"Visualizar"},null,-1)]),8,_o)]),_:2},1024))]),_:1},8,["items"])]),_:1})]),_:1}),o(ee,{show:e(D),onClose:p[4]||(p[4]=F=>D.value=!1)},null,8,["show"]),o(de,{representante_nome:e(w),representantes:e(K),ato_id:e(O),show:e($),onClose:p[5]||(p[5]=F=>$.value=!1),onUpdateRepresentante:le},null,8,["representante_nome","representantes","ato_id","show"]),o(te,{representante_nome:e(w),ato_token:e(i),ato_id:e(G),show:e(j),onClose:p[6]||(p[6]=F=>j.value=!1),onUpdatePapel:W},null,8,["representante_nome","ato_token","ato_id","show"]),e(m)?(f(),L(ae,{key:2,show:e(m),"link-view":e(n),"pessoa-obj":e(C),"is-view":!0,onClose:p[7]||(p[7]=F=>m.value=!1)},null,8,["show","link-view","pessoa-obj"])):B("",!0),o(I,null,{default:t(()=>[o(Ie,{onClick:Ne},{default:t(()=>[o(H,{size:"large",color:"red"},{default:t(()=>p[10]||(p[10]=[X("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},go={key:0,class:"loading-overlay"},bo="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",tt={__name:"Minuta",emits:["page","doc"],setup(oe,{emit:y}){Je("DocumentEditorContainer",[Xe,Ge,He]);const E=ne(),{$toast:h}=se(),u=ue(),d=re(),_=y;Se(`${E.public.docEditor}`);const x=`${E.public.managemant}/download`,Z=`${E.public.managemant}/atos/files`,P=`${E.public.managemant}/subitituirModelo`,Q=`${E.public.managemant}/upload`,V=s(null),z=s(!1),A=s("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),q=s(d.query.origem==="vizualizar"),v=s(!1),C=async r=>{try{const i=await fetch(r);if(!i.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await i.blob()}catch(i){return console.error(i),null}},S=async()=>{try{const{data:r}=await b(`${Z}/${d.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return r.value.link_ato}catch(r){console.error("Erro ao carregar o documento:",r),h.error(r)}},U=async()=>{v.value=!0;try{const r=await S(),{data:i,status:n}=await b(x,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:r}},"$dvNFfvmIJC"),c=i.value,l=await C(c);if(l){const M=new FileReader;M.onload=()=>{const a=M.result;V.value.ej2Instances.documentEditor.open(a),_("doc",a)},M.readAsText(l)}}catch{console.error("Erro ao carregar o documento.")}finally{v.value=!1}},$=async()=>{const r=V.value.ej2Instances.documentEditor;console.log(r.pageCount);const i=await r.saveAsBlob("Sfdt"),n=new FileReader;n.onload=()=>{const c=n.result,M=V.value.ej2Instances.documentEditor.pageCount;_("page",M),_("doc",c)},n.readAsText(i)},D=async()=>{v.value=!0;try{const i=await V.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),n=new FormData;n.append("file",i,"anexo.sfdt"),n.append("cartorio_token",R("user-data").value.cartorio_token),n.append("token",d.query.ato_token_edit),n.append("tipo","ato_minuta");const{data:c,status:l}=await b(Q,{method:"POST",body:n},"$xv11VtUdMy");if(l.value==="success"){h.success("Documento enviado!");const a=V.value.ej2Instances.documentEditor.pageCount;$(),_("page",a)}else h.error("Erro ao enviar documento para o sistema.")}catch(r){h.error("Erro ao salvar documento."),console.error(r)}finally{v.value=!1}},m=()=>{z.value=!1,j()},j=async()=>{O(!0);try{await K(),O(!0);const{data:r,status:i}=await b(P,{method:"POST",body:{ato_token:d.query.ato_token_edit}},"$zyzWHTXTBW");r.value&&w(r.value)}catch(r){console.error("Erro ao gerar a minuta:",r),h.error("Ocorreu um erro ao gerar a minuta.")}finally{O(!1)}},K=async()=>{try{const{data:r}=await b(x,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),i=await C(r.value);if(i){const n=new FileReader;n.onload=()=>{const c=n.result;V.value.ej2Instances.documentEditor.open(c),_("doc",c)},n.readAsText(i)}}catch(r){console.error("Erro ao carregar o modelo de minuta:",r)}},w=r=>{const i=V.value.ej2Instances.documentEditor,n=c=>{for(const[l,M]of Object.entries(c))if(/^<<.+>>$/.test(l))try{i.search.findAll(l),i.search.searchResults.length>0&&i.search.searchResults.replaceAll(M)}catch(a){console.error(`Erro ao substituir o marcador ${l}:`,a)}else if(l==="partes"&&Array.isArray(M)&&M.length>0)for(const a of M)typeof a=="object"&&n(a)};n(r)},O=r=>{v.value=r},G=()=>{const r=d.query.origem||"criar",i=d.query.id;r==="atualizar"||r==="vizualizar"?u.push(`/os/atualizar/${i}`):u.push("/os/criar-registro")};return Le(async()=>{await U(),$()}),(r,i)=>{const n=pe,c=Te;return f(),N($e,null,[o(e(ze),{height:"900px",ref_key:"documentEditorContainer",ref:V,serviceUrl:bo,enableToolbar:!0,enableWordExport:!0},null,512),e(v)?(f(),N("div",go,[o(Be,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):B("",!0),o(I,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[o(n,{class:"mr-4"},{default:t(()=>[o(H,{size:"large",onClick:G,color:"red"},{default:t(()=>i[2]||(i[2]=[X("Voltar")])),_:1})]),_:1}),e(q)?B("",!0):(f(),L(H,{key:0,size:"large",color:"green",onClick:D,disabled:e(v)},{default:t(()=>i[3]||(i[3]=[X("Atualizar")])),_:1},8,["disabled"])),e(q)?B("",!0):(f(),L(H,{key:1,class:"ml-4",size:"large",color:"blue",onClick:i[0]||(i[0]=l=>z.value=!0)},{default:t(()=>i[4]||(i[4]=[X("Gerar Minuta")])),_:1}))]),_:1}),o(c,{onConfirm:m,condMessage:e(A),show:e(z),onClose:i[1]||(i[1]=l=>z.value=!1)},null,8,["condMessage","show"])],64)}}},ko=["innerHTML"],at={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(oe){let y,E;const h=oe,u=ne();Se(`${u.public.docEditor}`);const{$toast:d}=se(),_=ue(),x=re(),Z=`${u.public.managemant}/download`,P=`${u.public.managemant}/atos/files`,Q=`${u.public.managemant}/lavrarAto`,V=`${u.public.managemant}/listarEscrevente`,z=s(R("user-data").value.cartorio_token),A=R("auth_token").value,q=s("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),v=s(!1),C=s(null),S=s(null),U=s(x.query.origem==="vizualizar"),$=s(null),D=s([]),m=fe({escrevente:null}),j=async n=>{try{const c=await fetch(n);if(!c.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await c.blob()}catch(c){return console.error(c),null}},K=async()=>{try{const{data:n}=await b(`${P}/${x.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return n.value.link_ato}catch(n){console.error("Erro ao carregar o documento:",n),d.error(n)}},w=async()=>{try{const n=await K(),{data:c,status:l}=await b(Z,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:n}},"$7ljqltMqa0"),M=c.value,a=await j(M);if(a){const k=new FileReader;k.onload=()=>{const Y=k.result;$.value.ej2Instances.documentEditor.open(Y)},k.readAsText(a)}}catch{d.error("Erro ao carregar o documento.")}};w();const O=async()=>{const n=$.value.ej2Instances.documentEditor.pageCount;try{const{data:c,status:l}=await b(Q,{method:"POST",body:{ato_token:x.query.ato_token_edit,qtd_paginas:n,escrevente_token:m.escrevente,usuario_token:A,cartorio_token:z}},"$OWxZSQkyX8");l.value==="success"?(C.value=c.value,S.value=c.value[0].selo,d.success("Ato lavrado com sucesso!")):d.error("Falha ao lavrar o ato.")}catch{d.error("Erro ao conectar com o servidor.")}},G=()=>{v.value=!1,O()},{data:r}=([y,E]=me(()=>b(V,{method:"POST",body:{cartorio_token:z}},"$sMqfUUQcBM")),y=await y,E(),y);D.value=r.value[0].func_json_escreventes;const i=()=>{const n=x.query.origem||"criar",c=x.query.id;n==="atualizar"&&(n==="atualizar"||n==="vizualizar"?_.push(`/os/atualizar/${c}`):_.push("/os/criar-registro"))};return Ve(()=>h.document,(n,c)=>{w()}),(n,c)=>{const l=Te;return f(),N($e,null,[o(I,null,{default:t(()=>[o(J,null,{default:t(()=>[o(e(ze),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:$,height:"850px",width:"850px"},null,512)]),_:1}),e(U)?B("",!0):(f(),L(J,{key:0},{default:t(()=>[o(ce,{class:"mt-15",label:"Tabelião/escrevente",modelValue:e(m).escrevente,"onUpdate:modelValue":c[0]||(c[0]=M=>e(m).escrevente=M),items:e(D),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),T("img",{onClick:c[1]||(c[1]=M=>v.value=!0),style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Ke}),e(C)?(f(),L(Ee,{key:0,width:"360"},{default:t(()=>[o(I,null,{default:t(()=>[o(J,null,{default:t(()=>[o(Ce,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[o(J,null,{default:t(()=>[X(" Livro: "+ye(e(C)[0].livro_numero),1)]),_:1}),o(J,null,{default:t(()=>[X(" Protocolo: "+ye(e(C)[0].protocolo?e(C)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),o(J,null,{default:t(()=>[o(Ce,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:t(()=>[X(" Folhas : "+ye(e(C)[0].pagina_inicial)+" A "+ye(e(C)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),T("div",{style:{"margin-left":"10px","padding-bottom":"20px","margin-top":"-10px"},innerHTML:e(S)},null,8,ko)]),_:1})):B("",!0)]),_:1}))]),_:1}),o(H,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:i},{default:t(()=>c[3]||(c[3]=[X("Voltar")])),_:1}),o(l,{show:e(v),condMessage:e(q),onClose:c[2]||(c[2]=M=>v.value=!1),onConfirm:G},null,8,["show","condMessage"])],64)}}},Ao=["onClick"],ho={key:0,style:{width:"30px",height:"30px"},src:he,alt:"Visualizar",title:"Reativar"},xo={key:1,src:xe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},st={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(oe){let y,E;const h=ue(),u=re(),d=ne(),{$toast:_}=se(),x=`${d.public.managemant}/listarEscrevente`;`${d.public.managemant}`;const Z=`${d.public.managemant}/atos_observacao`,P=`${d.public.managemant}/atos_observacao`,Q=`${d.public.managemant}/atos_observacao`,V=s(R("user-data").value.cartorio_token),z=s(u.query.origem==="vizualizar"),A=s([]),q=s([]),v=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],C=fe({observacao:""}),S={observacao:{required:Pe.withMessage("O campo é obrigatório",De)}},U=Me(S,C),{data:$}=([y,E]=me(()=>b(`${Q}/${u.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),y=await y,E(),y);Array.isArray($.value)?A.value=$.value.map(w=>({...w,created:ke(w.created,"dd/mm/yyyy hh:mm")})):$.value&&typeof $.value=="object"&&(A.value=[{...$.value,created:ke($.value.created,"dd/mm/yyyy hh:mm")}]);async function D(){if(C.observacao.trim()===""){_.error("O campo de observação está vazio.");return}if(await U.value.$validate()){const{data:w,error:O,status:G}=await b(Z,{method:"POST",body:{ato_id:Number(u.query.ato_id),observacao:C.observacao,user_id:R("user-data").value.usuario_id}},"$gnHMo4uCXD");G.value==="success"&&(A.value.push({created:ke(w.value.created,"dd/mm/yyyy hh:mm"),observacao:w.value.observacao,id:w.value.id,escrevente:R("user-data").value.nome}),C.observacao="",_.success("Observação registrada com sucesso"))}else _.error("Preencha os campos obrigatórios.")}async function m(w){w.excluido=!w.excluido;try{await b(`${P}/${w.id}`,{method:"PUT",body:JSON.stringify({excluido:w.excluido})},"$sP9AKdd3Ky")}catch(O){console.error("Erro ao excluir observação:",O)}}const{data:j}=([y,E]=me(()=>b(x,{method:"POST",body:{cartorio_token:V}},"$HL9pndqGh0")),y=await y,E(),y);q.value=j.value[0].func_json_escreventes;const K=()=>{const w=u.query.origem||"criar",O=u.query.id;w==="atualizar"||w==="vizualizar"?h.push(`/os/atualizar/${O}`):h.push("/os/criar-registro")};return(w,O)=>{const G=pe;return f(),L(ve,null,{default:t(()=>[z.value?B("",!0):(f(),L(I,{key:0,class:"mt-5"},{default:t(()=>[o(ie,{label:"Observação",modelValue:C.observacao,"onUpdate:modelValue":O[0]||(O[0]=r=>C.observacao=r),required:"","error-messages":e(U).observacao.$errors.length>0?e(U).observacao.$errors.map(r=>r.$message):[],onBlur:e(U).observacao.$touch,onInput:e(U).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),T("div",null,[T("img",{class:"btn-pointer ml-2",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:D})])]),_:1})),o(I,null,{default:t(()=>[o(J,null,{default:t(()=>[o(we,{style:{height:"465px"},headers:v,items:A.value},{"item.actions":t(({item:r})=>[T("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:i=>m(r),title:"Deletar Observação"},[r.excluido?(f(),N("img",ho)):(f(),N("img",xo))],8,Ao)]),_:1},8,["items"])]),_:1})]),_:1}),o(I,null,{default:t(()=>[o(G,{onClick:K},{default:t(()=>[o(H,{size:"large",color:"red"},{default:t(()=>O[1]||(O[1]=[X("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},wo="data:image/png;base64,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",Co={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:oo,alt:"Criar"},$o={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:to,alt:"Criar"},Vo={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:wo,alt:"Criar"},zo=["onClick"],So=["onClick"],To=["onClick"],Eo={key:0,style:{width:"30px",height:"30px"},src:he,alt:"Visualizar",title:"Reativar"},Po={key:1,src:xe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},rt={__name:"Anexos",async setup(oe){let y,E;const h=ne(),{$toast:u}=se(),d=ue(),_=re(),x=s(_.query.origem==="vizualizar"),Z=`${h.public.biometria}/run-scanner`,P=`${h.public.managemant}/atos_anexos`,Q=`${h.public.managemant}/atos_anexos`,V=`${h.public.managemant}/download`,z=`${h.public.managemant}/atos_anexos`,A=`${h.public.managemant}/upload`,q=s(!1),v=s(null),C=s([]);R("pessoa_token");const S=fe({descricao:"",fileEvent:null}),U={descricao:{required:Pe.withMessage("O campo é obrigatório",De)}},$=Me(U,S,{$autoDirty:!0}),D=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:m}=([y,E]=me(()=>b(`${z}/${_.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),y=await y,E(),y);C.value=m.value;async function j(){try{await K(),await w()}catch(a){console.error("Erro ao executar scanner ou listar arquivos:",a)}}async function K(){try{const{data:a}=await b(Z,{method:"GET"},"$KttjFhHivJ")}catch(a){u.error("Erro ao acionar o scanner:",a)}}async function w(){try{const{data:a,status:k}=await b("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:_.query.ato_token_edit,cartorio_token:R("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(a){console.error("Erro ao enviar o arquivo:",a)}}async function O(){try{const a=document.createElement("input");a.type="file",a.accept="*/*",a.onchange=async k=>{S.fileEvent=k,k.target.files[0]&&(v.value=!0)},a.click()}catch(a){console.error("Erro ao abrir o explorador de arquivos:",a)}}const G=async()=>{q.value=!0};function r(a){return a?!0:(v.value=!1,!1)}const i=async a=>{if(!S.fileEvent||!S.fileEvent.target.files.length){u.error("Nenhum arquivo selecionado.");return}const k=S.fileEvent.target.files[0],Y=new FormData;Y.append("file",k),Y.append("cartorio_token",R("user-data").value.cartorio_token),Y.append("token",a),Y.append("tipo","ato_anexo");try{const W=await b(A,{method:"POST",body:Y},"$KDhIYzGKzM");u.success("Anexo registrado com sucesso!")}catch{u.error("Erro ao enviar o arquivo.")}},n=async()=>{if($.value.$touch(),!$.value.$invalid&&r(S.fileEvent)){const{data:a,error:k,status:Y}=await b(P,{method:"POST",body:{ato_id:_.query.ato_id,descricao:S.descricao,user_id:R("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$cdoFBGO0Ti");Y.value==="success"&&(u.success("Anexo registrado com sucesso!"),C.value.push(a.value),i(a.value.token))}};async function c(a){a.excluido=!a.excluido;try{await b(`${Q}/${a.id}`,{method:"PUT",body:JSON.stringify({excluido:a.excluido})},"$WLSrgYRoHq")}catch(k){console.error("Erro ao excluir pessoa:",k)}}async function l(a){try{const k=await b(`${V}`,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:a.link}},"$NdgRjioizH"),W=await(await fetch(k.data.value)).blob(),le=URL.createObjectURL(W);window.open(le,"_blank")}catch(k){console.error("Erro ao excluir pessoa:",k)}}const M=()=>{const a=_.query.origem||"criar",k=_.query.id;a==="atualizar"||a==="vizualizar"?d.push(`/os/atualizar/${k}`):d.push("/os/criar-registro")};return(a,k)=>{const Y=pe;return f(),L(ve,null,{default:t(()=>[o(I,null,{default:t(()=>[o(J,{cols:"5",class:"mt-2"},{default:t(()=>[e(x)?B("",!0):(f(),L(ie,{key:0,modelValue:e(S).descricao,"onUpdate:modelValue":[k[0]||(k[0]=W=>e(S).descricao=W),e($).descricao.$touch],"error-messages":e($).descricao.$errors.map(W=>W.$message),onBlur:e($).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"]))]),_:1}),e(x)?B("",!0):(f(),N("div",{key:0,onClick:j,title:"Escanear"},k[1]||(k[1]=[T("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:eo,alt:"Escanear"},null,-1)]))),e(x)?B("",!0):(f(),N("div",{key:1,onClick:O,title:"Criar"},[e(v)===!1?(f(),N("img",Co)):e(v)===!0?(f(),N("img",$o)):(f(),N("img",Vo))])),e(x)?B("",!0):(f(),N("div",{key:2,onClick:n,title:"Criar"},k[2]||(k[2]=[T("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:_e,alt:"Criar"},null,-1)])))]),_:1}),o(we,{headers:D,items:e(C),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:W})=>[o(I,null,{default:t(()=>[T("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:le=>G(W),title:"Visualizar Anexo"},[T("img",{style:{width:"30px",height:"30px"},onClick:le=>l(W),src:Ae,alt:"Visualizar"},null,8,So)],8,zo),T("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:le=>c(W),title:"Deletar Pessoa"},[W.excluido?(f(),N("img",Eo)):(f(),N("img",Po))],8,To)]),_:2},1024)]),_:1},8,["items"]),o(Y,{onClick:M},{default:t(()=>[o(H,{size:"large",color:"red"},{default:t(()=>k[3]||(k[3]=[X("Voltar")])),_:1})]),_:1})]),_:1})}}},nt={__name:"TiposAtos",props:{show:Boolean,servicos:Array,tiposAtos:Array},emits:["close","update-ato"],setup(oe,{emit:y}){const h=s(oe.show),{$toast:u}=se(),d=re(),_=s(""),x=s(""),Z=ne(),P=R("auth_token").value,Q=s(R("user-data").value.cartorio_token).value,V=s([]),z=s([]),A=y,q=`${Z.public.managemant}/updateAtos`,v=`${Z.public.managemant}/tipoAtos`,C=async()=>{const{data:D}=await b(v,{method:"POST",body:{usuario_token:P,cartorio_token:Q}},"$6VlNS7ylT6");V.value=D.value,V.value.length>0&&(_.value=V.value[0])},S=async D=>{const{data:m}=await b(v,{method:"POST",body:{usuario_token:P,cartorio_token:Q,servico_token:D}},"$pRqAaiCpuA");z.value=m.value},U=async()=>{const{data:D,status:m}=await b(`${q}/${d.query.ato_id}`,{method:"PUT",body:{ato_tipo_id:x.value.id}},"$Qxfq8aWnXP");m.value==="success"&&(u.success("Tipo de ato atualizado com Sucesso!"),A("update-ato",{descricao:`${_.value.descricao} - ${x.value.descricao}`,usaImoveisParams:x.value.usa_imoveis}),$())},$=()=>{h.value=!1,A("close")};return Ve(_,async D=>{D&&(await S(D.token),x.value=z.value.length>0?z.value[0]:null)}),C(),(D,m)=>(f(),L(lo,{persistent:"",modelValue:e(h),"onUpdate:modelValue":m[3]||(m[3]=j=>be(h)?h.value=j:null),"max-width":"500"},{default:t(()=>[o(Ee,null,{default:t(()=>[o(ve,null,{default:t(()=>[o(I,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:t(()=>m[4]||(m[4]=[T("h1",{class:"ml-4"},"Tipos de Atos",-1)])),_:1}),m[5]||(m[5]=T("hr",{class:"mb-5"},null,-1)),o(ce,{"item-title":"descricao","item-value":"token",class:"mb-5",label:"Selecione o Serviço",modelValue:e(_),"onUpdate:modelValue":m[0]||(m[0]=j=>be(_)?_.value=j:null),items:e(V),"return-object":""},null,8,["modelValue","items"]),o(ce,{"item-title":"descricao","item-value":"id",class:"mb-5",label:"Selecione o Tipo de Ato",modelValue:e(x),"onUpdate:modelValue":m[1]||(m[1]=j=>be(x)?x.value=j:null),items:e(z),"return-object":""},null,8,["modelValue","items"])]),_:1}),o(no,null,{default:t(()=>[o(H,{style:{"background-color":"red",color:"white"},onClick:$},{default:t(()=>m[6]||(m[6]=[X("Voltar")])),_:1}),o(H,{style:{"background-color":"green",color:"white"},onClick:m[2]||(m[2]=j=>U())},{default:t(()=>m[7]||(m[7]=[X("Salvar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{nt as _,et as a,ot as b,tt as c,at as d,st as e,rt as f};
