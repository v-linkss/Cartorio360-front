import{_ as oe}from"./CpF4ghwP.js";import{c as me,r as pe,u as _e}from"./7_cBxn72.js";import{g as ze,m as H,O as Q,u as X,r as i,n as C,p as ae,H as te,o as A,y as K,w as o,b as e,x as t,V as Y,I as G,d as F,A as Z,K as Me,a as f,c as U,z as ve,Q as De,R as Re,F as be,S as he,t as se}from"./7QQ78_SJ.js";import{u as b}from"./CvJ5mIUm.js";import{V as z}from"./kmWoQJrD.js";import{V as I}from"./DGCSf-V-.js";import{V as re}from"./BJdbowPo.js";import{V as le}from"./DywUR6NN.js";import{_ as Ie}from"./Dhhrotwz.js";import{_ as je,a as Be,b as Ne,T as Ue,W as Fe,D as ke,c as Le,e as We,f as Ge,d as Je}from"./BlwvEqP8.js";import{_ as Ke,r as xe}from"./BlTdTwly.js";import{_ as de}from"./BKZiS51m.js";import{_ as ne}from"./BVz1G1IN.js";import{_ as Ye}from"./CBmuzA38.js";import{_ as fe,a as ge}from"./DJvq3mCv.js";import{V as ye}from"./DAPZDfxj.js";import{_ as He}from"./C206BADE.js";import{V as Qe}from"./r7kzVClg.js";import{f as Xe}from"./B0IxRygJ.js";const It={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_tipo_id:{type:Number}},emits:["saved"],async setup(L,{emit:y}){let g,_;const h=L;ze(()=>h.ato_tipo_id,r=>{$.value={id:r}});const V=y,k=H(),E=Q(),j=Z(),{$toast:N}=X(),W=`${j.public.managemant}/listarSituacoes`,S=`${j.public.managemant}/createAtos`;`${j.public.managemant}`;const P=i(C("user-data").value.cartorio_token),x=i(C("user-service").value.id).value||i(C("user-service").value).value,B=i([]),$=i(h.ato_tipo_id?{id:h.ato_tipo_id}:null),v=ae({dt_abertura:null,status:"EM EDIÇÃO",mne:null}),q={status:{required:me.withMessage("O campo é obrigatorio",pe)}},w=_e(q,v);async function M(){if(await w.value.$validate()){const{data:r,error:a,status:d}=await b(S,{method:"POST",body:{ato_tipo_id:$.value.id,cartorio_id:C("user-data").value.cartorio_id,ordemserv_id:x,status:v.status,dt_abertura:v.dt_abertura,mne:v.mne,user_id:C("user-data").value.usuario_id,user_alteracao_id:C("user-data").value.usuario_id}},"$9ZmTYsLk0K");d.value==="success"&&(N.success("Ato registrado com sucesso!"),V("saved",{id:r.value.id,token:r.value.token}))}else N.error("Preencha os campos obrigatorios.")}const{data:D}=([g,_]=te(()=>b(W,{method:"POST",body:{cartorio_token:P.value}},"$hyq5YcBEjF")),g=await g,_(),g);B.value=D.value;const c=()=>{const r=E.query.origem||"criar",a=E.query.id;r==="atualizar"?k.push(`/os/atualizar/${a}`):k.push("/os/criar-registro")};return(r,a)=>{const d=oe;return A(),K(le,null,{default:o(()=>[e(z,{class:"mt-5"},{default:o(()=>[e(I,{cols:"3"},{default:o(()=>[e(re,{label:"Situação",modelValue:t(v).status,"onUpdate:modelValue":a[0]||(a[0]=m=>t(v).status=m),items:t(B),"item-title":"descricao","item-value":"descricao",required:"","error-messages":t(w).status.$errors.map(m=>m.$message),onBlur:t(w).status.$touch,onInput:t(w).status.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1})]),_:1}),e(z,null,{default:o(()=>[e(I,{cols:"5"},{default:o(()=>[e(Y,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:t(v).mne,"onUpdate:modelValue":a[1]||(a[1]=m=>t(v).mne=m)},null,8,["modelValue"])]),_:1})]),_:1}),e(z,null,{default:o(()=>[e(I,{cols:"2"},{default:o(()=>[e(Y,{modelValue:t(v).dt_abertura,"onUpdate:modelValue":a[2]||(a[2]=m=>t(v).dt_abertura=m),type:"date",label:"Data Lavratura",disabled:"",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(z,{class:"mb-3"},{default:o(()=>[e(d,{onClick:c},{default:o(()=>[e(G,{size:"large",color:"red"},{default:o(()=>a[3]||(a[3]=[F("Voltar")])),_:1})]),_:1}),e(G,{class:"ml-10",onClick:M,size:"large",color:"green"},{default:o(()=>a[4]||(a[4]=[F("Salvar")])),_:1})]),_:1})]),_:1})}}},Ze=["onClick"],et=["onClick"],tt=["onClick"],ot={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},at={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},st=["onClick"],jt={__name:"Partes",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},async setup(L){let y,g;const _=L,h=H(),V=Q(),k=Z(),{$toast:E}=X(),j=`${k.public.managemant}/pesquisarPessoas`,N=`${k.public.managemant}/listarPapeis`,W=`${k.public.managemant}/download`,S=`${k.public.managemant}/createAtosPessoa`,P=`${k.public.managemant}/getAtosPessoaById`,x=`${k.public.managemant}/updateAtosPessoa`,B=i(C("user-data").value.cartorio_token),$=i([]),v=i({}),q=i([]),w=i([]),M=i(!1),D=i(!1),c=i(!1),r=i(!1),a=i(null),d=i(null),m=i(null),l=i(null);i(null);const p=i(null),R=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome",width:"30%"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome",width:"25%"},{value:"actions"}],s=ae({papeis:null,nome:null,pessoa:null,documento:null});Me(()=>{var u;return((u=s.pessoa)==null?void 0:u.link_ficha)||!1});const{data:J}=([y,g]=te(()=>b(N,{method:"POST",body:{tipo_ato_token:_.ato_token}},"$fFKndZhA4W")),y=await y,g(),y);w.value=J.value;async function ee(){try{const{data:u,error:n}=await b(j,{method:"POST",body:{cartorio_token:B.value,documento:s.documento,nome:s.nome}},"$o3ZL1rvYrY");u.value.length>0?($.value=u.value,s.pessoa=$.value[0]):$.value=[]}catch(u){console.error("Erro na requisição",u)}}const $e=()=>{D.value=!0},we=u=>{q.value=q.value.map(n=>n.id===m.value?{...n,papel:{...n.papel,descricao:u}}:n)},Ce=u=>{const n=q.value.find(T=>T.pessoa.id===l.value);n.representante.nome=u},Ve=async()=>{const u={pessoa:s.pessoa,papel:w.value.find(T=>T.id===s.papeis),representante:{nome:null}},n=await b(`${P}/${_.ato_id}`,{method:"GET"},"$kXSxUa4grs");for(const T of n.data.value)if(T.pessoa_id===s.pessoa.id&&T.ato_id===_.ato_id&&T.tipo_parte_id===s.papeis){E.error("Pessoa Já Registrada Com Esse Papel!");return}try{const{data:T,error:ie,status:ce}=await b(S,{method:"POST",body:{ato_id:Number(_.ato_id),pessoa_id:s.pessoa.id,tipo_parte_id:s.papeis,user_id:Number(C("user-data").value.usuario_id)}},"$So3qnQu7ek");ce.value==="success"?(u.id=T.value.id,E.success("Pessoa Registrada com Sucesso!"),q.value.push(u)):E.error(ie.value.message)}catch{E.error("Erro no servidor. Tente novamente.")}},Ee=async u=>{c.value=!0;const{data:n}=await b(W,{method:"POST",body:{bucket:C("user-data").value.cartorio_token,path:u.pessoa.link_ficha}},"$Q3kbIwtd9t");p.value=n.value,v.value=u.pessoa},Pe=u=>{const n=q.value.filter(T=>T.pessoa.id!==u.pessoa.id).map(T=>({id:T.pessoa.id,nome:T.pessoa.nome}));m.value=u.id,a.value=n,M.value=!0,d.value=u.pessoa.nome,l.value=u.pessoa.id},Ae=u=>{m.value=u.id,r.value=!0,d.value=u.pessoa.nome};async function Se(u){u.excluido=!u.excluido;try{await b(`${x}/${m.value}`,{method:"PUT",body:JSON.stringify({excluido:u.excluido})},"$9xStKwGd7o")}catch(n){console.error("Erro ao excluir pessoa:",n)}}const qe=()=>{const u=V.query.origem||"criar",n=V.query.id;u==="atualizar"?h.push(`/os/atualizar/${n}`):h.push("/os/criar-registro")};return(u,n)=>{const T=Ie,ie=Be,ce=Ne,Te=Ke,Oe=oe;return A(),K(le,null,{default:o(()=>[e(z,{class:"mt-5"},{default:o(()=>[e(I,{cols:"3"},{default:o(()=>[e(Y,{label:"Documento",modelValue:t(s).documento,"onUpdate:modelValue":n[0]||(n[0]=O=>t(s).documento=O)},null,8,["modelValue"])]),_:1}),e(I,{cols:"4"},{default:o(()=>[e(Y,{label:"Pessoa",modelValue:t(s).nome,"onUpdate:modelValue":n[1]||(n[1]=O=>t(s).nome=O)},null,8,["modelValue"])]),_:1}),f("div",null,[f("img",{class:"mt-3",src:de,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:ee})]),f("div",null,[f("img",{class:"mt-3 ml-2",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:$e})])]),_:1}),e(z,null,{default:o(()=>[e(I,{cols:"4"},{default:o(()=>[e(re,{label:"Selecione a Pessoa",modelValue:t(s).pessoa,"onUpdate:modelValue":n[2]||(n[2]=O=>t(s).pessoa=O),items:t($),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(I,{cols:"3"},{default:o(()=>[e(re,{label:"Papel",modelValue:t(s).papeis,"onUpdate:modelValue":n[3]||(n[3]=O=>t(s).papeis=O),items:t(w),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),f("div",null,[f("img",{class:"mt-3",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Ve})])]),_:1}),e(z,null,{default:o(()=>[e(I,null,{default:o(()=>[e(ye,{style:{height:"465px"},headers:R,items:t(q)},{"item.actions":o(({item:O})=>[e(z,null,{default:o(()=>[f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ue=>Ee(O),title:"Visualizar Ficha"},n[8]||(n[8]=[f("img",{style:{width:"30px",height:"30px"},src:de,alt:"Visualizar"},null,-1)]),8,Ze),f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ue=>Ae(O),class:"mr-2",title:"Alterar Papel"},n[9]||(n[9]=[f("img",{style:{width:"30px",height:"30px"},src:Ye,alt:"Visualizar"},null,-1)]),8,et),f("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ue=>Se(O),title:"Deletar Pessoa"},[O.excluido?(A(),U("img",ot)):(A(),U("img",at))],8,tt),f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ue=>Pe(O),title:"Selecionar Representante"},n[10]||(n[10]=[f("img",{style:{width:"30px",height:"30px"},src:je,alt:"Visualizar"},null,-1)]),8,st)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(T,{show:t(D),onClose:n[4]||(n[4]=O=>D.value=!1)},null,8,["show"]),e(ie,{representante_nome:t(d),representantes:t(a),ato_id:t(m),show:t(M),onClose:n[5]||(n[5]=O=>M.value=!1),onUpdateRepresentante:Ce},null,8,["representante_nome","representantes","ato_id","show"]),e(ce,{representante_nome:t(d),ato_token:_.ato_token,ato_id:t(m),show:t(r),onClose:n[6]||(n[6]=O=>r.value=!1),onUpdatePapel:we},null,8,["representante_nome","ato_token","ato_id","show"]),t(c)?(A(),K(Te,{key:0,show:t(c),"link-view":t(p),"pessoa-obj":t(v),"is-view":!0,onClose:n[7]||(n[7]=O=>c.value=!1)},null,8,["show","link-view","pessoa-obj"])):ve("",!0),e(z,null,{default:o(()=>[e(Oe,{onClick:qe},{default:o(()=>[e(G,{size:"large",color:"red"},{default:o(()=>n[11]||(n[11]=[F("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},rt={key:0,class:"loading-overlay"},nt="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Bt={__name:"Minuta",props:{ato_token:{type:String,required:!0}},emits:["page","doc"],setup(L,{emit:y}){const g=L;De("DocumentEditorContainer",[Ue,Fe]);const _=Z(),{$toast:h}=X(),V=H(),k=Q(),E=y;xe(`${_.public.docEditor}`);const j=`${_.public.managemant}/upload`,N=`${_.public.managemant}/subitituirModelo`,W=`${_.public.managemant}/download`,S=i(null),P=i(!1),x=async c=>{try{const r=await fetch(c);if(!r.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await r.blob()}catch(r){return console.error(r),null}},B=async()=>{const r=await S.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),a=new FileReader;a.onload=()=>{const d=a.result;E("doc",d)},a.readAsText(r)},$=async()=>{P.value=!0;try{const r=await S.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),a=new FormData;a.append("file",r,"anexo.docx"),a.append("cartorio_token",C("user-data").value.cartorio_token),a.append("token",g.ato_token),a.append("tipo","ato_minuta");const{data:d,status:m}=await b(j,{method:"POST",body:a},"$071xxdqs20");if(m.value==="success"){h.success("Documento enviado!");const p=S.value.ej2Instances.documentEditor.pageCount;B(),E("page",p)}else h.error("Erro ao enviar documento para o sistema.")}catch(c){h.error("Erro ao salvar documento."),console.error(c)}finally{P.value=!1}},v=async()=>{M(!0);try{await q(),M(!0);const{data:c,status:r}=await b(N,{method:"POST",body:{ato_token:g.ato_token}},"$0ktpWliD4l");c.value&&w(c.value)}catch(c){console.error("Erro ao gerar a minuta:",c),h.error("Ocorreu um erro ao gerar a minuta.")}finally{M(!1)}},q=async()=>{try{const{data:c}=await b(W,{method:"POST",body:{bucket:C("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$jXVvQjEE6u"),r=await x(c.value);if(r){const a=new FileReader;a.onload=()=>{const d=a.result;S.value.ej2Instances.documentEditor.open(d),E("doc",d)},a.readAsText(r)}}catch(c){console.error("Erro ao carregar o modelo de minuta:",c),h.error("Falha ao carregar o modelo de minuta.")}},w=c=>{const r=S.value.ej2Instances.documentEditor,a=d=>{for(const[m,l]of Object.entries(d))if(/^<<.+>>$/.test(m))try{r.search.findAll(m),r.search.searchResults.length>0&&r.search.searchResults.replaceAll(l)}catch(p){console.error(`Erro ao substituir o marcador ${m}:`,p)}else if(m==="partes"&&Array.isArray(l)&&l.length>0)for(const p of l)typeof p=="object"&&a(p)};a(c)},M=c=>{P.value=c},D=()=>{const c=k.query.origem||"criar",r=k.query.id;c==="atualizar"?V.push(`/os/atualizar/${r}`):V.push("/os/criar-registro")};return(c,r)=>{const a=oe;return A(),U(be,null,[e(t(ke),{height:"900px",ref_key:"documentEditorContainer",ref:S,serviceUrl:nt,enableToolbar:!0,enableWordExport:!0},null,512),t(P)?(A(),U("div",rt,[e(Re,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):ve("",!0),e(z,{class:"ml-4 mt-4 mb-4"},{default:o(()=>[e(a,{class:"mr-4"},{default:o(()=>[e(G,{size:"large",onClick:D,color:"red"},{default:o(()=>r[0]||(r[0]=[F("Voltar")])),_:1})]),_:1}),e(G,{size:"large",color:"green",onClick:$,disabled:t(P)},{default:o(()=>r[1]||(r[1]=[F("Salvar")])),_:1},8,["disabled"]),e(G,{class:"ml-4",size:"large",color:"blue",onClick:v},{default:o(()=>r[2]||(r[2]=[F("Gerar Minuta")])),_:1})]),_:1})],64)}}},lt=["innerHTML"],Nt={__name:"Livro",props:{ato_token:{type:String,required:!0},pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(L){let y,g;const _=L,h=Z();xe(`${h.public.docEditor}`);const{$toast:V}=X(),k=H(),E=Q(),j=`${h.public.managemant}/listarEscrevente`,N=`${h.public.managemant}/lavrarAto`,W=`${h.public.managemant}/ato_calcular`,S=i("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),P=i(!1),x=i(null),B=i(null),$=i(null),v=i(C("user-data").value.cartorio_token),q=C("auth_token").value,w=i([]),M=i({}),D=ae({escrevente:null}),c=async()=>{try{const{data:R,status:s}=await b(N,{method:"POST",body:{ato_token:_.ato_token,qtd_paginas:_.pages,escrevente_token:D.escrevente,usuario_token:q,cartorio_token:v}},"$ZKnVBNYxp9");s.value==="success"?(x.value=R.value,B.value=R.value[0].selo,V.success("Ato lavrado com sucesso!")):V.error("Falha ao lavrar o ato.")}catch{V.error("Erro ao conectar com o servidor.")}},r=async()=>{const{data:R,status:s}=await b(W,{method:"POST",body:{ato_token:_.ato_token,cartorio_token:v.value,quantidade:1,usuario_token:q,escrevente_token:D.escrevente,qtd_paginas:_.pages}},"$XouuxOFIWh");s.value==="success"?M.value=R.value[0]:V.error("Falha ao calcular o ato.")},a=async()=>{P.value=!1,await c()},d=async()=>{P.value=!0,await r()},{data:m}=([y,g]=te(()=>b(j,{method:"POST",body:{cartorio_token:v}},"$R51FaaSzOI")),y=await y,g(),y);w.value=m.value[0].func_json_escreventes;const l=function(){$.value.ej2Instances.documentEditor.open(_.document)},p=()=>{const R=E.query.origem||"criar",s=E.query.id;R==="atualizar"?k.push(`/os/atualizar/${s}`):k.push("/os/criar-registro")};return(R,s)=>{const J=He;return A(),U(be,null,[e(z,null,{default:o(()=>[e(I,null,{default:o(()=>[(A(),K(t(ke),{restrictEditing:!0,enableToolbar:!1,created:_.document?l:null,ref_key:"documentEditorContainer",ref:$,height:"850px",width:"850px",key:_.document},null,8,["created"]))]),_:1}),e(I,null,{default:o(()=>[e(re,{class:"mt-15",label:"Tabelião/escrevente",modelValue:t(D).escrevente,"onUpdate:modelValue":s[0]||(s[0]=ee=>t(D).escrevente=ee),items:t(w),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),f("div",null,[f("div",null,[f("img",{onClick:s[1]||(s[1]=ee=>d()),class:"ml-2",style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Le}),t(x)?(A(),K(Qe,{key:0,class:"mr-16"},{default:o(()=>[e(z,{"no-gutters":""},{default:o(()=>[e(I,null,{default:o(()=>[e(he,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:o(()=>[e(I,null,{default:o(()=>[F(" Livro: "+se(t(x)[0].livro_numero),1)]),_:1}),e(I,null,{default:o(()=>[F(" Protocolo: "+se(t(x)[0].protocolo?t(x)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),e(I,null,{default:o(()=>[e(he,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:o(()=>[F(" Folhas : "+se(t(x)[0].pagina_inicial)+" A "+se(t(x)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),f("div",{innerHTML:t(B)},null,8,lt)]),_:1})):ve("",!0)])])]),_:1})]),_:1}),e(G,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:p},{default:o(()=>s[3]||(s[3]=[F("Voltar")])),_:1}),e(J,{show:t(P),condMessage:t(S),valor:t(M),onClose:s[2]||(s[2]=ee=>P.value=!1),onConfirm:a},null,8,["show","condMessage","valor"])],64)}}},it=["onClick"],ct={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},ut={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ut={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(L){let y,g;const _=L,h=H(),V=Q(),k=Z(),{$toast:E}=X(),j=`${k.public.managemant}/listarEscrevente`,N=`${k.public.managemant}/getAtosTiposByToken`,W=`${k.public.managemant}/atos_observacao`,S=`${k.public.managemant}/atos_observacao`,P=i(C("user-data").value.cartorio_token),x=i([]),B=i([]),$=[{title:"Data",align:"start",key:"data"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],v=ae({observacao:null}),q={observacao:{required:me.withMessage("O campo é obrigatorio",pe)}},w=_e(q,v);[y,g]=te(()=>b(`${N}/${_.ato_token}`,{method:"GET"},"$aJM1TL1buW")),y=await y,g();async function M(){if(await w.value.$validate()){const{data:a,error:d,status:m}=await b(W,{method:"POST",body:{ato_id:_.ato_id,observacao:v.observacao,user_id:C("user-data").value.usuario_id}},"$dMg99jeUNP");m.value==="success"&&(x.value.push({data:Xe(a.value.created,"dd/mm/yyyy hh:mm"),observacao:a.value.observacao,id:a.value.id,escrevente:C("user-data").value.nome}),E.success("Observação registrada com sucesso"))}else E.error("Preencha os campos obrigatorios.")}async function D(a){a.excluido=!a.excluido;try{await b(`${S}/${a.id}`,{method:"PUT",body:JSON.stringify({excluido:a.excluido})},"$B6PdRx8Gp4")}catch(d){console.error("Erro ao excluir observacao:",d)}}const{data:c}=([y,g]=te(()=>b(j,{method:"POST",body:{cartorio_token:P}},"$xFHPGua26S")),y=await y,g(),y);B.value=c.value[0].func_json_escreventes;const r=()=>{const a=V.query.origem||"criar",d=V.query.id;a==="atualizar"?h.push(`/os/atualizar/${d}`):h.push("/os/criar-registro")};return(a,d)=>{const m=oe;return A(),K(le,null,{default:o(()=>[e(z,{class:"mt-5"},{default:o(()=>[e(Y,{label:"Observação",modelValue:t(v).observacao,"onUpdate:modelValue":d[0]||(d[0]=l=>t(v).observacao=l),required:"","error-messages":t(w).observacao.$errors.map(l=>l.$message),onBlur:t(w).observacao.$touch,onInput:t(w).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),f("div",null,[f("img",{class:"btn-pointer ml-2",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:M})])]),_:1}),e(z,null,{default:o(()=>[e(I,null,{default:o(()=>[e(ye,{style:{height:"465px"},headers:$,items:t(x)},{"item.actions":o(({item:l})=>[f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:p=>D(l),title:"Deletar Observação"},[l.excluido?(A(),U("img",ct)):(A(),U("img",ut))],8,it)]),_:1},8,["items"])]),_:1})]),_:1}),e(z,null,{default:o(()=>[e(m,{onClick:r},{default:o(()=>[e(G,{size:"large",color:"red"},{default:o(()=>d[1]||(d[1]=[F("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},dt={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:We,alt:"Criar"},mt={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ge,alt:"Criar"},pt={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Je,alt:"Criar"},_t=["onClick"],vt=["onClick"],ft=["onClick"],gt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},yt={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ft={__name:"Anexos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},setup(L){const y=L,g=Z(),{$toast:_}=X(),h=H(),V=Q(),k=`${g.public.biometria}/run-scanner`,E=`${g.public.managemant}/atos_anexos`,j=`${g.public.managemant}/atos_anexos`,N=`${g.public.managemant}/download`;`${g.public.managemant}`,`${g.public.managemant}`;const W=i(!1),S=i(null),P=i([]);C("pessoa_token");const x=ae({descricao:"",fileEvent:null}),B={descricao:{required:me.withMessage("O campo é obrigatório",pe)}},$=_e(B,x,{$autoDirty:!0}),v=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}];async function q(){try{await w(),await M()}catch(l){console.error("Erro ao executar scanner ou listar arquivos:",l)}}async function w(){try{const{data:l}=await b(k,{method:"GET"},"$WazoKp68Tw")}catch(l){_.error("Erro ao acionar o scanner:",l)}}async function M(){try{const{data:l,status:p}=await b("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:V.query.ato_token_edit,cartorio_token:C("user-data").value.cartorio_token}},"$03Wxiia3aI")}catch(l){console.error("Erro ao enviar o arquivo:",l)}}const D=async()=>{W.value=!0};function c(l){return l?!0:(console.error("Erro: Nenhum arquivo foi selecionado!"),S.value=!1,!1)}const r=async()=>{if($.value.$touch(),!$.value.$invalid&&c(x.fileEvent)){const{data:l,error:p,status:R}=await b(E,{method:"POST",body:{ato_id:y.ato_id,descricao:x.descricao,user_id:C("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$WyW0hasRPI");R.value==="success"&&(_.success("Anexo registrado com sucesso!"),P.value.push(l.value))}};async function a(l){l.excluido=!l.excluido;try{await b(`${j}/${l.id}`,{method:"PUT",body:JSON.stringify({excluido:l.excluido})},"$Y3y6TjqbSV")}catch(p){console.error("Erro ao excluir pessoa:",p)}}async function d(l){try{const p=await b(`${N}`,{method:"POST",body:{bucket:C("user-data").value.cartorio_token,path:l.link}},"$bkXJSi7s76"),s=await(await fetch(p.data.value)).blob(),J=URL.createObjectURL(s);window.open(J,"_blank")}catch(p){console.error("Erro ao excluir pessoa:",p)}}const m=()=>{const l=V.query.origem||"criar",p=V.query.id;l==="atualizar"?h.push(`/os/atualizar/${p}`):h.push("/os/criar-registro")};return(l,p)=>{const R=oe;return A(),K(le,null,{default:o(()=>[e(z,null,{default:o(()=>[e(I,{cols:"5",class:"mt-2"},{default:o(()=>[e(Y,{modelValue:t(x).descricao,"onUpdate:modelValue":[p[0]||(p[0]=s=>t(x).descricao=s),t($).descricao.$touch],"error-messages":t($).descricao.$errors.map(s=>s.$message),onBlur:t($).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"])]),_:1}),f("div",{onClick:q,title:"Criar",style:{"padding-right":"10px"}},[t(S)===!1?(A(),U("img",dt)):t(S)===!0?(A(),U("img",mt)):(A(),U("img",pt))]),f("div",{onClick:r,title:"Criar"},p[1]||(p[1]=[f("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:ne,alt:"Escanear"},null,-1)]))]),_:1}),e(ye,{headers:v,items:t(P),style:{height:"465px","max-width":"600px"}},{"item.actions":o(({item:s})=>[e(z,null,{default:o(()=>[f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:J=>D(s),title:"Visualizar Anexo"},[f("img",{style:{width:"30px",height:"30px"},onClick:J=>d(s),src:de,alt:"Visualizar"},null,8,vt)],8,_t),f("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:J=>a(s),title:"Deletar Pessoa"},[s.excluido?(A(),U("img",gt)):(A(),U("img",yt))],8,ft)]),_:2},1024)]),_:1},8,["items"]),e(R,{onClick:m},{default:o(()=>[e(G,{size:"large",color:"red"},{default:o(()=>p[2]||(p[2]=[F("Voltar")])),_:1})]),_:1})]),_:1})}}};export{It as _,jt as a,Bt as b,Nt as c,Ut as d,Ft as e};
