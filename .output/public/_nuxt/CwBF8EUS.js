import{_ as ne}from"./DCkK13hT.js";import{_ as le}from"./DYIvC8ev.js";import{_ as ie}from"./jnYLiuZi.js";import{_ as ue}from"./3OE-PpkA.js";import{_ as B}from"./JTsT0EZC.js";import{_ as ce}from"./BVz1G1IN.js";import{_ as me}from"./DEvt0h4I.js";import{a as de}from"./DJvq3mCv.js";import{G as pe,J as ve,m as _e,r as l,u as h,H as fe,n as ke,c as q,b as t,w as r,s,F as he,q as ge,o as P,V as $,a as u,v as R,d as S}from"./BpaK6Een.js";import{u as g}from"./BfhgwL1T.js";import{V as y}from"./Bw7DCElo.js";import{V as c}from"./IfF8xcir.js";import{V as ye}from"./C8NZ1I0J.js";import{V as z}from"./kx4lXAI_.js";import"./DJYG3Jw2.js";import"./CKI3NyDZ.js";import"./Cx--pjij.js";import"./B0IxRygJ.js";import"./DLzZ0AW7.js";import"./BnhfmzhU.js";import"./CkuX3Vw4.js";import"./BvLUiGH3.js";import"./xNBS92ME.js";import"./BdJjMUNN.js";import"./CqpVz-oB.js";import"./CdJYCCo7.js";import"./D4214uhE.js";const Ve=["onClick"],we={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:B,alt:"Possui Ficha",title:"Possui Ficha"},xe={key:1,style:{width:"30px",height:"30px",cursor:"pointer"},src:me,alt:"Visualizar",title:"Não Possui Ficha"},be=["onClick"],Xe={__name:"autencidade",props:{ato_token:{type:String,required:!0}},emits:["ato-created"],async setup(N,{emit:U}){let p,E;const j=N,D=U,F=pe(),T=ve(),v=ge(),{$toast:I}=_e(),K=`${v.public.managemant}/listarEscrevente`,H=`${v.public.managemant}/pesquisarPessoas`,L=`${v.public.managemant}/atoReconhecimento`,Q=`${v.public.managemant}/etiquetaAutenticidade`,_=l(h("user-data").value.cartorio_token),Z=l(h("user-service").value.token).value||l(h("user-service").value).value,G=h("auth_token").value,V=l([]),M=l([]),m=l([]),f=l(!1),w=l(!1),x=l(!1),b=l(null),C=l(""),A=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],n=fe({quantidade:1,escrevente:null,nome:null,documento:null}),{data:J}=([p,E]=ke(()=>g(K,{method:"POST",body:{cartorio_token:_}},"$qpB20nOlUE")),p=await p,E(),p);M.value=J.value[0].func_json_escreventes;async function W(){try{const{data:o,error:e}=await g(H,{method:"POST",body:{cartorio_token:_.value,documento:n.documento,nome:n.nome}},"$CfpM9wZnUE");o.value.length>0?(D("ato-created"),V.value=o.value):V.value=[]}catch(o){console.error("Erro na requisição",o)}}const X=()=>{w.value=!0};function Y(o){m.value.push(o)}const ee=o=>{b.value=o,x.value=!0};function te(o){m.value=m.value.filter(e=>e.token!==o.token)}async function oe(){if(!n.escrevente){I.error("Por favor selecione um Escrevente");return}try{const o=m.value.map(i=>({pessoa_token:i.token})),{data:e,error:k,status:d}=await g(L,{method:"POST",body:{pessoas:o,cartorio_token:_.value,ordemserv_token:Z,quantidade:n.quantidade,usuario_token:G,ato_tipo_token:j.ato_token}},"$LrKAtpxZwH");d.value==="success"&&e.value[0].status==="OK"?(se(e.value[0].token),O()):(f.value=!0,C.value=ato_token.value.status_mensagem||k.value.data.details)}catch(o){f.value=!0,C.value=o,console.error("Erro na requisição",o)}}async function se(o){try{const{data:e,error:k,status:d}=await g(Q,{method:"POST",body:{ato_token:o,cartorio_token:_.value,escrevente_token:n.escrevente}},"$EE94jKo1pQ");if(d.value==="success"){const i=window.open("","_blank");i.document.open(),i.document.write(e.value[0].etiqueta),i.document.close()}}catch(e){console.error("Erro na requisição",e)}}const O=()=>{const o=T.query.origem||"criar",e=T.query.id;o==="atualizar"?F.push(`/os/atualizar/${e}`):F.push("/os/criar-registro")};return(o,e)=>{const k=ne,d=le,i=ie,ae=ue;return P(),q(he,null,[t(y,{class:"mt-5"},{default:r(()=>[t(c,{cols:"5"},{default:r(()=>[t(ye,{label:"Tabelião/escrevente",modelValue:s(n).escrevente,"onUpdate:modelValue":e[0]||(e[0]=a=>s(n).escrevente=a),items:s(M),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"2"},{default:r(()=>[t($,{label:"Quantidade",type:"number",modelValue:s(n).quantidade,"onUpdate:modelValue":e[1]||(e[1]=a=>s(n).quantidade=a)},null,8,["modelValue"])]),_:1})]),_:1}),t(y,null,{default:r(()=>[t(c,{cols:"3"},{default:r(()=>[t($,{label:"Documento",modelValue:s(n).documento,"onUpdate:modelValue":e[2]||(e[2]=a=>s(n).documento=a)},null,8,["modelValue"])]),_:1}),t(c,{cols:"4"},{default:r(()=>[t($,{label:"Pessoa",modelValue:s(n).nome,"onUpdate:modelValue":e[3]||(e[3]=a=>s(n).nome=a)},null,8,["modelValue"])]),_:1}),u("div",null,[u("img",{class:"btn-pointer mt-1",src:B,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:W})]),u("div",null,[u("img",{class:"btn-pointer mt-1 ml-2",src:ce,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:X})])]),_:1}),t(y,null,{default:r(()=>[t(c,{class:"mr-10"},{default:r(()=>[t(z,{style:{height:"465px"},headers:A,items:s(V)},{"item.actions":r(({item:a})=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:re=>ee(a),title:"Visualizar Ficha"},[a.link_ficha?(P(),q("img",we)):(P(),q("img",xe))],8,Ve)]),_:1},8,["items"])]),_:1}),t(c,null,{default:r(()=>[t(z,{headers:A,items:s(m),style:{height:"465px"},"item-key":"id"},{"item.actions":r(({item:a})=>[u("div",{style:{display:"flex","justify-content":"flex-end"},onClick:re=>te(a),title:"Remover"},e[8]||(e[8]=[u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:de,alt:"Remover"},null,-1)]),8,be)]),_:1},8,["items"])]),_:1})]),_:1}),t(k,{show:s(w),onClose:e[4]||(e[4]=a=>w.value=!1)},null,8,["show"]),t(d,{show:s(x),item:s(b),onConfirmar:e[5]||(e[5]=a=>Y(s(b))),onClose:e[6]||(e[6]=a=>x.value=!1)},null,8,["show","item"]),t(i,{show:s(f),errorMessage:s(C),onClose:e[7]||(e[7]=a=>f.value=!1)},null,8,["show","errorMessage"]),t(y,null,{default:r(()=>[t(ae,{onClick:O},{default:r(()=>[t(R,{size:"large",color:"red"},{default:r(()=>e[9]||(e[9]=[S("Voltar")])),_:1})]),_:1}),t(R,{class:"ml-5",onClick:oe,size:"large",color:"green"},{default:r(()=>e[10]||(e[10]=[S("Salvar")])),_:1})]),_:1})],64)}}};export{Xe as default};
