import{_ as A}from"./haV4sDiV.js";import{r as d,J as F,m as O,H as P,g as U,o as _,c as $,b as o,w as r,a as V,V as v,s as n,v as h,d as E,C as z,F as j,q as R,u as D,A as G,p as T,P as H}from"./DXS2BqBf.js";import{u as M}from"./Dhhb3OK2.js";import{V as J,c as K}from"./BZ4UAAa2.js";import{V as I}from"./BRrkNpWu.js";import{V as N}from"./B4g0rByy.js";import{V as y}from"./BF0Cw2ZP.js";import{V as W}from"./CWi5ZpU4.js";import{_ as Y,a as Z}from"./DJvq3mCv.js";import{f as Q}from"./B0IxRygJ.js";import{V as X}from"./B6SrQJYy.js";import"./B_ygvunF.js";import"./zTqMfSg5.js";import"./D7nf8ZiX.js";import"./WL7ckFn8.js";const ee={__name:"ImportaSelos",props:{show:Boolean,ato_token:String,ato_id:Number,representante_nome:String},emits:["close","update-papel"],setup(B,{emit:w}){const p=B,i=d(p.show);F();const m=R(),{$toast:C}=O(),e=d(!1),g=d(""),b=`${m.public.ws}/fornecer_selos_por_lote`,x=`${m.public.managemant}/fornecer_selos`;d([]);const s=P({nuLote:null}),t=w;U(()=>p.show,async f=>{i.value=f});const c=()=>{i.value=!1,t("close")},a=async()=>{const{data:f,error:l,status:S}=await M(b,{method:"POST",body:{user:"56415451472",pass:"Ra961206",statusSelo:"D",nuLote:s.nuLote},onResponseError({response:u}){var k;const L=((k=u._data)==null?void 0:k.details)||"Erro ao buscar lote de selos.";g.value=L,e.value=!0,console.error("Erro forneceSeloPorLote:",L)}},"$Z1bKGPif1c");if(S.value==="success"){const u=f.value.selos,{data:L,error:k,status:q}=await M(x,{method:"POST",body:{tipo_id:1,cartorio_id:D("user-data").value.cartorio_id,selos:u,user_id:D("user-data").value.usuario_id}},"$Kr3yBtlYBF");q.value==="success"&&(C.success("Selos importados com sucesso"),c())}};return(f,l)=>{const S=A;return _(),$(j,null,[o(W,{persistent:"",modelValue:n(i),"onUpdate:modelValue":l[1]||(l[1]=u=>z(i)?i.value=u:null),"max-width":"800"},{default:r(()=>[o(J,null,{default:r(()=>[o(I,null,{default:r(()=>[o(N,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:r(()=>[o(y,null,{default:r(()=>l[3]||(l[3]=[V("h1",{class:"ml-4"},"Importar selos do lote",-1),V("p",{class:"ml-4 mt-3"}," Informe o codigo do lote para realizar a importação ",-1)])),_:1})]),_:1}),l[4]||(l[4]=V("hr",{class:"mb-5"},null,-1)),o(v,{label:"Lote",modelValue:n(s).nuLote,"onUpdate:modelValue":l[0]||(l[0]=u=>n(s).nuLote=u),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),o(K,null,{default:r(()=>[o(h,{style:{"background-color":"red",color:"white"},onClick:c},{default:r(()=>l[5]||(l[5]=[E("Voltar")])),_:1}),o(h,{style:{"background-color":"green",color:"white"},onClick:a},{default:r(()=>l[6]||(l[6]=[E("Importar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(S,{show:n(e),errorMessage:n(g),onClose:l[2]||(l[2]=u=>e.value=!1)},null,8,["show","errorMessage"])],64)}}},oe={class:"d-flex flex-column"},se=["onClick"],te={key:0,style:{width:"30px",height:"30px"},src:Y,alt:"Visualizar",title:"Reativar"},ae={key:1,src:Z,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},we={__name:"index",setup(B){const w=R(),p=d([]),i=d(!1),m=d(!1),C=`${w.public.managemant}/selos`,e=P({dt_compra:"",numero:"",lote_compra:"",sequencia:"",sigla:""}),g=[{title:"Data de compra",value:"dt_compra"},{title:"Selo",value:"numero"},{title:"Valor de compra",value:"lote_compra"}],b=async()=>{m.value=!0;try{const{data:s,error:t,status:c}=await M(C,{method:"GET"},"$g9WNETx7rH");c.value==="success"?p.value=Array.isArray(s.value)?s.value.map(a=>({...a,dt_compra:a.dt_compra?Q(a.dt_compra,"dd/mm/yyyy"):null})):[]:console.error(t)}catch(s){console.error("Erro ao buscar selos:",s)}finally{m.value=!1}},x=G(()=>p.value.filter(s=>(!e.dt_compra||s.dt_compra.toLowerCase().includes(e.dt_compra.toLowerCase()))&&(!e.numero||s.numero.toLowerCase().includes(e.numero.toLowerCase()))&&(!e.lote_compra||s.lote_compra.toLowerCase().includes(e.lote_compra.toLowerCase()))&&(!e.sequencia||s.sequencia.toLowerCase().includes(e.sequencia.toLowerCase()))&&(!e.sigla||s.sigla.toLowerCase().includes(e.sigla.toLowerCase()))));return b(),(s,t)=>{const c=ee;return n(m)?(_(),T(H,{key:0,class:"d-flex justify-center align-center",indeterminate:"",size:"64",style:{position:"absolute",top:"40%",left:"50%"}})):(_(),T(I,{key:1,class:"mt-5"},{default:r(()=>[V("div",oe,[o(h,{class:"mb-10 mt-auto align-self-end",color:"green",size:"large",onClick:t[0]||(t[0]=a=>i.value=!0)},{default:r(()=>t[5]||(t[5]=[E(" Importar Selos TJ ")])),_:1})]),o(N,{class:"mb-4",style:{gap:"10rem"}},{default:r(()=>[o(y,{cols:"12",md:"2"},{default:r(()=>[o(v,{modelValue:n(e).dt_compra,"onUpdate:modelValue":t[1]||(t[1]=a=>n(e).dt_compra=a),label:"Data de Compra","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),o(y,{cols:"12",md:"2"},{default:r(()=>[o(v,{modelValue:n(e).numero,"onUpdate:modelValue":t[2]||(t[2]=a=>n(e).numero=a),label:"Selo","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),o(y,{cols:"12",md:"2"},{default:r(()=>[o(v,{modelValue:n(e).lote_compra,"onUpdate:modelValue":t[3]||(t[3]=a=>n(e).lote_compra=a),label:"Valor de Compra","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),o(X,{density:"compact",headers:g,items:n(x),"item-key":"selo"},{"item.actions":r(({item:a})=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:f=>s.deleteObservacao(a),title:"Deletar Observação"},[a.excluido?(_(),$("img",te)):(_(),$("img",ae))],8,se)]),_:1},8,["items"]),o(c,{show:n(i),onClose:t[4]||(t[4]=a=>i.value=!1)},null,8,["show"])]),_:1}))}}};export{we as default};
