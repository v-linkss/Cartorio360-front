import{_ as te}from"./MF5Sk597.js";import{u as oe,n as se,q as Q,r,s as le,o as E,v as re,w as a,b as e,x as t,V as K,y as G,d as q,z as Z,A as N,B as X,a as u,C as de,c as L,D as ee,E as Te,F as qe}from"./CAyDw0ka.js";import{u as y}from"./CBN1IDPA.js";import{V as w}from"./CnwnXZHP.js";import{V as U}from"./CDRIMoEH.js";import{V as ue}from"./B6CK3rMo.js";import{V as ne}from"./D99_Rp8l.js";import{_ as Ee}from"./3lvADV1O.js";import{_ as Se,a as De,b as Ue,c as Re,d as Ie,e as je}from"./CUWQ9-Jo.js";import{_ as pe}from"./DSOuKtsh.js";import{_ as ae,a as me}from"./HBU26js5.js";import{_ as _e,a as Be}from"./SDCPWox4.js";import{V as ye,a as ve}from"./FMICyk4I.js";import{_ as fe}from"./DfjuBLsA.js";import{c as Me,r as Fe,u as Ne}from"./DC4re-Lu.js";import{V as Ge,a as H,b as Le,c as J}from"./Bd8-keww.js";import"./CfmeZTU0.js";const He={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(W){const l=W,{$toast:g}=oe(),k=Z(),v=se(),n=Q(),h=`${k.public.managemant}/updateAtos`,S=r(l.item_situacoes),x=le({dt_abertura:l.item_dados[0].dt_abertura||null,status:l.item_dados[0].status||null,mne:l.item_dados[0].mne||null});async function R(){const{data:V,error:d,status:P}=await y(`${h}/${n.query.id}`,{method:"PUT",body:{status:x.status,mne:x.mne}},"$EIT5jtTUdX");P.value==="success"&&g.success("Situação Atualizada com sucesso")}const I=()=>{const V=n.query.origem||"criar",d=n.query.id;V==="atualizar"?v.push(`/os/atualizar/${d}`):v.push("/os/criar-registro")};return(V,d)=>{const P=te;return E(),re(ne,null,{default:a(()=>[e(w,{class:"mt-5"},{default:a(()=>[e(U,{cols:"3"},{default:a(()=>[e(ue,{label:"Situação",modelValue:t(x).status,"onUpdate:modelValue":d[0]||(d[0]=b=>t(x).status=b),items:t(S),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(U,{cols:"5"},{default:a(()=>[e(K,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:t(x).mne,"onUpdate:modelValue":d[1]||(d[1]=b=>t(x).mne=b)},null,8,["modelValue"])]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(U,{cols:"2"},{default:a(()=>[e(K,{modelValue:t(x).dt_abertura,"onUpdate:modelValue":d[2]||(d[2]=b=>t(x).dt_abertura=b),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(w,{class:"mb-3"},{default:a(()=>[e(P,{onClick:I},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[q("Voltar")]),_:1})]),_:1}),e(G,{class:"ml-10",onClick:R,size:"large",color:"green"},{default:a(()=>[q("Salvar")]),_:1})]),_:1})]),_:1})}}},Je=["onClick"],Ke=u("img",{style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar"},null,-1),Xe=[Ke],We=["onClick"],Ye=u("img",{style:{width:"30px",height:"30px"},src:Be,alt:"Visualizar"},null,-1),Qe=[Ye],Ze=["onClick"],ea={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},aa={key:1,src:me,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},ta=["onClick"],oa=u("img",{style:{width:"30px",height:"30px"},src:Ue,alt:"Visualizar"},null,-1),sa=[oa],la={__name:"Partes",props:{ato_token:{type:String,required:!0}},async setup(W){let l,g;const k=se(),v=Q(),n=Z(),{$toast:h}=oe(),S=`${n.public.managemant}/pesquisarPessoas`,x=`${n.public.managemant}/listarPapeis`,R=`${n.public.managemant}/getLinkTipo`,I=`${n.public.managemant}/createAtosPessoa`,V=`${n.public.managemant}/updateAtosPessoa`,d=`${n.public.managemant}/getAtosPessoaById`,P=r(N("user-data").value.cartorio_token),b=r([]),$=r([]),M=r([]),A=r(!1),j=r(!1),f=r(!1),z=r(!1),F=r(null),D=r(null),o=r(null),c=r(null),O=r(null),p=r("xkyaA"),T=r(null),ge=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],m=le({papeis:null,nome:null,pessoa:null,documento:null}),{data:he}=([l,g]=X(()=>y(x,{method:"POST",body:{tipo_ato_token:"xkyaA"}},"$acoiTIUp00")),l=await l,g(),l);M.value=he.value;const ie=async()=>{const{data:i}=await y(`${d}/${v.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),B=(Y=>Y.map(C=>({...C,pessoa:{...C.pessoa,documento:C.pessoa.doc_identificacao},papel:{...C.partes_tipos}})))(i.value);$.value=B};ie();async function xe(){try{const{data:i,error:s}=await y(S,{method:"POST",body:{cartorio_token:P.value,documento:m.documento,nome:m.nome}},"$pr30MyPXfY");i.value.length>0?(b.value=i.value,m.pessoa=b.value[0]):b.value=[]}catch(i){console.error("Erro na requisição",i)}}const be=()=>{j.value=!0},$e=async()=>{await ie()},ke=async()=>{await ie()},Ve=async()=>{const i={pessoa:m.pessoa,papel:M.value.find(C=>C.id===m.papeis),representante:{nome:null}};for(const C of $.value)if(console.log(`element.pessoa_id
`,C.pessoa_id),console.log(`element.state.pessoa.id
`,m.pessoa.id),console.log(`element.tipo_parte_id
`,C.tipo_parte_id),console.log(`state.papeis
`,m.papeis),C.pessoa_id===m.pessoa.id&&C.tipo_parte_id===m.papeis){h.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:s,error:B,status:Y}=await y(I,{method:"POST",body:{ato_id:v.query.ato_id,pessoa_id:m.pessoa.id,tipo_parte_id:m.papeis,user_id:N("user-data").value.usuario_id}},"$scHdIvxj2D");Y.value==="success"&&(o.value=s.value.id,h.success("Pessoa Registrada com Sucesso!"),$.value.push(i))},Pe=async i=>{f.value=!0,T.value=null;const{data:s}=await y(`${R}`,{method:"POST",body:{id:i.pessoa.id,tipo:"ficha"}},"$18isAgOJxG");s.value&&s.value.link?T.value=`data:image/jpeg;base64,${s.value.link}`:T.value=null},we=i=>{const s=$.value.filter(B=>B.pessoa.id!==i.pessoa.id).map(B=>({id:B.pessoa.id,nome:B.pessoa.nome}));o.value=i.id,F.value=s,A.value=!0,D.value=i.pessoa.nome,O.value=i.pessoa.id},Ae=i=>{z.value=!0,c.value=i.id,D.value=i.pessoa.nome};async function Ce(i){i.excluido=!i.excluido;try{await y(`${V}/${i.id}`,{method:"PUT",body:JSON.stringify({excluido:i.excluido})},"$hmDzSF3F61")}catch(s){console.error("Erro ao excluir pessoa:",s)}}const ze=()=>{const i=v.query.origem||"criar",s=v.query.id;i==="atualizar"?k.push(`/os/atualizar/${s}`):k.push("/os/criar-registro")};return(i,s)=>{const B=Ee,Y=Se,C=De,Oe=te;return E(),re(ne,null,{default:a(()=>[e(w,{class:"mt-5"},{default:a(()=>[e(U,{cols:"3"},{default:a(()=>[e(K,{label:"Documento",modelValue:t(m).documento,"onUpdate:modelValue":s[0]||(s[0]=_=>t(m).documento=_)},null,8,["modelValue"])]),_:1}),e(U,{cols:"4"},{default:a(()=>[e(K,{label:"Pessoa",modelValue:t(m).nome,"onUpdate:modelValue":s[1]||(s[1]=_=>t(m).nome=_)},null,8,["modelValue"])]),_:1}),u("div",null,[u("img",{class:"mt-3",src:pe,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:xe})]),u("div",null,[u("img",{class:"mt-3 ml-2",src:ae,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:be})])]),_:1}),e(w,null,{default:a(()=>[e(U,{cols:"4"},{default:a(()=>[e(ue,{label:"Selecione a Pessoa",modelValue:t(m).pessoa,"onUpdate:modelValue":s[2]||(s[2]=_=>t(m).pessoa=_),items:t(b),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(U,{cols:"3"},{default:a(()=>[e(ue,{label:"Papel",modelValue:t(m).papeis,"onUpdate:modelValue":s[3]||(s[3]=_=>t(m).papeis=_),items:t(M),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),u("div",null,[u("img",{class:"mt-3",src:ae,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Ve})])]),_:1}),e(w,null,{default:a(()=>[e(U,null,{default:a(()=>[e(de,{style:{height:"465px"},headers:ge,items:t($)},{"item.actions":a(({item:_})=>[e(w,null,{default:a(()=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>Pe(_),title:"Visualizar Ficha"},Xe,8,Je),u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Ae(_),class:"mr-2",title:"Alterar Papel"},Qe,8,We),u("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Ce(_),title:"Deletar Pessoa"},[_.excluido?(E(),L("img",ea)):(E(),L("img",aa))],8,Ze),u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>we(_),title:"Selecionar Representante"},sa,8,ta)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(B,{show:t(j),onClose:s[4]||(s[4]=_=>j.value=!1)},null,8,["show"]),e(Y,{representante_nome:t(D),representantes:t(F),ato_id:t(o),show:t(A),onClose:s[5]||(s[5]=_=>A.value=!1),onUpdateRepresentante:ke},null,8,["representante_nome","representantes","ato_id","show"]),e(C,{representante_nome:t(D),ato_token:t(p),ato_id:t(c),show:t(z),onClose:s[6]||(s[6]=_=>z.value=!1),onUpdatePapel:$e},null,8,["representante_nome","ato_token","ato_id","show"]),e(ye,{modelValue:t(f),"onUpdate:modelValue":s[8]||(s[8]=_=>ee(f)?f.value=_:null),width:"600"},{default:a(()=>[e(ve,{"max-width":"600",title:"Ficha"},{default:a(()=>[e(Te,{src:t(T)},null,8,["src"]),e(G,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:s[7]||(s[7]=_=>f.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(w,null,{default:a(()=>[e(Oe,{onClick:ze},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[q("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},ra=["onClick"],na={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},ia={key:1,src:me,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},ca={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(W){let l,g;const k=se(),v=Q(),n=Z(),{$toast:h}=oe(),S=`${n.public.managemant}/listarEscrevente`;`${n.public.managemant}`;const x=`${n.public.managemant}/createAtosObservacao`,R=`${n.public.managemant}/updateAtosObservacao`,I=`${n.public.managemant}/getAtosObservacaoById`,V=r(N("user-data").value.cartorio_token),d=r([]),P=r([]),b=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],$=le({observacao:""}),M={observacao:{required:Me.withMessage("O campo é obrigatório",Fe)}},A=Ne(M,$),{data:j}=([l,g]=X(()=>y(`${I}/${v.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),l=await l,g(),l);d.value=j.value.map(o=>({...o,created:fe(o.created,"dd/mm/yyyy")}));async function f(){if($.observacao.trim()===""){h.error("O campo de observação está vazio.");return}if(await A.value.$validate()){const{data:o,error:c,status:O}=await y(x,{method:"POST",body:{ato_id:v.query.ato_id,observacao:$.observacao,user_id:N("user-data").value.usuario_id}},"$gnHMo4uCXD");O.value==="success"&&(d.value.push({created:fe(o.value.created,"dd/mm/yyyy"),observacao:o.value.observacao,id:o.value.id,escrevente:N("user-data").value.nome}),$.observacao="",h.success("Observação registrada com sucesso"))}else h.error("Preencha os campos obrigatórios.")}async function z(o){o.excluido=!o.excluido;try{await y(`${R}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$sP9AKdd3Ky")}catch(c){console.error("Erro ao excluir observação:",c)}}const{data:F}=([l,g]=X(()=>y(S,{method:"POST",body:{cartorio_token:V}},"$HL9pndqGh0")),l=await l,g(),l);P.value=F.value[0].func_json_escreventes;const D=()=>{const o=v.query.origem||"criar",c=v.query.id;o==="atualizar"?k.push(`/os/atualizar/${c}`):k.push("/os/criar-registro")};return(o,c)=>{const O=te;return E(),re(ne,null,{default:a(()=>[e(w,{class:"mt-5"},{default:a(()=>[e(K,{label:"Observação",modelValue:$.observacao,"onUpdate:modelValue":c[0]||(c[0]=p=>$.observacao=p),required:"","error-messages":t(A).observacao.$errors.length>0?t(A).observacao.$errors.map(p=>p.$message):[],onBlur:t(A).observacao.$touch,onInput:t(A).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),u("div",null,[u("img",{class:"btn-pointer ml-2",src:ae,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:f})])]),_:1}),e(w,null,{default:a(()=>[e(U,null,{default:a(()=>[e(de,{style:{height:"465px"},headers:b,items:d.value},{"item.actions":a(({item:p})=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:T=>z(p),title:"Deletar Observação"},[p.excluido?(E(),L("img",na)):(E(),L("img",ia))],8,ra)]),_:1},8,["items"])]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(O,{onClick:D},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[q("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},ua=u("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Re,alt:"Escanear"},null,-1),da=[ua],pa=u("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ae,alt:"Criar"},null,-1),ma=[pa],_a=["onClick"],va=u("img",{style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar"},null,-1),fa=[va],ya=["onClick"],ga={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},ha={key:1,src:me,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},xa={__name:"Anexos",async setup(W){let l,g;const k=Z(),{$toast:v}=oe(),n=se(),h=Q(),S=`${k.public.biometria}/run-scanner`,x=`${k.public.managemant}/atos_anexos`,R=`${k.public.managemant}/atos_anexos`,I=`${k.public.managemant}/atos_anexos`,V=r(!1),d=r([]),P=le({descricao:""}),b=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:$}=([l,g]=X(()=>y(`${I}/${h.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),l=await l,g(),l);d.value=$.value;async function M(){try{await A(),await j()}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}}async function A(){try{const{data:o}=await y(S,{method:"GET"},"$KttjFhHivJ")}catch(o){v.error("Erro ao acionar o scanner:",o)}}async function j(){try{const{data:o,status:c}=await y("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:h.query.ato_token_edit,cartorio_token:N("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(o){console.error("Erro ao enviar o arquivo:",o)}}const f=async()=>{V.value=!0},z=async()=>{const{data:o,error:c,status:O}=await y(x,{method:"POST",body:{ato_id:h.query.ato_id,descricao:P.descricao,user_id:N("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");O.value==="success"&&(v.success("Anexo registrado com sucesso!"),d.value.push(o.value))};async function F(o){o.excluido=!o.excluido;try{await y(`${R}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$cdoFBGO0Ti")}catch(c){console.error("Erro ao excluir pessoa:",c)}}const D=()=>{const o=h.query.origem||"criar",c=h.query.id;o==="atualizar"?n.push(`/os/atualizar/${c}`):n.push("/os/criar-registro")};return(o,c)=>{const O=te;return E(),re(ne,null,{default:a(()=>[e(w,null,{default:a(()=>[e(U,{cols:"5"},{default:a(()=>[e(K,{modelValue:t(P).descricao,"onUpdate:modelValue":c[0]||(c[0]=p=>t(P).descricao=p),label:"Descrição"},null,8,["modelValue"])]),_:1}),u("div",{onClick:M,title:"Escanear"},da),u("div",{onClick:z,title:"Criar"},ma)]),_:1}),e(de,{headers:b,items:t(d),style:{height:"465px","max-width":"600px"}},{"item.actions":a(({item:p})=>[e(w,null,{default:a(()=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:T=>f(p),title:"Visualizar Anexo"},fa,8,_a),u("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:T=>F(p),title:"Deletar Pessoa"},[p.excluido?(E(),L("img",ga)):(E(),L("img",ha))],8,ya)]),_:2},1024)]),_:1},8,["items"]),e(ye,{modelValue:t(V),"onUpdate:modelValue":c[2]||(c[2]=p=>ee(V)?V.value=p:null),width:"600"},{default:a(()=>[e(ve,{"max-width":"600",title:"Anexo"},{default:a(()=>[e(G,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:c[1]||(c[1]=p=>V.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(O,{onClick:D},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[q("Voltar")]),_:1})]),_:1})]),_:1})}}},ba=u("h1",{class:"mb-2"},"Procuração",-1),ja={__name:"[id]",async setup(W){let l,g;const k=r(null),v=r(null),n=r(null),h=Z(),S=Q(),x=`${h.public.managemant}/listarSituacoes`,R=`${h.public.managemant}/getAtos`,I=r(N("user-data").value.cartorio_token),V=S.query.id?{ato_token:"xkyaA"}:{cartorio_token:I},d=r([]),P=r([]);async function b(){try{const{data:f}=await y(`${R}/${S.query.id}`,{method:"GET"},"$j0JpHHj7PB");P.value=f.value}catch(f){console.log(f)}}[l,g]=X(()=>b()),await l,g();const{data:$,status:M}=([l,g]=X(()=>y(x,{method:"POST",body:V},"$mGbp7gAEjS")),l=await l,g(),l);d.value=$.value;const A=f=>{k.value=f},j=f=>{v.value=f};return(f,z)=>{const F=He,D=la,o=Ie,c=je,O=ca,p=xa;return E(),L(qe,null,[ba,e(ve,{width:"1300"},{default:a(()=>[e(Ge,{modelValue:t(n),"onUpdate:modelValue":z[0]||(z[0]=T=>ee(n)?n.value=T:null),"bg-color":"#f5f2f2"},{default:a(()=>[e(H,{value:"dados"},{default:a(()=>[q("Dados")]),_:1}),e(H,{value:"partes"},{default:a(()=>[q("Partes")]),_:1}),e(H,{value:"minuta"},{default:a(()=>[q("Minuta")]),_:1}),e(H,{value:"livro"},{default:a(()=>[q("Livro")]),_:1}),e(H,{value:"observacao"},{default:a(()=>[q("Observações")]),_:1}),e(H,{value:"anexo"},{default:a(()=>[q("Anexos")]),_:1})]),_:1},8,["modelValue"]),e(Le,{modelValue:t(n),"onUpdate:modelValue":z[1]||(z[1]=T=>ee(n)?n.value=T:null)},{default:a(()=>[e(J,{value:"dados"},{default:a(()=>[e(F,{item_dados:t(P),item_situacoes:t(d)},null,8,["item_dados","item_situacoes"])]),_:1}),e(J,{value:"partes"},{default:a(()=>[e(D)]),_:1}),e(J,{value:"minuta"},{default:a(()=>[e(o,{onPage:A,onDoc:j})]),_:1}),e(J,{value:"livro"},{default:a(()=>[e(c,{pages:t(k),document:t(v)},null,8,["pages","document"])]),_:1}),e(J,{value:"observacao"},{default:a(()=>[e(O)]),_:1}),e(J,{value:"anexo"},{default:a(()=>[e(p)]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}};export{ja as default};
