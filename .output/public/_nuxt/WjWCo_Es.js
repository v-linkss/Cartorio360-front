import{_ as ye}from"./Dsp8npIh.js";import{u as de,C as me,J as pe,r as s,f as ge,o as d,j as J,w as t,b as a,i as e,V as ue,v as oe,d as X,k as L,l as ve,e as R,y as Re,s as fe,a as q,c as S,M as Ie,g as Fe,N as Ne,F as Pe,H as Be,O as Ae,t as be}from"./B_E4pH1E.js";import{u as _}from"./CODeQj60.js";import{V as I}from"./B3oK8asH.js";import{V as B}from"./B8JbSqLg.js";import{V as ke}from"./B3pP8eow.js";import{V as xe}from"./CkJKeZFG.js";import{_ as Le,a as Ge,b as He,c as Je}from"./D30OiEiq.js";import{_ as Ke,a as We,b as Xe,T as Ye,W as Qe,S as Ze,D as Oe,c as ea}from"./J8_ntw3v.js";import{_ as aa,r as Te}from"./D4zemkNR.js";import{_ as Ce}from"./xFwOg1O6.js";import{_ as $e}from"./BVz1G1IN.js";import{_ as ta}from"./CgIUqggn.js";import{_ as oa}from"./C3iCTc0I.js";import{_ as Ee,a as Ve}from"./DJvq3mCv.js";import{V as qe}from"./BZix0oab.js";import{_ as Me}from"./BooTdJgq.js";import{V as sa}from"./BiIL1GZj.js";import{c as De,r as Se,u as je}from"./CnnDeAhE.js";import{f as ze}from"./B0IxRygJ.js";import{_ as ra}from"./-zgYk4Vu.js";const Xa={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(ne){const v=ne,{$toast:E}=de(),w=ve(),l=me(),c=pe(),b=`${w.public.managemant}/updateAtos`,V=s(v.item_situacoes),Y=s(c.query.origem==="vizualizar"),P=ge({dt_abertura:v.item_dados[0].dt_abertura||null,status:v.item_dados[0].status||null,mne:v.item_dados[0].mne||null});async function Q(){const{data:F,error:k,status:T}=await _(`${b}/${c.query.ato_id}`,{method:"PUT",body:{status:P.status,mne:P.mne,dt_abertura:P.dt_abertura}},"$EIT5jtTUdX");T.value==="success"&&E.success("Ato Atualizado com sucesso")}const O=()=>{const F=c.query.origem||"criar",k=c.query.id;switch(F){case"atualizar":case"vizualizar":l.push(`/os/atualizar/${k}`);break;case"atualizar-lista":case"vizualizar-lista":l.push("/atos/lista");break;default:l.push("/os/criar-registro");break}};return(F,k)=>{const T=ye;return d(),J(xe,null,{default:t(()=>[a(I,{class:"mt-5"},{default:t(()=>[a(B,{cols:"3"},{default:t(()=>[a(ke,{label:"Situação",modelValue:e(P).status,"onUpdate:modelValue":k[0]||(k[0]=y=>e(P).status=y),items:e(V),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),a(I,null,{default:t(()=>[a(B,{cols:"5"},{default:t(()=>[a(ue,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:e(P).mne,"onUpdate:modelValue":k[1]||(k[1]=y=>e(P).mne=y)},null,8,["modelValue"])]),_:1})]),_:1}),a(I,null,{default:t(()=>[a(B,{cols:"2"},{default:t(()=>[a(ue,{modelValue:e(P).dt_abertura,"onUpdate:modelValue":k[2]||(k[2]=y=>e(P).dt_abertura=y),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),a(I,{class:"mb-3"},{default:t(()=>[a(T,{onClick:O},{default:t(()=>[a(oe,{size:"large",color:"red"},{default:t(()=>k[3]||(k[3]=[X("Voltar")])),_:1})]),_:1}),e(Y)?L("",!0):(d(),J(oe,{key:0,class:"ml-10",onClick:Q,size:"large",color:"green"},{default:t(()=>k[4]||(k[4]=[X("Atualizar")])),_:1}))]),_:1})]),_:1})}}},na={key:0},la=["onClick"],ia={key:0,style:{width:"30px",height:"30px"},src:Ce,alt:"Visualizar"},ca={key:1,style:{width:"30px",height:"30px"},src:ta,alt:"Visualizar"},ua=["onClick"],da=["onClick"],ma={key:0,style:{width:"30px",height:"30px"},src:Ee,alt:"Visualizar",title:"Reativar"},pa={key:1,src:Ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},va=["onClick"],Ya={__name:"Partes",async setup(ne){let v,E;const w=me(),l=pe(),c=ve(),{$toast:b}=de(),V=`${c.public.managemant}/pesquisarPessoas`,Y=`${c.public.managemant}/listarPapeis`,P=`${c.public.managemant}/createAtosPessoa`,Q=`${c.public.managemant}/updateAtosPessoa`,O=`${c.public.managemant}/getAtosPessoaById`,F=`${c.public.managemant}/download`,k=s(R("user-data").value.cartorio_token),T=s(l.query.origem==="vizualizar"),y=s([]),A=s({}),z=s([]),N=s([]),x=s(!1),j=s(!1),K=s(!1),Z=s(!1),W=s(null),$=s(null),C=s(null),G=s(null),r=s(null),n=s(l.query.tipo_ato_token),h=s(null),M=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome",width:"320px"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome",width:"320px"},{value:"actions"}],i=ge({papeis:null,nome:null,pessoa:null,documento:null});Re(()=>{var p;return((p=i.pessoa)==null?void 0:p.link_ficha)||!1});const{data:U}=([v,E]=fe(()=>_(Y,{method:"POST",body:{tipo_ato_token:l.query.tipo_ato_token}},"$acoiTIUp00")),v=await v,E(),v);N.value=U.value;const o=async()=>{const{data:p}=await _(`${O}/${l.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),ee=(_e=>_e.map(re=>({...re,pessoa:{...re.pessoa,documento:re.pessoa.doc_identificacao},papel:{...re.partes_tipos}})))(p.value);z.value=ee};o();async function g(){try{const{data:p,error:u}=await _(V,{method:"POST",body:{cartorio_token:k.value,documento:i.documento,nome:i.nome}},"$pr30MyPXfY");p.value.length>0?(y.value=p.value,i.pessoa=y.value[0]):y.value=[]}catch(p){console.error("Erro na requisição",p)}}const H=()=>{j.value=!0},m=async()=>{await o()},f=async()=>{await o()},ae=async()=>{const p={pessoa:i.pessoa,papel:N.value.find(le=>le.id===i.papeis),representante:{nome:null}},u=await _(`${O}/${l.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const le of u.data.value)if(le.pessoa_id===i.pessoa.id&&le.ato_id===Number(l.query.ato_id)&&le.tipo_parte_id===i.papeis){b.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:ee,error:_e,status:re}=await _(P,{method:"POST",body:{ato_id:Number(l.query.ato_id),pessoa_id:i.pessoa.id,tipo_parte_id:i.papeis,user_id:R("user-data").value.usuario_id}},"$18isAgOJxG");re.value==="success"?(p.id=ee.value.id,b.success("Pessoa Registrada com Sucesso!"),z.value.push(p)):b.error(_e.value.message)},te=async p=>{K.value=!0;const{data:u}=await _(F,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:p.pessoa.link_ficha}},"$hmDzSF3F61");h.value=u.value,A.value=p.pessoa},ie=p=>{const u=z.value.filter(ee=>ee.pessoa.id!==p.pessoa.id&&!ee.excluido).map(ee=>({id:ee.pessoa.id,nome:ee.pessoa.nome}));C.value=p.id,W.value=u,x.value=!0,$.value=p.pessoa.nome,r.value=p.pessoa.id},se=p=>{Z.value=!0,G.value=p.id,$.value=p.pessoa.nome};async function ce(p){p.excluido=!p.excluido;try{await _(`${Q}/${p.id}`,{method:"PUT",body:JSON.stringify({excluido:p.excluido})},"$l09I6nLRfk")}catch(u){console.error("Erro ao excluir pessoa:",u)}}const he=()=>{const p=l.query.origem||"criar",u=l.query.id;switch(p){case"atualizar":case"vizualizar":w.push(`/os/atualizar/${u}`);break;case"atualizar-lista":case"vizualizar-lista":w.push("/atos/lista");break;default:w.push("/os/criar-registro");break}};return(p,u)=>{const ee=Le,_e=We,re=Xe,le=aa,Ue=ye;return d(),J(xe,null,{default:t(()=>[e(T)?L("",!0):(d(),J(I,{key:0,class:"mt-5"},{default:t(()=>[a(B,{cols:"3"},{default:t(()=>[a(ue,{label:"Documento",modelValue:e(i).documento,"onUpdate:modelValue":u[0]||(u[0]=D=>e(i).documento=D)},null,8,["modelValue"])]),_:1}),a(B,{cols:"4"},{default:t(()=>[a(ue,{label:"Pessoa",modelValue:e(i).nome,"onUpdate:modelValue":u[1]||(u[1]=D=>e(i).nome=D)},null,8,["modelValue"])]),_:1}),q("div",null,[q("img",{class:"mt-1",src:Ce,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:g})]),q("div",null,[q("img",{class:"mt-1 ml-2",src:$e,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:H})])]),_:1})),e(T)?L("",!0):(d(),J(I,{key:1},{default:t(()=>[a(B,{cols:"4"},{default:t(()=>[a(ke,{label:"Selecione a Pessoa",modelValue:e(i).pessoa,"onUpdate:modelValue":u[2]||(u[2]=D=>e(i).pessoa=D),items:e(y),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),a(B,{cols:"3"},{default:t(()=>[a(ke,{label:"Papel",modelValue:e(i).papeis,"onUpdate:modelValue":u[3]||(u[3]=D=>e(i).papeis=D),items:e(N),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(T)?L("",!0):(d(),S("div",na,[q("img",{class:"mt-1",src:$e,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:ae})]))]),_:1})),a(I,null,{default:t(()=>[a(B,null,{default:t(()=>[a(qe,{style:{height:"465px"},headers:M,items:e(z)},{"item.actions":t(({item:D})=>[e(T)?L("",!0):(d(),J(I,{key:0},{default:t(()=>[q("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-1",onClick:we=>te(D),title:"Visualizar Ficha"},[D.pessoa.link_ficha?(d(),S("img",ia)):(d(),S("img",ca))],8,la),q("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:we=>se(D),class:"mr-1",title:"Alterar Papel"},u[8]||(u[8]=[q("img",{style:{width:"30px",height:"30px"},src:oa,alt:"Visualizar"},null,-1)]),8,ua),q("div",{class:"mr-1",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:we=>ce(D),title:"Deletar Pessoa"},[D.excluido?(d(),S("img",ma)):(d(),S("img",pa))],8,da),q("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-1",onClick:we=>ie(D),title:"Selecionar Representante"},u[9]||(u[9]=[q("img",{style:{width:"30px",height:"30px"},src:Ke,alt:"Visualizar"},null,-1)]),8,va)]),_:2},1024))]),_:1},8,["items"])]),_:1})]),_:1}),a(ee,{show:e(j),onClose:u[4]||(u[4]=D=>j.value=!1)},null,8,["show"]),a(_e,{representante_nome:e($),representantes:e(W),ato_id:e(C),show:e(x),onClose:u[5]||(u[5]=D=>x.value=!1),onUpdateRepresentante:f},null,8,["representante_nome","representantes","ato_id","show"]),a(re,{representante_nome:e($),ato_token:e(n),ato_id:e(G),show:e(Z),onClose:u[6]||(u[6]=D=>Z.value=!1),onUpdatePapel:m},null,8,["representante_nome","ato_token","ato_id","show"]),e(K)?(d(),J(le,{key:2,show:e(K),"link-view":e(h),"pessoa-obj":e(A),"is-view":!0,onClose:u[7]||(u[7]=D=>K.value=!1)},null,8,["show","link-view","pessoa-obj"])):L("",!0),a(I,null,{default:t(()=>[a(Ue,{onClick:he},{default:t(()=>[a(oe,{size:"large",color:"red"},{default:t(()=>u[10]||(u[10]=[X("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},_a={key:0,class:"loading-overlay"},fa="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Qa={__name:"Minuta",emits:["page","doc"],setup(ne,{emit:v}){Ie("DocumentEditorContainer",[Ye,Qe,Ze]);const E=ve(),{$toast:w}=de(),l=me(),c=pe(),b=v;Te(`${E.public.docEditor}`);const V=`${E.public.managemant}/download`,Y=`${E.public.managemant}/atos/files`,P=`${E.public.managemant}/subitituirModelo`,Q=`${E.public.managemant}/upload`,O=s(null),F=s(!1),k=s("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),T=s(c.query.origem==="vizualizar"),y=s(!1),A=async r=>{try{const n=await fetch(r);if(!n.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await n.blob()}catch(n){return console.error(n),null}},z=async()=>{try{const{data:r}=await _(`${Y}/${c.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return r.value.link_ato}catch(r){console.error("Erro ao carregar o documento:",r),w.error(r)}},N=async()=>{y.value=!0;try{const r=await z(),{data:n,status:h}=await _(V,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:r}},"$dvNFfvmIJC"),M=n.value,i=await A(M);if(i){const U=new FileReader;U.onload=()=>{const o=U.result;O.value.ej2Instances.documentEditor.open(o),b("doc",o)},U.readAsText(i)}}catch{console.error("Erro ao carregar o documento.")}finally{y.value=!1}},x=async()=>{const n=await O.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),h=new FileReader;h.onload=()=>{const M=h.result,U=O.value.ej2Instances.documentEditor.pageCount;b("page",U),b("doc",M)},h.readAsText(n)},j=async()=>{y.value=!0;try{const n=await O.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),h=new FormData;h.append("file",n,"anexo.sfdt"),h.append("cartorio_token",R("user-data").value.cartorio_token),h.append("token",c.query.ato_token_edit),h.append("tipo","ato_minuta");const{data:M,status:i}=await _(Q,{method:"POST",body:h},"$xv11VtUdMy");if(i.value==="success"){w.success("Documento enviado!");const o=O.value.ej2Instances.documentEditor.pageCount;x(),b("page",o)}else w.error("Erro ao enviar documento para o sistema.")}catch(r){w.error("Erro ao salvar documento."),console.error(r)}finally{y.value=!1}},K=()=>{F.value=!1,Z()},Z=async()=>{C(!0);try{await W(),C(!0);const{data:r,status:n}=await _(P,{method:"POST",body:{ato_token:c.query.ato_token_edit}},"$zyzWHTXTBW");r.value&&$(r.value)}catch(r){console.error("Erro ao gerar a minuta:",r),w.error("Ocorreu um erro ao gerar a minuta.")}finally{C(!1)}},W=async()=>{try{const{data:r}=await _(V,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),n=await A(r.value);if(n){const h=new FileReader;h.onload=()=>{const M=h.result;O.value.ej2Instances.documentEditor.open(M),b("doc",M)},h.readAsText(n)}}catch(r){console.error("Erro ao carregar o modelo de minuta:",r)}},$=r=>{const n=O.value.ej2Instances.documentEditor,h=M=>{for(const[i,U]of Object.entries(M))if(/^<<.+>>$/.test(i))try{n.search.findAll(i),n.search.searchResults.length>0&&n.search.searchResults.replaceAll(U)}catch(o){console.error(`Erro ao substituir o marcador ${i}:`,o)}else if(i==="partes"&&Array.isArray(U)&&U.length>0)for(const o of U)typeof o=="object"&&h(o)};h(r)},C=r=>{y.value=r},G=()=>{const r=c.query.origem||"criar",n=c.query.id;switch(r){case"atualizar":case"vizualizar":l.push(`/os/atualizar/${n}`);break;case"atualizar-lista":case"vizualizar-lista":l.push("/atos/lista");break;default:l.push("/os/criar-registro");break}};return Fe(async()=>{await N(),x()}),(r,n)=>{const h=ye,M=Me;return d(),S(Pe,null,[a(e(Oe),{height:"900px",ref_key:"documentEditorContainer",ref:O,serviceUrl:fa,enableToolbar:!0,enableWordExport:!0},null,512),e(y)?(d(),S("div",_a,[a(Ne,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):L("",!0),a(I,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[a(h,{class:"mr-4"},{default:t(()=>[a(oe,{size:"large",onClick:G,color:"red"},{default:t(()=>n[2]||(n[2]=[X("Voltar")])),_:1})]),_:1}),e(T)?L("",!0):(d(),J(oe,{key:0,size:"large",color:"green",onClick:j,disabled:e(y)},{default:t(()=>n[3]||(n[3]=[X("Atualizar")])),_:1},8,["disabled"])),e(T)?L("",!0):(d(),J(oe,{key:1,class:"ml-4",size:"large",color:"blue",onClick:n[0]||(n[0]=i=>F.value=!0)},{default:t(()=>n[4]||(n[4]=[X("Gerar Minuta")])),_:1}))]),_:1}),a(M,{onConfirm:K,condMessage:e(k),show:e(F),onClose:n[1]||(n[1]=i=>F.value=!1)},null,8,["condMessage","show"])],64)}}},ya=["innerHTML"],Za={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(ne){let v,E;const w=ne,l=ve();Te(`${l.public.docEditor}`);const{$toast:c}=de(),b=me(),V=pe(),Y=`${l.public.managemant}/download`,P=`${l.public.managemant}/atos/files`,Q=`${l.public.managemant}/lavrarAto`,O=`${l.public.managemant}/valida_lavratura`,F=`${l.public.managemant}/listarEscrevente`,k=`${l.public.managemant}/ato_calcular`,T=s(R("user-data").value.cartorio_token),y=R("auth_token").value,A=s("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),z=s(null),N=s(""),x=s(!1),j=s(null),K=s(null),Z=s(V.query.origem==="vizualizar"),W=s(null),$=s([]),C=s({}),G=ge({escrevente:null}),r=async m=>{try{const f=await fetch(m);if(!f.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await f.blob()}catch(f){return console.error(f),null}},n=async()=>{try{const{data:m}=await _(`${P}/${V.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return m.value.link_ato}catch(m){console.error("Erro ao carregar o documento:",m),c.error(m)}},h=async()=>{try{const m=await n(),{data:f,status:ae}=await _(Y,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:m}},"$7ljqltMqa0"),te=f.value,ie=await r(te);if(ie){const se=new FileReader;se.onload=()=>{const ce=se.result;W.value.ej2Instances.documentEditor.open(ce)},se.readAsText(ie)}}catch{c.error("Erro ao carregar o documento.")}};h();const M=async(m=!1)=>{const f=W.value.ej2Instances.documentEditor.pageCount;try{if(!m){const{data:se}=await _(O,{method:"POST",body:{ato_token:V.query.ato_token_edit}},"$OWxZSQkyX8"),ce=se.value[0].status,he=se.value[0].status_mensagem;if(ce!=="OK"){z.value=ce,N.value=he,C.value=null,x.value=!0,A.value="O ato apresenta inconsistências, deseja prosseguir?";return}}const{data:ae,status:te,error:ie}=await _(Q,{method:"POST",body:{ato_token:V.query.ato_token_edit,qtd_paginas:f,escrevente_token:G.escrevente,usuario_token:y,cartorio_token:T}},"$sMqfUUQcBM");te.value==="success"?(j.value=ae.value,K.value=ae.value[0].selo,c.success("Ato lavrado com sucesso!")):c.error(ie.value.data[0].status_mensagem||"Falha ao lavrar o ato.")}catch{c.error("Erro ao conectar com o servidor.")}},i=async()=>{const m=W.value.ej2Instances.documentEditor.pageCount,{data:f,status:ae}=await _(k,{method:"POST",body:{ato_token:V.query.ato_token_edit,cartorio_token:T,quantidade:1,usuario_token:y,escrevente_token:G.escrevente,qtd_paginas:m}},"$OVwiKSwcOE");ae.value==="success"?C.value=f.value[0]:c.error("Falha ao calcular o ato.")},U=async()=>{x.value=!1,z.value&&z.value!=="OK"?(await M(!0),z.value=null,N.value=""):await M()},o=async()=>{x.value=!0,A.value="Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?",await i()},{data:g}=([v,E]=fe(()=>_(F,{method:"POST",body:{cartorio_token:T}},"$iv1N3XD6We")),v=await v,E(),v);$.value=g.value[0].func_json_escreventes;const H=()=>{const m=V.query.origem||"criar",f=V.query.id;switch(m){case"atualizar":case"vizualizar":b.push(`/os/atualizar/${f}`);break;case"atualizar-lista":case"vizualizar-lista":b.push("/atos/lista");break;default:b.push("/os/criar-registro");break}};return Be(()=>w.document,(m,f)=>{h()}),(m,f)=>{const ae=Me;return d(),S(Pe,null,[a(I,null,{default:t(()=>[a(B,null,{default:t(()=>[a(e(Oe),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:W,height:"850px",width:"850px"},null,512)]),_:1}),e(Z)?L("",!0):(d(),J(B,{key:0},{default:t(()=>[a(ke,{class:"mt-15",label:"Tabelião/escrevente",modelValue:e(G).escrevente,"onUpdate:modelValue":f[0]||(f[0]=te=>e(G).escrevente=te),items:e($),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),q("img",{onClick:f[1]||(f[1]=te=>o()),style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:ea}),e(j)?(d(),J(sa,{key:0,width:"360"},{default:t(()=>[a(I,null,{default:t(()=>[a(B,null,{default:t(()=>[a(Ae,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[a(B,null,{default:t(()=>[X(" Livro: "+be(e(j)[0].livro_numero),1)]),_:1}),a(B,null,{default:t(()=>[X(" Protocolo: "+be(e(j)[0].protocolo?e(j)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),a(B,null,{default:t(()=>[a(Ae,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:t(()=>[X(" Folhas : "+be(e(j)[0].pagina_inicial)+" A "+be(e(j)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),q("div",{style:{"margin-left":"10px","padding-bottom":"20px","margin-top":"-10px"},innerHTML:e(K)},null,8,ya)]),_:1})):L("",!0)]),_:1}))]),_:1}),a(oe,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:H},{default:t(()=>f[3]||(f[3]=[X("Voltar")])),_:1}),a(ae,{show:e(x),condMessage:e(A),valor:e(C),onClose:f[2]||(f[2]=te=>x.value=!1),onConfirm:U},null,8,["show","condMessage","valor"])],64)}}},ga=["onClick"],ha={key:0,style:{width:"30px",height:"30px"},src:Ee,alt:"Visualizar",title:"Reativar"},ba={key:1,src:Ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},et={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(ne){let v,E;const w=me(),l=pe(),c=ve(),{$toast:b}=de(),V=`${c.public.managemant}/listarEscrevente`;`${c.public.managemant}`;const Y=`${c.public.managemant}/atos_observacao`,P=`${c.public.managemant}/atos_observacao`,Q=`${c.public.managemant}/atos_observacao`,O=s(R("user-data").value.cartorio_token),F=s(l.query.origem==="vizualizar"),k=s([]),T=s([]),y=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],A=ge({observacao:""}),z={observacao:{required:De.withMessage("O campo é obrigatório",Se)}},N=je(z,A),{data:x}=([v,E]=fe(()=>_(`${Q}/${l.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),v=await v,E(),v);Array.isArray(x.value)?k.value=x.value.map($=>({...$,created:ze($.created,"dd/mm/yyyy hh:mm")})):x.value&&typeof x.value=="object"&&(k.value=[{...x.value,created:ze(x.value.created,"dd/mm/yyyy hh:mm")}]);async function j(){if(A.observacao.trim()===""){b.error("O campo de observação está vazio.");return}if(await N.value.$validate()){const{data:$,error:C,status:G}=await _(Y,{method:"POST",body:{ato_id:Number(l.query.ato_id),observacao:A.observacao,user_id:R("user-data").value.usuario_id}},"$gnHMo4uCXD");G.value==="success"&&(k.value.push({created:ze($.value.created,"dd/mm/yyyy hh:mm"),observacao:$.value.observacao,id:$.value.id,escrevente:R("user-data").value.nome}),A.observacao="",b.success("Observação registrada com sucesso"))}else b.error("Preencha os campos obrigatórios.")}async function K($){$.excluido=!$.excluido;try{await _(`${P}/${$.id}`,{method:"PUT",body:JSON.stringify({excluido:$.excluido})},"$sP9AKdd3Ky")}catch(C){console.error("Erro ao excluir observação:",C)}}const{data:Z}=([v,E]=fe(()=>_(V,{method:"POST",body:{cartorio_token:O}},"$HL9pndqGh0")),v=await v,E(),v);T.value=Z.value[0].func_json_escreventes;const W=()=>{const $=l.query.origem||"criar",C=l.query.id;switch($){case"atualizar":case"vizualizar":w.push(`/os/atualizar/${C}`);break;case"atualizar-lista":case"vizualizar-lista":w.push("/atos/lista");break;default:w.push("/os/criar-registro");break}};return($,C)=>{const G=ye;return d(),J(xe,null,{default:t(()=>[F.value?L("",!0):(d(),J(I,{key:0,class:"mt-5"},{default:t(()=>[a(ue,{label:"Observação",modelValue:A.observacao,"onUpdate:modelValue":C[0]||(C[0]=r=>A.observacao=r),required:"","error-messages":e(N).observacao.$errors.length>0?e(N).observacao.$errors.map(r=>r.$message):[],onBlur:e(N).observacao.$touch,onInput:e(N).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),q("div",null,[q("img",{class:"btn-pointer ml-2",src:$e,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:j})])]),_:1})),a(I,null,{default:t(()=>[a(B,null,{default:t(()=>[a(qe,{style:{height:"465px"},headers:y,items:k.value},{"item.actions":t(({item:r})=>[q("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:n=>K(r),title:"Deletar Observação"},[r.excluido?(d(),S("img",ha)):(d(),S("img",ba))],8,ga)]),_:1},8,["items"])]),_:1})]),_:1}),a(I,null,{default:t(()=>[a(G,{onClick:W},{default:t(()=>[a(oe,{size:"large",color:"red"},{default:t(()=>C[1]||(C[1]=[X("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},ka={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:He,alt:"Criar"},$a={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Je,alt:"Criar"},xa={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ra,alt:"Criar"},wa=["onClick"],za=["onClick"],Ca=["onClick"],Ea={key:0,style:{width:"30px",height:"30px"},src:Ee,alt:"Visualizar",title:"Reativar"},Va={key:1,src:Ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},at={__name:"Anexos",async setup(ne){let v,E;const w=ve(),{$toast:l}=de(),c=me(),b=pe(),V=s(b.query.origem==="vizualizar"),Y=`${w.public.biometria}/run-scanner`,P=`${w.public.managemant}/atos_anexos`,Q=`${w.public.managemant}/atos_anexos`,O=`${w.public.managemant}/download`,F=`${w.public.managemant}/atos_anexos`,k=`${w.public.managemant}/upload`,T=s(!1),y=s(null),A=s([]);R("pessoa_token");const z=ge({descricao:"",fileEvent:null}),N={descricao:{required:De.withMessage("O campo é obrigatório",Se)}},x=je(N,z,{$autoDirty:!0}),j=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:K}=([v,E]=fe(()=>_(`${F}/${b.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),v=await v,E(),v);A.value=K.value;async function Z(){try{await W(),await $()}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}}async function W(){try{const{data:o}=await _(Y,{method:"GET"},"$KttjFhHivJ")}catch(o){l.error("Erro ao acionar o scanner:",o)}}async function $(){try{const{data:o,status:g}=await _("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:b.query.ato_token_edit,cartorio_token:R("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(o){console.error("Erro ao enviar o arquivo:",o)}}async function C(){try{const o=document.createElement("input");o.type="file",o.accept="*/*",o.onchange=async g=>{z.fileEvent=g,g.target.files[0]&&(y.value=!0)},o.click()}catch(o){console.error("Erro ao abrir o explorador de arquivos:",o)}}const G=async()=>{T.value=!0};function r(o){return o?!0:(y.value=!1,!1)}const n=async o=>{if(!z.fileEvent||!z.fileEvent.target.files.length){l.error("Nenhum arquivo selecionado.");return}const g=z.fileEvent.target.files[0],H=new FormData;H.append("file",g),H.append("cartorio_token",R("user-data").value.cartorio_token),H.append("token",o),H.append("tipo","ato_anexo");try{const m=await _(k,{method:"POST",body:H},"$KDhIYzGKzM");l.success("Anexo registrado com sucesso!")}catch{l.error("Erro ao enviar o arquivo.")}},h=async()=>{if(x.value.$touch(),!x.value.$invalid&&r(z.fileEvent)){const{data:o,error:g,status:H}=await _(P,{method:"POST",body:{ato_id:b.query.ato_id,descricao:z.descricao,user_id:R("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$cdoFBGO0Ti");H.value==="success"&&(l.success("Anexo registrado com sucesso!"),A.value.push(o.value),n(o.value.token))}};async function M(o){o.excluido=!o.excluido;try{await _(`${Q}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$WLSrgYRoHq")}catch(g){console.error("Erro ao excluir pessoa:",g)}}async function i(o){try{const g=await _(`${O}`,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:o.link}},"$NdgRjioizH"),m=await(await fetch(g.data.value)).blob(),f=URL.createObjectURL(m);window.open(f,"_blank")}catch(g){console.error("Erro ao excluir pessoa:",g)}}const U=()=>{const o=b.query.origem||"criar",g=b.query.id;switch(o){case"atualizar":case"vizualizar":c.push(`/os/atualizar/${g}`);break;case"atualizar-lista":case"vizualizar-lista":c.push("/atos/lista");break;default:c.push("/os/criar-registro");break}};return(o,g)=>{const H=ye;return d(),J(xe,null,{default:t(()=>[a(I,null,{default:t(()=>[a(B,{cols:"5",class:"mt-2"},{default:t(()=>[e(V)?L("",!0):(d(),J(ue,{key:0,modelValue:e(z).descricao,"onUpdate:modelValue":[g[0]||(g[0]=m=>e(z).descricao=m),e(x).descricao.$touch],"error-messages":e(x).descricao.$errors.map(m=>m.$message),onBlur:e(x).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"]))]),_:1}),e(V)?L("",!0):(d(),S("div",{key:0,onClick:Z,title:"Escanear"},g[1]||(g[1]=[q("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ge,alt:"Escanear"},null,-1)]))),e(V)?L("",!0):(d(),S("div",{key:1,onClick:C,title:"Criar"},[e(y)===!1?(d(),S("img",ka)):e(y)===!0?(d(),S("img",$a)):(d(),S("img",xa))])),e(V)?L("",!0):(d(),S("div",{key:2,onClick:h,title:"Criar"},g[2]||(g[2]=[q("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:$e,alt:"Criar"},null,-1)])))]),_:1}),a(qe,{headers:j,items:e(A),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:m})=>[a(I,null,{default:t(()=>[q("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:f=>G(m),title:"Visualizar Anexo"},[q("img",{style:{width:"30px",height:"30px"},onClick:f=>i(m),src:Ce,alt:"Visualizar"},null,8,za)],8,wa),q("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:f=>M(m),title:"Deletar Pessoa"},[m.excluido?(d(),S("img",Ea)):(d(),S("img",Va))],8,Ca)]),_:2},1024)]),_:1},8,["items"]),a(H,{onClick:U},{default:t(()=>[a(oe,{size:"large",color:"red"},{default:t(()=>g[3]||(g[3]=[X("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Xa as _,Ya as a,Qa as b,Za as c,et as d,at as e};
