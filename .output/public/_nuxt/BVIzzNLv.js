import{r as b,A as i,B as q,S as D,o as t,c as f,a as w,b as c,x as v,D as L,w as V,I as n,J as E,z as $,bc as F,y as S,d as I,v as d,V as y}from"./DgXrkF5u.js";import{u as k}from"./D7zvLIPz.js";import{V as T}from"./BLKMo-uS.js";import{V as P}from"./DeovTI0r.js";import{V as O}from"./tfQVPjDb.js";import{V as Q}from"./ipD6B0nN.js";const z=w("h1",null,"Relatórios",-1),G={key:0},Y={__name:"lista",async setup(H){let m,h;const p=$(),B=`${p.public.managemant}/relatorios/buscar`,C=`${p.public.managemant}/relatorios`,U=`${p.public.managemant}/listaQuery`,_=b([]),u=b(null),r=b([]),g={user_token:i("auth_token").value,cartorio_token:i("user-data").value.cartorio_token,user_name:i("user-data").value.nome},{data:R}=([m,h]=q(()=>k(B,{method:"POST",body:g},"$53NFRNGH7x")),m=await m,h(),m);_.value=Array.isArray(R.value)?R.value:[];const A=D(()=>_.value.every(a=>!a.codigo&&!a.value&&!a.parametros)?[]:_.value.map(a=>({label:a.codigo,value:a.codigo,parametros:a.parametros}))),x=async a=>{const o=A.value.find(e=>e.value===a);if(o){r.value=o.parametros.map(e=>({...e,value:null,showDatePicker:!1,items:[]}));for(const e of r.value)if(e.tipo==="TABLE"&&e.dominio)try{const{data:s}=await k(U,{method:"POST",body:{cartorio_token:g.cartorio_token,parametros:e.dominio}},"$c4psqRQWRs");e.items=Array.isArray(s.value)?s.value.map(l=>({label:l.nome,value:l.token})):[]}catch(s){console.error("Erro ao buscar dados para TABLE:",s)}}else r.value=[]},N=async()=>{const a=r.value.reduce((o,e)=>(o[e.parametro]=e.value,o),{});try{const o={...a,user_id:i("user-data").value.usuario_id},{data:e}=await k(C,{method:"POST",body:o},"$6CLQJHdzNf");window.open(e.value,"_blank"),r.value=[],u.value=null}catch(o){console.error("Erro ao criar o relatório:",o)}};return(a,o)=>(t(),f(E,null,[z,w("div",null,[c(T,{modelValue:v(u),"onUpdate:modelValue":o[0]||(o[0]=e=>L(u)?u.value=e:null),items:v(A)||[],class:"mb-5","item-title":"label","item-value":"value",label:"Selecione o relatório",required:"","onUpdate:search":x},null,8,["modelValue","items"])]),v(u)?(t(),f("div",G,[c(P,null,{default:V(()=>[(t(!0),f(E,null,F(v(r),(e,s)=>(t(),d(O,{key:s},{default:V(()=>[c(Q,{cols:"4"},{default:V(()=>[e.tipo!=="DATE"&&e.tipo!=="TABLE"?(t(),d(y,{key:0,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,label:e.label,required:e.obrigatorio},null,8,["modelValue","onUpdate:modelValue","label","required"])):n("",!0),e.tipo==="INTEGER"?(t(),d(y,{key:1,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,type:"number",outlined:""},null,8,["modelValue","onUpdate:modelValue"])):n("",!0),e.tipo==="DATE"?(t(),d(y,{key:2,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,type:"date"},null,8,["modelValue","onUpdate:modelValue"])):n("",!0),e.tipo==="TABLE"?(t(),d(T,{key:3,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,items:e.items,"item-title":"label","item-value":"value",label:e.label,required:e.obrigatorio},null,8,["modelValue","onUpdate:modelValue","items","label","required"])):n("",!0)]),_:2},1024)]),_:2},1024))),128)),c(S,{color:"green",class:"mt-4",onClick:N},{default:V(()=>[I("Enviar")]),_:1})]),_:1})])):n("",!0)],64))}};export{Y as default};
