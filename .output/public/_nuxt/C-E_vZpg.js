import{_ as pe}from"./CbgngSdL.js";import{u as re,D as de,H as ne,r,E as ve,o as b,C as Y,w as t,b as o,s as e,V as ue,z as K,d as X,J as Q,A as le,m as R,I as me,a as V,c as L,v as ge,N as Je,n as Le,O as Be,F as Ve,g as ze,P as $e,t as ye}from"./qheerGNG.js";import{u as g}from"./CoczidDA.js";import{V as N}from"./B5KVOyE5.js";import{V as B}from"./CKSFl6j_.js";import{V as ce}from"./BoncRjJN.js";import{V as fe}from"./cAyW47ab.js";import{_ as Ye,a as We}from"./DmcWjkco.js";import{_ as Ze,a as Qe,b as Xe,T as He,W as Ge,S as Ke,r as Se,D as Te,c as eo,d as oo,e as to,f as ao}from"./BqPAIv4C.js";import{_ as Ae}from"./C3EZu-wy.js";import{_ as _e}from"./BVz1G1IN.js";import{_ as so}from"./r63YAuEk.js";import{_ as he,a as xe}from"./DJvq3mCv.js";import{V as we}from"./DP0qnU88.js";import{V as Ee}from"./BrH7nplV.js";import{V as Ce,c as ro}from"./CPGezLnt.js";import{_ as Pe}from"./BZ8-V5M7.js";import{c as De,r as qe,u as Me}from"./DzecWvFS.js";import{f as ke}from"./B0IxRygJ.js";const Zo={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(ae){const f=ae,{$toast:E}=re(),h=le(),p=de(),u=ne(),y=`${h.public.managemant}/updateAtos`,C=r(f.item_situacoes),W=r(u.query.origem==="vizualizar"),P=ve({dt_abertura:f.item_dados[0].dt_abertura||null,status:f.item_dados[0].status||null,mne:f.item_dados[0].mne||null});async function Z(){const{data:z,error:k,status:I}=await g(`${y}/${u.query.ato_id}`,{method:"PUT",body:{status:P.status,mne:P.mne,dt_abertura:P.dt_abertura}},"$EIT5jtTUdX");I.value==="success"&&E.success("Ato Atualizado com sucesso")}const S=()=>{const z=u.query.origem||"criar",k=u.query.id;z==="atualizar"||z==="vizualizar"?p.push(`/os/atualizar/${k}`):p.push("/os/criar-registro")};return(z,k)=>{const I=pe;return b(),Y(fe,null,{default:t(()=>[o(N,{class:"mt-5"},{default:t(()=>[o(B,{cols:"3"},{default:t(()=>[o(ce,{label:"Situação",modelValue:e(P).status,"onUpdate:modelValue":k[0]||(k[0]=v=>e(P).status=v),items:e(C),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),o(N,null,{default:t(()=>[o(B,{cols:"5"},{default:t(()=>[o(ue,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:e(P).mne,"onUpdate:modelValue":k[1]||(k[1]=v=>e(P).mne=v)},null,8,["modelValue"])]),_:1})]),_:1}),o(N,null,{default:t(()=>[o(B,{cols:"2"},{default:t(()=>[o(ue,{modelValue:e(P).dt_abertura,"onUpdate:modelValue":k[2]||(k[2]=v=>e(P).dt_abertura=v),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),o(N,{class:"mb-3"},{default:t(()=>[o(I,{onClick:S},{default:t(()=>[o(K,{size:"large",color:"red"},{default:t(()=>k[3]||(k[3]=[X("Voltar")])),_:1})]),_:1}),e(W)?Q("",!0):(b(),Y(K,{key:0,class:"ml-10",onClick:Z,size:"large",color:"green"},{default:t(()=>k[4]||(k[4]=[X("Atualizar")])),_:1}))]),_:1})]),_:1})}}},no={key:0},lo=["onClick"],io=["onClick"],uo=["onClick"],co={key:0,style:{width:"30px",height:"30px"},src:he,alt:"Visualizar",title:"Reativar"},mo={key:1,src:xe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},po=["onClick"],Qo={__name:"Partes",async setup(ae){let f,E;const h=de(),p=ne(),u=le(),{$toast:y}=re(),C=`${u.public.managemant}/pesquisarPessoas`,W=`${u.public.managemant}/listarPapeis`,P=`${u.public.managemant}/getLinkTipo`,Z=`${u.public.managemant}/createAtosPessoa`,S=`${u.public.managemant}/updateAtosPessoa`,z=`${u.public.managemant}/getAtosPessoaById`,k=`${u.public.managemant}/download`,I=r(R("user-data").value.cartorio_token),v=r(p.query.origem==="vizualizar"),x=r([]),T=r([]),j=r([]),$=r(!1),D=r(!1),c=r(!1),F=r(!1),oe=r(null),w=r(null),M=r(null),H=r(null),n=r(null),i=r(p.query.tipo_ato_token),s=r(null),d=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],m=ve({papeis:null,nome:null,pessoa:null,documento:null}),{data:q}=([f,E]=me(()=>g(W,{method:"POST",body:{tipo_ato_token:p.query.tipo_ato_token}},"$acoiTIUp00")),f=await f,E(),f);j.value=q.value;const a=async()=>{const{data:A}=await g(`${z}/${p.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),G=(se=>se.map(ee=>({...ee,pessoa:{...ee.pessoa,documento:ee.pessoa.doc_identificacao},papel:{...ee.partes_tipos}})))(A.value);T.value=G};a();async function _(){try{const{data:A,error:l}=await g(C,{method:"POST",body:{cartorio_token:I.value,documento:m.documento,nome:m.nome}},"$pr30MyPXfY");A.value.length>0?(x.value=A.value,m.pessoa=x.value[0]):x.value=[]}catch(A){console.error("Erro na requisição",A)}}const J=()=>{D.value=!0},U=async()=>{await a()},ie=async()=>{await a()},Oe=async()=>{const A={pessoa:m.pessoa,papel:j.value.find(te=>te.id===m.papeis),representante:{nome:null}},l=await g(`${z}/${p.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const te of l.data.value)if(te.pessoa_id===m.pessoa.id&&te.ato_id===Number(p.query.ato_id)&&te.tipo_parte_id===m.papeis){y.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:G,error:se,status:ee}=await g(Z,{method:"POST",body:{ato_id:Number(p.query.ato_id),pessoa_id:m.pessoa.id,tipo_parte_id:m.papeis,user_id:R("user-data").value.usuario_id}},"$18isAgOJxG");ee.value==="success"?(A.id=G.value.id,y.success("Pessoa Registrada com Sucesso!"),T.value.push(A)):y.error(se.value.message)},Re=async A=>{var te;if(c.value=!0,s.value=null,!A.pessoa.id)return;const{data:l}=await g(P,{method:"POST",body:{tipo:"ficha",id:A.pessoa.id}},"$hmDzSF3F61");if(!((te=l.value)!=null&&te.link))return;const{data:G}=await g(k,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:l.value.link}},"$l09I6nLRfk"),se=l.value.link,ee=G.value;/\.(tr7|tiff)$/i.test(se)?s.value=ee:fotoRender.value=`data:image/jpeg;base64,${ee}`},Fe=A=>{const l=T.value.filter(G=>G.pessoa.id!==A.pessoa.id).map(G=>({id:G.pessoa.id,nome:G.pessoa.nome}));M.value=A.id,oe.value=l,$.value=!0,w.value=A.pessoa.nome,n.value=A.pessoa.id},Ne=A=>{F.value=!0,H.value=A.id,w.value=A.pessoa.nome};async function je(A){A.excluido=!A.excluido;try{await g(`${S}/${A.id}`,{method:"PUT",body:JSON.stringify({excluido:A.excluido})},"$PUt0nEhmBF")}catch(l){console.error("Erro ao excluir pessoa:",l)}}const Ue=()=>{const A=p.query.origem||"criar",l=p.query.id;A==="atualizar"||A==="vizualizar"?h.push(`/os/atualizar/${l}`):h.push("/os/criar-registro")};return(A,l)=>{const G=Ye,se=Qe,ee=Xe,te=We,Ie=pe;return b(),Y(fe,null,{default:t(()=>[e(v)?Q("",!0):(b(),Y(N,{key:0,class:"mt-5"},{default:t(()=>[o(B,{cols:"3"},{default:t(()=>[o(ue,{label:"Documento",modelValue:e(m).documento,"onUpdate:modelValue":l[0]||(l[0]=O=>e(m).documento=O)},null,8,["modelValue"])]),_:1}),o(B,{cols:"4"},{default:t(()=>[o(ue,{label:"Pessoa",modelValue:e(m).nome,"onUpdate:modelValue":l[1]||(l[1]=O=>e(m).nome=O)},null,8,["modelValue"])]),_:1}),V("div",null,[V("img",{class:"mt-1",src:Ae,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:_})]),V("div",null,[V("img",{class:"mt-1 ml-2",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:J})])]),_:1})),e(v)?Q("",!0):(b(),Y(N,{key:1},{default:t(()=>[o(B,{cols:"4"},{default:t(()=>[o(ce,{label:"Selecione a Pessoa",modelValue:e(m).pessoa,"onUpdate:modelValue":l[2]||(l[2]=O=>e(m).pessoa=O),items:e(x),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),o(B,{cols:"3"},{default:t(()=>[o(ce,{label:"Papel",modelValue:e(m).papeis,"onUpdate:modelValue":l[3]||(l[3]=O=>e(m).papeis=O),items:e(j),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(v)?Q("",!0):(b(),L("div",no,[V("img",{class:"mt-1",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Oe})]))]),_:1})),o(N,null,{default:t(()=>[o(B,null,{default:t(()=>[o(we,{style:{height:"465px"},headers:d,items:e(T)},{"item.actions":t(({item:O})=>[e(v)?Q("",!0):(b(),Y(N,{key:0},{default:t(()=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:be=>Re(O),title:"Visualizar Ficha"},l[9]||(l[9]=[V("img",{style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar"},null,-1)]),8,lo),V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:be=>Ne(O),class:"mr-2",title:"Alterar Papel"},l[10]||(l[10]=[V("img",{style:{width:"30px",height:"30px"},src:so,alt:"Visualizar"},null,-1)]),8,io),V("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:be=>je(O),title:"Deletar Pessoa"},[O.excluido?(b(),L("img",co)):(b(),L("img",mo))],8,uo),V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:be=>Fe(O),title:"Selecionar Representante"},l[11]||(l[11]=[V("img",{style:{width:"30px",height:"30px"},src:Ze,alt:"Visualizar"},null,-1)]),8,po)]),_:2},1024))]),_:1},8,["items"])]),_:1})]),_:1}),o(G,{show:e(D),onClose:l[4]||(l[4]=O=>D.value=!1)},null,8,["show"]),o(se,{representante_nome:e(w),representantes:e(oe),ato_id:e(M),show:e($),onClose:l[5]||(l[5]=O=>$.value=!1),onUpdateRepresentante:ie},null,8,["representante_nome","representantes","ato_id","show"]),o(ee,{representante_nome:e(w),ato_token:e(i),ato_id:e(H),show:e(F),onClose:l[6]||(l[6]=O=>F.value=!1),onUpdatePapel:U},null,8,["representante_nome","ato_token","ato_id","show"]),o(Ee,{modelValue:e(c),"onUpdate:modelValue":l[8]||(l[8]=O=>ge(c)?c.value=O:null),width:"600"},{default:t(()=>[o(Ce,{"max-width":"600",title:"Ficha"},{default:t(()=>[o(te,{"tiff-url":e(s)},null,8,["tiff-url"]),o(K,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:l[7]||(l[7]=O=>c.value=!1)})]),_:1})]),_:1},8,["modelValue"]),o(N,null,{default:t(()=>[o(Ie,{onClick:Ue},{default:t(()=>[o(K,{size:"large",color:"red"},{default:t(()=>l[12]||(l[12]=[X("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},vo={key:0,class:"loading-overlay"},fo="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Xo={__name:"Minuta",emits:["page","doc"],setup(ae,{emit:f}){Je("DocumentEditorContainer",[He,Ge,Ke]);const E=le(),{$toast:h}=re(),p=de(),u=ne(),y=f;Se(`${E.public.docEditor}`);const C=`${E.public.managemant}/download`,W=`${E.public.managemant}/atos/files`,P=`${E.public.managemant}/subitituirModelo`,Z=`${E.public.managemant}/upload`,S=r(null),z=r(!1),k=r("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),I=r(u.query.origem==="vizualizar"),v=r(!1),x=async n=>{try{const i=await fetch(n);if(!i.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await i.blob()}catch(i){return console.error(i),null}},T=async()=>{try{const{data:n}=await g(`${W}/${u.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return n.value.link_ato}catch(n){console.error("Erro ao carregar o documento:",n),h.error(n)}},j=async()=>{v.value=!0;try{const n=await T(),{data:i,status:s}=await g(C,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:n}},"$dvNFfvmIJC"),d=i.value,m=await x(d);if(m){const q=new FileReader;q.onload=()=>{const a=q.result;S.value.ej2Instances.documentEditor.open(a),y("doc",a)},q.readAsText(m)}}catch{console.error("Erro ao carregar o documento.")}finally{v.value=!1}},$=async()=>{const i=await S.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),s=new FileReader;s.onload=()=>{const d=s.result,q=S.value.ej2Instances.documentEditor.pageCount;y("page",q),y("doc",d)},s.readAsText(i)},D=async()=>{v.value=!0;try{const i=await S.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),s=new FormData;s.append("file",i,"anexo.sfdt"),s.append("cartorio_token",R("user-data").value.cartorio_token),s.append("token",u.query.ato_token_edit),s.append("tipo","ato_minuta");const{data:d,status:m}=await g(Z,{method:"POST",body:s},"$xv11VtUdMy");if(m.value==="success"){h.success("Documento enviado!");const a=S.value.ej2Instances.documentEditor.pageCount;$(),y("page",a)}else h.error("Erro ao enviar documento para o sistema.")}catch(n){h.error("Erro ao salvar documento."),console.error(n)}finally{v.value=!1}},c=()=>{z.value=!1,F()},F=async()=>{M(!0);try{await oe(),M(!0);const{data:n,status:i}=await g(P,{method:"POST",body:{ato_token:u.query.ato_token_edit}},"$zyzWHTXTBW");n.value&&w(n.value)}catch(n){console.error("Erro ao gerar a minuta:",n),h.error("Ocorreu um erro ao gerar a minuta.")}finally{M(!1)}},oe=async()=>{try{const{data:n}=await g(C,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),i=await x(n.value);if(i){const s=new FileReader;s.onload=()=>{const d=s.result;S.value.ej2Instances.documentEditor.open(d),y("doc",d)},s.readAsText(i)}}catch(n){console.error("Erro ao carregar o modelo de minuta:",n)}},w=n=>{const i=S.value.ej2Instances.documentEditor,s=d=>{for(const[m,q]of Object.entries(d))if(/^<<.+>>$/.test(m))try{i.search.findAll(m),i.search.searchResults.length>0&&i.search.searchResults.replaceAll(q)}catch(a){console.error(`Erro ao substituir o marcador ${m}:`,a)}else if(m==="partes"&&Array.isArray(q)&&q.length>0)for(const a of q)typeof a=="object"&&s(a)};s(n)},M=n=>{v.value=n},H=()=>{const n=u.query.origem||"criar",i=u.query.id;n==="atualizar"||n==="vizualizar"?p.push(`/os/atualizar/${i}`):p.push("/os/criar-registro")};return Le(async()=>{await j(),$()}),(n,i)=>{const s=pe,d=Pe;return b(),L(Ve,null,[o(e(Te),{height:"900px",ref_key:"documentEditorContainer",ref:S,serviceUrl:fo,enableToolbar:!0,enableWordExport:!0},null,512),e(v)?(b(),L("div",vo,[o(Be,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):Q("",!0),o(N,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[o(s,{class:"mr-4"},{default:t(()=>[o(K,{size:"large",onClick:H,color:"red"},{default:t(()=>i[2]||(i[2]=[X("Voltar")])),_:1})]),_:1}),e(I)?Q("",!0):(b(),Y(K,{key:0,size:"large",color:"green",onClick:D,disabled:e(v)},{default:t(()=>i[3]||(i[3]=[X("Atualizar")])),_:1},8,["disabled"])),e(I)?Q("",!0):(b(),Y(K,{key:1,class:"ml-4",size:"large",color:"blue",onClick:i[0]||(i[0]=m=>z.value=!0)},{default:t(()=>i[4]||(i[4]=[X("Gerar Minuta")])),_:1}))]),_:1}),o(d,{onConfirm:c,condMessage:e(k),show:e(z),onClose:i[1]||(i[1]=m=>z.value=!1)},null,8,["condMessage","show"])],64)}}},yo=["innerHTML"],Ho={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(ae){let f,E;const h=ae,p=le();Se(`${p.public.docEditor}`);const{$toast:u}=re(),y=de(),C=ne(),W=`${p.public.managemant}/download`,P=`${p.public.managemant}/atos/files`,Z=`${p.public.managemant}/lavrarAto`,S=`${p.public.managemant}/listarEscrevente`,z=r(R("user-data").value.cartorio_token),k=R("auth_token").value,I=r("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),v=r(!1),x=r(null),T=r(null),j=r(C.query.origem==="vizualizar"),$=r(null),D=r([]),c=ve({escrevente:null}),F=async s=>{try{const d=await fetch(s);if(!d.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await d.blob()}catch(d){return console.error(d),null}},oe=async()=>{try{const{data:s}=await g(`${P}/${C.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return s.value.link_ato}catch(s){console.error("Erro ao carregar o documento:",s),u.error(s)}},w=async()=>{try{const s=await oe(),{data:d,status:m}=await g(W,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:s}},"$7ljqltMqa0"),q=d.value,a=await F(q);if(a){const _=new FileReader;_.onload=()=>{const J=_.result;$.value.ej2Instances.documentEditor.open(J)},_.readAsText(a)}}catch{u.error("Erro ao carregar o documento.")}};w();const M=async()=>{try{const{data:s,status:d}=await g(Z,{method:"POST",body:{ato_token:C.query.ato_token_edit,qtd_paginas:h.pages,escrevente_token:c.escrevente,usuario_token:k,cartorio_token:z}},"$OWxZSQkyX8");d.value==="success"?(x.value=s.value,T.value=s.value[0].selo,u.success("Ato lavrado com sucesso!")):u.error("Falha ao lavrar o ato.")}catch{u.error("Erro ao conectar com o servidor.")}},H=()=>{v.value=!1,M()},{data:n}=([f,E]=me(()=>g(S,{method:"POST",body:{cartorio_token:z}},"$sMqfUUQcBM")),f=await f,E(),f);D.value=n.value[0].func_json_escreventes;const i=()=>{const s=C.query.origem||"criar",d=C.query.id;s==="atualizar"&&(s==="atualizar"||s==="vizualizar"?y.push(`/os/atualizar/${d}`):y.push("/os/criar-registro"))};return ze(()=>h.document,(s,d)=>{w()}),(s,d)=>{const m=Pe;return b(),L(Ve,null,[o(N,null,{default:t(()=>[o(B,null,{default:t(()=>[o(e(Te),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:$,height:"850px",width:"850px"},null,512)]),_:1}),e(j)?Q("",!0):(b(),Y(B,{key:0},{default:t(()=>[o(ce,{class:"mt-15",label:"Tabelião/escrevente",modelValue:e(c).escrevente,"onUpdate:modelValue":d[0]||(d[0]=q=>e(c).escrevente=q),items:e(D),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),V("img",{onClick:d[1]||(d[1]=q=>v.value=!0),style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:eo}),e(x)?(b(),Y(Ce,{key:0,width:"360"},{default:t(()=>[o(N,null,{default:t(()=>[o(B,null,{default:t(()=>[o($e,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[o(B,null,{default:t(()=>[X(" Livro: "+ye(e(x)[0].livro_numero)+" Protocolo: "+ye(e(x)[0].protocolo?e(x)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),o(B,null,{default:t(()=>[o($e,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:t(()=>[X(" Folhas : "+ye(e(x)[0].pagina_inicial)+" A "+ye(e(x)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),V("div",{style:{"margin-left":"10px","padding-bottom":"20px","margin-top":"-10px"},innerHTML:e(T)},null,8,yo)]),_:1})):Q("",!0)]),_:1}))]),_:1}),o(K,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:i},{default:t(()=>d[3]||(d[3]=[X("Voltar")])),_:1}),o(m,{show:e(v),condMessage:e(I),onClose:d[2]||(d[2]=q=>v.value=!1),onConfirm:H},null,8,["show","condMessage"])],64)}}},go=["onClick"],_o={key:0,style:{width:"30px",height:"30px"},src:he,alt:"Visualizar",title:"Reativar"},bo={key:1,src:xe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Go={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(ae){let f,E;const h=de(),p=ne(),u=le(),{$toast:y}=re(),C=`${u.public.managemant}/listarEscrevente`;`${u.public.managemant}`;const W=`${u.public.managemant}/atos_observacao`,P=`${u.public.managemant}/atos_observacao`,Z=`${u.public.managemant}/atos_observacao`,S=r(R("user-data").value.cartorio_token),z=r(p.query.origem==="vizualizar"),k=r([]),I=r([]),v=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],x=ve({observacao:""}),T={observacao:{required:De.withMessage("O campo é obrigatório",qe)}},j=Me(T,x),{data:$}=([f,E]=me(()=>g(`${Z}/${p.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),f=await f,E(),f);Array.isArray($.value)?k.value=$.value.map(w=>({...w,created:ke(w.created,"dd/mm/yyyy hh:mm")})):$.value&&typeof $.value=="object"&&(k.value=[{...$.value,created:ke($.value.created,"dd/mm/yyyy hh:mm")}]);async function D(){if(x.observacao.trim()===""){y.error("O campo de observação está vazio.");return}if(await j.value.$validate()){const{data:w,error:M,status:H}=await g(W,{method:"POST",body:{ato_id:Number(p.query.ato_id),observacao:x.observacao,user_id:R("user-data").value.usuario_id}},"$gnHMo4uCXD");H.value==="success"&&(k.value.push({created:ke(w.value.created,"dd/mm/yyyy hh:mm"),observacao:w.value.observacao,id:w.value.id,escrevente:R("user-data").value.nome}),x.observacao="",y.success("Observação registrada com sucesso"))}else y.error("Preencha os campos obrigatórios.")}async function c(w){w.excluido=!w.excluido;try{await g(`${P}/${w.id}`,{method:"PUT",body:JSON.stringify({excluido:w.excluido})},"$sP9AKdd3Ky")}catch(M){console.error("Erro ao excluir observação:",M)}}const{data:F}=([f,E]=me(()=>g(C,{method:"POST",body:{cartorio_token:S}},"$HL9pndqGh0")),f=await f,E(),f);I.value=F.value[0].func_json_escreventes;const oe=()=>{const w=p.query.origem||"criar",M=p.query.id;w==="atualizar"||w==="vizualizar"?h.push(`/os/atualizar/${M}`):h.push("/os/criar-registro")};return(w,M)=>{const H=pe;return b(),Y(fe,null,{default:t(()=>[z.value?Q("",!0):(b(),Y(N,{key:0,class:"mt-5"},{default:t(()=>[o(ue,{label:"Observação",modelValue:x.observacao,"onUpdate:modelValue":M[0]||(M[0]=n=>x.observacao=n),required:"","error-messages":e(j).observacao.$errors.length>0?e(j).observacao.$errors.map(n=>n.$message):[],onBlur:e(j).observacao.$touch,onInput:e(j).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),V("div",null,[V("img",{class:"btn-pointer ml-2",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:D})])]),_:1})),o(N,null,{default:t(()=>[o(B,null,{default:t(()=>[o(we,{style:{height:"465px"},headers:v,items:k.value},{"item.actions":t(({item:n})=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:i=>c(n),title:"Deletar Observação"},[n.excluido?(b(),L("img",_o)):(b(),L("img",bo))],8,go)]),_:1},8,["items"])]),_:1})]),_:1}),o(N,null,{default:t(()=>[o(H,{onClick:oe},{default:t(()=>[o(K,{size:"large",color:"red"},{default:t(()=>M[1]||(M[1]=[X("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},ko="data:image/png;base64,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",Ao={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:to,alt:"Criar"},ho={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ao,alt:"Criar"},xo={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ko,alt:"Criar"},wo=["onClick"],Co=["onClick"],$o=["onClick"],Vo={key:0,style:{width:"30px",height:"30px"},src:he,alt:"Visualizar",title:"Reativar"},zo={key:1,src:xe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ko={__name:"Anexos",async setup(ae){let f,E;const h=le(),{$toast:p}=re(),u=de(),y=ne(),C=r(y.query.origem==="vizualizar"),W=`${h.public.biometria}/run-scanner`,P=`${h.public.managemant}/atos_anexos`,Z=`${h.public.managemant}/atos_anexos`,S=`${h.public.managemant}/download`,z=`${h.public.managemant}/atos_anexos`,k=`${h.public.managemant}/upload`,I=r(!1),v=r(null),x=r([]);R("pessoa_token");const T=ve({descricao:"",fileEvent:null}),j={descricao:{required:De.withMessage("O campo é obrigatório",qe)}},$=Me(j,T,{$autoDirty:!0}),D=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:c}=([f,E]=me(()=>g(`${z}/${y.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),f=await f,E(),f);x.value=c.value;async function F(){try{await oe(),await w()}catch(a){console.error("Erro ao executar scanner ou listar arquivos:",a)}}async function oe(){try{const{data:a}=await g(W,{method:"GET"},"$KttjFhHivJ")}catch(a){p.error("Erro ao acionar o scanner:",a)}}async function w(){try{const{data:a,status:_}=await g("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:y.query.ato_token_edit,cartorio_token:R("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(a){console.error("Erro ao enviar o arquivo:",a)}}async function M(){try{const a=document.createElement("input");a.type="file",a.accept="*/*",a.onchange=async _=>{T.fileEvent=_,_.target.files[0]&&(v.value=!0)},a.click()}catch(a){console.error("Erro ao abrir o explorador de arquivos:",a)}}const H=async()=>{I.value=!0};function n(a){return a?(console.log("Arquivo válido:",a.name),!0):(console.error("Erro: Nenhum arquivo foi selecionado!"),v.value=!1,!1)}const i=async a=>{if(!T.fileEvent||!T.fileEvent.target.files.length){console.error("Nenhum arquivo selecionado."),p.error("Nenhum arquivo selecionado.");return}const _=T.fileEvent.target.files[0];console.log("Arquivo selecionado:",_);const J=new FormData;J.append("file",_),J.append("cartorio_token",R("user-data").value.cartorio_token),J.append("token",a),J.append("tipo","ato_anexo");try{const U=await g(k,{method:"POST",body:J},"$KDhIYzGKzM");console.log("Resposta do servidor:",U.data),p.success("Anexo registrado com sucesso!")}catch(U){console.error("Erro ao enviar o arquivo:",U),p.error("Erro ao enviar o arquivo.")}},s=async()=>{if($.value.$touch(),!$.value.$invalid&&n(T.fileEvent)){const{data:a,error:_,status:J}=await g(P,{method:"POST",body:{ato_id:y.query.ato_id,descricao:T.descricao,user_id:R("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$cdoFBGO0Ti");J.value==="success"&&(p.success("Anexo registrado com sucesso!"),x.value.push(a.value),console.log(`createAnexo
`,a.value.token),i(a.value.token))}};async function d(a){a.excluido=!a.excluido;try{await g(`${Z}/${a.id}`,{method:"PUT",body:JSON.stringify({excluido:a.excluido})},"$WLSrgYRoHq")}catch(_){console.error("Erro ao excluir pessoa:",_)}}async function m(a){try{const _=await g(`${S}`,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:a.link}},"$NdgRjioizH"),U=await(await fetch(_.data.value)).blob(),ie=URL.createObjectURL(U);window.open(ie,"_blank")}catch(_){console.error("Erro ao excluir pessoa:",_)}}const q=()=>{const a=y.query.origem||"criar",_=y.query.id;a==="atualizar"||a==="vizualizar"?u.push(`/os/atualizar/${_}`):u.push("/os/criar-registro")};return(a,_)=>{const J=pe;return b(),Y(fe,null,{default:t(()=>[o(N,null,{default:t(()=>[o(B,{cols:"5",class:"mt-2"},{default:t(()=>[e(C)?Q("",!0):(b(),Y(ue,{key:0,modelValue:e(T).descricao,"onUpdate:modelValue":[_[0]||(_[0]=U=>e(T).descricao=U),e($).descricao.$touch],"error-messages":e($).descricao.$errors.map(U=>U.$message),onBlur:e($).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"]))]),_:1}),e(C)?Q("",!0):(b(),L("div",{key:0,onClick:F,title:"Escanear"},_[1]||(_[1]=[V("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:oo,alt:"Escanear"},null,-1)]))),V("div",{onClick:M,title:"Criar"},[e(v)===!1?(b(),L("img",Ao)):e(v)===!0?(b(),L("img",ho)):(b(),L("img",xo))]),e(C)?Q("",!0):(b(),L("div",{key:1,onClick:s,title:"Criar"},_[2]||(_[2]=[V("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:_e,alt:"Criar"},null,-1)])))]),_:1}),o(we,{headers:D,items:e(x),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:U})=>[o(N,null,{default:t(()=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ie=>H(U),title:"Visualizar Anexo"},[V("img",{style:{width:"30px",height:"30px"},onClick:ie=>m(U),src:Ae,alt:"Visualizar"},null,8,Co)],8,wo),V("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ie=>d(U),title:"Deletar Pessoa"},[U.excluido?(b(),L("img",Vo)):(b(),L("img",zo))],8,$o)]),_:2},1024)]),_:1},8,["items"]),o(J,{onClick:q},{default:t(()=>[o(K,{size:"large",color:"red"},{default:t(()=>_[3]||(_[3]=[X("Voltar")])),_:1})]),_:1})]),_:1})}}},et={__name:"TiposAtos",props:{show:Boolean,servicos:Array,tiposAtos:Array},emits:["close","update-ato"],setup(ae,{emit:f}){const h=r(ae.show),{$toast:p}=re(),u=ne(),y=r(""),C=r(""),W=le(),P=R("auth_token").value,Z=r(R("user-data").value.cartorio_token).value,S=r([]),z=r([]),k=f,I=`${W.public.managemant}/updateAtos`,v=`${W.public.managemant}/tipoAtos`,x=async()=>{const{data:D}=await g(v,{method:"POST",body:{usuario_token:P,cartorio_token:Z}},"$6VlNS7ylT6");S.value=D.value,S.value.length>0&&(y.value=S.value[0])},T=async D=>{const{data:c}=await g(v,{method:"POST",body:{usuario_token:P,cartorio_token:Z,servico_token:D}},"$pRqAaiCpuA");z.value=c.value},j=async()=>{const{data:D,status:c}=await g(`${I}/${u.query.ato_id}`,{method:"PUT",body:{ato_tipo_id:C.value.id}},"$Qxfq8aWnXP");c.value==="success"&&(p.success("Tipo de ato atualizado com Sucesso!"),k("update-ato",{descricao:`${y.value.descricao} - ${C.value.descricao}`,usaImoveisParams:C.value.usa_imoveis}),$())},$=()=>{h.value=!1,k("close")};return ze(y,async D=>{D&&(await T(D.token),C.value=z.value.length>0?z.value[0]:null)}),x(),(D,c)=>(b(),Y(Ee,{persistent:"",modelValue:e(h),"onUpdate:modelValue":c[3]||(c[3]=F=>ge(h)?h.value=F:null),"max-width":"500"},{default:t(()=>[o(Ce,null,{default:t(()=>[o(fe,null,{default:t(()=>[o(N,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:t(()=>c[4]||(c[4]=[V("h1",{class:"ml-4"},"Tipos de Atos",-1)])),_:1}),c[5]||(c[5]=V("hr",{class:"mb-5"},null,-1)),o(ce,{"item-title":"descricao","item-value":"token",class:"mb-5",label:"Selecione o Serviço",modelValue:e(y),"onUpdate:modelValue":c[0]||(c[0]=F=>ge(y)?y.value=F:null),items:e(S),"return-object":""},null,8,["modelValue","items"]),o(ce,{"item-title":"descricao","item-value":"id",class:"mb-5",label:"Selecione o Tipo de Ato",modelValue:e(C),"onUpdate:modelValue":c[1]||(c[1]=F=>ge(C)?C.value=F:null),items:e(z),"return-object":""},null,8,["modelValue","items"])]),_:1}),o(ro,null,{default:t(()=>[o(K,{style:{"background-color":"red",color:"white"},onClick:$},{default:t(()=>c[6]||(c[6]=[X("Voltar")])),_:1}),o(K,{style:{"background-color":"green",color:"white"},onClick:c[2]||(c[2]=F=>j())},{default:t(()=>c[7]||(c[7]=[X("Salvar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{et as _,Zo as a,Qo as b,Xo as c,Ho as d,Go as e,Ko as f};
