import{_ as g}from"./Br1w0fcs.js";import{_ as q}from"./OTRi8R3b.js";import{_ as B}from"./D78SZ3iw.js";import{u as A,C as I,r as n,m,D as z,n as P,E as J,G as M,w as r,s as F,o as Y,b as s,a as i,V as j,y as k,z as p,B as G}from"./BLppTzvE.js";import{u as C,V as _}from"./CfqRZs9Q.js";import{V as H}from"./BKk7OEjz.js";import{V as u}from"./BeSjWRLd.js";import{V as y}from"./BdREAPZc.js";import{V as L}from"./pGV9wKJL.js";import"./CBARFI8v.js";import"./B8qpgP2u.js";import"./D0RjlLEA.js";import"./BLMTb5PZ.js";const W=["title","onClick"],X=["onClick","title"],K=["onClick"],ma={__name:"index",setup(Q){const v=F(),{$toast:c}=A(),V=`${v.public.managemant}/listarUsuarios`,h=`${v.public.managemant}/listarCaixas`,S=I(),f=n(m("user-data").value.cartorio_token)||null,b=n([]),d=n([]),D=n(["PENDENTE","ENCERRADO","CANCELADO"]),N=n(null),w=n([]),o=z({data:E(),situacao:null,usuario_token:null}),$=[{title:"Data",value:"data"},{title:"Situação",value:"situacao"},{title:"Usuário",value:"usuario_nome"},{title:"Ações",value:"actions",sortable:!1}];function E(){const a=new Date,e=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0"),l=String(a.getDate()).padStart(2,"0");return`${e}-${t}-${l}`}async function O(){try{const{data:a}=await C(V,{method:"POST",body:{cartorio_token:f.value}},"$iWNqbVflHd");b.value=a.value}catch(a){c.error("Erro ao buscar usuários."),console.error(a)}}async function x(){try{sessionStorage.setItem("pesquisaCaixas",JSON.stringify(o));const{data:a}=await C(h,{method:"POST",body:{cartorio_token:f.value,ussuario_token:o.usuario_token,data:o.data||null,situacao:o.situacao}},"$XYvyo77vvU");console.log(a),a.value.length>0?d.value=a.value:(d.value=[],c.error("Não existe caixa registrada!"))}catch(a){c.error("Erro ao buscar caixas."),console.error(a)}}function R(a,e){N.value=a}function T(a){const e=m("user-service"),t=w.value.find(l=>l.id===a);e.value=JSON.stringify({id:t.id,token:t.token}),S.push({path:`/os/atualizar/${a}`})}function U(a){const e=m("caixa-service");e.value=JSON.stringify({caixa_token:a.token,usuario_nome:a.usuario_nome,data:a.data}),G("/caixas/caixasRecebimentoOs")}return P(()=>{J(async()=>{const a=sessionStorage.getItem("pesquisaCaixas");if(a){const e=JSON.parse(a);Object.assign(o,e)}await O(),await x()})}),(a,e)=>(Y(),M(H,{class:"mt-5"},{default:r(()=>[s(_,{class:"mb-5"},{default:r(()=>e[3]||(e[3]=[i("h1",null,"Caixas",-1)])),_:1}),s(_,null,{default:r(()=>[s(u,{cols:"2"},{default:r(()=>[s(j,{modelValue:o.data,"onUpdate:modelValue":e[0]||(e[0]=t=>o.data=t),type:"date",label:"Data"},null,8,["modelValue"])]),_:1}),s(u,{md:"3"},{default:r(()=>[s(y,{modelValue:o.situacao,"onUpdate:modelValue":e[1]||(e[1]=t=>o.situacao=t),items:D.value,label:"Situação"},null,8,["modelValue","items"])]),_:1}),s(u,{md:"2"},{default:r(()=>[s(y,{items:b.value,modelValue:o.usuario_token,"onUpdate:modelValue":e[2]||(e[2]=t=>o.usuario_token=t),"item-title":"user_nome","item-value":"user_token",label:"Usuário"},null,8,["items","modelValue"])]),_:1}),s(u,null,{default:r(()=>[i("div",null,[i("img",{onClick:x,style:{width:"40px",height:"40px",cursor:"pointer"},src:g,alt:"Pesquisar"})])]),_:1})]),_:1}),e[5]||(e[5]=i("hr",{class:"mt-5 mb-5"},null,-1)),s(L,{headers:$,items:d.value,"item-key":"id"},{"item.actions":r(({item:t})=>[s(_,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:r(()=>[i("div",{class:p({disabled:!t.btn_receber}),title:t.btn_receber?"Receber":"Bloqueado",onClick:l=>t.btn_receber?U(t):null},[i("img",{style:k({cursor:t.btn_receber?"pointer":"default",width:"30px",height:"30px"}),src:q,alt:"Receber"},null,4)],10,W),i("div",{class:p({disabled:!t.btn_editar}),onClick:l=>t.btn_editar?T(t.id):null,title:t.btn_editar?"Editar":"Bloqueado"},[i("img",{style:k({cursor:t.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:B,alt:"Salvar"},null,4)],10,X),i("div",{class:p({disabled:!t.btn_cancelar}),onClick:l=>t.btn_cancelar?R(t.numero,t.token):null,title:"Bloquear"},e[4]||(e[4]=[i("img",{style:{width:"30px",height:"30px"},src:g,alt:"Visualizar"},null,-1)]),10,K)]),_:2},1024)]),_:1},8,["items"])]),_:1}))}};export{ma as default};
