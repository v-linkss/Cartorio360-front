import{r as m,n as $e,D as M,F as ae,h as te,G as se,H as ye,o as F,A as j,w as a,b as o,d as L,q as e,P as we,c as le,t as Pe,C as Z,s as _,I as Y,a as c,v as ne,x as re,V as xe,y as ee,u as qe,E as Ie,O as Me,J as oe}from"./Bv08FN8P.js";import{a as Fe,u as T}from"./CidV0l9R.js";import{_ as ie}from"./ToPptOUL.js";import{c as K,r as W,u as ue,V as G,_ as de}from"./BtadqO6e.js";import{c as Ue}from"./DOBfvpJ-.js";import{a as ce,b as me,V as pe,c as Se}from"./5LBATLD1.js";import{V as Be}from"./BN4nnkQW.js";import{V as b}from"./CpEFAFkN.js";import{V as u}from"./IPjvlJbX.js";import{_ as Re}from"./HKvlkxUr.js";import{_ as Ee}from"./D-p5d-Wo.js";import{_ as _e}from"./DCsXQasW.js";import{_ as Oe,a as Te}from"./CrE-eFFQ.js";const De={key:1},Ne={__name:"RegistroPessoas",props:{show:Boolean},emits:["close"],async setup(U,{emit:$}){let v,V;const y=U,g=m(y.show),h=$,{$toast:w}=$e(),k=re(),S=`${k.public.managemant}/createPessoa`,J=`${k.public.managemant}/listarEstadoCivil`,P=`${k.public.managemant}/listarCapacidadeCivil`,Q=`${k.public.managemant}/listarCidades`,H={nome:"",nome_pai:"",nome_mae:"",profissao:"",local_trabalho:"",data_nascimento:"",doc_identificacao:"",cpf_pai:"",cpf_mae:"",tipo_pessoa:"FISICA",tabvalores_estadocivil_id:"",tabvalores_capacidadecivil_id:"",cidade_natural_id:"",cartorio_id:M("user-data").value.cartorio_id,user_id:M("user-data").value.usuario_id},n=ae({...H});te(()=>y.show,r=>{g.value=r});const B=()=>{g.value=!1,h("close")};function x(r){if(r)return r.replace(/[.\-]/g,"");r=null}const{data:C,pending:D,status:q,error:I}=([v,V]=se(async()=>Fe("cliente-dados",async()=>{const[r,s,f]=await Promise.all([$fetch(J),$fetch(P),$fetch(Q)]);return{estadoCivilItems:r,capacidadeCivilItems:s,cidadeNascimentoItems:f}})),v=await v,V(),v),R={nome:{required:K.withMessage("O campo é obrigatorio",W)},nome_mae:{required:K.withMessage("O campo é obrigatorio",W)},doc_identificacao:{required:K.withMessage("O campo é obrigatorio",W),cpf:Ue}},p=ue(R,n);async function N(){if(await p.value.$validate()){const r={...n};for(const A in r)r[A]===""&&(r[A]=null);const s={...r,doc_identificacao:x(n.doc_identificacao),cpf_pai:x(n.cpf_pai),cpf_mae:x(n.cpf_mae)},{data:f,error:t,status:X}=await T(S,{method:"POST",body:s},"$BiOjXVCR5N");X.value==="error"&&t.value.statusCode===500?w.error("Erro ao cadastrar pessoa,o CPF já está cadastrado."):(w.success("Pessoa cadastrada com sucesso!"),B())}else w.error("Erro ao cadastrar pessoa, preencha os campos obrigatorios.")}return(r,s)=>{const f=ye("mask");return F(),j(pe,{persistent:"",modelValue:e(g),"onUpdate:modelValue":s[13]||(s[13]=t=>ne(g)?g.value=t:null),"max-width":"1000"},{default:a(()=>[o(ce,null,{default:a(()=>[o(me,{class:"text-h5 mt-3"},{default:a(()=>[L("Criar Pessoa")]),_:1}),e(q)==="pending"?(F(),j(we,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):e(I)?(F(),le("div",De,Pe(e(I).message),1)):Z("",!0),e(q)==="success"?(F(),j(Be,{key:2,class:"mt-5"},{default:a(()=>[o(b,null,{default:a(()=>[o(u,{cols:"12",md:"8"},{default:a(()=>[o(_,{modelValue:e(n).nome,"onUpdate:modelValue":s[0]||(s[0]=t=>e(n).nome=t),"error-messages":e(p).nome.$errors.map(t=>t.$message),label:"Nome",required:"",onBlur:e(p).nome.$touch,onInput:e(p).nome.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1}),o(u,{cols:"12",md:"4"},{default:a(()=>[Y(o(_,{modelValue:e(n).doc_identificacao,"onUpdate:modelValue":s[1]||(s[1]=t=>e(n).doc_identificacao=t),"error-messages":e(p).doc_identificacao.$errors.map(t=>t.$message),label:"CPF",required:"",onBlur:e(p).doc_identificacao.$touch,onInput:e(p).doc_identificacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),[[f,"###.###.###-##"]])]),_:1})]),_:1}),o(b,null,{default:a(()=>[o(u,{cols:"12",md:"4"},{default:a(()=>[o(G,{modelValue:e(n).tabvalores_estadocivil_id,"onUpdate:modelValue":s[2]||(s[2]=t=>e(n).tabvalores_estadocivil_id=t),items:e(C).estadoCivilItems,"item-title":"descricao","item-value":"id",label:"Estado Civil"},null,8,["modelValue","items"])]),_:1}),o(u,{cols:"12",md:"4"},{default:a(()=>[o(_,{modelValue:e(n).profissao,"onUpdate:modelValue":s[3]||(s[3]=t=>e(n).profissao=t),label:"Profissão"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12",md:"4"},{default:a(()=>[o(_,{modelValue:e(n).local_trabalho,"onUpdate:modelValue":s[4]||(s[4]=t=>e(n).local_trabalho=t),label:"Local de trabalho"},null,8,["modelValue"])]),_:1})]),_:1}),o(b,null,{default:a(()=>[o(u,{cols:"12",md:"4"},{default:a(()=>[o(_,{modelValue:e(n).data_nascimento,"onUpdate:modelValue":s[5]||(s[5]=t=>e(n).data_nascimento=t),type:"date","prepend-icon":"",label:"Data de nascimento"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12",md:"4"},{default:a(()=>[o(G,{modelValue:e(n).tabvalores_capacidadecivil_id,"onUpdate:modelValue":s[6]||(s[6]=t=>e(n).tabvalores_capacidadecivil_id=t),items:e(C).capacidadeCivilItems,label:"Capacidade Civil","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),o(u,{cols:"12",md:"4"},{default:a(()=>[o(G,{modelValue:e(n).cidade_natural_id,"onUpdate:modelValue":s[7]||(s[7]=t=>e(n).cidade_natural_id=t),items:e(C).cidadeNascimentoItems,label:"Cidade de nascimento","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),o(b,null,{default:a(()=>[o(u,{cols:"12",md:"4"},{default:a(()=>[Y(o(_,{modelValue:e(n).cpf_pai,"onUpdate:modelValue":s[8]||(s[8]=t=>e(n).cpf_pai=t),modelModifiers:{date:!0},label:"CPF do Pai"},null,8,["modelValue"]),[[f,"###.###.###-##"]])]),_:1}),o(u,{cols:"12",md:"4"},{default:a(()=>[o(_,{modelValue:e(n).nome_pai,"onUpdate:modelValue":s[9]||(s[9]=t=>e(n).nome_pai=t),modelModifiers:{date:!0},label:"Nome do Pai"},null,8,["modelValue"])]),_:1})]),_:1}),o(b,null,{default:a(()=>[o(u,{cols:"12",md:"4"},{default:a(()=>[Y(o(_,{modelValue:e(n).cpf_mae,"onUpdate:modelValue":s[10]||(s[10]=t=>e(n).cpf_mae=t),modelModifiers:{date:!0},label:"CPF da Mãe"},null,8,["modelValue"]),[[f,"###.###.###-##"]])]),_:1}),o(u,{cols:"12",md:"4"},{default:a(()=>[o(_,{modelValue:e(n).nome_mae,"onUpdate:modelValue":s[11]||(s[11]=t=>e(n).nome_mae=t),modelModifiers:{date:!0},"error-messages":e(p).nome_mae.$errors.map(t=>t.$message),label:"Nome da Mãe",required:"",onBlur:e(p).nome_mae.$touch,onInput:e(p).nome_mae.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),o(b,null,{default:a(()=>[c("div",null,[c("img",{class:"ml-5",style:{cursor:"pointer"},src:ie,alt:"Sair",onClick:B})]),c("div",null,[c("img",{style:{cursor:"pointer"},class:"ml-5",src:de,onClick:s[12]||(s[12]=t=>N())})])]),_:1})]),_:1})):Z("",!0)]),_:1})]),_:1},8,["modelValue"])}}},Ae=""+new URL("ficha.DrpzE7Jr.png",import.meta.url).href,ze={__name:"FichaCard",props:{show:Boolean},emits:["close","confirmar"],setup(U,{emit:$}){const v=U,V=m(v.show),y=$;te(()=>v.show,w=>{V.value=w});const g=()=>{y("confirmar"),h()},h=()=>{V.value=!1,y("close")};return(w,k)=>(F(),j(pe,{persistent:"",modelValue:e(V),"onUpdate:modelValue":k[0]||(k[0]=S=>ne(V)?V.value=S:null),per:"","max-width":"700"},{default:a(()=>[o(ce,null,{default:a(()=>[o(me,{class:"text-h5"},{default:a(()=>[L("Ficha de Firma")]),_:1}),o(xe,{src:Ae}),o(Se,null,{default:a(()=>[o(ee,{style:{"background-color":"#429946",color:"white"},onClick:g},{default:a(()=>[L("Confirmar")]),_:1}),o(ee,{style:{"background-color":"red",color:"white"},onClick:h},{default:a(()=>[L("Cancelar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},je=c("h1",null,"Reconhecimento por Semelhança",-1),Le=["onClick"],Ke=c("img",{style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar"},null,-1),We=[Ke],Ge=["onClick"],Je=c("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:Te,alt:"Remover"},null,-1),Qe=[Je],He=c("img",{class:"btn-pointer mt-10 mb-5",src:ie,alt:"Sair",style:{cursor:"pointer"}},null,-1),co={__name:"semelhanca",props:{ato_token:{type:String,required:!0}},async setup(U){let $,v;const V=U,y=qe(),g=Ie(),h=re(),w=`${h.public.managemant}/listarEscrevente`,k=`${h.public.managemant}/pesquisarPessoas`,S=`${h.public.managemant}/atoReconhecimento`,J=`${h.public.managemant}/etiquetaReconhecimento`,P=m(M("user-data").value.cartorio_token),Q=m(M("user-service").value.token).value||m(M("user-service").value).value,H=M("auth_token").value,n=m([]),B=m([]),x=m([]),C=m([]),D=m(!1),q=m(!1),I=m(!1),R=m(null),p=m(""),N=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],r=ae({quantidade:1,escrevente:null,nome:null,documento:null}),s={escrevente:{required:K.withMessage("O campo é obrigatorio",W)}},f=ue(s,r),{data:t}=([$,v]=se(()=>T(w,{method:"POST",body:{cartorio_token:P}},"$iEFsIjdWdW")),$=await $,v(),$);x.value=t.value[0].func_json_escreventes;async function X(){try{const{data:i,error:l}=await T(k,{method:"POST",body:{cartorio_token:P.value,documento:r.documento,nome:r.nome}},"$uzKb8LPV3v");i.value.length>0?n.value=i.value:n.value=[]}catch(i){console.error("Erro na requisição",i)}}const A=()=>{q.value=!0};function fe(i){C.value.push(i)}const ve=i=>{R.value=i,I.value=!0};function Ve(i){C.value=C.value.filter(l=>l.pessoa_token!==i.pessoa_token),B.value=B.value.filter(l=>l!==`${i.nome}-${i.documento}-${i.pessoa_token}`)}async function ge(){if(await f.value.$validate()){const i=C.value.map(l=>({pessoa_token:l.pessoa_token}));try{const{data:l,error:z,status:E}=await T(S,{method:"POST",body:{pessoas:i,cartorio_token:P.value,ordemserv_token:Q,quantidade:r.quantidade,usuario_token:H,ato_tipo_token:V.ato_token}},"$MulQmK1LAp");E.value==="success"&&l.value[0].status==="OK"?be(l.value[0].token):(D.value=!0,p.value=ato_token.value.status_mensagem||z.value.data.details)}catch(l){console.error("Erro na requisição",l)}}}async function be(i){try{const{data:l,error:z,status:E}=await T(J,{method:"POST",body:{ato_token:i,cartorio_token:P.value,escrevente_token:r.escrevente}},"$fMGlIlw995");if(E.value==="success"){const O=window.open("","_blank");O.document.open(),O.document.write(l.value[0].etiqueta),O.document.close()}}catch(l){console.error("Erro na requisição",l)}}const he=()=>{const i=g.query.origem||"criar",l=g.query.id;i==="atualizar"?y.push(`/ordens-servicos/atualizar/${l}`):y.push("/ordens-servicos/criar-registro")};return(i,l)=>{const z=Ne,E=ze,O=Re,ke=Ee;return F(),le(Me,null,[je,o(b,{class:"mt-5"},{default:a(()=>[o(u,{cols:"5"},{default:a(()=>[o(G,{label:"Tabelião/escrevente",modelValue:e(r).escrevente,"onUpdate:modelValue":l[0]||(l[0]=d=>e(r).escrevente=d),items:e(x),"item-title":"nome","item-value":"token",required:"","error-messages":e(f).escrevente.$errors.map(d=>d.$message),onBlur:e(f).escrevente.$touch,onInput:e(f).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1}),o(u,{cols:"2"},{default:a(()=>[o(_,{label:"Quantidade",type:"number",modelValue:e(r).quantidade,"onUpdate:modelValue":l[1]||(l[1]=d=>e(r).quantidade=d)},null,8,["modelValue"])]),_:1})]),_:1}),o(b,null,{default:a(()=>[o(u,{cols:"3"},{default:a(()=>[o(_,{label:"Documento",modelValue:e(r).documento,"onUpdate:modelValue":l[2]||(l[2]=d=>e(r).documento=d)},null,8,["modelValue"])]),_:1}),o(u,{cols:"4"},{default:a(()=>[o(_,{label:"Pessoa",modelValue:e(r).nome,"onUpdate:modelValue":l[3]||(l[3]=d=>e(r).nome=d)},null,8,["modelValue"])]),_:1}),c("div",null,[c("img",{class:"btn-pointer mt-3",src:_e,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:X})]),c("div",null,[c("img",{class:"btn-pointer mt-3 ml-2",src:Oe,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:A})])]),_:1}),o(b,null,{default:a(()=>[o(u,{class:"mr-10"},{default:a(()=>[o(oe,{style:{height:"465px"},headers:N,items:e(n)},{"item.actions":a(({item:d})=>[c("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:Ce=>ve(d),title:"Visualizar Ficha"},We,8,Le)]),_:1},8,["items"])]),_:1}),o(u,null,{default:a(()=>[o(oe,{headers:N,items:e(C),style:{height:"465px"},"item-key":"id"},{"item.actions":a(({item:d})=>[c("div",{style:{display:"flex","justify-content":"flex-end"},onClick:Ce=>Ve(d),title:"Remover"},Qe,8,Ge)]),_:1},8,["items"])]),_:1})]),_:1}),o(z,{show:e(q),onClose:l[4]||(l[4]=d=>q.value=!1)},null,8,["show"]),o(E,{show:e(I),item:e(R),onConfirmar:l[5]||(l[5]=d=>fe(e(R))),onClose:l[6]||(l[6]=d=>I.value=!1)},null,8,["show","item"]),o(b,null,{default:a(()=>[o(O,{onClick:he},{default:a(()=>[He]),_:1}),c("div",null,[c("img",{class:"mt-10 mb-5 ml-10",onClick:ge,style:{cursor:"pointer"},src:de})])]),_:1}),o(ke,{show:e(D),errorMessage:e(p),onClose:l[7]||(l[7]=d=>D.value=!1)},null,8,["show","errorMessage"])],64)}}};export{co as default};
