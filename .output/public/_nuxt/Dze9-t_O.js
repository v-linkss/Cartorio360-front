import{_ as X}from"./Ko9lYoTQ.js";import{c as ve,r as _e,u as fe}from"./Bxi-6725.js";import{C as Y,H,u as Z,r as c,m as q,D as ee,I as G,o as D,G as K,w as t,b as e,v as o,V as J,A as F,d as U,s as Q,a as p,c as L,x as ge,L as De,M as Me,K as ye,F as be,N as pe,t as ne}from"./DRz8gTjX.js";import{u as b,V as P}from"./ykE_iCmk.js";import{V as j}from"./MQXhnECs.js";import{V as ie}from"./iNQXE_wp.js";import{V as oe}from"./BznRURap.js";import{_ as Ie}from"./BX4JR-DJ.js";import{_ as Re,a as je,b as Be,T as Ne,W as Fe,r as xe,D as he,c as Ue,d as Le}from"./D5cCVlme.js";import{_ as le}from"./DcrIfDBa.js";import{_ as te,a as ue,b as ce}from"./BP1uhy__.js";import{_ as We}from"./CzFuQd4f.js";import{V as de}from"./D7WFTuLK.js";import{V as ke,a as me}from"./f6FWUqqb.js";import{V as Ge}from"./BlfZoKmu.js";import{_ as Ke}from"./CzAIc32d.js";import{_ as Je}from"./CdP3NN9a.js";const Pt={__name:"Dados",props:{ato_token:{type:String,required:!0}},emits:["saved"],async setup(N,{emit:_}){let v,f;const k=N,V=_,y=Y(),w=H(),M=Q(),{$toast:x}=Z(),A=`${M.public.managemant}/listarSituacoes`,T=`${M.public.managemant}/createAtos`,O=`${M.public.managemant}/getAtosTiposByToken`,I=c(q("user-data").value.cartorio_token),B=c(q("user-service").value.id).value||c(q("user-service").value).value,S=c([]),d=ee({dt_abertura:null,status:"EM EDIÇÃO",mne:null}),R={status:{required:ve.withMessage("O campo é obrigatorio",_e)}},n=fe(R,d),{data:u}=([v,f]=G(()=>b(`${O}/${k.ato_token}`,{method:"GET"},"$9ZmTYsLk0K")),v=await v,f(),v);async function a(){if(await n.value.$validate()){const{data:l,error:s,status:g}=await b(T,{method:"POST",body:{ato_tipo_id:u.value.id,cartorio_id:q("user-data").value.cartorio_id,ordemserv_id:B,status:d.status,dt_abertura:d.dt_abertura,mne:d.mne,user_id:q("user-data").value.usuario_id,user_alteracao_id:q("user-data").value.usuario_id}},"$hyq5YcBEjF");g.value==="success"&&(x.success("Ato registrado com sucesso!"),V("saved",{id:l.value.id,token:l.value.token}))}else x.error("Preencha os campos obrigatorios.")}const{data:i}=([v,f]=G(()=>b(A,{method:"POST",body:{cartorio_token:I.value}},"$S3qwbpImEh")),v=await v,f(),v);S.value=i.value;const $=()=>{const l=w.query.origem||"criar",s=w.query.id;l==="atualizar"?y.push(`/os/atualizar/${s}`):y.push("/os/criar-registro")};return(l,s)=>{const g=X;return D(),K(oe,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(j,{cols:"3"},{default:t(()=>[e(ie,{label:"Situação",modelValue:o(d).status,"onUpdate:modelValue":s[0]||(s[0]=h=>o(d).status=h),items:o(S),"item-title":"descricao","item-value":"descricao",required:"","error-messages":o(n).status.$errors.map(h=>h.$message),onBlur:o(n).status.$touch,onInput:o(n).status.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(j,{cols:"5"},{default:t(()=>[e(J,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:o(d).mne,"onUpdate:modelValue":s[1]||(s[1]=h=>o(d).mne=h)},null,8,["modelValue"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(j,{cols:"2"},{default:t(()=>[e(J,{modelValue:o(d).dt_abertura,"onUpdate:modelValue":s[2]||(s[2]=h=>o(d).dt_abertura=h),type:"date",label:"Data Lavratura",disabled:"",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(P,{class:"mb-3"},{default:t(()=>[e(g,{onClick:$},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>s[3]||(s[3]=[U("Voltar")])),_:1})]),_:1}),e(F,{class:"ml-10",onClick:a,size:"large",color:"green"},{default:t(()=>s[4]||(s[4]=[U("Salvar")])),_:1})]),_:1})]),_:1})}}},Ye=["onClick"],He=["onClick"],Ze=["onClick"],Qe={key:0,style:{width:"30px",height:"30px"},src:ue,alt:"Visualizar",title:"Reativar"},Xe={key:1,src:ce,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},et=["onClick"],At={__name:"Partes",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},async setup(N){let _,v;const f=N,k=Y(),V=H(),y=Q(),{$toast:w}=Z(),M=`${y.public.managemant}/pesquisarPessoas`,x=`${y.public.managemant}/listarPapeis`,A=`${y.public.managemant}/getLinkTipo`,T=`${y.public.managemant}/createAtosPessoa`,O=`${y.public.managemant}/getAtosPessoaById`,I=`${y.public.managemant}/updateAtosPessoa`,B=c(q("user-data").value.cartorio_token),S=c([]),d=c([]),R=c([]),n=c(!1),u=c(!1),a=c(!1),i=c(!1),$=c(null),l=c(null),s=c(null),g=c(null);c(null);const h=c(null),W=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],z=ee({papeis:null,nome:null,pessoa:null,documento:null}),{data:$e}=([_,v]=G(()=>b(x,{method:"POST",body:{tipo_ato_token:f.ato_token}},"$fFKndZhA4W")),_=await _,v(),_);R.value=$e.value;async function we(){try{const{data:m,error:r}=await b(M,{method:"POST",body:{cartorio_token:B.value,documento:z.documento,nome:z.nome}},"$o3ZL1rvYrY");m.value.length>0?(S.value=m.value,z.pessoa=S.value[0]):S.value=[]}catch(m){console.error("Erro na requisição",m)}}const Ve=()=>{u.value=!0},Ce=m=>{d.value=d.value.map(r=>r.id===s.value?{...r,papel:{...r.papel,descricao:m}}:r)},Ee=m=>{const r=d.value.find(C=>C.pessoa.id===g.value);r.representante.nome=m},Pe=async()=>{const m={pessoa:z.pessoa,papel:R.value.find(C=>C.id===z.papeis),representante:{nome:null}},r=await b(`${O}/${f.ato_id}`,{method:"GET"},"$kXSxUa4grs");for(const C of r.data.value)if(C.pessoa_id===z.pessoa.id&&C.ato_id===f.ato_id&&C.tipo_parte_id===z.papeis){w.error("Pessoa Já Registrada Com Esse Papel!");return}try{const{data:C,error:ae,status:se}=await b(T,{method:"POST",body:{ato_id:Number(f.ato_id),pessoa_id:z.pessoa.id,tipo_parte_id:z.papeis,user_id:Number(q("user-data").value.usuario_id)}},"$So3qnQu7ek");se.value==="success"?(m.id=C.value.id,w.success("Pessoa Registrada com Sucesso!"),d.value.push(m)):w.error(ae.value.message)}catch{w.error("Erro no servidor. Tente novamente.")}},Ae=async m=>{a.value=!0,h.value=null;const{data:r}=await b(`${A}`,{method:"POST",body:{id:m.pessoa.id,tipo:"ficha"}},"$Q3kbIwtd9t");r.value&&r.value.link?h.value=`data:image/jpeg;base64,${r.value.link}`:h.value=null},Te=m=>{const r=d.value.filter(C=>C.pessoa.id!==m.pessoa.id).map(C=>({id:C.pessoa.id,nome:C.pessoa.nome}));s.value=m.id,$.value=r,n.value=!0,l.value=m.pessoa.nome,g.value=m.pessoa.id},Se=m=>{s.value=m.id,i.value=!0,l.value=m.pessoa.nome};async function qe(m){m.excluido=!m.excluido;try{await b(`${I}/${s.value}`,{method:"PUT",body:JSON.stringify({excluido:m.excluido})},"$9xStKwGd7o")}catch(r){console.error("Erro ao excluir pessoa:",r)}}const Oe=()=>{const m=V.query.origem||"criar",r=V.query.id;m==="atualizar"?k.push(`/os/atualizar/${r}`):k.push("/os/criar-registro")};return(m,r)=>{const C=Ie,ae=je,se=Be,ze=X;return D(),K(oe,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(j,{cols:"3"},{default:t(()=>[e(J,{label:"Documento",modelValue:o(z).documento,"onUpdate:modelValue":r[0]||(r[0]=E=>o(z).documento=E)},null,8,["modelValue"])]),_:1}),e(j,{cols:"4"},{default:t(()=>[e(J,{label:"Pessoa",modelValue:o(z).nome,"onUpdate:modelValue":r[1]||(r[1]=E=>o(z).nome=E)},null,8,["modelValue"])]),_:1}),p("div",null,[p("img",{class:"mt-3",src:le,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:we})]),p("div",null,[p("img",{class:"mt-3 ml-2",src:te,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Ve})])]),_:1}),e(P,null,{default:t(()=>[e(j,{cols:"4"},{default:t(()=>[e(ie,{label:"Selecione a Pessoa",modelValue:o(z).pessoa,"onUpdate:modelValue":r[2]||(r[2]=E=>o(z).pessoa=E),items:o(S),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),p("div",null,[p("img",{class:"mt-3",src:te,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Pe})])]),_:1}),e(P,null,{default:t(()=>[e(j,null,{default:t(()=>[e(de,{style:{height:"465px"},headers:W,items:o(d)},{"item.actions":t(({item:E})=>[e(P,null,{default:t(()=>[p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:re=>Ae(E),title:"Visualizar Ficha"},r[8]||(r[8]=[p("img",{style:{width:"30px",height:"30px"},src:le,alt:"Visualizar"},null,-1)]),8,Ye),p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:re=>Se(E),class:"mr-2",title:"Alterar Papel"},r[9]||(r[9]=[p("img",{style:{width:"30px",height:"30px"},src:We,alt:"Visualizar"},null,-1)]),8,He),p("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:re=>qe(E),title:"Deletar Pessoa"},[E.excluido?(D(),L("img",Qe)):(D(),L("img",Xe))],8,Ze),p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:re=>Te(E),title:"Selecionar Representante"},r[10]||(r[10]=[p("img",{style:{width:"30px",height:"30px"},src:Re,alt:"Visualizar"},null,-1)]),8,et)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(C,{show:o(u),onClose:r[3]||(r[3]=E=>u.value=!1)},null,8,["show"]),e(ae,{representante_nome:o(l),representantes:o($),ato_id:o(s),show:o(n),onClose:r[4]||(r[4]=E=>n.value=!1),onUpdateRepresentante:Ee},null,8,["representante_nome","representantes","ato_id","show"]),e(se,{representante_nome:o(l),ato_token:f.ato_token,ato_id:o(s),show:o(i),onClose:r[5]||(r[5]=E=>i.value=!1),onUpdatePapel:Ce},null,8,["representante_nome","ato_token","ato_id","show"]),e(ke,{modelValue:o(a),"onUpdate:modelValue":r[7]||(r[7]=E=>ge(a)?a.value=E:null),width:"600"},{default:t(()=>[e(me,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(Ge,{src:o(h)},null,8,["src"]),e(F,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:r[6]||(r[6]=E=>a.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(P,null,{default:t(()=>[e(ze,{onClick:Oe},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>r[11]||(r[11]=[U("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},tt={key:0,class:"loading-overlay"},ot="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Tt={__name:"Minuta",props:{ato_token:{type:String,required:!0}},emits:["page","doc"],setup(N,{emit:_}){const v=N;De("DocumentEditorContainer",[Ne,Fe]);const f=Q(),{$toast:k}=Z(),V=Y(),y=H(),w=_;xe(`${f.public.docEditor}`);const M=`${f.public.managemant}/upload`,x=c(null),A=c(!1),T=async()=>{const u=await x.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),a=new FileReader;a.onload=()=>{const i=a.result;w("doc",i)},a.readAsText(u)},O=async()=>{A.value=!0;try{const u=await x.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),a=new FormData;a.append("file",u,"anexo.docx"),a.append("cartorio_token",q("user-data").value.cartorio_token),a.append("token",v.ato_token),a.append("tipo","ato_minuta");const{data:i,status:$}=await b(M,{method:"POST",body:a},"$071xxdqs20");if($.value==="success"){k.success("Documento enviado!");const s=x.value.ej2Instances.documentEditor.pageCount;T(),w("page",s)}else k.error("Erro ao enviar documento para o sistema.")}catch(n){k.error("Erro ao salvar documento."),console.error(n)}finally{A.value=!1}},I=async()=>{d(!0);try{await B(),d(!0);const{data:n,status:u}=await b(substituirModelo,{method:"POST",body:{ato_token:v.ato_token}},"$0ktpWliD4l");n.value&&S(n.value)}catch(n){console.error("Erro ao gerar a minuta:",n),k.error("Ocorreu um erro ao gerar a minuta.")}finally{d(!1)}},B=async()=>{try{const{data:n}=await b(baixarDocumento,{method:"POST",body:{bucket:"qvgjz",path:"provider/modeloAto.sfdt"}},"$jXVvQjEE6u"),u=await fetchBlobFromMinIO(n.value);if(u){const a=new FileReader;a.onload=()=>{const i=a.result;x.value.ej2Instances.documentEditor.open(i),w("doc",i)},a.readAsText(u)}}catch(n){console.error("Erro ao carregar o modelo de minuta:",n),k.error("Falha ao carregar o modelo de minuta.")}},S=n=>{const u=x.value.ej2Instances.documentEditor,a=i=>{for(const[$,l]of Object.entries(i))if(/^<<.+>>$/.test($))try{u.search.findAll($),u.search.searchResults.length>0&&u.search.searchResults.replaceAll(l)}catch(s){console.error(`Erro ao substituir o marcador ${$}:`,s)}else if($==="partes"&&Array.isArray(l)&&l.length>0)for(const s of l)typeof s=="object"&&a(s)};a(n)},d=n=>{A.value=n},R=()=>{const n=y.query.origem||"criar",u=y.query.id;n==="atualizar"?V.push(`/os/atualizar/${u}`):V.push("/os/criar-registro")};return(n,u)=>{const a=X;return D(),L(be,null,[e(o(he),{height:"900px",ref_key:"documentEditorContainer",ref:x,serviceUrl:ot,enableToolbar:!0,enableWordExport:!0},null,512),o(A)?(D(),L("div",tt,[e(Me,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):ye("",!0),e(P,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e(a,{class:"mr-4"},{default:t(()=>[e(F,{size:"large",onClick:R,color:"red"},{default:t(()=>u[0]||(u[0]=[U("Voltar")])),_:1})]),_:1}),e(F,{size:"large",color:"green",onClick:O,disabled:o(A)},{default:t(()=>u[1]||(u[1]=[U("Salvar")])),_:1},8,["disabled"]),e(F,{class:"ml-4",size:"large",color:"blue",onClick:I},{default:t(()=>u[2]||(u[2]=[U("Gerar Minuta")])),_:1})]),_:1})],64)}}},at=["innerHTML"],St={__name:"Livro",props:{ato_token:{type:String,required:!0},pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(N){let _,v;const f=N,k=Q();xe(`${k.public.docEditor}`);const{$toast:V}=Z(),y=Y(),w=H(),M=`${k.public.managemant}/listarEscrevente`,x=`${k.public.managemant}/lavrarAto`,A=c("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),T=c(!1),O=c(null),I=c(null),B=c(null),S=c(q("user-data").value.cartorio_token),d=q("auth_token").value,R=c([]),n=ee({escrevente:null}),u=async()=>{try{const{data:s,status:g}=await b(x,{method:"POST",body:{ato_token:f.ato_token,qtd_paginas:f.pages,escrevente_token:n.escrevente,usuario_token:d,cartorio_token:S}},"$ZKnVBNYxp9");g.value==="success"?(O.value=s.value,I.value=s.value[0].selo,V.success("Ato lavrado com sucesso!")):V.error("Falha ao lavrar o ato.")}catch{V.error("Erro ao conectar com o servidor.")}},a=()=>{T.value=!1,u()},{data:i}=([_,v]=G(()=>b(M,{method:"POST",body:{cartorio_token:S}},"$XouuxOFIWh")),_=await _,v(),_);R.value=i.value[0].func_json_escreventes;const $=function(){B.value.ej2Instances.documentEditor.open(f.document)},l=()=>{const s=w.query.origem||"criar",g=w.query.id;s==="atualizar"?y.push(`/os/atualizar/${g}`):y.push("/os/criar-registro")};return(s,g)=>{const h=Ke;return D(),L(be,null,[e(P,null,{default:t(()=>[e(j,null,{default:t(()=>[(D(),K(o(he),{restrictEditing:!0,enableToolbar:!1,created:f.document?$:null,ref_key:"documentEditorContainer",ref:B,height:"850px",width:"850px",key:f.document},null,8,["created"]))]),_:1}),e(j,null,{default:t(()=>[e(ie,{class:"mt-15",label:"Tabelião/escrevente",modelValue:o(n).escrevente,"onUpdate:modelValue":g[0]||(g[0]=W=>o(n).escrevente=W),items:o(R),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),p("div",null,[p("div",null,[p("img",{onClick:g[1]||(g[1]=W=>T.value=!0),class:"ml-2",style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Ue}),o(O)?(D(),K(me,{key:0,class:"mr-16"},{default:t(()=>[e(P,{"no-gutters":""},{default:t(()=>[e(j,null,{default:t(()=>[e(pe,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[U(" Livro: "+ne(o(O)[0].livro_numero),1)]),_:1})]),_:1}),e(j,null,{default:t(()=>[e(pe,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[U(" Folhas : "+ne(o(O)[0].pagina_inicial)+" A "+ne(o(O)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),p("div",{innerHTML:o(I)},null,8,at)]),_:1})):ye("",!0)])])]),_:1})]),_:1}),e(F,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:l},{default:t(()=>g[3]||(g[3]=[U("Voltar")])),_:1}),e(h,{show:o(T),condMessage:o(A),onClose:g[2]||(g[2]=W=>T.value=!1),onConfirm:a},null,8,["show","condMessage"])],64)}}},st=["onClick"],rt={key:0,style:{width:"30px",height:"30px"},src:ue,alt:"Visualizar",title:"Reativar"},nt={key:1,src:ce,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},qt={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(N){let _,v;const f=N,k=Y(),V=H(),y=Q(),{$toast:w}=Z(),M=`${y.public.managemant}/listarEscrevente`,x=`${y.public.managemant}/getAtosTiposByToken`,A=`${y.public.managemant}/createAtosObservacao`,T=`${y.public.managemant}/updateAtosObservacao`,O=c(q("user-data").value.cartorio_token),I=c([]),B=c([]),S=[{title:"Data",align:"start",key:"data"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],d=ee({observacao:null}),R={observacao:{required:ve.withMessage("O campo é obrigatorio",_e)}},n=fe(R,d);[_,v]=G(()=>b(`${x}/${f.ato_token}`,{method:"GET"},"$aJM1TL1buW")),_=await _,v();async function u(){if(await n.value.$validate()){const{data:l,error:s,status:g}=await b(A,{method:"POST",body:{ato_id:f.ato_id,observacao:d.observacao,user_id:q("user-data").value.usuario_id}},"$dMg99jeUNP");g.value==="success"&&(I.value.push({data:Je(l.value.created,"dd/mm/yyyy hh:mm"),observacao:l.value.observacao,id:l.value.id,escrevente:q("user-data").value.nome}),w.success("Observação registrada com sucesso"))}else w.error("Preencha os campos obrigatorios.")}async function a(l){l.excluido=!l.excluido;try{await b(`${T}/${l.id}`,{method:"PUT",body:JSON.stringify({excluido:l.excluido})},"$B6PdRx8Gp4")}catch(s){console.error("Erro ao excluir observacao:",s)}}const{data:i}=([_,v]=G(()=>b(M,{method:"POST",body:{cartorio_token:O}},"$xFHPGua26S")),_=await _,v(),_);B.value=i.value[0].func_json_escreventes;const $=()=>{const l=V.query.origem||"criar",s=V.query.id;l==="atualizar"?k.push(`/os/atualizar/${s}`):k.push("/os/criar-registro")};return(l,s)=>{const g=X;return D(),K(oe,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(J,{label:"Observação",modelValue:o(d).observacao,"onUpdate:modelValue":s[0]||(s[0]=h=>o(d).observacao=h),required:"","error-messages":o(n).observacao.$errors.map(h=>h.$message),onBlur:o(n).observacao.$touch,onInput:o(n).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),p("div",null,[p("img",{class:"btn-pointer ml-2",src:te,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:u})])]),_:1}),e(P,null,{default:t(()=>[e(j,null,{default:t(()=>[e(de,{style:{height:"465px"},headers:S,items:o(I)},{"item.actions":t(({item:h})=>[p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:W=>a(h),title:"Deletar Observação"},[h.excluido?(D(),L("img",rt)):(D(),L("img",nt))],8,st)]),_:1},8,["items"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(g,{onClick:$},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>s[1]||(s[1]=[U("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},lt=["onClick"],it=["onClick"],ut={key:0,style:{width:"30px",height:"30px"},src:ue,alt:"Visualizar",title:"Reativar"},ct={key:1,src:ce,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ot={__name:"Anexos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},setup(N){const _=N,v=Q(),{$toast:f}=Z(),k=Y(),V=H(),y=`${v.public.biometria}/run-scanner`,w=`${v.public.managemant}/atos_anexos`,M=`${v.public.managemant}/atos_anexos`,x=c(!1),A=c([]),T=ee({descricao:""}),O=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}];async function I(){try{await B(),await S()}catch(a){console.error("Erro ao executar scanner ou listar arquivos:",a)}}async function B(){try{const{data:a}=await b(y,{method:"GET"},"$WazoKp68Tw")}catch(a){f.error("Erro ao acionar o scanner:",a)}}async function S(){try{const{data:a,status:i}=await b("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:_.ato_token,cartorio_token:q("user-data").value.cartorio_token}},"$03Wxiia3aI")}catch(a){console.error("Erro ao enviar o arquivo:",a)}}const d=async()=>{x.value=!0},R=async()=>{const{data:a,error:i,status:$}=await b(w,{method:"POST",body:{ato_id:_.ato_id,descricao:T.descricao,user_id:q("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$D2PdkmlmwW");$.value==="success"&&(f.success("Anexo registrado com sucesso!"),A.value.push(a.value))};async function n(a){a.excluido=!a.excluido;try{await b(`${M}/${a.id}`,{method:"PUT",body:JSON.stringify({excluido:a.excluido})},"$WyW0hasRPI")}catch(i){console.error("Erro ao excluir pessoa:",i)}}const u=()=>{const a=V.query.origem||"criar",i=V.query.id;a==="atualizar"?k.push(`/os/atualizar/${i}`):k.push("/os/criar-registro")};return(a,i)=>{const $=X;return D(),K(oe,null,{default:t(()=>[e(P,null,{default:t(()=>[e(j,{cols:"5"},{default:t(()=>[e(J,{modelValue:o(T).descricao,"onUpdate:modelValue":i[0]||(i[0]=l=>o(T).descricao=l),label:"Descrição"},null,8,["modelValue"])]),_:1}),p("div",{onClick:I,title:"Escanear"},i[3]||(i[3]=[p("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Le,alt:"Escanear"},null,-1)])),p("div",{onClick:R,title:"Criar"},i[4]||(i[4]=[p("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:te,alt:"Criar"},null,-1)]))]),_:1}),e(de,{headers:O,items:o(A),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:l})=>[e(P,null,{default:t(()=>[p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:s=>d(l),title:"Visualizar Anexo"},i[5]||(i[5]=[p("img",{style:{width:"30px",height:"30px"},src:le,alt:"Visualizar"},null,-1)]),8,lt),p("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:s=>n(l),title:"Deletar Pessoa"},[l.excluido?(D(),L("img",ut)):(D(),L("img",ct))],8,it)]),_:2},1024)]),_:1},8,["items"]),e(ke,{modelValue:o(x),"onUpdate:modelValue":i[2]||(i[2]=l=>ge(x)?x.value=l:null),width:"600"},{default:t(()=>[e(me,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(F,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:i[1]||(i[1]=l=>x.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e($,{onClick:u},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>i[6]||(i[6]=[U("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Pt as _,At as a,Tt as b,St as c,qt as d,Ot as e};
