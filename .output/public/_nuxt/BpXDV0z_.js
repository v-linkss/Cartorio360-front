import{r as f,m as v,I as $,p as q,c as y,a as T,b as p,v as n,x as F,w as V,K as m,F as w,s as L,o as r,bi as D,A as I,d as P,G as d,V as k}from"./BUB_oj1-.js";import{u as _,V as S}from"./v3H-4gFp.js";import{V as C}from"./CzBCifCk.js";import{V as G}from"./BGy-dWNw.js";import{V as O}from"./DSXhbIse.js";import"./DQ6-Kpl6.js";import"./Dc4x97Z4.js";import"./C3UDeqBP.js";import"./DOS5v7o_.js";const Q={key:0},ee={__name:"lista",async setup(H){let i,g;const b=L(),U=`${b.public.managemant}/getRelatorios`,h=`${b.public.managemant}/createRelatorio`,B=`${b.public.managemant}/listaQuery`,c=f([]),s=f(null),u=f([]),R={user_token:v("auth_token").value,cartorio_token:v("user-data").value.cartorio_token,user_name:v("user-data").value.nome},{data:A}=([i,g]=$(()=>_(U,{method:"POST",body:R},"$53NFRNGH7x")),i=await i,g(),i);c.value=Array.isArray(A.value)?A.value:[],console.log(c.value);const E=q(()=>c.value.every(o=>!o.codigo&&!o.value&&!o.parametros)?[]:c.value.map(o=>({label:o.codigo,value:o.codigo,parametros:o.parametros}))),x=async o=>{const a=E.value.find(e=>e.value===o);if(a){u.value=a.parametros.map(e=>({...e,value:null,showDatePicker:!1,items:[]}));for(const e of u.value)if(e.tipo==="TABLE"&&e.dominio)try{const{data:l}=await _(B,{method:"POST",body:{cartorio_token:R.cartorio_token,parametros:e.dominio}},"$c4psqRQWRs");e.items=Array.isArray(l.value)?l.value.map(t=>({label:t.nome,value:t.token})):[]}catch(l){console.error("Erro ao buscar dados para TABLE:",l)}}else u.value=[]},N=async o=>{const a=u.value.reduce((e,l)=>(e[l.parametro]=l.value,e),{});try{const e={...a,user_id:v("user-data").value.usuario_id,consulta:o},{data:l}=await _(h,{method:"POST",body:e},"$6CLQJHdzNf");window.open(l.value,"_blank"),u.value=[],s.value=null}catch(e){console.error("Erro ao criar o relatório:",e)}};return(o,a)=>(r(),y(w,null,[a[3]||(a[3]=T("h1",null,"Relatórios",-1)),T("div",null,[p(C,{modelValue:n(s),"onUpdate:modelValue":a[0]||(a[0]=e=>F(s)?s.value=e:null),items:n(E),class:"mb-5","item-title":"label","item-value":"value",label:"Selecione o relatório",required:"","onUpdate:search":x},null,8,["modelValue","items"])]),n(s)?(r(),y("div",Q,[p(G,null,{default:V(()=>[(r(!0),y(w,null,D(n(u),(e,l)=>(r(),d(S,{key:l},{default:V(()=>[p(O,{cols:"4"},{default:V(()=>[e.tipo!=="DATE"&&e.tipo!=="TABLE"?(r(),d(k,{key:0,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,label:e.label,required:e.obrigatorio},null,8,["modelValue","onUpdate:modelValue","label","required"])):m("",!0),e.tipo==="INTEGER"?(r(),d(k,{key:1,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,type:"number",outlined:""},null,8,["modelValue","onUpdate:modelValue"])):m("",!0),e.tipo==="DATE"?(r(),d(k,{key:2,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,type:"date"},null,8,["modelValue","onUpdate:modelValue"])):m("",!0),e.tipo==="TABLE"?(r(),d(C,{key:3,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,items:e.items,"item-title":"label","item-value":"value",label:e.label,required:e.obrigatorio},null,8,["modelValue","onUpdate:modelValue","items","label","required"])):m("",!0)]),_:2},1024)]),_:2},1024))),128)),p(I,{color:"green",class:"mt-4",onClick:a[1]||(a[1]=e=>N(n(s)))},{default:V(()=>a[2]||(a[2]=[P("Enviar")])),_:1})]),_:1})])):m("",!0)],64))}};export{ee as default};
