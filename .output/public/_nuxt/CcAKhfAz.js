import{_ as ie}from"./D30OiEiq.js";import{_ as ue}from"./D4zemkNR.js";import{_ as ce}from"./B-XI0v8g.js";import{_ as me}from"./Dsp8npIh.js";import{_ as z}from"./xFwOg1O6.js";import{_ as de}from"./BVz1G1IN.js";import{_ as pe}from"./CgIUqggn.js";import{a as ve}from"./DJvq3mCv.js";import{C as _e,J as fe,u as ke,r as l,e as v,f as he,s as ye,c as $,b as o,w as r,i as s,j as ge,k as Ve,F as we,l as be,o as w,V as q,a as u,v as j,d as B}from"./B_E4pH1E.js";import{u as _}from"./CODeQj60.js";import{V as b}from"./B3oK8asH.js";import{V as c}from"./B8JbSqLg.js";import{V as xe}from"./B3pP8eow.js";import{V as S}from"./BZix0oab.js";import"./CnnDeAhE.js";import"./CiIeflMy.js";import"./rZnRhoY0.js";import"./MJ2J-28f.js";import"./B0IxRygJ.js";import"./DPS1oOBH.js";import"./BYf4b4bD.js";import"./xQeghuNr.js";import"./B1AAzFL5.js";import"./CkJKeZFG.js";import"./C3iCTc0I.js";import"./qbusXUS4.js";import"./BiIL1GZj.js";import"./Is9XVdTw.js";import"./DbDMPfxZ.js";const Ce=["onClick"],Pe={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:z,alt:"Possui Ficha",title:"Possui Ficha"},$e={key:1,style:{width:"30px",height:"30px",cursor:"pointer"},src:pe,alt:"Visualizar",title:"Não Possui Ficha"},qe=["onClick"],at={__name:"autencidade",props:{ato_token:{type:String,required:!0}},emits:["ato-created"],async setup(N,{emit:U}){let f,F;const D=N,I=U,E=_e(),T=fe(),m=be(),{$toast:K}=ke(),Z=`${m.public.managemant}/listarEscrevente`,L=`${m.public.managemant}/pesquisarPessoas`,Q=`${m.public.managemant}/atoReconhecimento`,H=`${m.public.managemant}/etiquetaAutenticidade`,J=`${m.public.managemant}/download`,k=l(v("user-data").value.cartorio_token),W=l(v("user-service").value.token).value||l(v("user-service").value).value,G=v("auth_token").value,x=l([]),M=l([]),d=l([]),h=l(!1),C=l(!1),y=l(!1),g=l(null),O=l(null),P=l(""),A=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],n=he({quantidade:1,escrevente:null,nome:null,documento:null}),{data:X}=([f,F]=ye(()=>_(Z,{method:"POST",body:{cartorio_token:k}},"$qpB20nOlUE")),f=await f,F(),f);M.value=X.value[0].func_json_escreventes;async function Y(){try{const{data:t,error:e}=await _(L,{method:"POST",body:{cartorio_token:k.value,documento:n.documento,nome:n.nome}},"$CfpM9wZnUE");t.value.length>0?(I("ato-created"),x.value=t.value):x.value=[]}catch(t){console.error("Erro na requisição",t)}}const ee=()=>{C.value=!0};function te(t){d.value.push(t)}const oe=async t=>{g.value=t,y.value=!0;const{data:e}=await _(J,{method:"POST",body:{bucket:v("user-data").value.cartorio_token,path:t.link_ficha}},"$LrKAtpxZwH");O.value=e.value};function se(t){d.value=d.value.filter(e=>e.token!==t.token)}async function ae(){if(!n.escrevente){K.error("Por favor selecione um Escrevente");return}try{const t=d.value.map(i=>({pessoa_token:i.token})),{data:e,error:V,status:p}=await _(Q,{method:"POST",body:{pessoas:t,cartorio_token:k.value,ordemserv_token:W,quantidade:n.quantidade,usuario_token:G,ato_tipo_token:D.ato_token}},"$EE94jKo1pQ");p.value==="success"&&e.value[0].status==="OK"?(re(e.value[0].token),R()):(h.value=!0,P.value=ato_token.value.status_mensagem||V.value.data.details)}catch(t){h.value=!0,P.value=t,console.error("Erro na requisição",t)}}async function re(t){try{const{data:e,error:V,status:p}=await _(H,{method:"POST",body:{ato_token:t,cartorio_token:k.value,escrevente_token:n.escrevente}},"$KyoIzBxZyr");if(p.value==="success"){const i=window.open("","_blank");i.document.open(),i.document.write(e.value[0].etiqueta),i.document.close()}}catch(e){console.error("Erro na requisição",e)}}const R=()=>{const t=T.query.origem||"criar",e=T.query.id;t==="atualizar"?E.push(`/os/atualizar/${e}`):E.push("/os/criar-registro")};return(t,e)=>{const V=ie,p=ue,i=ce,ne=me;return w(),$(we,null,[o(b,{class:"mt-5"},{default:r(()=>[o(c,{cols:"5"},{default:r(()=>[o(xe,{label:"Tabelião/escrevente",modelValue:s(n).escrevente,"onUpdate:modelValue":e[0]||(e[0]=a=>s(n).escrevente=a),items:s(M),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),o(c,{cols:"2"},{default:r(()=>[o(q,{label:"Quantidade",type:"number",modelValue:s(n).quantidade,"onUpdate:modelValue":e[1]||(e[1]=a=>s(n).quantidade=a)},null,8,["modelValue"])]),_:1})]),_:1}),o(b,null,{default:r(()=>[o(c,{cols:"3"},{default:r(()=>[o(q,{label:"Documento",modelValue:s(n).documento,"onUpdate:modelValue":e[2]||(e[2]=a=>s(n).documento=a)},null,8,["modelValue"])]),_:1}),o(c,{cols:"4"},{default:r(()=>[o(q,{label:"Pessoa",modelValue:s(n).nome,"onUpdate:modelValue":e[3]||(e[3]=a=>s(n).nome=a)},null,8,["modelValue"])]),_:1}),u("div",null,[u("img",{class:"btn-pointer mt-1",src:z,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:Y})]),u("div",null,[u("img",{class:"btn-pointer mt-1 ml-2",src:de,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ee})])]),_:1}),o(b,null,{default:r(()=>[o(c,{class:"mr-10"},{default:r(()=>[o(S,{style:{height:"465px"},headers:A,items:s(x)},{"item.actions":r(({item:a})=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:le=>oe(a),title:"Visualizar Ficha"},[a.link_ficha?(w(),$("img",Pe)):(w(),$("img",$e))],8,Ce)]),_:1},8,["items"])]),_:1}),o(c,null,{default:r(()=>[o(S,{headers:A,items:s(d),style:{height:"465px"},"item-key":"id"},{"item.actions":r(({item:a})=>[u("div",{style:{display:"flex","justify-content":"flex-end"},onClick:le=>se(a),title:"Remover"},e[8]||(e[8]=[u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ve,alt:"Remover"},null,-1)]),8,qe)]),_:1},8,["items"])]),_:1})]),_:1}),o(V,{show:s(C),onClose:e[4]||(e[4]=a=>C.value=!1)},null,8,["show"]),s(y)?(w(),ge(p,{key:0,show:s(y),item:s(g),"pessoa-obj":s(g),"link-view":s(O),onConfirmar:e[5]||(e[5]=a=>te(s(g))),onClose:e[6]||(e[6]=a=>y.value=!1)},null,8,["show","item","pessoa-obj","link-view"])):Ve("",!0),o(i,{show:s(h),errorMessage:s(P),onClose:e[7]||(e[7]=a=>h.value=!1)},null,8,["show","errorMessage"]),o(b,null,{default:r(()=>[o(ne,{onClick:R},{default:r(()=>[o(j,{size:"large",color:"red"},{default:r(()=>e[9]||(e[9]=[B("Voltar")])),_:1})]),_:1}),o(j,{class:"ml-5",onClick:ae,size:"large",color:"green"},{default:r(()=>e[10]||(e[10]=[B("Salvar")])),_:1})]),_:1})],64)}}};export{at as default};
