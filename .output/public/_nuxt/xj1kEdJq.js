import{_ as go}from"./DdwEBhAa.js";import{_ as ho,a as wo}from"./BWvN1zOr.js";import{_ as Co}from"./DapHtTiK.js";import{_ as Ao}from"./TbY5Hzgj.js";import{c as So,r as xo,u as Do}from"./BH0N06JF.js";import{r as d,u as ao,e as A,f as eo,g as Oo,o as J,h as to,w as s,b as l,a as r,d as B,t as Uo,i as t,V as Q,j as To,k as lo,_ as Po,l as qo,n as Eo,m as Mo,c as No,p as zo,F as Io,q as D,s as m,v as C,x as Ro}from"./DH37S-X0.js";import{u as b}from"./BEfxIfo2.js";import{V as W,a as Fo}from"./B16Qmxdq.js";import{V as L}from"./3LuLNxGQ.js";import{V as M}from"./BF3su-ZN.js";import{V as Bo}from"./yZxK_X7S.js";import{V as jo}from"./TJKOOUJp.js";import{_ as oo}from"./DnWPfiwg.js";import{_ as Jo}from"./DV4jUF5X.js";import{_ as Lo}from"./DKW-zlvo.js";import{_ as Ho}from"./CkxRHKSR.js";import{u as Go}from"./Bt5Q_nWc.js";import{f as E}from"./B0IxRygJ.js";import{V as Xo}from"./sp--kCx7.js";import{V as c}from"./l6kSQR-y.js";import{V as j}from"./C2eYXCe7.js";import"./CrFZ4IFN.js";import"./BVz1G1IN.js";import"./DJvq3mCv.js";import"./ClBbx_sq.js";import"./SR4BCDrp.js";import"./BN5OaGGB.js";import"./BtvPX5Xu.js";import"./BjZWOkaB.js";import"./DcNSMfRb.js";import"./2JUpKchL.js";import"./D11DcERw.js";const Yo={class:"mb-5",style:{display:"flex","justify-content":"flex-start"}},Zo={class:"ml-6"},Ko={class:"ml-6"},Qo="O cancelamento de atos é definitivo e não pode ser revertido. Informe o motivo do cancelamento para confirmar",Wo={__name:"CancelamentoAto",props:{show:Boolean,ato_token:String},emits:["close"],setup(H,{emit:_}){const y=H,$=d(y.show),N=lo(),{$toast:g}=ao(),z=d(A("auth_token").value),O=`${N.public.managemant}/cancela_lavratura`,V=eo({motivo:null}),I=_,U={motivo:{required:So.withMessage("O campo é obrigatorio",xo)}},k=Do(U,V);Oo(()=>y.show,p=>{$.value=p});const h=()=>{$.value=!1,I("close")},S=async()=>{var p,i;if(await k.value.$validate())try{const{data:u,status:T}=await b(O,{method:"POST",body:{ato_token:y.ato_token,user_token:z.value,cancelar_selo:!1,motivo_cancelamento:V.motivo}},"$VPLGcUZMk8");T.value==="success"&&Array.isArray(u.value)&&((p=u.value[0])==null?void 0:p.status)==="OK"?(g.success("Ato cancelado com sucesso!"),h()):Array.isArray(u.value)&&((i=u.value[0])==null?void 0:i.status)==="ERRO"?g.error(u.value[0].status_mensagem||"Erro ao cancelar ato"):g.error("Erro inesperado ao cancelar ato")}catch(u){console.error("Erro ao cancelar ato:",u),g.error("Erro ao cancelar ato")}};return(p,i)=>(J(),to(jo,{persistent:"",modelValue:t($),"onUpdate:modelValue":i[1]||(i[1]=u=>To($)?$.value=u:null),"max-width":"650"},{default:s(()=>[l(W,null,{default:s(()=>[l(L,null,{default:s(()=>[l(M,{class:"mb-5 mt-1 ml-2"},{default:s(()=>i[2]||(i[2]=[r("h1",null,"Cancelamento de Ato",-1),r("h1",{style:{color:"red","margin-left":"18px"}},null,-1)])),_:1}),l(L,null,{default:s(()=>[l(W,{variant:"outlined",class:"mb-5"},{default:s(()=>[l(Fo,null,{default:s(()=>[B(Uo(Qo))]),_:1})]),_:1}),l(Bo,{label:"Motivo",modelValue:t(V).motivo,"onUpdate:modelValue":i[0]||(i[0]=u=>t(V).motivo=u),required:"","error-messages":t(k).motivo.$errors.map(u=>u.$message),onBlur:t(k).motivo.$touch,onInput:t(k).motivo.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),r("div",Yo,[r("div",Zo,[l(Q,{size:"large",color:"red",onClick:h},{default:s(()=>i[3]||(i[3]=[B("Fechar")])),_:1})]),r("div",Ko,[l(Q,{size:"large",color:"green",disabled:!t(V).motivo||t(V).motivo.trim()==="",onClick:S},{default:s(()=>i[4]||(i[4]=[B(" Salvar ")])),_:1},8,["disabled"])])])]),_:1})]),_:1},8,["modelValue"]))}},oa={style:{width:"1300px",margin:"0 auto"}},aa={style:{display:"flex",gap:"4px","justify-content":"center"}},ea=["onClick","title"],ta=["onClick","title"],la=["onClick","title"],na=["onClick"],sa=["title"],ra=["onClick"],ia=["title"],ua={__name:"index",setup(H){const _=lo(),{$toast:y}=ao(),$=`${_.public.managemant}/listarUsuarios`,N=`${_.public.managemant}/listar_tipo_atos`,g=`${_.public.biometria}/run-scanner?format=pdf`,z=`${_.public.envioDoc}/upload`;`${_.public.managemant}`;const O=`${_.public.managemant}/pesquisaAtos`,V=`${_.public.auth}/service/gerencia/lista_sit_atos`,I=A("auth_token"),{redirectTo:U}=Go(),k=d(A("auth_token").value)||null,h=d(A("user-data").value.cartorio_token)||null,S=d(!1),p=d([]),i=d([]),u=d([]),T=d([]),G=d(!1),X=d(!1),R=d(!1),Y=d(null),no=d({}),F=d(!1),P=d(null),n=eo({numero:null,data_inicio:Z(),data_fim:Z(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:k.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),so=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:e=>e.protocolo?`${e.id}
${e.protocolo}`:`${e.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:e=>e.dt_abertura?`${e.dt_abertura}
${e.apresentante_cpf}`:`${e.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:e=>e.dt_lavratura?`${e.dt_lavratura}
${e.apresentante_nome}`:`${e.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:e=>e.situacao?`${e.situacao}
${e.ato_servico}`:`${e.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function Z(){const e=new Date,o=e.getFullYear(),v=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${v}-${o}`}function w(e){if(!e)return null;const[o,v,f]=e.split("/");return`${f}-${v}-${o}`}async function K(){const e=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(e),{data:v}=await b(O,{method:"POST",body:{cartorio_token:A("user-data").value.cartorio_token,usuario_token:o.usuario_token||k.value,data_fim:w(o==null?void 0:o.data_fim),data_inicio:w(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");v.value.length>0&&(p.value=v.value.map(f=>({...f,dt_lavratura:f.dt_lavratura?E(f.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:E(f.dt_abertura,"dd/mm/yyyy")})))}async function ro(){const{data:e}=await b($,{method:"POST",body:{cartorio_token:h.value}},"$hvipqUJYtS");i.value=e.value}async function io(){const{data:e,error:o}=await b(V,{method:"GET",headers:{Authorization:`Bearer ${I.value}`}},"$OjamgBH6nj");T.value=e.value}async function uo(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(n));const{data:e}=await b(O,{method:"POST",body:{cartorio_token:h.value,numero_os:n.numero||null,data_inicio:w(n.data_inicio)||null,data_fim:w(n.data_fim)||null,data_lavratura_inicio:w(n.data_lavratura_inicio)||null,data_lavratura_fim:w(n.data_lavratura_fim)||null,protocolo:n.protocolo||null,livro:n.livro||null,folha:n.folha||null,situacao:n.situacao||null,usuario_token:n.usuario_token,selo:n.selo||null,ato_tipo_token:n.ato_tipo_token,parte:n.parte||null}},"$QxIfw0Zxe4");e.value.length>0?p.value=e.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?E(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?E(o.dt_abertura,"dd/mm/yyyy"):null})):(p.value=[],y.error("Não existe ato Registrado!"))}catch(e){console.error("Erro na requisição",e)}}const co=e=>{U({item:e,id:e.id,numeroOs:e.numero_os,origem:"vizualizar-lista"})};async function mo(){const{data:e,error:o}=await b(N,{method:"POST",body:{cartorio_token:h.value,usuario_token:k.value,tipo_retorno:"servico_ato"}},"$ceiptlfDNO");u.value=e.value}const po=e=>{P.value=e,F.value=!0};function _o(e){Y.value=e.numero,P.value=e.token,R.value=!0}const vo=e=>{U({item:e,id:e.id,numeroOs:e.numero_os,origem:"atualizar-lista"})},fo=async e=>{try{await Vo(),await yo(e)}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}};async function yo(e){try{const{status:o,data:v}=await b(z,{method:"POST",body:{tipo:"ato_livro",token:e,cartorio_token:A("user-data").value.cartorio_token}},"$zTNfED00Fu");o.value==="success"&&y.success("Arquivo enviado com sucesso!")}catch(o){y.error(o),console.error("Erro ao enviar o arquivo:",o)}}async function Vo(){try{const{data:e}=await b(g,{method:"GET"},"$hJse5XXJsY")}catch(e){y.error("Erro ao acionar o scanner:",e)}}return qo(()=>{Eo(async()=>{const e=sessionStorage.getItem("pesquisaAto");if(e){const o=JSON.parse(e);Object.assign(n,o)}await K()})}),ro(),mo(),io(),(e,o)=>{const v=go,f=ho,ko=Co,bo=Ao,$o=Wo,x=Mo("mask");return J(),No(Io,null,[l(L,{class:"mt-5"},{default:s(()=>[l(M,{class:"mb-5"},{default:s(()=>o[20]||(o[20]=[r("h1",null,"Atos",-1)])),_:1}),l(M,null,{default:s(()=>[l(c,{cols:"2"},{default:s(()=>[D(l(m,{modelValue:t(n).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=a=>t(n).data_inicio=a),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(c,{cols:"2"},{default:s(()=>[D(l(m,{modelValue:t(n).data_fim,"onUpdate:modelValue":o[1]||(o[1]=a=>t(n).data_fim=a),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(c,{cols:"2"},{default:s(()=>[D(l(m,{modelValue:t(n).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=a=>t(n).data_lavratura_inicio=a),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(c,{cols:"2"},{default:s(()=>[D(l(m,{modelValue:t(n).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=a=>t(n).data_lavratura_fim=a),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(c,{cols:"2"},{default:s(()=>[l(m,{modelValue:t(n).numero,"onUpdate:modelValue":o[4]||(o[4]=a=>t(n).numero=a),label:"N° OS"},null,8,["modelValue"])]),_:1}),l(c,{cols:"2"},{default:s(()=>[l(m,{modelValue:t(n).selo,"onUpdate:modelValue":o[5]||(o[5]=a=>t(n).selo=a),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),l(M,null,{default:s(()=>[l(c,{cols:"2"},{default:s(()=>[l(m,{modelValue:t(n).protocolo,"onUpdate:modelValue":o[6]||(o[6]=a=>t(n).protocolo=a),label:"Protocolo"},null,8,["modelValue"])]),_:1}),l(c,{cols:"2"},{default:s(()=>[D(l(m,{modelValue:t(n).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=a=>t(n).apresentante_cpf=a),label:"CPF",dense:""},null,8,["modelValue"]),[[x,"###.###.###-##"]])]),_:1}),l(c,{cols:"3"},{default:s(()=>[l(m,{modelValue:t(n).parte,"onUpdate:modelValue":o[8]||(o[8]=a=>t(n).parte=a),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),l(c,{cols:"3"},{default:s(()=>[l(j,{modelValue:t(n).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=a=>t(n).ato_tipo_token=a),items:t(u),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),l(c,{cols:"2"},{default:s(()=>[l(j,{items:t(i),modelValue:t(n).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=a=>t(n).usuario_token=a),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),l(c,{md:"3"},{default:s(()=>[l(j,{modelValue:t(n).situacao,"onUpdate:modelValue":o[11]||(o[11]=a=>t(n).situacao=a),items:t(T),"item-title":"descricao","item-value":"descricao",label:"Situação"},null,8,["modelValue","items"])]),_:1}),l(c,{cols:"1"},{default:s(()=>[l(m,{modelValue:t(n).livro,"onUpdate:modelValue":o[12]||(o[12]=a=>t(n).livro=a),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),l(c,{cols:"1"},{default:s(()=>[l(m,{modelValue:t(n).folha,"onUpdate:modelValue":o[13]||(o[13]=a=>t(n).folha=a),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),l(c,null,{default:s(()=>[r("div",null,[r("img",{onClick:uo,style:{width:"40px",height:"40px",cursor:"pointer"},src:oo,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),r("div",oa,[o[21]||(o[21]=r("hr",{class:"mt-5 mb-5"},null,-1)),l(Xo,{headers:so,items:t(p),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":s(({item:a})=>[r("div",aa,[r("div",{onClick:q=>co({id:a.id,tipo:`${a.tipo_servico} - ${a.tipo_ato}`,token:a.token,tipo_token:a.tipo_token,rota:a.rota,numero_os:a.numero_os}),title:a.btn_visualizar?"Visualizar":"Desabilitado"},[r("img",{style:C({width:"30px",height:"30px",cursor:a.btn_visualizar?"pointer":"not-allowed",opacity:a.btn_visualizar?"1":"0.5"}),src:oo,alt:"Visualizar"},null,4)],8,ea),r("div",{onClick:q=>po(a.token),title:a.btn_selos?"Reimprimir Selos":"Não permitido"},[r("img",{style:C({width:"30px",height:"30px",cursor:a.btn_selos?"pointer":"not-allowed",opacity:a.btn_selos?"1":"0.5"}),src:wo,alt:"Reimprimir"},null,4)],8,ta),r("div",{class:Ro({disabled:!a.btn_editar}),onClick:q=>a.btn_editar?vo({id:a.id,tipo:`${a.tipo_servico} - ${a.tipo_ato}`,token:a.token,tipo_token:a.tipo_token,rota:a.rota,numero_os:a.numero_os}):null,title:a.btn_editar?"Editar":"Desabilitado"},[r("img",{style:C({cursor:a.btn_editar?"pointer":"default",width:"30px",height:"30px",opacity:a.btn_editar?"1":"0.5"}),src:Jo,alt:"Editar"},null,4)],10,la),r("div",{onClick:q=>a.btn_cancelar?_o(a):null,title:"Excluir",style:C({cursor:a.btn_cancelar?"pointer":"not-allowed"})},[r("img",{style:C({width:"30px",height:"30px",cursor:a.btn_cancelar?"pointer":"not-allowed",opacity:a.btn_cancelar?"1":"0.5"}),src:Lo,alt:"Cancelar",title:a.btn_cancelar?"Cancelar":"Não permitido"},null,12,sa)],12,na),r("div",{onClick:q=>fo(a.token)},[r("img",{style:C({width:"30px",height:"30px",cursor:a.btn_escanear?"pointer":"not-allowed",opacity:a.btn_escanear?"1":"0.5"}),src:Ho,alt:"escanear",title:a.btn_escanear?"Escanear":"Não permitido"},null,12,ia)],8,ra)])]),_:1},8,["items"])]),t(S)?(J(),to(v,{key:0,show:t(S),servicos:e.dadosData.servicos||[],tiposAtos:e.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=a=>S.value=!1),onUpdateAto:e.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):zo("",!0),l(f,{show:t(F),ato_token:t(P),onClose:o[15]||(o[15]=a=>F.value=!1)},null,8,["show","ato_token"]),l(ko,{show:t(G),numero_os:t(Y),ordem:t(no),onClose:o[16]||(o[16]=a=>G.value=!1),onRefreshValue:o[17]||(o[17]=a=>K())},null,8,["show","numero_os","ordem"]),l(bo,{show:t(X),condMessage:e.condMessage,onClose:o[18]||(o[18]=a=>X.value=!1),onConfirm:e.cancelaAto},null,8,["show","condMessage","onConfirm"]),l($o,{show:t(R),ato_token:t(P),onClose:o[19]||(o[19]=a=>R.value=!1)},null,8,["show","ato_token"])],64)}}},Ba=Po(ua,[["__scopeId","data-v-cc1f17a0"]]);export{Ba as default};
