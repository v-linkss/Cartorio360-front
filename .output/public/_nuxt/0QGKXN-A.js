import{V as j,a as q}from"./Be1BTeLb.js";import{_ as A,p as V,r as d,g as w,m as U,o as f,C as y,w as a,b as o,d as p,s as l,v as b,c1 as E,a as H,c as x,y as J,J as C,z as B,A as W}from"./EhouhAgw.js";import{u as T}from"./DbmbSVZU.js";import{V as X,a as Z,c as G}from"./CzMneozR.js";import{V as K}from"./D2IiOHFH.js";import{V as Q}from"./CiYD_HWu.js";import{V as $}from"./By2JFqVX.js";import{V as Y}from"./CJlK7UN7.js";const L={class:"d-flex justify-center align-center"},ee={key:0,class:"ml-5 mt-15"},te=["src"],ae={__name:"FichaCard",props:{show:Boolean,item:Object,isView:{type:Boolean,default:!1},linkView:String},emits:["close","confirmar"],setup(R,{emit:z}){const s=R,_=W(),F=`${_.public.managemant}/getLinkTipo`,S=`${_.public.managemant}/download`,N=V(()=>!!n.value),O=V(()=>!!r.value),m=d(s.show),n=d(null),r=d(null),i=d(.8),u=d(0),g=z,P=V(()=>(i.value-1)*-50);w(()=>s.show,async t=>{m.value=t,n.value=null,await I()}),w(()=>s.linkView,t=>{s.isView&&(t&&t.includes(".tr7")?(n.value=t,r.value=null):(n.value=null,r.value=t))});const D=()=>{g("confirmar"),k()},I=async()=>{var h;if(s.isView||!s.item.id)return;const{data:t}=await T(F,{method:"POST",body:{tipo:"ficha",id:s.item.id}},"$4omB3S9Tg3");if(!((h=t.value)!=null&&h.link))return;const{data:e}=await T(S,{method:"POST",body:{bucket:U("user-data").value.cartorio_token,path:t.value.link}},"$yanMHqBuqW"),v=t.value.link,c=e.value;/\.(tr7|tiff)$/i.test(v)?n.value=c:r.value=c},k=()=>{m.value=!1,n.value=null,r.value=null,i.value=.8,u.value=0,g("close")},M=()=>{u.value+=90,u.value>=360&&(u.value=0)};return(t,e)=>{const v=q;return f(),y(Y,{persistent:"",modelValue:l(m),"onUpdate:modelValue":e[1]||(e[1]=c=>b(m)?m.value=c:null),"max-width":"850"},{default:a(()=>[o(X,null,{default:a(()=>[o(Z,{class:"text-h5"},{default:a(()=>e[2]||(e[2]=[p("Ficha de Firma")])),_:1}),o(K,null,{default:a(()=>[o(Q,null,{default:a(()=>[o($,{cols:"10"},{default:a(()=>[o(j,{modelValue:l(i),"onUpdate:modelValue":e[0]||(e[0]=c=>b(i)?i.value=c:null),min:"0.5",max:"1.1",step:"0.1",label:"Zoom",class:"mt-3"},null,8,["modelValue"])]),_:1}),o($,{cols:"2"},{default:a(()=>[o(E,{class:"ml-6",size:"50px",onClick:M},{default:a(()=>e[3]||(e[3]=[p("mdi-rotate-right")])),_:1})]),_:1})]),_:1})]),_:1}),H("div",L,[l(N)?(f(),x("div",ee,[o(v,{"tiff-url":l(n),"is-modal":!0,"zoom-level":l(i),"rotation-degree":l(u),"translate-x":l(P)},null,8,["tiff-url","zoom-level","rotation-degree","translate-x"])])):l(O)?(f(),x("img",{key:1,src:l(r),style:J({width:"70%",height:"70%",transform:`scale(${l(i)}) rotate(${l(u)}deg)`})},null,12,te)):C("",!0)]),o(G,null,{default:a(()=>[s.isView?C("",!0):(f(),y(B,{key:0,style:{"background-color":"#429946",color:"white"},onClick:D},{default:a(()=>e[4]||(e[4]=[p("Reconhecer")])),_:1})),o(B,{style:{"background-color":"red",color:"white"},onClick:k},{default:a(()=>e[5]||(e[5]=[p("Voltar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},me=A(ae,[["__scopeId","data-v-d447ef31"]]);export{me as _};
