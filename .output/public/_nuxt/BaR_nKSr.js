import{_ as te}from"./C_WaycAp.js";import{_ as oe,a as re}from"./BZU-M3hc.js";import{n as se,r as d,D as s,F as ne,G as le,o as m,A as f,w as n,x as ie,H as ue,b as l,a as i,t as de,q as t,I as ce,s as $,C as I,d as me,K as pe,L as _e,c as P,J as ve}from"./BYM4jG2M.js";import{u as w}from"./bciLEvKa.js";import"./DHdPNBH8.js";import{c as U,r as L,u as fe,V as ge,_ as he}from"./Br9g8LYa.js";import{_ as ye,a as ke}from"./CrE-eFFQ.js";import{_ as Ce,a as be}from"./qu7Wfn_m.js";import{_ as Ve}from"./ToPptOUL.js";import{V as xe}from"./Iv7da11N.js";import{V as h}from"./htQIkgNF.js";import{V as y}from"./qsPMAI4O.js";import"./D_spPjXB.js";const $e=i("h1",null,"Ordem de Serviço nº ",-1),we={style:{color:"red","margin-left":"30px"}},Se=i("h1",{class:"ml-5"},"Atos",-1),Oe=i("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:ye,alt:"novo"},null,-1),Ee=i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:re,alt:"Reimprimir"},null,-1),Te=[Ee],Re=["onClick","title"],Ae=["disabled","onClick"],Ne={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:be,alt:"Visualizar",title:"Reativar"},Fe={key:1,src:ke,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Qe={__name:"criar-registro",async setup(qe){var A,N,F,q,B;let g,S;const{$toast:_}=se(),k=ie(),M=`${k.public.managemant}/createOrdensServico`,z=`${k.public.managemant}/validarCpf`,G=`${k.public.managemant}/listarAtos`,H=d(s("user-data").value.cartorio_id),J=d(s("user-data").value.usuario_id),j=d((A=s("user-service").value)==null?void 0:A.token).value||null,K=d(s("user-data").value.cartorio_token).value,O=d((N=s("user-service").value)==null?void 0:N.numero);let E=d(!!((F=s("user-service").value)!=null&&F.numero)),C=d(s("ordem-button").value),b=!1;const V=d(!1),x=d([]),o=ne({nacionalidade:!1,apresentante_nome:(q=s("user-service").value)==null?void 0:q.apresentante_nome,apresentante_cpf:(B=s("user-service").value)==null?void 0:B.apresentante_cpf,documento:null}),Q=[{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],Y=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],W={apresentante_nome:{required:U.withMessage("O campo é obrigatorio",L)},apresentante_cpf:{required:U.withMessage("O campo é obrigatorio",L)}},c=fe(W,o);function T(r){if(r)return r.replace(/[.\-]/g,"");r=null}function X(){const r=s("user-service"),a=s("ordem-button");r.value=null,a.value=null}const Z=()=>{V.value=!0};async function ee(){const r={apresentante_cpf:T(o.apresentante_cpf),apresentante_nome:o.apresentante_nome,user_id:J.value,cartorio_id:H.value,estrangeiro:o.nacionalidade};if(await c.value.$validate()){const{data:a,error:p,status:u}=await w(M,{method:"POST",body:r},"$omLGvLxYlw");if(u.value==="error"&&p.value.statusCode===500)_.error("Erro ao cadastrar ordem,erro no sistema.");else{_.success("Ordem registrada com sucesso!"),E.value=!0,C.value=!1,O.value=a.value.numero;const v=s("ordem-button");v.value=C.value;const e=s("user-service");e.value=e.value=JSON.stringify({numero:a.value.numero,apresentante_cpf:a.value.apresentante_cpf,apresentante_nome:a.value.apresentante_nome,token:a.value.token})}}}async function ae(r){const a=T(r);if(a.length===11&&!b){b=!0;const p={cpf:a};try{const{data:u,error:v,status:e}=await w(z,{method:"POST",body:p},"$e6ybTA3ect");e.value==="error"&&v.value.statusCode===500?_.error("Erro ao cadastrar pessoa, o CPF já está cadastrado."):u.value.cpfValidation===!0?(o.apresentante_nome=u.value.nome,_.success("Cpf autenticado com sucesso!")):u.value.cpfValidation===!1&&_.error("Cpf não cadastrado!")}catch(u){console.error("Erro ao validar CPF:",u)}finally{b=!1}}}const{data:R}=([g,S]=le(()=>w(G,{method:"POST",body:{cartorio_token:K,ordemserv_token:j}},"$Q1qkHbHde0")),g=await g,S(),g);return R.value.length>0?x.value=R.value:x.value=[],(r,a)=>{const p=te,u=oe,v=ue("mask");return m(),f(xe,{class:"mt-5"},{default:n(()=>[l(h,{class:"mb-5"},{default:n(()=>{var e;return[$e,i("h1",we,de(t(O)||((e=("useCookie"in r?r.useCookie:t(s))("user-service").value)==null?void 0:e.numero)),1)]}),_:1}),l(h,null,{default:n(()=>[l(y,{md:"3"},{default:n(()=>[l(ge,{label:"Nacionalidade",items:Y,modelValue:t(o).nacionalidade,"onUpdate:modelValue":a[0]||(a[0]=e=>t(o).nacionalidade=e)},null,8,["modelValue"])]),_:1}),l(y,{md:"2"},{default:n(()=>[t(o).nacionalidade===!1?ce((m(),f($,{key:0,autofocus:"",modelValue:t(o).apresentante_cpf,"onUpdate:modelValue":a[1]||(a[1]=e=>t(o).apresentante_cpf=e),label:"CPF",required:"","error-messages":t(c).apresentante_cpf.$errors.map(e=>e.$message),onBlur:t(c).apresentante_cpf.$touch,onInput:a[2]||(a[2]=e=>ae(t(o).apresentante_cpf))},null,8,["modelValue","error-messages","onBlur"])),[[v,"###.###.###-##"]]):(m(),f($,{key:1,autofocus:"",modelValue:t(o).apresentante_cpf,"onUpdate:modelValue":a[3]||(a[3]=e=>t(o).apresentante_cpf=e),label:"Documento",required:"","error-messages":t(c).apresentante_cpf.$errors.map(e=>e.$message),onBlur:t(c).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),l(y,{md:"4"},{default:n(()=>[l($,{modelValue:t(o).apresentante_nome,"onUpdate:modelValue":a[4]||(a[4]=e=>t(o).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":t(c).apresentante_nome.$errors.map(e=>e.$message),onInput:t(c).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),t(C)?(m(),f(y,{key:0},{default:n(()=>[i("div",null,[i("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:he,alt:"Salvar",onClick:a[5]||(a[5]=e=>ee())})])]),_:1})):I("",!0)]),_:1}),t(E)?(m(),f(h,{key:0,style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:n(()=>[Se,l(p,{to:{path:"/ordens-servicos/criar-ato",query:{origem:"criar"}}},{default:n(()=>[Oe]),_:1}),me(),l(ve,{headers:Q,items:t(x),"item-key":"id"},{"item.actions":n(({item:e})=>[l(h,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:n(()=>[i("div",{onClick:a[6]||(a[6]=D=>Z()),title:"Reimprimir"},Te),i("div",{class:_e({disabled:!e.btn_editar}),onClick:D=>e.btn_editar?r.redirectToUpdate(e.id):null,title:e.btn_editar?"Editar":"Desabilitado"},[i("img",{style:pe({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:Ce,alt:"Editar"},null,4)],10,Re),i("div",{disabled:!e.btn_cancelar,onClick:D=>e.btn_cancelar?r.deleteEndereco(e):null,title:"Excluir"},[e.excluido?(m(),P("img",Ne)):(m(),P("img",Fe))],8,Ae)]),_:2},1024)]),_:1},8,["items"]),l(u,{show:t(V),onClose:a[7]||(a[7]=e=>V.value=!1)},null,8,["show"])]),_:1})):I("",!0),l(p,{to:"/ordens-servicos"},{default:n(()=>[i("img",{class:"btn-pointer mt-5",src:Ve,alt:"Sair",onClick:X})]),_:1})]),_:1})}}};export{Qe as default};
