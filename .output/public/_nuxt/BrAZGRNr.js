import{_ as ae}from"./BjoM3O_p.js";import{a as se,_ as re}from"./wqKNIfvd.js";import{_ as ne}from"./BIiYLUQ8.js";import{_ as ie}from"./BVz1G1IN.js";import{_ as le}from"./BzkpQIAL.js";import{_ as ue}from"./CqRSf2BS.js";import{_ as pe,a as de}from"./DJvq3mCv.js";import{c as E,r as T,u as me}from"./aK6ZQ8LY.js";import{u as ce,Q as _e,m as fe,r as u,n as k,p as ve,H as B,v as ge,y as w,w as n,A as ke,o as c,b as r,a as i,t as I,x as a,B as xe,V as C,d as U,G as he,E as $e,c as S,I as ye}from"./DF05AKOF.js";import{u as O}from"./CfW26UbF.js";import{f as Ve}from"./wcDvEv2s.js";import{V as be}from"./DX5EcUUi.js";import{V as x}from"./Bz1YW4Y4.js";import{V as h}from"./BnbVBdqt.js";import{V as we}from"./Bdr9bsK4.js";import{V as Ce}from"./DuTXH_CJ.js";import"./CRqjvR77.js";import"./UZ8fUI0u.js";import"./BjU9UHJO.js";import"./CfJimsn2.js";import"./Bk9u9Tim.js";import"./5IN7PNWq.js";import"./sPIO4lIV.js";const Oe={style:{color:"red","margin-left":"30px"}},Ae=["onClick"],Re=["onClick"],ze=["onClick","title"],Ee=["disabled","onClick"],Te={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:pe,alt:"Visualizar",title:"Reativar"},Be={key:1,src:de,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},st={__name:"[id]",async setup(Ie){let l,_;const{$toast:A}=ce(),q=_e(),{id:d}=q.params,$=fe(),f=ke(),P=`${f.public.managemant}/updateOrdensServico`,D=`${f.public.managemant}/getOrdensServicoById`,N=`${f.public.managemant}/listarAtos`,F=`${f.public.managemant}/updateAtos`,M=u(k("user-data").value.cartorio_id),G=u(k("user-data").value.usuario_id),L=u(k("user-service").value.token).value||null,H=u(k("user-data").value.cartorio_token).value,y=u([]),V=u(!1),R=u(null),m=u(null),s=ve({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),K=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],Q=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],W={apresentante_nome:{required:E.withMessage("O campo é obrigatorio",T)},apresentante_cpf:{required:E.withMessage("O campo é obrigatorio",T)}},p=me(W,s);function X(t){if(t)return t.replace(/[.\-]/g,"");t=null}const Y=t=>{R.value=t,V.value=!0},Z=t=>{(t.rota==="/fontes/atos/ato-com-bem/geral"||t.rota==="/fontes/atos/ato-sem-bem/geral")&&$.push({path:`/fontes/atos/atos-com-bem/atualizar/${t.id}`,query:{origem:"vizualizar",id:d,ato_id:t.id,tipo_ato_token:t.tipo_token,tipo_ato:t.tipo,ato_token_edit:t.token,numero_os:m.value,usa_imoveis:t.usa_imoveis}})},j=t=>{(t.usa_imoveis||!t.usa_imoveis)&&$.push({path:`/fontes/atos/atos-com-bem/atualizar/${t.id}`,query:{origem:"atualizar",id:d,ato_id:t.id,tipo_ato_token:t.tipo_token,tipo_ato:t.tipo,ato_token_edit:t.token,numero_os:m.value,usa_imoveis:t.usa_imoveis}})};async function J(){const t={apresentante_cpf:X(s.apresentante_cpf),apresentante_nome:s.apresentante_nome,user_id:G.value,cartorio_id:M.value},{error:o,status:g}=await O(`${P}/${d}`,{method:"PUT",body:t},"$Fud06ay483");g.value==="error"&&o.value.statusCode===500?A.error("Erro ao cadastrar ordem,erro no sistema."):(A.success("Ordem Atualizada com sucesso!"),$.push({path:"/os/lista"}))}const{data:v}=([l,_]=B(()=>O(`${D}/${d}`,{method:"GET"},"$wPUkUpDvPf")),l=await l,_(),l);m.value=v.value.numero,s.nacionalidade=v.value.estrangeiro,s.apresentante_cpf=v.value.apresentante_cpf,s.apresentante_nome=v.value.apresentante_nome;const{data:z}=([l,_]=B(()=>O(N,{method:"POST",body:{cartorio_token:H,ordemserv_token:L}},"$YXZ55K3IUf")),l=await l,_(),l);async function ee(t){t.excluido=!t.excluido;try{await Ve(`${F}/${t.id}`,{method:"PUT",body:{excluido:t.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}return z.value.length>0?y.value=z.value:y.value=[],(t,o)=>{const g=ae,te=re,oe=ge("mask");return c(),w(be,{class:"mt-5"},{default:n(()=>[r(x,{class:"mb-5"},{default:n(()=>[o[6]||(o[6]=i("h1",null,"Ordem de Serviço nº",-1)),i("h1",Oe,I(a(m)),1)]),_:1}),r(x,null,{default:n(()=>[r(h,{md:"3"},{default:n(()=>[r(we,{label:"Nacionalidade",items:Q,modelValue:a(s).nacionalidade,"onUpdate:modelValue":o[0]||(o[0]=e=>a(s).nacionalidade=e)},null,8,["modelValue"])]),_:1}),r(h,{md:"2"},{default:n(()=>[a(s).nacionalidade==="brasileiro"?xe((c(),w(C,{key:0,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":o[1]||(o[1]=e=>a(s).apresentante_cpf=e),label:"CPF",required:"","error-messages":a(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(p).apresentante_cpf.$touch,onInput:a(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[oe,"###.###.###-##"]]):(c(),w(C,{key:1,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":o[2]||(o[2]=e=>a(s).apresentante_cpf=e),label:"Documento",required:"","error-messages":a(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),r(h,{md:"4"},{default:n(()=>[r(C,{modelValue:a(s).apresentante_nome,"onUpdate:modelValue":o[3]||(o[3]=e=>a(s).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":a(p).apresentante_nome.$errors.map(e=>e.$message),onInput:a(p).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),r(h,null,{default:n(()=>[i("div",null,[i("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:ne,alt:"Salvar",onClick:o[4]||(o[4]=e=>J())})])]),_:1})]),_:1}),r(x,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:n(()=>[o[10]||(o[10]=i("h1",{class:"ml-5"},"Atos",-1)),r(g,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:a(d),numeroOs:a(m)}}},{default:n(()=>o[7]||(o[7]=[i("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:ie,alt:"novo"},null,-1)])),_:1},8,["to"]),r(Ce,{headers:K,items:a(y),"item-key":"id"},{"item.actions":n(({item:e})=>[U(I(e)+" ",1),r(x,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:n(()=>[i("div",{onClick:b=>Z(e),title:"Visualizar"},o[8]||(o[8]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:le,alt:"Visualizar"},null,-1)]),8,Ae),i("div",{onClick:b=>Y(e.token),title:"Reimprimir"},o[9]||(o[9]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:se,alt:"Reimprimir"},null,-1)]),8,Re),i("div",{class:$e({disabled:!e.btn_editar}),onClick:b=>e.btn_editar?j({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,usa_imoveis:e.usa_imoveis}):null,title:e.btn_editar?"Editar":"Desabilitado"},[i("img",{style:he({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ue,alt:"Editar"},null,4)],10,ze),i("div",{disabled:!e.btn_cancelar,onClick:b=>e.btn_cancelar?ee(e):null,title:"Excluir"},[e.excluido?(c(),S("img",Te)):(c(),S("img",Be))],8,Ee)]),_:2},1024)]),_:1},8,["items"]),r(te,{show:a(V),ato_token:a(R),onClose:o[5]||(o[5]=e=>V.value=!1)},null,8,["show","ato_token"])]),_:1}),r(g,{to:"/os/lista"},{default:n(()=>[r(ye,{size:"large",color:"red"},{default:n(()=>o[11]||(o[11]=[U("Voltar")])),_:1})]),_:1})]),_:1})}}};export{st as default};
