import{_ as oe}from"./Cbc0Spl8.js";import{_ as te,L as se,C as le,B as z,r as N,N as Y,v as de,O as ie,o as m,c as H,x as l,s as _,P as re,t as ne,y as f,w as o,b as e,V,Q as L,a as M,F as ue,z as me,p as ce,e as pe,d as w,A as J}from"./8Lc1Ye8d.js";import{b as _e,a as Q}from"./BatLNKDS.js";import{V as y,_ as fe}from"./DzzenEPx.js";import{_ as Ve}from"./37abXc2X.js";import{g as A,r as B,u as ve,V as F,a as be,b as P,c as ge,_ as Ce,d as $e,e as Ie,f as ye}from"./D9zQy4Wy.js";import{V as p}from"./DMyzBB-L.js";import{V as D}from"./C9vNJnFK.js";import{V as Z}from"./B731R9lY.js";import{V as xe}from"./DNLTjn2t.js";import"./BUe_X6z7.js";import"./CZDdFGDk.js";import"./3wJ_PxiT.js";import"./B__GP0ju.js";const X=A.withMessage("CPF inválido",v=>{if(!v)return!1;const r=v.replace(/[^\d]+/g,"");if(r.length!==11||/^(\d)\1+$/.test(r))return!1;let d=0;for(let c=0;c<9;c++)d+=parseInt(r.charAt(c))*(10-c);let n=11-d%11;if((n===10||n===11)&&(n=0),n!==parseInt(r.charAt(9)))return!1;d=0;for(let c=0;c<10;c++)d+=parseInt(r.charAt(c))*(11-c);return n=11-d%11,(n===10||n===11)&&(n=0),n===parseInt(r.charAt(10))}),ke=v=>(ce("data-v-1803b434"),v=v(),pe(),v),we={key:1},Fe=ke(()=>M("img",{class:"btn-pointer",src:fe,alt:"Sair"},null,-1)),Pe={__name:"Dados",emits:["saved"],async setup(v,{emit:r}){let d,n;const c=r,U=se(),{$toast:I}=le(),$=me(),W=`${$.public.managemant}/createPessoa`,b=`${$.public.managemant}/updatePessoa`,R=`${$.public.managemant}/listarEstadoCivil`,T=`${$.public.managemant}/listarCapacidadeCivil`,E=`${$.public.managemant}/listarCidades`,q={nome:"",nome_pai:"",nome_mae:"",profissao:"",local_trabalho:"",data_nascimento:"",doc_identificacao:"",cpf_pai:"",cpf_mae:"",local_trabalho:"",tipo_pessoa:"FISICA",tabvalores_estadocivil_id:"",tabvalores_capacidadecivil_id:"",cidade_natural_id:"",cartorio_id:z("user-data").value.cartorio_id,user_id:z("user-data").value.usuario_id},S=N(!1),g=z("pessoa-id"),t=Y({...q});function x(i){if(i)return i.replace(/[.\-]/g,"");i=null}const{data:O,status:he,pending:j,error:G}=([d,n]=de(async()=>_e("cliente-dados",async()=>{const[i,s,C]=await Promise.all([$fetch(R),$fetch(T),$fetch(E)]);return{estadoCivilItems:i,capacidadeCivilItems:s,cidadeNascimentoItems:C}})),d=await d,n(),d),K={nome:{required:A.withMessage("O campo é obrigatorio",B)},nome_mae:{required:A.withMessage("O campo é obrigatorio",B)},doc_identificacao:{required:A.withMessage("O campo é obrigatorio",B),cpf:X},cpf_mae:{required:A.withMessage("O campo é obrigatorio",B),cpf:X}},u=ve(K,t);async function ee(){if(await u.value.$validate()){const i={...t};for(const h in i)i[h]===""&&(i[h]=null);const s={...i,doc_identificacao:x(t.doc_identificacao),cpf_pai:x(t.cpf_pai),cpf_mae:x(t.cpf_mae)},{data:C,error:k,status:a}=await Q(W,{method:"POST",body:s},"$fcbWHpl5XR");if(a.value==="error"&&k.value.statusCode===500)I.error("Erro ao cadastrar pessoa,o CPF já está cadastrado.");else{I.success("Pessoa cadastrada com sucesso!");const h=C.value.id;g.value=h,c("saved"),S.value=!0}}else I.error("Erro ao cadastrar pessoa, preencha os campos obrigatorios.")}async function ae(){const i={...t};for(const C in i)i[C]===""&&(i[C]=null);const s={...i,doc_identificacao:x(t.doc_identificacao),cpf_mae:x(t.cpf_mae)};await Q(`${b}/${g.value}`,{method:"PUT",body:s},"$S30ZRYxneo"),I.success("Pessoa atualizada com sucesso!"),U.push("/pessoas/registros")}return(i,s)=>{const C=oe,k=ie("mask");return m(),H(ue,null,[l(j)?(m(),_(re,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):l(G)?(m(),H("div",we,ne(l(G).message),1)):f("",!0),l(j)?f("",!0):(m(),_(Z,{key:2,class:"mt-5"},{default:o(()=>[e(y,null,{default:o(()=>[e(p,{cols:"12",md:"8"},{default:o(()=>[e(V,{modelValue:t.nome,"onUpdate:modelValue":s[0]||(s[0]=a=>t.nome=a),"error-messages":l(u).nome.$errors.map(a=>a.$message),label:"Nome",required:"",onBlur:l(u).nome.$touch,onInput:l(u).nome.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1}),e(p,{cols:"12",md:"4"},{default:o(()=>[L(e(V,{modelValue:t.doc_identificacao,"onUpdate:modelValue":s[1]||(s[1]=a=>t.doc_identificacao=a),"error-messages":l(u).doc_identificacao.$errors.map(a=>a.$message),label:"CPF",required:"",onBlur:l(u).doc_identificacao.$touch,onInput:l(u).doc_identificacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),[[k,"###.###.###-##"]])]),_:1})]),_:1}),e(y,null,{default:o(()=>[e(p,{cols:"12",md:"4"},{default:o(()=>[e(D,{modelValue:t.tabvalores_estadocivil_id,"onUpdate:modelValue":s[2]||(s[2]=a=>t.tabvalores_estadocivil_id=a),items:l(O).estadoCivilItems,"item-title":"descricao","item-value":"id",label:"Estado Civil"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",md:"4"},{default:o(()=>[e(V,{modelValue:t.profissao,"onUpdate:modelValue":s[3]||(s[3]=a=>t.profissao=a),label:"Profissão"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4"},{default:o(()=>[e(V,{modelValue:t.local_trabalho,"onUpdate:modelValue":s[4]||(s[4]=a=>t.local_trabalho=a),label:"Local de trabalho"},null,8,["modelValue"])]),_:1})]),_:1}),e(y,null,{default:o(()=>[e(p,{cols:"12",md:"4"},{default:o(()=>[e(V,{modelValue:t.data_nascimento,"onUpdate:modelValue":s[5]||(s[5]=a=>t.data_nascimento=a),type:"date","prepend-icon":"",label:"Data de nascimento"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4"},{default:o(()=>[e(D,{modelValue:t.tabvalores_capacidadecivil_id,"onUpdate:modelValue":s[6]||(s[6]=a=>t.tabvalores_capacidadecivil_id=a),items:l(O).capacidadeCivilItems,label:"Capacidade Civil","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12",md:"4"},{default:o(()=>[e(D,{modelValue:t.cidade_natural_id,"onUpdate:modelValue":s[7]||(s[7]=a=>t.cidade_natural_id=a),items:l(O).cidadeNascimentoItems,label:"Cidade de nascimento","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),e(y,null,{default:o(()=>[e(p,{cols:"12",md:"4"},{default:o(()=>[L(e(V,{modelValue:t.cpf_pai,"onUpdate:modelValue":s[8]||(s[8]=a=>t.cpf_pai=a),modelModifiers:{date:!0},label:"CPF do Pai"},null,8,["modelValue"]),[[k,"###.###.###-##"]])]),_:1}),e(p,{cols:"12",md:"4"},{default:o(()=>[e(V,{modelValue:t.nome_pai,"onUpdate:modelValue":s[9]||(s[9]=a=>t.nome_pai=a),modelModifiers:{date:!0},label:"Nome do Pai"},null,8,["modelValue"])]),_:1})]),_:1}),e(y,null,{default:o(()=>[e(p,{cols:"12",md:"4"},{default:o(()=>[L(e(V,{modelValue:t.cpf_mae,"onUpdate:modelValue":s[10]||(s[10]=a=>t.cpf_mae=a),modelModifiers:{date:!0},"error-messages":l(u).cpf_mae.$errors.map(a=>a.$message),label:"CPF da Mãe",required:"",onBlur:l(u).cpf_mae.$touch,onInput:l(u).cpf_mae.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),[[k,"###.###.###-##"]])]),_:1}),e(p,{cols:"12",md:"4"},{default:o(()=>[e(V,{modelValue:t.nome_mae,"onUpdate:modelValue":s[11]||(s[11]=a=>t.nome_mae=a),modelModifiers:{date:!0},"error-messages":l(u).nome_mae.$errors.map(a=>a.$message),label:"Nome da Mãe",required:"",onBlur:l(u).nome_mae.$touch,onInput:l(u).nome_mae.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),e(y,null,{default:o(()=>[e(C,{to:"/pessoas/registros"},{default:o(()=>[Fe]),_:1}),M("img",{class:"btn-pointer",src:Ve,onClick:s[12]||(s[12]=a=>S.value?ae():ee())})]),_:1})]),_:1}))],64)}}},Ae=te(Pe,[["__scopeId","data-v-1803b434"]]),Ue=M("h1",{style:{"background-color":"#C8FCCA",color:"#429946",padding:"10px 0px 0px 20px"}}," Cadastramento de pessoas ",-1),Se={style:{"background-color":"#C8FCCA",padding:"20px 0px 20px 20px"}},He={__name:"index",setup(v){const r=N(null),d=N(!1),n=N(!1),U=Y({...{tipo_pessoa:"FISICA"}}),I=["FISICA","JURIDICA","ESTRANGEIRA"],$=()=>{d.value=!0,n.value=!0};return(W,b)=>{const R=Ae,T=Ce,E=$e,q=Ie,S=ye;return m(),_(xe,{width:"1300"},{default:o(()=>[Ue,M("div",Se,[e(D,{modelValue:l(U).tipo_pessoa,"onUpdate:modelValue":b[0]||(b[0]=g=>l(U).tipo_pessoa=g),style:{width:"200px"},items:I,label:"Tipo de pessoa","bg-color":"#F6F6F6",disabled:l(n)},null,8,["modelValue","disabled"])]),e(be,{modelValue:l(r),"onUpdate:modelValue":b[1]||(b[1]=g=>J(r)?r.value=g:null),"bg-color":"#C8FCCA"},{default:o(()=>[e(F,{value:"dados"},{default:o(()=>[w("Dados")]),_:1}),l(d)?(m(),_(F,{key:0,value:"documento"},{default:o(()=>[w("Documentos")]),_:1})):f("",!0),l(d)?(m(),_(F,{key:1,value:"endereco"},{default:o(()=>[w("Endereços")]),_:1})):f("",!0),l(d)?(m(),_(F,{key:2,value:"biometria"},{default:o(()=>[w("Biometria")]),_:1})):f("",!0),l(d)?(m(),_(F,{key:3,value:"restricao"},{default:o(()=>[w("Restrições")]),_:1})):f("",!0)]),_:1},8,["modelValue"]),e(ge,{modelValue:l(r),"onUpdate:modelValue":b[2]||(b[2]=g=>J(r)?r.value=g:null)},{default:o(()=>[e(P,{value:"dados"},{default:o(()=>[e(R,{onSaved:$})]),_:1}),l(d)?(m(),_(P,{key:0,value:"documento"},{default:o(()=>[e(T)]),_:1})):f("",!0),l(d)?(m(),_(P,{key:1,value:"endereco"},{default:o(()=>[e(E)]),_:1})):f("",!0),l(d)?(m(),_(P,{key:2,value:"biometria"},{default:o(()=>[e(Z,{class:"mt-5"},{default:o(()=>[e(q)]),_:1})]),_:1})):f("",!0),l(d)?(m(),_(P,{key:3,value:"restricao"},{default:o(()=>[e(S)]),_:1})):f("",!0)]),_:1},8,["modelValue"])]),_:1})}}};export{He as default};
