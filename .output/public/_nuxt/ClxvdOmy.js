import{_ as P}from"./4u97w4Tn.js";import{a as h,d as Z,V as E}from"./r8yh9lJA.js";import{V as N}from"./BQcnqvwy.js";import{V,u as D}from"./BiEQowPw.js";import{r as d,g as Q,o as F,G as O,w as a,b as l,a as i,A as C,d as p,v as m,x as k,u as X,m as G,D as $,t as H,V as I,s as ee,bx as oe}from"./BLoPs_BL.js";import{_ as le}from"./BVz1G1IN.js";import{V as ae}from"./CTkDAExr.js";import{V as re}from"./D-7GlszZ.js";const te={__name:"ModalRecebimentoCond",props:{show:Boolean,faltaReceber:Number},emits:["close","confirmar"],setup(x,{emit:B}){const o=x,u=d(o.show),c=B;Q(()=>o.show,w=>{u.value=w});const v=()=>{c("confirmar"),b()},b=()=>{u.value=!1,c("close")};return(w,n)=>(F(),O(E,{persistent:"",modelValue:m(u),"onUpdate:modelValue":n[0]||(n[0]=y=>k(u)?u.value=y:null),"max-width":"650"},{default:a(()=>[l(h,null,{default:a(()=>[l(N,null,{default:a(()=>[l(V,{class:"mb-5 mt-1 ml-2"},{default:a(()=>n[1]||(n[1]=[i("h1",null,"Confirmação de Recebimento",-1)])),_:1}),l(V,{class:"ml-2"},{default:a(()=>n[2]||(n[2]=[i("p",null," O valor recebido é menor que o valor da OS, confirma o recebimento parcial? ",-1)])),_:1})]),_:1}),l(Z,null,{default:a(()=>[l(C,{style:{"background-color":"#429946",color:"white"},onClick:v},{default:a(()=>n[3]||(n[3]=[p("Confirmar")])),_:1}),l(C,{style:{"background-color":"red",color:"white"},onClick:b},{default:a(()=>n[4]||(n[4]=[p("Cancelar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAABJhJREFUeJztW81v3EQcfTM73ZU3C1GF4NJAG+UGSKgSjZAgfwCFHnMpiAMSyckHGim2FAl8cSRvFFopApEixIW/APFx48IKCS5wQOKGGpqWAx/SqhslMY6HS1PZg+0de2fsSdN3m/HM6Ofn37zxPI8JNMO27Y5lWcuEkKsAngcwNabLHoBfOOefd7vdm57nhTrjIzoHX1tbOxdF0VcAXqg4xM+Msdd937+jMq4ktBFg23an2+3+gOo3f4yfLMt6SVcmUB2DAoBlWcuY/OYB4OL+/v47CsbJBNM1MCHkjWSZc/41gOV+v79b1G91dXWGEHITwKuJ6jcBfKg+So0ZAOBZoTz25gGg3+/vMsaWhern1IWVhk4CesmCzM0fw/f920LVY0oiyoBOAk4Exq4CjuNcAXANwCWMX8NNwR6AH+M4/mBjY+PLooatoouu664D+AjABQBtZeHpRxvALCHk6sLCwpnBYPBtXsPcDLj/5L/QEV3diOP4Sl4mFGnANU3x1A5K6bt514reA14Uyi8HQfC9mpD0wnGcVwB8l6i6lNe2KANSy9hJuXkACIJgIFTlLqOnfhl8REDTATSNU0+A9G7QcRyuM5CmcOozoIgA6d2b6eCci7vLBygiYAkPAQmc89uU0qW861KeoOM4OwCeOS5HUXRhc3NzR0F8yrCysnKeMXYrUfV7EATnx/WT1YBRssAY6+U1bAqdTkd827sn068SAZRS4wiIokiMaZTZUEAlAo6OjowjIOOhSBEg9R5ACBlxzpPlXAIcx3kNwDYADmApCIJv6mgXx3GPkJSkqcsAzvlIKBdlwMcAzgGY4Zxv19VOfCiEEKVTICUolNIil3YmEcTTNbZLxRTHsToRLJkBjUBrBlBKU4MVaUCDSDnWhJA9mU6yUyA1GOfcOHs8juPUQxGzNg+VpgA0fqmZAKmYtIqgiVNAjOmRCOoUQQiOsQkQH4pSDYjj2HgCIMTUarXUEcAYO3EimPHQMiFFwOHhoSgoxmVAhi6pE8F2u238FBBFMAxDdRkwGo2MJwBCTNPT0+oI2NraOgTwb6Kq7XmeMecFbNvuADiTqAplj9WVscVTjA6HQ2OyoNfrVTJDgBIEiOvqmC1xrQjDUD8B4puVScZohiGqngD83xQxhoAMQ1RqCQQm0ACTjNGqhigwwRQwaUcoegGoQwRN2hFW3QkCD8kqAGEfILsTBCYQQZMzADpE0HBjtJIhCpTLAGON0aqGKDCBBsAsT6CSIQpMQEDBFHhwqKLoZIbKdmIsTYvgEoDdcSczVLabRASlT4lRSlNfiJHjCdz/elv0DU95u6qGKFAiAww3RisZokA5DfhbqJr1PK/xY3aLi4stALPJuiiK/pHtL30DU1NTO0gvhU8dHBxcd133rOwYquG67tm5ubkbAJ5MVN8bDoe3ZMco9eeo4zifAni7TJ8G8EkQBEWimkKpFGaMvQfgr9Ih1Yc/W63W+2U6lCLA9/07hJDLAP4oFVY9uMs5v7y+vl4qtsK/xrIwGAzuzs/Pf8YYCznnTxBCHofGX3DH4ADArwC2CSFvBUHwW9kB/gMs68lWOHHFdwAAAABJRU5ErkJggg==",ne={style:{color:"red","margin-left":"18px"}},me={style:{"max-width":"180px"}},ie=["onClick"],ue={style:{display:"flex","justify-content":"flex-start"}},Ce={__name:"Ordem",props:{show:Boolean,ordem:{type:Object,required:!0}},emits:["close"],setup(x,{emit:B}){const o=x,{$toast:u}=X(),c=d(o.show),v=d(!1),b=ee(),w=`${b.public.managemant}/listarFormasReceb`,n=`${b.public.managemant}/receberOs`,y=G("auth_token").value,R=d([]),S=d(null),f=d([]),M=d([]),t=$({descricao:null,forma:null,valor:""}),q=B,J=[{title:"Forma",value:"forma"},{title:"Valor",value:"valor"},{value:"actions"}],A=d(0),Y=()=>{const r=parseFloat(o.ordem.valor),e=parseFloat(o.ordem.valor_pago);A.value=parseFloat(r-e).toFixed(2)};Q(()=>o.show,r=>{c.value=r,r&&Y()});const U=()=>{c.value=!1,t.forma=null,t.descricao=null,t.valor="",f.value=[],q("close")},j=async()=>{S.value=Number(o.ordem.valor),v.value=!0},T=async()=>{try{const r={ordemserv_token:o.ordem.token,usuario_token:y,recebimentos:[M.value]},{data:e}=await D(n,{method:"POST",body:JSON.stringify(r)},"$vhMIR8Sr2p");if(e.value[0].status==="OK")u.success(`${e.value[0].status}: Valores Recebidos com Sucesso!`),f.value=[],U();else{const g=e.value[0].status_mensagem;u.error(g)}}catch(r){u.error(r)}},K=()=>{o.ordem.valor=parseFloat(o.ordem.valor).toFixed(2),o.ordem.valor_pago=parseFloat(o.ordem.valor_pago).toFixed(2)},z=async()=>{try{const e={cartorio_token:d(G("user-data").value.cartorio_token).value},{data:g,error:_}=await D(w,{method:"POST",body:JSON.stringify(e)},"$eiMzO5y6Bb");R.value=oe(g.value)}catch(r){console.error("Erro ao realizar a requisição:",r)}},L=async()=>{const r=R.value.find(e=>e.token===t.forma);if(!r){u.error("Por favor, selecione uma forma.");return}f.value.push({forma:t.forma,descricao:r.descricao,valor:t.valor}),M.value.push({forma_receb_token:t.forma,valor:Number(t.valor)}),o.ordem.valor_pago=parseFloat(o.ordem.valor_pago)+parseFloat(t.valor),o.ordem.valor=parseFloat(o.ordem.valor)-parseFloat(t.valor),A.value=parseFloat(A.value)-parseFloat(t.valor),t.forma=null,t.valor="0.00",K()},W=r=>{const e=f.value.indexOf(r);e!==-1&&(f.value.splice(e,1),M.value.splice(e,1),o.ordem.valor_pago=parseFloat(o.ordem.valor_pago)-parseFloat(r.valor),o.ordem.valor=parseFloat(o.ordem.valor)+parseFloat(r.valor))};return z(),(r,e)=>{const g=P,_=te;return F(),O(E,{persistent:"",modelValue:m(c),"onUpdate:modelValue":e[6]||(e[6]=s=>k(c)?c.value=s:null),"max-width":"650"},{default:a(()=>[l(h,null,{default:a(()=>[l(N,null,{default:a(()=>[l(V,{class:"mb-5 mt-1 ml-2"},{default:a(()=>[e[7]||(e[7]=i("h1",null,"Ordem de Serviço nº",-1)),i("h1",ne,H(o.ordem.numero),1)]),_:1}),l(N,null,{default:a(()=>[l(V,null,{default:a(()=>[l(I,{class:"mr-5",label:"Recebido",modelValue:o.ordem.valor_pago,"onUpdate:modelValue":e[0]||(e[0]=s=>o.ordem.valor_pago=s),style:{"font-weight":"bold",cursor:"default","pointer-events":"none"},readonly:""},null,8,["modelValue"]),l(I,{label:"Falta Receber",style:{"font-weight":"bold",cursor:"default","pointer-events":"none"},modelValue:m(A),"onUpdate:modelValue":e[1]||(e[1]=s=>k(A)?A.value=s:null)},null,8,["modelValue"])]),_:1}),l(V,null,{default:a(()=>[l(ae,{class:"mb-5 mr-5",label:"Forma",modelValue:m(t).forma,"onUpdate:modelValue":e[2]||(e[2]=s=>m(t).forma=s),items:m(R),"item-title":"descricao","item-value":"token"},null,8,["modelValue","items"]),i("div",me,[l(g,{modelValue:m(t).valor,"onUpdate:modelValue":e[3]||(e[3]=s=>m(t).valor=s)},null,8,["modelValue"])]),i("div",null,[i("img",{src:le,class:"ml-5",style:{cursor:"pointer",height:"40px",width:"40px"},onClick:L})])]),_:1})]),_:1}),e[9]||(e[9]=i("hr",{class:"mb-5"},null,-1)),l(re,{headers:J,items:m(f),"item-value":"token"},{"item.forma":a(({item:s})=>[p(H(s.descricao),1)]),"item.actions":a(({item:s})=>[i("div",{style:{display:"flex","justify-content":"flex-end"},onClick:de=>W(s),title:"Remover"},e[8]||(e[8]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:se,alt:"Remover"},null,-1)]),8,ie)]),_:1},8,["items"])]),_:1}),i("div",ue,[l(C,{class:"ml-8",size:"large",onClick:U,color:"red"},{default:a(()=>e[10]||(e[10]=[p("Voltar")])),_:1}),Number(o.ordem.valor)>0?(F(),O(C,{key:0,class:"ml-6 mb-6",size:"large",color:"green",onClick:j},{default:a(()=>e[11]||(e[11]=[p("Salvar")])),_:1})):(F(),O(C,{key:1,size:"large",class:"ml-6 mb-6",color:"green",onClick:T},{default:a(()=>e[12]||(e[12]=[p("Salvar")])),_:1}))])]),_:1}),l(_,{modelValue:m(v),"onUpdate:modelValue":e[4]||(e[4]=s=>k(v)?v.value=s:null),faltaReceber:m(S),onClose:e[5]||(e[5]=s=>v.value=!1),onConfirmar:T},null,8,["modelValue","faltaReceber"])]),_:1},8,["modelValue"])}}};export{Ce as _};
