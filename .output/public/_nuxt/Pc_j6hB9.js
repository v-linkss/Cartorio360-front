import{_ as ke}from"./ZN9v-XaS.js";import{_ as pe}from"./a-TVMJ-j.js";import{c as $e,r as xe,m as Pe,u as we}from"./DEpi5b-x.js";import{D as ce,u as _e,r,m as ae,A as fe,E as ve,n as Ce,v as l,o as U,c as te,b as e,L as Ue,q as Y,w as a,V as _,a as m,H as W,d as D,s as Ve,F as Z,g as Te,I as ne}from"./DaneSYc1.js";import{u as I}from"./DJoYMKY3.js";import{V as g}from"./BMSRPTUx.js";import{V as n}from"./DbBP1eS_.js";import{V as Ie}from"./C-QOaEHa.js";import{V as C}from"./Dt-bgEF4.js";import{V as se}from"./DHqbyCIU.js";import{_ as Se,d as qe,V as Be,a as re,b as ze,c as ue}from"./Cm0eVwjU.js";import{b as Me}from"./B6gml0Zs.js";import{_ as de}from"./CCaEuro3.js";import{_ as me,a as De,b as Ae,c as Oe}from"./CIRLdqQh.js";import{V as Ne}from"./ICyKXb_2.js";import{V as ge,a as be}from"./DwKQgpcP.js";const Re={key:0,class:"d-flex justify-center"},Ee={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},emits:["saved","close-modal"],async setup(G,{emit:A}){let f,v;const b=G,k=A,V=ce(),y=Ve(),{$toast:S}=_e(),{id:q}=V.params,p=`${y.public.managemant}/registro_imoveis`,O=`${y.public.managemant}/natureza_imoveis`,N=`${y.public.managemant}/tipo_logradouros`,$=`${y.public.managemant}/situacao_imoveis`,B=`${y.public.managemant}/listarCidades`,Q=`${y.public.managemant}/listarTipoBens`,X=r(ae("user-data").value.cartorio_token);r(ae("user-data").value.usuario_id).value,r([]),r([]);const z=r([]),w=r([]),M=r([]),R=r([]),E=r([]);r(!1);const F=r(!0),t=fe({vlr_alienacao:null,tabvalores_tipo_regimovel_id:null,registro_cartorio:null,registro_matricula:null,registro_matricula_letra:null,tabvalores_nat_imovel_id:null,cib:null,end_cidade_id:null,end_quadra:null,end_lote:null,tabvalores_tipologradouro_id:null,end_logradouro:null,end_logradouro_numero:null,end_bairro:null,end_cep:null,end_complemento:null,tipo_id:null,descricao:null,inscricao_estadual:null,tabvalores_situacao_imoveis_id:null,tipo_id:null,vlr_alienacao:null,vlr_mercado:null,aliq_itbi:null,vlr_itbi:null}),h={descricao:{required:$e.withMessage("O campo é obrigatório",xe,Pe(3))}},c=we(h,t),ee=async()=>{if(!await c.value.$validate()){S.error("Preencha todos os campos obrigatórios!");return}k("saved")},{data:J}=([f,v]=ve(()=>I(`${Q}`,{method:"POST",body:{cartorio_token:X.value,imoveis:!0}},"$H1S2cTYpdB")),f=await f,v(),f);t.tiposBens=J.value;async function le(){try{const[T,o,x,L,s]=await Promise.all([$fetch(O),$fetch(p),$fetch($),$fetch(N),$fetch(B)]);w.value=T,z.value=o,E.value=x,M.value=L,R.value=s}catch(T){console.error("Erro ao carregar os dados de imoveis pessoa:",T)}finally{F.value=!1}}const oe=()=>{k("close-modal")};return Ce(()=>{q||b.ato_id?le():F.value=!1}),(T,o)=>{const x=ke,L=pe;return l(F)?(U(),te("div",Re,[e(Ue,{indeterminate:"",class:"loading-spinner",size:"64"})])):(U(),Y(se,{key:1},{default:a(()=>[e(g,null,{default:a(()=>[e(n,{class:"mt-5",cols:"12"},{default:a(()=>[e(Ie,{label:"Descrição",modelValue:l(t).descricao,"onUpdate:modelValue":o[0]||(o[0]=s=>l(t).descricao=s),"error-messages":l(c).descricao.$errors.map(s=>s.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(n,{cols:"3"},{default:a(()=>[e(C,{label:"Selecione o Tipo de Registro",modelValue:l(t).tabvalores_tipo_regimovel_id,"onUpdate:modelValue":o[1]||(o[1]=s=>l(t).tabvalores_tipo_regimovel_id=s),items:l(z),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(n,{cols:"2"},{default:a(()=>[e(_,{label:"Cartório",modelValue:l(t).registro_cartorio,"onUpdate:modelValue":o[2]||(o[2]=s=>l(t).registro_cartorio=s)},null,8,["modelValue"])]),_:1}),e(n,{cols:"2"},{default:a(()=>[e(_,{label:"Matricula",modelValue:l(t).registro_matricula,"onUpdate:modelValue":o[3]||(o[3]=s=>l(t).registro_matricula=s)},null,8,["modelValue"])]),_:1}),e(n,null,{default:a(()=>[e(_,{label:"Letra",modelValue:l(t).registro_matricula_letra,"onUpdate:modelValue":o[4]||(o[4]=s=>l(t).registro_matricula_letra=s)},null,8,["modelValue"])]),_:1}),e(n,{cols:"2"},{default:a(()=>[e(C,{label:"Natureza",modelValue:l(t).tabvalores_nat_imovel_id,"onUpdate:modelValue":o[5]||(o[5]=s=>l(t).tabvalores_nat_imovel_id=s),items:l(w),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(n,{cols:"1"},{default:a(()=>[e(_,{label:"CIB",modelValue:l(t).cib,"onUpdate:modelValue":o[6]||(o[6]=s=>l(t).cib=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(n,{cols:"3"},{default:a(()=>[e(C,{label:"Selecione a Cidade",modelValue:l(t).end_cidade_id,"onUpdate:modelValue":o[7]||(o[7]=s=>l(t).end_cidade_id=s),items:l(R),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(n,{cols:"2"},{default:a(()=>[e(_,{label:"Quadra",modelValue:l(t).end_quadra,"onUpdate:modelValue":o[8]||(o[8]=s=>l(t).end_quadra=s)},null,8,["modelValue"])]),_:1}),e(n,{cols:"2"},{default:a(()=>[e(_,{label:"Lote",modelValue:l(t).end_lote,"onUpdate:modelValue":o[9]||(o[9]=s=>l(t).end_lote=s)},null,8,["modelValue"])]),_:1}),e(n,{cols:"4"},{default:a(()=>[e(C,{label:"Logradouro",modelValue:l(t).tabvalores_tipologradouro_id,"onUpdate:modelValue":o[10]||(o[10]=s=>l(t).tabvalores_tipologradouro_id=s),items:l(M),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(n,{cols:"1"},{default:a(()=>[e(_,{label:"N*",modelValue:l(t).end_logradouro_numero,"onUpdate:modelValue":o[11]||(o[11]=s=>l(t).end_logradouro_numero=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(n,null,{default:a(()=>[e(_,{label:"Bairro",modelValue:l(t).end_bairro,"onUpdate:modelValue":o[12]||(o[12]=s=>l(t).end_bairro=s)},null,8,["modelValue"])]),_:1}),e(n,null,{default:a(()=>[e(_,{label:"CEP",modelValue:l(t).end_cep,"onUpdate:modelValue":o[13]||(o[13]=s=>l(t).end_cep=s)},null,8,["modelValue"])]),_:1}),e(n,null,{default:a(()=>[e(_,{label:"Complemento",modelValue:l(t).end_complemento,"onUpdate:modelValue":o[14]||(o[14]=s=>l(t).end_complemento=s)},null,8,["modelValue"])]),_:1}),e(n,{cols:"3"},{default:a(()=>[e(C,{modelValue:l(t).tipo_id,"onUpdate:modelValue":o[15]||(o[15]=s=>l(t).tipo_id=s),label:"Selecione o tipo de imovel","item-title":"descricao","item-value":"id"},null,8,["modelValue"])]),_:1}),e(n,{cols:"3"},{default:a(()=>[e(_,{label:"Inscrição Municipal"})]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(n,{class:"mt-6",cols:"4"},{default:a(()=>[e(C,{label:"Selecione a Situação",items:l(E),"item-title":"descricao","item-value":"id"},null,8,["items"])]),_:1}),e(n,{cols:"2"},{default:a(()=>[o[21]||(o[21]=m("label",null,"Valor Alienação",-1)),e(x,{label:"Valor Alienação",modelValue:l(t).vlr_alienacao,"onUpdate:modelValue":o[16]||(o[16]=s=>l(t).vlr_alienacao=s)},null,8,["modelValue"])]),_:1}),e(n,{cols:"2"},{default:a(()=>[o[22]||(o[22]=m("label",null,"Valor Avaliação",-1)),e(x,{label:"Valor Avaliação",modelValue:l(t).vlr_avaliacao,"onUpdate:modelValue":o[17]||(o[17]=s=>l(t).vlr_avaliacao=s)},null,8,["modelValue"])]),_:1}),e(n,{cols:"2"},{default:a(()=>[o[23]||(o[23]=m("label",null,"Valor Mercado",-1)),e(x,{label:"Valor Mercado",modelValue:l(t).vlr_mercado,"onUpdate:modelValue":o[18]||(o[18]=s=>l(t).vlr_mercado=s)},null,8,["modelValue"])]),_:1}),e(n,{cols:"1"},{default:a(()=>[o[24]||(o[24]=m("label",null,"%ITB",-1)),e(x,{label:"%ITB",modelValue:l(t).aliq_itbi,"onUpdate:modelValue":o[19]||(o[19]=s=>l(t).aliq_itbi=s)},null,8,["modelValue"])]),_:1}),e(n,{cols:"1"},{default:a(()=>[o[25]||(o[25]=m("label",null,"Valor ITB",-1)),e(x,{label:"Valor ITB",modelValue:l(t).vlr_itbi,"onUpdate:modelValue":o[20]||(o[20]=s=>l(t).vlr_itbi=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{class:"mt-10"},{default:a(()=>[e(L,{onClick:oe},{default:a(()=>[e(W,{size:"large",color:"red"},{default:a(()=>o[26]||(o[26]=[D("Voltar")])),_:1})]),_:1}),e(W,{class:"ml-5",size:"large",color:"green",onClick:ee},{default:a(()=>o[27]||(o[27]=[D("Salvar")])),_:1})]),_:1})]),_:1}))}}},Fe=["onClick"],Le=["onClick"],je=["onClick"],He={key:0,style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar",title:"Reativar"},Ye={key:1,src:Oe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},We={__name:"Partes",emits:["saved","close-modal"],async setup(G,{emit:A}){let f,v;const b=A,k=ce(),V=Ve();_e();const y=`${V.public.managemant}/pesquisarPessoas`,S=`${V.public.managemant}/listarPapeis`,q=`${V.public.managemant}/getLinkTipo`;`${V.public.managemant}`;const p=`${V.public.managemant}/updateAtosPessoa`,O=`${V.public.managemant}/getAtosPessoaById`,N=`${V.public.managemant}/download`,$=r(ae("user-data").value.cartorio_token),B=r([]),Q=r([]),X=r([]),z=r(!1),w=r(!1),M=r(!1),R=r(null),E=r(null),F=r("xkyaA"),t=r(null),h=[{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"%",align:"start"},{value:"actions"}],c=fe({papeis:null,nome:null,pessoa:null,documento:null}),{data:ee}=([f,v]=ve(()=>I(S,{method:"POST",body:{tipo_ato_token:k.query.tipo_ato_token}},"$X6FDd5A6WK")),f=await f,v(),f);X.value=ee.value;const J=async()=>{const{data:u}=await I(`${O}/${k.query.ato_id}`,{method:"GET"},"$Dyv7lSgcqT"),j=(H=>H.map(P=>({...P,pessoa:{...P.pessoa,documento:P.pessoa.doc_identificacao},papel:{...P.partes_tipos}})))(u.value);Q.value=j};J();async function le(){try{const{data:u,error:i}=await I(y,{method:"POST",body:{cartorio_token:$.value,documento:c.documento,nome:c.nome}},"$Ir36YwSBFY");u.value.length>0?(B.value=u.value,c.pessoa=B.value[0]):B.value=[]}catch(u){console.error("Erro na requisição",u)}}const oe=()=>{z.value=!0},T=async()=>{await J()},o=async()=>{b("saved")},x=async u=>{var K;if(w.value=!0,t.value=null,!u.pessoa.id)return;const{data:i}=await I(q,{method:"POST",body:{tipo:"ficha",id:u.pessoa.id}},"$z4QOGPyvCc");if(!((K=i.value)!=null&&K.link))return;const{data:j}=await I(N,{method:"POST",body:{bucket:"qvgjz",path:i.value.link}},"$XYnqHmowsR"),H=i.value.link,P=j.value;/\.(tr7|tiff)$/i.test(H)?t.value=P:fotoRender.value=`data:image/jpeg;base64,${P}`},L=u=>{M.value=!0,E.value=u.id,R.value=u.pessoa.nome};async function s(u){u.excluido=!u.excluido;try{await I(`${p}/${u.id}`,{method:"PUT",body:JSON.stringify({excluido:u.excluido})},"$63DgHOk5hC")}catch(i){console.error("Erro ao excluir pessoa:",i)}}const ye=()=>{b("close-modal")};return(u,i)=>{const j=Se,H=Me,P=qe,K=pe;return U(),Y(se,null,{default:a(()=>[e(g,null,{default:a(()=>[e(n,{cols:"3"},{default:a(()=>[e(_,{label:"Documento",modelValue:l(c).documento,"onUpdate:modelValue":i[0]||(i[0]=d=>l(c).documento=d)},null,8,["modelValue"])]),_:1}),e(n,{cols:"4"},{default:a(()=>[e(_,{label:"Pessoa",modelValue:l(c).nome,"onUpdate:modelValue":i[1]||(i[1]=d=>l(c).nome=d)},null,8,["modelValue"])]),_:1}),m("div",null,[m("img",{class:"mt-1",src:de,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:le})]),m("div",null,[m("img",{class:"mt-1 ml-2",src:me,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:oe})])]),_:1}),e(g,null,{default:a(()=>[e(n,{cols:"4"},{default:a(()=>[e(C,{label:"Selecione a Pessoa",modelValue:l(c).pessoa,"onUpdate:modelValue":i[2]||(i[2]=d=>l(c).pessoa=d),items:l(B),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(n,{cols:"3"},{default:a(()=>[e(C,{label:"Papel",modelValue:l(c).papeis,"onUpdate:modelValue":i[3]||(i[3]=d=>l(c).papeis=d),items:l(X),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(n,{cols:"1"},{default:a(()=>[e(_,{label:"%"})]),_:1}),m("div",null,[m("img",{class:"mt-1",src:me,style:{width:"40px",cursor:"pointer"},title:"Criar Imovel",onClick:o})])]),_:1}),e(g,null,{default:a(()=>[e(n,null,{default:a(()=>[e(Ne,{style:{height:"385px"},headers:h,items:l(Q)},{"item.actions":a(({item:d})=>[e(g,null,{default:a(()=>[m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ie=>x(d),title:"Visualizar Ficha"},i[8]||(i[8]=[m("img",{style:{width:"30px",height:"30px"},src:de,alt:"Visualizar"},null,-1)]),8,Fe),m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ie=>L(d),class:"mr-2",title:"Alterar Papel"},i[9]||(i[9]=[m("img",{style:{width:"30px",height:"30px"},src:De,alt:"Visualizar"},null,-1)]),8,Le),m("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ie=>s(d),title:"Deletar Pessoa"},[d.excluido?(U(),te("img",He)):(U(),te("img",Ye))],8,je)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(j,{show:l(z),onClose:i[4]||(i[4]=d=>z.value=!1)},null,8,["show"]),e(H,{representante_nome:l(R),ato_token:l(F),ato_id:l(E),show:l(M),onClose:i[5]||(i[5]=d=>M.value=!1),onUpdatePapel:T},null,8,["representante_nome","ato_token","ato_id","show"]),e(ge,{modelValue:l(w),"onUpdate:modelValue":i[7]||(i[7]=d=>Z(w)?w.value=d:null),width:"600"},{default:a(()=>[e(be,{"max-width":"600",title:"Ficha"},{default:a(()=>[e(P,{"tiff-url":l(t)},null,8,["tiff-url"]),e(W,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:i[6]||(i[6]=d=>w.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(g,{class:"mt-5"},{default:a(()=>[e(K,{onClick:ye},{default:a(()=>[e(W,{size:"large",color:"red"},{default:a(()=>i[10]||(i[10]=[D("Voltar")])),_:1})]),_:1}),e(W,{class:"ml-5",size:"large",color:"green"},{default:a(()=>i[11]||(i[11]=[D("Salvar")])),_:1})]),_:1})]),_:1})}}},ul={__name:"Cadastro",props:{show:Boolean},emits:["close"],setup(G,{emit:A}){const f=G,v=r("dados"),b=r(f.show),k=r(!1),V=A;Te(()=>f.show,q=>{b.value=q});const y=()=>{k.value=!0},S=()=>{b.value=!1,V("close")};return(q,p)=>{const O=Ee,N=We;return U(),Y(ge,{persistent:"",modelValue:l(b),"onUpdate:modelValue":p[2]||(p[2]=$=>Z(b)?b.value=$:null),"max-width":"1000"},{default:a(()=>[e(be,null,{default:a(()=>[e(se,null,{default:a(()=>[p[5]||(p[5]=m("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Cadastro de imoveis ",-1)),e(Be,{modelValue:l(v),"onUpdate:modelValue":p[0]||(p[0]=$=>Z(v)?v.value=$:null),"bg-color":"#f5f2f2"},{default:a(()=>[e(re,{value:"dados"},{default:a(()=>p[3]||(p[3]=[D("Dados")])),_:1}),l(k)?(U(),Y(re,{key:0,value:"partes"},{default:a(()=>p[4]||(p[4]=[D("Partes")])),_:1})):ne("",!0)]),_:1},8,["modelValue"]),e(ze,{modelValue:l(v),"onUpdate:modelValue":p[1]||(p[1]=$=>Z(v)?v.value=$:null)},{default:a(()=>[e(ue,{value:"dados"},{default:a(()=>[e(O,{onSaved:y,onCloseModal:S})]),_:1}),e(ue,{value:"partes"},{default:a(()=>[l(k)?(U(),Y(N,{key:0,onCloseModal:S})):ne("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{ul as _};
