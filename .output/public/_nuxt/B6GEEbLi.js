import{_ as ee}from"./DQWqkHxV.js";import{_ as te,a as oe}from"./B2iN3YUs.js";import{_ as ae}from"./-3tgkx60.js";import{_ as se,a as re,b as ne}from"./BP1uhy__.js";import{_ as ie}from"./C5rgAD2L.js";import{c as I,r as T,u as le}from"./C1HqGyMv.js";import{u as ue,H as de,C as pe,r as u,m as k,D as me,I as U,Q as ce,G as V,w as n,s as _e,o as p,b as r,a as i,t as fe,v as a,R as ve,V as b,y as ge,z as ke,c as B,A as xe,d as he}from"./DA0HTbiw.js";import{u as w}from"./CJnsM6n0.js";import{f as ye}from"./CkZRn5TZ.js";import{V as $e}from"./C8LpPkkA.js";import{V as x}from"./O28GMiy1.js";import{V as h}from"./CPn99ldi.js";import{V as Ve}from"./BvWWJTzj.js";import{V as be}from"./Dk-pQ6vG.js";import"./CXjrZ7cx.js";import"./xHkLInpz.js";import"./HYgR4ksd.js";import"./kLuAZoU9.js";import"./7PQ2EdSL.js";import"./CKSRJv49.js";const we={style:{color:"red","margin-left":"30px"}},Ce=["onClick"],Oe=["onClick","title"],Re=["disabled","onClick"],Ae={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:re,alt:"Visualizar",title:"Reativar"},Ee={key:1,src:ne,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},je={__name:"[id]",async setup(Ie){let l,m;const{$toast:C}=ue(),S=de(),{id:c}=S.params,O=pe(),_=_e(),z=`${_.public.managemant}/updateOrdensServico`,D=`${_.public.managemant}/getOrdensServicoById`,P=`${_.public.managemant}/listarAtos`,q=`${_.public.managemant}/updateAtos`,N=u(k("user-data").value.cartorio_id),F=u(k("user-data").value.usuario_id),M=u(k("user-service").value.token).value||null,G=u(k("user-data").value.cartorio_token).value,y=u([]),$=u(!1),R=u(null),f=u(null),s=me({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),L=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],H=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],K={apresentante_nome:{required:I.withMessage("O campo é obrigatorio",T)},apresentante_cpf:{required:I.withMessage("O campo é obrigatorio",T)}},d=le(K,s);function Q(o){if(o)return o.replace(/[.\-]/g,"");o=null}const W=o=>{R.value=o,$.value=!0},X=o=>{(o.usa_imoveis||!o.usa_imoveis)&&O.push({path:`/fontes/atos/atos-com-bem/atualizar/${o.id}`,query:{origem:"atualizar",id:c,ato_id:o.id,tipo_ato_token:o.tipo_token,tipo_ato:o.tipo,ato_token_edit:o.token,numero_os:f.value,usa_imoveis:o.usa_imoveis}})};async function Y(){const o={apresentante_cpf:Q(s.apresentante_cpf),apresentante_nome:s.apresentante_nome,user_id:F.value,cartorio_id:N.value},{error:t,status:g}=await w(`${z}/${c}`,{method:"PUT",body:o},"$Fud06ay483");g.value==="error"&&t.value.statusCode===500?C.error("Erro ao cadastrar ordem,erro no sistema."):(C.success("Ordem Atualizada com sucesso!"),O.push({path:"/os/lista"}))}const{data:v}=([l,m]=U(()=>w(`${D}/${c}`,{method:"GET"},"$wPUkUpDvPf")),l=await l,m(),l);f.value=v.value.numero,s.nacionalidade=v.value.estrangeiro,s.apresentante_cpf=v.value.apresentante_cpf,s.apresentante_nome=v.value.apresentante_nome;const{data:A}=([l,m]=U(()=>w(P,{method:"POST",body:{cartorio_token:G,ordemserv_token:M}},"$YXZ55K3IUf")),l=await l,m(),l);async function Z(o){o.excluido=!o.excluido;try{await ye(`${q}/${o.id}`,{method:"PUT",body:{excluido:o.excluido}})}catch(t){console.error("Erro ao excluir pessoa:",t)}}return A.value.length>0?y.value=A.value:y.value=[],(o,t)=>{const g=ee,j=oe,J=ce("mask");return p(),V($e,{class:"mt-5"},{default:n(()=>[r(x,{class:"mb-5"},{default:n(()=>[t[6]||(t[6]=i("h1",null,"Ordem de Serviço nº",-1)),i("h1",we,fe(a(f)),1)]),_:1}),r(x,null,{default:n(()=>[r(h,{md:"3"},{default:n(()=>[r(Ve,{label:"Nacionalidade",items:H,modelValue:a(s).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>a(s).nacionalidade=e)},null,8,["modelValue"])]),_:1}),r(h,{md:"2"},{default:n(()=>[a(s).nacionalidade==="brasileiro"?ve((p(),V(b,{key:0,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>a(s).apresentante_cpf=e),label:"CPF",required:"","error-messages":a(d).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(d).apresentante_cpf.$touch,onInput:a(d).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[J,"###.###.###-##"]]):(p(),V(b,{key:1,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>a(s).apresentante_cpf=e),label:"Documento",required:"","error-messages":a(d).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(d).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),r(h,{md:"4"},{default:n(()=>[r(b,{modelValue:a(s).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>a(s).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":a(d).apresentante_nome.$errors.map(e=>e.$message),onInput:a(d).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),r(h,null,{default:n(()=>[i("div",null,[i("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:ae,alt:"Salvar",onClick:t[4]||(t[4]=e=>Y())})])]),_:1})]),_:1}),r(x,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:n(()=>[t[9]||(t[9]=i("h1",{class:"ml-5"},"Atos",-1)),r(g,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:a(c),numeroOs:a(f)}}},{default:n(()=>t[7]||(t[7]=[i("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:se,alt:"novo"},null,-1)])),_:1},8,["to"]),r(be,{headers:L,items:a(y),"item-key":"id"},{"item.actions":n(({item:e})=>[r(x,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:n(()=>[i("div",{onClick:E=>W(e.token),title:"Reimprimir"},t[8]||(t[8]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:te,alt:"Reimprimir"},null,-1)]),8,Ce),i("div",{class:ke({disabled:!e.btn_editar}),onClick:E=>e.btn_editar?X({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,usa_imoveis:e.usa_imoveis}):null,title:e.btn_editar?"Editar":"Desabilitado"},[i("img",{style:ge({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ie,alt:"Editar"},null,4)],10,Oe),i("div",{disabled:!e.btn_cancelar,onClick:E=>e.btn_cancelar?Z(e):null,title:"Excluir"},[e.excluido?(p(),B("img",Ae)):(p(),B("img",Ee))],8,Re)]),_:2},1024)]),_:1},8,["items"]),r(j,{show:a($),ato_token:a(R),onClose:t[5]||(t[5]=e=>$.value=!1)},null,8,["show","ato_token"])]),_:1}),r(g,{to:"/os/lista"},{default:n(()=>[r(xe,{size:"large",color:"red"},{default:n(()=>t[10]||(t[10]=[he("Voltar")])),_:1})]),_:1})]),_:1})}}};export{je as default};
