import{_ as bo}from"./DmMATcTW.js";import{_ as ko,a as go}from"./BwFM56kB.js";import{_ as $o}from"./DT0AfsH9.js";import{_ as ho}from"./ChuxEUSe.js";import{c as wo,r as Ao,u as Co}from"./BWb6nRwC.js";import{r as u,u as X,e as O,f as oo,g as So,o as j,h as ao,w as r,b as l,a as s,d as B,t as xo,i as t,V as K,j as Do,k as eo,_ as Oo,l as Uo,n as To,m as Eo,c as No,p as Po,F as Mo,q as D,s as m,v as A,x as qo}from"./BGGLO0M3.js";import{u as $}from"./BFZfoIu9.js";import{V as Q,a as zo}from"./D_65gRCL.js";import{V as H}from"./iXIaxdJO.js";import{V as q}from"./7nMRhwxd.js";import{V as Io}from"./CHPjlEoq.js";import{V as Ro}from"./DAVkvYly.js";import{_ as W}from"./BBXf5euQ.js";import{_ as Fo}from"./Ckaum8Ce.js";import{_ as Bo}from"./CsPk-EU2.js";import{_ as Lo}from"./Bi1p7wXK.js";import{u as jo}from"./BFSANp4U.js";import{f as M}from"./B0IxRygJ.js";import{V as Ho}from"./CBWE0DUh.js";import{V as c}from"./MWYtpHIH.js";import{V as L}from"./CCy5QtVI.js";import"./CnM_Lmqw.js";import"./BVz1G1IN.js";import"./DJvq3mCv.js";import"./C_bXnsni.js";import"./DJtxDwJg.js";import"./DHSUtBpD.js";import"./DTi9JsB7.js";import"./DkKi6Bme.js";import"./B6voK-dq.js";import"./DX8m7vY_.js";import"./CqOcBIVA.js";const Jo={class:"mb-5",style:{display:"flex","justify-content":"flex-start"}},Go={class:"ml-6"},Yo={class:"ml-6"},Zo="O cancelamento de atos é definitivo e não pode ser revertido. Informe o motivo do cancelamento para confirmar",Ko={__name:"CancelamentoAto",props:{show:Boolean,ato_token:String},emits:["close"],setup(J,{emit:f}){const y=J,k=u(y.show),z=eo(),{$toast:h}=X(),I=u(O("auth_token").value),U=`${z.public.managemant}/cancela_lavratura`,p=oo({motivo:null}),C=f,S={motivo:{required:wo.withMessage("O campo é obrigatorio",Ao)}},V=Co(S,p);So(()=>y.show,b=>{k.value=b});const g=()=>{k.value=!1,C("close")},T=async()=>{var b,d;if(await V.value.$validate())try{const{data:i,status:E}=await $(U,{method:"POST",body:{ato_token:y.ato_token,user_token:I.value,cancelar_selo:!1,motivo_cancelamento:p.motivo}},"$VPLGcUZMk8");E.value==="success"&&Array.isArray(i.value)&&((b=i.value[0])==null?void 0:b.status)==="OK"?(h.success("Ato cancelado com sucesso!"),g()):Array.isArray(i.value)&&((d=i.value[0])==null?void 0:d.status)==="ERRO"?h.error(i.value[0].status_mensagem||"Erro ao cancelar ato"):h.error("Erro inesperado ao cancelar ato")}catch(i){console.error("Erro ao cancelar ato:",i),h.error("Erro ao cancelar ato")}};return(b,d)=>(j(),ao(Ro,{persistent:"",modelValue:t(k),"onUpdate:modelValue":d[1]||(d[1]=i=>Do(k)?k.value=i:null),"max-width":"650"},{default:r(()=>[l(Q,null,{default:r(()=>[l(H,null,{default:r(()=>[l(q,{class:"mb-5 mt-1 ml-2"},{default:r(()=>d[2]||(d[2]=[s("h1",null,"Cancelamento de Ato",-1),s("h1",{style:{color:"red","margin-left":"18px"}},null,-1)])),_:1}),l(H,null,{default:r(()=>[l(Q,{variant:"outlined",class:"mb-5"},{default:r(()=>[l(zo,null,{default:r(()=>[B(xo(Zo))]),_:1})]),_:1}),l(Io,{label:"Motivo",modelValue:t(p).motivo,"onUpdate:modelValue":d[0]||(d[0]=i=>t(p).motivo=i),required:"","error-messages":t(V).motivo.$errors.map(i=>i.$message),onBlur:t(V).motivo.$touch,onInput:t(V).motivo.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),s("div",Jo,[s("div",Go,[l(K,{size:"large",color:"red",onClick:g},{default:r(()=>d[3]||(d[3]=[B("Fechar")])),_:1})]),s("div",Yo,[l(K,{size:"large",color:"green",disabled:!t(p).motivo||t(p).motivo.trim()==="",onClick:T},{default:r(()=>d[4]||(d[4]=[B(" Salvar ")])),_:1},8,["disabled"])])])]),_:1})]),_:1},8,["modelValue"]))}},Qo={style:{width:"1300px",margin:"0 auto"}},Wo={style:{display:"flex",gap:"4px","justify-content":"center"}},Xo=["onClick","title"],oa=["onClick","title"],aa=["onClick","title"],ea=["onClick"],ta=["title"],la=["onClick"],na=["title"],ra={__name:"index",setup(J){const f=eo(),{$toast:y}=X(),k=`${f.public.managemant}/listarUsuarios`,z=`${f.public.managemant}/listar_tipo_atos`,h=`${f.public.biometria}/run-scanner?format=pdf`,I=`${f.public.envioDoc}/upload`;`${f.public.managemant}`;const U=`${f.public.managemant}/pesquisaAtos`,{redirectTo:p}=jo(),C=u(O("auth_token").value)||null,S=u(O("user-data").value.cartorio_token)||null,V=u(!1),g=u([]),T=u([]),b=u([]),d=u(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),i=u(!1),E=u(!1),R=u(!1),G=u(null),to=u({}),F=u(!1),N=u(null),n=oo({numero:null,data_inicio:Y(),data_fim:Y(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:C.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),lo=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:e=>e.protocolo?`${e.id}
${e.protocolo}`:`${e.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:e=>e.dt_abertura?`${e.dt_abertura}
${e.apresentante_cpf}`:`${e.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:e=>e.dt_lavratura?`${e.dt_lavratura}
${e.apresentante_nome}`:`${e.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:e=>e.situacao?`${e.situacao}
${e.ato_servico}`:`${e.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function Y(){const e=new Date,o=e.getFullYear(),_=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${_}-${o}`}function w(e){if(!e)return null;const[o,_,v]=e.split("/");return`${v}-${_}-${o}`}async function Z(){const e=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(e),{data:_}=await $(U,{method:"POST",body:{cartorio_token:O("user-data").value.cartorio_token,usuario_token:o.usuario_token||C.value,data_fim:w(o==null?void 0:o.data_fim),data_inicio:w(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");_.value.length>0&&(g.value=_.value.map(v=>({...v,dt_lavratura:v.dt_lavratura?M(v.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:M(v.dt_abertura,"dd/mm/yyyy")})))}async function no(){const{data:e}=await $(k,{method:"POST",body:{cartorio_token:S.value}},"$hvipqUJYtS");T.value=e.value}async function ro(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(n));const{data:e}=await $(U,{method:"POST",body:{cartorio_token:S.value,numero_os:n.numero||null,data_inicio:w(n.data_inicio)||null,data_fim:w(n.data_fim)||null,data_lavratura_inicio:w(n.data_lavratura_inicio)||null,data_lavratura_fim:w(n.data_lavratura_fim)||null,protocolo:n.protocolo||null,livro:n.livro||null,folha:n.folha||null,situacao:n.situacao||null,usuario_token:n.usuario_token,selo:n.selo||null,ato_tipo_token:n.ato_tipo_token,parte:n.parte||null}},"$OjamgBH6nj");e.value.length>0?g.value=e.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?M(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?M(o.dt_abertura,"dd/mm/yyyy"):null})):(g.value=[],y.error("Não existe ato Registrado!"))}catch(e){console.error("Erro na requisição",e)}}const so=e=>{p({item:e,id:e.id,numeroOs:e.numero_os,origem:"vizualizar-lista"})};async function io(){const{data:e,error:o}=await $(z,{method:"POST",body:{cartorio_token:S.value,usuario_token:C.value,tipo_retorno:"servico_ato"}},"$QxIfw0Zxe4");b.value=e.value}const uo=e=>{N.value=e,F.value=!0};function co(e){G.value=e.numero,N.value=e.token,R.value=!0}const mo=e=>{p({item:e,id:e.id,numeroOs:e.numero_os,origem:"atualizar-lista"})},po=async e=>{try{await vo(),await _o(e)}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}};async function _o(e){try{const{status:o,data:_}=await $(I,{method:"POST",body:{tipo:"ato_livro",token:e,cartorio_token:O("user-data").value.cartorio_token}},"$ceiptlfDNO");o.value==="success"&&y.success("Arquivo enviado com sucesso!")}catch(o){y.error(o),console.error("Erro ao enviar o arquivo:",o)}}async function vo(){try{const{data:e}=await $(h,{method:"GET"},"$zTNfED00Fu")}catch(e){y.error("Erro ao acionar o scanner:",e)}}return Uo(()=>{To(async()=>{const e=sessionStorage.getItem("pesquisaAto");if(e){const o=JSON.parse(e);Object.assign(n,o)}await Z()})}),no(),io(),(e,o)=>{const _=bo,v=ko,fo=$o,yo=ho,Vo=Ko,x=Eo("mask");return j(),No(Mo,null,[l(H,{class:"mt-5"},{default:r(()=>[l(q,{class:"mb-5"},{default:r(()=>o[20]||(o[20]=[s("h1",null,"Atos",-1)])),_:1}),l(q,null,{default:r(()=>[l(c,{cols:"2"},{default:r(()=>[D(l(m,{modelValue:t(n).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=a=>t(n).data_inicio=a),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(c,{cols:"2"},{default:r(()=>[D(l(m,{modelValue:t(n).data_fim,"onUpdate:modelValue":o[1]||(o[1]=a=>t(n).data_fim=a),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(c,{cols:"2"},{default:r(()=>[D(l(m,{modelValue:t(n).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=a=>t(n).data_lavratura_inicio=a),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(c,{cols:"2"},{default:r(()=>[D(l(m,{modelValue:t(n).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=a=>t(n).data_lavratura_fim=a),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(c,{cols:"2"},{default:r(()=>[l(m,{modelValue:t(n).numero,"onUpdate:modelValue":o[4]||(o[4]=a=>t(n).numero=a),label:"N° OS"},null,8,["modelValue"])]),_:1}),l(c,{cols:"2"},{default:r(()=>[l(m,{modelValue:t(n).selo,"onUpdate:modelValue":o[5]||(o[5]=a=>t(n).selo=a),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),l(q,null,{default:r(()=>[l(c,{cols:"2"},{default:r(()=>[l(m,{modelValue:t(n).protocolo,"onUpdate:modelValue":o[6]||(o[6]=a=>t(n).protocolo=a),label:"Protocolo"},null,8,["modelValue"])]),_:1}),l(c,{cols:"2"},{default:r(()=>[D(l(m,{modelValue:t(n).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=a=>t(n).apresentante_cpf=a),label:"CPF",dense:""},null,8,["modelValue"]),[[x,"###.###.###-##"]])]),_:1}),l(c,{cols:"3"},{default:r(()=>[l(m,{modelValue:t(n).parte,"onUpdate:modelValue":o[8]||(o[8]=a=>t(n).parte=a),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),l(c,{cols:"3"},{default:r(()=>[l(L,{modelValue:t(n).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=a=>t(n).ato_tipo_token=a),items:t(b),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),l(c,{cols:"2"},{default:r(()=>[l(L,{items:t(T),modelValue:t(n).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=a=>t(n).usuario_token=a),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),l(c,{cols:"3"},{default:r(()=>[l(L,{modelValue:t(n).situacao,"onUpdate:modelValue":o[11]||(o[11]=a=>t(n).situacao=a),items:t(d),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),l(c,{cols:"1"},{default:r(()=>[l(m,{modelValue:t(n).livro,"onUpdate:modelValue":o[12]||(o[12]=a=>t(n).livro=a),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),l(c,{cols:"1"},{default:r(()=>[l(m,{modelValue:t(n).folha,"onUpdate:modelValue":o[13]||(o[13]=a=>t(n).folha=a),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),l(c,null,{default:r(()=>[s("div",null,[s("img",{onClick:ro,style:{width:"40px",height:"40px",cursor:"pointer"},src:W,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),s("div",Qo,[o[21]||(o[21]=s("hr",{class:"mt-5 mb-5"},null,-1)),l(Ho,{headers:lo,items:t(g),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":r(({item:a})=>[s("div",Wo,[s("div",{onClick:P=>so({id:a.id,tipo:`${a.tipo_servico} - ${a.tipo_ato}`,token:a.token,tipo_token:a.tipo_token,rota:a.rota,numero_os:a.numero_os}),title:a.btn_visualizar?"Visualizar":"Desabilitado"},[s("img",{style:A({width:"30px",height:"30px",cursor:a.btn_visualizar?"pointer":"not-allowed",opacity:a.btn_visualizar?"1":"0.5"}),src:W,alt:"Visualizar"},null,4)],8,Xo),s("div",{onClick:P=>uo(a.token),title:a.btn_selos?"Reimprimir Selos":"Não permitido"},[s("img",{style:A({width:"30px",height:"30px",cursor:a.btn_selos?"pointer":"not-allowed",opacity:a.btn_selos?"1":"0.5"}),src:go,alt:"Reimprimir"},null,4)],8,oa),s("div",{class:qo({disabled:!a.btn_editar}),onClick:P=>a.btn_editar?mo({id:a.id,tipo:`${a.tipo_servico} - ${a.tipo_ato}`,token:a.token,tipo_token:a.tipo_token,rota:a.rota,numero_os:a.numero_os}):null,title:a.btn_editar?"Editar":"Desabilitado"},[s("img",{style:A({cursor:a.btn_editar?"pointer":"default",width:"30px",height:"30px",opacity:a.btn_editar?"1":"0.5"}),src:Fo,alt:"Editar"},null,4)],10,aa),s("div",{onClick:P=>a.btn_cancelar?co(a):null,title:"Excluir",style:A({cursor:a.btn_cancelar?"pointer":"not-allowed"})},[s("img",{style:A({width:"30px",height:"30px",cursor:a.btn_cancelar?"pointer":"not-allowed",opacity:a.btn_cancelar?"1":"0.5"}),src:Bo,alt:"Cancelar",title:a.btn_cancelar?"Cancelar":"Não permitido"},null,12,ta)],12,ea),s("div",{onClick:P=>po(a.token)},[s("img",{style:A({width:"30px",height:"30px",cursor:a.btn_escanear?"pointer":"not-allowed",opacity:a.btn_escanear?"1":"0.5"}),src:Lo,alt:"escanear",title:a.btn_escanear?"Escanear":"Não permitido"},null,12,na)],8,la)])]),_:1},8,["items"])]),t(V)?(j(),ao(_,{key:0,show:t(V),servicos:e.dadosData.servicos||[],tiposAtos:e.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=a=>V.value=!1),onUpdateAto:e.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):Po("",!0),l(v,{show:t(F),ato_token:t(N),onClose:o[15]||(o[15]=a=>F.value=!1)},null,8,["show","ato_token"]),l(fo,{show:t(i),numero_os:t(G),ordem:t(to),onClose:o[16]||(o[16]=a=>i.value=!1),onRefreshValue:o[17]||(o[17]=a=>Z())},null,8,["show","numero_os","ordem"]),l(yo,{show:t(E),condMessage:e.condMessage,onClose:o[18]||(o[18]=a=>E.value=!1),onConfirm:e.cancelaAto},null,8,["show","condMessage","onConfirm"]),l(Vo,{show:t(R),ato_token:t(N),onClose:o[19]||(o[19]=a=>R.value=!1)},null,8,["show","ato_token"])],64)}}},Ia=Oo(ra,[["__scopeId","data-v-7e9031ce"]]);export{Ia as default};
