import{_ as ee,a as ae,u as oe}from"./D1kopPWM.js";import{_ as te,C as se,u as le,r as u,z as ne,j as g,w as s,l as re,o as V,b as o,a as A,V as O,i as l,A as w,v as m,P as ie,d,L as x,k as _,t as ue,e as D}from"./DqnRh1oO.js";import{f as M}from"./G6ymh92I.js";import{u as I}from"./GyNZPv28.js";import{V as de}from"./B6RA0__n.js";import{V as ce}from"./CfWkpjh7.js";import{V as L}from"./BTDPZ89z.js";import{V as j}from"./CphoyLwf.js";import{V as E,a as me,b as pe,c as fe}from"./DqGAYxJy.js";import{V as ve}from"./CFixPO6I.js";import"./eJwQp9Js.js";import"./Ccg8KtvY.js";const ge={__name:"index",setup(Ve){const T=se(),{$toast:k}=le(),p=u({senha:"",email:""}),h=u(!1),c=u(!1),N=u(!1),P=u(!1),U=u(!1),y=u(!1),f=u(!1),C=u(""),S=()=>{N.value=!1,P.value=!1,y.value=!1,U.value=!1,c.value=!1},R=re(),z=`${R.public.auth}/service/gerencia/listarMenu`,F=R.public.auth,B=R.public.managemant,v=u(!1),$=u(""),J=async()=>{const{data:t,status:e,error:n}=await M(`${F}/login`,{method:"POST",body:{senha:p.value.senha,email:p.value.email}});return{data:t==null?void 0:t.value,status:e==null?void 0:e.value,error:n==null?void 0:n.value}},W=t=>{const e=D("user-data");e.value=JSON.stringify({nome:t.nome,usuario_id:t.id,cartorio_id:t.cartorios[0].cartorio_id,cartorio_nome:t.cartorios[0].cartorio_descricao,cartorio_token:t.cartorios[0].cartorio_token});const n=D("auth_token");n.value=t.token},q=t=>{var a,r,i;const e=(i=(r=(a=t==null?void 0:t.data)==null?void 0:a[0])==null?void 0:r.func_autentica_acesso_v1)==null?void 0:i[0],n=e==null?void 0:e.status_mensagem;if(!e){y.value=!0;return}switch(n){case"Esse email não está cadastrado no Durabil.":P.value=!0;break;case"Senha inválida.":N.value=!0;break;case"Seu cadastro está desativado. Entre em contato com o administrador da conta.":U.value=!0;break;default:y.value=!0;break}},H=async()=>{var a,r,i,K;const{data:t,status:e,error:n}=await J();if(e==="success"){const b=(K=(i=(r=(a=t==null?void 0:t[0])==null?void 0:a.func_autentica_acesso_v1)==null?void 0:r[0])==null?void 0:i.registro)==null?void 0:K[0];if(oe().cartorioInfos=b,W(b),b.cartorios.length>1){T.push({path:"/login/tipo-perfil"});return}k.success("Login realizado com sucesso!");const{data:G,status:Q}=await M(z,{method:"POST",body:{usuario_id:b.id,perfil_descricao:b.cartorios[0].perfil_descricao}});if(Q.value==="success"){const Y=D("menu-navbar");Y.value=G.value,T.push({path:"/"})}}else e==="error"&&(n==null?void 0:n.statusCode)===500?y.value=!0:q(n)},X=async()=>{var a,r,i;const{data:t,status:e,error:n}=await I(`${B}/recupera_senha`,{method:"POST",body:{email:C.value,acao:"gerar"}},"$iX10IJN3fa");e.value==="success"?(k.success(t.value.message||"Código enviado"),v.value=!0):k.error(((i=(r=(a=n.value)==null?void 0:a.data)==null?void 0:r.menssage)==null?void 0:i.details)||"Erro desconhecido")},Z=async()=>{var a,r,i;const{data:t,status:e,error:n}=await I(`${B}/verifica_codigo_recuperacao`,{method:"POST",body:{email:C.value,code:$.value}},"$ZtHWy4R1Ea");e.value==="success"?(k.success(t.value.message||"Código verificado com sucesso"),f.value=!1,T.push("/recupera_senha")):k.error(((i=(r=(a=n.value)==null?void 0:a.data)==null?void 0:r.menssage)==null?void 0:i.details)||"Código inválido")};return(t,e)=>{const n=ne("center");return V(),g(de,{style:{"background-color":"#0a063b"}},{default:s(()=>[o(ve,{cols:"5",class:"d-flex align-center justify-center"},{default:s(()=>[o(ce,{style:{"max-width":"650px"}},{default:s(()=>[o(n,null,{default:s(()=>[o(L,{style:{"margin-bottom":"30px"},width:400,height:330,src:ee})]),_:1}),e[16]||(e[16]=A("div",{class:"text"},"Login",-1)),o(O,{autofocus:"",autocomplete:"email",type:"email",modelValue:l(p).email,"onUpdate:modelValue":e[0]||(e[0]=a=>l(p).email=a),"persistent-hint":"",class:"input mb-5",style:{"background-color":"aliceblue"},"hide-details":"",density:"compact",placeholder:"Email","prepend-inner-icon":"mdi-email-outline",variant:"outlined"},null,8,["modelValue"]),o(O,{modelValue:l(p).senha,"onUpdate:modelValue":e[1]||(e[1]=a=>l(p).senha=a),class:"input","append-inner-icon":l(h)?"mdi-eye-off":"mdi-eye",type:l(h)?"text":"password",density:"compact",style:{"background-color":"aliceblue"},"hide-details":"",placeholder:"Senha","prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":e[2]||(e[2]=a=>h.value=!l(h))},null,8,["modelValue","append-inner-icon","type"]),o(j,{modelValue:l(c),"onUpdate:modelValue":e[4]||(e[4]=a=>w(c)?c.value=a:null),"max-width":"400",persistent:""},{activator:s(({props:a})=>[o(m,ie({rounded:"",class:"mb-10 mt-4 ml-1"},a,{color:"primary",onClick:H,modelValue:l(c),"onUpdate:modelValue":e[3]||(e[3]=r=>w(c)?c.value=r:null),block:""}),{default:s(()=>e[11]||(e[11]=[d(" Acessar ")])),_:2},1040,["modelValue"])]),default:s(()=>[l(N)?(V(),g(E,{key:0,text:"Senha inválida."},{actions:s(()=>[o(x),o(m,{onClick:S,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[12]||(e[12]=[d(" OK ")])),_:1})]),_:1})):_("",!0),l(P)?(V(),g(E,{key:1,text:"Esse email não está cadastrado."},{actions:s(()=>[o(x),o(m,{onClick:S,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[13]||(e[13]=[d(" OK ")])),_:1})]),_:1})):_("",!0),l(y)?(V(),g(E,{key:2,text:"Erro no sistema, fora do ar."},{actions:s(()=>[o(x),o(m,{onClick:S,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[14]||(e[14]=[d(" OK ")])),_:1})]),_:1})):_("",!0),l(U)?(V(),g(E,{key:3,text:"Seu cadastro está desativado. Entre em contato com o administrador da conta."},{actions:s(()=>[o(x),o(m,{onClick:S,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[15]||(e[15]=[d(" OK ")])),_:1})]),_:1})):_("",!0)]),_:1},8,["modelValue"]),A("div",null,[A("a",{class:"text-decoration-none",rel:"noopener noreferrer",style:{color:"white","margin-left":"10px"},onClick:e[5]||(e[5]=a=>f.value=!0)}," Esqueceu a senha? ")])]),_:1})]),_:1}),o(L,{src:ae,cover:""}),o(j,{modelValue:l(f),"onUpdate:modelValue":e[10]||(e[10]=a=>w(f)?f.value=a:null),"max-width":"500"},{default:s(()=>[o(E,null,{default:s(()=>[o(me,null,{default:s(()=>e[17]||(e[17]=[d("Recuperar senha")])),_:1}),o(pe,null,{default:s(()=>[e[18]||(e[18]=d(" ' ")),o(O,{modelValue:l(C),"onUpdate:modelValue":e[6]||(e[6]=a=>w(C)?C.value=a:null),readonly:l(v),type:"email",label:"Digite seu email","prepend-inner-icon":"mdi-email-outline"},null,8,["modelValue","readonly"]),l(v)?(V(),g(O,{key:0,modelValue:l($),"onUpdate:modelValue":e[7]||(e[7]=a=>w($)?$.value=a:null),label:"Código de verificação","prepend-inner-icon":"mdi-numeric"},null,8,["modelValue"])):_("",!0)]),_:1}),e[20]||(e[20]=d("' ")),o(fe,null,{default:s(()=>[o(x),o(m,{class:"bg-green text-white",onClick:e[8]||(e[8]=a=>l(v)?Z():X())},{default:s(()=>[d(ue(l(v)?"Confirmar":"Enviar"),1)]),_:1}),o(m,{class:"bg-red text-white",onClick:e[9]||(e[9]=a=>{f.value=!1,v.value=!1})},{default:s(()=>e[19]||(e[19]=[d(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Te=te(ge,[["__scopeId","data-v-c6edf430"]]);export{Te as default};
