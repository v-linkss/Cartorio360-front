import{_ as mo}from"./BrnkE6Qv.js";import{_ as _o,a as vo}from"./CB1ATgzw.js";import{_ as fo}from"./bt1PZV-9.js";import{_ as yo}from"./C7TQW4Id.js";import{_ as J}from"./DIAdC4EX.js";import{_ as ko}from"./ssBe4qYe.js";import{_ as Vo}from"./ClxBQSCG.js";import{_ as bo}from"./GtbSwuaU.js";import{_ as ho,a as $o}from"./DJvq3mCv.js";import{_ as go,u as xo,r as u,e as $,f as wo,g as Ao,n as So,h as Co,c as D,b as r,w as s,a as n,i as l,j as Do,k as Oo,F as Uo,l as To,o as g,m as V,V as c,p as Po,q as O}from"./CQuBOsNg.js";import{u as Eo}from"./BUxYSy8-.js";import{u as _}from"./BmoeFm2G.js";import{f as x}from"./B0IxRygJ.js";import{f as No}from"./DP0vfqlT.js";import{V as qo}from"./DUzjHVQl.js";import{V as Ro}from"./L4ABCn0h.js";import{V as U}from"./Chx0Tj9q.js";import{V as i}from"./Dyz-Ed-H.js";import{V as T}from"./XfnsRPsj.js";import"./CqREEPpR.js";import"./DdDSVdjN.js";import"./aXru670M.js";import"./7020qKcT.js";import"./BJVN5Rf1.js";import"./D_2vOfWt.js";import"./_G3p1sFa.js";import"./BVz1G1IN.js";import"./BBWz33tm.js";import"./Dc8aqalp.js";import"./D8Ey4nSy.js";const Mo={style:{width:"1300px",margin:"0 auto"}},Io={style:{display:"flex",gap:"4px","justify-content":"center"}},zo=["onClick"],Fo=["onClick"],Lo=["onClick","title"],Jo=["onClick"],jo=["title"],Bo=["onClick"],Ho=["onClick"],Xo={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:ho,alt:"Visualizar",title:"Reativar"},Yo={key:1,src:$o,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Wo={__name:"index",setup(Go){const m=To(),{$toast:f}=xo(),j=`${m.public.managemant}/listarUsuarios`,B=`${m.public.managemant}/listar_tipo_atos`,H=`${m.public.managemant}/cancela_lavratura`,X=`${m.public.biometria}/run-scanner?format=pdf`,Y=`${m.public.envioDoc}/upload`,W=`${m.public.managemant}/updateAtos`,P=`${m.public.managemant}/pesquisaAtos`,{redirectTo:E}=Eo(),b=u($("auth_token").value)||null,w=u($("user-data").value.cartorio_token)||null,A=u(!1),h=u([]),N=u([]),q=u([]),G=u(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),R=u(!1),S=u(!1),M=u(""),K=u(null),Q=u({}),C=u(!1),I=u(null),e=wo({numero:null,data_inicio:z(),data_fim:z(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:b.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),Z=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:a=>a.protocolo?`${a.id}
${a.protocolo}`:`${a.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:a=>a.dt_abertura?`${a.dt_abertura}
${a.apresentante_cpf}`:`${a.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:a=>a.dt_lavratura?`${a.dt_lavratura}
${a.apresentante_nome}`:`${a.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:a=>a.situacao?`${a.situacao}
${a.ato_servico}`:`${a.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function z(){const a=new Date,o=a.getFullYear(),d=String(a.getMonth()+1).padStart(2,"0");return`${String(a.getDate()).padStart(2,"0")}-${d}-${o}`}function v(a){if(!a)return null;const[o,d,p]=a.split("/");return`${p}-${d}-${o}`}async function F(){const a=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(a),{data:d}=await _(P,{method:"POST",body:{cartorio_token:$("user-data").value.cartorio_token,usuario_token:o.usuario_token||b.value,data_fim:v(o==null?void 0:o.data_fim),data_inicio:v(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");d.value.length>0&&(h.value=d.value.map(p=>({...p,dt_lavratura:p.dt_lavratura?x(p.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:x(p.dt_abertura,"dd/mm/yyyy")})))}async function oo(){const{data:a}=await _(j,{method:"POST",body:{cartorio_token:w.value}},"$hvipqUJYtS");N.value=a.value}async function ao(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(e));const{data:a}=await _(P,{method:"POST",body:{cartorio_token:w.value,numero:e.numero||null,data_inicio:v(e.data_inicio)||null,data_fim:v(e.data_fim)||null,data_lavratura_inicio:v(e.data_lavratura_inicio)||null,data_lavratura_fim:v(e.data_lavratura_fim)||null,protocolo:e.protocolo||null,livro:e.livro||null,folha:e.folha||null,situacao:e.situacao||null,usuario_token:e.usuario_token,selo:e.selo||null,ato_tipo_token:e.ato_tipo_token,parte:e.parte||null}},"$OjamgBH6nj");a.value.length>0?h.value=a.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?x(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?x(o.dt_abertura,"dd/mm/yyyy"):null})):(h.value=[],f.error("Não existe ato Registrado!"))}catch(a){console.error("Erro na requisição",a)}}const to=a=>{E({item:a,id:a.id,numeroOs:a.numero_os,origem:"vizualizar-lista"})};async function eo(){const{data:a,error:o}=await _(B,{method:"POST",body:{cartorio_token:w.value,usuario_token:b.value,tipo_retorno:"servico_ato"}},"$QxIfw0Zxe4");q.value=a.value}const lo=a=>{I.value=a,C.value=!0};async function ro(a){a.excluido=!a.excluido;try{await No(`${W}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}const L=async a=>{const{data:o,status:d}=await _(H,{method:"POST",body:{ato_token:a,user_token:b.value,cancelar_selo:!1}},"$ceiptlfDNO");d.value==="success"&&o.value[0].status==="OK"?f.success("Lavratura cancelada com sucesso!"):o.value[0].status==="ERRO"&&(S.value=!0,M.value=o.value[0].status_mensagem)},so=a=>{E({item:a,id:a.id,numeroOs:a.numero_os,origem:"atualizar-lista"})},no=async a=>{try{await uo(),await io(a)}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}};async function io(a){try{const{status:o,data:d}=await _(Y,{method:"POST",body:{tipo:"ato_livro",token:a,cartorio_token:$("user-data").value.cartorio_token}},"$zTNfED00Fu");o.value==="success"&&f.success("Arquivo enviado com sucesso!")}catch(o){f.error(o),console.error("Erro ao enviar o arquivo:",o)}}async function uo(){try{const{data:a}=await _(X,{method:"GET"},"$hJse5XXJsY")}catch(a){f.error("Erro ao acionar o scanner:",a)}}return Ao(()=>{So(async()=>{const a=sessionStorage.getItem("pesquisaAto");if(a){const o=JSON.parse(a);Object.assign(e,o)}await F()})}),oo(),eo(),(a,o)=>{const d=mo,p=_o,co=fo,po=yo,y=Co("mask");return g(),D(Uo,null,[r(qo,{class:"mt-5"},{default:s(()=>[r(U,{class:"mb-5"},{default:s(()=>o[19]||(o[19]=[n("h1",null,"Atos",-1)])),_:1}),r(U,null,{default:s(()=>[r(i,{cols:"2"},{default:s(()=>[V(r(c,{modelValue:l(e).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=t=>l(e).data_inicio=t),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),r(i,{cols:"2"},{default:s(()=>[V(r(c,{modelValue:l(e).data_fim,"onUpdate:modelValue":o[1]||(o[1]=t=>l(e).data_fim=t),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),r(i,{cols:"2"},{default:s(()=>[V(r(c,{modelValue:l(e).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=t=>l(e).data_lavratura_inicio=t),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),r(i,{cols:"2"},{default:s(()=>[V(r(c,{modelValue:l(e).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=t=>l(e).data_lavratura_fim=t),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),r(i,{cols:"2"},{default:s(()=>[r(c,{modelValue:l(e).numero,"onUpdate:modelValue":o[4]||(o[4]=t=>l(e).numero=t),label:"N° OS"},null,8,["modelValue"])]),_:1}),r(i,{cols:"2"},{default:s(()=>[r(c,{modelValue:l(e).selo,"onUpdate:modelValue":o[5]||(o[5]=t=>l(e).selo=t),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),r(U,null,{default:s(()=>[r(i,{cols:"2"},{default:s(()=>[r(c,{modelValue:l(e).protocolo,"onUpdate:modelValue":o[6]||(o[6]=t=>l(e).protocolo=t),label:"Protocolo"},null,8,["modelValue"])]),_:1}),r(i,{cols:"2"},{default:s(()=>[V(r(c,{modelValue:l(e).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=t=>l(e).apresentante_cpf=t),label:"CPF",dense:""},null,8,["modelValue"]),[[y,"###.###.###-##"]])]),_:1}),r(i,{cols:"3"},{default:s(()=>[r(c,{modelValue:l(e).parte,"onUpdate:modelValue":o[8]||(o[8]=t=>l(e).parte=t),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),r(i,{cols:"3"},{default:s(()=>[r(T,{modelValue:l(e).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=t=>l(e).ato_tipo_token=t),items:l(q),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),r(i,{cols:"2"},{default:s(()=>[r(T,{items:l(N),modelValue:l(e).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=t=>l(e).usuario_token=t),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),r(i,{cols:"3"},{default:s(()=>[r(T,{modelValue:l(e).situacao,"onUpdate:modelValue":o[11]||(o[11]=t=>l(e).situacao=t),items:l(G),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),r(i,{cols:"1"},{default:s(()=>[r(c,{modelValue:l(e).livro,"onUpdate:modelValue":o[12]||(o[12]=t=>l(e).livro=t),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),r(i,{cols:"1"},{default:s(()=>[r(c,{modelValue:l(e).folha,"onUpdate:modelValue":o[13]||(o[13]=t=>l(e).folha=t),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),r(i,null,{default:s(()=>[n("div",null,[n("img",{onClick:ao,style:{width:"40px",height:"40px",cursor:"pointer"},src:J,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),n("div",Mo,[o[23]||(o[23]=n("hr",{class:"mt-5 mb-5"},null,-1)),r(Ro,{headers:Z,items:l(h),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":s(({item:t})=>[n("div",Io,[n("div",{onClick:k=>to({id:t.id,tipo:`${t.tipo_servico} - ${t.tipo_ato}`,token:t.token,tipo_token:t.tipo_token,rota:t.rota,numero_os:t.numero_os}),title:"Visualizar"},o[20]||(o[20]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:J,alt:"Visualizar"},null,-1)]),8,zo),n("div",{onClick:k=>lo(t.token),title:"Reimprimir"},o[21]||(o[21]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:vo,alt:"Reimprimir"},null,-1)]),8,Fo),n("div",{class:Po({disabled:!t.btn_editar}),onClick:k=>t.btn_editar?so({id:t.id,tipo:`${t.tipo_servico} - ${t.tipo_ato}`,token:t.token,tipo_token:t.tipo_token,rota:t.rota,numero_os:t.numero_os}):null,title:t.btn_editar?"Editar":"Desabilitado"},[n("img",{style:O({cursor:t.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ko,alt:"Editar"},null,4)],10,Lo),n("div",{onClick:k=>t.btn_cancelar?L(t.token):null,title:"Excluir",style:O({cursor:t.btn_cancelar?"pointer":"not-allowed"})},[n("img",{style:O({width:"30px",height:"30px",cursor:t.btn_cancelar?"pointer":"not-allowed",opacity:t.btn_cancelar?"1":"0.5"}),src:Vo,alt:"Cancelar",title:t.btn_cancelar?"Cancelar":"Não permitido"},null,12,jo)],12,Jo),n("div",{onClick:k=>no(t.token)},o[22]||(o[22]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:bo,alt:"escanear",title:"escanear"},null,-1)]),8,Bo),n("div",{onClick:k=>ro(t),title:"Excluir"},[t.excluido?(g(),D("img",Xo)):(g(),D("img",Yo))],8,Ho)])]),_:1},8,["items"])]),l(A)?(g(),Do(d,{key:0,show:l(A),servicos:a.dadosData.servicos||[],tiposAtos:a.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=t=>A.value=!1),onUpdateAto:a.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):Oo("",!0),r(p,{show:l(C),ato_token:l(I),onClose:o[15]||(o[15]=t=>C.value=!1)},null,8,["show","ato_token"]),r(co,{show:l(R),numero_os:l(K),ordem:l(Q),onClose:o[16]||(o[16]=t=>R.value=!1),onRefreshValue:o[17]||(o[17]=t=>F())},null,8,["show","numero_os","ordem"]),r(po,{show:l(S),condMessage:l(M),onClose:o[18]||(o[18]=t=>S.value=!1),onConfirm:L},null,8,["show","condMessage"])],64)}}},Sa=go(Wo,[["__scopeId","data-v-dd63aa21"]]);export{Sa as default};
