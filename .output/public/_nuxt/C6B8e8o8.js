import{r as m,u as A,H as N,g as O,n as P,o as j,p as E,w as l,b as a,a as v,U as H,d as J,s as o,B as g,q as L}from"./BOL4noSq.js";import{c as M,r as W,u as Y}from"./Bni1fX-8.js";import{u as w}from"./TzX8YZO0.js";import{V as z,c as F}from"./CPO4BRHb.js";import{V as G}from"./Cl_P9YfM.js";import{V as K}from"./bqpzMvxx.js";import{V as Q}from"./BRVU7TxM.js";import{V as X}from"./C5FAYfot.js";import{V as Z}from"./BTXPcqnv.js";const ee=""+new URL("selo.D9mIBRmY.png",import.meta.url).href,ce={__name:"Selos",props:{show:Boolean,ato_token:String},emits:["close"],async setup($,{emit:S}){let c,_;const d=$,n=m(d.show),f=L(),y=m(A("user-data").value.cartorio_token).value,h=`${f.public.managemant}/listarSelos`,C=`${f.public.managemant}/reimprimirSelo`,B=`${f.public.managemant}/listarEscrevente`,V=m([]),r=m([]),b=m([]),u=N({escrevente:null}),R=S,T={escrevente:{required:M.withMessage("O campo é obrigatorio",W)}},p=Y(T,u),I=[{title:"Numero",value:"numero"},{title:"Referencia",value:"referencia"},{value:"actions"}];O(()=>d.show,s=>{n.value=s,s&&D()});const k=()=>{n.value=!1,u.escrevente=null,r.value=null,R("close")},{data:x}=([c,_]=P(()=>w(B,{method:"POST",body:{cartorio_token:y}},"$V2ulT7DYvP")),c=await c,_(),c);b.value=x.value[0].func_json_escreventes;const q=async()=>{if(await p.value.$validate()){const s=r.value.map(i=>({selo_token:i})),e={escrevente_token:u.escrevente,ato_token:d.ato_token,selos:s},{data:t,error:te,status:U}=await w(`${C}`,{method:"POST",body:e},"$45J51uHTfa");if(U.value==="success"){const i=window.open("","_blank");i.document.open(),i.document.write(t.value[0].etiqueta),i.document.close(),k()}}},D=async()=>{const{data:s,error:e}=await w(`${h}`,{method:"POST",body:{ato_token:d.ato_token}},"$rLWIRtrfDz");s.value.selos===null?V.value=[]:V.value=s.value.selos};return(s,e)=>(j(),E(Z,{persistent:"",modelValue:o(n),"onUpdate:modelValue":e[2]||(e[2]=t=>g(n)?n.value=t:null),"max-width":"500"},{default:l(()=>[a(z,null,{default:l(()=>[a(G,null,{default:l(()=>[a(K,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:l(()=>[e[4]||(e[4]=v("h1",{class:"ml-4"},"Reimpressão de Selos",-1)),a(H,{class:"mt-4 mr-4",style:{color:"red"},onClick:k},{default:l(()=>e[3]||(e[3]=[J("mdi-close")])),_:1})]),_:1}),e[5]||(e[5]=v("hr",{class:"mb-5"},null,-1)),a(Q,{class:"mb-5",label:"Tabelião/escrivão",modelValue:o(u).escrevente,"onUpdate:modelValue":e[0]||(e[0]=t=>o(u).escrevente=t),items:o(b),"item-title":"nome","item-value":"token",required:"","error-messages":o(p).escrevente.$errors.map(t=>t.$message),onBlur:o(p).escrevente.$touch,onInput:o(p).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"]),a(X,{headers:I,items:o(V),"item-value":"token","show-select":"",modelValue:o(r),"onUpdate:modelValue":e[1]||(e[1]=t=>g(r)?r.value=t:null)},null,8,["items","modelValue"])]),_:1}),a(F,null,{default:l(()=>[v("div",null,[v("img",{src:ee,style:{cursor:"pointer"},onClick:q})])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{ee as _,ce as a};
