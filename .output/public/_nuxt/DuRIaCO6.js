import{_ as me}from"./Coc3-8tq.js";import{u as ne,m as le,M as ie,r as n,p as pe,o as p,y as U,w as t,b as a,x as e,V as re,G as ee,d as Z,z as N,A as ce,n as R,I as je,E as de,a as V,c as P,O as Ne,q as Ie,P as Je,F as Ce,g as Le,Q as we,t as fe}from"./CZ7-18UE.js";import{u as g}from"./43DIqOTu.js";import{V as F}from"./CTrdSjEh.js";import{V as j}from"./_ocnesnf.js";import{V as ve}from"./BefhvARx.js";import{V as _e}from"./CnjcOA3J.js";import{_ as Ue}from"./3AfeyhUv.js";import{_ as Be,a as Ye,b as We,T as Ze,W as Qe,S as Xe,D as $e,c as Ge,d as He,e as Ke,f as ea}from"./3tq3I5KB.js";import{_ as aa,r as ze}from"./BXJMSIuN.js";import{_ as he}from"./Vu017YYU.js";import{_ as ye}from"./BVz1G1IN.js";import{_ as ta}from"./D2dM333b.js";import{_ as oa}from"./DNuG4GZK.js";import{_ as ke,a as Ae}from"./DJvq3mCv.js";import{V as xe}from"./WQ6iG51X.js";import{_ as Ve}from"./C2lbDBHW.js";import{V as sa}from"./DioM5gZU.js";import{c as Ee,r as Se,u as Te}from"./BOxUVA13.js";import{f as be}from"./B0IxRygJ.js";const Qa={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(te){const v=te,{$toast:C}=ne(),A=ce(),u=le(),d=ie(),b=`${A.public.managemant}/updateAtos`,S=n(v.item_situacoes),Q=n(d.query.origem==="vizualizar"),T=pe({dt_abertura:v.item_dados[0].dt_abertura||null,status:v.item_dados[0].status||null,mne:v.item_dados[0].mne||null});async function X(){const{data:O,error:h,status:q}=await g(`${b}/${d.query.ato_id}`,{method:"PUT",body:{status:T.status,mne:T.mne,dt_abertura:T.dt_abertura}},"$EIT5jtTUdX");q.value==="success"&&C.success("Ato Atualizado com sucesso")}const D=()=>{const O=d.query.origem||"criar",h=d.query.id;switch(O){case"atualizar":case"vizualizar":u.push(`/os/atualizar/${h}`);break;case"atualizar-lista":case"vizualizar-lista":u.push("/atos/lista");break;default:u.push("/os/criar-registro");break}};return(O,h)=>{const q=me;return p(),U(_e,null,{default:t(()=>[a(F,{class:"mt-5"},{default:t(()=>[a(j,{cols:"3"},{default:t(()=>[a(ve,{label:"Situação",modelValue:e(T).status,"onUpdate:modelValue":h[0]||(h[0]=y=>e(T).status=y),items:e(S),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),a(F,null,{default:t(()=>[a(j,{cols:"5"},{default:t(()=>[a(re,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:e(T).mne,"onUpdate:modelValue":h[1]||(h[1]=y=>e(T).mne=y)},null,8,["modelValue"])]),_:1})]),_:1}),a(F,null,{default:t(()=>[a(j,{cols:"2"},{default:t(()=>[a(re,{modelValue:e(T).dt_abertura,"onUpdate:modelValue":h[2]||(h[2]=y=>e(T).dt_abertura=y),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),a(F,{class:"mb-3"},{default:t(()=>[a(q,{onClick:D},{default:t(()=>[a(ee,{size:"large",color:"red"},{default:t(()=>h[3]||(h[3]=[Z("Voltar")])),_:1})]),_:1}),e(Q)?N("",!0):(p(),U(ee,{key:0,class:"ml-10",onClick:X,size:"large",color:"green"},{default:t(()=>h[4]||(h[4]=[Z("Atualizar")])),_:1}))]),_:1})]),_:1})}}},ra={key:0},na=["onClick"],la={key:0,style:{width:"30px",height:"30px"},src:he,alt:"Visualizar"},ia={key:1,style:{width:"30px",height:"30px"},src:ta,alt:"Visualizar"},ca=["onClick"],ua=["onClick"],da={key:0,style:{width:"30px",height:"30px"},src:ke,alt:"Visualizar",title:"Reativar"},ma={key:1,src:Ae,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},pa=["onClick"],Xa={__name:"Partes",async setup(te){let v,C;const A=le(),u=ie(),d=ce(),{$toast:b}=ne(),S=`${d.public.managemant}/pesquisarPessoas`,Q=`${d.public.managemant}/listarPapeis`,T=`${d.public.managemant}/createAtosPessoa`,X=`${d.public.managemant}/updateAtosPessoa`,D=`${d.public.managemant}/getAtosPessoaById`,O=`${d.public.managemant}/download`,h=n(R("user-data").value.cartorio_token),q=n(u.query.origem==="vizualizar"),y=n([]),x=n({}),$=n([]),I=n([]),w=n(!1),Y=n(!1),B=n(!1),G=n(!1),H=n(null),k=n(null),E=n(null),W=n(null),s=n(null),i=n(u.query.tipo_ato_token),r=n(null),c=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],l=pe({papeis:null,nome:null,pessoa:null,documento:null});je(()=>{var f;return((f=l.pessoa)==null?void 0:f.link_ficha)||!1});const{data:z}=([v,C]=de(()=>g(Q,{method:"POST",body:{tipo_ato_token:u.query.tipo_ato_token}},"$acoiTIUp00")),v=await v,C(),v);I.value=z.value;const o=async()=>{const{data:f}=await g(`${D}/${u.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),K=(ue=>ue.map(ae=>({...ae,pessoa:{...ae.pessoa,documento:ae.pessoa.doc_identificacao},papel:{...ae.partes_tipos}})))(f.value);$.value=K};o();async function _(){try{const{data:f,error:m}=await g(S,{method:"POST",body:{cartorio_token:h.value,documento:l.documento,nome:l.nome}},"$pr30MyPXfY");f.value.length>0?(y.value=f.value,l.pessoa=y.value[0]):y.value=[]}catch(f){console.error("Erro na requisição",f)}}const J=()=>{Y.value=!0},L=async()=>{await o()},se=async()=>{await o()},De=async()=>{const f={pessoa:l.pessoa,papel:I.value.find(oe=>oe.id===l.papeis),representante:{nome:null}},m=await g(`${D}/${u.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const oe of m.data.value)if(oe.pessoa_id===l.pessoa.id&&oe.ato_id===Number(u.query.ato_id)&&oe.tipo_parte_id===l.papeis){b.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:K,error:ue,status:ae}=await g(T,{method:"POST",body:{ato_id:Number(u.query.ato_id),pessoa_id:l.pessoa.id,tipo_parte_id:l.papeis,user_id:R("user-data").value.usuario_id}},"$18isAgOJxG");ae.value==="success"?(f.id=K.value.id,b.success("Pessoa Registrada com Sucesso!"),$.value.push(f)):b.error(ue.value.message)},Me=async f=>{B.value=!0;const{data:m}=await g(O,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:f.pessoa.link_ficha}},"$hmDzSF3F61");r.value=m.value,x.value=f.pessoa},Pe=f=>{const m=$.value.filter(K=>K.pessoa.id!==f.pessoa.id).map(K=>({id:K.pessoa.id,nome:K.pessoa.nome}));E.value=f.id,H.value=m,w.value=!0,k.value=f.pessoa.nome,s.value=f.pessoa.id},Oe=f=>{G.value=!0,W.value=f.id,k.value=f.pessoa.nome};async function qe(f){f.excluido=!f.excluido;try{await g(`${X}/${f.id}`,{method:"PUT",body:JSON.stringify({excluido:f.excluido})},"$l09I6nLRfk")}catch(m){console.error("Erro ao excluir pessoa:",m)}}const Re=()=>{const f=u.query.origem||"criar",m=u.query.id;switch(f){case"atualizar":case"vizualizar":A.push(`/os/atualizar/${m}`);break;case"atualizar-lista":case"vizualizar-lista":A.push("/atos/lista");break;default:A.push("/os/criar-registro");break}};return(f,m)=>{const K=Ue,ue=Ye,ae=We,oe=aa,Fe=me;return p(),U(_e,null,{default:t(()=>[e(q)?N("",!0):(p(),U(F,{key:0,class:"mt-5"},{default:t(()=>[a(j,{cols:"3"},{default:t(()=>[a(re,{label:"Documento",modelValue:e(l).documento,"onUpdate:modelValue":m[0]||(m[0]=M=>e(l).documento=M)},null,8,["modelValue"])]),_:1}),a(j,{cols:"4"},{default:t(()=>[a(re,{label:"Pessoa",modelValue:e(l).nome,"onUpdate:modelValue":m[1]||(m[1]=M=>e(l).nome=M)},null,8,["modelValue"])]),_:1}),V("div",null,[V("img",{class:"mt-1",src:he,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:_})]),V("div",null,[V("img",{class:"mt-1 ml-2",src:ye,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:J})])]),_:1})),e(q)?N("",!0):(p(),U(F,{key:1},{default:t(()=>[a(j,{cols:"4"},{default:t(()=>[a(ve,{label:"Selecione a Pessoa",modelValue:e(l).pessoa,"onUpdate:modelValue":m[2]||(m[2]=M=>e(l).pessoa=M),items:e(y),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),a(j,{cols:"3"},{default:t(()=>[a(ve,{label:"Papel",modelValue:e(l).papeis,"onUpdate:modelValue":m[3]||(m[3]=M=>e(l).papeis=M),items:e(I),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(q)?N("",!0):(p(),P("div",ra,[V("img",{class:"mt-1",src:ye,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:De})]))]),_:1})),a(F,null,{default:t(()=>[a(j,null,{default:t(()=>[a(xe,{style:{height:"465px"},headers:c,items:e($)},{"item.actions":t(({item:M})=>[e(q)?N("",!0):(p(),U(F,{key:0},{default:t(()=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-1",onClick:ge=>Me(M),title:"Visualizar Ficha"},[M.pessoa.link_ficha?(p(),P("img",la)):(p(),P("img",ia))],8,na),V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ge=>Oe(M),class:"mr-1",title:"Alterar Papel"},m[8]||(m[8]=[V("img",{style:{width:"30px",height:"30px"},src:oa,alt:"Visualizar"},null,-1)]),8,ca),V("div",{class:"mr-1",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ge=>qe(M),title:"Deletar Pessoa"},[M.excluido?(p(),P("img",da)):(p(),P("img",ma))],8,ua),V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-1",onClick:ge=>Pe(M),title:"Selecionar Representante"},m[9]||(m[9]=[V("img",{style:{width:"30px",height:"30px"},src:Be,alt:"Visualizar"},null,-1)]),8,pa)]),_:2},1024))]),_:1},8,["items"])]),_:1})]),_:1}),a(K,{show:e(Y),onClose:m[4]||(m[4]=M=>Y.value=!1)},null,8,["show"]),a(ue,{representante_nome:e(k),representantes:e(H),ato_id:e(E),show:e(w),onClose:m[5]||(m[5]=M=>w.value=!1),onUpdateRepresentante:se},null,8,["representante_nome","representantes","ato_id","show"]),a(ae,{representante_nome:e(k),ato_token:e(i),ato_id:e(W),show:e(G),onClose:m[6]||(m[6]=M=>G.value=!1),onUpdatePapel:L},null,8,["representante_nome","ato_token","ato_id","show"]),e(B)?(p(),U(oe,{key:2,show:e(B),"link-view":e(r),"pessoa-obj":e(x),"is-view":!0,onClose:m[7]||(m[7]=M=>B.value=!1)},null,8,["show","link-view","pessoa-obj"])):N("",!0),a(F,null,{default:t(()=>[a(Fe,{onClick:Re},{default:t(()=>[a(ee,{size:"large",color:"red"},{default:t(()=>m[10]||(m[10]=[Z("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},fa={key:0,class:"loading-overlay"},va="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Ga={__name:"Minuta",emits:["page","doc"],setup(te,{emit:v}){Ne("DocumentEditorContainer",[Ze,Qe,Xe]);const C=ce(),{$toast:A}=ne(),u=le(),d=ie(),b=v;ze(`${C.public.docEditor}`);const S=`${C.public.managemant}/download`,Q=`${C.public.managemant}/atos/files`,T=`${C.public.managemant}/subitituirModelo`,X=`${C.public.managemant}/upload`,D=n(null),O=n(!1),h=n("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),q=n(d.query.origem==="vizualizar"),y=n(!1),x=async s=>{try{const i=await fetch(s);if(!i.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await i.blob()}catch(i){return console.error(i),null}},$=async()=>{try{const{data:s}=await g(`${Q}/${d.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return s.value.link_ato}catch(s){console.error("Erro ao carregar o documento:",s),A.error(s)}},I=async()=>{y.value=!0;try{const s=await $(),{data:i,status:r}=await g(S,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:s}},"$dvNFfvmIJC"),c=i.value,l=await x(c);if(l){const z=new FileReader;z.onload=()=>{const o=z.result;D.value.ej2Instances.documentEditor.open(o),b("doc",o)},z.readAsText(l)}}catch{console.error("Erro ao carregar o documento.")}finally{y.value=!1}},w=async()=>{const i=await D.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),r=new FileReader;r.onload=()=>{const c=r.result,z=D.value.ej2Instances.documentEditor.pageCount;b("page",z),b("doc",c)},r.readAsText(i)},Y=async()=>{y.value=!0;try{const i=await D.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),r=new FormData;r.append("file",i,"anexo.sfdt"),r.append("cartorio_token",R("user-data").value.cartorio_token),r.append("token",d.query.ato_token_edit),r.append("tipo","ato_minuta");const{data:c,status:l}=await g(X,{method:"POST",body:r},"$xv11VtUdMy");if(l.value==="success"){A.success("Documento enviado!");const o=D.value.ej2Instances.documentEditor.pageCount;w(),b("page",o)}else A.error("Erro ao enviar documento para o sistema.")}catch(s){A.error("Erro ao salvar documento."),console.error(s)}finally{y.value=!1}},B=()=>{O.value=!1,G()},G=async()=>{E(!0);try{await H(),E(!0);const{data:s,status:i}=await g(T,{method:"POST",body:{ato_token:d.query.ato_token_edit}},"$zyzWHTXTBW");s.value&&k(s.value)}catch(s){console.error("Erro ao gerar a minuta:",s),A.error("Ocorreu um erro ao gerar a minuta.")}finally{E(!1)}},H=async()=>{try{const{data:s}=await g(S,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),i=await x(s.value);if(i){const r=new FileReader;r.onload=()=>{const c=r.result;D.value.ej2Instances.documentEditor.open(c),b("doc",c)},r.readAsText(i)}}catch(s){console.error("Erro ao carregar o modelo de minuta:",s)}},k=s=>{const i=D.value.ej2Instances.documentEditor,r=c=>{for(const[l,z]of Object.entries(c))if(/^<<.+>>$/.test(l))try{i.search.findAll(l),i.search.searchResults.length>0&&i.search.searchResults.replaceAll(z)}catch(o){console.error(`Erro ao substituir o marcador ${l}:`,o)}else if(l==="partes"&&Array.isArray(z)&&z.length>0)for(const o of z)typeof o=="object"&&r(o)};r(s)},E=s=>{y.value=s},W=()=>{const s=d.query.origem||"criar",i=d.query.id;switch(s){case"atualizar":case"vizualizar":u.push(`/os/atualizar/${i}`);break;case"atualizar-lista":case"vizualizar-lista":u.push("/atos/lista");break;default:u.push("/os/criar-registro");break}};return Ie(async()=>{await I(),w()}),(s,i)=>{const r=me,c=Ve;return p(),P(Ce,null,[a(e($e),{height:"900px",ref_key:"documentEditorContainer",ref:D,serviceUrl:va,enableToolbar:!0,enableWordExport:!0},null,512),e(y)?(p(),P("div",fa,[a(Je,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):N("",!0),a(F,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[a(r,{class:"mr-4"},{default:t(()=>[a(ee,{size:"large",onClick:W,color:"red"},{default:t(()=>i[2]||(i[2]=[Z("Voltar")])),_:1})]),_:1}),e(q)?N("",!0):(p(),U(ee,{key:0,size:"large",color:"green",onClick:Y,disabled:e(y)},{default:t(()=>i[3]||(i[3]=[Z("Atualizar")])),_:1},8,["disabled"])),e(q)?N("",!0):(p(),U(ee,{key:1,class:"ml-4",size:"large",color:"blue",onClick:i[0]||(i[0]=l=>O.value=!0)},{default:t(()=>i[4]||(i[4]=[Z("Gerar Minuta")])),_:1}))]),_:1}),a(c,{onConfirm:B,condMessage:e(h),show:e(O),onClose:i[1]||(i[1]=l=>O.value=!1)},null,8,["condMessage","show"])],64)}}},ya=["innerHTML"],Ha={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(te){let v,C;const A=te,u=ce();ze(`${u.public.docEditor}`);const{$toast:d}=ne(),b=le(),S=ie(),Q=`${u.public.managemant}/download`,T=`${u.public.managemant}/atos/files`,X=`${u.public.managemant}/lavrarAto`,D=`${u.public.managemant}/listarEscrevente`,O=n(R("user-data").value.cartorio_token),h=R("auth_token").value,q=n("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),y=n(!1),x=n(null),$=n(null),I=n(S.query.origem==="vizualizar"),w=n(null),Y=n([]),B=pe({escrevente:null}),G=async r=>{try{const c=await fetch(r);if(!c.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await c.blob()}catch(c){return console.error(c),null}},H=async()=>{try{const{data:r}=await g(`${T}/${S.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return r.value.link_ato}catch(r){console.error("Erro ao carregar o documento:",r),d.error(r)}},k=async()=>{try{const r=await H(),{data:c,status:l}=await g(Q,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:r}},"$7ljqltMqa0"),z=c.value,o=await G(z);if(o){const _=new FileReader;_.onload=()=>{const J=_.result;w.value.ej2Instances.documentEditor.open(J)},_.readAsText(o)}}catch{d.error("Erro ao carregar o documento.")}};k();const E=async()=>{const r=w.value.ej2Instances.documentEditor.pageCount;try{const{data:c,status:l}=await g(X,{method:"POST",body:{ato_token:S.query.ato_token_edit,qtd_paginas:r,escrevente_token:B.escrevente,usuario_token:h,cartorio_token:O}},"$OWxZSQkyX8");l.value==="success"?(x.value=c.value,$.value=c.value[0].selo,d.success("Ato lavrado com sucesso!")):d.error("Falha ao lavrar o ato.")}catch{d.error("Erro ao conectar com o servidor.")}},W=()=>{y.value=!1,E()},{data:s}=([v,C]=de(()=>g(D,{method:"POST",body:{cartorio_token:O}},"$sMqfUUQcBM")),v=await v,C(),v);Y.value=s.value[0].func_json_escreventes;const i=()=>{const r=S.query.origem||"criar",c=S.query.id;switch(r){case"atualizar":case"vizualizar":b.push(`/os/atualizar/${c}`);break;case"atualizar-lista":case"vizualizar-lista":b.push("/atos/lista");break;default:b.push("/os/criar-registro");break}};return Le(()=>A.document,(r,c)=>{k()}),(r,c)=>{const l=Ve;return p(),P(Ce,null,[a(F,null,{default:t(()=>[a(j,null,{default:t(()=>[a(e($e),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:w,height:"850px",width:"850px"},null,512)]),_:1}),e(I)?N("",!0):(p(),U(j,{key:0},{default:t(()=>[a(ve,{class:"mt-15",label:"Tabelião/escrevente",modelValue:e(B).escrevente,"onUpdate:modelValue":c[0]||(c[0]=z=>e(B).escrevente=z),items:e(Y),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),V("img",{onClick:c[1]||(c[1]=z=>y.value=!0),style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Ge}),e(x)?(p(),U(sa,{key:0,width:"360"},{default:t(()=>[a(F,null,{default:t(()=>[a(j,null,{default:t(()=>[a(we,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[a(j,null,{default:t(()=>[Z(" Livro: "+fe(e(x)[0].livro_numero),1)]),_:1}),a(j,null,{default:t(()=>[Z(" Protocolo: "+fe(e(x)[0].protocolo?e(x)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),a(j,null,{default:t(()=>[a(we,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:t(()=>[Z(" Folhas : "+fe(e(x)[0].pagina_inicial)+" A "+fe(e(x)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),V("div",{style:{"margin-left":"10px","padding-bottom":"20px","margin-top":"-10px"},innerHTML:e($)},null,8,ya)]),_:1})):N("",!0)]),_:1}))]),_:1}),a(ee,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:i},{default:t(()=>c[3]||(c[3]=[Z("Voltar")])),_:1}),a(l,{show:e(y),condMessage:e(q),onClose:c[2]||(c[2]=z=>y.value=!1),onConfirm:W},null,8,["show","condMessage"])],64)}}},_a=["onClick"],ga={key:0,style:{width:"30px",height:"30px"},src:ke,alt:"Visualizar",title:"Reativar"},ba={key:1,src:Ae,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ka={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(te){let v,C;const A=le(),u=ie(),d=ce(),{$toast:b}=ne(),S=`${d.public.managemant}/listarEscrevente`;`${d.public.managemant}`;const Q=`${d.public.managemant}/atos_observacao`,T=`${d.public.managemant}/atos_observacao`,X=`${d.public.managemant}/atos_observacao`,D=n(R("user-data").value.cartorio_token),O=n(u.query.origem==="vizualizar"),h=n([]),q=n([]),y=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],x=pe({observacao:""}),$={observacao:{required:Ee.withMessage("O campo é obrigatório",Se)}},I=Te($,x),{data:w}=([v,C]=de(()=>g(`${X}/${u.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),v=await v,C(),v);Array.isArray(w.value)?h.value=w.value.map(k=>({...k,created:be(k.created,"dd/mm/yyyy hh:mm")})):w.value&&typeof w.value=="object"&&(h.value=[{...w.value,created:be(w.value.created,"dd/mm/yyyy hh:mm")}]);async function Y(){if(x.observacao.trim()===""){b.error("O campo de observação está vazio.");return}if(await I.value.$validate()){const{data:k,error:E,status:W}=await g(Q,{method:"POST",body:{ato_id:Number(u.query.ato_id),observacao:x.observacao,user_id:R("user-data").value.usuario_id}},"$gnHMo4uCXD");W.value==="success"&&(h.value.push({created:be(k.value.created,"dd/mm/yyyy hh:mm"),observacao:k.value.observacao,id:k.value.id,escrevente:R("user-data").value.nome}),x.observacao="",b.success("Observação registrada com sucesso"))}else b.error("Preencha os campos obrigatórios.")}async function B(k){k.excluido=!k.excluido;try{await g(`${T}/${k.id}`,{method:"PUT",body:JSON.stringify({excluido:k.excluido})},"$sP9AKdd3Ky")}catch(E){console.error("Erro ao excluir observação:",E)}}const{data:G}=([v,C]=de(()=>g(S,{method:"POST",body:{cartorio_token:D}},"$HL9pndqGh0")),v=await v,C(),v);q.value=G.value[0].func_json_escreventes;const H=()=>{const k=u.query.origem||"criar",E=u.query.id;switch(k){case"atualizar":case"vizualizar":A.push(`/os/atualizar/${E}`);break;case"atualizar-lista":case"vizualizar-lista":A.push("/atos/lista");break;default:A.push("/os/criar-registro");break}};return(k,E)=>{const W=me;return p(),U(_e,null,{default:t(()=>[O.value?N("",!0):(p(),U(F,{key:0,class:"mt-5"},{default:t(()=>[a(re,{label:"Observação",modelValue:x.observacao,"onUpdate:modelValue":E[0]||(E[0]=s=>x.observacao=s),required:"","error-messages":e(I).observacao.$errors.length>0?e(I).observacao.$errors.map(s=>s.$message):[],onBlur:e(I).observacao.$touch,onInput:e(I).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),V("div",null,[V("img",{class:"btn-pointer ml-2",src:ye,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Y})])]),_:1})),a(F,null,{default:t(()=>[a(j,null,{default:t(()=>[a(xe,{style:{height:"465px"},headers:y,items:h.value},{"item.actions":t(({item:s})=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:i=>B(s),title:"Deletar Observação"},[s.excluido?(p(),P("img",ga)):(p(),P("img",ba))],8,_a)]),_:1},8,["items"])]),_:1})]),_:1}),a(F,null,{default:t(()=>[a(W,{onClick:H},{default:t(()=>[a(ee,{size:"large",color:"red"},{default:t(()=>E[1]||(E[1]=[Z("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},ha="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAACmpJREFUeJzlW3+MVNUV/r73ZmZnZ1zcFZdfggtrpFiroFVTC2qF0rQRFRPdmKa1xjRM/AFhhZ1ZljQzU2Oyv6QWTZOltJTUpuma2gKxxVDBRiSt2OpKtFCUXy4ILiC6uzPL7Lz79Y95S1Zclp3ZHWa1X/KSuZl7zjv3e/fde+5551ASBkNNTc04klfZtj0NwFgAnkEFCo80gBOS9jmOs7upqemjwTpzIAJCoZC3tLR0Dsm5AGZKGk+yGIAXAPNi9shBAHoBJCQdA9AGYFsgEHg1Go2mz+78GQKqqqp8kydPnuzz+RYCmC1pIskkgEMAjgLoBpDW+aZNgUCSyMzQoGv7FEnFJI9I2m6M2XDw4MHDra2tqTMyfWOJx+O+ZDJ5paS7SD4I4DiANyXttCzr7c7OzkPl5eWdsVisdzQTEIvFvB0dHSWBQKCC5DUAbiI5C8BYSet7e3s3tre37+0j4cz73NPTM9kYczeARwEckfRsKpXa+vTTTx/rf5NoNHohx5QV3AeTAnDCvf69cuXKzY7jzAPwOIDHfD6fKioq/gBgP+DOgFAo5C0rK1sMICTp03Q6/eOurq69LS0tiUINZiQRj8cD3d3d0y3LWovM69ESCASejUajaQsASktL5wCYDeC4pFVdXV1716xZkyyo1SOIWCyWDAaD/5X0MwAnSc7p7u6eDQAWALir/QQAb6ZSqa0tLS2J0fqe5wJJikajCUkvS3oLwETLsuYCgN3d3T0OwCJ3Bf1Lc3PzjoJam0fMnz+/a8uWLeNIXi3pkk2bNr1skbyK5HgAH5DcVWgj8w1jzC5jTDvJ8X6/f4Zl2/YVAAIAjnZ2dh4qtIEXAAdJfgggYNv2FR5Jl5L0AuguLy/vzFVrJBKZD+B2kmMknfEWScoYkwTwRjAY/FM0Gk2dW0v+UVJS8mkymeyS5JNUznA4/BOSPwTw64aGhoZsF7/a2tqLAfwGwMIhdD/sOM6DBw8e3Nba2urkYP+wQZKRSCQC4CFJv7Usy7KR8QeU7eBDoVBAUj2Aha74KQCHAbT3uw5LOgnAALjMtu1fVVZWLnAX3QuOfuOkZVn2sE52Y8aMuYbkfEki2SYp6jjOsbP7eTyeYkl3A1gKYAqAJ6qrq99AhqyCImsC+p7cfffd5502bdodAKYBgDHmd42NjRsHEX2ltrbWlvQYyWt8Pt+LS5YsWfDMM88Mi4Th+itDJqCurm66Meb+mpqaG0j6SJYC+DoAi+Rhkq3n05FKpSJer/dKAN8GMDMQCLwTDofbAOTqcisSibSTfKGhoWFzLmQMiYBwOHwFybUkb7Es67MWSPslPdLY2HjeLXTVqlXJ2tra5QDikhaSHEPylmyNPhuSFoTD4YcB/Dlb2SERYFnW3QBucpufSvrYsqxPjDFbJLU0NjbuHeoN6+vr34nH4w8kk8nbJD0E4Go32JILPAAmkZwg6eckN2Q7C4b6CkyR5CP5EYAHGhoaXsra1H6IRqMJAH91r5wRj8f9yWRyHYD7SV6+dOnSiwGcykaHdf4uAEnLXfwcY8yoOSKfOHFCkrr62sXFxXa2OoZEwJcZ//cEjHiImyRra2tLSeY9fF5cXFxE0t/Xdhzn0rq6ujMPVVLa7/d/Eo1Gzbl0jJiR8Xjc09PT861IJLLIGDOJZNbvY7YgSUnT+nnVzxljzoS+JTmJROJAbW1tU319fdtAOkaEgHg8biWTyccB/BRA0YV08/vfi+QNA/w3W9K85cuX397c3Lz7bPkRISCZTC4G8AQAn6RTJPdI6hkJ3cMByUskzQAw1uPxLARQf3afYROwYsWKqQDiyAx+v2VZK9Lp9OvuB5WCobe3l16v93uWZTUDGAPg4oH6DZsASXe6yg3JX/j9/ucHW3QuFOLxuJVIJC4DUCIpJen9gfoNaxuMx+MBSd8BAEkfAPjHaBg8AJw+fXosgG8i85A/AfD3gfoNi4Cenp6rSc5w4wF7U6nUu8PRN5JIp9NTSN4IACT/GQwGR3YGkKQx5joAlwOApFdWrVp1Mld9Iw3Lsr4r6RK3+ctzzcycCVi0aFExyXkAfCTTJAcLhlxQVFVV2QC+755f2vft27f5XH1zJqCsrOxSALcBgKTXi4uL38lV10ijsrLyZklfdZvPDRaAzZkASQskjXN//2y0LH4uHnaffpfjOIPOzJwIcJWHXFf0o6amphdy0ZMPRCKRSciE3CDpX+l0+sBg/XMiYNmyZTe4yQeQ9MdR9iF1PoCLJDkAdiQSieODdc6JANu2f4BMrlC3ZVnDig6NJEKhUIDkrQD8AD6WtKOlpaV3MJlcCJgAYK77e3dvb+9/ctCRF5SUlFwu6XoAlmVZR9Pp9Hm/dGdNAMlvIEOCkfTWyZMnR80HVa/XexXJrwCAMealofgl2RLgA3AzgDIAPSS3rlu3ruCnvj5IugNAMTIP57mhyGRFgKRSANeTtCV12bb9cg525gWhUMgL4C63uTMYDL49FLmsToNulMd2f7/45JNPfu47YKFQWlpaBaDc3ZHO6fqejZx2AUmOpDW5yOYDVVVVNsnFbvNDAEPemXJ1hNr279+/MxfZfGDq1KkzAVznNredOnVqyIeyrAlwp9jvC5XgMBBI3onM65yS9Eo2+Y25bIPHjTF/y1YuX6irqxsL4BY3LeeAMebNbORzeQVeN8a05yCXF6TT6a8BmO6eT/Z0dnZm5ZhlS0AawI6nnnrqRJZyeYF77r8NwGQAkLQ52/TeIW2DkrokOSSTkhQOh2/M5BkVDiQ9lZWVtwJYhsy55BjylR8AYJcb5g6SrAHwSLY3ygN8AMrhDp7ko/X19UeyVeIxxjgkRRcDHW0dx9lk2/YWAPcg4waXDdf6kYAbjN1nWdbioqKic4a9+sNNkyMAGWMcD8nTyKSweWKxmBeZfPvPoKmpqZvkvZFI5F5JN5MsGtGR5ADXGXvXcZznm5ubBz3z90csFvMmk0mPJAOgxyOpg2QKQLCjo6MEmUKDgW5oALS61xcWnZ2dY2zbvohkimSHRfJ9ZAqMJgYCgYpCG5hveL3eCpITkRnze5bjOLslHSM5pS/M9WWGMeZaZLbNo4lEYo/l1tW1SSoGcNPKlSvHF9bE/KG6unqi+7XIb4xpW716dUefI7SN5BGSsxzHmRePxwOFyuXNB0iypqYmWFRUNE/SLABHAGwFXE8wEAi8Kmk7MpWhj3d3d0+PxWK55u6NOixfvjxgjJkuqVpSmTFmezAYfA1wCYhGo2ljzAZJ6yVNtCxrbSKRuCccDk8orOnDR3V19UTbtu/xeDxrkYllru/t7d3QV0V6pnDSrRq90ufz3QngRwBOSnpL0k5jzK6enp4DX6TCyZKSkqnGmGtJ3ihplqQyy7LWp9PpjYcOHXqvr3Dyc6WzFRUVl9m2fRcyR8xJrv//gVtm8oUpnQUwCZnV3g/giDFmu6SN5yyd7Q8342uOMWYugJluUVUAmTQYz2hdIF3XOI2MN5sAcNQY0wZgazAYfO28xdMDYcmSJeV+v38GyUoAE0heJMmbjwEMFyR73dTZoyTfTyQSe1avXt0xmMz/AHO29RxBrcY5AAAAAElFTkSuQmCC",ka={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ke,alt:"Criar"},Aa={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ea,alt:"Criar"},xa={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ha,alt:"Criar"},wa=["onClick"],Ca=["onClick"],$a=["onClick"],za={key:0,style:{width:"30px",height:"30px"},src:ke,alt:"Visualizar",title:"Reativar"},Va={key:1,src:Ae,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},et={__name:"Anexos",async setup(te){let v,C;const A=ce(),{$toast:u}=ne(),d=le(),b=ie(),S=n(b.query.origem==="vizualizar"),Q=`${A.public.biometria}/run-scanner`,T=`${A.public.managemant}/atos_anexos`,X=`${A.public.managemant}/atos_anexos`,D=`${A.public.managemant}/download`,O=`${A.public.managemant}/atos_anexos`,h=`${A.public.managemant}/upload`,q=n(!1),y=n(null),x=n([]);R("pessoa_token");const $=pe({descricao:"",fileEvent:null}),I={descricao:{required:Ee.withMessage("O campo é obrigatório",Se)}},w=Te(I,$,{$autoDirty:!0}),Y=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:B}=([v,C]=de(()=>g(`${O}/${b.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),v=await v,C(),v);x.value=B.value;async function G(){try{await H(),await k()}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}}async function H(){try{const{data:o}=await g(Q,{method:"GET"},"$KttjFhHivJ")}catch(o){u.error("Erro ao acionar o scanner:",o)}}async function k(){try{const{data:o,status:_}=await g("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:b.query.ato_token_edit,cartorio_token:R("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(o){console.error("Erro ao enviar o arquivo:",o)}}async function E(){try{const o=document.createElement("input");o.type="file",o.accept="*/*",o.onchange=async _=>{$.fileEvent=_,_.target.files[0]&&(y.value=!0)},o.click()}catch(o){console.error("Erro ao abrir o explorador de arquivos:",o)}}const W=async()=>{q.value=!0};function s(o){return o?!0:(y.value=!1,!1)}const i=async o=>{if(!$.fileEvent||!$.fileEvent.target.files.length){u.error("Nenhum arquivo selecionado.");return}const _=$.fileEvent.target.files[0],J=new FormData;J.append("file",_),J.append("cartorio_token",R("user-data").value.cartorio_token),J.append("token",o),J.append("tipo","ato_anexo");try{const L=await g(h,{method:"POST",body:J},"$KDhIYzGKzM");u.success("Anexo registrado com sucesso!")}catch{u.error("Erro ao enviar o arquivo.")}},r=async()=>{if(w.value.$touch(),!w.value.$invalid&&s($.fileEvent)){const{data:o,error:_,status:J}=await g(T,{method:"POST",body:{ato_id:b.query.ato_id,descricao:$.descricao,user_id:R("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$cdoFBGO0Ti");J.value==="success"&&(u.success("Anexo registrado com sucesso!"),x.value.push(o.value),i(o.value.token))}};async function c(o){o.excluido=!o.excluido;try{await g(`${X}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$WLSrgYRoHq")}catch(_){console.error("Erro ao excluir pessoa:",_)}}async function l(o){try{const _=await g(`${D}`,{method:"POST",body:{bucket:R("user-data").value.cartorio_token,path:o.link}},"$NdgRjioizH"),L=await(await fetch(_.data.value)).blob(),se=URL.createObjectURL(L);window.open(se,"_blank")}catch(_){console.error("Erro ao excluir pessoa:",_)}}const z=()=>{const o=b.query.origem||"criar",_=b.query.id;switch(o){case"atualizar":case"vizualizar":d.push(`/os/atualizar/${_}`);break;case"atualizar-lista":case"vizualizar-lista":d.push("/atos/lista");break;default:d.push("/os/criar-registro");break}};return(o,_)=>{const J=me;return p(),U(_e,null,{default:t(()=>[a(F,null,{default:t(()=>[a(j,{cols:"5",class:"mt-2"},{default:t(()=>[e(S)?N("",!0):(p(),U(re,{key:0,modelValue:e($).descricao,"onUpdate:modelValue":[_[0]||(_[0]=L=>e($).descricao=L),e(w).descricao.$touch],"error-messages":e(w).descricao.$errors.map(L=>L.$message),onBlur:e(w).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"]))]),_:1}),e(S)?N("",!0):(p(),P("div",{key:0,onClick:G,title:"Escanear"},_[1]||(_[1]=[V("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:He,alt:"Escanear"},null,-1)]))),e(S)?N("",!0):(p(),P("div",{key:1,onClick:E,title:"Criar"},[e(y)===!1?(p(),P("img",ka)):e(y)===!0?(p(),P("img",Aa)):(p(),P("img",xa))])),e(S)?N("",!0):(p(),P("div",{key:2,onClick:r,title:"Criar"},_[2]||(_[2]=[V("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ye,alt:"Criar"},null,-1)])))]),_:1}),a(xe,{headers:Y,items:e(x),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:L})=>[a(F,null,{default:t(()=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:se=>W(L),title:"Visualizar Anexo"},[V("img",{style:{width:"30px",height:"30px"},onClick:se=>l(L),src:he,alt:"Visualizar"},null,8,Ca)],8,wa),V("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:se=>c(L),title:"Deletar Pessoa"},[L.excluido?(p(),P("img",za)):(p(),P("img",Va))],8,$a)]),_:2},1024)]),_:1},8,["items"]),a(J,{onClick:z},{default:t(()=>[a(ee,{size:"large",color:"red"},{default:t(()=>_[3]||(_[3]=[Z("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Qa as _,Xa as a,Ga as b,Ha as c,Ka as d,et as e};
