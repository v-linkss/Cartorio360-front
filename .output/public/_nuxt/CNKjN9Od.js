import{V as _e,c as Se}from"./V_tnbP-q.js";import{V as ne}from"./B6GgtCcs.js";import{a as Ie,V as te}from"./B8wZoO2-.js";import{V as ve}from"./5Bym0PMx.js";import{r as u,o as y,y as j,w as t,b as e,P as Ve,U as Te,d as M,x as a,G as R,M as fe,u as be,n as oe,p as le,E as se,g as pe,q as Pe,c as h,V as L,a as T,A as ge,t as ze,K as ie,z as Q}from"./LFanaqvB.js";import{_ as ye}from"./CHECEXjW.js";import{_ as $e}from"./D-Ana3ml.js";import{c as ke,r as xe,u as Be}from"./CHs3DNtu.js";import{u as z}from"./CKWaKVTu.js";import{V as q}from"./Cxn7b9Xe.js";import{V as _}from"./BloomSmb.js";import{V as Ee}from"./DJUNZPcA.js";import{V as H}from"./C5aN0HXP.js";import{a as Me}from"./U7Yf5phD.js";import{_ as qe}from"./BVz1G1IN.js";import{_ as Ne}from"./CCDpt9zO.js";import{_ as Ae}from"./BCcHdrL1.js";import{_ as Oe,a as je}from"./DJvq3mCv.js";import{V as Le}from"./DREe8X_D.js";const Re={__name:"SaveButton",props:{onSave:{type:Function,required:!0},disabled:{type:Boolean,default:!1}},setup(B){const O=B,s=u(!1);async function m(){if(!s.value){s.value=!0;try{await O.onSave()}finally{s.value=!1}}}return(p,g)=>(y(),j(R,{loading:a(s),disabled:a(s)||B.disabled,color:"green",onClick:m,size:"large"},{loader:t(()=>[e(Ve,{indeterminate:"",color:"white",size:"24"})]),default:t(()=>[Te(p.$slots,"default",{},()=>[g[0]||(g[0]=M("Salvar"))])]),_:3},8,["loading","disabled"]))}},he={key:0,class:"d-flex justify-center"},we={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(B,{emit:O}){let s,m;const p=B,g=O,C=fe(),d=ge(),{$toast:I}=be(),{id:V}=C.params,$=`${d.public.managemant}/atos_bens`,N=`${d.public.managemant}/atos_bens`,E=`${d.public.managemant}/atos_bens`,b=`${d.public.managemant}/registro_imoveis`,D=`${d.public.managemant}/natureza_imoveis`,F=`${d.public.managemant}/tipo_logradouros`,k=`${d.public.managemant}/situacao_imoveis`,v=`${d.public.managemant}/listarCidades`,A=`${d.public.managemant}/listarTipoBens`,P=u(oe("user-data").value.cartorio_token),G=u(oe("user-data").value.usuario_id).value,J=u([]),K=u([]),re=u([]),W=u([]),X=u([]),w=u([]),Z=u(!0),i=le({tabvalores_tipo_regimovel_id:null,registro_cartorio:null,registro_matricula:null,matricula_letra:null,tabvalores_nat_imovel_id:null,cib:null,end_cidade_id:null,end_quadra:null,end_lote:null,tabvalores_tipologradouro_id:null,tipo_id:null,descricao:null,inscricao_estadual:null,tabvalores_situacao_imoveis_id:null,vlr_avaliacao:null,vlr_mercado:null,valor_mercado:"0.00",aliq_itbi:null,vlr_itbi:null,user_id:G,ato_id:Number(C.query.ato_id)||Number(p.ato_id)}),Y=le({...i}),c={descricao:{required:ke.withMessage("O campo é obrigatório",xe)},tipo_id:{required:ke.withMessage("O campo é obrigatório",xe)}},ee=Be(c,i),de=async()=>{var x,r,S,ce;if(!await ee.value.$validate()){I.error("Preencha todos os campos obrigatórios!");return}const o={...i,vlr_avaliacao:(x=i.vlr_avaliacao)==null?void 0:x.replace(/,/g,""),vlr_mercado:(r=i.vlr_mercado)==null?void 0:r.replace(/,/g,""),aliq_itbi:(S=i.aliq_itbi)==null?void 0:S.replace(/,/g,""),vlr_itbi:(ce=i.vlr_itbi)==null?void 0:ce.replace(/,/g,"")},{data:n,status:f}=await z(`${$}`,{method:"POST",body:o},"$0Mdv6RF9cH");f.value==="success"&&(I.success("Imovel criado com sucesso!"),g("saved",{id:n.value.id,token:n.value.token,ato_id:n.value.ato_id}))},{data:ue}=([s,m]=se(()=>z(`${A}`,{method:"POST",body:{cartorio_token:P.value,imoveis:!0}},"$H1S2cTYpdB")),s=await s,m(),s);if(w.value=ue.value,p.isUpdate===!0){const{data:l}=([s,m]=se(()=>z(`${N}/${p.imovel_id}`,{method:"GET"},"$jHrIlABk8l")),s=await s,m(),s);l.value&&Object.keys(i).forEach(o=>{l.value[o]!==void 0&&(i[o]=l.value[o])}),Object.assign(Y,i)}async function ae(){try{const[l,o,n,f,x]=await Promise.all([$fetch(D),$fetch(b),$fetch(k),$fetch(F),$fetch(v)]);K.value=l,J.value=o,X.value=n,re.value=f,W.value=x}catch(l){console.error("Erro ao carregar os dados de imoveis pessoa:",l)}finally{Z.value=!1}}const me=async l=>{const o={};if(Object.keys(i).forEach(f=>{i[f]!==Y[f]&&(o[f]=i[f])}),["vlr_avaliacao","vlr_mercado","aliq_itbi","vlr_itbi"].forEach(f=>{var x;o[f]&&(o[f]=(x=o[f])==null?void 0:x.toString().replace(/,/g,""))}),Object.keys(o).length===0)return;const{status:n}=await z(`${E}/${l}`,{method:"PUT",body:o},"$BZjXR26AL9");n.value==="success"&&(I.success("Imovel Atualizado com sucesso!"),g("close-modal"))},U=()=>{g("close-modal"),g("refresh-list")};return pe([()=>i.vlr_avaliacao?i.vlr_avaliacao.replace(/,/g,""):"0",()=>i.aliq_itbi?i.aliq_itbi.replace(/,/g,""):"0"],([l,o])=>{i.vlr_itbi=(Number(l)*Number(o)/100).toFixed(2)}),Pe(()=>{V||p.ato_id?ae():Z.value=!1}),(l,o)=>{const n=ye,f=$e,x=Re;return a(Z)?(y(),h("div",he,[e(Ve,{indeterminate:"",class:"loading-spinner",size:"64"})])):(y(),j(ne,{key:1},{default:t(()=>[e(q,null,{default:t(()=>[e(_,{class:"mt-2",cols:"12"},{default:t(()=>[e(Ee,{label:"Descrição",modelValue:a(i).descricao,"onUpdate:modelValue":o[0]||(o[0]=r=>a(i).descricao=r),"error-messages":a(ee).descricao.$errors.map(r=>r.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(_,{cols:"3"},{default:t(()=>[e(H,{label:"Tipo de Registro",modelValue:a(i).tabvalores_tipo_regimovel_id,"onUpdate:modelValue":o[1]||(o[1]=r=>a(i).tabvalores_tipo_regimovel_id=r),items:a(J),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"2"},{default:t(()=>[e(L,{label:"Cartório",modelValue:a(i).registro_cartorio,"onUpdate:modelValue":o[2]||(o[2]=r=>a(i).registro_cartorio=r)},null,8,["modelValue"])]),_:1}),e(_,{cols:"2"},{default:t(()=>[e(L,{label:"Matricula",modelValue:a(i).registro_matricula,"onUpdate:modelValue":o[3]||(o[3]=r=>a(i).registro_matricula=r)},null,8,["modelValue"])]),_:1}),e(_,null,{default:t(()=>[e(L,{label:"Letra",modelValue:a(i).matricula_letra,"onUpdate:modelValue":o[4]||(o[4]=r=>a(i).matricula_letra=r)},null,8,["modelValue"])]),_:1}),e(_,{cols:"4"},{default:t(()=>[e(H,{label:"Natureza",modelValue:a(i).tabvalores_nat_imovel_id,"onUpdate:modelValue":o[5]||(o[5]=r=>a(i).tabvalores_nat_imovel_id=r),items:a(K),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(_,{cols:"2"},{default:t(()=>[e(L,{label:"CIB",modelValue:a(i).cib,"onUpdate:modelValue":o[6]||(o[6]=r=>a(i).cib=r)},null,8,["modelValue"])]),_:1}),e(_,{cols:"3"},{default:t(()=>[e(H,{modelValue:a(i).tipo_id,"onUpdate:modelValue":o[7]||(o[7]=r=>a(i).tipo_id=r),items:a(w),label:"Tipo de imovel","item-title":"descricao","item-value":"id","error-messages":a(ee).tipo_id.$errors.map(r=>r.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(_,{cols:"3"},{default:t(()=>[e(L,{label:"Inscrição Municipal",modelValue:a(i).inscricao_estadual,"onUpdate:modelValue":o[8]||(o[8]=r=>a(i).inscricao_estadual=r)},null,8,["modelValue"])]),_:1}),e(_,{cols:"4"},{default:t(()=>[e(H,{label:"Situação",items:a(X),"item-title":"descricao","item-value":"id",modelValue:a(i).tabvalores_situacao_imoveis_id,"onUpdate:modelValue":o[9]||(o[9]=r=>a(i).tabvalores_situacao_imoveis_id=r)},null,8,["items","modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(_,{cols:"2"},{default:t(()=>[o[15]||(o[15]=T("label",null,"Valor Avaliação",-1)),e(n,{label:"Valor Avaliação",modelValue:a(i).vlr_avaliacao,"onUpdate:modelValue":o[10]||(o[10]=r=>a(i).vlr_avaliacao=r)},null,8,["modelValue"])]),_:1}),e(_,{cols:"2"},{default:t(()=>[o[16]||(o[16]=T("label",null,"Valor Mercado",-1)),e(n,{label:"Valor Mercado",modelValue:a(i).vlr_mercado,"onUpdate:modelValue":o[11]||(o[11]=r=>a(i).vlr_mercado=r)},null,8,["modelValue"])]),_:1}),e(_,{cols:"1"},{default:t(()=>[o[17]||(o[17]=T("label",null,"%ITB",-1)),e(n,{label:"%ITB",modelValue:a(i).aliq_itbi,"onUpdate:modelValue":o[12]||(o[12]=r=>a(i).aliq_itbi=r)},null,8,["modelValue"])]),_:1}),e(_,{cols:"2"},{default:t(()=>[o[18]||(o[18]=T("label",null,"Valor ITB",-1)),e(n,{label:"Valor ITB",modelValue:a(i).vlr_itbi,"onUpdate:modelValue":o[13]||(o[13]=r=>a(i).vlr_itbi=r)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,{class:"mt-10"},{default:t(()=>[e(f,{onClick:U},{default:t(()=>[e(R,{size:"large",color:"red"},{default:t(()=>o[19]||(o[19]=[M("Voltar")])),_:1})]),_:1}),B.isUpdate?(y(),j(R,{key:0,class:"ml-5",size:"large",color:"green",onClick:o[14]||(o[14]=r=>me(p.imovel_id))},{default:t(()=>o[20]||(o[20]=[M("Atualizar")])),_:1})):(y(),j(x,{key:1,class:"ml-5",onSave:de},{default:t(()=>o[21]||(o[21]=[M(" Salvar ")])),_:1}))]),_:1})]),_:1}))}}},De={key:0,class:"d-flex justify-center"},Ce={__name:"Enderecos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(B,{emit:O}){let s,m;const p=B,g=O,C=fe(),d=ge(),{$toast:I}=be(),{id:V}=C.params,$=`${d.public.managemant}/atos_bens`,N=`${d.public.managemant}/atos_bens`,E=`${d.public.managemant}/registro_imoveis`,b=`${d.public.managemant}/natureza_imoveis`,D=`${d.public.managemant}/tipo_logradouros`,F=`${d.public.managemant}/situacao_imoveis`,k=`${d.public.auth}/service/gerencia/cep`,v=`${d.public.managemant}/listarCidades`,A=`${d.public.managemant}/listarTipoBens`,P=u(oe("user-data").value.cartorio_token),G=u(oe("user-data").value.usuario_id).value,K=oe("auth_token").value,re=u([]),W=u([]),X=u([]),w=u([]),Z=u([]),i=u([]),Y=u(!0),c=le({end_cidade_id:null,end_quadra:null,end_lote:null,tabvalores_tipologradouro_id:null,end_logradouro:null,end_logradouro_numero:null,end_bairro:null,end_cep:null,end_complemento:null,user_id:G,ato_id:Number(C.query.ato_id)||Number(p.ato_id)}),ee=le({...c}),{data:de}=([s,m]=se(()=>z(`${A}`,{method:"POST",body:{cartorio_token:P.value,imoveis:!0}},"$W62VZQp5Tx")),s=await s,m(),s);if(i.value=de.value,p.isUpdate===!0){const{data:U}=([s,m]=se(()=>z(`${$}/${p.imovel_id}`,{method:"GET"},"$uGMUgsxHFk")),s=await s,m(),s);U.value&&Object.keys(c).forEach(l=>{U.value[l]!==void 0&&(c[l]=U.value[l])}),Object.assign(ee,c)}async function ue(){try{const[U,l,o,n,f]=await Promise.all([$fetch(b),$fetch(E),$fetch(F),$fetch(D),$fetch(v)]);W.value=U,re.value=l,Z.value=o,X.value=n,w.value=f}catch(U){console.error("Erro ao carregar os dados de imoveis pessoa:",U)}finally{Y.value=!1}}const ae=async U=>{const l={};if(Object.keys(c).forEach(n=>{c[n]!==ee[n]&&(l[n]=c[n])}),Object.keys(l).length===0)return;const{status:o}=await z(`${N}/${U}`,{method:"PUT",body:l},"$JWP9Pf1MfJ");o.value==="success"&&I.success("Imovel Atualizado com sucesso!")},me=()=>{g("close-modal"),g("refresh-list")};return pe(()=>c.end_cep,async U=>{if(U&&U.length===8)try{const{data:l,error:o}=await z(`${k}/${U}`,{headers:{Authorization:K}},"$b99zbpjYFS");if(o.value){console.error("Erro ao buscar CEP:",o.value),I.error("Erro ao buscar CEP no servidor.");return}if(l.value.logradouro&&l.value.bairro&&l.value.localidade&&l.value.uf){c.end_logradouro=l.value.logradouro,c.end_bairro=l.value.bairro,c.end_complemento=l.value.complemento;let n=`${l.value.localidade}/${l.value.uf}`.toUpperCase();const f=w.value.find(x=>x.descricao===n);f?c.end_cidade_id=f.id:I.error("Cidade não encontrada na lista!")}else I.error("CEP não retornou dados válidos!")}catch(l){console.error("Erro inesperado:",l),I.error("Erro inesperado. Verifique sua conexão.")}}),Pe(()=>{V||p.ato_id||p.imovel_id?ue():Y.value=!1}),(U,l)=>{const o=$e;return a(Y)?(y(),h("div",De,[e(Ve,{indeterminate:"",class:"loading-spinner",size:"64"})])):(y(),j(ne,{key:1,style:{height:"500px"},class:"mt-2"},{default:t(()=>[e(q,null,{default:t(()=>[e(_,{cols:"2"},{default:t(()=>[e(L,{label:"CEP",modelValue:a(c).end_cep,"onUpdate:modelValue":l[0]||(l[0]=n=>a(c).end_cep=n)},null,8,["modelValue"])]),_:1}),e(_,{cols:"5"},{default:t(()=>[e(H,{label:"Cidade",modelValue:a(c).end_cidade_id,"onUpdate:modelValue":l[1]||(l[1]=n=>a(c).end_cidade_id=n),items:a(w),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"2"},{default:t(()=>[e(L,{label:"Quadra",modelValue:a(c).end_quadra,"onUpdate:modelValue":l[2]||(l[2]=n=>a(c).end_quadra=n)},null,8,["modelValue"])]),_:1}),e(_,{cols:"2"},{default:t(()=>[e(L,{label:"Lote",modelValue:a(c).end_lote,"onUpdate:modelValue":l[3]||(l[3]=n=>a(c).end_lote=n)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(_,{cols:"4"},{default:t(()=>[e(H,{label:"Tipo de Logradouro",modelValue:a(c).tabvalores_tipologradouro_id,"onUpdate:modelValue":l[4]||(l[4]=n=>a(c).tabvalores_tipologradouro_id=n),items:a(X),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"6"},{default:t(()=>[e(L,{label:"Logradouro",modelValue:a(c).end_logradouro,"onUpdate:modelValue":l[5]||(l[5]=n=>a(c).end_logradouro=n)},null,8,["modelValue"])]),_:1}),e(_,{cols:"1"},{default:t(()=>[e(L,{label:"N*",modelValue:a(c).end_logradouro_numero,"onUpdate:modelValue":l[6]||(l[6]=n=>a(c).end_logradouro_numero=n)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(_,{cols:"6"},{default:t(()=>[e(L,{label:"Bairro",modelValue:a(c).end_bairro,"onUpdate:modelValue":l[7]||(l[7]=n=>a(c).end_bairro=n)},null,8,["modelValue"])]),_:1}),e(_,{cols:"5"},{default:t(()=>[e(L,{label:"Complemento",modelValue:a(c).end_complemento,"onUpdate:modelValue":l[8]||(l[8]=n=>a(c).end_complemento=n)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,{class:"mt-10 justify-start"},{default:t(()=>[e(o,{onClick:me},{default:t(()=>[e(R,{size:"large",color:"red"},{default:t(()=>l[11]||(l[11]=[M("Voltar")])),_:1})]),_:1}),B.isUpdate?(y(),j(R,{key:0,class:"ml-5",size:"large",color:"green",onClick:l[9]||(l[9]=n=>ae(p.imovel_id))},{default:t(()=>l[12]||(l[12]=[M("Atualizar")])),_:1})):(y(),j(R,{key:1,class:"ml-5",size:"large",color:"green",onClick:l[10]||(l[10]=n=>ae(p.imovel_id))},{default:t(()=>l[13]||(l[13]=[M("Salvar")])),_:1}))]),_:1})]),_:1}))}}},Fe={class:"ml-4"},Ge={__name:"Partes",props:{show:Boolean,ato_token:String,ato_id:Number,partes_imovel:Object},emits:["close","update-imovel"],setup(B,{emit:O}){const s=B,m=u(s.show),p=fe(),g=ge(),{$toast:C}=be(),d=`${g.public.managemant}/bens_pessoa`,I=`${g.public.managemant}/listarPapeis`,V=u([]),$=le({percentual:null,tipo_parte_id:null}),N=u({}),E=O;pe(()=>s.show,async k=>{m.value=k,k&&(await D(),$.tipo_parte_id=s.partes_imovel.partes_tipos.descricao||null,$.percentual=s.partes_imovel.percentual.replace(/,/g,"")||null,N.value={tipo_parte_id:$.tipo_parte_id,percentual:$.percentual.replace(/,/g,"")})});const b=()=>{m.value=!1,E("close")},D=async()=>{const{data:k}=await z(I,{method:"POST",body:{tipo_ato_token:p.query.tipo_ato_token}},"$IjSu4kwy4b");V.value=k.value},F=async()=>{const k={};Object.keys($).forEach(A=>{let P=$[A];A==="tipo_parte_id"&&P&&(P=P.id),P!==N.value[A]&&(k[A]=P)}),k.percentual&&(k.percentual=k.percentual.toString().replace(/,/g,""));const{status:v}=await z(`${d}/${s.partes_imovel.id}`,{method:"PUT",body:k},"$QkvGl1R6ZY");v.value==="success"&&(C.success("Parte Atualizada com Sucesso!"),E("update-imovel",k),b())};return(k,v)=>{const A=ye;return y(),j(ve,{persistent:"",modelValue:a(m),"onUpdate:modelValue":v[2]||(v[2]=P=>ie(m)?m.value=P:null),"max-width":"800"},{default:t(()=>[e(_e,null,{default:t(()=>[e(ne,null,{default:t(()=>[e(q,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:t(()=>[T("h1",Fe," Altere o papel para: "+ze(s.partes_imovel.pessoa.nome),1)]),_:1}),v[4]||(v[4]=T("hr",{class:"mb-5"},null,-1)),e(q,null,{default:t(()=>[e(_,{cols:"8"},{default:t(()=>[e(H,{class:"mt-6",label:"Selecione o Papel",modelValue:a($).tipo_parte_id,"onUpdate:modelValue":v[0]||(v[0]=P=>a($).tipo_parte_id=P),items:a(V),"item-title":"descricao","item-value":"descricao","return-object":""},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"2"},{default:t(()=>[v[3]||(v[3]=T("label",null,"%",-1)),e(A,{modelValue:a($).percentual,"onUpdate:modelValue":v[1]||(v[1]=P=>a($).percentual=P)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Se,null,{default:t(()=>[e(R,{style:{"background-color":"red",color:"white"},onClick:b},{default:t(()=>v[5]||(v[5]=[M("Voltar")])),_:1}),e(R,{style:{"background-color":"green",color:"white"},onClick:F},{default:t(()=>v[6]||(v[6]=[M("Salvar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},He=["onClick"],Ye=["onClick"],Qe=["onClick"],Je={key:0,style:{width:"30px",height:"30px"},src:Oe,alt:"Visualizar",title:"Reativar"},Ke={key:1,src:je,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ue={__name:"Partes",props:{ato_token:{type:String},ato_token_selected:{type:String},ato_id:{type:Number},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(B,{emit:O}){let s,m;const p=B,g=O,C=fe(),d=ge(),{$toast:I}=be(),V=`${d.public.managemant}/partes_atos`,$=`${d.public.managemant}/listarPapeis`,N=`${d.public.managemant}/getLinkTipo`,E=`${d.public.managemant}/bens_pessoa`,b=`${d.public.managemant}/bens_pessoa`,D=`${d.public.managemant}/bens_pessoa`,F=`${d.public.managemant}/download`,k=u(null),v=u([]),A=u([]),P=u([]),G=u(!1),J=u(!1),K=u(null),re=u(C.query.tipo_ato_token),W=u(null),X=[{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"%",align:"start",key:"percentual"},{value:"actions"}],w=le({papeis:null,percentual:null}),{data:Z}=([s,m]=se(()=>z($,{method:"POST"},"$X6FDd5A6WK")),s=await s,m(),s);P.value=Z.value;const i=async()=>{const{data:l}=await z(`${b}/${p.imovel_id}`,{method:"GET"},"$Dyv7lSgcqT"),n=(f=>f.map(x=>({...x,pessoa:{...x.pessoa,documento:x.pessoa.doc_identificacao},papel:{...x.partes_tipos}})))(l.value);A.value=n};i();const Y=async()=>{await i()},{data:c,status:ee}=([s,m]=se(()=>z(V,{method:"POST",body:{ato_token:p.ato_token||C.query.ato_token_edit}},"$Ir36YwSBFY")),s=await s,m(),s);v.value=c.value&&Object.keys(c.value).length===0?[]:c.value;const de=async()=>{const l={pessoa:{nome:w.pessoa.pessoa_nome},papel:P.value.find(f=>f.id===w.papeis),percentual:w.percentual},{data:o,status:n}=await z(E,{method:"POST",body:{bem_id:p.imovel_id,ato_id:Number(C.query.ato_id),pessoa_id:w.pessoa.pessoa_id,tipo_parte_id:w.papeis,user_id:oe("user-data").value.usuario_id,percentual:w.percentual.replace(/,/g,"")}},"$z4QOGPyvCc");n.value==="success"&&(l.id=o.value.id,I.success("Pessoa Registrada com Sucesso!"),A.value.push(l))},ue=async l=>{var r;if(G.value=!0,W.value=null,!l.pessoa.id)return;const{data:o}=await z(N,{method:"POST",body:{tipo:"ficha",id:l.pessoa.id}},"$XYnqHmowsR");if(!((r=o.value)!=null&&r.link))return;const{data:n}=await z(F,{method:"POST",body:{bucket:oe("user-data").value.cartorio_token,path:o.value.link}},"$63DgHOk5hC"),f=o.value.link,x=n.value;/\.(tr7|tiff)$/i.test(f)?W.value=x:fotoRender.value=`data:image/jpeg;base64,${x}`},ae=l=>{J.value=!0,k.value=l,K.value=l.id};async function me(l){l.excluido=!l.excluido;try{await z(`${D}/${l.id}`,{method:"PUT",body:JSON.stringify({excluido:l.excluido})},"$3fKfAn4Pra")}catch(o){console.error("Erro ao excluir pessoa:",o)}}const U=()=>{g("close-modal"),g("refresh-list")};return(l,o)=>{const n=ye,f=Ge,x=Me,r=$e;return y(),j(ne,{style:{height:"500px"}},{default:t(()=>[e(q,null,{default:t(()=>[e(_,{class:"mt-6",cols:"4"},{default:t(()=>[e(H,{label:"Selecione a Pessoa",modelValue:a(w).pessoa,"onUpdate:modelValue":o[0]||(o[0]=S=>a(w).pessoa=S),items:a(v),"item-title":"pessoa_nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(_,{class:"mt-6",cols:"3"},{default:t(()=>[e(H,{label:"Papel",modelValue:a(w).papeis,"onUpdate:modelValue":o[1]||(o[1]=S=>a(w).papeis=S),items:a(P),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"1"},{default:t(()=>[o[6]||(o[6]=T("label",null,"%",-1)),e(n,{modelValue:a(w).percentual,"onUpdate:modelValue":o[2]||(o[2]=S=>a(w).percentual=S)},null,8,["modelValue"])]),_:1}),T("div",null,[T("img",{class:"mt-7",src:qe,style:{width:"40px",cursor:"pointer"},title:"Criar Imovel",onClick:de})])]),_:1}),e(q,null,{default:t(()=>[e(_,null,{default:t(()=>[e(Le,{style:{height:"350px"},headers:X,items:a(A)},{"item.actions":t(({item:S})=>[e(q,null,{default:t(()=>[T("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>ue(S),title:"Visualizar Ficha"},o[7]||(o[7]=[T("img",{style:{width:"30px",height:"30px"},src:Ne,alt:"Visualizar"},null,-1)]),8,He),T("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>ae(S),class:"mr-2",title:"Alterar Papel"},o[8]||(o[8]=[T("img",{style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar"},null,-1)]),8,Ye),T("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>me(S),title:"Deletar Pessoa"},[S.excluido?(y(),h("img",Je)):(y(),h("img",Ke))],8,Qe)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(f,{partes_imovel:a(k),ato_token:a(re),ato_id:a(K),show:a(J),onClose:o[3]||(o[3]=S=>J.value=!1),onUpdateImovel:Y},null,8,["partes_imovel","ato_token","ato_id","show"]),e(ve,{modelValue:a(G),"onUpdate:modelValue":o[5]||(o[5]=S=>ie(G)?G.value=S:null),width:"600"},{default:t(()=>[e(_e,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(x,{"tiff-url":a(W)},null,8,["tiff-url"]),e(R,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:o[4]||(o[4]=S=>G.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(q,{class:"mt-5"},{default:t(()=>[e(r,{onClick:U},{default:t(()=>[e(R,{size:"large",color:"red"},{default:t(()=>o[9]||(o[9]=[M("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},We={key:0},Xe={key:1},Ze={key:2},xo={__name:"Cadastro",props:{show:Boolean,imovel_id:Number,ato_token:String,ato_id:Number,ato_token_selected:String},emits:["close","refresh"],setup(B,{emit:O}){const s=B,m=u("dados"),p=u(s.show),g=u(null),C=u(null),d=u(!1),I=O;pe(()=>s.show,E=>{p.value=E});const V=E=>{d.value=!0,C.value=E.ato_id,g.value=E.id},$=()=>{p.value=!1,d.value=!1,I("close")},N=()=>{I("refresh")};return(E,b)=>{const D=we,F=Ce,k=Ue;return y(),j(ve,{persistent:"",modelValue:a(p),"onUpdate:modelValue":b[1]||(b[1]=v=>ie(p)?p.value=v:null),"max-width":"1000"},{default:t(()=>[e(_e,{style:{height:"650px"}},{default:t(()=>[e(ne,null,{default:t(()=>[b[5]||(b[5]=T("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Cadastro de imoveis ",-1)),e(Ie,{modelValue:a(m),"onUpdate:modelValue":b[0]||(b[0]=v=>ie(m)?m.value=v:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(te,{value:"dados"},{default:t(()=>b[2]||(b[2]=[M("Dados")])),_:1}),a(d)?(y(),j(te,{key:0,value:"enderecos"},{default:t(()=>b[3]||(b[3]=[M("Endereco")])),_:1})):Q("",!0),a(d)?(y(),j(te,{key:1,value:"partes"},{default:t(()=>b[4]||(b[4]=[M("Partes")])),_:1})):Q("",!0)]),_:1},8,["modelValue"]),a(m)==="dados"?(y(),h("div",We,[e(D,{onRefreshList:N,ato_id:s.ato_id,onSaved:V,onCloseModal:$},null,8,["ato_id"])])):Q("",!0),a(m)==="enderecos"&&a(d)?(y(),h("div",Xe,[e(F,{onRefreshList:N,isUpdate:!0,ato_id:a(C),ato_token:s.ato_token,imovel_id:a(g),onCloseModal:$},null,8,["ato_id","ato_token","imovel_id"])])):Q("",!0),a(m)==="partes"&&a(d)?(y(),h("div",Ze,[e(k,{onRefreshList:N,imovel_id:a(g),ato_token:s.ato_token,ato_id:s.ato_id,ato_token_selected:s.ato_token_selected,onCloseModal:$},null,8,["imovel_id","ato_token","ato_id","ato_token_selected"])])):Q("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},eo={key:0},oo={key:1},ao={key:2},Io={__name:"Atualizar",props:{show:Boolean,imovel_id:Number,ato_token_selected:String},emits:["close","refresh"],setup(B,{emit:O}){const s=B,m=u("dados"),p=u(s.show),g=O;pe(()=>s.show,I=>{p.value=I});const C=()=>{p.value=!1,g("close")},d=()=>{g("refresh")};return(I,V)=>{const $=we,N=Ce,E=Ue;return y(),j(ve,{persistent:"",modelValue:a(p),"onUpdate:modelValue":V[1]||(V[1]=b=>ie(p)?p.value=b:null),"max-width":"1000"},{default:t(()=>[e(_e,{style:{height:"650px"}},{default:t(()=>[e(ne,null,{default:t(()=>[V[5]||(V[5]=T("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Atualizar imovel ",-1)),e(Ie,{modelValue:a(m),"onUpdate:modelValue":V[0]||(V[0]=b=>ie(m)?m.value=b:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(te,{value:"dados"},{default:t(()=>V[2]||(V[2]=[M("Dados")])),_:1}),e(te,{value:"enderecos"},{default:t(()=>V[3]||(V[3]=[M("Endereço")])),_:1}),e(te,{value:"partes"},{default:t(()=>V[4]||(V[4]=[M("Partes")])),_:1})]),_:1},8,["modelValue"]),a(m)==="dados"?(y(),h("div",eo,[e($,{onRefreshList:d,isUpdate:!0,imovel_id:s.imovel_id,onCloseModal:C},null,8,["imovel_id"])])):Q("",!0),a(m)==="enderecos"?(y(),h("div",oo,[e(N,{onRefreshList:d,isUpdate:!0,imovel_id:s.imovel_id,onCloseModal:C},null,8,["imovel_id"])])):Q("",!0),a(m)==="partes"?(y(),h("div",ao,[e(E,{imovel_id:s.imovel_id,ato_token_selected:s.ato_token_selected,onCloseModal:C},null,8,["imovel_id","ato_token_selected"])])):Q("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{xo as _,Io as a};
