import{_ as te}from"./D6-M35Lx.js";import{c as de,r as me,u as pe}from"./xDohCSqF.js";import{g as ze,G as H,J as Q,m as X,r as i,u as P,H as oe,n as ee,o as C,p as K,w as o,b as e,s as t,V as Y,v as G,d as L,q as Z,A as Me,a as _,c as j,O as De,P as Re,K as ye,F as he,Q as ge,t as ae}from"./BqN3gZQn.js";import{u as $}from"./DL24gEe2.js";import{V as M}from"./CSantnwn.js";import{V as R}from"./P9KcvYp-.js";import{V as re}from"./StRd7zJm.js";import{V as le}from"./DEEuPpoh.js";import{_ as Be}from"./DMBEU1J0.js";import{_ as Ne,a as je,b as Ie,T as Ue,W as Fe,r as be,D as xe,c as Le,e as We,f as Ge,d as Je}from"./DyNKOOrA.js";import{_ as Ke}from"./DxI9STOp.js";import{_ as se}from"./bem81gIS.js";import{_ as ne}from"./BVz1G1IN.js";import{_ as Ye}from"./C51cWfDz.js";import{_ as He}from"./DhBtNmTR.js";import{_ as _e,a as ve}from"./DJvq3mCv.js";import{V as fe}from"./Cy95rehp.js";import{_ as Qe}from"./DaX5Fjnm.js";import{V as Xe}from"./DBNvRq73.js";import{f as Ze}from"./B0IxRygJ.js";const It={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_tipo_id:{type:Number}},emits:["saved"],async setup(W,{emit:f}){let v,h;const x=W;ze(()=>x.ato_tipo_id,g=>{w.value={id:g}});const A=f,k=H(),V=Q(),I=Z(),{$toast:q}=X(),B=`${I.public.managemant}/listarSituacoes`,D=`${I.public.managemant}/createAtos`;`${I.public.managemant}`;const S=i(P("user-data").value.cartorio_token),O=i(P("user-service").value.id).value||i(P("user-service").value).value,U=i([]),w=i(x.ato_tipo_id?{id:x.ato_tipo_id}:null),m=oe({dt_abertura:null,status:"EM EDIÇÃO",mne:null}),N={status:{required:de.withMessage("O campo é obrigatorio",me)}},r=pe(N,m);async function u(){if(await r.value.$validate()){const{data:g,error:s,status:n}=await $(D,{method:"POST",body:{ato_tipo_id:w.value.id,cartorio_id:P("user-data").value.cartorio_id,ordemserv_id:O,status:m.status,dt_abertura:m.dt_abertura,mne:m.mne,user_id:P("user-data").value.usuario_id,user_alteracao_id:P("user-data").value.usuario_id}},"$9ZmTYsLk0K");n.value==="success"&&(q.success("Ato registrado com sucesso!"),A("saved",{id:g.value.id,token:g.value.token}))}else q.error("Preencha os campos obrigatorios.")}const{data:c}=([v,h]=ee(()=>$(B,{method:"POST",body:{cartorio_token:S.value}},"$hyq5YcBEjF")),v=await v,h(),v);U.value=c.value;const E=()=>{const g=V.query.origem||"criar",s=V.query.id;g==="atualizar"?k.push(`/os/atualizar/${s}`):k.push("/os/criar-registro")};return(g,s)=>{const n=te;return C(),K(le,null,{default:o(()=>[e(M,{class:"mt-5"},{default:o(()=>[e(R,{cols:"3"},{default:o(()=>[e(re,{label:"Situação",modelValue:t(m).status,"onUpdate:modelValue":s[0]||(s[0]=p=>t(m).status=p),items:t(U),"item-title":"descricao","item-value":"descricao",required:"","error-messages":t(r).status.$errors.map(p=>p.$message),onBlur:t(r).status.$touch,onInput:t(r).status.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1})]),_:1}),e(M,null,{default:o(()=>[e(R,{cols:"5"},{default:o(()=>[e(Y,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:t(m).mne,"onUpdate:modelValue":s[1]||(s[1]=p=>t(m).mne=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(M,null,{default:o(()=>[e(R,{cols:"2"},{default:o(()=>[e(Y,{modelValue:t(m).dt_abertura,"onUpdate:modelValue":s[2]||(s[2]=p=>t(m).dt_abertura=p),type:"date",label:"Data Lavratura",disabled:"",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(M,{class:"mb-3"},{default:o(()=>[e(n,{onClick:E},{default:o(()=>[e(G,{size:"large",color:"red"},{default:o(()=>s[3]||(s[3]=[L("Voltar")])),_:1})]),_:1}),e(G,{class:"ml-10",onClick:u,size:"large",color:"green"},{default:o(()=>s[4]||(s[4]=[L("Salvar")])),_:1})]),_:1})]),_:1})}}},et={key:1,style:{width:"40px",height:"40px"},src:Ye,alt:"Visualizar",title:"Não Ficha"},tt=["onClick"],ot=["onClick"],at=["onClick"],st={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},rt={key:1,src:ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},nt=["onClick"],Ut={__name:"Partes",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},async setup(W){let f,v;const h=W,x=H(),A=Q(),k=Z(),{$toast:V}=X(),I=`${k.public.managemant}/pesquisarPessoas`,q=`${k.public.managemant}/listarPapeis`,B=`${k.public.managemant}/getLinkTipo`,D=`${k.public.managemant}/createAtosPessoa`,S=`${k.public.managemant}/getAtosPessoaById`,O=`${k.public.managemant}/updateAtosPessoa`,U=i(P("user-data").value.cartorio_token),w=i([]),m=i([]),N=i([]),r=i(!1),u=i(!1),c=i(!1),E=i(!1),g=i(null),s=i(null),n=i(null),p=i(null);i(null);const l=i(null),b=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],y=oe({papeis:null,nome:null,pessoa:null,documento:null}),F=Me(()=>{var d;return((d=y.pessoa)==null?void 0:d.link_ficha)||!1}),{data:J}=([f,v]=ee(()=>$(q,{method:"POST",body:{tipo_ato_token:h.ato_token}},"$fFKndZhA4W")),f=await f,v(),f);N.value=J.value;async function ke(){try{const{data:d,error:a}=await $(I,{method:"POST",body:{cartorio_token:U.value,documento:y.documento,nome:y.nome}},"$o3ZL1rvYrY");d.value.length>0?(w.value=d.value,y.pessoa=w.value[0]):w.value=[]}catch(d){console.error("Erro na requisição",d)}}const $e=()=>{u.value=!0},we=d=>{m.value=m.value.map(a=>a.id===n.value?{...a,papel:{...a.papel,descricao:d}}:a)},Ce=d=>{const a=m.value.find(z=>z.pessoa.id===p.value);a.representante.nome=d},Ve=async()=>{const d={pessoa:y.pessoa,papel:N.value.find(z=>z.id===y.papeis),representante:{nome:null}},a=await $(`${S}/${h.ato_id}`,{method:"GET"},"$kXSxUa4grs");for(const z of a.data.value)if(z.pessoa_id===y.pessoa.id&&z.ato_id===h.ato_id&&z.tipo_parte_id===y.papeis){V.error("Pessoa Já Registrada Com Esse Papel!");return}try{const{data:z,error:ie,status:ue}=await $(D,{method:"POST",body:{ato_id:Number(h.ato_id),pessoa_id:y.pessoa.id,tipo_parte_id:y.papeis,user_id:Number(P("user-data").value.usuario_id)}},"$So3qnQu7ek");ue.value==="success"?(d.id=z.value.id,V.success("Pessoa Registrada com Sucesso!"),m.value.push(d)):V.error(ie.value.message)}catch{V.error("Erro no servidor. Tente novamente.")}},Ee=async d=>{c.value=!0,l.value=null;const{data:a}=await $(`${B}`,{method:"POST",body:{id:d.pessoa.id,tipo:"ficha"}},"$Q3kbIwtd9t");a.value&&a.value.link?l.value=`data:image/jpeg;base64,${a.value.link}`:l.value=null},Pe=d=>{const a=m.value.filter(z=>z.pessoa.id!==d.pessoa.id).map(z=>({id:z.pessoa.id,nome:z.pessoa.nome}));n.value=d.id,g.value=a,r.value=!0,s.value=d.pessoa.nome,p.value=d.pessoa.id},Ae=d=>{n.value=d.id,E.value=!0,s.value=d.pessoa.nome};async function Se(d){d.excluido=!d.excluido;try{await $(`${O}/${n.value}`,{method:"PUT",body:JSON.stringify({excluido:d.excluido})},"$9xStKwGd7o")}catch(a){console.error("Erro ao excluir pessoa:",a)}}const Te=()=>{const d=A.query.origem||"criar",a=A.query.id;d==="atualizar"?x.push(`/os/atualizar/${a}`):x.push("/os/criar-registro")};return(d,a)=>{const z=Be,ie=je,ue=Ie,qe=Ke,Oe=te;return C(),K(le,null,{default:o(()=>[e(M,{class:"mt-5"},{default:o(()=>[e(R,{cols:"3"},{default:o(()=>[e(Y,{label:"Documento",modelValue:t(y).documento,"onUpdate:modelValue":a[0]||(a[0]=T=>t(y).documento=T)},null,8,["modelValue"])]),_:1}),e(R,{cols:"4"},{default:o(()=>[e(Y,{label:"Pessoa",modelValue:t(y).nome,"onUpdate:modelValue":a[1]||(a[1]=T=>t(y).nome=T)},null,8,["modelValue"])]),_:1}),_("div",null,[_("img",{class:"mt-3",src:se,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:ke})]),_("div",null,[_("img",{class:"mt-3 ml-2",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:$e})])]),_:1}),e(M,null,{default:o(()=>[e(R,{cols:"4"},{default:o(()=>[e(re,{label:"Selecione a Pessoa",modelValue:t(y).pessoa,"onUpdate:modelValue":a[2]||(a[2]=T=>t(y).pessoa=T),items:t(w),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(R,{cols:"3"},{default:o(()=>[e(re,{label:"Papel",modelValue:t(y).papeis,"onUpdate:modelValue":a[3]||(a[3]=T=>t(y).papeis=T),items:t(N),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),_("div",null,[_("img",{class:"mt-3",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Ve}),t(F)?(C(),j("img",{key:0,class:"mt-0 ml-2",src:se,style:{width:"40px",cursor:"pointer"},title:"Visualizar Ficha",onClick:a[4]||(a[4]=T=>c.value=!0)})):(C(),j("img",et))])]),_:1}),e(M,null,{default:o(()=>[e(R,null,{default:o(()=>[e(fe,{style:{height:"465px"},headers:b,items:t(m)},{"item.actions":o(({item:T})=>[e(M,null,{default:o(()=>[_("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>Ee(T),title:"Visualizar Ficha"},a[9]||(a[9]=[_("img",{style:{width:"30px",height:"30px"},src:se,alt:"Visualizar"},null,-1)]),8,tt),_("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Ae(T),class:"mr-2",title:"Alterar Papel"},a[10]||(a[10]=[_("img",{style:{width:"30px",height:"30px"},src:He,alt:"Visualizar"},null,-1)]),8,ot),_("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Se(T),title:"Deletar Pessoa"},[T.excluido?(C(),j("img",st)):(C(),j("img",rt))],8,at),_("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>Pe(T),title:"Selecionar Representante"},a[11]||(a[11]=[_("img",{style:{width:"30px",height:"30px"},src:Ne,alt:"Visualizar"},null,-1)]),8,nt)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(z,{show:t(u),onClose:a[5]||(a[5]=T=>u.value=!1)},null,8,["show"]),e(ie,{representante_nome:t(s),representantes:t(g),ato_id:t(n),show:t(r),onClose:a[6]||(a[6]=T=>r.value=!1),onUpdateRepresentante:Ce},null,8,["representante_nome","representantes","ato_id","show"]),e(ue,{representante_nome:t(s),ato_token:h.ato_token,ato_id:t(n),show:t(E),onClose:a[7]||(a[7]=T=>E.value=!1),onUpdatePapel:we},null,8,["representante_nome","ato_token","ato_id","show"]),e(qe,{show:t(c),item:t(y).pessoa,"is-view":!0,onClose:a[8]||(a[8]=T=>c.value=!1)},null,8,["show","item"]),e(M,null,{default:o(()=>[e(Oe,{onClick:Te},{default:o(()=>[e(G,{size:"large",color:"red"},{default:o(()=>a[12]||(a[12]=[L("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},lt={key:0,class:"loading-overlay"},it="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Ft={__name:"Minuta",props:{ato_token:{type:String,required:!0}},emits:["page","doc"],setup(W,{emit:f}){const v=W;De("DocumentEditorContainer",[Ue,Fe]);const h=Z(),{$toast:x}=X(),A=H(),k=Q(),V=f;be(`${h.public.docEditor}`);const I=`${h.public.managemant}/upload`,q=i(null),B=i(!1),D=async()=>{const u=await q.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),c=new FileReader;c.onload=()=>{const E=c.result;V("doc",E)},c.readAsText(u)},S=async()=>{B.value=!0;try{const u=await q.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),c=new FormData;c.append("file",u,"anexo.docx"),c.append("cartorio_token",P("user-data").value.cartorio_token),c.append("token",v.ato_token),c.append("tipo","ato_minuta");const{data:E,status:g}=await $(I,{method:"POST",body:c},"$071xxdqs20");if(g.value==="success"){x.success("Documento enviado!");const n=q.value.ej2Instances.documentEditor.pageCount;D(),V("page",n)}else x.error("Erro ao enviar documento para o sistema.")}catch(r){x.error("Erro ao salvar documento."),console.error(r)}finally{B.value=!1}},O=async()=>{m(!0);try{await U(),m(!0);const{data:r,status:u}=await $(substituirModelo,{method:"POST",body:{ato_token:v.ato_token}},"$0ktpWliD4l");r.value&&w(r.value)}catch(r){console.error("Erro ao gerar a minuta:",r),x.error("Ocorreu um erro ao gerar a minuta.")}finally{m(!1)}},U=async()=>{try{const{data:r}=await $(baixarDocumento,{method:"POST",body:{bucket:P("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$jXVvQjEE6u"),u=await fetchBlobFromMinIO(r.value);if(u){const c=new FileReader;c.onload=()=>{const E=c.result;q.value.ej2Instances.documentEditor.open(E),V("doc",E)},c.readAsText(u)}}catch(r){console.error("Erro ao carregar o modelo de minuta:",r),x.error("Falha ao carregar o modelo de minuta.")}},w=r=>{const u=q.value.ej2Instances.documentEditor,c=E=>{for(const[g,s]of Object.entries(E))if(/^<<.+>>$/.test(g))try{u.search.findAll(g),u.search.searchResults.length>0&&u.search.searchResults.replaceAll(s)}catch(n){console.error(`Erro ao substituir o marcador ${g}:`,n)}else if(g==="partes"&&Array.isArray(s)&&s.length>0)for(const n of s)typeof n=="object"&&c(n)};c(r)},m=r=>{B.value=r},N=()=>{const r=k.query.origem||"criar",u=k.query.id;r==="atualizar"?A.push(`/os/atualizar/${u}`):A.push("/os/criar-registro")};return(r,u)=>{const c=te;return C(),j(he,null,[e(t(xe),{height:"900px",ref_key:"documentEditorContainer",ref:q,serviceUrl:it,enableToolbar:!0,enableWordExport:!0},null,512),t(B)?(C(),j("div",lt,[e(Re,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):ye("",!0),e(M,{class:"ml-4 mt-4 mb-4"},{default:o(()=>[e(c,{class:"mr-4"},{default:o(()=>[e(G,{size:"large",onClick:N,color:"red"},{default:o(()=>u[0]||(u[0]=[L("Voltar")])),_:1})]),_:1}),e(G,{size:"large",color:"green",onClick:S,disabled:t(B)},{default:o(()=>u[1]||(u[1]=[L("Salvar")])),_:1},8,["disabled"]),e(G,{class:"ml-4",size:"large",color:"blue",onClick:O},{default:o(()=>u[2]||(u[2]=[L("Gerar Minuta")])),_:1})]),_:1})],64)}}},ut=["innerHTML"],Lt={__name:"Livro",props:{ato_token:{type:String,required:!0},pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(W){let f,v;const h=W,x=Z();be(`${x.public.docEditor}`);const{$toast:A}=X(),k=H(),V=Q(),I=`${x.public.managemant}/listarEscrevente`,q=`${x.public.managemant}/lavrarAto`,B=i("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),D=i(!1),S=i(null),O=i(null),U=i(null),w=i(P("user-data").value.cartorio_token),m=P("auth_token").value,N=i([]),r=oe({escrevente:null}),u=async()=>{try{const{data:n,status:p}=await $(q,{method:"POST",body:{ato_token:h.ato_token,qtd_paginas:h.pages,escrevente_token:r.escrevente,usuario_token:m,cartorio_token:w}},"$ZKnVBNYxp9");p.value==="success"?(S.value=n.value,O.value=n.value[0].selo,A.success("Ato lavrado com sucesso!")):A.error("Falha ao lavrar o ato.")}catch{A.error("Erro ao conectar com o servidor.")}},c=()=>{D.value=!1,u()},{data:E}=([f,v]=ee(()=>$(I,{method:"POST",body:{cartorio_token:w}},"$XouuxOFIWh")),f=await f,v(),f);N.value=E.value[0].func_json_escreventes;const g=function(){U.value.ej2Instances.documentEditor.open(h.document)},s=()=>{const n=V.query.origem||"criar",p=V.query.id;n==="atualizar"?k.push(`/os/atualizar/${p}`):k.push("/os/criar-registro")};return(n,p)=>{const l=Qe;return C(),j(he,null,[e(M,null,{default:o(()=>[e(R,null,{default:o(()=>[(C(),K(t(xe),{restrictEditing:!0,enableToolbar:!1,created:h.document?g:null,ref_key:"documentEditorContainer",ref:U,height:"850px",width:"850px",key:h.document},null,8,["created"]))]),_:1}),e(R,null,{default:o(()=>[e(re,{class:"mt-15",label:"Tabelião/escrevente",modelValue:t(r).escrevente,"onUpdate:modelValue":p[0]||(p[0]=b=>t(r).escrevente=b),items:t(N),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),_("div",null,[_("div",null,[_("img",{onClick:p[1]||(p[1]=b=>D.value=!0),class:"ml-2",style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Le}),t(S)?(C(),K(Xe,{key:0,class:"mr-16"},{default:o(()=>[e(M,{"no-gutters":""},{default:o(()=>[e(R,null,{default:o(()=>[e(ge,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:o(()=>[e(R,null,{default:o(()=>[L(" Livro: "+ae(t(S)[0].livro_numero),1)]),_:1}),e(R,null,{default:o(()=>[L(" Protocolo: "+ae(t(S)[0].protocolo?t(S)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),e(R,null,{default:o(()=>[e(ge,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:o(()=>[L(" Folhas : "+ae(t(S)[0].pagina_inicial)+" A "+ae(t(S)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),_("div",{innerHTML:t(O)},null,8,ut)]),_:1})):ye("",!0)])])]),_:1})]),_:1}),e(G,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:s},{default:o(()=>p[3]||(p[3]=[L("Voltar")])),_:1}),e(l,{show:t(D),condMessage:t(B),onClose:p[2]||(p[2]=b=>D.value=!1),onConfirm:c},null,8,["show","condMessage"])],64)}}},ct=["onClick"],dt={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},mt={key:1,src:ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Wt={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(W){let f,v;const h=W,x=H(),A=Q(),k=Z(),{$toast:V}=X(),I=`${k.public.managemant}/listarEscrevente`,q=`${k.public.managemant}/getAtosTiposByToken`,B=`${k.public.managemant}/atos_observacao`,D=`${k.public.managemant}/atos_observacao`,S=i(P("user-data").value.cartorio_token),O=i([]),U=i([]),w=[{title:"Data",align:"start",key:"data"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],m=oe({observacao:null}),N={observacao:{required:de.withMessage("O campo é obrigatorio",me)}},r=pe(N,m);[f,v]=ee(()=>$(`${q}/${h.ato_token}`,{method:"GET"},"$aJM1TL1buW")),f=await f,v();async function u(){if(await r.value.$validate()){const{data:s,error:n,status:p}=await $(B,{method:"POST",body:{ato_id:h.ato_id,observacao:m.observacao,user_id:P("user-data").value.usuario_id}},"$dMg99jeUNP");p.value==="success"&&(O.value.push({data:Ze(s.value.created,"dd/mm/yyyy hh:mm"),observacao:s.value.observacao,id:s.value.id,escrevente:P("user-data").value.nome}),V.success("Observação registrada com sucesso"))}else V.error("Preencha os campos obrigatorios.")}async function c(s){s.excluido=!s.excluido;try{await $(`${D}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$B6PdRx8Gp4")}catch(n){console.error("Erro ao excluir observacao:",n)}}const{data:E}=([f,v]=ee(()=>$(I,{method:"POST",body:{cartorio_token:S}},"$xFHPGua26S")),f=await f,v(),f);U.value=E.value[0].func_json_escreventes;const g=()=>{const s=A.query.origem||"criar",n=A.query.id;s==="atualizar"?x.push(`/os/atualizar/${n}`):x.push("/os/criar-registro")};return(s,n)=>{const p=te;return C(),K(le,null,{default:o(()=>[e(M,{class:"mt-5"},{default:o(()=>[e(Y,{label:"Observação",modelValue:t(m).observacao,"onUpdate:modelValue":n[0]||(n[0]=l=>t(m).observacao=l),required:"","error-messages":t(r).observacao.$errors.map(l=>l.$message),onBlur:t(r).observacao.$touch,onInput:t(r).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),_("div",null,[_("img",{class:"btn-pointer ml-2",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:u})])]),_:1}),e(M,null,{default:o(()=>[e(R,null,{default:o(()=>[e(fe,{style:{height:"465px"},headers:w,items:t(O)},{"item.actions":o(({item:l})=>[_("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:b=>c(l),title:"Deletar Observação"},[l.excluido?(C(),j("img",dt)):(C(),j("img",mt))],8,ct)]),_:1},8,["items"])]),_:1})]),_:1}),e(M,null,{default:o(()=>[e(p,{onClick:g},{default:o(()=>[e(G,{size:"large",color:"red"},{default:o(()=>n[1]||(n[1]=[L("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},pt={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:We,alt:"Criar"},_t={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ge,alt:"Criar"},vt={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Je,alt:"Criar"},ft=["onClick"],gt=["onClick"],yt=["onClick"],ht={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},bt={key:1,src:ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Gt={__name:"Anexos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},setup(W){const f=W,v=Z(),{$toast:h}=X(),x=H(),A=Q(),k=`${v.public.biometria}/run-scanner`,V=`${v.public.managemant}/atos_anexos`,I=`${v.public.managemant}/atos_anexos`,q=`${v.public.managemant}/download`;`${v.public.managemant}`,`${v.public.managemant}`;const B=i(!1),D=i(null),S=i([]);P("pessoa_token");const O=oe({descricao:"",fileEvent:null}),U={descricao:{required:de.withMessage("O campo é obrigatório",me)}},w=pe(U,O,{$autoDirty:!0}),m=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}];async function N(){try{await r(),await u()}catch(l){console.error("Erro ao executar scanner ou listar arquivos:",l)}}async function r(){try{const{data:l}=await $(k,{method:"GET"},"$WazoKp68Tw")}catch(l){h.error("Erro ao acionar o scanner:",l)}}async function u(){try{const{data:l,status:b}=await $("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:A.query.ato_token_edit,cartorio_token:P("user-data").value.cartorio_token}},"$03Wxiia3aI")}catch(l){console.error("Erro ao enviar o arquivo:",l)}}const c=async()=>{B.value=!0};function E(l){return l?!0:(console.error("Erro: Nenhum arquivo foi selecionado!"),D.value=!1,!1)}const g=async()=>{if(w.value.$touch(),!w.value.$invalid&&E(O.fileEvent)){const{data:l,error:b,status:y}=await $(V,{method:"POST",body:{ato_id:f.ato_id,descricao:O.descricao,user_id:P("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$WyW0hasRPI");y.value==="success"&&(h.success("Anexo registrado com sucesso!"),S.value.push(l.value))}};async function s(l){l.excluido=!l.excluido;try{await $(`${I}/${l.id}`,{method:"PUT",body:JSON.stringify({excluido:l.excluido})},"$Y3y6TjqbSV")}catch(b){console.error("Erro ao excluir pessoa:",b)}}async function n(l){try{const b=await $(`${q}`,{method:"POST",body:{bucket:P("user-data").value.cartorio_token,path:l.link}},"$bkXJSi7s76"),F=await(await fetch(b.data.value)).blob(),J=URL.createObjectURL(F);window.open(J,"_blank")}catch(b){console.error("Erro ao excluir pessoa:",b)}}const p=()=>{const l=A.query.origem||"criar",b=A.query.id;l==="atualizar"?x.push(`/os/atualizar/${b}`):x.push("/os/criar-registro")};return(l,b)=>{const y=te;return C(),K(le,null,{default:o(()=>[e(M,null,{default:o(()=>[e(R,{cols:"5",class:"mt-2"},{default:o(()=>[e(Y,{modelValue:t(O).descricao,"onUpdate:modelValue":[b[0]||(b[0]=F=>t(O).descricao=F),t(w).descricao.$touch],"error-messages":t(w).descricao.$errors.map(F=>F.$message),onBlur:t(w).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"])]),_:1}),_("div",{onClick:N,title:"Criar",style:{"padding-right":"10px"}},[t(D)===!1?(C(),j("img",pt)):t(D)===!0?(C(),j("img",_t)):(C(),j("img",vt))]),_("div",{onClick:g,title:"Criar"},b[1]||(b[1]=[_("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:ne,alt:"Escanear"},null,-1)]))]),_:1}),e(fe,{headers:m,items:t(S),style:{height:"465px","max-width":"600px"}},{"item.actions":o(({item:F})=>[e(M,null,{default:o(()=>[_("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:J=>c(F),title:"Visualizar Anexo"},[_("img",{style:{width:"30px",height:"30px"},onClick:J=>n(F),src:se,alt:"Visualizar"},null,8,gt)],8,ft),_("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:J=>s(F),title:"Deletar Pessoa"},[F.excluido?(C(),j("img",ht)):(C(),j("img",bt))],8,yt)]),_:2},1024)]),_:1},8,["items"]),e(y,{onClick:p},{default:o(()=>[e(G,{size:"large",color:"red"},{default:o(()=>b[2]||(b[2]=[L("Voltar")])),_:1})]),_:1})]),_:1})}}};export{It as _,Ut as a,Ft as b,Lt as c,Wt as d,Gt as e};
