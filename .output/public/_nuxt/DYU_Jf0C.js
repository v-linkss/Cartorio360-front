import{_ as go}from"./DRO-pVYM.js";import{_ as ho,a as wo}from"./FnR0jx_S.js";import{_ as Co}from"./9JufoEdw.js";import{_ as Ao}from"./B-5XaZRE.js";import{c as So,r as xo,u as Do}from"./IrCsQgMH.js";import{r as d,u as ao,m as C,n as eo,g as Oo,o as L,p as to,w as n,b as l,a as s,d as B,t as Uo,q as t,V as Q,s as To,v as lo,_ as Po,x as qo,y as Eo,z as Mo,c as Io,A as No,F as zo,B as x,C as c,D as Ro,E as F}from"./D7ENO5AD.js";import{u as b}from"./5esaczZp.js";import{V as W,a as Bo}from"./BRSUoOBh.js";import{V as j}from"./B2A0rb-z.js";import{V as E}from"./CfMx6KlI.js";import{V as Fo}from"./D-8tGulk.js";import{V as Jo}from"./Ds1d2W4B.js";import{_ as oo}from"./BvsrtV93.js";import{_ as Lo}from"./D8KEJPgO.js";import{_ as jo}from"./CXDJqYU6.js";import{_ as Ho}from"./DnD3CKoX.js";import{u as Go}from"./RE453Doa.js";import{f as q}from"./B0IxRygJ.js";import{V as Xo}from"./D8EBDzaJ.js";import{V as m}from"./CEvvklSZ.js";import{V as J}from"./Bv_dzn0g.js";import"./Cx2_1k0M.js";import"./BVz1G1IN.js";import"./DJvq3mCv.js";import"./D3WrJDqK.js";import"./jAxziKPi.js";import"./B7WBkq8M.js";import"./Cmy3_6E3.js";import"./I7ClkghD.js";import"./C9NLORQb.js";import"./B5dUHZgd.js";import"./BJNQpbcT.js";const Yo={class:"mb-5",style:{display:"flex","justify-content":"flex-start"}},Zo={class:"ml-6"},Ko={class:"ml-6"},Qo="O cancelamento de atos é definitivo e não pode ser revertido. Informe o motivo do cancelamento para confirmar",Wo={__name:"CancelamentoAto",props:{show:Boolean,ato_token:String},emits:["close"],setup(H,{emit:_}){const y=H,$=d(y.show),M=lo(),{$toast:g}=ao(),I=d(C("auth_token").value),D=`${M.public.managemant}/cancela_lavratura`,V=eo({motivo:null}),N=_,O={motivo:{required:So.withMessage("O campo é obrigatorio",xo)}},k=Do(O,V);Oo(()=>y.show,p=>{$.value=p});const h=()=>{$.value=!1,N("close")},A=async()=>{var p,i;if(await k.value.$validate())try{const{data:u,status:U}=await b(D,{method:"POST",body:{ato_token:y.ato_token,user_token:I.value,cancelar_selo:!1,motivo_cancelamento:V.motivo}},"$VPLGcUZMk8");U.value==="success"&&Array.isArray(u.value)&&((p=u.value[0])==null?void 0:p.status)==="OK"?(g.success("Ato cancelado com sucesso!"),h()):Array.isArray(u.value)&&((i=u.value[0])==null?void 0:i.status)==="ERRO"?g.error(u.value[0].status_mensagem||"Erro ao cancelar ato"):g.error("Erro inesperado ao cancelar ato")}catch(u){console.error("Erro ao cancelar ato:",u),g.error("Erro ao cancelar ato")}};return(p,i)=>(L(),to(Jo,{persistent:"",modelValue:t($),"onUpdate:modelValue":i[1]||(i[1]=u=>To($)?$.value=u:null),"max-width":"650"},{default:n(()=>[l(W,null,{default:n(()=>[l(j,null,{default:n(()=>[l(E,{class:"mb-5 mt-1 ml-2"},{default:n(()=>i[2]||(i[2]=[s("h1",null,"Cancelamento de Ato",-1),s("h1",{style:{color:"red","margin-left":"18px"}},null,-1)])),_:1}),l(j,null,{default:n(()=>[l(W,{variant:"outlined",class:"mb-5"},{default:n(()=>[l(Bo,null,{default:n(()=>[B(Uo(Qo))]),_:1})]),_:1}),l(Fo,{label:"Motivo",modelValue:t(V).motivo,"onUpdate:modelValue":i[0]||(i[0]=u=>t(V).motivo=u),required:"","error-messages":t(k).motivo.$errors.map(u=>u.$message),onBlur:t(k).motivo.$touch,onInput:t(k).motivo.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),s("div",Yo,[s("div",Zo,[l(Q,{size:"large",color:"red",onClick:h},{default:n(()=>i[3]||(i[3]=[B("Fechar")])),_:1})]),s("div",Ko,[l(Q,{size:"large",color:"green",disabled:!t(V).motivo||t(V).motivo.trim()==="",onClick:A},{default:n(()=>i[4]||(i[4]=[B(" Salvar ")])),_:1},8,["disabled"])])])]),_:1})]),_:1},8,["modelValue"]))}},oa={style:{width:"1300px",margin:"0 auto"}},aa={style:{display:"flex",gap:"4px","justify-content":"center"}},ea=["onClick"],ta=["onClick"],la=["onClick","title"],ra=["onClick"],na=["title"],sa=["onClick"],ia={__name:"index",setup(H){const _=lo(),{$toast:y}=ao(),$=`${_.public.managemant}/listarUsuarios`,M=`${_.public.managemant}/listar_tipo_atos`,g=`${_.public.biometria}/run-scanner?format=pdf`,I=`${_.public.envioDoc}/upload`;`${_.public.managemant}`;const D=`${_.public.managemant}/pesquisaAtos`,V=`${_.public.auth}/service/gerencia/lista_sit_atos`,N=C("auth_token"),{redirectTo:O}=Go(),k=d(C("auth_token").value)||null,h=d(C("user-data").value.cartorio_token)||null,A=d(!1),p=d([]),i=d([]),u=d([]),U=d([]),G=d(!1),X=d(!1),z=d(!1),Y=d(null),ro=d({}),R=d(!1),T=d(null),r=eo({numero:null,data_inicio:Z(),data_fim:Z(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:k.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),no=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:a=>a.protocolo?`${a.id}
${a.protocolo}`:`${a.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:a=>a.dt_abertura?`${a.dt_abertura}
${a.apresentante_cpf}`:`${a.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:a=>a.dt_lavratura?`${a.dt_lavratura}
${a.apresentante_nome}`:`${a.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:a=>a.situacao?`${a.situacao}
${a.ato_servico}`:`${a.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function Z(){const a=new Date,o=a.getFullYear(),v=String(a.getMonth()+1).padStart(2,"0");return`${String(a.getDate()).padStart(2,"0")}-${v}-${o}`}function w(a){if(!a)return null;const[o,v,f]=a.split("/");return`${f}-${v}-${o}`}async function K(){const a=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(a),{data:v}=await b(D,{method:"POST",body:{cartorio_token:C("user-data").value.cartorio_token,usuario_token:o.usuario_token||k.value,data_fim:w(o==null?void 0:o.data_fim),data_inicio:w(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");v.value.length>0&&(p.value=v.value.map(f=>({...f,dt_lavratura:f.dt_lavratura?q(f.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:q(f.dt_abertura,"dd/mm/yyyy")})))}async function so(){const{data:a}=await b($,{method:"POST",body:{cartorio_token:h.value}},"$hvipqUJYtS");i.value=a.value}async function io(){const{data:a,error:o}=await b(V,{method:"GET",headers:{Authorization:`Bearer ${N.value}`}},"$OjamgBH6nj");U.value=a.value}async function uo(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(r));const{data:a}=await b(D,{method:"POST",body:{cartorio_token:h.value,numero_os:r.numero||null,data_inicio:w(r.data_inicio)||null,data_fim:w(r.data_fim)||null,data_lavratura_inicio:w(r.data_lavratura_inicio)||null,data_lavratura_fim:w(r.data_lavratura_fim)||null,protocolo:r.protocolo||null,livro:r.livro||null,folha:r.folha||null,situacao:r.situacao||null,usuario_token:r.usuario_token,selo:r.selo||null,ato_tipo_token:r.ato_tipo_token,parte:r.parte||null}},"$QxIfw0Zxe4");a.value.length>0?p.value=a.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?q(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?q(o.dt_abertura,"dd/mm/yyyy"):null})):(p.value=[],y.error("Não existe ato Registrado!"))}catch(a){console.error("Erro na requisição",a)}}const mo=a=>{O({item:a,id:a.id,numeroOs:a.numero_os,origem:"vizualizar-lista"})};async function co(){const{data:a,error:o}=await b(M,{method:"POST",body:{cartorio_token:h.value,usuario_token:k.value,tipo_retorno:"servico_ato"}},"$ceiptlfDNO");u.value=a.value}const po=a=>{T.value=a,R.value=!0};function _o(a){Y.value=a.numero,T.value=a.token,z.value=!0}const vo=a=>{O({item:a,id:a.id,numeroOs:a.numero_os,origem:"atualizar-lista"})},fo=async a=>{try{await Vo(),await yo(a)}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}};async function yo(a){try{const{status:o,data:v}=await b(I,{method:"POST",body:{tipo:"ato_livro",token:a,cartorio_token:C("user-data").value.cartorio_token}},"$zTNfED00Fu");o.value==="success"&&y.success("Arquivo enviado com sucesso!")}catch(o){y.error(o),console.error("Erro ao enviar o arquivo:",o)}}async function Vo(){try{const{data:a}=await b(g,{method:"GET"},"$hJse5XXJsY")}catch(a){y.error("Erro ao acionar o scanner:",a)}}return qo(()=>{Eo(async()=>{const a=sessionStorage.getItem("pesquisaAto");if(a){const o=JSON.parse(a);Object.assign(r,o)}await K()})}),so(),co(),io(),(a,o)=>{const v=go,f=ho,ko=Co,bo=Ao,$o=Wo,S=Mo("mask");return L(),Io(zo,null,[l(j,{class:"mt-5"},{default:n(()=>[l(E,{class:"mb-5"},{default:n(()=>o[20]||(o[20]=[s("h1",null,"Atos",-1)])),_:1}),l(E,null,{default:n(()=>[l(m,{cols:"2"},{default:n(()=>[x(l(c,{modelValue:t(r).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=e=>t(r).data_inicio=e),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[S,"##/##/####"]])]),_:1}),l(m,{cols:"2"},{default:n(()=>[x(l(c,{modelValue:t(r).data_fim,"onUpdate:modelValue":o[1]||(o[1]=e=>t(r).data_fim=e),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[S,"##/##/####"]])]),_:1}),l(m,{cols:"2"},{default:n(()=>[x(l(c,{modelValue:t(r).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=e=>t(r).data_lavratura_inicio=e),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[S,"##/##/####"]])]),_:1}),l(m,{cols:"2"},{default:n(()=>[x(l(c,{modelValue:t(r).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=e=>t(r).data_lavratura_fim=e),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[S,"##/##/####"]])]),_:1}),l(m,{cols:"2"},{default:n(()=>[l(c,{modelValue:t(r).numero,"onUpdate:modelValue":o[4]||(o[4]=e=>t(r).numero=e),label:"N° OS"},null,8,["modelValue"])]),_:1}),l(m,{cols:"2"},{default:n(()=>[l(c,{modelValue:t(r).selo,"onUpdate:modelValue":o[5]||(o[5]=e=>t(r).selo=e),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),l(E,null,{default:n(()=>[l(m,{cols:"2"},{default:n(()=>[l(c,{modelValue:t(r).protocolo,"onUpdate:modelValue":o[6]||(o[6]=e=>t(r).protocolo=e),label:"Protocolo"},null,8,["modelValue"])]),_:1}),l(m,{cols:"2"},{default:n(()=>[x(l(c,{modelValue:t(r).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=e=>t(r).apresentante_cpf=e),label:"CPF",dense:""},null,8,["modelValue"]),[[S,"###.###.###-##"]])]),_:1}),l(m,{cols:"3"},{default:n(()=>[l(c,{modelValue:t(r).parte,"onUpdate:modelValue":o[8]||(o[8]=e=>t(r).parte=e),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),l(m,{cols:"3"},{default:n(()=>[l(J,{modelValue:t(r).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=e=>t(r).ato_tipo_token=e),items:t(u),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),l(m,{cols:"2"},{default:n(()=>[l(J,{items:t(i),modelValue:t(r).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=e=>t(r).usuario_token=e),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),l(m,{md:"3"},{default:n(()=>[l(J,{modelValue:t(r).situacao,"onUpdate:modelValue":o[11]||(o[11]=e=>t(r).situacao=e),items:t(U),"item-title":"descricao","item-value":"descricao",label:"Situação"},null,8,["modelValue","items"])]),_:1}),l(m,{cols:"1"},{default:n(()=>[l(c,{modelValue:t(r).livro,"onUpdate:modelValue":o[12]||(o[12]=e=>t(r).livro=e),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),l(m,{cols:"1"},{default:n(()=>[l(c,{modelValue:t(r).folha,"onUpdate:modelValue":o[13]||(o[13]=e=>t(r).folha=e),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),l(m,null,{default:n(()=>[s("div",null,[s("img",{onClick:uo,style:{width:"40px",height:"40px",cursor:"pointer"},src:oo,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),s("div",oa,[o[24]||(o[24]=s("hr",{class:"mt-5 mb-5"},null,-1)),l(Xo,{headers:no,items:t(p),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":n(({item:e})=>[s("div",aa,[s("div",{onClick:P=>mo({id:e.id,tipo:`${e.tipo_servico} - ${e.tipo_ato}`,token:e.token,tipo_token:e.tipo_token,rota:e.rota,numero_os:e.numero_os}),title:"Visualizar"},o[21]||(o[21]=[s("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:oo,alt:"Visualizar"},null,-1)]),8,ea),s("div",{onClick:P=>po(e.token),title:"Reimprimir"},o[22]||(o[22]=[s("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:wo,alt:"Reimprimir"},null,-1)]),8,ta),s("div",{class:Ro({disabled:!e.btn_editar}),onClick:P=>e.btn_editar?vo({id:e.id,tipo:`${e.tipo_servico} - ${e.tipo_ato}`,token:e.token,tipo_token:e.tipo_token,rota:e.rota,numero_os:e.numero_os}):null,title:e.btn_editar?"Editar":"Desabilitado"},[s("img",{style:F({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:Lo,alt:"Editar"},null,4)],10,la),s("div",{onClick:P=>e.btn_cancelar?_o(e):null,title:"Excluir",style:F({cursor:e.btn_cancelar?"pointer":"not-allowed"})},[s("img",{style:F({width:"30px",height:"30px",cursor:e.btn_cancelar?"pointer":"not-allowed",opacity:e.btn_cancelar?"1":"0.5"}),src:jo,alt:"Cancelar",title:e.btn_cancelar?"Cancelar":"Não permitido"},null,12,na)],12,ra),s("div",{onClick:P=>fo(e.token)},o[23]||(o[23]=[s("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:Ho,alt:"escanear",title:"escanear"},null,-1)]),8,sa)])]),_:1},8,["items"])]),t(A)?(L(),to(v,{key:0,show:t(A),servicos:a.dadosData.servicos||[],tiposAtos:a.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=e=>A.value=!1),onUpdateAto:a.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):No("",!0),l(f,{show:t(R),ato_token:t(T),onClose:o[15]||(o[15]=e=>R.value=!1)},null,8,["show","ato_token"]),l(ko,{show:t(G),numero_os:t(Y),ordem:t(ro),onClose:o[16]||(o[16]=e=>G.value=!1),onRefreshValue:o[17]||(o[17]=e=>K())},null,8,["show","numero_os","ordem"]),l(bo,{show:t(X),condMessage:a.condMessage,onClose:o[18]||(o[18]=e=>X.value=!1),onConfirm:a.cancelaAto},null,8,["show","condMessage","onConfirm"]),l($o,{show:t(z),ato_token:t(T),onClose:o[19]||(o[19]=e=>z.value=!1)},null,8,["show","ato_token"])],64)}}},Ba=Po(ia,[["__scopeId","data-v-34c9045f"]]);export{Ba as default};
