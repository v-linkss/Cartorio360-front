import{_ as be}from"./BcHthQep.js";import{_ as ge}from"./M5FLVeI7.js";import{c as me,r as pe,u as Ce}from"./0X1jLeZq.js";import{D as ye,u as $e,r as u,m as Z,A as ie,E as ne,n as Ie,v as a,o as x,c as ue,b as l,L as Ue,q as T,w as o,V as y,a as m,H as O,d as q,s as ke,F as J,g as Te,I as ce}from"./FnxYlhN9.js";import{u as k}from"./CNpItiIB.js";import{V as P}from"./DW5UIibG.js";import{V as n}from"./CjEmkOQ1.js";import{V as qe}from"./Dd1XdZrD.js";import{V as I}from"./CQyFm3_L.js";import{V as re}from"./Jbm2bR8t.js";import{_ as Be,d as Me,V as ze,a as _e,b as Oe,c as fe}from"./jcSCV8X9.js";import{b as Se}from"./Bei_CKU4.js";import{_ as ve}from"./B6hM5Vqj.js";import{_ as Ve,a as Ae,b as De,c as Ne}from"./CtKhqYlz.js";import{V as Re}from"./B8MkFSEx.js";import{V as Pe,a as xe}from"./CPX67p8K.js";const je={key:0,class:"d-flex justify-center"},Ee={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal"],async setup(S,{emit:A}){let c,v;const V=S,b=A,$=ye(),g=ke(),{$toast:C}=$e(),{id:B}=$.params,_=`${g.public.managemant}/atos_bens`,D=`${g.public.managemant}/atos_bens`,N=`${g.public.managemant}/atos_bens`,w=`${g.public.managemant}/registro_imoveis`,h=`${g.public.managemant}/natureza_imoveis`,M=`${g.public.managemant}/tipo_logradouros`,R=`${g.public.managemant}/situacao_imoveis`,j=`${g.public.managemant}/listarCidades`,E=`${g.public.managemant}/listarTipoBens`,U=u(Z("user-data").value.cartorio_token),F=u(Z("user-data").value.usuario_id).value,L=u([]),H=u([]),W=u([]),z=u([]),K=u([]),r=u([]);u(!1);const G=u(!0),s=ie({vlr_alienacao:null,tabvalores_tipo_regimovel_id:null,registro_cartorio:null,registro_matricula:null,registro_matricula_letra:null,tabvalores_nat_imovel_id:null,cib:null,end_cidade_id:null,end_quadra:null,end_lote:null,tabvalores_tipologradouro_id:null,end_logradouro:null,end_logradouro_numero:null,end_bairro:null,end_cep:null,end_complemento:null,tipo_id:null,descricao:null,inscricao_estadual:null,tabvalores_situacao_imoveis_id:null,tipo_id:null,vlr_alienacao:null,vlr_mercado:null,valor_mercado:"0.00",aliq_itbi:null,vlr_itbi:null,user_id:F,ato_id:Number($.query.ato_id)||Number(V.ato_id)}),Q=ie({...s}),ee={descricao:{required:me.withMessage("O campo é obrigatório",pe)},tipo_id:{required:me.withMessage("O campo é obrigatório",pe)}},Y=Ce(ee,s),le=async()=>{if(!await Y.value.$validate()){C.error("Preencha todos os campos obrigatórios!");return}const{status:e}=await k(`${_}`,{method:"POST",body:s},"$0Mdv6RF9cH");e.value==="success"&&(C.success("Imovel criado com sucesso!"),b("saved"))},{data:ae}=([c,v]=ne(()=>k(`${E}`,{method:"POST",body:{cartorio_token:U.value,imoveis:!0}},"$H1S2cTYpdB")),c=await c,v(),c);if(r.value=ae.value,V.isUpdate===!0){const{data:i}=([c,v]=ne(()=>k(`${D}/${V.imovel_id}`,{method:"GET"},"$jHrIlABk8l")),c=await c,v(),c);i.value&&Object.keys(s).forEach(e=>{i.value[e]!==void 0&&(s[e]=i.value[e])}),Object.assign(Q,s)}async function oe(){try{const[i,e,p,f,t]=await Promise.all([$fetch(h),$fetch(w),$fetch(R),$fetch(M),$fetch(j)]);H.value=i,L.value=e,K.value=p,W.value=f,z.value=t}catch(i){console.error("Erro ao carregar os dados de imoveis pessoa:",i)}finally{G.value=!1}}const te=async i=>{const e={};if(Object.keys(s).forEach(f=>{s[f]!==Q[f]&&(e[f]=s[f])}),Object.keys(e).length===0)return;const{status:p}=await k(`${N}/${i}`,{method:"PUT",body:e},"$GHkpnZRexD");p.value==="success"&&(C.success("Imovel Atualizado com sucesso!"),b("close-modal"))},se=()=>{b("close-modal")};return Ie(()=>{B||V.ato_id?oe():G.value=!1}),(i,e)=>{const p=be,f=ge;return a(G)?(x(),ue("div",je,[l(Ue,{indeterminate:"",class:"loading-spinner",size:"64"})])):(x(),T(re,{key:1},{default:o(()=>[l(P,null,{default:o(()=>[l(n,{class:"mt-5",cols:"12"},{default:o(()=>[l(qe,{label:"Descrição",modelValue:a(s).descricao,"onUpdate:modelValue":e[0]||(e[0]=t=>a(s).descricao=t),"error-messages":a(Y).descricao.$errors.map(t=>t.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),l(P,null,{default:o(()=>[l(n,{cols:"3"},{default:o(()=>[l(I,{label:"Tipo de Registro",modelValue:a(s).tabvalores_tipo_regimovel_id,"onUpdate:modelValue":e[1]||(e[1]=t=>a(s).tabvalores_tipo_regimovel_id=t),items:a(L),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"2"},{default:o(()=>[l(y,{label:"Cartório",modelValue:a(s).registro_cartorio,"onUpdate:modelValue":e[2]||(e[2]=t=>a(s).registro_cartorio=t)},null,8,["modelValue"])]),_:1}),l(n,{cols:"2"},{default:o(()=>[l(y,{label:"Matricula",modelValue:a(s).registro_matricula,"onUpdate:modelValue":e[3]||(e[3]=t=>a(s).registro_matricula=t)},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[l(y,{label:"Letra",modelValue:a(s).registro_matricula_letra,"onUpdate:modelValue":e[4]||(e[4]=t=>a(s).registro_matricula_letra=t)},null,8,["modelValue"])]),_:1}),l(n,{cols:"2"},{default:o(()=>[l(I,{label:"Natureza",modelValue:a(s).tabvalores_nat_imovel_id,"onUpdate:modelValue":e[5]||(e[5]=t=>a(s).tabvalores_nat_imovel_id=t),items:a(H),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"1"},{default:o(()=>[l(y,{label:"CIB",modelValue:a(s).cib,"onUpdate:modelValue":e[6]||(e[6]=t=>a(s).cib=t)},null,8,["modelValue"])]),_:1})]),_:1}),l(P,null,{default:o(()=>[l(n,{cols:"3"},{default:o(()=>[l(I,{label:"Cidade",modelValue:a(s).end_cidade_id,"onUpdate:modelValue":e[7]||(e[7]=t=>a(s).end_cidade_id=t),items:a(z),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"2"},{default:o(()=>[l(y,{label:"Quadra",modelValue:a(s).end_quadra,"onUpdate:modelValue":e[8]||(e[8]=t=>a(s).end_quadra=t)},null,8,["modelValue"])]),_:1}),l(n,{cols:"2"},{default:o(()=>[l(y,{label:"Lote",modelValue:a(s).end_lote,"onUpdate:modelValue":e[9]||(e[9]=t=>a(s).end_lote=t)},null,8,["modelValue"])]),_:1}),l(n,{cols:"4"},{default:o(()=>[l(I,{label:"Logradouro",modelValue:a(s).tabvalores_tipologradouro_id,"onUpdate:modelValue":e[10]||(e[10]=t=>a(s).tabvalores_tipologradouro_id=t),items:a(W),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"1"},{default:o(()=>[l(y,{label:"N*",modelValue:a(s).end_logradouro_numero,"onUpdate:modelValue":e[11]||(e[11]=t=>a(s).end_logradouro_numero=t)},null,8,["modelValue"])]),_:1})]),_:1}),l(P,null,{default:o(()=>[l(n,null,{default:o(()=>[l(y,{label:"Bairro",modelValue:a(s).end_bairro,"onUpdate:modelValue":e[12]||(e[12]=t=>a(s).end_bairro=t)},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[l(y,{label:"CEP",modelValue:a(s).end_cep,"onUpdate:modelValue":e[13]||(e[13]=t=>a(s).end_cep=t)},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[l(y,{label:"Complemento",modelValue:a(s).end_complemento,"onUpdate:modelValue":e[14]||(e[14]=t=>a(s).end_complemento=t)},null,8,["modelValue"])]),_:1}),l(n,{cols:"3"},{default:o(()=>[l(I,{modelValue:a(s).tipo_id,"onUpdate:modelValue":e[15]||(e[15]=t=>a(s).tipo_id=t),items:a(r),label:"Tipo de imovel","item-title":"descricao","item-value":"id","error-messages":a(Y).tipo_id.$errors.map(t=>t.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),l(n,{cols:"3"},{default:o(()=>[l(y,{label:"Inscrição Municipal"})]),_:1})]),_:1}),l(P,null,{default:o(()=>[l(n,{class:"mt-6",cols:"4"},{default:o(()=>[l(I,{label:"Situação",items:a(K),"item-title":"descricao","item-value":"id"},null,8,["items"])]),_:1}),l(n,{cols:"2"},{default:o(()=>[e[22]||(e[22]=m("label",null,"Valor Alienação",-1)),l(p,{label:"Valor Alienação",modelValue:a(s).vlr_alienacao,"onUpdate:modelValue":e[16]||(e[16]=t=>a(s).vlr_alienacao=t)},null,8,["modelValue"])]),_:1}),l(n,{cols:"2"},{default:o(()=>[e[23]||(e[23]=m("label",null,"Valor Avaliação",-1)),l(p,{label:"Valor Avaliação",modelValue:a(s).vlr_avaliacao,"onUpdate:modelValue":e[17]||(e[17]=t=>a(s).vlr_avaliacao=t)},null,8,["modelValue"])]),_:1}),l(n,{cols:"2"},{default:o(()=>[e[24]||(e[24]=m("label",null,"Valor Mercado",-1)),l(p,{label:"Valor Mercado",modelValue:a(s).vlr_mercado,"onUpdate:modelValue":e[18]||(e[18]=t=>a(s).vlr_mercado=t)},null,8,["modelValue"])]),_:1}),l(n,{cols:"1"},{default:o(()=>[e[25]||(e[25]=m("label",null,"%ITB",-1)),l(p,{label:"%ITB",modelValue:a(s).aliq_itbi,"onUpdate:modelValue":e[19]||(e[19]=t=>a(s).aliq_itbi=t)},null,8,["modelValue"])]),_:1}),l(n,{cols:"1"},{default:o(()=>[e[26]||(e[26]=m("label",null,"Valor ITB",-1)),l(p,{label:"Valor ITB",modelValue:a(s).vlr_itbi,"onUpdate:modelValue":e[20]||(e[20]=t=>a(s).vlr_itbi=t)},null,8,["modelValue"])]),_:1})]),_:1}),l(P,{class:"mt-10"},{default:o(()=>[l(f,{onClick:se},{default:o(()=>[l(O,{size:"large",color:"red"},{default:o(()=>e[27]||(e[27]=[q("Voltar")])),_:1})]),_:1}),S.isUpdate?(x(),T(O,{key:0,class:"ml-5",size:"large",color:"green",onClick:e[21]||(e[21]=t=>te(V.imovel_id))},{default:o(()=>e[28]||(e[28]=[q("Atualizar")])),_:1})):(x(),T(O,{key:1,class:"ml-5",size:"large",color:"green",onClick:le},{default:o(()=>e[29]||(e[29]=[q("Salvar")])),_:1}))]),_:1})]),_:1}))}}},Fe=["onClick"],Le=["onClick"],He=["onClick"],Ge={key:0,style:{width:"30px",height:"30px"},src:De,alt:"Visualizar",title:"Reativar"},Ye={key:1,src:Ne,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},We={__name:"Partes",emits:["saved","close-modal"],async setup(S,{emit:A}){let c,v;const V=A,b=ye(),$=ke(),{$toast:g}=$e(),C=`${$.public.managemant}/pesquisarPessoas`,B=`${$.public.managemant}/listarPapeis`,_=`${$.public.managemant}/getLinkTipo`,D=`${$.public.managemant}/bens_pessoa`;`${$.public.managemant}`;const N=`${$.public.managemant}/getAtosPessoaById`,w=`${$.public.managemant}/download`,h=u(Z("user-data").value.cartorio_token),M=u([]),R=u([]),j=u([]),E=u(!1),U=u(!1),F=u(!1),L=u(null),H=u(null),W=u(b.query.tipo_ato_token),z=u(null),K=[{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"%",align:"start",key:"percentual.percentual"},{value:"actions"}],r=ie({papeis:null,percentual:null,pessoa:null,documento:null}),{data:G}=([c,v]=ne(()=>k(B,{method:"POST",body:{tipo_ato_token:b.query.tipo_ato_token}},"$X6FDd5A6WK")),c=await c,v(),c);j.value=G.value;const s=async()=>{const{data:i}=await k(`${N}/${b.query.ato_id}`,{method:"GET"},"$Dyv7lSgcqT"),p=(f=>f.map(t=>({...t,pessoa:{...t.pessoa,documento:t.pessoa.doc_identificacao},papel:{...t.partes_tipos}})))(i.value);R.value=p};s();async function Q(){try{const{data:i}=await k(C,{method:"POST",body:{cartorio_token:h.value,documento:r.documento,nome:r.nome}},"$Ir36YwSBFY");i.value.length>0?(M.value=i.value,r.pessoa=M.value[0]):M.value=[]}catch(i){console.error("Erro na requisição",i)}}const ee=()=>{E.value=!0},Y=async()=>{await s()},le=async()=>{const i={pessoa:r.pessoa,papel:j.value.find(f=>f.id===r.papeis),percentual:r.percentual},{data:e,status:p}=await k(D,{method:"POST",body:{ato_id:Number(b.query.ato_id),pessoa_id:r.pessoa.id,tipo_parte_id:r.papeis,user_id:Z("user-data").value.usuario_id,percentual:r.percentual}},"$z4QOGPyvCc");p.value==="success"&&(i.id=e.value.id,g.success("Pessoa Registrada com Sucesso!"),R.value.push(i))},ae=async i=>{var X;if(U.value=!0,z.value=null,!i.pessoa.id)return;const{data:e}=await k(_,{method:"POST",body:{tipo:"ficha",id:i.pessoa.id}},"$XYnqHmowsR");if(!((X=e.value)!=null&&X.link))return;const{data:p}=await k(w,{method:"POST",body:{bucket:"qvgjz",path:e.value.link}},"$63DgHOk5hC"),f=e.value.link,t=p.value;/\.(tr7|tiff)$/i.test(f)?z.value=t:fotoRender.value=`data:image/jpeg;base64,${t}`},oe=i=>{F.value=!0,H.value=i.id,L.value=i.pessoa.nome};async function te(i){i.excluido=!i.excluido;try{await k(`${pessoasUpdate}/${i.id}`,{method:"PUT",body:JSON.stringify({excluido:i.excluido})},"$3fKfAn4Pra")}catch(e){console.error("Erro ao excluir pessoa:",e)}}const se=()=>{V("close-modal")};return(i,e)=>{const p=be,f=Be,t=Se,X=Me,we=ge;return x(),T(re,null,{default:o(()=>[l(P,null,{default:o(()=>[l(n,{cols:"3"},{default:o(()=>[l(y,{label:"Documento",modelValue:a(r).documento,"onUpdate:modelValue":e[0]||(e[0]=d=>a(r).documento=d)},null,8,["modelValue"])]),_:1}),l(n,{cols:"4"},{default:o(()=>[l(y,{label:"Pessoa",modelValue:a(r).nome,"onUpdate:modelValue":e[1]||(e[1]=d=>a(r).nome=d)},null,8,["modelValue"])]),_:1}),m("div",null,[m("img",{class:"mt-1",src:ve,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:Q})]),m("div",null,[m("img",{class:"mt-1 ml-2",src:Ve,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ee})])]),_:1}),l(P,null,{default:o(()=>[l(n,{class:"mt-6",cols:"4"},{default:o(()=>[l(I,{label:"Selecione a Pessoa",modelValue:a(r).pessoa,"onUpdate:modelValue":e[2]||(e[2]=d=>a(r).pessoa=d),items:a(M),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),l(n,{class:"mt-6",cols:"3"},{default:o(()=>[l(I,{label:"Papel",modelValue:a(r).papeis,"onUpdate:modelValue":e[3]||(e[3]=d=>a(r).papeis=d),items:a(j),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"1"},{default:o(()=>[e[9]||(e[9]=m("label",null,"%",-1)),l(p,{modelValue:a(r).percentual,"onUpdate:modelValue":e[4]||(e[4]=d=>a(r).percentual=d)},null,8,["modelValue"])]),_:1}),m("div",null,[m("img",{class:"mt-7",src:Ve,style:{width:"40px",cursor:"pointer"},title:"Criar Imovel",onClick:le})])]),_:1}),l(P,null,{default:o(()=>[l(n,null,{default:o(()=>[l(Re,{style:{height:"385px"},headers:K,items:a(R)},{"item.actions":o(({item:d})=>[l(P,null,{default:o(()=>[m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:de=>ae(d),title:"Visualizar Ficha"},e[10]||(e[10]=[m("img",{style:{width:"30px",height:"30px"},src:ve,alt:"Visualizar"},null,-1)]),8,Fe),m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:de=>oe(d),class:"mr-2",title:"Alterar Papel"},e[11]||(e[11]=[m("img",{style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar"},null,-1)]),8,Le),m("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:de=>te(d),title:"Deletar Pessoa"},[d.excluido?(x(),ue("img",Ge)):(x(),ue("img",Ye))],8,He)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),l(f,{show:a(E),onClose:e[5]||(e[5]=d=>E.value=!1)},null,8,["show"]),l(t,{representante_nome:a(L),ato_token:a(W),ato_id:a(H),show:a(F),onClose:e[6]||(e[6]=d=>F.value=!1),onUpdatePapel:Y},null,8,["representante_nome","ato_token","ato_id","show"]),l(Pe,{modelValue:a(U),"onUpdate:modelValue":e[8]||(e[8]=d=>J(U)?U.value=d:null),width:"600"},{default:o(()=>[l(xe,{"max-width":"600",title:"Ficha"},{default:o(()=>[l(X,{"tiff-url":a(z)},null,8,["tiff-url"]),l(O,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:e[7]||(e[7]=d=>U.value=!1)})]),_:1})]),_:1},8,["modelValue"]),l(P,{class:"mt-5"},{default:o(()=>[l(we,{onClick:se},{default:o(()=>[l(O,{size:"large",color:"red"},{default:o(()=>e[12]||(e[12]=[q("Voltar")])),_:1})]),_:1}),l(O,{class:"ml-5",size:"large",color:"green"},{default:o(()=>e[13]||(e[13]=[q("Salvar")])),_:1})]),_:1})]),_:1})}}},dl={__name:"Cadastro",props:{show:Boolean},emits:["close"],setup(S,{emit:A}){const c=S,v=u("dados"),V=u(c.show),b=u(!1),$=A;Te(()=>c.show,B=>{V.value=B});const g=()=>{b.value=!0},C=()=>{V.value=!1,b.value=!1,$("close")};return(B,_)=>{const D=Ee,N=We;return x(),T(Pe,{persistent:"",modelValue:a(V),"onUpdate:modelValue":_[2]||(_[2]=w=>J(V)?V.value=w:null),"max-width":"1000"},{default:o(()=>[l(xe,null,{default:o(()=>[l(re,null,{default:o(()=>[_[5]||(_[5]=m("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Cadastro de imoveis ",-1)),l(ze,{modelValue:a(v),"onUpdate:modelValue":_[0]||(_[0]=w=>J(v)?v.value=w:null),"bg-color":"#f5f2f2"},{default:o(()=>[l(_e,{value:"dados"},{default:o(()=>_[3]||(_[3]=[q("Dados")])),_:1}),a(b)?(x(),T(_e,{key:0,value:"partes"},{default:o(()=>_[4]||(_[4]=[q("Partes")])),_:1})):ce("",!0)]),_:1},8,["modelValue"]),l(Oe,{modelValue:a(v),"onUpdate:modelValue":_[1]||(_[1]=w=>J(v)?v.value=w:null)},{default:o(()=>[l(fe,{value:"dados"},{default:o(()=>[l(D,{onSaved:g,onCloseModal:C})]),_:1}),l(fe,{value:"partes"},{default:o(()=>[a(b)?(x(),T(N,{key:0,onCloseModal:C})):ce("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{Ee as _,We as a,dl as b};
