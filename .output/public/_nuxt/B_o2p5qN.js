import{_ as oe}from"./DOc5oAB_.js";import{a as ae,_ as re}from"./DAAbc1FB.js";import{_ as se}from"./BjPuDUkZ.js";import{_ as ne}from"./BVz1G1IN.js";import{_ as ie}from"./TioMVpdk.js";import{_ as le}from"./DTk-1k_d.js";import{_ as ue,a as de}from"./DJvq3mCv.js";import{c as E,r as z,u as pe}from"./A-JWE82C.js";import{u as me}from"./rEzubGKr.js";import{u as ce,M as _e,L as fe,r as u,m as x,n as ve,D as B,s as ge,x as b,w as n,z as xe,o as c,b as s,a as i,t as ke,v as o,A as Ve,V as w,C as $e,B as he,c as U,E as ye,d as be}from"./jNRvdYSc.js";import{u as C}from"./BXhetWJD.js";import{f as we}from"./vxCqYvDh.js";import{V as Ce}from"./C8yst81n.js";import{V as k}from"./CRIxyrsP.js";import{V}from"./BUfhigB7.js";import{V as Oe}from"./B5LTd4UV.js";import{V as Re}from"./CB_MsP2q.js";import"./LS_FHW_4.js";import"./BSzrTJU7.js";import"./G-FIzmQ3.js";import"./BMli1kaz.js";import"./Bjzi7n50.js";import"./xH0o6Zd0.js";import"./B-HEFmEe.js";import"./DIeteNUM.js";const Te={style:{color:"red","margin-left":"30px"}},Ae=["onClick"],Ee=["onClick"],ze=["onClick","title"],Be=["disabled","onClick"],Ue={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:ue,alt:"Visualizar",title:"Reativar"},Ie={key:1,src:de,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},lt={__name:"[id]",async setup(Se){let l,_;const{redirectTo:O}=me(),{$toast:R}=ce(),I=_e(),{id:p}=I.params,S=fe(),f=xe(),D=`${f.public.managemant}/updateOrdensServico`,P=`${f.public.managemant}/getOrdensServicoById`,N=`${f.public.managemant}/listarAtos`,q=`${f.public.managemant}/updateAtos`,F=u(x("user-data").value.cartorio_id),M=u(x("user-data").value.usuario_id),L=u(x("user-service").value.token).value||null,G=u(x("user-data").value.cartorio_token).value,$=u([]),h=u(!1),T=u(null),m=u(null),r=ve({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),K=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],W=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],X={apresentante_nome:{required:E.withMessage("O campo é obrigatorio",z)},apresentante_cpf:{required:E.withMessage("O campo é obrigatorio",z)}},d=pe(X,r);function Y(a){if(a)return a.replace(/[.\-]/g,"");a=null}const Z=a=>{T.value=a,h.value=!0},j=a=>{O({item:a,id:p,numeroOs:m.value,origem:"vizualizar"})},H=a=>{O({item:a,id:p,numeroOs:m.value,origem:"atualizar"})};async function J(){const a={apresentante_cpf:Y(r.apresentante_cpf),apresentante_nome:r.apresentante_nome,user_id:M.value,cartorio_id:F.value},{error:t,status:g}=await C(`${D}/${p}`,{method:"PUT",body:a},"$Fud06ay483");g.value==="error"&&t.value.statusCode===500?R.error("Erro ao cadastrar ordem,erro no sistema."):(R.success("Ordem Atualizada com sucesso!"),S.push({path:"/os/lista"}))}const{data:v}=([l,_]=B(()=>C(`${P}/${p}`,{method:"GET"},"$wPUkUpDvPf")),l=await l,_(),l);m.value=v.value.numero,r.nacionalidade=v.value.estrangeiro,r.apresentante_cpf=v.value.apresentante_cpf,r.apresentante_nome=v.value.apresentante_nome;const{data:A}=([l,_]=B(()=>C(N,{method:"POST",body:{cartorio_token:G,ordemserv_token:L}},"$YXZ55K3IUf")),l=await l,_(),l);async function Q(a){a.excluido=!a.excluido;try{await we(`${q}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(t){console.error("Erro ao excluir pessoa:",t)}}return A.value.length>0?$.value=A.value:$.value=[],(a,t)=>{const g=oe,ee=re,te=ge("mask");return c(),b(Ce,{class:"mt-5"},{default:n(()=>[s(k,{class:"mb-5"},{default:n(()=>[t[6]||(t[6]=i("h1",null,"Ordem de Serviço nº",-1)),i("h1",Te,ke(o(m)),1)]),_:1}),s(k,null,{default:n(()=>[s(V,{md:"3"},{default:n(()=>[s(Oe,{label:"Nacionalidade",items:W,modelValue:o(r).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>o(r).nacionalidade=e)},null,8,["modelValue"])]),_:1}),s(V,{md:"2"},{default:n(()=>[o(r).nacionalidade==="brasileiro"?Ve((c(),b(w,{key:0,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>o(r).apresentante_cpf=e),label:"CPF",required:"","error-messages":o(d).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(d).apresentante_cpf.$touch,onInput:o(d).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[te,"###.###.###-##"]]):(c(),b(w,{key:1,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>o(r).apresentante_cpf=e),label:"Documento",required:"","error-messages":o(d).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(d).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),s(V,{md:"4"},{default:n(()=>[s(w,{modelValue:o(r).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>o(r).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":o(d).apresentante_nome.$errors.map(e=>e.$message),onInput:o(d).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),s(V,null,{default:n(()=>[i("div",null,[i("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:se,alt:"Salvar",onClick:t[4]||(t[4]=e=>J())})])]),_:1})]),_:1}),s(k,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:n(()=>[t[10]||(t[10]=i("h1",{class:"ml-5"},"Atos",-1)),s(g,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:o(p),numeroOs:o(m)}}},{default:n(()=>t[7]||(t[7]=[i("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:ne,alt:"novo"},null,-1)])),_:1},8,["to"]),s(Re,{headers:K,items:o($),"item-key":"id"},{"item.actions":n(({item:e})=>[s(k,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:n(()=>[i("div",{onClick:y=>j(e),title:"Visualizar"},t[8]||(t[8]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ie,alt:"Visualizar"},null,-1)]),8,Ae),i("div",{onClick:y=>Z(e.token),title:"Reimprimir"},t[9]||(t[9]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ae,alt:"Reimprimir"},null,-1)]),8,Ee),i("div",{class:he({disabled:!e.btn_editar}),onClick:y=>e.btn_editar?H({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,rota:e.rota}):null,title:e.btn_editar?"Editar":"Desabilitado"},[i("img",{style:$e({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:le,alt:"Editar"},null,4)],10,ze),i("div",{disabled:!e.btn_cancelar,onClick:y=>e.btn_cancelar?Q(e):null,title:"Excluir"},[e.excluido?(c(),U("img",Ue)):(c(),U("img",Ie))],8,Be)]),_:2},1024)]),_:1},8,["items"]),s(ee,{show:o(h),ato_token:o(T),onClose:t[5]||(t[5]=e=>h.value=!1)},null,8,["show","ato_token"])]),_:1}),s(g,{to:"/os/lista"},{default:n(()=>[s(ye,{size:"large",color:"red"},{default:n(()=>t[11]||(t[11]=[be("Voltar")])),_:1})]),_:1})]),_:1})}}};export{lt as default};
