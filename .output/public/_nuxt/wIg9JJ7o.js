import{_ as oe}from"./BS6dDNxh.js";import{a as ae,b as re,_ as se}from"./D_xOpNM8.js";import{_ as ne}from"./LAQiXzUq.js";import{_ as le}from"./BVz1G1IN.js";import{_ as ie}from"./CCt5G1nV.js";import{_ as ue}from"./C7BdYCS9.js";import{c as I,r as S,u as pe}from"./vVYenxr7.js";import{u as de}from"./Cpz5BCZ-.js";import{u as me,J as ce,D as _e,r as u,e as g,f as fe,y as z,m as ve,h as b,w as l,k as ge,o as h,b as s,a as n,t as ke,i as o,q as xe,s as w,x as C,v as Ve,V as $e,d as ye}from"./BZTclJb_.js";import{u as O}from"./C9ebrkvE.js";import{f as be}from"./Cu6b8Ug_.js";import{V as he}from"./Czey38Ht.js";import{V as k}from"./DtsFxz_M.js";import{V as x}from"./CaF9n5dG.js";import{V as we}from"./BhsWa34n.js";import{V as Ce}from"./7A7nJpbM.js";import"./BbhQUv3T.js";import"./CntSlUwr.js";import"./CjKRLbzV.js";import"./C2bYHPI9.js";import"./P7giLpGY.js";import"./D-aitGgy.js";import"./7CP29JCH.js";import"./BMAdM1Mt.js";const Oe={style:{color:"red","margin-left":"30px"}},Te=["onClick"],Re=["onClick"],Ae=["onClick","title"],Ue=["onClick"],Ie=["title"],rt={__name:"[id]",async setup(Se){let i,c;const{redirectTo:T}=de(),{$toast:R}=me(),B=ce(),{id:d}=B.params,D=_e(),_=ge(),E=`${_.public.managemant}/updateOrdensServico`,N=`${_.public.managemant}/getOrdensServicoById`,P=`${_.public.managemant}/listarAtos`,q=`${_.public.managemant}/updateAtos`,F=u(g("user-data").value.cartorio_id),M=u(g("user-data").value.usuario_id),G=u(g("user-service").value.token).value||null,L=u(g("user-data").value.cartorio_token).value,V=u([]),$=u(!1),A=u(null),m=u(null),r=fe({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),J=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],K=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],W={apresentante_nome:{required:I.withMessage("O campo é obrigatorio",S)},apresentante_cpf:{required:I.withMessage("O campo é obrigatorio",S)}},p=pe(W,r);function X(a){if(a)return a.replace(/[.\-]/g,"");a=null}const Y=a=>{A.value=a,$.value=!0},Z=a=>{T({item:a,id:d,numeroOs:m.value,origem:"vizualizar"})},j=a=>{T({item:a,id:d,numeroOs:m.value,origem:"atualizar"})};async function H(){const a={apresentante_cpf:X(r.apresentante_cpf),apresentante_nome:r.apresentante_nome,user_id:M.value,cartorio_id:F.value},{error:t,status:v}=await O(`${E}/${d}`,{method:"PUT",body:a},"$Fud06ay483");v.value==="error"&&t.value.statusCode===500?R.error("Erro ao cadastrar ordem,erro no sistema."):(R.success("Ordem Atualizada com sucesso!"),D.push({path:"/os/lista"}))}const{data:f}=([i,c]=z(()=>O(`${N}/${d}`,{method:"GET"},"$wPUkUpDvPf")),i=await i,c(),i);m.value=f.value.numero,r.nacionalidade=f.value.estrangeiro,r.apresentante_cpf=f.value.apresentante_cpf,r.apresentante_nome=f.value.apresentante_nome;const{data:U}=([i,c]=z(()=>O(P,{method:"POST",body:{cartorio_token:L,ordemserv_token:G}},"$YXZ55K3IUf")),i=await i,c(),i);async function Q(a){a.excluido=!a.excluido;try{await be(`${q}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(t){console.error("Erro ao excluir pessoa:",t)}}return U.value.length>0?V.value=U.value:V.value=[],(a,t)=>{const v=oe,ee=se,te=ve("mask");return h(),b(he,{class:"mt-5"},{default:l(()=>[s(k,{class:"mb-5"},{default:l(()=>[t[6]||(t[6]=n("h1",null,"Ordem de Serviço nº",-1)),n("h1",Oe,ke(o(m)),1)]),_:1}),s(k,null,{default:l(()=>[s(x,{md:"3"},{default:l(()=>[s(we,{label:"Nacionalidade",items:K,modelValue:o(r).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>o(r).nacionalidade=e)},null,8,["modelValue"])]),_:1}),s(x,{md:"2"},{default:l(()=>[o(r).nacionalidade==="brasileiro"?xe((h(),b(w,{key:0,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>o(r).apresentante_cpf=e),label:"CPF",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch,onInput:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[te,"###.###.###-##"]]):(h(),b(w,{key:1,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>o(r).apresentante_cpf=e),label:"Documento",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),s(x,{md:"4"},{default:l(()=>[s(w,{modelValue:o(r).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>o(r).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":o(p).apresentante_nome.$errors.map(e=>e.$message),onInput:o(p).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),s(x,null,{default:l(()=>[n("div",null,[n("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:ne,alt:"Salvar",onClick:t[4]||(t[4]=e=>H())})])]),_:1})]),_:1}),s(k,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:l(()=>[t[10]||(t[10]=n("h1",{class:"ml-5"},"Atos",-1)),s(v,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:o(d),numeroOs:o(m)}}},{default:l(()=>t[7]||(t[7]=[n("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:le,alt:"novo"},null,-1)])),_:1},8,["to"]),s(Ce,{headers:J,items:o(V),"item-key":"id"},{"item.actions":l(({item:e})=>[s(k,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:l(()=>[n("div",{onClick:y=>Z(e),title:"Visualizar"},t[8]||(t[8]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ie,alt:"Visualizar"},null,-1)]),8,Te),n("div",{onClick:y=>Y(e.token),title:"Reimprimir"},t[9]||(t[9]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ae,alt:"Reimprimir"},null,-1)]),8,Re),n("div",{class:Ve({disabled:!e.btn_editar}),onClick:y=>e.btn_editar?j({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,rota:e.rota}):null,title:e.btn_editar?"Editar":"Desabilitado"},[n("img",{style:C({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ue,alt:"Editar"},null,4)],10,Ae),n("div",{onClick:y=>e.btn_cancelar?Q(e):null,title:"Excluir",style:C({cursor:e.btn_cancelar?"pointer":"not-allowed"})},[n("img",{style:C({width:"30px",height:"30px",cursor:e.btn_cancelar?"pointer":"not-allowed",opacity:e.btn_cancelar?"1":"0.5"}),src:re,alt:"Cancelar",title:e.btn_cancelar?"Cancelar":"Não permitido"},null,12,Ie)],12,Ue)]),_:2},1024)]),_:1},8,["items"]),s(ee,{show:o($),ato_token:o(A),onClose:t[5]||(t[5]=e=>$.value=!1)},null,8,["show","ato_token"])]),_:1}),s(v,{to:"/os/lista"},{default:l(()=>[s($e,{size:"large",color:"red"},{default:l(()=>t[11]||(t[11]=[ye("Voltar")])),_:1})]),_:1})]),_:1})}}};export{rt as default};
