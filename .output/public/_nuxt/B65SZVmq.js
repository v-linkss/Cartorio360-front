import{_ as ne}from"./CkfNF4UP.js";import{u as te,C as oe,H as ae,r as p,D as le,o as j,G as ie,w as t,b as e,v as o,V as ee,A as G,d as H,s as se,m as W,I as re,a as g,c as X,x as ke,L as Ue,n as Re,M as Ie,K as we,F as Ve,g as Fe,N as xe,t as _e}from"./6WvddAsj.js";import{V as P,u as y}from"./Cvp2CtMV.js";import{V as S}from"./BA1hschn.js";import{V as ce}from"./BXM1UxqR.js";import{V as de}from"./DsLYeT_F.js";import{_ as Be,d as Ne}from"./DDZuS16_.js";import{_ as Le,a as Ge,b as He,T as Je,W as Ke,S as We,r as Ce,D as Ee,c as Xe,d as Qe}from"./CtSQUrPp.js";import{_ as fe}from"./B3alQKAE.js";import{_ as ue}from"./BVz1G1IN.js";import{_ as Ye,a as ve,b as ye}from"./3wu_wFqt.js";import{V as ge}from"./BuW5Dw_U.js";import{V as Pe,a as be}from"./B6LS7lpe.js";import{_ as Ae}from"./B3ri6XUK.js";import{c as Ze,r as et,u as tt}from"./Dco9MqqG.js";import{_ as $e}from"./CdP3NN9a.js";const Mt={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(Q){const _=Q,{$toast:x}=te(),$=se(),f=oe(),d=ae(),b=`${$.public.managemant}/updateAtos`,z=p(_.item_situacoes),V=le({dt_abertura:_.item_dados[0].dt_abertura||null,status:_.item_dados[0].status||null,mne:_.item_dados[0].mne||null});async function F(){const{data:h,error:m,status:M}=await y(`${b}/${d.query.ato_id}`,{method:"PUT",body:{status:V.status,mne:V.mne,dt_abertura:V.dt_abertura}},"$EIT5jtTUdX");M.value==="success"&&x.success("Ato Atualizado com sucesso")}const B=()=>{const h=d.query.origem||"criar",m=d.query.id;h==="atualizar"?f.push(`/os/atualizar/${m}`):f.push("/os/criar-registro")};return(h,m)=>{const M=ne;return j(),ie(de,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(S,{cols:"3"},{default:t(()=>[e(ce,{label:"Situação",modelValue:o(V).status,"onUpdate:modelValue":m[0]||(m[0]=k=>o(V).status=k),items:o(z),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(S,{cols:"5"},{default:t(()=>[e(ee,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:o(V).mne,"onUpdate:modelValue":m[1]||(m[1]=k=>o(V).mne=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(S,{cols:"2"},{default:t(()=>[e(ee,{modelValue:o(V).dt_abertura,"onUpdate:modelValue":m[2]||(m[2]=k=>o(V).dt_abertura=k),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(P,{class:"mb-3"},{default:t(()=>[e(M,{onClick:B},{default:t(()=>[e(G,{size:"large",color:"red"},{default:t(()=>m[3]||(m[3]=[H("Voltar")])),_:1})]),_:1}),e(G,{class:"ml-10",onClick:F,size:"large",color:"green"},{default:t(()=>m[4]||(m[4]=[H("Atualizar")])),_:1})]),_:1})]),_:1})}}},ot=["onClick"],at=["onClick"],st=["onClick"],rt={key:0,style:{width:"30px",height:"30px"},src:ve,alt:"Visualizar",title:"Reativar"},nt={key:1,src:ye,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},lt=["onClick"],Dt={__name:"Partes",async setup(Q){let _,x;const $=oe(),f=ae(),d=se(),{$toast:b}=te(),z=`${d.public.managemant}/pesquisarPessoas`,V=`${d.public.managemant}/listarPapeis`,F=`${d.public.managemant}/getLinkTipo`,B=`${d.public.managemant}/createAtosPessoa`,h=`${d.public.managemant}/updateAtosPessoa`,m=`${d.public.managemant}/getAtosPessoaById`,M=`${d.public.managemant}/download`,k=p(W("user-data").value.cartorio_token),w=p([]),A=p([]),T=p([]),U=p(!1),R=p(!1),q=p(!1),N=p(!1),J=p(null),s=p(null),l=p(null),D=p(null),a=p(null),i=p(f.query.tipo_ato_token),r=p(null),c=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],u=le({papeis:null,nome:null,pessoa:null,documento:null}),{data:C}=([_,x]=re(()=>y(V,{method:"POST",body:{tipo_ato_token:f.query.tipo_ato_token}},"$acoiTIUp00")),_=await _,x(),_);T.value=C.value;const O=async()=>{const{data:v}=await y(`${m}/${f.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),I=(Y=>Y.map(L=>({...L,pessoa:{...L.pessoa,documento:L.pessoa.doc_identificacao},papel:{...L.partes_tipos}})))(v.value);A.value=I};O();async function Z(){try{const{data:v,error:n}=await y(z,{method:"POST",body:{cartorio_token:k.value,documento:u.documento,nome:u.nome}},"$pr30MyPXfY");v.value.length>0?(w.value=v.value,u.pessoa=w.value[0]):w.value=[]}catch(v){console.error("Erro na requisição",v)}}const me=()=>{R.value=!0},he=async()=>{await O()},Te=async()=>{await O()},qe=async()=>{const v={pessoa:u.pessoa,papel:T.value.find(K=>K.id===u.papeis),representante:{nome:null}},n=await y(`${m}/${f.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const K of n.data.value)if(K.pessoa_id===u.pessoa.id&&K.ato_id===Number(f.query.ato_id)&&K.tipo_parte_id===u.papeis){b.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:I,error:Y,status:L}=await y(B,{method:"POST",body:{ato_id:Number(f.query.ato_id),pessoa_id:u.pessoa.id,tipo_parte_id:u.papeis,user_id:W("user-data").value.usuario_id}},"$18isAgOJxG");L.value==="success"?(v.id=I.value.id,b.success("Pessoa Registrada com Sucesso!"),A.value.push(v)):b.error(Y.value.message)},Oe=async v=>{var K;if(q.value=!0,r.value=null,!v.pessoa.id)return;const{data:n}=await y(F,{method:"POST",body:{tipo:"ficha",id:v.pessoa.id}},"$hmDzSF3F61");if(!((K=n.value)!=null&&K.link))return;const{data:I}=await y(M,{method:"POST",body:{bucket:"qvgjz",path:n.value.link}},"$l09I6nLRfk"),Y=n.value.link,L=I.value;/\.(tr7|tiff)$/i.test(Y)?r.value=L:fotoRender.value=`data:image/jpeg;base64,${L}`},ze=v=>{const n=A.value.filter(I=>I.pessoa.id!==v.pessoa.id).map(I=>({id:I.pessoa.id,nome:I.pessoa.nome}));l.value=v.id,J.value=n,U.value=!0,s.value=v.pessoa.nome,a.value=v.pessoa.id},Me=v=>{N.value=!0,D.value=v.id,s.value=v.pessoa.nome};async function De(v){v.excluido=!v.excluido;try{await y(`${h}/${v.id}`,{method:"PUT",body:JSON.stringify({excluido:v.excluido})},"$PUt0nEhmBF")}catch(n){console.error("Erro ao excluir pessoa:",n)}}const Se=()=>{const v=f.query.origem||"criar",n=f.query.id;v==="atualizar"?$.push(`/os/atualizar/${n}`):$.push("/os/criar-registro")};return(v,n)=>{const I=Be,Y=Ge,L=He,K=Ne,je=ne;return j(),ie(de,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(S,{cols:"3"},{default:t(()=>[e(ee,{label:"Documento",modelValue:o(u).documento,"onUpdate:modelValue":n[0]||(n[0]=E=>o(u).documento=E)},null,8,["modelValue"])]),_:1}),e(S,{cols:"4"},{default:t(()=>[e(ee,{label:"Pessoa",modelValue:o(u).nome,"onUpdate:modelValue":n[1]||(n[1]=E=>o(u).nome=E)},null,8,["modelValue"])]),_:1}),g("div",null,[g("img",{class:"mt-1",src:fe,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:Z})]),g("div",null,[g("img",{class:"mt-1 ml-2",src:ue,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:me})])]),_:1}),e(P,null,{default:t(()=>[e(S,{cols:"4"},{default:t(()=>[e(ce,{label:"Selecione a Pessoa",modelValue:o(u).pessoa,"onUpdate:modelValue":n[2]||(n[2]=E=>o(u).pessoa=E),items:o(w),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(S,{cols:"3"},{default:t(()=>[e(ce,{label:"Papel",modelValue:o(u).papeis,"onUpdate:modelValue":n[3]||(n[3]=E=>o(u).papeis=E),items:o(T),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),g("div",null,[g("img",{class:"mt-1",src:ue,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:qe})])]),_:1}),e(P,null,{default:t(()=>[e(S,null,{default:t(()=>[e(ge,{style:{height:"465px"},headers:c,items:o(A)},{"item.actions":t(({item:E})=>[e(P,null,{default:t(()=>[g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:pe=>Oe(E),title:"Visualizar Ficha"},n[9]||(n[9]=[g("img",{style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar"},null,-1)]),8,ot),g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:pe=>Me(E),class:"mr-2",title:"Alterar Papel"},n[10]||(n[10]=[g("img",{style:{width:"30px",height:"30px"},src:Ye,alt:"Visualizar"},null,-1)]),8,at),g("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:pe=>De(E),title:"Deletar Pessoa"},[E.excluido?(j(),X("img",rt)):(j(),X("img",nt))],8,st),g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:pe=>ze(E),title:"Selecionar Representante"},n[11]||(n[11]=[g("img",{style:{width:"30px",height:"30px"},src:Le,alt:"Visualizar"},null,-1)]),8,lt)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(I,{show:o(R),onClose:n[4]||(n[4]=E=>R.value=!1)},null,8,["show"]),e(Y,{representante_nome:o(s),representantes:o(J),ato_id:o(l),show:o(U),onClose:n[5]||(n[5]=E=>U.value=!1),onUpdateRepresentante:Te},null,8,["representante_nome","representantes","ato_id","show"]),e(L,{representante_nome:o(s),ato_token:o(i),ato_id:o(D),show:o(N),onClose:n[6]||(n[6]=E=>N.value=!1),onUpdatePapel:he},null,8,["representante_nome","ato_token","ato_id","show"]),e(Pe,{modelValue:o(q),"onUpdate:modelValue":n[8]||(n[8]=E=>ke(q)?q.value=E:null),width:"600"},{default:t(()=>[e(be,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(K,{"tiff-url":o(r)},null,8,["tiff-url"]),e(G,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:n[7]||(n[7]=E=>q.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(P,null,{default:t(()=>[e(je,{onClick:Se},{default:t(()=>[e(G,{size:"large",color:"red"},{default:t(()=>n[12]||(n[12]=[H("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},it={key:0,class:"loading-overlay"},ct="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",St={__name:"Minuta",emits:["page","doc"],setup(Q,{emit:_}){Ue("DocumentEditorContainer",[Je,Ke,We]);const x=se(),{$toast:$}=te(),f=oe(),d=ae(),b=_;Ce(`${x.public.docEditor}`);const z=`${x.public.managemant}/download`,V=`${x.public.managemant}/atos/files`,F=`${x.public.managemant}/subitituirModelo`,B=`${x.public.managemant}/upload`,h=p(null),m=p(!1),M=p("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),k=p(!1),w=async a=>{try{const i=await fetch(a);if(!i.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await i.blob()}catch(i){return console.error(i),null}},A=async()=>{try{const{data:a}=await y(`${V}/${d.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return a.value.link_ato}catch(a){console.error("Erro ao carregar o documento:",a),$.error(a)}},T=async()=>{k.value=!0;try{const a=await A(),{data:i,status:r}=await y(z,{method:"POST",body:{bucket:"qvgjz",path:a}},"$dvNFfvmIJC"),c=i.value,u=await w(c);if(u){const C=new FileReader;C.onload=()=>{const O=C.result;h.value.ej2Instances.documentEditor.open(O),b("doc",O)},C.readAsText(u)}}catch{console.error("Erro ao carregar o documento.")}finally{k.value=!1}},U=async()=>{const i=await h.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),r=new FileReader;r.onload=()=>{const c=r.result,C=h.value.ej2Instances.documentEditor.pageCount;b("page",C),b("doc",c)},r.readAsText(i)},R=async()=>{k.value=!0;try{const i=await h.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),r=new FormData;r.append("file",i,"anexo.sfdt"),r.append("cartorio_token",W("user-data").value.cartorio_token),r.append("token",d.query.ato_token_edit),r.append("tipo","ato_minuta");const{data:c,status:u}=await y(B,{method:"POST",body:r},"$xv11VtUdMy");if(u.value==="success"){$.success("Documento enviado!");const O=h.value.ej2Instances.documentEditor.pageCount;U(),b("page",O)}else $.error("Erro ao enviar documento para o sistema.")}catch(a){$.error("Erro ao salvar documento."),console.error(a)}finally{k.value=!1}},q=()=>{m.value=!1,N()},N=async()=>{l(!0);try{await J(),l(!0);const{data:a,status:i}=await y(F,{method:"POST",body:{ato_token:d.query.ato_token_edit}},"$zyzWHTXTBW");a.value&&s(a.value)}catch(a){console.error("Erro ao gerar a minuta:",a),$.error("Ocorreu um erro ao gerar a minuta.")}finally{l(!1)}},J=async()=>{try{const{data:a}=await y(z,{method:"POST",body:{bucket:"qvgjz",path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),i=await w(a.value);if(i){const r=new FileReader;r.onload=()=>{const c=r.result;h.value.ej2Instances.documentEditor.open(c),b("doc",c)},r.readAsText(i)}}catch(a){console.error("Erro ao carregar o modelo de minuta:",a)}},s=a=>{const i=h.value.ej2Instances.documentEditor,r=c=>{for(const[u,C]of Object.entries(c))if(/^<<.+>>$/.test(u))try{i.search.findAll(u),i.search.searchResults.length>0&&i.search.searchResults.replaceAll(C)}catch(O){console.error(`Erro ao substituir o marcador ${u}:`,O)}else if(u==="partes"&&Array.isArray(C)&&C.length>0)for(const O of C)typeof O=="object"&&r(O)};r(a)},l=a=>{k.value=a},D=()=>{const a=d.query.origem||"criar",i=d.query.id;a==="atualizar"?f.push(`/os/atualizar/${i}`):f.push("/os/criar-registro")};return Re(async()=>{await T(),U()}),(a,i)=>{const r=ne,c=Ae;return j(),X(Ve,null,[e(o(Ee),{height:"900px",ref_key:"documentEditorContainer",ref:h,serviceUrl:ct,enableToolbar:!0,enableWordExport:!0},null,512),o(k)?(j(),X("div",it,[e(Ie,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):we("",!0),e(P,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e(r,{class:"mr-4"},{default:t(()=>[e(G,{size:"large",onClick:D,color:"red"},{default:t(()=>i[2]||(i[2]=[H("Voltar")])),_:1})]),_:1}),e(G,{size:"large",color:"green",onClick:R,disabled:o(k)},{default:t(()=>i[3]||(i[3]=[H("Atualizar")])),_:1},8,["disabled"]),e(G,{class:"ml-4",size:"large",color:"blue",onClick:i[0]||(i[0]=u=>m.value=!0)},{default:t(()=>i[4]||(i[4]=[H("Gerar Minuta")])),_:1})]),_:1}),e(c,{onConfirm:q,condMessage:o(M),show:o(m),onClose:i[1]||(i[1]=u=>m.value=!1)},null,8,["condMessage","show"])],64)}}},ut=["innerHTML"],jt={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(Q){let _,x;const $=Q,f=se();Ce(`${f.public.docEditor}`);const{$toast:d}=te(),b=oe(),z=ae(),V=`${f.public.managemant}/download`,F=`${f.public.managemant}/atos/files`,B=`${f.public.managemant}/lavrarAto`,h=`${f.public.managemant}/listarEscrevente`,m=p(W("user-data").value.cartorio_token),M=W("auth_token").value,k=p("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),w=p(!1),A=p(null),T=p(null),U=p(null),R=p([]),q=le({escrevente:null}),N=async r=>{try{const c=await fetch(r);if(!c.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await c.blob()}catch(c){return console.error(c),null}},J=async()=>{try{const{data:r}=await y(`${F}/${z.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return r.value.link_ato}catch(r){console.error("Erro ao carregar o documento:",r),d.error(r)}},s=async()=>{try{const r=await J(),{data:c,status:u}=await y(V,{method:"POST",body:{bucket:"qvgjz",path:r}},"$7ljqltMqa0"),C=c.value,O=await N(C);if(O){const Z=new FileReader;Z.onload=()=>{const me=Z.result;U.value.ej2Instances.documentEditor.open(me)},Z.readAsText(O)}}catch{d.error("Erro ao carregar o documento.")}};s();const l=async()=>{if(!q.escrevente){d.error("Selecione um escrevente para realizar a ação");return}try{const{data:r,status:c}=await y(B,{method:"POST",body:{ato_token:z.query.ato_token_edit,qtd_paginas:$.pages,escrevente_token:q.escrevente,usuario_token:M,cartorio_token:m}},"$OWxZSQkyX8");c.value==="success"?(A.value=r.value,T.value=r.value[0].selo,d.success("Ato lavrado com sucesso!")):d.error("Falha ao lavrar o ato.")}catch{d.error("Erro ao conectar com o servidor.")}},D=()=>{w.value=!1,l()},{data:a}=([_,x]=re(()=>y(h,{method:"POST",body:{cartorio_token:m}},"$sMqfUUQcBM")),_=await _,x(),_);R.value=a.value[0].func_json_escreventes;const i=()=>{const r=z.query.origem||"criar",c=z.query.id;r==="atualizar"?b.push(`/os/atualizar/${c}`):b.push("/os/criar-registro")};return Fe(()=>$.document,(r,c)=>{s()}),(r,c)=>{const u=Ae;return j(),X(Ve,null,[e(P,null,{default:t(()=>[e(S,null,{default:t(()=>[e(o(Ee),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:U,height:"850px",width:"850px"},null,512)]),_:1}),e(S,null,{default:t(()=>[e(ce,{class:"mt-15",label:"Tabelião/escrevente",modelValue:o(q).escrevente,"onUpdate:modelValue":c[0]||(c[0]=C=>o(q).escrevente=C),items:o(R),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),g("img",{onClick:c[1]||(c[1]=C=>w.value=!0),style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Xe}),o(A)?(j(),ie(be,{key:0,width:"360px",class:"mr-16"},{default:t(()=>[e(P,null,{default:t(()=>[e(S,null,{default:t(()=>[e(xe,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[H(" Livro: "+_e(o(A)[0].livro_numero),1)]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(xe,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[H(" Folhas : "+_e(o(A)[0].pagina_inicial)+" A "+_e(o(A)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),g("div",{style:{border:"1px solid black","border-radius":"8px","padding-bottom":"20px","margin-top":"-10px"},class:"ml-2 mb-2 mr-2",innerHTML:o(T)},null,8,ut)]),_:1})):we("",!0)]),_:1})]),_:1}),e(G,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:i},{default:t(()=>c[3]||(c[3]=[H("Voltar")])),_:1}),e(u,{show:o(w),condMessage:o(k),onClose:c[2]||(c[2]=C=>w.value=!1),onConfirm:D},null,8,["show","condMessage"])],64)}}},dt=["onClick"],mt={key:0,style:{width:"30px",height:"30px"},src:ve,alt:"Visualizar",title:"Reativar"},pt={key:1,src:ye,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ut={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(Q){let _,x;const $=oe(),f=ae(),d=se(),{$toast:b}=te(),z=`${d.public.managemant}/listarEscrevente`;`${d.public.managemant}`;const V=`${d.public.managemant}/createAtosObservacao`,F=`${d.public.managemant}/updateAtosObservacao`,B=`${d.public.managemant}/getAtosObservacaoById`,h=p(W("user-data").value.cartorio_token),m=p([]),M=p([]),k=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],w=le({observacao:""}),A={observacao:{required:Ze.withMessage("O campo é obrigatório",et)}},T=tt(A,w),{data:U}=([_,x]=re(()=>y(`${B}/${f.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),_=await _,x(),_);m.value=U.value.map(s=>({...s,created:$e(s.created,"dd/mm/yyyy hh:mm")}));async function R(){if(w.observacao.trim()===""){b.error("O campo de observação está vazio.");return}if(await T.value.$validate()){const{data:s,error:l,status:D}=await y(V,{method:"POST",body:{ato_id:f.query.ato_id,observacao:w.observacao,user_id:W("user-data").value.usuario_id}},"$gnHMo4uCXD");D.value==="success"&&(m.value.push({created:$e(s.value.created,"dd/mm/yyyy hh:mm"),observacao:s.value.observacao,id:s.value.id,escrevente:W("user-data").value.nome}),w.observacao="",b.success("Observação registrada com sucesso"))}else b.error("Preencha os campos obrigatórios.")}async function q(s){s.excluido=!s.excluido;try{await y(`${F}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$sP9AKdd3Ky")}catch(l){console.error("Erro ao excluir observação:",l)}}const{data:N}=([_,x]=re(()=>y(z,{method:"POST",body:{cartorio_token:h}},"$HL9pndqGh0")),_=await _,x(),_);M.value=N.value[0].func_json_escreventes;const J=()=>{const s=f.query.origem||"criar",l=f.query.id;s==="atualizar"?$.push(`/os/atualizar/${l}`):$.push("/os/criar-registro")};return(s,l)=>{const D=ne;return j(),ie(de,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(ee,{label:"Observação",modelValue:w.observacao,"onUpdate:modelValue":l[0]||(l[0]=a=>w.observacao=a),required:"","error-messages":o(T).observacao.$errors.length>0?o(T).observacao.$errors.map(a=>a.$message):[],onBlur:o(T).observacao.$touch,onInput:o(T).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),g("div",null,[g("img",{class:"btn-pointer ml-2",src:ue,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:R})])]),_:1}),e(P,null,{default:t(()=>[e(S,null,{default:t(()=>[e(ge,{style:{height:"465px"},headers:k,items:m.value},{"item.actions":t(({item:a})=>[g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:i=>q(a),title:"Deletar Observação"},[a.excluido?(j(),X("img",mt)):(j(),X("img",pt))],8,dt)]),_:1},8,["items"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(D,{onClick:J},{default:t(()=>[e(G,{size:"large",color:"red"},{default:t(()=>l[1]||(l[1]=[H("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},_t=["onClick"],ft=["onClick"],vt={key:0,style:{width:"30px",height:"30px"},src:ve,alt:"Visualizar",title:"Reativar"},yt={key:1,src:ye,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Rt={__name:"Anexos",async setup(Q){let _,x;const $=se(),{$toast:f}=te(),d=oe(),b=ae(),z=`${$.public.biometria}/run-scanner`,V=`${$.public.managemant}/atos_anexos`,F=`${$.public.managemant}/atos_anexos`,B=`${$.public.managemant}/atos_anexos`,h=p(!1),m=p([]),M=le({descricao:""}),k=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:w}=([_,x]=re(()=>y(`${B}/${b.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),_=await _,x(),_);m.value=w.value;async function A(){try{await T(),await U()}catch(s){console.error("Erro ao executar scanner ou listar arquivos:",s)}}async function T(){try{const{data:s}=await y(z,{method:"GET"},"$KttjFhHivJ")}catch(s){f.error("Erro ao acionar o scanner:",s)}}async function U(){try{const{data:s,status:l}=await y("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:b.query.ato_token_edit,cartorio_token:W("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(s){console.error("Erro ao enviar o arquivo:",s)}}const R=async()=>{h.value=!0},q=async()=>{const{data:s,error:l,status:D}=await y(V,{method:"POST",body:{ato_id:b.query.ato_id,descricao:M.descricao,user_id:W("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");D.value==="success"&&(f.success("Anexo registrado com sucesso!"),m.value.push(s.value))};async function N(s){s.excluido=!s.excluido;try{await y(`${F}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$cdoFBGO0Ti")}catch(l){console.error("Erro ao excluir pessoa:",l)}}const J=()=>{const s=b.query.origem||"criar",l=b.query.id;s==="atualizar"?d.push(`/os/atualizar/${l}`):d.push("/os/criar-registro")};return(s,l)=>{const D=ne;return j(),ie(de,null,{default:t(()=>[e(P,null,{default:t(()=>[e(S,{cols:"5"},{default:t(()=>[e(ee,{modelValue:o(M).descricao,"onUpdate:modelValue":l[0]||(l[0]=a=>o(M).descricao=a),label:"Descrição"},null,8,["modelValue"])]),_:1}),g("div",{onClick:A,title:"Escanear"},l[3]||(l[3]=[g("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Qe,alt:"Escanear"},null,-1)])),g("div",{onClick:q,title:"Criar"},l[4]||(l[4]=[g("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ue,alt:"Criar"},null,-1)]))]),_:1}),e(ge,{headers:k,items:o(m),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:a})=>[e(P,null,{default:t(()=>[g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:i=>R(a),title:"Visualizar Anexo"},l[5]||(l[5]=[g("img",{style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar"},null,-1)]),8,_t),g("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:i=>N(a),title:"Deletar Pessoa"},[a.excluido?(j(),X("img",vt)):(j(),X("img",yt))],8,ft)]),_:2},1024)]),_:1},8,["items"]),e(Pe,{modelValue:o(h),"onUpdate:modelValue":l[2]||(l[2]=a=>ke(h)?h.value=a:null),width:"600"},{default:t(()=>[e(be,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(G,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:l[1]||(l[1]=a=>h.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(D,{onClick:J},{default:t(()=>[e(G,{size:"large",color:"red"},{default:t(()=>l[6]||(l[6]=[H("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Mt as _,Dt as a,St as b,jt as c,Ut as d,Rt as e};
