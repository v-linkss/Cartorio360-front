import{r as f,H as I,u as O,E as D,g as R,o as p,C as b,w as l,b as t,a as _,V,s as r,z as x,d as S,v as z,A as B,m as h,p as A,O as U,c as $}from"./CwU4kxTo.js";import{u as k}from"./BEW0F98I.js";import{V as q,c as M}from"./bQGkuzEm.js";import{V as E}from"./DD38bONR.js";import{V as T}from"./BiBFcqle.js";import{V as y}from"./CAOrvGLN.js";import{V as j}from"./CXW17CEK.js";import{_ as F,a as G}from"./DJvq3mCv.js";import{f as H}from"./B0IxRygJ.js";import{V as K}from"./cjTZzF5E.js";import"./C7M4mhBN.js";import"./C429a16G.js";import"./DeRk1mpv.js";import"./BQgWKnO7.js";const J={__name:"ImportaSelos",props:{show:Boolean,ato_token:String,ato_id:Number,representante_nome:String},emits:["close","update-papel"],setup(L,{emit:g}){const m=L,n=f(m.show);I();const u=B(),{$toast:v}=O(),o=`${u.public.ws}/fornecer_selos_por_lote`,w=`${u.public.managemant}/fornecer_selos`;f([]);const c=D({nuLote:null}),C=g;R(()=>m.show,async i=>{n.value=i,i&&await getPapeis()});const s=()=>{n.value=!1,C("close")},a=async()=>{const{data:i,error:e,status:d}=await k(o,{method:"POST",body:{user:"41140940406",pass:"RP6DEN",statusSelo:"D",nuLote:c.nuLote}},"$Z1bKGPif1c");if(d.value==="success"){const N=i.value.selos,{data:X,error:ee,status:P}=await k(w,{method:"POST",body:{tipo_id:1,cartorio_id:h("user-data").value.cartorio_id,selos:N,user_id:h("user-data").value.usuario_id}},"$Kr3yBtlYBF");P.value==="success"&&(v.success("Selos importados com sucesso"),s())}};return(i,e)=>(p(),b(j,{persistent:"",modelValue:r(n),"onUpdate:modelValue":e[1]||(e[1]=d=>z(n)?n.value=d:null),"max-width":"800"},{default:l(()=>[t(q,null,{default:l(()=>[t(E,null,{default:l(()=>[t(T,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:l(()=>[t(y,null,{default:l(()=>e[2]||(e[2]=[_("h1",{class:"ml-4"}," Importar selos do lote ",-1),_("p",{class:"ml-4 mt-3"}," Informe o codigo do lote para realizar a importação ",-1)])),_:1})]),_:1}),e[3]||(e[3]=_("hr",{class:"mb-5"},null,-1)),t(V,{label:"Lote",modelValue:r(c).nuLote,"onUpdate:modelValue":e[0]||(e[0]=d=>r(c).nuLote=d),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),t(M,null,{default:l(()=>[t(x,{style:{"background-color":"red",color:"white"},onClick:s},{default:l(()=>e[4]||(e[4]=[S("Voltar")])),_:1}),t(x,{style:{"background-color":"green",color:"white"},onClick:a},{default:l(()=>e[5]||(e[5]=[S("Importar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},W={class:"d-flex flex-column"},Y=["onClick"],Z={key:0,style:{width:"30px",height:"30px"},src:F,alt:"Visualizar",title:"Reativar"},Q={key:1,src:G,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},_e={__name:"index",setup(L){const g=B(),m=f([]),n=f(!1),u=f(!1),v=`${g.public.managemant}/selos`,o=D({dt_compra:"",numero:"",lote_compra:"",sequencia:"",sigla:""}),w=[{title:"Data de compra",value:"dt_compra"},{title:"Selo",value:"numero"},{title:"Valor de compra",value:"lote_compra"}],c=async()=>{u.value=!0;try{const{data:s,error:a,status:i}=await k(v,{method:"GET"},"$g9WNETx7rH");i.value==="success"?m.value=Array.isArray(s.value)?s.value.map(e=>({...e,dt_compra:e.dt_compra?H(e.dt_compra,"dd/mm/yyyy"):null})):[]:console.error(a)}catch(s){console.error("Erro ao buscar selos:",s)}finally{u.value=!1}},C=A(()=>m.value.filter(s=>(!o.dt_compra||s.dt_compra.toLowerCase().includes(o.dt_compra.toLowerCase()))&&(!o.numero||s.numero.toLowerCase().includes(o.numero.toLowerCase()))&&(!o.lote_compra||s.lote_compra.toLowerCase().includes(o.lote_compra.toLowerCase()))&&(!o.sequencia||s.sequencia.toLowerCase().includes(o.sequencia.toLowerCase()))&&(!o.sigla||s.sigla.toLowerCase().includes(o.sigla.toLowerCase()))));return c(),(s,a)=>{const i=J;return r(u)?(p(),b(U,{key:0,class:"d-flex justify-center align-center",indeterminate:"",size:"64",style:{position:"absolute",top:"40%",left:"50%"}})):(p(),b(E,{key:1,class:"mt-5"},{default:l(()=>[_("div",W,[t(x,{class:"mb-10 mt-auto align-self-end",color:"green",size:"large",onClick:a[0]||(a[0]=e=>n.value=!0)},{default:l(()=>a[5]||(a[5]=[S(" Importar Selos TJ ")])),_:1})]),t(T,{class:"mb-4",style:{gap:"10rem"}},{default:l(()=>[t(y,{cols:"12",md:"2"},{default:l(()=>[t(V,{modelValue:r(o).dt_compra,"onUpdate:modelValue":a[1]||(a[1]=e=>r(o).dt_compra=e),label:"Data de Compra","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(y,{cols:"12",md:"2"},{default:l(()=>[t(V,{modelValue:r(o).numero,"onUpdate:modelValue":a[2]||(a[2]=e=>r(o).numero=e),label:"Selo","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),t(y,{cols:"12",md:"2"},{default:l(()=>[t(V,{modelValue:r(o).lote_compra,"onUpdate:modelValue":a[3]||(a[3]=e=>r(o).lote_compra=e),label:"Valor de Compra","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(K,{density:"compact",headers:w,items:r(C),"item-key":"selo"},{"item.actions":l(({item:e})=>[_("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:d=>s.deleteObservacao(e),title:"Deletar Observação"},[e.excluido?(p(),$("img",Z)):(p(),$("img",Q))],8,Y)]),_:1},8,["items"]),t(i,{show:r(n),onClose:a[4]||(a[4]=e=>n.value=!1)},null,8,["show"])]),_:1}))}}};export{_e as default};
