import{_ as ee,a as te}from"./CZW0oE5c.js";import{_ as oe}from"./Cty_CyaO.js";import{_ as se}from"./BKDBdQx4.js";import{u as ae,E as ne,n as re,r as i,D as k,F as le,G as ie,o as ue,c as ce,b as t,w as r,q as s,O as me,a as l,x as de,s as C,J as O}from"./Cm--m2J4.js";import{u as h}from"./CXHp52tO.js";import{_ as R}from"./DCsXQasW.js";import{_ as pe,a as _e}from"./CrE-eFFQ.js";import{_ as ve}from"./ToPptOUL.js";import{V as fe,_ as ke}from"./BVkKH_Fn.js";import{V as y}from"./BA8kNxIu.js";import{V as c}from"./Cf0KQtn6.js";import"./BhPc0xpx.js";import"./Cer5jZQw.js";import"./Dq4r32f3.js";const he=l("h1",null,"Reconhecimento por Autencidade",-1),ye=["onClick"],ge=l("img",{style:{width:"30px",height:"30px"},src:R,alt:"Visualizar"},null,-1),Ve=[ge],be=["onClick"],we=l("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:_e,alt:"Remover"},null,-1),xe=[we],Ce=l("img",{class:"btn-pointer mt-10 mb-5",src:ve,alt:"Sair",style:{cursor:"pointer"}},null,-1),De={__name:"autencidade",props:{ato_token:{type:String,required:!0}},async setup(T){let p,$;const S=T,q=ae(),P=ne(),_=de(),{$toast:U}=re(),j=`${_.public.managemant}/listarEscrevente`,B=`${_.public.managemant}/pesquisarPessoas`,D=`${_.public.managemant}/atoReconhecimento`,z=`${_.public.managemant}/etiquetaAutenticidade`,v=i(k("user-data").value.cartorio_token),I=i(k("user-service").value.token).value||i(k("user-service").value).value,N=k("auth_token").value,g=i([]),E=i([]),m=i([]),V=i(!1),b=i(!1),w=i(!1),x=i(null),A=i(""),F=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],n=le({quantidade:1,escrevente:null,nome:null,documento:null}),{data:K}=([p,$]=ie(()=>h(j,{method:"POST",body:{cartorio_token:v}},"$qpB20nOlUE")),p=await p,$(),p);E.value=K.value[0].func_json_escreventes;async function L(){try{const{data:o,error:e}=await h(B,{method:"POST",body:{cartorio_token:v.value,documento:n.documento,nome:n.nome}},"$CfpM9wZnUE");o.value.length>0?g.value=o.value:g.value=[]}catch(o){console.error("Erro na requisição",o)}}const Q=()=>{b.value=!0};function Z(o){m.value.push(o)}const G=o=>{x.value=o,w.value=!0};function H(o){m.value=m.value.filter(e=>e.token!==o.token)}async function J(){if(!n.escrevente){U.error("Por favor selecione um Escrevente");return}try{const o=m.value.map(u=>({pessoa_token:u.token})),{data:e,error:f,status:d}=await h(D,{method:"POST",body:{pessoas:o,cartorio_token:v.value,ordemserv_token:I,quantidade:n.quantidade,usuario_token:N,ato_tipo_token:S.ato_token}},"$LrKAtpxZwH");d.value==="success"&&e.value[0].status==="OK"?(W(e.value[0].token),M()):(V.value=!0,A.value=ato_token.value.status_mensagem||f.value.data.details)}catch(o){console.error("Erro na requisição",o)}}async function W(o){try{const{data:e,error:f,status:d}=await h(z,{method:"POST",body:{ato_token:o,cartorio_token:v.value,escrevente_token:n.escrevente}},"$EE94jKo1pQ");if(d.value==="success"){const u=window.open("","_blank");u.document.open(),u.document.write(e.value[0].etiqueta),u.document.close()}}catch(e){console.error("Erro na requisição",e)}}const M=()=>{const o=P.query.origem||"criar",e=P.query.id;o==="atualizar"?q.push(`/ordens-servicos/atualizar/${e}`):q.push("/ordens-servicos/criar-registro")};return(o,e)=>{const f=ee,d=te,u=oe,X=se;return ue(),ce(me,null,[he,t(y,{class:"mt-5"},{default:r(()=>[t(c,{cols:"5"},{default:r(()=>[t(fe,{label:"Tabelião/escrevente",modelValue:s(n).escrevente,"onUpdate:modelValue":e[0]||(e[0]=a=>s(n).escrevente=a),items:s(E),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"2"},{default:r(()=>[t(C,{label:"Quantidade",type:"number",modelValue:s(n).quantidade,"onUpdate:modelValue":e[1]||(e[1]=a=>s(n).quantidade=a)},null,8,["modelValue"])]),_:1})]),_:1}),t(y,null,{default:r(()=>[t(c,{cols:"3"},{default:r(()=>[t(C,{label:"Documento",modelValue:s(n).documento,"onUpdate:modelValue":e[2]||(e[2]=a=>s(n).documento=a)},null,8,["modelValue"])]),_:1}),t(c,{cols:"4"},{default:r(()=>[t(C,{label:"Pessoa",modelValue:s(n).nome,"onUpdate:modelValue":e[3]||(e[3]=a=>s(n).nome=a)},null,8,["modelValue"])]),_:1}),l("div",null,[l("img",{class:"btn-pointer mt-3",src:R,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:L})]),l("div",null,[l("img",{class:"btn-pointer mt-3 ml-2",src:pe,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Q})])]),_:1}),t(y,null,{default:r(()=>[t(c,{class:"mr-10"},{default:r(()=>[t(O,{style:{height:"465px"},headers:F,items:s(g)},{"item.actions":r(({item:a})=>[l("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:Y=>G(a),title:"Visualizar Ficha"},Ve,8,ye)]),_:1},8,["items"])]),_:1}),t(c,null,{default:r(()=>[t(O,{headers:F,items:s(m),style:{height:"465px"},"item-key":"id"},{"item.actions":r(({item:a})=>[l("div",{style:{display:"flex","justify-content":"flex-end"},onClick:Y=>H(a),title:"Remover"},xe,8,be)]),_:1},8,["items"])]),_:1})]),_:1}),t(f,{show:s(b),onClose:e[4]||(e[4]=a=>b.value=!1)},null,8,["show"]),t(d,{show:s(w),item:s(x),onConfirmar:e[5]||(e[5]=a=>Z(s(x))),onClose:e[6]||(e[6]=a=>w.value=!1)},null,8,["show","item"]),t(y,null,{default:r(()=>[t(u,{onClick:M},{default:r(()=>[Ce]),_:1}),l("div",null,[l("img",{class:"mt-10 mb-5 ml-10",onClick:J,style:{cursor:"pointer"},src:ke})])]),_:1}),t(X,{show:s(V),errorMessage:s(A),onClose:e[7]||(e[7]=a=>V.value=!1)},null,8,["show","errorMessage"])],64)}}};export{De as default};
