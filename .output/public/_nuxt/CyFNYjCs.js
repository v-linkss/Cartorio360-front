import{_ as de}from"./DmuEGno1.js";import{u as oe,C as ie,H as ae,r as l,D as me,o as h,G as I,w as o,b as e,v as t,V as ne,A as W,d as Z,J,s as se,m as X,I as ce,a as V,c as Y,x as ue,N as Ne,n as Ie,O as Je,F as $e,g as ze,P as Ve,t as _e}from"./SG2ImWtc.js";import{u as b}from"./TsLX9HyX.js";import{V as R}from"./D0FEAVpf.js";import{V as B}from"./DV4Urdjz.js";import{V as le}from"./HFFXsIWM.js";import{V as pe}from"./Dlv4cljS.js";import{_ as Ue,a as Le}from"./PwKENb87.js";import{_ as Be,a as Ye,b as We,T as Ze,W as Qe,S as Xe,r as Te,D as Se,c as Ge,d as He}from"./DMeovgO3.js";import{_ as Ae}from"./CyWe8HPP.js";import{_ as fe,a as ke,b as he}from"./BP1uhy__.js";import{_ as Ke}from"./BjF43Tf3.js";import{V as xe}from"./CYsaaxGh.js";import{V as we}from"./Cwcv_F8c.js";import{V as ve,c as et}from"./BHO5qa_o.js";import{_ as Pe}from"./Bik9x1y6.js";import{c as tt,r as ot,u as at}from"./DcBgFAjU.js";import{_ as be}from"./CVilXGDu.js";const Nt={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(ee){const f=ee,{$toast:T}=oe(),C=se(),v=ie(),u=ae(),y=`${C.public.managemant}/updateAtos`,x=l(f.item_situacoes),U=l(u.query.origem==="vizualizar"),S=me({dt_abertura:f.item_dados[0].dt_abertura||null,status:f.item_dados[0].status||null,mne:f.item_dados[0].mne||null});async function L(){const{data:k,error:g,status:O}=await b(`${y}/${u.query.ato_id}`,{method:"PUT",body:{status:S.status,mne:S.mne,dt_abertura:S.dt_abertura}},"$EIT5jtTUdX");O.value==="success"&&T.success("Ato Atualizado com sucesso")}const z=()=>{const k=u.query.origem||"criar",g=u.query.id;k==="atualizar"||k==="vizualizar"?v.push(`/os/atualizar/${g}`):v.push("/os/criar-registro")};return(k,g)=>{const O=de;return h(),I(pe,null,{default:o(()=>[e(R,{class:"mt-5"},{default:o(()=>[e(B,{cols:"3"},{default:o(()=>[e(le,{label:"Situação",modelValue:t(S).status,"onUpdate:modelValue":g[0]||(g[0]=_=>t(S).status=_),items:t(x),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(R,null,{default:o(()=>[e(B,{cols:"5"},{default:o(()=>[e(ne,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:t(S).mne,"onUpdate:modelValue":g[1]||(g[1]=_=>t(S).mne=_)},null,8,["modelValue"])]),_:1})]),_:1}),e(R,null,{default:o(()=>[e(B,{cols:"2"},{default:o(()=>[e(ne,{modelValue:t(S).dt_abertura,"onUpdate:modelValue":g[2]||(g[2]=_=>t(S).dt_abertura=_),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(R,{class:"mb-3"},{default:o(()=>[e(O,{onClick:z},{default:o(()=>[e(W,{size:"large",color:"red"},{default:o(()=>g[3]||(g[3]=[Z("Voltar")])),_:1})]),_:1}),t(U)?J("",!0):(h(),I(W,{key:0,class:"ml-10",onClick:L,size:"large",color:"green"},{default:o(()=>g[4]||(g[4]=[Z("Atualizar")])),_:1}))]),_:1})]),_:1})}}},st={key:0},rt=["onClick"],nt=["onClick"],lt=["onClick"],it={key:0,style:{width:"30px",height:"30px"},src:ke,alt:"Visualizar",title:"Reativar"},ut={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},ct=["onClick"],It={__name:"Partes",async setup(ee){let f,T;const C=ie(),v=ae(),u=se(),{$toast:y}=oe(),x=`${u.public.managemant}/pesquisarPessoas`,U=`${u.public.managemant}/listarPapeis`,S=`${u.public.managemant}/getLinkTipo`,L=`${u.public.managemant}/createAtosPessoa`,z=`${u.public.managemant}/updateAtosPessoa`,k=`${u.public.managemant}/getAtosPessoaById`,g=`${u.public.managemant}/download`,O=l(X("user-data").value.cartorio_token),_=l(v.query.origem==="vizualizar"),$=l([]),N=l([]),F=l([]),P=l(!1),E=l(!1),c=l(!1),q=l(!1),H=l(null),w=l(null),n=l(null),d=l(null),a=l(null),s=l(v.query.tipo_ato_token),r=l(null),m=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],p=me({papeis:null,nome:null,pessoa:null,documento:null}),{data:D}=([f,T]=ce(()=>b(U,{method:"POST",body:{tipo_ato_token:v.query.tipo_ato_token}},"$acoiTIUp00")),f=await f,T(),f);F.value=D.value;const j=async()=>{const{data:A}=await b(`${k}/${v.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),Q=(te=>te.map(G=>({...G,pessoa:{...G.pessoa,documento:G.pessoa.doc_identificacao},papel:{...G.partes_tipos}})))(A.value);N.value=Q};j();async function re(){try{const{data:A,error:i}=await b(x,{method:"POST",body:{cartorio_token:O.value,documento:p.documento,nome:p.nome}},"$pr30MyPXfY");A.value.length>0?($.value=A.value,p.pessoa=$.value[0]):$.value=[]}catch(A){console.error("Erro na requisição",A)}}const ye=()=>{E.value=!0},Ce=async()=>{await j()},Ee=async()=>{await j()},De=async()=>{const A={pessoa:p.pessoa,papel:F.value.find(K=>K.id===p.papeis),representante:{nome:null}},i=await b(`${k}/${v.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const K of i.data.value)if(K.pessoa_id===p.pessoa.id&&K.ato_id===Number(v.query.ato_id)&&K.tipo_parte_id===p.papeis){y.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:Q,error:te,status:G}=await b(L,{method:"POST",body:{ato_id:Number(v.query.ato_id),pessoa_id:p.pessoa.id,tipo_parte_id:p.papeis,user_id:X("user-data").value.usuario_id}},"$18isAgOJxG");G.value==="success"?(A.id=Q.value.id,y.success("Pessoa Registrada com Sucesso!"),N.value.push(A)):y.error(te.value.message)},Me=async A=>{var K;if(c.value=!0,r.value=null,!A.pessoa.id)return;const{data:i}=await b(S,{method:"POST",body:{tipo:"ficha",id:A.pessoa.id}},"$hmDzSF3F61");if(!((K=i.value)!=null&&K.link))return;const{data:Q}=await b(g,{method:"POST",body:{bucket:"qvgjz",path:i.value.link}},"$l09I6nLRfk"),te=i.value.link,G=Q.value;/\.(tr7|tiff)$/i.test(te)?r.value=G:fotoRender.value=`data:image/jpeg;base64,${G}`},Oe=A=>{const i=N.value.filter(Q=>Q.pessoa.id!==A.pessoa.id).map(Q=>({id:Q.pessoa.id,nome:Q.pessoa.nome}));n.value=A.id,H.value=i,P.value=!0,w.value=A.pessoa.nome,a.value=A.pessoa.id},qe=A=>{q.value=!0,d.value=A.id,w.value=A.pessoa.nome};async function Re(A){A.excluido=!A.excluido;try{await b(`${z}/${A.id}`,{method:"PUT",body:JSON.stringify({excluido:A.excluido})},"$PUt0nEhmBF")}catch(i){console.error("Erro ao excluir pessoa:",i)}}const Fe=()=>{const A=v.query.origem||"criar",i=v.query.id;A==="atualizar"||A==="vizualizar"?C.push(`/os/atualizar/${i}`):C.push("/os/criar-registro")};return(A,i)=>{const Q=Ue,te=Ye,G=We,K=Le,je=de;return h(),I(pe,null,{default:o(()=>[t(_)?J("",!0):(h(),I(R,{key:0,class:"mt-5"},{default:o(()=>[e(B,{cols:"3"},{default:o(()=>[e(ne,{label:"Documento",modelValue:t(p).documento,"onUpdate:modelValue":i[0]||(i[0]=M=>t(p).documento=M)},null,8,["modelValue"])]),_:1}),e(B,{cols:"4"},{default:o(()=>[e(ne,{label:"Pessoa",modelValue:t(p).nome,"onUpdate:modelValue":i[1]||(i[1]=M=>t(p).nome=M)},null,8,["modelValue"])]),_:1}),V("div",null,[V("img",{class:"mt-1",src:Ae,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:re})]),V("div",null,[V("img",{class:"mt-1 ml-2",src:fe,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ye})])]),_:1})),t(_)?J("",!0):(h(),I(R,{key:1},{default:o(()=>[e(B,{cols:"4"},{default:o(()=>[e(le,{label:"Selecione a Pessoa",modelValue:t(p).pessoa,"onUpdate:modelValue":i[2]||(i[2]=M=>t(p).pessoa=M),items:t($),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(B,{cols:"3"},{default:o(()=>[e(le,{label:"Papel",modelValue:t(p).papeis,"onUpdate:modelValue":i[3]||(i[3]=M=>t(p).papeis=M),items:t(F),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),t(_)?J("",!0):(h(),Y("div",st,[V("img",{class:"mt-1",src:fe,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:De})]))]),_:1})),e(R,null,{default:o(()=>[e(B,null,{default:o(()=>[e(xe,{style:{height:"465px"},headers:m,items:t(N)},{"item.actions":o(({item:M})=>[t(_)?J("",!0):(h(),I(R,{key:0},{default:o(()=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ge=>Me(M),title:"Visualizar Ficha"},i[9]||(i[9]=[V("img",{style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar"},null,-1)]),8,rt),V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ge=>qe(M),class:"mr-2",title:"Alterar Papel"},i[10]||(i[10]=[V("img",{style:{width:"30px",height:"30px"},src:Ke,alt:"Visualizar"},null,-1)]),8,nt),V("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ge=>Re(M),title:"Deletar Pessoa"},[M.excluido?(h(),Y("img",it)):(h(),Y("img",ut))],8,lt),V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ge=>Oe(M),title:"Selecionar Representante"},i[11]||(i[11]=[V("img",{style:{width:"30px",height:"30px"},src:Be,alt:"Visualizar"},null,-1)]),8,ct)]),_:2},1024))]),_:1},8,["items"])]),_:1})]),_:1}),e(Q,{show:t(E),onClose:i[4]||(i[4]=M=>E.value=!1)},null,8,["show"]),e(te,{representante_nome:t(w),representantes:t(H),ato_id:t(n),show:t(P),onClose:i[5]||(i[5]=M=>P.value=!1),onUpdateRepresentante:Ee},null,8,["representante_nome","representantes","ato_id","show"]),e(G,{representante_nome:t(w),ato_token:t(s),ato_id:t(d),show:t(q),onClose:i[6]||(i[6]=M=>q.value=!1),onUpdatePapel:Ce},null,8,["representante_nome","ato_token","ato_id","show"]),e(we,{modelValue:t(c),"onUpdate:modelValue":i[8]||(i[8]=M=>ue(c)?c.value=M:null),width:"600"},{default:o(()=>[e(ve,{"max-width":"600",title:"Ficha"},{default:o(()=>[e(K,{"tiff-url":t(r)},null,8,["tiff-url"]),e(W,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:i[7]||(i[7]=M=>c.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(R,null,{default:o(()=>[e(je,{onClick:Fe},{default:o(()=>[e(W,{size:"large",color:"red"},{default:o(()=>i[12]||(i[12]=[Z("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},dt={key:0,class:"loading-overlay"},mt="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Jt={__name:"Minuta",emits:["page","doc"],setup(ee,{emit:f}){Ne("DocumentEditorContainer",[Ze,Qe,Xe]);const T=se(),{$toast:C}=oe(),v=ie(),u=ae(),y=f;Te(`${T.public.docEditor}`);const x=`${T.public.managemant}/download`,U=`${T.public.managemant}/atos/files`,S=`${T.public.managemant}/subitituirModelo`,L=`${T.public.managemant}/upload`,z=l(null),k=l(!1),g=l("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),O=l(u.query.origem==="vizualizar"),_=l(!1),$=async a=>{try{const s=await fetch(a);if(!s.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await s.blob()}catch(s){return console.error(s),null}},N=async()=>{try{const{data:a}=await b(`${U}/${u.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return a.value.link_ato}catch(a){console.error("Erro ao carregar o documento:",a),C.error(a)}},F=async()=>{_.value=!0;try{const a=await N(),{data:s,status:r}=await b(x,{method:"POST",body:{bucket:"qvgjz",path:a}},"$dvNFfvmIJC"),m=s.value,p=await $(m);if(p){const D=new FileReader;D.onload=()=>{const j=D.result;z.value.ej2Instances.documentEditor.open(j),y("doc",j)},D.readAsText(p)}}catch{console.error("Erro ao carregar o documento.")}finally{_.value=!1}},P=async()=>{const s=await z.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),r=new FileReader;r.onload=()=>{const m=r.result,D=z.value.ej2Instances.documentEditor.pageCount;y("page",D),y("doc",m)},r.readAsText(s)},E=async()=>{_.value=!0;try{const s=await z.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),r=new FormData;r.append("file",s,"anexo.sfdt"),r.append("cartorio_token",X("user-data").value.cartorio_token),r.append("token",u.query.ato_token_edit),r.append("tipo","ato_minuta");const{data:m,status:p}=await b(L,{method:"POST",body:r},"$xv11VtUdMy");if(p.value==="success"){C.success("Documento enviado!");const j=z.value.ej2Instances.documentEditor.pageCount;P(),y("page",j)}else C.error("Erro ao enviar documento para o sistema.")}catch(a){C.error("Erro ao salvar documento."),console.error(a)}finally{_.value=!1}},c=()=>{k.value=!1,q()},q=async()=>{n(!0);try{await H(),n(!0);const{data:a,status:s}=await b(S,{method:"POST",body:{ato_token:u.query.ato_token_edit}},"$zyzWHTXTBW");a.value&&w(a.value)}catch(a){console.error("Erro ao gerar a minuta:",a),C.error("Ocorreu um erro ao gerar a minuta.")}finally{n(!1)}},H=async()=>{try{const{data:a}=await b(x,{method:"POST",body:{bucket:"qvgjz",path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),s=await $(a.value);if(s){const r=new FileReader;r.onload=()=>{const m=r.result;z.value.ej2Instances.documentEditor.open(m),y("doc",m)},r.readAsText(s)}}catch(a){console.error("Erro ao carregar o modelo de minuta:",a)}},w=a=>{const s=z.value.ej2Instances.documentEditor,r=m=>{for(const[p,D]of Object.entries(m))if(/^<<.+>>$/.test(p))try{s.search.findAll(p),s.search.searchResults.length>0&&s.search.searchResults.replaceAll(D)}catch(j){console.error(`Erro ao substituir o marcador ${p}:`,j)}else if(p==="partes"&&Array.isArray(D)&&D.length>0)for(const j of D)typeof j=="object"&&r(j)};r(a)},n=a=>{_.value=a},d=()=>{const a=u.query.origem||"criar",s=u.query.id;a==="atualizar"||a==="vizualizar"?v.push(`/os/atualizar/${s}`):v.push("/os/criar-registro")};return Ie(async()=>{await F(),P()}),(a,s)=>{const r=de,m=Pe;return h(),Y($e,null,[e(t(Se),{height:"900px",ref_key:"documentEditorContainer",ref:z,serviceUrl:mt,enableToolbar:!0,enableWordExport:!0},null,512),t(_)?(h(),Y("div",dt,[e(Je,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):J("",!0),e(R,{class:"ml-4 mt-4 mb-4"},{default:o(()=>[e(r,{class:"mr-4"},{default:o(()=>[e(W,{size:"large",onClick:d,color:"red"},{default:o(()=>s[2]||(s[2]=[Z("Voltar")])),_:1})]),_:1}),t(O)?J("",!0):(h(),I(W,{key:0,size:"large",color:"green",onClick:E,disabled:t(_)},{default:o(()=>s[3]||(s[3]=[Z("Atualizar")])),_:1},8,["disabled"])),t(O)?J("",!0):(h(),I(W,{key:1,class:"ml-4",size:"large",color:"blue",onClick:s[0]||(s[0]=p=>k.value=!0)},{default:o(()=>s[4]||(s[4]=[Z("Gerar Minuta")])),_:1}))]),_:1}),e(m,{onConfirm:c,condMessage:t(g),show:t(k),onClose:s[1]||(s[1]=p=>k.value=!1)},null,8,["condMessage","show"])],64)}}},pt=["innerHTML"],Ut={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(ee){let f,T;const C=ee,v=se();Te(`${v.public.docEditor}`);const{$toast:u}=oe(),y=ie(),x=ae(),U=`${v.public.managemant}/download`,S=`${v.public.managemant}/atos/files`,L=`${v.public.managemant}/lavrarAto`,z=`${v.public.managemant}/listarEscrevente`,k=l(X("user-data").value.cartorio_token),g=X("auth_token").value,O=l("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),_=l(!1),$=l(null),N=l(null),F=l(x.query.origem==="vizualizar"),P=l(null),E=l([]),c=me({escrevente:null}),q=async r=>{try{const m=await fetch(r);if(!m.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await m.blob()}catch(m){return console.error(m),null}},H=async()=>{try{const{data:r}=await b(`${S}/${x.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return r.value.link_ato}catch(r){console.error("Erro ao carregar o documento:",r),u.error(r)}},w=async()=>{try{const r=await H(),{data:m,status:p}=await b(U,{method:"POST",body:{bucket:"qvgjz",path:r}},"$7ljqltMqa0"),D=m.value,j=await q(D);if(j){const re=new FileReader;re.onload=()=>{const ye=re.result;P.value.ej2Instances.documentEditor.open(ye)},re.readAsText(j)}}catch{u.error("Erro ao carregar o documento.")}};w();const n=async()=>{try{const{data:r,status:m}=await b(L,{method:"POST",body:{ato_token:x.query.ato_token_edit,qtd_paginas:C.pages,escrevente_token:c.escrevente,usuario_token:g,cartorio_token:k}},"$OWxZSQkyX8");m.value==="success"?($.value=r.value,N.value=r.value[0].selo,u.success("Ato lavrado com sucesso!")):u.error("Falha ao lavrar o ato.")}catch{u.error("Erro ao conectar com o servidor.")}},d=()=>{_.value=!1,n()},{data:a}=([f,T]=ce(()=>b(z,{method:"POST",body:{cartorio_token:k}},"$sMqfUUQcBM")),f=await f,T(),f);E.value=a.value[0].func_json_escreventes;const s=()=>{const r=x.query.origem||"criar",m=x.query.id;r==="atualizar"&&(r==="atualizar"||r==="vizualizar"?y.push(`/os/atualizar/${m}`):y.push("/os/criar-registro"))};return ze(()=>C.document,(r,m)=>{w()}),(r,m)=>{const p=Pe;return h(),Y($e,null,[e(R,null,{default:o(()=>[e(B,null,{default:o(()=>[e(t(Se),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:P,height:"850px",width:"850px"},null,512)]),_:1}),t(F)?J("",!0):(h(),I(B,{key:0},{default:o(()=>[e(le,{class:"mt-15",label:"Tabelião/escrevente",modelValue:t(c).escrevente,"onUpdate:modelValue":m[0]||(m[0]=D=>t(c).escrevente=D),items:t(E),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),V("img",{onClick:m[1]||(m[1]=D=>_.value=!0),style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Ge}),t($)?(h(),I(ve,{key:0,width:"360"},{default:o(()=>[e(R,null,{default:o(()=>[e(B,null,{default:o(()=>[e(Ve,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:o(()=>[Z(" Livro: "+_e(t($)[0].livro_numero),1)]),_:1})]),_:1}),e(B,null,{default:o(()=>[e(Ve,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:o(()=>[Z(" Folhas : "+_e(t($)[0].pagina_inicial)+" A "+_e(t($)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),V("div",{style:{"margin-left":"10px","padding-bottom":"20px","margin-top":"-10px"},innerHTML:t(N)},null,8,pt)]),_:1})):J("",!0)]),_:1}))]),_:1}),e(W,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:s},{default:o(()=>m[3]||(m[3]=[Z("Voltar")])),_:1}),e(p,{show:t(_),condMessage:t(O),onClose:m[2]||(m[2]=D=>_.value=!1),onConfirm:d},null,8,["show","condMessage"])],64)}}},ft=["onClick"],vt={key:0,style:{width:"30px",height:"30px"},src:ke,alt:"Visualizar",title:"Reativar"},yt={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Lt={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(ee){let f,T;const C=ie(),v=ae(),u=se(),{$toast:y}=oe(),x=`${u.public.managemant}/listarEscrevente`;`${u.public.managemant}`;const U=`${u.public.managemant}/atos_observacao`,S=`${u.public.managemant}/atos_observacao`,L=`${u.public.managemant}/atos_observacao`,z=l(X("user-data").value.cartorio_token),k=l(v.query.origem==="vizualizar"),g=l([]),O=l([]),_=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],$=me({observacao:""}),N={observacao:{required:tt.withMessage("O campo é obrigatório",ot)}},F=at(N,$),{data:P}=([f,T]=ce(()=>b(`${L}/${v.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),f=await f,T(),f);Array.isArray(P.value)?g.value=P.value.map(w=>({...w,created:be(w.created,"dd/mm/yyyy hh:mm")})):P.value&&typeof P.value=="object"&&(g.value=[{...P.value,created:be(P.value.created,"dd/mm/yyyy hh:mm")}]);async function E(){if($.observacao.trim()===""){y.error("O campo de observação está vazio.");return}if(await F.value.$validate()){const{data:w,error:n,status:d}=await b(U,{method:"POST",body:{ato_id:Number(v.query.ato_id),observacao:$.observacao,user_id:X("user-data").value.usuario_id}},"$gnHMo4uCXD");d.value==="success"&&(g.value.push({created:be(w.value.created,"dd/mm/yyyy hh:mm"),observacao:w.value.observacao,id:w.value.id,escrevente:X("user-data").value.nome}),$.observacao="",y.success("Observação registrada com sucesso"))}else y.error("Preencha os campos obrigatórios.")}async function c(w){w.excluido=!w.excluido;try{await b(`${S}/${w.id}`,{method:"PUT",body:JSON.stringify({excluido:w.excluido})},"$sP9AKdd3Ky")}catch(n){console.error("Erro ao excluir observação:",n)}}const{data:q}=([f,T]=ce(()=>b(x,{method:"POST",body:{cartorio_token:z}},"$HL9pndqGh0")),f=await f,T(),f);O.value=q.value[0].func_json_escreventes;const H=()=>{const w=v.query.origem||"criar",n=v.query.id;w==="atualizar"||w==="vizualizar"?C.push(`/os/atualizar/${n}`):C.push("/os/criar-registro")};return(w,n)=>{const d=de;return h(),I(pe,null,{default:o(()=>[k.value?J("",!0):(h(),I(R,{key:0,class:"mt-5"},{default:o(()=>[e(ne,{label:"Observação",modelValue:$.observacao,"onUpdate:modelValue":n[0]||(n[0]=a=>$.observacao=a),required:"","error-messages":t(F).observacao.$errors.length>0?t(F).observacao.$errors.map(a=>a.$message):[],onBlur:t(F).observacao.$touch,onInput:t(F).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),V("div",null,[V("img",{class:"btn-pointer ml-2",src:fe,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:E})])]),_:1})),e(R,null,{default:o(()=>[e(B,null,{default:o(()=>[e(xe,{style:{height:"465px"},headers:_,items:g.value},{"item.actions":o(({item:a})=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:s=>c(a),title:"Deletar Observação"},[a.excluido?(h(),Y("img",vt)):(h(),Y("img",yt))],8,ft)]),_:1},8,["items"])]),_:1})]),_:1}),e(R,null,{default:o(()=>[e(d,{onClick:H},{default:o(()=>[e(W,{size:"large",color:"red"},{default:o(()=>n[1]||(n[1]=[Z("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},gt="data:image/png;base64,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",_t=["onClick"],bt=["onClick"],At={key:0,style:{width:"30px",height:"30px"},src:ke,alt:"Visualizar",title:"Reativar"},kt={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Bt={__name:"Anexos",async setup(ee){let f,T;const C=se(),{$toast:v}=oe(),u=ie(),y=ae(),x=l(y.query.origem==="vizualizar"),U=`${C.public.biometria}/run-scanner`,S=`${C.public.managemant}/atos_anexos`,L=`${C.public.managemant}/atos_anexos`,z=`${C.public.managemant}/atos_anexos`,k=l(!1),g=l([]),O=me({descricao:""}),_=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:$}=([f,T]=ce(()=>b(`${z}/${y.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),f=await f,T(),f);g.value=$.value;async function N(){try{await F(),await P()}catch(n){console.error("Erro ao executar scanner ou listar arquivos:",n)}}async function F(){try{const{data:n}=await b(U,{method:"GET"},"$KttjFhHivJ")}catch(n){v.error("Erro ao acionar o scanner:",n)}}async function P(){try{const{data:n,status:d}=await b("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:y.query.ato_token_edit,cartorio_token:X("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(n){console.error("Erro ao enviar o arquivo:",n)}}async function E(){try{const n=document.createElement("input");n.type="file",n.accept="*/*",n.onchange=async d=>{const a=d.target.files[0];a&&console.log(a)},n.click()}catch(n){console.error("Erro ao abrir o explorador de arquivos:",n)}}const c=async()=>{k.value=!0},q=async()=>{const{data:n,error:d,status:a}=await b(S,{method:"POST",body:{ato_id:y.query.ato_id,descricao:O.descricao,user_id:X("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");a.value==="success"&&(v.success("Anexo registrado com sucesso!"),g.value.push(n.value))};async function H(n){n.excluido=!n.excluido;try{await b(`${L}/${n.id}`,{method:"PUT",body:JSON.stringify({excluido:n.excluido})},"$cdoFBGO0Ti")}catch(d){console.error("Erro ao excluir pessoa:",d)}}const w=()=>{const n=y.query.origem||"criar",d=y.query.id;n==="atualizar"||n==="vizualizar"?u.push(`/os/atualizar/${d}`):u.push("/os/criar-registro")};return(n,d)=>{const a=de;return h(),I(pe,null,{default:o(()=>[e(R,null,{default:o(()=>[e(B,{cols:"5",class:"mt-2"},{default:o(()=>[t(x)?J("",!0):(h(),I(ne,{key:0,modelValue:t(O).descricao,"onUpdate:modelValue":d[0]||(d[0]=s=>t(O).descricao=s),label:"Descrição"},null,8,["modelValue"]))]),_:1}),t(x)?J("",!0):(h(),Y("div",{key:0,onClick:N,title:"Escanear"},d[3]||(d[3]=[V("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:He,alt:"Escanear"},null,-1)]))),t(x)?J("",!0):(h(),Y("div",{key:1,onClick:E,title:"Criar"},d[4]||(d[4]=[V("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:gt,alt:"Criar"},null,-1)]))),t(x)?J("",!0):(h(),Y("div",{key:2,onClick:q,title:"Criar"},d[5]||(d[5]=[V("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:fe,alt:"Criar"},null,-1)])))]),_:1}),e(xe,{headers:_,items:t(g),style:{height:"465px","max-width":"600px"}},{"item.actions":o(({item:s})=>[e(R,null,{default:o(()=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:r=>c(s),title:"Visualizar Anexo"},d[6]||(d[6]=[V("img",{style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar"},null,-1)]),8,_t),V("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:r=>H(s),title:"Deletar Pessoa"},[s.excluido?(h(),Y("img",At)):(h(),Y("img",kt))],8,bt)]),_:2},1024)]),_:1},8,["items"]),e(we,{modelValue:t(k),"onUpdate:modelValue":d[2]||(d[2]=s=>ue(k)?k.value=s:null),width:"600"},{default:o(()=>[e(ve,{"max-width":"600",title:"Anexo"},{default:o(()=>[e(W,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:d[1]||(d[1]=s=>k.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(a,{onClick:w},{default:o(()=>[e(W,{size:"large",color:"red"},{default:o(()=>d[7]||(d[7]=[Z("Voltar")])),_:1})]),_:1})]),_:1})}}},Yt={__name:"TiposAtos",props:{show:Boolean,servicos:Array,tiposAtos:Array},emits:["close","update-ato"],setup(ee,{emit:f}){const C=l(ee.show),{$toast:v}=oe(),u=ae(),y=l(""),x=l(""),U=se(),S=X("auth_token").value,L=l(X("user-data").value.cartorio_token).value,z=l([]),k=l([]),g=f,O=`${U.public.managemant}/updateAtos`,_=`${U.public.managemant}/tipoAtos`,$=async()=>{const{data:E}=await b(_,{method:"POST",body:{usuario_token:S,cartorio_token:L}},"$6VlNS7ylT6");z.value=E.value,z.value.length>0&&(y.value=z.value[0])},N=async E=>{const{data:c}=await b(_,{method:"POST",body:{usuario_token:S,cartorio_token:L,servico_token:E}},"$pRqAaiCpuA");k.value=c.value},F=async()=>{const{data:E,status:c}=await b(`${O}/${u.query.ato_id}`,{method:"PUT",body:{ato_tipo_id:x.value.id}},"$Qxfq8aWnXP");c.value==="success"&&(v.success("Tipo de ato atualizado com Sucesso!"),g("update-ato",{descricao:`${y.value.descricao} - ${x.value.descricao}`,usaImoveisParams:x.value.usa_imoveis}),P())},P=()=>{C.value=!1,g("close")};return ze(y,async E=>{E&&(await N(E.token),x.value=k.value.length>0?k.value[0]:null)}),$(),(E,c)=>(h(),I(we,{persistent:"",modelValue:t(C),"onUpdate:modelValue":c[3]||(c[3]=q=>ue(C)?C.value=q:null),"max-width":"500"},{default:o(()=>[e(ve,null,{default:o(()=>[e(pe,null,{default:o(()=>[e(R,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:o(()=>c[4]||(c[4]=[V("h1",{class:"ml-4"},"Tipos de Atos",-1)])),_:1}),c[5]||(c[5]=V("hr",{class:"mb-5"},null,-1)),e(le,{"item-title":"descricao","item-value":"token",class:"mb-5",label:"Selecione o Serviço",modelValue:t(y),"onUpdate:modelValue":c[0]||(c[0]=q=>ue(y)?y.value=q:null),items:t(z),"return-object":""},null,8,["modelValue","items"]),e(le,{"item-title":"descricao","item-value":"id",class:"mb-5",label:"Selecione o Tipo de Ato",modelValue:t(x),"onUpdate:modelValue":c[1]||(c[1]=q=>ue(x)?x.value=q:null),items:t(k),"return-object":""},null,8,["modelValue","items"])]),_:1}),e(et,null,{default:o(()=>[e(W,{style:{"background-color":"red",color:"white"},onClick:P},{default:o(()=>c[6]||(c[6]=[Z("Voltar")])),_:1}),e(W,{style:{"background-color":"green",color:"white"},onClick:c[2]||(c[2]=q=>F())},{default:o(()=>c[7]||(c[7]=[Z("Salvar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{Yt as _,Nt as a,It as b,Jt as c,Ut as d,Lt as e,Bt as f};
