import{_ as Q}from"./D2vJ64Ox.js";import{_ as W,a as ee,b as te}from"./Cu1bLSGF.js";import{_ as ae,V as oe,a as se,b as re,c as ne}from"./paxI6nei.js";import{c as B,r as U,u as le}from"./CPhUGWrC.js";import{n as ie,m as ue,u as de,r as u,p as g,q as pe,s as z,L as me,v as V,w as n,A as ce,o as c,b as r,a as l,t as _e,x as a,M as fe,B as w,N as ve,O as ge,c as I,z as ke,d as he}from"./CNAiVaQm.js";import{u as C}from"./-ksdFIuP.js";import{V as $e}from"./DqvlQ722.js";import{V as k}from"./4QjTaRBk.js";import{V as h}from"./nC4QlDlf.js";import{V as be}from"./CVYrSSd-.js";import"./BC3latsD.js";import"./JdEJ36-T.js";import"./Br3bdj8I.js";import"./geStYpxQ.js";import"./BU2JxnnE.js";const xe={style:{color:"red","margin-left":"30px"}},ye=["onClick"],Ve=["onClick","title"],we=["disabled","onClick"],Ce={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:re,alt:"Visualizar",title:"Reativar"},Oe={key:1,src:ne,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Ge={__name:"[id]",async setup(Re){let i,_;const{$toast:O}=ie(),S=ue(),{id:p}=S.params,$=de(),b=ce(),q=`${b.public.managemant}/updateOrdensServico`,T=`${b.public.managemant}/getOrdensServicoById`,N=`${b.public.managemant}/listarAtos`,P=u(g("user-data").value.cartorio_id),D=u(g("user-data").value.usuario_id),F=u(g("user-service").value.token).value||null,M=u(g("user-data").value.cartorio_token).value,x=u([]),y=u(!1),R=u(null),m=u(null),s=pe({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),L=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],G=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],K={apresentante_nome:{required:B.withMessage("O campo é obrigatorio",U)},apresentante_cpf:{required:B.withMessage("O campo é obrigatorio",U)}},d=le(K,s);function X(o){if(o)return o.replace(/[.\-]/g,"");o=null}const Y=o=>{R.value=o,y.value=!0},Z=o=>{o.tipo==="PROCURAÇÃO GERAL"?$.push({path:`/fontes/atos/atos-sem-bem/atualizar/${o.id}`,query:{origem:"atualizar",id:p,ato_id:o.id,ato_token_edit:o.token,numero_os:m.value}}):$.push({path:`/fontes/atos/atos-com-bem/atualizar/${o.id}`,query:{origem:"atualizar",id:p,ato_id:o.id,ato_token_edit:o.token,numero_os:m.value}})};async function j(){const o={apresentante_cpf:X(s.apresentante_cpf),apresentante_nome:s.apresentante_nome,user_id:D.value,cartorio_id:P.value},{error:t,status:v}=await C(`${q}/${p}`,{method:"PUT",body:o},"$Fud06ay483");v.value==="error"&&t.value.statusCode===500?O.error("Erro ao cadastrar ordem,erro no sistema."):(O.success("Ordem Atualizada com sucesso!"),$.push({path:"/os/lista"}))}const{data:f}=([i,_]=z(()=>C(`${T}/${p}`,{method:"GET"},"$wPUkUpDvPf")),i=await i,_(),i);m.value=f.value.numero,s.nacionalidade=f.value.estrangeiro,s.apresentante_cpf=f.value.apresentante_cpf,s.apresentante_nome=f.value.apresentante_nome;const{data:A}=([i,_]=z(()=>C(N,{method:"POST",body:{cartorio_token:M,ordemserv_token:F}},"$YXZ55K3IUf")),i=await i,_(),i);return A.value.length>0?x.value=A.value:x.value=[],(o,t)=>{const v=Q,H=te,J=me("mask");return c(),V($e,{class:"mt-5"},{default:n(()=>[r(k,{class:"mb-5"},{default:n(()=>[t[6]||(t[6]=l("h1",null,"Ordem de Serviço nº",-1)),l("h1",xe,_e(a(m)),1)]),_:1}),r(k,null,{default:n(()=>[r(h,{md:"3"},{default:n(()=>[r(be,{label:"Nacionalidade",items:G,modelValue:a(s).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>a(s).nacionalidade=e)},null,8,["modelValue"])]),_:1}),r(h,{md:"2"},{default:n(()=>[a(s).nacionalidade==="brasileiro"?fe((c(),V(w,{key:0,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>a(s).apresentante_cpf=e),label:"CPF",required:"","error-messages":a(d).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(d).apresentante_cpf.$touch,onInput:a(d).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[J,"###.###.###-##"]]):(c(),V(w,{key:1,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>a(s).apresentante_cpf=e),label:"Documento",required:"","error-messages":a(d).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(d).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),r(h,{md:"4"},{default:n(()=>[r(w,{modelValue:a(s).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>a(s).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":a(d).apresentante_nome.$errors.map(e=>e.$message),onInput:a(d).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),r(h,null,{default:n(()=>[l("div",null,[l("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:W,alt:"Salvar",onClick:t[4]||(t[4]=e=>j())})])]),_:1})]),_:1}),r(k,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:n(()=>[t[9]||(t[9]=l("h1",{class:"ml-5"},"Atos",-1)),r(v,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:a(p),numeroOs:a(m)}}},{default:n(()=>t[7]||(t[7]=[l("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:ae,alt:"novo"},null,-1)])),_:1},8,["to"]),r(oe,{headers:L,items:a(x),"item-key":"id"},{"item.actions":n(({item:e})=>[r(k,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:n(()=>[l("div",{onClick:E=>Y(e.token),title:"Reimprimir"},t[8]||(t[8]=[l("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ee,alt:"Reimprimir"},null,-1)]),8,ye),l("div",{class:ge({disabled:!e.btn_editar}),onClick:E=>e.btn_editar?Z({id:e.id,tipo:e.tipo,token:e.token}):null,title:e.btn_editar?"Editar":"Desabilitado"},[l("img",{style:ve({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:se,alt:"Editar"},null,4)],10,Ve),l("div",{disabled:!e.btn_cancelar,onClick:E=>e.btn_cancelar?o.deleteEndereco(e):null,title:"Excluir"},[e.excluido?(c(),I("img",Ce)):(c(),I("img",Oe))],8,we)]),_:2},1024)]),_:1},8,["items"]),r(H,{show:a(y),ato_token:a(R),onClose:t[5]||(t[5]=e=>y.value=!1)},null,8,["show","ato_token"])]),_:1}),r(v,{to:"/os/lista"},{default:n(()=>[r(ke,{size:"large",color:"red"},{default:n(()=>t[10]||(t[10]=[he("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Ge as default};
