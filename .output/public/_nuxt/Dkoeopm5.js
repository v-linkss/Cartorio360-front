import{_ as te}from"./B64UyeAE.js";import{_ as se,u as le,n as de,D as A,r as S,F as X,G as ie,H as ne,o as n,c as G,q as e,A as u,a4 as re,t as ue,C as c,w as o,b as a,s as _,I as M,y as H,d as C,O as me,x as ce,a as Y,v as j}from"./CjJ6IIxa.js";import{a as pe,u as J}from"./BiShY3Qy.js";import{c as q,r as z,u as _e,V as B}from"./D0ft-aPo.js";import{c as fe}from"./BgtGmUBe.js";import{V as y}from"./D0BksC4C.js";import{V as r}from"./BKpivEKe.js";import{V as Z}from"./BR9zYKZe.js";import{_ as Ve,a as ve,b as be,c as Ce}from"./UNctfwUI.js";import{a as ge}from"./CUiav6qz.js";import{a as I,V as ye,c as F,b as $e}from"./Cyspt6RI.js";import"./BUe_X6z7.js";import"./CrE-eFFQ.js";import"./D7MG7sly.js";import"./B63BRiqs.js";import"./37abXc2X.js";const ke={key:1},xe={__name:"Dados",emits:["saved"],async setup(K,{emit:f}){let i,$;const O=f,w=le(),{$toast:g}=de(),b=ce(),L=`${b.public.managemant}/createPessoa`,V=`${b.public.managemant}/updatePessoa`,D=`${b.public.managemant}/listarEstadoCivil`,N=`${b.public.managemant}/listarCapacidadeCivil`,R=`${b.public.managemant}/listarCidades`,T={nome:"",nome_pai:"",nome_mae:"",profissao:"",local_trabalho:"",data_nascimento:"",doc_identificacao:"",cpf_pai:"",cpf_mae:"",tipo_pessoa:"FISICA",tabvalores_estadocivil_id:"",tabvalores_capacidadecivil_id:"",cidade_natural_id:"",cartorio_id:A("user-data").value.cartorio_id,user_id:A("user-data").value.usuario_id},U=S(!1),v=A("pessoa-id"),t=X({...T});function k(d){if(d)return d.replace(/[.\-]/g,"");d=null}const{data:E,status:Ue,pending:W,error:h}=([i,$]=ie(async()=>pe("cliente-dados",async()=>{const[d,s,p]=await Promise.all([$fetch(D),$fetch(N),$fetch(R)]);return{estadoCivilItems:d,capacidadeCivilItems:s,cidadeNascimentoItems:p}})),i=await i,$(),i),Q={nome:{required:q.withMessage("O campo é obrigatorio",z)},nome_mae:{required:q.withMessage("O campo é obrigatorio",z)},doc_identificacao:{required:q.withMessage("O campo é obrigatorio",z),cpf:fe}},m=_e(Q,t);async function ee(){if(await m.value.$validate()){const d={...t};for(const P in d)d[P]===""&&(d[P]=null);const s={...d,doc_identificacao:k(t.doc_identificacao),cpf_pai:k(t.cpf_pai),cpf_mae:k(t.cpf_mae)},{data:p,error:x,status:l}=await J(L,{method:"POST",body:s},"$fcbWHpl5XR");if(l.value==="error"&&x.value.statusCode===500)g.error("Erro ao cadastrar pessoa,o CPF já está cadastrado.");else{g.success("Pessoa cadastrada com sucesso!");const P=p.value.id;v.value=P;const oe=A("pessoa_token");oe.value=p.value.token,O("saved"),U.value=!0}}else g.error("Erro ao cadastrar pessoa, preencha os campos obrigatorios.")}async function ae(){const d={...t};for(const p in d)d[p]===""&&(d[p]=null);const s={...d,doc_identificacao:k(t.doc_identificacao),cpf_mae:k(t.cpf_mae)};await J(`${V}/${v.value}`,{method:"PUT",body:s},"$S30ZRYxneo"),g.success("Pessoa atualizada com sucesso!"),w.push("/pessoas/registros")}return(d,s)=>{const p=te,x=ne("mask");return n(),G(me,null,[e(W)?(n(),u(re,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):e(h)?(n(),G("div",ke,ue(e(h).message),1)):c("",!0),e(W)?c("",!0):(n(),u(Z,{key:2,class:"mt-5"},{default:o(()=>[a(y,null,{default:o(()=>[a(r,{cols:"12",md:"8"},{default:o(()=>[a(_,{modelValue:e(t).nome,"onUpdate:modelValue":s[0]||(s[0]=l=>e(t).nome=l),"error-messages":e(m).nome.$errors.map(l=>l.$message),label:"Nome",required:"",onBlur:e(m).nome.$touch,onInput:e(m).nome.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1}),a(r,{cols:"12",md:"4"},{default:o(()=>[M(a(_,{modelValue:e(t).doc_identificacao,"onUpdate:modelValue":s[1]||(s[1]=l=>e(t).doc_identificacao=l),"error-messages":e(m).doc_identificacao.$errors.map(l=>l.$message),label:"CPF",required:"",onBlur:e(m).doc_identificacao.$touch,onInput:e(m).doc_identificacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),[[x,"###.###.###-##"]])]),_:1})]),_:1}),a(y,null,{default:o(()=>[a(r,{cols:"12",md:"4"},{default:o(()=>[a(B,{modelValue:e(t).tabvalores_estadocivil_id,"onUpdate:modelValue":s[2]||(s[2]=l=>e(t).tabvalores_estadocivil_id=l),items:e(E).estadoCivilItems,"item-title":"descricao","item-value":"id",label:"Estado Civil"},null,8,["modelValue","items"])]),_:1}),a(r,{cols:"12",md:"4"},{default:o(()=>[a(_,{modelValue:e(t).profissao,"onUpdate:modelValue":s[3]||(s[3]=l=>e(t).profissao=l),label:"Profissão"},null,8,["modelValue"])]),_:1}),a(r,{cols:"12",md:"4"},{default:o(()=>[a(_,{modelValue:e(t).local_trabalho,"onUpdate:modelValue":s[4]||(s[4]=l=>e(t).local_trabalho=l),label:"Local de trabalho"},null,8,["modelValue"])]),_:1})]),_:1}),a(y,null,{default:o(()=>[a(r,{cols:"12",md:"4"},{default:o(()=>[a(_,{modelValue:e(t).data_nascimento,"onUpdate:modelValue":s[5]||(s[5]=l=>e(t).data_nascimento=l),type:"date","prepend-icon":"",label:"Data de nascimento"},null,8,["modelValue"])]),_:1}),a(r,{cols:"12",md:"4"},{default:o(()=>[a(B,{modelValue:e(t).tabvalores_capacidadecivil_id,"onUpdate:modelValue":s[6]||(s[6]=l=>e(t).tabvalores_capacidadecivil_id=l),items:e(E).capacidadeCivilItems,label:"Capacidade Civil","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),a(r,{cols:"12",md:"4"},{default:o(()=>[a(B,{modelValue:e(t).cidade_natural_id,"onUpdate:modelValue":s[7]||(s[7]=l=>e(t).cidade_natural_id=l),items:e(E).cidadeNascimentoItems,label:"Cidade de nascimento","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),a(y,null,{default:o(()=>[a(r,{cols:"12",md:"4"},{default:o(()=>[M(a(_,{modelValue:e(t).cpf_pai,"onUpdate:modelValue":s[8]||(s[8]=l=>e(t).cpf_pai=l),modelModifiers:{date:!0},label:"CPF do Pai"},null,8,["modelValue"]),[[x,"###.###.###-##"]])]),_:1}),a(r,{cols:"12",md:"4"},{default:o(()=>[a(_,{modelValue:e(t).nome_pai,"onUpdate:modelValue":s[9]||(s[9]=l=>e(t).nome_pai=l),modelModifiers:{date:!0},label:"Nome do Pai"},null,8,["modelValue"])]),_:1})]),_:1}),a(y,null,{default:o(()=>[a(r,{cols:"12",md:"4"},{default:o(()=>[M(a(_,{modelValue:e(t).cpf_mae,"onUpdate:modelValue":s[10]||(s[10]=l=>e(t).cpf_mae=l),modelModifiers:{date:!0},label:"CPF da Mãe"},null,8,["modelValue"]),[[x,"###.###.###-##"]])]),_:1}),a(r,{cols:"12",md:"4"},{default:o(()=>[a(_,{modelValue:e(t).nome_mae,"onUpdate:modelValue":s[11]||(s[11]=l=>e(t).nome_mae=l),modelModifiers:{date:!0},"error-messages":e(m).nome_mae.$errors.map(l=>l.$message),label:"Nome da Mãe",required:"",onBlur:e(m).nome_mae.$touch,onInput:e(m).nome_mae.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),a(y,{class:"mb-3"},{default:o(()=>[a(p,{to:"/pessoas/registros"},{default:o(()=>[a(H,{size:"large",color:"red"},{default:o(()=>[C("Voltar")]),_:1})]),_:1}),a(H,{onClick:s[12]||(s[12]=l=>e(U)?ae():ee()),class:"ml-4",size:"large",color:"green"},{default:o(()=>[C("Salvar")]),_:1})]),_:1})]),_:1}))],64)}}},Ie=se(xe,[["__scopeId","data-v-4d4acc0a"]]),Fe=Y("h1",{style:{"background-color":"#C8FCCA",color:"#429946",padding:"10px 0px 0px 20px"}}," Cadastramento de pessoas ",-1),we={style:{"background-color":"#C8FCCA",padding:"20px 0px 20px 20px"}},Ge={__name:"index",setup(K){const f=S(null),i=S(!1),$=S(!1),w=X({...{tipo_pessoa:"FISICA"}}),g=["FISICA","JURIDICA","ESTRANGEIRA"],b=()=>{i.value=!0,$.value=!0};return(L,V)=>{const D=Ie,N=Ve,R=ve,T=be,U=Ce;return n(),u(ge,{width:"1300"},{default:o(()=>[Fe,Y("div",we,[a(B,{modelValue:e(w).tipo_pessoa,"onUpdate:modelValue":V[0]||(V[0]=v=>e(w).tipo_pessoa=v),style:{width:"200px"},items:g,label:"Tipo de pessoa","bg-color":"#F6F6F6",disabled:e($)},null,8,["modelValue","disabled"])]),a(ye,{modelValue:e(f),"onUpdate:modelValue":V[1]||(V[1]=v=>j(f)?f.value=v:null),"bg-color":"#C8FCCA"},{default:o(()=>[a(I,{value:"dados"},{default:o(()=>[C("Dados")]),_:1}),e(i)?(n(),u(I,{key:0,value:"documento"},{default:o(()=>[C("Documentos")]),_:1})):c("",!0),e(i)?(n(),u(I,{key:1,value:"endereco"},{default:o(()=>[C("Endereços")]),_:1})):c("",!0),e(i)?(n(),u(I,{key:2,value:"biometria"},{default:o(()=>[C("Biometria")]),_:1})):c("",!0),e(i)?(n(),u(I,{key:3,value:"restricao"},{default:o(()=>[C("Restrições")]),_:1})):c("",!0)]),_:1},8,["modelValue"]),a($e,{modelValue:e(f),"onUpdate:modelValue":V[2]||(V[2]=v=>j(f)?f.value=v:null)},{default:o(()=>[a(F,{value:"dados"},{default:o(()=>[a(D,{onSaved:b})]),_:1}),e(i)?(n(),u(F,{key:0,value:"documento"},{default:o(()=>[a(N)]),_:1})):c("",!0),e(i)?(n(),u(F,{key:1,value:"endereco"},{default:o(()=>[a(R)]),_:1})):c("",!0),e(i)?(n(),u(F,{key:2,value:"biometria"},{default:o(()=>[a(Z,{class:"mt-5"},{default:o(()=>[a(T)]),_:1})]),_:1})):c("",!0),e(i)?(n(),u(F,{key:3,value:"restricao"},{default:o(()=>[a(U)]),_:1})):c("",!0)]),_:1},8,["modelValue"])]),_:1})}}};export{Ge as default};
