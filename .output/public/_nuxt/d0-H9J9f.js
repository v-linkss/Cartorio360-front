import{_ as ee}from"./CxqckAzS.js";import{_ as te,a as oe}from"./BSVU11Mv.js";import{_ as ae}from"./BnN_11nu.js";import{_ as se}from"./BVz1G1IN.js";import{_ as re,a as ne,b as le}from"./B7VgIJPM.js";import{c as I,r as T,u as ie}from"./CyuTucyo.js";import{u as ue,H as de,C as pe,r as u,m as k,D as me,I as U,Q as ce,G as b,w as n,s as _e,o as c,b as r,a as l,t as fe,v as a,R as ve,V as w,y as ge,z as ke,c as z,A as he,d as xe}from"./CahgHD4s.js";import{u as R,V as h}from"./CqXH_2-Y.js";import{f as ye}from"./Cl8cN1Fr.js";import{V as $e}from"./CvQ3xxjU.js";import{V as x}from"./CXKKc63K.js";import{V as Ve}from"./CrqZoQ3P.js";import{V as be}from"./DHJGDUzK.js";import"./BMiOKdmx.js";import"./DFrhZmaR.js";import"./Ch0WWVZi.js";import"./B4jzeSH9.js";import"./DLvvAifW.js";const we={style:{color:"red","margin-left":"30px"}},Re=["onClick"],Ce=["onClick","title"],Ae=["disabled","onClick"],Oe={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:ne,alt:"Visualizar",title:"Reativar"},Ee={key:1,src:le,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Ye={__name:"[id]",async setup(Ie){let i,_;const{$toast:C}=ue(),B=de(),{id:p}=B.params,y=pe(),f=_e(),P=`${f.public.managemant}/updateOrdensServico`,S=`${f.public.managemant}/getOrdensServicoById`,N=`${f.public.managemant}/listarAtos`,q=`${f.public.managemant}/updateAtos`,D=u(k("user-data").value.cartorio_id),F=u(k("user-data").value.usuario_id),G=u(k("user-service").value.token).value||null,L=u(k("user-data").value.cartorio_token).value,$=u([]),V=u(!1),A=u(null),m=u(null),s=me({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),M=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],H=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],K={apresentante_nome:{required:I.withMessage("O campo é obrigatorio",T)},apresentante_cpf:{required:I.withMessage("O campo é obrigatorio",T)}},d=ie(K,s);function Q(o){if(o)return o.replace(/[.\-]/g,"");o=null}const W=o=>{A.value=o,V.value=!0},X=o=>{o.tipo==="PROCURAÇÃO GERAL"?y.push({path:`/fontes/atos/atos-sem-bem/atualizar/${o.id}`,query:{origem:"atualizar",id:p,ato_id:o.id,tipo_ato_token:o.tipo_token,ato_token_edit:o.token,numero_os:m.value}}):o.tipo==="INVENTÁRIO E PARTILHA"&&y.push({path:`/fontes/atos/atos-com-bem/atualizar/${o.id}`,query:{origem:"atualizar",id:p,ato_id:o.id,tipo_ato_token:o.tipo_token,ato_token_edit:o.token,numero_os:m.value}})};async function Y(){const o={apresentante_cpf:Q(s.apresentante_cpf),apresentante_nome:s.apresentante_nome,user_id:F.value,cartorio_id:D.value},{error:t,status:g}=await R(`${P}/${p}`,{method:"PUT",body:o},"$Fud06ay483");g.value==="error"&&t.value.statusCode===500?C.error("Erro ao cadastrar ordem,erro no sistema."):(C.success("Ordem Atualizada com sucesso!"),y.push({path:"/os/lista"}))}const{data:v}=([i,_]=U(()=>R(`${S}/${p}`,{method:"GET"},"$wPUkUpDvPf")),i=await i,_(),i);m.value=v.value.numero,s.nacionalidade=v.value.estrangeiro,s.apresentante_cpf=v.value.apresentante_cpf,s.apresentante_nome=v.value.apresentante_nome;const{data:O}=([i,_]=U(()=>R(N,{method:"POST",body:{cartorio_token:L,ordemserv_token:G}},"$YXZ55K3IUf")),i=await i,_(),i);async function Z(o){o.excluido=!o.excluido;try{await ye(`${q}/${o.id}`,{method:"PUT",body:{excluido:o.excluido}})}catch(t){console.error("Erro ao excluir pessoa:",t)}}return O.value.length>0?$.value=O.value:$.value=[],(o,t)=>{const g=ee,j=oe,J=ce("mask");return c(),b($e,{class:"mt-5"},{default:n(()=>[r(h,{class:"mb-5"},{default:n(()=>[t[6]||(t[6]=l("h1",null,"Ordem de Serviço nº",-1)),l("h1",we,fe(a(m)),1)]),_:1}),r(h,null,{default:n(()=>[r(x,{md:"3"},{default:n(()=>[r(Ve,{label:"Nacionalidade",items:H,modelValue:a(s).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>a(s).nacionalidade=e)},null,8,["modelValue"])]),_:1}),r(x,{md:"2"},{default:n(()=>[a(s).nacionalidade==="brasileiro"?ve((c(),b(w,{key:0,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>a(s).apresentante_cpf=e),label:"CPF",required:"","error-messages":a(d).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(d).apresentante_cpf.$touch,onInput:a(d).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[J,"###.###.###-##"]]):(c(),b(w,{key:1,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>a(s).apresentante_cpf=e),label:"Documento",required:"","error-messages":a(d).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(d).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),r(x,{md:"4"},{default:n(()=>[r(w,{modelValue:a(s).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>a(s).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":a(d).apresentante_nome.$errors.map(e=>e.$message),onInput:a(d).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),r(x,null,{default:n(()=>[l("div",null,[l("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:ae,alt:"Salvar",onClick:t[4]||(t[4]=e=>Y())})])]),_:1})]),_:1}),r(h,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:n(()=>[t[9]||(t[9]=l("h1",{class:"ml-5"},"Atos",-1)),r(g,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:a(p),numeroOs:a(m)}}},{default:n(()=>t[7]||(t[7]=[l("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:se,alt:"novo"},null,-1)])),_:1},8,["to"]),r(be,{headers:M,items:a($),"item-key":"id"},{"item.actions":n(({item:e})=>[r(h,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:n(()=>[l("div",{onClick:E=>W(e.token),title:"Reimprimir"},t[8]||(t[8]=[l("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:te,alt:"Reimprimir"},null,-1)]),8,Re),l("div",{class:ke({disabled:!e.btn_editar}),onClick:E=>e.btn_editar?X({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token}):null,title:e.btn_editar?"Editar":"Desabilitado"},[l("img",{style:ge({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:re,alt:"Editar"},null,4)],10,Ce),l("div",{disabled:!e.btn_cancelar,onClick:E=>e.btn_cancelar?Z(e):null,title:"Excluir"},[e.excluido?(c(),z("img",Oe)):(c(),z("img",Ee))],8,Ae)]),_:2},1024)]),_:1},8,["items"]),r(j,{show:a(V),ato_token:a(A),onClose:t[5]||(t[5]=e=>V.value=!1)},null,8,["show","ato_token"])]),_:1}),r(g,{to:"/os/lista"},{default:n(()=>[r(he,{size:"large",color:"red"},{default:n(()=>t[10]||(t[10]=[xe("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Ye as default};
