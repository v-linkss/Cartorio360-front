import{_ as O}from"./DhPKIzqP.js";import{r as d,m as U,H as z,g as A,o as _,c as h,b as e,w as l,a as g,V as v,s as r,v as $,d as E,P as I,B as j,F as G,q as N,u as T,z as H,p as P}from"./BOL4noSq.js";import{u as B}from"./TzX8YZO0.js";import{V as K,c as J}from"./CPO4BRHb.js";import{V as R}from"./Cl_P9YfM.js";import{V as q}from"./bqpzMvxx.js";import{V as y}from"./DQU5PUT0.js";import{V as W}from"./BTXPcqnv.js";import{_ as Y,a as Z}from"./DJvq3mCv.js";import{f as Q}from"./B0IxRygJ.js";import{V as X}from"./C5FAYfot.js";import"./D6ANBwFC.js";import"./DgnvD5-t.js";import"./BAkrviJb.js";import"./BuYEFpRz.js";const ee={__name:"ImportaSelos",props:{show:Boolean,ato_token:String,ato_id:Number,representante_nome:String},emits:["close","update-papel"],setup(M,{emit:w}){const p=M,i=d(p.show),m=N(),{$toast:b}=U(),o=d(!1),V=d(""),C=`${m.public.ws}/fornecer_selos_por_lote`,x=`${m.public.managemant}/fornecer_selos`,s=d(!1),a=z({nuLote:null}),f=w;A(()=>p.show,async c=>{i.value=c});const t=()=>{i.value=!1,f("close")},D=async()=>{s.value=!0;try{const{data:c,error:n,status:L}=await B(C,{method:"POST",body:{user:"56415451472",pass:"Ra961206",statusSelo:"D",nuLote:a.nuLote},onResponseError({response:u}){var k;const S=((k=u._data)==null?void 0:k.details)||"Erro ao buscar lote de selos.";V.value=S,o.value=!0,console.error("Erro forneceSeloPorLote:",S)}},"$Z1bKGPif1c");if(L.value==="success"){const u=c.value.selos,{data:S,error:k,status:F}=await B(x,{method:"POST",body:{tipo_id:1,cartorio_id:T("user-data").value.cartorio_id,selos:u,user_id:T("user-data").value.usuario_id}},"$Kr3yBtlYBF");F.value==="success"&&(b.success("Selos importados com sucesso"),t())}}catch(c){console.error("Erro ao importar selos:",c)}finally{s.value=!1}};return(c,n)=>{const L=O;return _(),h(G,null,[e(W,{persistent:"",modelValue:r(i),"onUpdate:modelValue":n[1]||(n[1]=u=>j(i)?i.value=u:null),"max-width":"800"},{default:l(()=>[e(K,null,{default:l(()=>[e(R,null,{default:l(()=>[e(q,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:l(()=>[e(y,null,{default:l(()=>n[3]||(n[3]=[g("h1",{class:"ml-4"},"Importar selos do lote",-1),g("p",{class:"ml-4 mt-3"}," Informe o codigo do lote para realizar a importação ",-1)])),_:1})]),_:1}),n[4]||(n[4]=g("hr",{class:"mb-5"},null,-1)),e(v,{label:"Lote",modelValue:r(a).nuLote,"onUpdate:modelValue":n[0]||(n[0]=u=>r(a).nuLote=u),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(J,null,{default:l(()=>[e($,{style:{"background-color":"red",color:"white"},onClick:t},{default:l(()=>n[5]||(n[5]=[E(" Voltar ")])),_:1}),e($,{style:{"background-color":"green",color:"white"},loading:r(s),disabled:r(s),onClick:D},{loader:l(()=>[e(I,{indeterminate:"",color:"white",size:"24"})]),default:l(()=>[n[6]||(n[6]=E(" Importar "))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(L,{show:r(o),errorMessage:r(V),onClose:n[2]||(n[2]=u=>o.value=!1)},null,8,["show","errorMessage"])],64)}}},oe={class:"d-flex flex-column"},ae=["onClick"],se={key:0,style:{width:"30px",height:"30px"},src:Y,alt:"Visualizar",title:"Reativar"},te={key:1,src:Z,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},we={__name:"index",setup(M){const w=N(),p=d([]),i=d(!1),m=d(!1),b=`${w.public.managemant}/selos`,o=z({dt_compra:"",numero:"",lote_compra:"",sequencia:"",sigla:""}),V=[{title:"Data de compra",value:"dt_compra"},{title:"Selo",value:"numero"},{title:"Valor de compra",value:"lote_compra"}],C=async()=>{m.value=!0;try{const{data:s,error:a,status:f}=await B(b,{method:"GET"},"$g9WNETx7rH");f.value==="success"?p.value=Array.isArray(s.value)?s.value.map(t=>({...t,dt_compra:t.dt_compra?Q(t.dt_compra,"dd/mm/yyyy"):null})):[]:console.error(a)}catch(s){console.error("Erro ao buscar selos:",s)}finally{m.value=!1}},x=H(()=>p.value.filter(s=>(!o.dt_compra||s.dt_compra.toLowerCase().includes(o.dt_compra.toLowerCase()))&&(!o.numero||s.numero.toLowerCase().includes(o.numero.toLowerCase()))&&(!o.lote_compra||s.lote_compra.toLowerCase().includes(o.lote_compra.toLowerCase()))&&(!o.sequencia||s.sequencia.toLowerCase().includes(o.sequencia.toLowerCase()))&&(!o.sigla||s.sigla.toLowerCase().includes(o.sigla.toLowerCase()))));return C(),(s,a)=>{const f=ee;return r(m)?(_(),P(I,{key:0,class:"d-flex justify-center align-center",indeterminate:"",size:"64",style:{position:"absolute",top:"40%",left:"50%"}})):(_(),P(R,{key:1,class:"mt-5"},{default:l(()=>[g("div",oe,[e($,{class:"mb-10 mt-auto align-self-end",color:"green",size:"large",onClick:a[0]||(a[0]=t=>i.value=!0)},{default:l(()=>a[5]||(a[5]=[E(" Importar Selos TJ ")])),_:1})]),e(q,{class:"mb-4",style:{gap:"10rem"}},{default:l(()=>[e(y,{cols:"12",md:"2"},{default:l(()=>[e(v,{modelValue:r(o).dt_compra,"onUpdate:modelValue":a[1]||(a[1]=t=>r(o).dt_compra=t),label:"Data de Compra","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:l(()=>[e(v,{modelValue:r(o).numero,"onUpdate:modelValue":a[2]||(a[2]=t=>r(o).numero=t),label:"Selo","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:l(()=>[e(v,{modelValue:r(o).lote_compra,"onUpdate:modelValue":a[3]||(a[3]=t=>r(o).lote_compra=t),label:"Valor de Compra","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(X,{density:"compact",headers:V,items:r(x),"item-key":"selo"},{"item.actions":l(({item:t})=>[g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:D=>s.deleteObservacao(t),title:"Deletar Observação"},[t.excluido?(_(),h("img",se)):(_(),h("img",te))],8,ae)]),_:1},8,["items"]),e(f,{show:r(i),onClose:a[4]||(a[4]=t=>i.value=!1)},null,8,["show"])]),_:1}))}}};export{we as default};
