import{_ as no}from"./CP1Hbaqs.js";import{_ as ro,a as io}from"./Bgdt1z7u.js";import{_ as uo}from"./3kY4LOxT.js";import{_ as mo}from"./CQmua4bw.js";import{_ as z}from"./DD_s6tIt.js";import{_ as po}from"./MJoG-67g.js";import{_ as co,a as _o}from"./DJvq3mCv.js";import{_ as vo,u as fo,r,e as C,f as yo,g as Vo,n as ko,h as bo,c as U,b as s,w as n,a as u,i as l,j as go,k as $o,F as ho,l as xo,o as V,m as f,V as d,p as wo,q as Ao}from"./BkvpCUKT.js";import{u as So}from"./GPJEKoOD.js";import{u as k}from"./B9wrWlxw.js";import{f as b}from"./B0IxRygJ.js";import{f as Co}from"./Bg0xZqAC.js";import{V as Uo}from"./Cn7ZiGJA.js";import{V as Do}from"./BFF_Sdr7.js";import{V as D}from"./CN02Inq4.js";import{V as i}from"./tL_dU8xg.js";import{V as O}from"./CekT6yPb.js";import"./D4OLfovi.js";import"./BkmxosRR.js";import"./CX8efakt.js";import"./Y6xufdEv.js";import"./L-ei26Lb.js";import"./D6vszR0f.js";import"./DrwMu2zw.js";import"./BVz1G1IN.js";import"./iZKWpZNy.js";import"./CIawfje4.js";import"./BkThSKy7.js";const Oo={style:{width:"1300px",margin:"0 auto"}},Po={style:{display:"flex",gap:"4px","justify-content":"center"}},To=["onClick"],No=["onClick"],Eo=["onClick","title"],Mo=["onClick"],Io={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:co,alt:"Visualizar",title:"Reativar"},Ro={key:1,src:_o,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},qo={__name:"index",setup(zo){const _=xo(),{$toast:F}=fo(),L=`${_.public.managemant}/listarUsuarios`,j=`${_.public.managemant}/listar_tipo_atos`;`${_.public.managemant}`;const B=`${_.public.managemant}/updateAtos`,P=`${_.public.managemant}/pesquisaAtos`,{redirectTo:T}=So(),g=r(C("auth_token").value)||null,$=r(C("user-data").value.cartorio_token)||null,h=r(!1),y=r([]),N=r([]),E=r([]),H=r(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),M=r(!1),x=r(!1),J=r(""),W=r(null),Y=r({}),w=r(!1),I=r(null),A=r(null),e=yo({numero:null,data_inicio:R(),data_fim:R(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:g.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),Q=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:a=>a.protocolo?`${a.id}
${a.protocolo}`:`${a.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:a=>a.dt_abertura?`${a.dt_abertura}
${a.apresentante_cpf}`:`${a.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:a=>a.dt_lavratura?`${a.dt_lavratura}
${a.apresentante_nome}`:`${a.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:a=>a.situacao?`${a.situacao}
${a.ato_servico}`:`${a.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function R(){const a=new Date,o=a.getFullYear(),p=String(a.getMonth()+1).padStart(2,"0");return`${String(a.getDate()).padStart(2,"0")}-${p}-${o}`}function c(a){if(!a)return null;const[o,p,m]=a.split("/");return`${m}-${p}-${o}`}async function q(){const a=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(a),{data:p}=await k(P,{method:"POST",body:{cartorio_token:C("user-data").value.cartorio_token,usuario_token:o.usuario_token||g.value,data_fim:c(o==null?void 0:o.data_fim),data_inicio:c(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");p.value.length>0&&(y.value=p.value.map(m=>({...m,dt_lavratura:m.dt_lavratura?b(m.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:b(m.dt_abertura,"dd/mm/yyyy")})))}async function X(){const{data:a}=await k(L,{method:"POST",body:{cartorio_token:$.value}},"$hvipqUJYtS");N.value=a.value}async function Z(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(e));const{data:a}=await k(P,{method:"POST",body:{cartorio_token:$.value,numero:e.numero||null,data_inicio:c(e.data_inicio)||null,data_fim:c(e.data_fim)||null,data_lavratura_inicio:c(e.data_lavratura_inicio)||null,data_lavratura_fim:c(e.data_lavratura_fim)||null,protocolo:e.protocolo||null,livro:e.livro||null,folha:e.folha||null,situacao:e.situacao||null,usuario_token:e.usuario_token,selo:e.selo||null,ato_tipo_token:e.ato_tipo_token,parte:e.parte||null}},"$OjamgBH6nj");a.value.length>0?y.value=a.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?b(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?b(o.dt_abertura,"dd/mm/yyyy"):null})):(y.value=[],F.error("Não existe ato Registrado!"))}catch(a){console.error("Erro na requisição",a)}}const G=a=>{T({item:a,id,numeroOs:a.numero_os,origem:"vizualizar-lista"})};async function K(){const{data:a,error:o}=await k(j,{method:"POST",body:{cartorio_token:$.value,usuario_token:g.value,tipo_retorno:"servico_ato"}},"$QxIfw0Zxe4");E.value=a.value}const oo=a=>{I.value=a,w.value=!0};async function ao(a){a.excluido=!a.excluido;try{await Co(`${B}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}const to=async()=>{A.value&&(await cancelaAto(A.value),A.value=null),x.value=!1},eo=a=>{T({item:a,id:a.id,numeroOs:a.numero_os,origem:"atualizar-lista"})};return Vo(()=>{ko(async()=>{const a=sessionStorage.getItem("pesquisaAto");if(a){const o=JSON.parse(a);Object.assign(e,o)}await q()})}),X(),K(),(a,o)=>{const p=no,m=ro,lo=uo,so=mo,v=bo("mask");return V(),U(ho,null,[s(Uo,{class:"mt-5"},{default:n(()=>[s(D,{class:"mb-5"},{default:n(()=>o[19]||(o[19]=[u("h1",null,"Atos",-1)])),_:1}),s(D,null,{default:n(()=>[s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(e).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=t=>l(e).data_inicio=t),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(e).data_fim,"onUpdate:modelValue":o[1]||(o[1]=t=>l(e).data_fim=t),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(e).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=t=>l(e).data_lavratura_inicio=t),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(e).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=t=>l(e).data_lavratura_fim=t),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(e).numero,"onUpdate:modelValue":o[4]||(o[4]=t=>l(e).numero=t),label:"N° OS"},null,8,["modelValue"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(e).selo,"onUpdate:modelValue":o[5]||(o[5]=t=>l(e).selo=t),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),s(D,null,{default:n(()=>[s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(e).protocolo,"onUpdate:modelValue":o[6]||(o[6]=t=>l(e).protocolo=t),label:"Protocolo"},null,8,["modelValue"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(e).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=t=>l(e).apresentante_cpf=t),label:"CPF",dense:""},null,8,["modelValue"]),[[v,"###.###.###-##"]])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(d,{modelValue:l(e).parte,"onUpdate:modelValue":o[8]||(o[8]=t=>l(e).parte=t),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(O,{modelValue:l(e).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=t=>l(e).ato_tipo_token=t),items:l(E),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(O,{items:l(N),modelValue:l(e).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=t=>l(e).usuario_token=t),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(O,{modelValue:l(e).situacao,"onUpdate:modelValue":o[11]||(o[11]=t=>l(e).situacao=t),items:l(H),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),s(i,{cols:"1"},{default:n(()=>[s(d,{modelValue:l(e).livro,"onUpdate:modelValue":o[12]||(o[12]=t=>l(e).livro=t),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"1"},{default:n(()=>[s(d,{modelValue:l(e).folha,"onUpdate:modelValue":o[13]||(o[13]=t=>l(e).folha=t),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),s(i,null,{default:n(()=>[u("div",null,[u("img",{onClick:Z,style:{width:"40px",height:"40px",cursor:"pointer"},src:z,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),u("div",Oo,[o[22]||(o[22]=u("hr",{class:"mt-5 mb-5"},null,-1)),s(Do,{headers:Q,items:l(y),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":n(({item:t})=>[u("div",Po,[u("div",{onClick:S=>G({id:t.id,tipo:`${t.tipo_servico} - ${t.tipo_ato}`,token:t.token,tipo_token:t.tipo_token,rota:t.rota,numero_os:t.numero_os}),title:"Visualizar"},o[20]||(o[20]=[u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:z,alt:"Visualizar"},null,-1)]),8,To),u("div",{onClick:S=>oo(t.token),title:"Reimprimir"},o[21]||(o[21]=[u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:io,alt:"Reimprimir"},null,-1)]),8,No),u("div",{class:wo({disabled:!t.btn_editar}),onClick:S=>t.btn_editar?eo({id:t.id,tipo:`${t.tipo_servico} - ${t.tipo_ato}`,token:t.token,tipo_token:t.tipo_token,rota:t.rota,numero_os:t.numero_os}):null,title:t.btn_editar?"Editar":"Desabilitado"},[u("img",{style:Ao({cursor:t.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:po,alt:"Editar"},null,4)],10,Eo),u("div",{onClick:S=>ao(t),title:"Excluir"},[t.excluido?(V(),U("img",Io)):(V(),U("img",Ro))],8,Mo)])]),_:1},8,["items"])]),l(h)?(V(),go(p,{key:0,show:l(h),servicos:a.dadosData.servicos||[],tiposAtos:a.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=t=>h.value=!1),onUpdateAto:a.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):$o("",!0),s(m,{show:l(w),ato_token:l(I),onClose:o[15]||(o[15]=t=>w.value=!1)},null,8,["show","ato_token"]),s(lo,{show:l(M),numero_os:l(W),ordem:l(Y),onClose:o[16]||(o[16]=t=>M.value=!1),onRefreshValue:o[17]||(o[17]=t=>q())},null,8,["show","numero_os","ordem"]),s(so,{show:l(x),condMessage:l(J),onClose:o[18]||(o[18]=t=>x.value=!1),onConfirm:to},null,8,["show","condMessage"])],64)}}},va=vo(qo,[["__scopeId","data-v-aa63338c"]]);export{va as default};
