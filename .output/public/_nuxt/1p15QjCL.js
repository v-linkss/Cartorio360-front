import{_ as he}from"./B_przcBl.js";import{u as ke,D as me,K as pe,r as o,f as xe,o as i,h as I,w as t,b as a,i as e,s as ye,V as oe,d as W,p as R,k as _e,e as G,A as je,y as ge,a as z,c as O,M as Ue,l as Re,N as Fe,F as Oe,g as Ie,O as Pe,t as fe}from"./mdyzx23d.js";import{u as _}from"./B6LjWyvH.js";import{V as F}from"./Bl5QLEkU.js";import{V as B}from"./D0vCAOjD.js";import{V as be}from"./JbJ4AFdN.js";import{V as $e}from"./BwhnVZYP.js";import{_ as Ne,a as Le,b as Be}from"./OsZCbQlJ.js";import{_ as Ge,a as Ke,b as He,T as Je,W as We,S as Xe,D as Te,c as Ye,d as Qe}from"./C4XjJ1a1.js";import{_ as Ze,r as Me}from"./CB2P7kjL.js";import{_ as we}from"./DkCZHCHO.js";import{_ as Ce}from"./BVz1G1IN.js";import{_ as ea}from"./CrvyJ2NW.js";import{_ as aa}from"./BCh29XKw.js";import{_ as Ee,a as Ve}from"./DJvq3mCv.js";import{V as Ae}from"./C5OlwL7r.js";import{_ as De}from"./-bme7efy.js";import{V as ta}from"./DWNduKzn.js";import{f as qe}from"./B0IxRygJ.js";import{_ as oa}from"./DmpgbHNm.js";import{_ as sa}from"./-zgYk4Vu.js";import{c as ra,r as na,u as la}from"./GezEq5rA.js";const ot={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(ce){const v=ce,{$toast:C}=ke(),g=_e(),c=me(),m=pe(),x=`${g.public.managemant}/updateAtos`,E=o(v.item_situacoes),Q=o(m.query.origem==="vizualizar"),T=xe({dt_abertura:v.item_dados[0].dt_abertura||null,status:v.item_dados[0].status||null,mne:v.item_dados[0].mne||null});async function Z(){const{data:D,error:b,status:V}=await _(`${x}/${m.query.ato_id}`,{method:"PUT",body:{status:T.status,mne:T.mne,dt_abertura:T.dt_abertura}},"$EIT5jtTUdX");V.value==="success"&&C.success("Ato Atualizado com sucesso")}const w=()=>{const D=m.query.origem||"criar",b=m.query.id;switch(D){case"atualizar":case"vizualizar":c.push(`/os/atualizar/${b}`);break;case"atualizar-lista":case"vizualizar-lista":c.push("/atos/lista");break;default:c.push("/os/criar-registro");break}};return(D,b)=>{const V=he;return i(),I($e,null,{default:t(()=>[a(F,{class:"mt-5"},{default:t(()=>[a(B,{cols:"3"},{default:t(()=>[a(be,{label:"Situação",modelValue:e(T).status,"onUpdate:modelValue":b[0]||(b[0]=f=>e(T).status=f),items:e(E),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),a(F,null,{default:t(()=>[a(B,{cols:"5"},{default:t(()=>[a(ye,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:e(T).mne,"onUpdate:modelValue":b[1]||(b[1]=f=>e(T).mne=f)},null,8,["modelValue"])]),_:1})]),_:1}),a(F,null,{default:t(()=>[a(B,{cols:"2"},{default:t(()=>[a(ye,{modelValue:e(T).dt_abertura,"onUpdate:modelValue":b[2]||(b[2]=f=>e(T).dt_abertura=f),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),a(F,{class:"mb-3"},{default:t(()=>[a(V,{onClick:w},{default:t(()=>[a(oe,{size:"large",color:"red"},{default:t(()=>b[3]||(b[3]=[W("Voltar")])),_:1})]),_:1}),e(Q)?R("",!0):(i(),I(oe,{key:0,class:"ml-10",onClick:Z,size:"large",color:"green"},{default:t(()=>b[4]||(b[4]=[W("Atualizar")])),_:1}))]),_:1})]),_:1})}}},ia={key:0},ca=["onClick"],ua={key:0,style:{width:"30px",height:"30px"},src:we,alt:"Visualizar"},da={key:1,style:{width:"30px",height:"30px"},src:ea,alt:"Visualizar"},ma=["onClick"],pa=["onClick"],_a={key:0,style:{width:"30px",height:"30px"},src:Ee,alt:"Visualizar",title:"Reativar"},va={key:1,src:Ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},fa=["onClick"],st={__name:"Partes",async setup(ce){let v,C;const g=me(),c=pe(),m=_e(),{$toast:x}=ke(),E=`${m.public.managemant}/pesquisarPessoas`,Q=`${m.public.managemant}/listarPapeis`,T=`${m.public.managemant}/createAtosPessoa`,Z=`${m.public.managemant}/updateAtosPessoa`,w=`${m.public.managemant}/getAtosPessoaById`,D=`${m.public.managemant}/download`,b=o(G("user-data").value.cartorio_token),V=o(c.query.origem==="vizualizar"),f=o([]),K=o({}),$=o([]),J=o([]),P=o(!1),S=o(!1),X=o(!1),ee=o(!1),Y=o(null),y=o(null),h=o(null),ae=o(null),n=o(null),s=o(null),k=o(c.query.tipo_ato_token),M=o(null),q=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome",width:"320px"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante",width:"320px"},{value:"actions"}],d=xe({papeis:null,nome:null,pessoa:null,documento:null});je(()=>{var u;return((u=d.pessoa)==null?void 0:u.link_ficha)||!1});const{data:r}=([v,C]=ge(()=>_(Q,{method:"POST",body:{tipo_ato_token:c.query.tipo_ato_token}},"$acoiTIUp00")),v=await v,C(),v);J.value=r.value;const p=async()=>{const{data:u}=await _(`${w}/${c.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),L=(ve=>ve.map(ie=>({...ie,pessoa:{...ie.pessoa,documento:ie.pessoa.doc_identificacao},papel:{...ie.partes_tipos}})))(u.value);$.value=L};p();async function H(){try{const{data:u,error:l}=await _(E,{method:"POST",body:{cartorio_token:b.value,documento:d.documento,nome:d.nome}},"$pr30MyPXfY");u.value.length>0?(f.value=u.value,d.pessoa=f.value[0]):f.value=[]}catch(u){console.error("Erro na requisição",u)}}const N=()=>{S.value=!0},re=async()=>{await p()},j=async()=>{await p()},A=async()=>{const u={pessoa:d.pessoa,papel:J.value.find(ue=>ue.id===d.papeis),representante:{nome:null}},l=await _(`${w}/${c.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const ue of l.data.value)if(ue.pessoa_id===d.pessoa.id&&ue.ato_id===Number(c.query.ato_id)&&ue.tipo_parte_id===d.papeis){x.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:L,error:ve,status:ie}=await _(T,{method:"POST",body:{ato_id:Number(c.query.ato_id),pessoa_id:d.pessoa.id,tipo_parte_id:d.papeis,user_id:G("user-data").value.usuario_id}},"$18isAgOJxG");ie.value==="success"?(u.id=L.value.id,x.success("Pessoa Registrada com Sucesso!"),$.value.push(u)):x.error(ve.value.message)},se=async u=>{X.value=!0;const{data:l}=await _(D,{method:"POST",body:{bucket:G("user-data").value.cartorio_token,path:u.pessoa.link_ficha}},"$hmDzSF3F61");M.value=l.value,K.value=u.pessoa},ne=u=>{const l=$.value.filter(L=>L.pessoa.id!==u.pessoa.id&&!L.excluido).map(L=>({id:L.pessoa.id,nome:L.pessoa.nome,token:L.pessoa.token}));h.value=u.id,ae.value=u.token,Y.value=l,P.value=!0,y.value=u.pessoa.nome,s.value=u.pessoa.id},de=u=>{ee.value=!0,n.value=u.id,y.value=u.pessoa.nome};async function te(u){u.excluido=!u.excluido;try{await _(`${Z}/${u.id}`,{method:"PUT",body:JSON.stringify({excluido:u.excluido})},"$l09I6nLRfk")}catch(l){console.error("Erro ao excluir pessoa:",l)}}const le=()=>{const u=c.query.origem||"criar",l=c.query.id;switch(u){case"atualizar":case"vizualizar":g.push(`/os/atualizar/${l}`);break;case"atualizar-lista":case"vizualizar-lista":g.push("/atos/lista");break;default:g.push("/os/criar-registro");break}};return(u,l)=>{const L=Ne,ve=Ke,ie=He,ue=Ze,Se=he;return i(),I($e,null,{default:t(()=>[e(V)?R("",!0):(i(),I(F,{key:0,class:"mt-5"},{default:t(()=>[a(B,{cols:"3"},{default:t(()=>[a(ye,{label:"Documento",modelValue:e(d).documento,"onUpdate:modelValue":l[0]||(l[0]=U=>e(d).documento=U)},null,8,["modelValue"])]),_:1}),a(B,{cols:"4"},{default:t(()=>[a(ye,{label:"Pessoa",modelValue:e(d).nome,"onUpdate:modelValue":l[1]||(l[1]=U=>e(d).nome=U)},null,8,["modelValue"])]),_:1}),z("div",null,[z("img",{class:"mt-1",src:we,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:H})]),z("div",null,[z("img",{class:"mt-1 ml-2",src:Ce,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:N})])]),_:1})),e(V)?R("",!0):(i(),I(F,{key:1},{default:t(()=>[a(B,{cols:"4"},{default:t(()=>[a(be,{label:"Selecione a Pessoa",modelValue:e(d).pessoa,"onUpdate:modelValue":l[2]||(l[2]=U=>e(d).pessoa=U),items:e(f),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),a(B,{cols:"3"},{default:t(()=>[a(be,{label:"Papel",modelValue:e(d).papeis,"onUpdate:modelValue":l[3]||(l[3]=U=>e(d).papeis=U),items:e(J),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(V)?R("",!0):(i(),O("div",ia,[z("img",{class:"mt-1",src:Ce,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:A})]))]),_:1})),a(F,null,{default:t(()=>[a(B,null,{default:t(()=>[a(Ae,{style:{height:"465px"},headers:q,items:e($)},{"item.actions":t(({item:U})=>[e(V)?R("",!0):(i(),I(F,{key:0},{default:t(()=>[z("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-1",onClick:ze=>se(U),title:"Visualizar Ficha"},[U.pessoa.link_ficha?(i(),O("img",ua)):(i(),O("img",da))],8,ca),z("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ze=>de(U),class:"mr-1",title:"Alterar Papel"},l[8]||(l[8]=[z("img",{style:{width:"30px",height:"30px"},src:aa,alt:"Visualizar"},null,-1)]),8,ma),z("div",{class:"mr-1",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ze=>te(U),title:"Deletar Pessoa"},[U.excluido?(i(),O("img",_a)):(i(),O("img",va))],8,pa),z("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-1",onClick:ze=>ne(U),title:"Selecionar Representante"},l[9]||(l[9]=[z("img",{style:{width:"30px",height:"30px"},src:Ge,alt:"Visualizar"},null,-1)]),8,fa)]),_:2},1024))]),_:1},8,["items"])]),_:1})]),_:1}),a(L,{show:e(S),onClose:l[4]||(l[4]=U=>S.value=!1)},null,8,["show"]),a(ve,{representante_nome:e(y),representantes:e(Y),ato_pessoa_token:e(ae),ato_id:e(h),show:e(P),onClose:l[5]||(l[5]=U=>P.value=!1),onUpdateRepresentante:j},null,8,["representante_nome","representantes","ato_pessoa_token","ato_id","show"]),a(ie,{representante_nome:e(y),ato_token:e(k),ato_id:e(n),show:e(ee),onClose:l[6]||(l[6]=U=>ee.value=!1),onUpdatePapel:re},null,8,["representante_nome","ato_token","ato_id","show"]),e(X)?(i(),I(ue,{key:2,show:e(X),"link-view":e(M),"pessoa-obj":e(K),"is-view":!0,onClose:l[7]||(l[7]=U=>X.value=!1)},null,8,["show","link-view","pessoa-obj"])):R("",!0),a(F,null,{default:t(()=>[a(Se,{onClick:le},{default:t(()=>[a(oe,{size:"large",color:"red"},{default:t(()=>l[10]||(l[10]=[W("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},ya={key:0,class:"loading-overlay"},ga="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",rt={__name:"Minuta",emits:["page","doc"],setup(ce,{emit:v}){Ue("DocumentEditorContainer",[Je,We,Xe]);const C=_e(),{$toast:g}=ke(),c=me(),m=pe(),x=v;Me(`${C.public.docEditor}`);const E=`${C.public.managemant}/download`,Q=`${C.public.managemant}/atos/files`,T=`${C.public.managemant}/subitituirModelo`,Z=`${C.public.managemant}/upload`,w=o(null),D=o(!1),b=o("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),V=o(m.query.origem==="vizualizar"),f=o(!1),K=async n=>{try{const s=await fetch(n);if(!s.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await s.blob()}catch(s){return console.error(s),null}},$=async()=>{try{const{data:n}=await _(`${Q}/${m.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return n.value.link_ato}catch(n){console.error("Erro ao carregar o documento:",n),g.error(n)}},J=async()=>{f.value=!0;try{const n=await $(),{data:s,status:k}=await _(E,{method:"POST",body:{bucket:G("user-data").value.cartorio_token,path:n}},"$dvNFfvmIJC"),M=s.value,q=await K(M);if(q){const d=new FileReader;d.onload=()=>{const r=d.result;w.value.ej2Instances.documentEditor.open(r),x("doc",r)},d.readAsText(q)}}catch{console.error("Erro ao carregar o documento.")}finally{f.value=!1}},P=async()=>{const s=await w.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),k=new FileReader;k.onload=()=>{const M=k.result,d=w.value.ej2Instances.documentEditor.pageCount;x("page",d),x("doc",M)},k.readAsText(s)},S=async()=>{f.value=!0;try{const s=await w.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),k=new FormData;k.append("file",s,"anexo.sfdt"),k.append("cartorio_token",G("user-data").value.cartorio_token),k.append("token",m.query.ato_token_edit),k.append("tipo","ato_minuta");const{data:M,status:q}=await _(Z,{method:"POST",body:k},"$xv11VtUdMy");if(q.value==="success"){g.success("Documento enviado!");const r=w.value.ej2Instances.documentEditor.pageCount;P(),x("page",r)}else g.error("Erro ao enviar documento para o sistema.")}catch(n){g.error("Erro ao salvar documento."),console.error(n)}finally{f.value=!1}},X=()=>{D.value=!1,ee()},ee=async()=>{h(!0);try{await Y(),h(!0);const{data:n,status:s}=await _(T,{method:"POST",body:{ato_token:m.query.ato_token_edit}},"$zyzWHTXTBW");n.value&&y(n.value)}catch(n){console.error("Erro ao gerar a minuta:",n),g.error("Ocorreu um erro ao gerar a minuta.")}finally{h(!1)}},Y=async()=>{try{const{data:n}=await _(E,{method:"POST",body:{bucket:G("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),s=await K(n.value);if(s){const k=new FileReader;k.onload=()=>{const M=k.result;w.value.ej2Instances.documentEditor.open(M),x("doc",M)},k.readAsText(s)}}catch(n){console.error("Erro ao carregar o modelo de minuta:",n)}},y=n=>{const s=w.value.ej2Instances.documentEditor,k=M=>{for(const[q,d]of Object.entries(M))if(/^<<.+>>$/.test(q))try{s.search.findAll(q),s.search.searchResults.length>0&&s.search.searchResults.replaceAll(d)}catch(r){console.error(`Erro ao substituir o marcador ${q}:`,r)}else if(q==="partes"&&Array.isArray(d)&&d.length>0)for(const r of d)typeof r=="object"&&k(r)};k(n)},h=n=>{f.value=n},ae=()=>{const n=m.query.origem||"criar",s=m.query.id;switch(n){case"atualizar":case"vizualizar":c.push(`/os/atualizar/${s}`);break;case"atualizar-lista":case"vizualizar-lista":c.push("/atos/lista");break;default:c.push("/os/criar-registro");break}};return Re(async()=>{await J(),P()}),(n,s)=>{const k=he,M=De;return i(),O(Oe,null,[a(e(Te),{height:"900px",ref_key:"documentEditorContainer",ref:w,serviceUrl:ga,enableToolbar:!0,enableWordExport:!0},null,512),e(f)?(i(),O("div",ya,[a(Fe,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):R("",!0),a(F,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[a(k,{class:"mr-4"},{default:t(()=>[a(oe,{size:"large",onClick:ae,color:"red"},{default:t(()=>s[2]||(s[2]=[W("Voltar")])),_:1})]),_:1}),e(V)?R("",!0):(i(),I(oe,{key:0,size:"large",color:"green",onClick:S,disabled:e(f)},{default:t(()=>s[3]||(s[3]=[W("Atualizar")])),_:1},8,["disabled"])),e(V)?R("",!0):(i(),I(oe,{key:1,class:"ml-4",size:"large",color:"blue",onClick:s[0]||(s[0]=q=>D.value=!0)},{default:t(()=>s[4]||(s[4]=[W("Gerar Minuta")])),_:1}))]),_:1}),a(M,{onConfirm:X,condMessage:e(b),show:e(D),onClose:s[1]||(s[1]=q=>D.value=!1)},null,8,["condMessage","show"])],64)}}},ha={key:0},ka=["src"],ba={key:1},xa=["innerHTML"],nt={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0},linkLivro:{type:String||null}},async setup(ce){let v,C;const g=ce,c=_e();Me(`${c.public.docEditor}`);const{$toast:m}=ke(),x=me(),E=pe(),Q=`${c.public.managemant}/download`,T=`${c.public.managemant}/atos/files`,Z=`${c.public.managemant}/lavrarAto`,w=`${c.public.managemant}/valida_lavratura`,D=`${c.public.managemant}/listarEscrevente`,b=`${c.public.managemant}/ato_calcular`,V=o(G("user-data").value.cartorio_token),f=G("auth_token").value,K=o("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),$=o(null),J=o(""),P=o(!1),S=o(null),X=o(null),ee=o(E.query.origem==="vizualizar"),Y=o(null),y=o([]),h=o({}),ae=o(null),n=xe({escrevente:null}),s=async j=>{try{const A=await fetch(j);if(!A.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await A.blob()}catch(A){return console.error(A),null}},k=async()=>{try{const{data:j}=await _(`${T}/${E.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return j.value.link_ato}catch(j){console.error("Erro ao carregar o documento:",j),m.error(j)}},M=async()=>{try{if(g.linkLivro){const{data:te}=await _(Q,{method:"POST",body:{bucket:G("user-data").value.cartorio_token,path:g.linkLivro}},"$7ljqltMqa0");ae.value=te.value;return}const j=await k(),{data:A,status:se}=await _(Q,{method:"POST",body:{bucket:G("user-data").value.cartorio_token,path:j}},"$OWxZSQkyX8"),ne=A.value,de=await s(ne);if(de){const te=new FileReader;te.onload=()=>{const le=te.result;Y.value.ej2Instances.documentEditor.open(le)},te.readAsText(de)}}catch{m.error("Erro ao carregar o documento.")}};M();const q=async(j=!1)=>{const A=Y.value.ej2Instances.documentEditor.pageCount;if(!j){const{data:te,error:le,status:u}=await _(w,{method:"POST",body:{ato_token:E.query.ato_token_edit}},"$sMqfUUQcBM");let l,L;if(u.value==="success"&&te.value?(l=te.value[0].status,L=te.value[0].status_mensagem):le.value&&le.value.data&&(l=le.value.data[0].status,L=le.value.data[0].status_mensagem),l!=="OK"){$.value=l,J.value=L,h.value=null,P.value=!0,K.value=" O ato apresenta inconsistências, deseja prosseguir?";return}}const{data:se,status:ne,error:de}=await _(Z,{method:"POST",body:{ato_token:E.query.ato_token_edit,qtd_paginas:A,escrevente_token:n.escrevente,usuario_token:f,cartorio_token:V}},"$OVwiKSwcOE");ne.value==="success"?(S.value=se.value,X.value=se.value[0].selo,m.success("Ato lavrado com sucesso!")):m.error(de.value.data[0].status_mensagem||"Falha ao lavrar o ato.")},d=()=>{P.value=!1,$.value=null,J.value="",h.value={}},r=async()=>{const j=Y.value.ej2Instances.documentEditor.pageCount,{data:A,status:se}=await _(b,{method:"POST",body:{ato_token:E.query.ato_token_edit,cartorio_token:V,quantidade:1,usuario_token:f,escrevente_token:n.escrevente,qtd_paginas:j}},"$iv1N3XD6We");se.value==="success"?h.value=A.value[0]:m.error("Falha ao calcular o ato.")},p=async()=>{P.value=!1,$.value&&$.value!=="OK"?(await q(!0),$.value=null,J.value=""):await q()},H=async()=>{P.value=!0,K.value="Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?",await r()},{data:N}=([v,C]=ge(()=>_(D,{method:"POST",body:{cartorio_token:V}},"$Kj765fCvMC")),v=await v,C(),v);y.value=N.value[0].func_json_escreventes;const re=()=>{const j=E.query.origem||"criar",A=E.query.id;switch(j){case"atualizar":case"vizualizar":x.push(`/os/atualizar/${A}`);break;case"atualizar-lista":case"vizualizar-lista":x.push("/atos/lista");break;default:x.push("/os/criar-registro");break}};return Ie(()=>g.document,()=>{M()}),(j,A)=>{const se=De;return i(),O(Oe,null,[a(F,null,{default:t(()=>[a(B,null,{default:t(()=>[g.linkLivro?(i(),O("div",ha,[z("iframe",{src:e(ae),type:"application/pdf",width:"100%",height:"850px"},null,8,ka)])):(i(),O("div",ba,[a(e(Te),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:Y,height:"850px",width:"850px"},null,512)]))]),_:1}),e(ee)?R("",!0):(i(),I(B,{key:0},{default:t(()=>[a(be,{class:"mt-15",label:"Tabelião/escrevente",modelValue:e(n).escrevente,"onUpdate:modelValue":A[0]||(A[0]=ne=>e(n).escrevente=ne),items:e(y),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),z("img",{onClick:A[1]||(A[1]=ne=>H()),style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Ye}),e(S)?(i(),I(ta,{key:0,width:"360"},{default:t(()=>[a(F,null,{default:t(()=>[a(B,null,{default:t(()=>[a(Pe,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[a(B,null,{default:t(()=>[W(" Livro: "+fe(e(S)[0].livro_numero),1)]),_:1}),a(B,null,{default:t(()=>[W(" Protocolo: "+fe(e(S)[0].protocolo?e(S)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),a(B,null,{default:t(()=>[a(Pe,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:t(()=>[W(" Folhas : "+fe(e(S)[0].pagina_inicial)+" A "+fe(e(S)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),z("div",{style:{"margin-left":"10px","padding-bottom":"20px","margin-top":"-10px"},innerHTML:e(X)},null,8,xa)]),_:1})):R("",!0)]),_:1}))]),_:1}),a(oe,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:re},{default:t(()=>A[2]||(A[2]=[W("Voltar")])),_:1}),a(se,{show:e(P),condMessage:e(K),description:e(J),valor:e(h),onClose:d,onConfirm:p},null,8,["show","condMessage","description","valor"])],64)}}},$a=["onClick"],wa=["onClick"],za={key:0,style:{width:"30px",height:"30px"},src:Ee,alt:"Visualizar",title:"Reativar"},Ca={key:1,src:Ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},lt={__name:"Observacao",async setup(ce){let v,C;const g=me(),c=pe(),m=_e(),x=`${m.public.managemant}/listarEscrevente`,E=`${m.public.managemant}/atos_observacao`,Q=`${m.public.managemant}/atos_observacao`,T=o(G("user-data").value.cartorio_token),Z=o(c.query.origem==="vizualizar"),w=o(!1),D=o(!1),b=o(""),V=o([]),f=o([]);function K(y){b.value=y.observacao,D.value=!0,w.value=!0}const $=()=>{D.value=!1,w.value=!0,b.value=""},J=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],P=async()=>{w.value=!1,await S()};async function S(){const{data:y}=await _(`${Q}/${c.query.ato_id}`,{method:"GET"},"$HyzoO40swN");Array.isArray(y.value)?V.value=y.value.map(h=>({...h,created:qe(h.created,"dd/mm/yyyy hh:mm")})):y.value&&typeof y.value=="object"&&(V.value=[{...y.value,created:qe(y.value.created,"dd/mm/yyyy hh:mm")}])}[v,C]=ge(()=>S()),await v,C();async function X(y){y.excluido=!y.excluido;try{await _(`${E}/${y.id}`,{method:"PUT",body:JSON.stringify({excluido:y.excluido})},"$gnHMo4uCXD")}catch(h){console.error("Erro ao excluir observação:",h)}}const{data:ee}=([v,C]=ge(()=>_(x,{method:"POST",body:{cartorio_token:T}},"$sP9AKdd3Ky")),v=await v,C(),v);f.value=ee.value[0].func_json_escreventes;const Y=()=>{const y=c.query.origem||"criar",h=c.query.id;switch(y){case"atualizar":case"vizualizar":g.push(`/os/atualizar/${h}`);break;case"atualizar-lista":case"vizualizar-lista":g.push("/atos/lista");break;default:g.push("/os/criar-registro");break}};return(y,h)=>{const ae=Qe,n=he;return i(),I($e,null,{default:t(()=>[e(Z)?R("",!0):(i(),I(F,{key:0,class:"mt-5"},{default:t(()=>[e(Z)?R("",!0):(i(),I(oe,{key:0,class:"mb-4 ml-8",onClick:$,size:"large",color:"green"},{default:t(()=>h[0]||(h[0]=[W("Novo")])),_:1}))]),_:1})),a(F,null,{default:t(()=>[a(B,null,{default:t(()=>[a(Ae,{style:{height:"465px"},headers:J,items:e(V)},{"item.observacao":t(({item:s})=>[W(fe(s.observacao.length>100?s.observacao.slice(0,100)+"...":s.observacao),1)]),"item.actions":t(({item:s})=>[a(F,null,{default:t(()=>[z("div",{onClick:k=>K(s)},h[1]||(h[1]=[z("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:we,alt:"Visualizar"},null,-1)]),8,$a),z("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end","margin-left":"5px"},onClick:k=>X(s),title:"Deletar Observação"},[s.excluido?(i(),O("img",za)):(i(),O("img",Ca))],8,wa)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(w)?(i(),I(ae,{key:1,show:e(w),observacao:e(b),visualizar:e(D),onClose:P},null,8,["show","observacao","visualizar"])):R("",!0),a(F,null,{default:t(()=>[a(n,{onClick:Y},{default:t(()=>[a(oe,{size:"large",color:"red"},{default:t(()=>h[2]||(h[2]=[W("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},Ea={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Le,alt:"Criar"},Va={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Be,alt:"Criar"},Aa={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:sa,alt:"Criar"},Pa=["onClick"],qa=["onClick"],Oa=["onClick"],Ta={key:0,style:{width:"30px",height:"30px"},src:Ee,alt:"Visualizar",title:"Reativar"},Ma={key:1,src:Ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},it={__name:"Anexos",async setup(ce){let v,C;const g=_e(),{$toast:c}=ke(),m=me(),x=pe(),E=o(x.query.origem==="vizualizar"),Q=`${g.public.biometria}/run-scanner`,T=`${g.public.managemant}/atos_anexos`,Z=`${g.public.managemant}/atos_anexos`,w=`${g.public.managemant}/download`,D=`${g.public.managemant}/atos_anexos`,b=`${g.public.managemant}/upload`,V=o(!1),f=o(null),K=o([]);G("pessoa_token");const $=xe({descricao:"",fileEvent:null}),J={descricao:{required:ra.withMessage("O campo é obrigatório",na)}},P=la(J,$,{$autoDirty:!0}),S=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:X}=([v,C]=ge(()=>_(`${D}/${x.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),v=await v,C(),v);K.value=X.value;async function ee(){try{await Y(),await y()}catch(r){console.error("Erro ao executar scanner ou listar arquivos:",r)}}async function Y(){try{const{data:r}=await _(Q,{method:"GET"},"$KttjFhHivJ")}catch(r){c.error("Erro ao acionar o scanner:",r)}}async function y(){try{const{data:r,status:p}=await _("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:x.query.ato_token_edit,cartorio_token:G("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(r){console.error("Erro ao enviar o arquivo:",r)}}async function h(){try{const r=document.createElement("input");r.type="file",r.accept="*/*",r.onchange=async p=>{$.fileEvent=p,p.target.files[0]&&(f.value=!0)},r.click()}catch(r){console.error("Erro ao abrir o explorador de arquivos:",r)}}const ae=async()=>{V.value=!0};function n(r){return r?!0:(f.value=!1,!1)}const s=async r=>{if(!$.fileEvent||!$.fileEvent.target.files.length){c.error("Nenhum arquivo selecionado.");return}const p=$.fileEvent.target.files[0],H=new FormData;H.append("file",p),H.append("cartorio_token",G("user-data").value.cartorio_token),H.append("token",r),H.append("tipo","ato_anexo");try{const N=await _(b,{method:"POST",body:H},"$KDhIYzGKzM");c.success("Anexo registrado com sucesso!")}catch{c.error("Erro ao enviar o arquivo.")}},k=async()=>{if(P.value.$touch(),!P.value.$invalid&&n($.fileEvent)){const{data:r,error:p,status:H}=await _(T,{method:"POST",body:{ato_id:x.query.ato_id,descricao:$.descricao,user_id:G("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$cdoFBGO0Ti");H.value==="success"&&(c.success("Anexo registrado com sucesso!"),K.value.push(r.value),s(r.value.token))}};async function M(r){r.excluido=!r.excluido;try{await _(`${Z}/${r.id}`,{method:"PUT",body:JSON.stringify({excluido:r.excluido})},"$WLSrgYRoHq")}catch(p){console.error("Erro ao excluir pessoa:",p)}}async function q(r){try{const p=await _(`${w}`,{method:"POST",body:{bucket:G("user-data").value.cartorio_token,path:r.link}},"$NdgRjioizH"),N=await(await fetch(p.data.value)).blob(),re=URL.createObjectURL(N);window.open(re,"_blank")}catch(p){console.error("Erro ao excluir pessoa:",p)}}const d=()=>{const r=x.query.origem||"criar",p=x.query.id;switch(r){case"atualizar":case"vizualizar":m.push(`/os/atualizar/${p}`);break;case"atualizar-lista":case"vizualizar-lista":m.push("/atos/lista");break;default:m.push("/os/criar-registro");break}};return(r,p)=>{const H=he;return i(),I($e,null,{default:t(()=>[a(F,null,{default:t(()=>[a(B,{cols:"5",class:"mt-2"},{default:t(()=>[e(E)?R("",!0):(i(),I(ye,{key:0,modelValue:e($).descricao,"onUpdate:modelValue":[p[0]||(p[0]=N=>e($).descricao=N),e(P).descricao.$touch],"error-messages":e(P).descricao.$errors.map(N=>N.$message),onBlur:e(P).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"]))]),_:1}),e(E)?R("",!0):(i(),O("div",{key:0,onClick:ee,title:"Escanear"},p[1]||(p[1]=[z("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:oa,alt:"Escanear"},null,-1)]))),e(E)?R("",!0):(i(),O("div",{key:1,onClick:h,title:"Criar"},[e(f)===!1?(i(),O("img",Ea)):e(f)===!0?(i(),O("img",Va)):(i(),O("img",Aa))])),e(E)?R("",!0):(i(),O("div",{key:2,onClick:k,title:"Criar"},p[2]||(p[2]=[z("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ce,alt:"Criar"},null,-1)])))]),_:1}),a(Ae,{headers:S,items:e(K),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:N})=>[a(F,null,{default:t(()=>[z("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:re=>ae(N),title:"Visualizar Anexo"},[z("img",{style:{width:"30px",height:"30px"},onClick:re=>q(N),src:we,alt:"Visualizar"},null,8,qa)],8,Pa),z("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:re=>M(N),title:"Deletar Pessoa"},[N.excluido?(i(),O("img",Ta)):(i(),O("img",Ma))],8,Oa)]),_:2},1024)]),_:1},8,["items"]),a(H,{onClick:d},{default:t(()=>[a(oe,{size:"large",color:"red"},{default:t(()=>p[3]||(p[3]=[W("Voltar")])),_:1})]),_:1})]),_:1})}}};export{ot as _,st as a,rt as b,nt as c,lt as d,it as e};
