import{_ as ue}from"./C_5qy7sQ.js";import{_ as ce}from"./CxMWwUNL.js";import{_ as me}from"./CqfQc6g9.js";import{_ as de}from"./o6CKp184.js";import{_ as B}from"./BHSGMGOy.js";import{_ as pe}from"./BVz1G1IN.js";import{_ as ve}from"./lL_wZ7Hl.js";import{a as _e}from"./DJvq3mCv.js";import{L as fe,P as ke,u as he,r as l,m as _,n as ye,G as ge,c as $,b as t,w as r,q as o,p as Ve,A as be,F as we,v as Pe,o as V,C as q,a as u,V as E,d as N}from"./DP3qcOMz.js";import{u as m}from"./CtJXq5EX.js";import{V as b}from"./0oLPtT-r.js";import{V as d}from"./tkLs4TKj.js";import{V as xe}from"./D8SSUY1X.js";import{V as j}from"./Ds7CA34Q.js";import"./D8tBkyop.js";import"./DX4VL7_W.js";import"./CV8HQgQO.js";import"./C2XSGdQM.js";import"./B0IxRygJ.js";import"./qs1__QEg.js";import"./BUXXOQvW.js";import"./bhuJpQuo.js";import"./ChQBZ17x.js";import"./Q7fyLs9I.js";import"./cXFZDrSw.js";import"./D9PM0Nbz.js";import"./BUlLaMYO.js";import"./Ca0IpsuN.js";import"./B80RE6Z1.js";const $e=["onClick"],qe={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:B,alt:"Possui Ficha",title:"Possui Ficha"},Ce={key:1,style:{width:"30px",height:"30px",cursor:"pointer"},src:ve,alt:"Visualizar",title:"Não Possui Ficha"},Se=["onClick"],rt={__name:"semelhanca",props:{ato_token:{type:String,required:!0}},emits:["ato-created"],async setup(A,{emit:D}){let f,C;const I=A,U=D,S=fe(),F=ke(),c=Pe(),{$toast:T}=he(),L=`${c.public.managemant}/listarEscrevente`,K=`${c.public.managemant}/pesquisarPessoas`,W=`${c.public.managemant}/atoReconhecimento`,G=`${c.public.managemant}/etiquetaReconhecimento`,Q=`${c.public.managemant}/download`,Z=`${c.public.envioDoc}/print`,k=l(_("user-data").value.cartorio_token),H=l(_("user-service").value.token).value||l(_("user-service").value).value,Y=_("auth_token").value,w=l([]),z=l([]),p=l([]),P=l(!1),x=l(!1),h=l(!1),y=l(null),M=l(null),O=l(""),R=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],n=ye({quantidade:1,escrevente:null,nome:null,documento:null}),{data:J}=([f,C]=ge(()=>m(L,{method:"POST",body:{cartorio_token:k}},"$iEFsIjdWdW")),f=await f,C(),f);z.value=J.value[0].func_json_escreventes;async function X(){try{const{data:a,error:e}=await m(K,{method:"POST",body:{cartorio_token:k.value,documento:n.documento,nome:n.nome}},"$uzKb8LPV3v");a.value.length>0?(w.value=a.value,U("ato-created")):w.value=[]}catch(a){console.error("Erro na requisição",a)}}const ee=()=>{x.value=!0};function te(a){p.value.push(a)}const oe=async a=>{y.value=a,h.value=!0;const{data:e}=await m(Q,{method:"POST",body:{bucket:_("user-data").value.cartorio_token,path:a.link_ficha}},"$MulQmK1LAp");M.value=e.value};function ae(a){p.value=p.value.filter(e=>e.token!==a.token)}async function se(){if(!n.escrevente){T.error("Por favor selecione um Escrevente");return}const a=p.value.map(e=>({pessoa_token:e.token}));try{const{data:e,error:g,status:v}=await m(W,{method:"POST",body:{pessoas:a,cartorio_token:k.value,ordemserv_token:H,quantidade:n.quantidade,usuario_token:Y,ato_tipo_token:I.ato_token}},"$fMGlIlw995");v.value==="success"&&e.value[0].status==="OK"?re(e.value[0].token):(P.value=!0,O.value=ato_token.value.status_mensagem||g.value.data.details)}catch(e){console.error("Erro na requisição",e)}}async function re(a){try{const{data:e,error:g,status:v}=await m(G,{method:"POST",body:{ato_token:a,cartorio_token:k.value,escrevente_token:n.escrevente}},"$oSnYNRtP6Z");if(v.value==="success"){if(e.value[0].tipo_etiqueta==="html"){const i=window.open("","_blank");i.document.open(),i.document.write(e.value[0].etiqueta),i.document.close()}else if(e.value[0].tipo_etiqueta==="zpl"){const{status:i}=await m(`${Z}`,{method:"POST",body:{zpl:atob(e.value[0].etiqueta)}},"$BtUyHn78O6");if(i.value!=="success"){T.error("Não foi possivel fazer a impressao da etiqueta");return}}}}catch(e){console.error("Erro na requisição",e)}}const ne=()=>{const a=F.query.origem||"criar",e=F.query.id;a==="atualizar"?S.push(`/os/atualizar/${e}`):S.push("/os/criar-registro")};return(a,e)=>{const g=ue,v=ce,i=me,le=de;return V(),$(we,null,[t(b,{class:"mt-5"},{default:r(()=>[t(d,{cols:"5"},{default:r(()=>[t(xe,{label:"Tabelião/escrevente",modelValue:o(n).escrevente,"onUpdate:modelValue":e[0]||(e[0]=s=>o(n).escrevente=s),items:o(z),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),t(d,{cols:"2"},{default:r(()=>[t(q,{label:"Quantidade",type:"number",modelValue:o(n).quantidade,"onUpdate:modelValue":e[1]||(e[1]=s=>o(n).quantidade=s)},null,8,["modelValue"])]),_:1})]),_:1}),t(b,null,{default:r(()=>[t(d,{cols:"3"},{default:r(()=>[t(q,{label:"Documento",modelValue:o(n).documento,"onUpdate:modelValue":e[2]||(e[2]=s=>o(n).documento=s)},null,8,["modelValue"])]),_:1}),t(d,{cols:"4"},{default:r(()=>[t(q,{label:"Pessoa",modelValue:o(n).nome,"onUpdate:modelValue":e[3]||(e[3]=s=>o(n).nome=s)},null,8,["modelValue"])]),_:1}),u("div",null,[u("img",{class:"btn-pointer mt-3",src:B,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:X})]),u("div",null,[u("img",{class:"btn-pointer mt-3 ml-2",src:pe,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ee})])]),_:1}),t(b,null,{default:r(()=>[t(d,{class:"mr-10"},{default:r(()=>[t(j,{style:{height:"465px"},headers:R,items:o(w)},{"item.actions":r(({item:s})=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ie=>oe(s),title:"Visualizar Ficha"},[s.link_ficha?(V(),$("img",qe)):(V(),$("img",Ce))],8,$e)]),_:1},8,["items"])]),_:1}),t(d,null,{default:r(()=>[t(j,{headers:R,items:o(p),style:{height:"465px"},"item-key":"id"},{"item.actions":r(({item:s})=>[u("div",{style:{display:"flex","justify-content":"flex-end"},onClick:ie=>ae(s),title:"Remover"},e[8]||(e[8]=[u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:_e,alt:"Remover"},null,-1)]),8,Se)]),_:1},8,["items"])]),_:1})]),_:1}),t(g,{show:o(x),onClose:e[4]||(e[4]=s=>x.value=!1)},null,8,["show"]),o(h)?(V(),Ve(v,{key:0,show:o(h),item:o(y),"pessoa-obj":o(y),"link-view":o(M),onConfirmar:e[5]||(e[5]=s=>te(o(y))),onClose:e[6]||(e[6]=s=>h.value=!1)},null,8,["show","item","pessoa-obj","link-view"])):be("",!0),t(b,null,{default:r(()=>[t(i,{onClick:ne},{default:r(()=>[t(E,{size:"large",color:"red"},{default:r(()=>e[9]||(e[9]=[N("Voltar")])),_:1})]),_:1}),t(E,{class:"ml-5",onClick:se,size:"large",color:"green"},{default:r(()=>e[10]||(e[10]=[N("Salvar")])),_:1})]),_:1}),t(le,{show:o(P),errorMessage:o(O),onClose:e[7]||(e[7]=s=>P.value=!1)},null,8,["show","errorMessage"])],64)}}};export{rt as default};
