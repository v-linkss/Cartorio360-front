import{_ as oe}from"./DYCjZhxV.js";import{c as me,r as pe,u as _e}from"./yghpo_da.js";import{g as ze,m as Y,O as Z,u as H,r as i,n as C,p as ae,H as te,o as S,y as K,w as o,b as e,x as t,V as X,I as J,d as U,A as Q,K as Fe,a as f,c as N,z as ve,Q as De,R as Me,F as be,S as he,t as se}from"./Dlqmy1RL.js";import{u as h}from"./C_GLwl2T.js";import{V as F}from"./BKuoGoND.js";import{V as R}from"./wTX4dFQI.js";import{V as re}from"./syGi6Sh6.js";import{V as le}from"./DAKMzE7Y.js";import{_ as Re}from"./B6LtOqaK.js";import{_ as Ie,a as je,b as Be,T as Ne,W as Ue,D as ke,c as Le,e as We,f as Ge,d as Je}from"./Beslshpo.js";import{_ as Ke,r as xe}from"./dKVMa679.js";import{_ as de}from"./DlI8Qddj.js";import{_ as ne}from"./BVz1G1IN.js";import{_ as Xe}from"./CV_4hpUE.js";import{_ as fe,a as ge}from"./DJvq3mCv.js";import{V as ye}from"./Dwnwy4ft.js";import{_ as Ye}from"./CBzVbGoF.js";import{V as Ze}from"./R8R8AvG3.js";import{f as He}from"./B0IxRygJ.js";const Rt={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_tipo_id:{type:Number}},emits:["saved"],async setup(L,{emit:y}){let g,_;const b=L;ze(()=>b.ato_tipo_id,r=>{$.value={id:r}});const V=y,k=Y(),E=Z(),I=Q(),{$toast:B}=H(),W=`${I.public.managemant}/listarSituacoes`,A=`${I.public.managemant}/createAtos`;`${I.public.managemant}`;const P=i(C("user-data").value.cartorio_token),x=i(C("user-service").value.id).value||i(C("user-service").value).value,j=i([]),$=i(b.ato_tipo_id?{id:b.ato_tipo_id}:null),v=ae({dt_abertura:null,status:"EM EDIÇÃO",mne:null}),q={status:{required:me.withMessage("O campo é obrigatorio",pe)}},w=_e(q,v);async function D(){if(await w.value.$validate()){const{data:r,error:a,status:d}=await h(A,{method:"POST",body:{ato_tipo_id:$.value.id,cartorio_id:C("user-data").value.cartorio_id,ordemserv_id:x,status:v.status,dt_abertura:v.dt_abertura,mne:v.mne,user_id:C("user-data").value.usuario_id,user_alteracao_id:C("user-data").value.usuario_id}},"$9ZmTYsLk0K");d.value==="success"&&(B.success("Ato registrado com sucesso!"),V("saved",{id:r.value.id,token:r.value.token}))}else B.error("Preencha os campos obrigatorios.")}const{data:M}=([g,_]=te(()=>h(W,{method:"POST",body:{cartorio_token:P.value}},"$hyq5YcBEjF")),g=await g,_(),g);j.value=M.value;const u=()=>{const r=E.query.origem||"criar",a=E.query.id;r==="atualizar"?k.push(`/os/atualizar/${a}`):k.push("/os/criar-registro")};return(r,a)=>{const d=oe;return S(),K(le,null,{default:o(()=>[e(F,{class:"mt-5"},{default:o(()=>[e(R,{cols:"3"},{default:o(()=>[e(re,{label:"Situação",modelValue:t(v).status,"onUpdate:modelValue":a[0]||(a[0]=m=>t(v).status=m),items:t(j),"item-title":"descricao","item-value":"descricao",required:"","error-messages":t(w).status.$errors.map(m=>m.$message),onBlur:t(w).status.$touch,onInput:t(w).status.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1})]),_:1}),e(F,null,{default:o(()=>[e(R,{cols:"5"},{default:o(()=>[e(X,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:t(v).mne,"onUpdate:modelValue":a[1]||(a[1]=m=>t(v).mne=m)},null,8,["modelValue"])]),_:1})]),_:1}),e(F,null,{default:o(()=>[e(R,{cols:"2"},{default:o(()=>[e(X,{modelValue:t(v).dt_abertura,"onUpdate:modelValue":a[2]||(a[2]=m=>t(v).dt_abertura=m),type:"date",label:"Data Lavratura",disabled:"",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(F,{class:"mb-3"},{default:o(()=>[e(d,{onClick:u},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>a[3]||(a[3]=[U("Voltar")])),_:1})]),_:1}),e(J,{class:"ml-10",onClick:D,size:"large",color:"green"},{default:o(()=>a[4]||(a[4]=[U("Salvar")])),_:1})]),_:1})]),_:1})}}},Qe=["onClick"],et=["onClick"],tt=["onClick"],ot={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},at={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},st=["onClick"],It={__name:"Partes",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},async setup(L){let y,g;const _=L,b=Y(),V=Z(),k=Q(),{$toast:E}=H(),I=`${k.public.managemant}/pesquisarPessoas`,B=`${k.public.managemant}/listarPapeis`,W=`${k.public.managemant}/download`,A=`${k.public.managemant}/createAtosPessoa`,P=`${k.public.managemant}/getAtosPessoaById`,x=`${k.public.managemant}/updateAtosPessoa`,j=i(C("user-data").value.cartorio_token),$=i([]),v=i({}),q=i([]),w=i([]),D=i(!1),M=i(!1),u=i(!1),r=i(!1),a=i(null),d=i(null),m=i(null),l=i(null);i(null);const p=i(null),O=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome",width:"30%"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome",width:"25%"},{value:"actions"}],s=ae({papeis:null,nome:null,pessoa:null,documento:null});Fe(()=>{var c;return((c=s.pessoa)==null?void 0:c.link_ficha)||!1});const{data:G}=([y,g]=te(()=>h(B,{method:"POST",body:{tipo_ato_token:_.ato_token}},"$fFKndZhA4W")),y=await y,g(),y);w.value=G.value;async function ee(){try{const{data:c,error:n}=await h(I,{method:"POST",body:{cartorio_token:j.value,documento:s.documento,nome:s.nome}},"$o3ZL1rvYrY");c.value.length>0?($.value=c.value,s.pessoa=$.value[0]):$.value=[]}catch(c){console.error("Erro na requisição",c)}}const $e=()=>{M.value=!0},we=c=>{q.value=q.value.map(n=>n.id===m.value?{...n,papel:{...n.papel,descricao:c}}:n)},Ce=c=>{const n=q.value.find(T=>T.pessoa.id===l.value);n.representante.nome=c},Ve=async()=>{const c={pessoa:s.pessoa,papel:w.value.find(T=>T.id===s.papeis),representante:{nome:null}},n=await h(`${P}/${_.ato_id}`,{method:"GET"},"$kXSxUa4grs");for(const T of n.data.value)if(T.pessoa_id===s.pessoa.id&&T.ato_id===_.ato_id&&T.tipo_parte_id===s.papeis){E.error("Pessoa Já Registrada Com Esse Papel!");return}try{const{data:T,error:ie,status:ue}=await h(A,{method:"POST",body:{ato_id:Number(_.ato_id),pessoa_id:s.pessoa.id,tipo_parte_id:s.papeis,user_id:Number(C("user-data").value.usuario_id)}},"$So3qnQu7ek");ue.value==="success"?(c.id=T.value.id,E.success("Pessoa Registrada com Sucesso!"),q.value.push(c)):E.error(ie.value.message)}catch{E.error("Erro no servidor. Tente novamente.")}},Ee=async c=>{u.value=!0;const{data:n}=await h(W,{method:"POST",body:{bucket:C("user-data").value.cartorio_token,path:c.pessoa.link_ficha}},"$Q3kbIwtd9t");p.value=n.value,v.value=c.pessoa},Pe=c=>{const n=q.value.filter(T=>T.pessoa.id!==c.pessoa.id).map(T=>({id:T.pessoa.id,nome:T.pessoa.nome}));m.value=c.id,a.value=n,D.value=!0,d.value=c.pessoa.nome,l.value=c.pessoa.id},Se=c=>{m.value=c.id,r.value=!0,d.value=c.pessoa.nome};async function Ae(c){c.excluido=!c.excluido;try{await h(`${x}/${m.value}`,{method:"PUT",body:JSON.stringify({excluido:c.excluido})},"$9xStKwGd7o")}catch(n){console.error("Erro ao excluir pessoa:",n)}}const qe=()=>{const c=V.query.origem||"criar",n=V.query.id;c==="atualizar"?b.push(`/os/atualizar/${n}`):b.push("/os/criar-registro")};return(c,n)=>{const T=Re,ie=je,ue=Be,Oe=Ke,Te=oe;return S(),K(le,null,{default:o(()=>[e(F,{class:"mt-5"},{default:o(()=>[e(R,{cols:"3"},{default:o(()=>[e(X,{label:"Documento",modelValue:t(s).documento,"onUpdate:modelValue":n[0]||(n[0]=z=>t(s).documento=z)},null,8,["modelValue"])]),_:1}),e(R,{cols:"4"},{default:o(()=>[e(X,{label:"Pessoa",modelValue:t(s).nome,"onUpdate:modelValue":n[1]||(n[1]=z=>t(s).nome=z)},null,8,["modelValue"])]),_:1}),f("div",null,[f("img",{class:"mt-3",src:de,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:ee})]),f("div",null,[f("img",{class:"mt-3 ml-2",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:$e})])]),_:1}),e(F,null,{default:o(()=>[e(R,{cols:"4"},{default:o(()=>[e(re,{label:"Selecione a Pessoa",modelValue:t(s).pessoa,"onUpdate:modelValue":n[2]||(n[2]=z=>t(s).pessoa=z),items:t($),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(R,{cols:"3"},{default:o(()=>[e(re,{label:"Papel",modelValue:t(s).papeis,"onUpdate:modelValue":n[3]||(n[3]=z=>t(s).papeis=z),items:t(w),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),f("div",null,[f("img",{class:"mt-3",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Ve})])]),_:1}),e(F,null,{default:o(()=>[e(R,null,{default:o(()=>[e(ye,{style:{height:"465px"},headers:O,items:t(q)},{"item.actions":o(({item:z})=>[e(F,null,{default:o(()=>[f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>Ee(z),title:"Visualizar Ficha"},n[8]||(n[8]=[f("img",{style:{width:"30px",height:"30px"},src:de,alt:"Visualizar"},null,-1)]),8,Qe),f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Se(z),class:"mr-2",title:"Alterar Papel"},n[9]||(n[9]=[f("img",{style:{width:"30px",height:"30px"},src:Xe,alt:"Visualizar"},null,-1)]),8,et),f("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Ae(z),title:"Deletar Pessoa"},[z.excluido?(S(),N("img",ot)):(S(),N("img",at))],8,tt),f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>Pe(z),title:"Selecionar Representante"},n[10]||(n[10]=[f("img",{style:{width:"30px",height:"30px"},src:Ie,alt:"Visualizar"},null,-1)]),8,st)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(T,{show:t(M),onClose:n[4]||(n[4]=z=>M.value=!1)},null,8,["show"]),e(ie,{representante_nome:t(d),representantes:t(a),ato_id:t(m),show:t(D),onClose:n[5]||(n[5]=z=>D.value=!1),onUpdateRepresentante:Ce},null,8,["representante_nome","representantes","ato_id","show"]),e(ue,{representante_nome:t(d),ato_token:_.ato_token,ato_id:t(m),show:t(r),onClose:n[6]||(n[6]=z=>r.value=!1),onUpdatePapel:we},null,8,["representante_nome","ato_token","ato_id","show"]),t(u)?(S(),K(Oe,{key:0,show:t(u),"link-view":t(p),"pessoa-obj":t(v),"is-view":!0,onClose:n[7]||(n[7]=z=>u.value=!1)},null,8,["show","link-view","pessoa-obj"])):ve("",!0),e(F,null,{default:o(()=>[e(Te,{onClick:qe},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>n[11]||(n[11]=[U("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},rt={key:0,class:"loading-overlay"},nt="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",jt={__name:"Minuta",props:{ato_token:{type:String,required:!0}},emits:["page","doc"],setup(L,{emit:y}){const g=L;De("DocumentEditorContainer",[Ne,Ue]);const _=Q(),{$toast:b}=H(),V=Y(),k=Z(),E=y;xe(`${_.public.docEditor}`);const I=`${_.public.managemant}/upload`,B=`${_.public.managemant}/subitituirModelo`,W=`${_.public.managemant}/download`,A=i(null),P=i(!1),x=async u=>{try{const r=await fetch(u);if(!r.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await r.blob()}catch(r){return console.error(r),null}},j=async()=>{const r=await A.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),a=new FileReader;a.onload=()=>{const d=a.result;E("doc",d)},a.readAsText(r)},$=async()=>{P.value=!0;try{const r=await A.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),a=new FormData;a.append("file",r,"anexo.docx"),a.append("cartorio_token",C("user-data").value.cartorio_token),a.append("token",g.ato_token),a.append("tipo","ato_minuta");const{data:d,status:m}=await h(I,{method:"POST",body:a},"$071xxdqs20");if(m.value==="success"){b.success("Documento enviado!");const p=A.value.ej2Instances.documentEditor.pageCount;j(),E("page",p)}else b.error("Erro ao enviar documento para o sistema.")}catch(u){b.error("Erro ao salvar documento."),console.error(u)}finally{P.value=!1}},v=async()=>{D(!0);try{await q(),D(!0);const{data:u,status:r}=await h(B,{method:"POST",body:{ato_token:g.ato_token}},"$0ktpWliD4l");u.value&&w(u.value)}catch(u){console.error("Erro ao gerar a minuta:",u),b.error("Ocorreu um erro ao gerar a minuta.")}finally{D(!1)}},q=async()=>{try{const{data:u}=await h(W,{method:"POST",body:{bucket:C("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$jXVvQjEE6u"),r=await x(u.value);if(r){const a=new FileReader;a.onload=()=>{const d=a.result;A.value.ej2Instances.documentEditor.open(d),E("doc",d)},a.readAsText(r)}}catch(u){console.error("Erro ao carregar o modelo de minuta:",u),b.error("Falha ao carregar o modelo de minuta.")}},w=u=>{const r=A.value.ej2Instances.documentEditor,a=d=>{for(const[m,l]of Object.entries(d))if(/^<<.+>>$/.test(m))try{r.search.findAll(m),r.search.searchResults.length>0&&r.search.searchResults.replaceAll(l)}catch(p){console.error(`Erro ao substituir o marcador ${m}:`,p)}else if(m==="partes"&&Array.isArray(l)&&l.length>0)for(const p of l)typeof p=="object"&&a(p)};a(u)},D=u=>{P.value=u},M=()=>{const u=k.query.origem||"criar",r=k.query.id;u==="atualizar"?V.push(`/os/atualizar/${r}`):V.push("/os/criar-registro")};return(u,r)=>{const a=oe;return S(),N(be,null,[e(t(ke),{height:"900px",ref_key:"documentEditorContainer",ref:A,serviceUrl:nt,enableToolbar:!0,enableWordExport:!0},null,512),t(P)?(S(),N("div",rt,[e(Me,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):ve("",!0),e(F,{class:"ml-4 mt-4 mb-4"},{default:o(()=>[e(a,{class:"mr-4"},{default:o(()=>[e(J,{size:"large",onClick:M,color:"red"},{default:o(()=>r[0]||(r[0]=[U("Voltar")])),_:1})]),_:1}),e(J,{size:"large",color:"green",onClick:$,disabled:t(P)},{default:o(()=>r[1]||(r[1]=[U("Salvar")])),_:1},8,["disabled"]),e(J,{class:"ml-4",size:"large",color:"blue",onClick:v},{default:o(()=>r[2]||(r[2]=[U("Gerar Minuta")])),_:1})]),_:1})],64)}}},lt=["innerHTML"],Bt={__name:"Livro",props:{ato_token:{type:String,required:!0},pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(L){let y,g;const _=L,b=Q();xe(`${b.public.docEditor}`);const{$toast:V}=H(),k=Y(),E=Z(),I=`${b.public.managemant}/listarEscrevente`,B=`${b.public.managemant}/lavrarAto`,W=`${b.public.managemant}/ato_calcular`,A=i("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),P=i(!1),x=i(null),j=i(null),$=i(null),v=i(C("user-data").value.cartorio_token),q=C("auth_token").value,w=i([]),D=i({}),M=ae({escrevente:null}),u=async()=>{const{data:O,status:s}=await h(B,{method:"POST",body:{ato_token:_.ato_token,qtd_paginas:_.pages,escrevente_token:M.escrevente,usuario_token:q,cartorio_token:v}},"$ZKnVBNYxp9");if(s.value==="success"){if(O.value[0].tipo_etiqueta==="html")x.value=O.value,j.value=O.value[0].selo;else if(O.value[0].tipo_etiqueta==="zpl"){const{status:G}=await h(`${imprimeZplSelo}`,{method:"POST",body:{zpl:`^XA
^CF0,40
^FO50,30^FDCartório 360^FS
^CF0,30
^FO50,80^FDDocumento: 123456^FS
^FO50,120^FDData: 21/06/2025^FS
^FO50,160^FDAssinatura:___________________^FS
^FO50,210^GB700,3,3^FS
^CF0,25
^FO50,230^FDEste documento foi autenticado eletronicamente.^FS
^XZ`}},"$XouuxOFIWh");if(G.value!=="success"){V.error("Não foi possivel fazer a impressao da etiqueta");return}}V.success("Ato lavrado com sucesso!")}else V.error("Falha ao lavrar o ato.")},r=async()=>{const{data:O,status:s}=await h(W,{method:"POST",body:{ato_token:_.ato_token,cartorio_token:v.value,quantidade:1,usuario_token:q,escrevente_token:M.escrevente,qtd_paginas:_.pages}},"$R51FaaSzOI");s.value==="success"?D.value=O.value[0]:V.error("Falha ao calcular o ato.")},a=async()=>{P.value=!1,await u()},d=async()=>{P.value=!0,await r()},{data:m}=([y,g]=te(()=>h(I,{method:"POST",body:{cartorio_token:v}},"$JCPnpnnRzP")),y=await y,g(),y);w.value=m.value[0].func_json_escreventes;const l=function(){$.value.ej2Instances.documentEditor.open(_.document)},p=()=>{const O=E.query.origem||"criar",s=E.query.id;O==="atualizar"?k.push(`/os/atualizar/${s}`):k.push("/os/criar-registro")};return(O,s)=>{const G=Ye;return S(),N(be,null,[e(F,null,{default:o(()=>[e(R,null,{default:o(()=>[(S(),K(t(ke),{restrictEditing:!0,enableToolbar:!1,created:_.document?l:null,ref_key:"documentEditorContainer",ref:$,height:"850px",width:"850px",key:_.document},null,8,["created"]))]),_:1}),e(R,null,{default:o(()=>[e(re,{class:"mt-15",label:"Tabelião/escrevente",modelValue:t(M).escrevente,"onUpdate:modelValue":s[0]||(s[0]=ee=>t(M).escrevente=ee),items:t(w),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),f("div",null,[f("div",null,[f("img",{onClick:s[1]||(s[1]=ee=>d()),class:"ml-2",style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Le}),t(x)?(S(),K(Ze,{key:0,class:"mr-16"},{default:o(()=>[e(F,{"no-gutters":""},{default:o(()=>[e(R,null,{default:o(()=>[e(he,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:o(()=>[e(R,null,{default:o(()=>[U(" Livro: "+se(t(x)[0].livro_numero),1)]),_:1}),e(R,null,{default:o(()=>[U(" Protocolo: "+se(t(x)[0].protocolo?t(x)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),e(R,null,{default:o(()=>[e(he,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:o(()=>[U(" Folhas : "+se(t(x)[0].pagina_inicial)+" A "+se(t(x)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),f("div",{innerHTML:t(j)},null,8,lt)]),_:1})):ve("",!0)])])]),_:1})]),_:1}),e(J,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:p},{default:o(()=>s[3]||(s[3]=[U("Voltar")])),_:1}),e(G,{show:t(P),condMessage:t(A),valor:t(D),onClose:s[2]||(s[2]=ee=>P.value=!1),onConfirm:a},null,8,["show","condMessage","valor"])],64)}}},it=["onClick"],ut={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},ct={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Nt={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(L){let y,g;const _=L,b=Y(),V=Z(),k=Q(),{$toast:E}=H(),I=`${k.public.managemant}/listarEscrevente`,B=`${k.public.managemant}/getAtosTiposByToken`,W=`${k.public.managemant}/atos_observacao`,A=`${k.public.managemant}/atos_observacao`,P=i(C("user-data").value.cartorio_token),x=i([]),j=i([]),$=[{title:"Data",align:"start",key:"data"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],v=ae({observacao:null}),q={observacao:{required:me.withMessage("O campo é obrigatorio",pe)}},w=_e(q,v);[y,g]=te(()=>h(`${B}/${_.ato_token}`,{method:"GET"},"$aJM1TL1buW")),y=await y,g();async function D(){if(await w.value.$validate()){const{data:a,error:d,status:m}=await h(W,{method:"POST",body:{ato_id:_.ato_id,observacao:v.observacao,user_id:C("user-data").value.usuario_id}},"$dMg99jeUNP");m.value==="success"&&(x.value.push({data:He(a.value.created,"dd/mm/yyyy hh:mm"),observacao:a.value.observacao,id:a.value.id,escrevente:C("user-data").value.nome}),E.success("Observação registrada com sucesso"))}else E.error("Preencha os campos obrigatorios.")}async function M(a){a.excluido=!a.excluido;try{await h(`${A}/${a.id}`,{method:"PUT",body:JSON.stringify({excluido:a.excluido})},"$B6PdRx8Gp4")}catch(d){console.error("Erro ao excluir observacao:",d)}}const{data:u}=([y,g]=te(()=>h(I,{method:"POST",body:{cartorio_token:P}},"$xFHPGua26S")),y=await y,g(),y);j.value=u.value[0].func_json_escreventes;const r=()=>{const a=V.query.origem||"criar",d=V.query.id;a==="atualizar"?b.push(`/os/atualizar/${d}`):b.push("/os/criar-registro")};return(a,d)=>{const m=oe;return S(),K(le,null,{default:o(()=>[e(F,{class:"mt-5"},{default:o(()=>[e(X,{label:"Observação",modelValue:t(v).observacao,"onUpdate:modelValue":d[0]||(d[0]=l=>t(v).observacao=l),required:"","error-messages":t(w).observacao.$errors.map(l=>l.$message),onBlur:t(w).observacao.$touch,onInput:t(w).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),f("div",null,[f("img",{class:"btn-pointer ml-2",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:D})])]),_:1}),e(F,null,{default:o(()=>[e(R,null,{default:o(()=>[e(ye,{style:{height:"465px"},headers:$,items:t(x)},{"item.actions":o(({item:l})=>[f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:p=>M(l),title:"Deletar Observação"},[l.excluido?(S(),N("img",ut)):(S(),N("img",ct))],8,it)]),_:1},8,["items"])]),_:1})]),_:1}),e(F,null,{default:o(()=>[e(m,{onClick:r},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>d[1]||(d[1]=[U("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},dt={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:We,alt:"Criar"},mt={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ge,alt:"Criar"},pt={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Je,alt:"Criar"},_t=["onClick"],vt=["onClick"],ft=["onClick"],gt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},yt={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ut={__name:"Anexos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},setup(L){const y=L,g=Q(),{$toast:_}=H(),b=Y(),V=Z(),k=`${g.public.biometria}/run-scanner`,E=`${g.public.managemant}/atos_anexos`,I=`${g.public.managemant}/atos_anexos`,B=`${g.public.managemant}/download`;`${g.public.managemant}`,`${g.public.managemant}`;const W=i(!1),A=i(null),P=i([]);C("pessoa_token");const x=ae({descricao:"",fileEvent:null}),j={descricao:{required:me.withMessage("O campo é obrigatório",pe)}},$=_e(j,x,{$autoDirty:!0}),v=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}];async function q(){try{await w(),await D()}catch(l){console.error("Erro ao executar scanner ou listar arquivos:",l)}}async function w(){try{const{data:l}=await h(k,{method:"GET"},"$WazoKp68Tw")}catch(l){_.error("Erro ao acionar o scanner:",l)}}async function D(){try{const{data:l,status:p}=await h("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:V.query.ato_token_edit,cartorio_token:C("user-data").value.cartorio_token}},"$03Wxiia3aI")}catch(l){console.error("Erro ao enviar o arquivo:",l)}}const M=async()=>{W.value=!0};function u(l){return l?!0:(console.error("Erro: Nenhum arquivo foi selecionado!"),A.value=!1,!1)}const r=async()=>{if($.value.$touch(),!$.value.$invalid&&u(x.fileEvent)){const{data:l,error:p,status:O}=await h(E,{method:"POST",body:{ato_id:y.ato_id,descricao:x.descricao,user_id:C("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$WyW0hasRPI");O.value==="success"&&(_.success("Anexo registrado com sucesso!"),P.value.push(l.value))}};async function a(l){l.excluido=!l.excluido;try{await h(`${I}/${l.id}`,{method:"PUT",body:JSON.stringify({excluido:l.excluido})},"$Y3y6TjqbSV")}catch(p){console.error("Erro ao excluir pessoa:",p)}}async function d(l){try{const p=await h(`${B}`,{method:"POST",body:{bucket:C("user-data").value.cartorio_token,path:l.link}},"$bkXJSi7s76"),s=await(await fetch(p.data.value)).blob(),G=URL.createObjectURL(s);window.open(G,"_blank")}catch(p){console.error("Erro ao excluir pessoa:",p)}}const m=()=>{const l=V.query.origem||"criar",p=V.query.id;l==="atualizar"?b.push(`/os/atualizar/${p}`):b.push("/os/criar-registro")};return(l,p)=>{const O=oe;return S(),K(le,null,{default:o(()=>[e(F,null,{default:o(()=>[e(R,{cols:"5",class:"mt-2"},{default:o(()=>[e(X,{modelValue:t(x).descricao,"onUpdate:modelValue":[p[0]||(p[0]=s=>t(x).descricao=s),t($).descricao.$touch],"error-messages":t($).descricao.$errors.map(s=>s.$message),onBlur:t($).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"])]),_:1}),f("div",{onClick:q,title:"Criar",style:{"padding-right":"10px"}},[t(A)===!1?(S(),N("img",dt)):t(A)===!0?(S(),N("img",mt)):(S(),N("img",pt))]),f("div",{onClick:r,title:"Criar"},p[1]||(p[1]=[f("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:ne,alt:"Escanear"},null,-1)]))]),_:1}),e(ye,{headers:v,items:t(P),style:{height:"465px","max-width":"600px"}},{"item.actions":o(({item:s})=>[e(F,null,{default:o(()=>[f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:G=>M(s),title:"Visualizar Anexo"},[f("img",{style:{width:"30px",height:"30px"},onClick:G=>d(s),src:de,alt:"Visualizar"},null,8,vt)],8,_t),f("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:G=>a(s),title:"Deletar Pessoa"},[s.excluido?(S(),N("img",gt)):(S(),N("img",yt))],8,ft)]),_:2},1024)]),_:1},8,["items"]),e(O,{onClick:m},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>p[2]||(p[2]=[U("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Rt as _,It as a,jt as b,Bt as c,Nt as d,Ut as e};
