import{_ as pe}from"./D5rc64ea.js";import{u as ne,m as le,M as ie,r as n,p as fe,o as m,y as U,w as o,b as t,x as e,V as re,G as ae,d as X,z as L,A as ce,n as F,I as je,E as me,a as $,c as P,O as Ne,q as Ie,P as Je,F as Ve,g as Le,Q as ze,t as ve}from"./CePgPPUp.js";import{u as v}from"./CQvyG1hN.js";import{V as j}from"./Ds29TH1O.js";import{V as J}from"./Dr5V9hRV.js";import{V as ye}from"./CbscXxhn.js";import{V as ge}from"./BG8n_ZWm.js";import{_ as Ue}from"./t0w1RaJB.js";import{_ as Be,a as Ye,b as We,T as Ze,W as Qe,S as Xe,D as Ee,c as Ge,d as He,e as Ke,f as ea}from"./DPgpRXiG.js";import{_ as aa,r as Se}from"./qmOgG8xN.js";import{_ as Ae}from"./DfHalZRj.js";import{_ as _e}from"./BVz1G1IN.js";import{_ as ta}from"./DGpMiMnN.js";import{_ as oa}from"./CnTtVMkJ.js";import{_ as xe,a as we}from"./DJvq3mCv.js";import{V as Ce}from"./D3BZSHvI.js";import{_ as Te}from"./CMi78ao4.js";import{V as sa}from"./zcsBC5zH.js";import{c as De,r as Me,u as Oe}from"./CoMTGXYs.js";import{f as he}from"./B0IxRygJ.js";const Qa={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(oe){const f=oe,{$toast:x}=ne(),A=ce(),i=le(),u=ie(),g=`${A.public.managemant}/updateAtos`,z=n(f.item_situacoes),G=n(u.query.origem==="vizualizar"),T=fe({dt_abertura:f.item_dados[0].dt_abertura||null,status:f.item_dados[0].status||null,mne:f.item_dados[0].mne||null});async function H(){const{data:N,error:y,status:M}=await v(`${g}/${u.query.ato_id}`,{method:"PUT",body:{status:T.status,mne:T.mne,dt_abertura:T.dt_abertura}},"$EIT5jtTUdX");M.value==="success"&&x.success("Ato Atualizado com sucesso")}const D=()=>{const N=u.query.origem||"criar",y=u.query.id;switch(N){case"atualizar":case"vizualizar":i.push(`/os/atualizar/${y}`);break;case"atualizar-lista":case"vizualizar-lista":i.push("/atos/lista");break;default:i.push("/os/criar-registro");break}};return(N,y)=>{const M=pe;return m(),U(ge,null,{default:o(()=>[t(j,{class:"mt-5"},{default:o(()=>[t(J,{cols:"3"},{default:o(()=>[t(ye,{label:"Situação",modelValue:e(T).status,"onUpdate:modelValue":y[0]||(y[0]=_=>e(T).status=_),items:e(z),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),t(j,null,{default:o(()=>[t(J,{cols:"5"},{default:o(()=>[t(re,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:e(T).mne,"onUpdate:modelValue":y[1]||(y[1]=_=>e(T).mne=_)},null,8,["modelValue"])]),_:1})]),_:1}),t(j,null,{default:o(()=>[t(J,{cols:"2"},{default:o(()=>[t(re,{modelValue:e(T).dt_abertura,"onUpdate:modelValue":y[2]||(y[2]=_=>e(T).dt_abertura=_),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),t(j,{class:"mb-3"},{default:o(()=>[t(M,{onClick:D},{default:o(()=>[t(ae,{size:"large",color:"red"},{default:o(()=>y[3]||(y[3]=[X("Voltar")])),_:1})]),_:1}),e(G)?L("",!0):(m(),U(ae,{key:0,class:"ml-10",onClick:H,size:"large",color:"green"},{default:o(()=>y[4]||(y[4]=[X("Atualizar")])),_:1}))]),_:1})]),_:1})}}},ra={key:0},na=["onClick"],la={key:0,style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar"},ia={key:1,style:{width:"30px",height:"30px"},src:ta,alt:"Visualizar"},ca=["onClick"],ua=["onClick"],da={key:0,style:{width:"30px",height:"30px"},src:xe,alt:"Visualizar",title:"Reativar"},ma={key:1,src:we,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},pa=["onClick"],Xa={__name:"Partes",async setup(oe){let f,x;const A=le(),i=ie(),u=ce(),{$toast:g}=ne(),z=`${u.public.managemant}/pesquisarPessoas`,G=`${u.public.managemant}/listarPapeis`,T=`${u.public.managemant}/createAtosPessoa`,H=`${u.public.managemant}/updateAtosPessoa`,D=`${u.public.managemant}/getAtosPessoaById`,N=`${u.public.managemant}/download`,y=n(F("user-data").value.cartorio_token),M=n(i.query.origem==="vizualizar"),_=n([]),w=n({}),k=n([]),I=n([]),C=n(!1),B=n(!1),Y=n(!1),Q=n(!1),W=n(null),h=n(null),V=n(null),Z=n(null),r=n(null),l=n(i.query.tipo_ato_token),b=n(null),q=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],c=fe({papeis:null,nome:null,pessoa:null,documento:null});je(()=>{var p;return((p=c.pessoa)==null?void 0:p.link_ficha)||!1});const{data:R}=([f,x]=me(()=>v(G,{method:"POST",body:{tipo_ato_token:i.query.tipo_ato_token}},"$acoiTIUp00")),f=await f,x(),f);I.value=R.value;const a=async()=>{const{data:p}=await v(`${D}/${i.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),K=(de=>de.map(te=>({...te,pessoa:{...te.pessoa,documento:te.pessoa.doc_identificacao},papel:{...te.partes_tipos}})))(p.value);k.value=K};a();async function s(){try{const{data:p,error:d}=await v(z,{method:"POST",body:{cartorio_token:y.value,documento:c.documento,nome:c.nome}},"$pr30MyPXfY");p.value.length>0?(_.value=p.value,c.pessoa=_.value[0]):_.value=[]}catch(p){console.error("Erro na requisição",p)}}const E=()=>{B.value=!0},S=async()=>{await a()},ee=async()=>{await a()},ue=async()=>{const p={pessoa:c.pessoa,papel:I.value.find(se=>se.id===c.papeis),representante:{nome:null}},d=await v(`${D}/${i.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const se of d.data.value)if(se.pessoa_id===c.pessoa.id&&se.ato_id===Number(i.query.ato_id)&&se.tipo_parte_id===c.papeis){g.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:K,error:de,status:te}=await v(T,{method:"POST",body:{ato_id:Number(i.query.ato_id),pessoa_id:c.pessoa.id,tipo_parte_id:c.papeis,user_id:F("user-data").value.usuario_id}},"$18isAgOJxG");te.value==="success"?(p.id=K.value.id,g.success("Pessoa Registrada com Sucesso!"),k.value.push(p)):g.error(de.value.message)},ke=async p=>{Y.value=!0;const{data:d}=await v(N,{method:"POST",body:{bucket:F("user-data").value.cartorio_token,path:p.pessoa.link_ficha}},"$hmDzSF3F61");b.value=d.value,w.value=p.pessoa},$e=p=>{const d=k.value.filter(K=>K.pessoa.id!==p.pessoa.id).map(K=>({id:K.pessoa.id,nome:K.pessoa.nome}));V.value=p.id,W.value=d,C.value=!0,h.value=p.pessoa.nome,r.value=p.pessoa.id},Pe=p=>{Q.value=!0,Z.value=p.id,h.value=p.pessoa.nome};async function qe(p){p.excluido=!p.excluido;try{await v(`${H}/${p.id}`,{method:"PUT",body:JSON.stringify({excluido:p.excluido})},"$l09I6nLRfk")}catch(d){console.error("Erro ao excluir pessoa:",d)}}const Re=()=>{const p=i.query.origem||"criar",d=i.query.id;switch(p){case"atualizar":case"vizualizar":A.push(`/os/atualizar/${d}`);break;case"atualizar-lista":case"vizualizar-lista":A.push("/atos/lista");break;default:A.push("/os/criar-registro");break}};return(p,d)=>{const K=Ue,de=Ye,te=We,se=aa,Fe=pe;return m(),U(ge,null,{default:o(()=>[e(M)?L("",!0):(m(),U(j,{key:0,class:"mt-5"},{default:o(()=>[t(J,{cols:"3"},{default:o(()=>[t(re,{label:"Documento",modelValue:e(c).documento,"onUpdate:modelValue":d[0]||(d[0]=O=>e(c).documento=O)},null,8,["modelValue"])]),_:1}),t(J,{cols:"4"},{default:o(()=>[t(re,{label:"Pessoa",modelValue:e(c).nome,"onUpdate:modelValue":d[1]||(d[1]=O=>e(c).nome=O)},null,8,["modelValue"])]),_:1}),$("div",null,[$("img",{class:"mt-1",src:Ae,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:s})]),$("div",null,[$("img",{class:"mt-1 ml-2",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:E})])]),_:1})),e(M)?L("",!0):(m(),U(j,{key:1},{default:o(()=>[t(J,{cols:"4"},{default:o(()=>[t(ye,{label:"Selecione a Pessoa",modelValue:e(c).pessoa,"onUpdate:modelValue":d[2]||(d[2]=O=>e(c).pessoa=O),items:e(_),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),t(J,{cols:"3"},{default:o(()=>[t(ye,{label:"Papel",modelValue:e(c).papeis,"onUpdate:modelValue":d[3]||(d[3]=O=>e(c).papeis=O),items:e(I),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(M)?L("",!0):(m(),P("div",ra,[$("img",{class:"mt-1",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:ue})]))]),_:1})),t(j,null,{default:o(()=>[t(J,null,{default:o(()=>[t(Ce,{style:{height:"465px"},headers:q,items:e(k)},{"item.actions":o(({item:O})=>[e(M)?L("",!0):(m(),U(j,{key:0},{default:o(()=>[$("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-1",onClick:be=>ke(O),title:"Visualizar Ficha"},[O.pessoa.link_ficha?(m(),P("img",la)):(m(),P("img",ia))],8,na),$("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:be=>Pe(O),class:"mr-1",title:"Alterar Papel"},d[8]||(d[8]=[$("img",{style:{width:"30px",height:"30px"},src:oa,alt:"Visualizar"},null,-1)]),8,ca),$("div",{class:"mr-1",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:be=>qe(O),title:"Deletar Pessoa"},[O.excluido?(m(),P("img",da)):(m(),P("img",ma))],8,ua),$("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-1",onClick:be=>$e(O),title:"Selecionar Representante"},d[9]||(d[9]=[$("img",{style:{width:"30px",height:"30px"},src:Be,alt:"Visualizar"},null,-1)]),8,pa)]),_:2},1024))]),_:1},8,["items"])]),_:1})]),_:1}),t(K,{show:e(B),onClose:d[4]||(d[4]=O=>B.value=!1)},null,8,["show"]),t(de,{representante_nome:e(h),representantes:e(W),ato_id:e(V),show:e(C),onClose:d[5]||(d[5]=O=>C.value=!1),onUpdateRepresentante:ee},null,8,["representante_nome","representantes","ato_id","show"]),t(te,{representante_nome:e(h),ato_token:e(l),ato_id:e(Z),show:e(Q),onClose:d[6]||(d[6]=O=>Q.value=!1),onUpdatePapel:S},null,8,["representante_nome","ato_token","ato_id","show"]),e(Y)?(m(),U(se,{key:2,show:e(Y),"link-view":e(b),"pessoa-obj":e(w),"is-view":!0,onClose:d[7]||(d[7]=O=>Y.value=!1)},null,8,["show","link-view","pessoa-obj"])):L("",!0),t(j,null,{default:o(()=>[t(Fe,{onClick:Re},{default:o(()=>[t(ae,{size:"large",color:"red"},{default:o(()=>d[10]||(d[10]=[X("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},fa={key:0,class:"loading-overlay"},va="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Ga={__name:"Minuta",emits:["page","doc"],setup(oe,{emit:f}){Ne("DocumentEditorContainer",[Ze,Qe,Xe]);const x=ce(),{$toast:A}=ne(),i=le(),u=ie(),g=f;Se(`${x.public.docEditor}`);const z=`${x.public.managemant}/download`,G=`${x.public.managemant}/atos/files`,T=`${x.public.managemant}/subitituirModelo`,H=`${x.public.managemant}/upload`,D=n(null),N=n(!1),y=n("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),M=n(u.query.origem==="vizualizar"),_=n(!1),w=async r=>{try{const l=await fetch(r);if(!l.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await l.blob()}catch(l){return console.error(l),null}},k=async()=>{try{const{data:r}=await v(`${G}/${u.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return r.value.link_ato}catch(r){console.error("Erro ao carregar o documento:",r),A.error(r)}},I=async()=>{_.value=!0;try{const r=await k(),{data:l,status:b}=await v(z,{method:"POST",body:{bucket:F("user-data").value.cartorio_token,path:r}},"$dvNFfvmIJC"),q=l.value,c=await w(q);if(c){const R=new FileReader;R.onload=()=>{const a=R.result;D.value.ej2Instances.documentEditor.open(a),g("doc",a)},R.readAsText(c)}}catch{console.error("Erro ao carregar o documento.")}finally{_.value=!1}},C=async()=>{const l=await D.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),b=new FileReader;b.onload=()=>{const q=b.result,R=D.value.ej2Instances.documentEditor.pageCount;g("page",R),g("doc",q)},b.readAsText(l)},B=async()=>{_.value=!0;try{const l=await D.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),b=new FormData;b.append("file",l,"anexo.sfdt"),b.append("cartorio_token",F("user-data").value.cartorio_token),b.append("token",u.query.ato_token_edit),b.append("tipo","ato_minuta");const{data:q,status:c}=await v(H,{method:"POST",body:b},"$xv11VtUdMy");if(c.value==="success"){A.success("Documento enviado!");const a=D.value.ej2Instances.documentEditor.pageCount;C(),g("page",a)}else A.error("Erro ao enviar documento para o sistema.")}catch(r){A.error("Erro ao salvar documento."),console.error(r)}finally{_.value=!1}},Y=()=>{N.value=!1,Q()},Q=async()=>{V(!0);try{await W(),V(!0);const{data:r,status:l}=await v(T,{method:"POST",body:{ato_token:u.query.ato_token_edit}},"$zyzWHTXTBW");r.value&&h(r.value)}catch(r){console.error("Erro ao gerar a minuta:",r),A.error("Ocorreu um erro ao gerar a minuta.")}finally{V(!1)}},W=async()=>{try{const{data:r}=await v(z,{method:"POST",body:{bucket:F("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),l=await w(r.value);if(l){const b=new FileReader;b.onload=()=>{const q=b.result;D.value.ej2Instances.documentEditor.open(q),g("doc",q)},b.readAsText(l)}}catch(r){console.error("Erro ao carregar o modelo de minuta:",r)}},h=r=>{const l=D.value.ej2Instances.documentEditor,b=q=>{for(const[c,R]of Object.entries(q))if(/^<<.+>>$/.test(c))try{l.search.findAll(c),l.search.searchResults.length>0&&l.search.searchResults.replaceAll(R)}catch(a){console.error(`Erro ao substituir o marcador ${c}:`,a)}else if(c==="partes"&&Array.isArray(R)&&R.length>0)for(const a of R)typeof a=="object"&&b(a)};b(r)},V=r=>{_.value=r},Z=()=>{const r=u.query.origem||"criar",l=u.query.id;switch(r){case"atualizar":case"vizualizar":i.push(`/os/atualizar/${l}`);break;case"atualizar-lista":case"vizualizar-lista":i.push("/atos/lista");break;default:i.push("/os/criar-registro");break}};return Ie(async()=>{await I(),C()}),(r,l)=>{const b=pe,q=Te;return m(),P(Ve,null,[t(e(Ee),{height:"900px",ref_key:"documentEditorContainer",ref:D,serviceUrl:va,enableToolbar:!0,enableWordExport:!0},null,512),e(_)?(m(),P("div",fa,[t(Je,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):L("",!0),t(j,{class:"ml-4 mt-4 mb-4"},{default:o(()=>[t(b,{class:"mr-4"},{default:o(()=>[t(ae,{size:"large",onClick:Z,color:"red"},{default:o(()=>l[2]||(l[2]=[X("Voltar")])),_:1})]),_:1}),e(M)?L("",!0):(m(),U(ae,{key:0,size:"large",color:"green",onClick:B,disabled:e(_)},{default:o(()=>l[3]||(l[3]=[X("Atualizar")])),_:1},8,["disabled"])),e(M)?L("",!0):(m(),U(ae,{key:1,class:"ml-4",size:"large",color:"blue",onClick:l[0]||(l[0]=c=>N.value=!0)},{default:o(()=>l[4]||(l[4]=[X("Gerar Minuta")])),_:1}))]),_:1}),t(q,{onConfirm:Y,condMessage:e(y),show:e(N),onClose:l[1]||(l[1]=c=>N.value=!1)},null,8,["condMessage","show"])],64)}}},ya=["innerHTML"],Ha={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(oe){let f,x;const A=oe,i=ce();Se(`${i.public.docEditor}`);const{$toast:u}=ne(),g=le(),z=ie(),G=`${i.public.managemant}/download`,T=`${i.public.managemant}/atos/files`,H=`${i.public.managemant}/lavrarAto`,D=`${i.public.managemant}/listarEscrevente`,N=`${i.public.managemant}/ato_calcular`,y=n(F("user-data").value.cartorio_token),M=F("auth_token").value,_=n("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),w=n(!1),k=n(null),I=n(null),C=n(z.query.origem==="vizualizar"),B=n(null),Y=n([]),Q=n({}),W=fe({escrevente:null}),h=async a=>{try{const s=await fetch(a);if(!s.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await s.blob()}catch(s){return console.error(s),null}},V=async()=>{try{const{data:a}=await v(`${T}/${z.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return a.value.link_ato}catch(a){console.error("Erro ao carregar o documento:",a),u.error(a)}},Z=async()=>{try{const a=await V(),{data:s,status:E}=await v(G,{method:"POST",body:{bucket:F("user-data").value.cartorio_token,path:a}},"$7ljqltMqa0"),S=s.value,ee=await h(S);if(ee){const ue=new FileReader;ue.onload=()=>{const ke=ue.result;B.value.ej2Instances.documentEditor.open(ke)},ue.readAsText(ee)}}catch{u.error("Erro ao carregar o documento.")}};Z();const r=async()=>{const a=B.value.ej2Instances.documentEditor.pageCount;try{const{data:s,status:E}=await v(H,{method:"POST",body:{ato_token:z.query.ato_token_edit,qtd_paginas:a,escrevente_token:W.escrevente,usuario_token:M,cartorio_token:y}},"$OWxZSQkyX8");E.value==="success"?(k.value=s.value,I.value=s.value[0].selo,u.success("Ato lavrado com sucesso!")):u.error("Falha ao lavrar o ato.")}catch{u.error("Erro ao conectar com o servidor.")}},l=async()=>{const a=B.value.ej2Instances.documentEditor.pageCount,{data:s,status:E}=await v(N,{method:"POST",body:{ato_token:z.query.ato_token_edit,cartorio_token:y,quantidade:1,usuario_token:M,escrevente_token:W.escrevente,qtd_paginas:a}},"$sMqfUUQcBM");E.value==="success"?Q.value=s.value[0]:u.error("Falha ao calcular o ato.")},b=async()=>{w.value=!1,r()},q=async()=>{w.value=!0,await l()},{data:c}=([f,x]=me(()=>v(D,{method:"POST",body:{cartorio_token:y}},"$OVwiKSwcOE")),f=await f,x(),f);Y.value=c.value[0].func_json_escreventes;const R=()=>{const a=z.query.origem||"criar",s=z.query.id;switch(a){case"atualizar":case"vizualizar":g.push(`/os/atualizar/${s}`);break;case"atualizar-lista":case"vizualizar-lista":g.push("/atos/lista");break;default:g.push("/os/criar-registro");break}};return Le(()=>A.document,(a,s)=>{Z()}),(a,s)=>{const E=Te;return m(),P(Ve,null,[t(j,null,{default:o(()=>[t(J,null,{default:o(()=>[t(e(Ee),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:B,height:"850px",width:"850px"},null,512)]),_:1}),e(C)?L("",!0):(m(),U(J,{key:0},{default:o(()=>[t(ye,{class:"mt-15",label:"Tabelião/escrevente",modelValue:e(W).escrevente,"onUpdate:modelValue":s[0]||(s[0]=S=>e(W).escrevente=S),items:e(Y),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),$("img",{onClick:s[1]||(s[1]=S=>q()),style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Ge}),e(k)?(m(),U(sa,{key:0,width:"360"},{default:o(()=>[t(j,null,{default:o(()=>[t(J,null,{default:o(()=>[t(ze,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:o(()=>[t(J,null,{default:o(()=>[X(" Livro: "+ve(e(k)[0].livro_numero),1)]),_:1}),t(J,null,{default:o(()=>[X(" Protocolo: "+ve(e(k)[0].protocolo?e(k)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),t(J,null,{default:o(()=>[t(ze,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:o(()=>[X(" Folhas : "+ve(e(k)[0].pagina_inicial)+" A "+ve(e(k)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),$("div",{style:{"margin-left":"10px","padding-bottom":"20px","margin-top":"-10px"},innerHTML:e(I)},null,8,ya)]),_:1})):L("",!0)]),_:1}))]),_:1}),t(ae,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:R},{default:o(()=>s[3]||(s[3]=[X("Voltar")])),_:1}),t(E,{show:e(w),condMessage:e(_),valor:e(Q),onClose:s[2]||(s[2]=S=>w.value=!1),onConfirm:b},null,8,["show","condMessage","valor"])],64)}}},_a=["onClick"],ga={key:0,style:{width:"30px",height:"30px"},src:xe,alt:"Visualizar",title:"Reativar"},ka={key:1,src:we,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ka={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(oe){let f,x;const A=le(),i=ie(),u=ce(),{$toast:g}=ne(),z=`${u.public.managemant}/listarEscrevente`;`${u.public.managemant}`;const G=`${u.public.managemant}/atos_observacao`,T=`${u.public.managemant}/atos_observacao`,H=`${u.public.managemant}/atos_observacao`,D=n(F("user-data").value.cartorio_token),N=n(i.query.origem==="vizualizar"),y=n([]),M=n([]),_=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],w=fe({observacao:""}),k={observacao:{required:De.withMessage("O campo é obrigatório",Me)}},I=Oe(k,w),{data:C}=([f,x]=me(()=>v(`${H}/${i.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),f=await f,x(),f);Array.isArray(C.value)?y.value=C.value.map(h=>({...h,created:he(h.created,"dd/mm/yyyy hh:mm")})):C.value&&typeof C.value=="object"&&(y.value=[{...C.value,created:he(C.value.created,"dd/mm/yyyy hh:mm")}]);async function B(){if(w.observacao.trim()===""){g.error("O campo de observação está vazio.");return}if(await I.value.$validate()){const{data:h,error:V,status:Z}=await v(G,{method:"POST",body:{ato_id:Number(i.query.ato_id),observacao:w.observacao,user_id:F("user-data").value.usuario_id}},"$gnHMo4uCXD");Z.value==="success"&&(y.value.push({created:he(h.value.created,"dd/mm/yyyy hh:mm"),observacao:h.value.observacao,id:h.value.id,escrevente:F("user-data").value.nome}),w.observacao="",g.success("Observação registrada com sucesso"))}else g.error("Preencha os campos obrigatórios.")}async function Y(h){h.excluido=!h.excluido;try{await v(`${T}/${h.id}`,{method:"PUT",body:JSON.stringify({excluido:h.excluido})},"$sP9AKdd3Ky")}catch(V){console.error("Erro ao excluir observação:",V)}}const{data:Q}=([f,x]=me(()=>v(z,{method:"POST",body:{cartorio_token:D}},"$HL9pndqGh0")),f=await f,x(),f);M.value=Q.value[0].func_json_escreventes;const W=()=>{const h=i.query.origem||"criar",V=i.query.id;switch(h){case"atualizar":case"vizualizar":A.push(`/os/atualizar/${V}`);break;case"atualizar-lista":case"vizualizar-lista":A.push("/atos/lista");break;default:A.push("/os/criar-registro");break}};return(h,V)=>{const Z=pe;return m(),U(ge,null,{default:o(()=>[N.value?L("",!0):(m(),U(j,{key:0,class:"mt-5"},{default:o(()=>[t(re,{label:"Observação",modelValue:w.observacao,"onUpdate:modelValue":V[0]||(V[0]=r=>w.observacao=r),required:"","error-messages":e(I).observacao.$errors.length>0?e(I).observacao.$errors.map(r=>r.$message):[],onBlur:e(I).observacao.$touch,onInput:e(I).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),$("div",null,[$("img",{class:"btn-pointer ml-2",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:B})])]),_:1})),t(j,null,{default:o(()=>[t(J,null,{default:o(()=>[t(Ce,{style:{height:"465px"},headers:_,items:y.value},{"item.actions":o(({item:r})=>[$("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:l=>Y(r),title:"Deletar Observação"},[r.excluido?(m(),P("img",ga)):(m(),P("img",ka))],8,_a)]),_:1},8,["items"])]),_:1})]),_:1}),t(j,null,{default:o(()=>[t(Z,{onClick:W},{default:o(()=>[t(ae,{size:"large",color:"red"},{default:o(()=>V[1]||(V[1]=[X("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},ba="data:image/png;base64,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",ha={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ke,alt:"Criar"},Aa={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ea,alt:"Criar"},xa={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ba,alt:"Criar"},wa=["onClick"],Ca=["onClick"],$a=["onClick"],za={key:0,style:{width:"30px",height:"30px"},src:xe,alt:"Visualizar",title:"Reativar"},Va={key:1,src:we,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},et={__name:"Anexos",async setup(oe){let f,x;const A=ce(),{$toast:i}=ne(),u=le(),g=ie(),z=n(g.query.origem==="vizualizar"),G=`${A.public.biometria}/run-scanner`,T=`${A.public.managemant}/atos_anexos`,H=`${A.public.managemant}/atos_anexos`,D=`${A.public.managemant}/download`,N=`${A.public.managemant}/atos_anexos`,y=`${A.public.managemant}/upload`,M=n(!1),_=n(null),w=n([]);F("pessoa_token");const k=fe({descricao:"",fileEvent:null}),I={descricao:{required:De.withMessage("O campo é obrigatório",Me)}},C=Oe(I,k,{$autoDirty:!0}),B=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:Y}=([f,x]=me(()=>v(`${N}/${g.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),f=await f,x(),f);w.value=Y.value;async function Q(){try{await W(),await h()}catch(a){console.error("Erro ao executar scanner ou listar arquivos:",a)}}async function W(){try{const{data:a}=await v(G,{method:"GET"},"$KttjFhHivJ")}catch(a){i.error("Erro ao acionar o scanner:",a)}}async function h(){try{const{data:a,status:s}=await v("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:g.query.ato_token_edit,cartorio_token:F("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(a){console.error("Erro ao enviar o arquivo:",a)}}async function V(){try{const a=document.createElement("input");a.type="file",a.accept="*/*",a.onchange=async s=>{k.fileEvent=s,s.target.files[0]&&(_.value=!0)},a.click()}catch(a){console.error("Erro ao abrir o explorador de arquivos:",a)}}const Z=async()=>{M.value=!0};function r(a){return a?!0:(_.value=!1,!1)}const l=async a=>{if(!k.fileEvent||!k.fileEvent.target.files.length){i.error("Nenhum arquivo selecionado.");return}const s=k.fileEvent.target.files[0],E=new FormData;E.append("file",s),E.append("cartorio_token",F("user-data").value.cartorio_token),E.append("token",a),E.append("tipo","ato_anexo");try{const S=await v(y,{method:"POST",body:E},"$KDhIYzGKzM");i.success("Anexo registrado com sucesso!")}catch{i.error("Erro ao enviar o arquivo.")}},b=async()=>{if(C.value.$touch(),!C.value.$invalid&&r(k.fileEvent)){const{data:a,error:s,status:E}=await v(T,{method:"POST",body:{ato_id:g.query.ato_id,descricao:k.descricao,user_id:F("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$cdoFBGO0Ti");E.value==="success"&&(i.success("Anexo registrado com sucesso!"),w.value.push(a.value),l(a.value.token))}};async function q(a){a.excluido=!a.excluido;try{await v(`${H}/${a.id}`,{method:"PUT",body:JSON.stringify({excluido:a.excluido})},"$WLSrgYRoHq")}catch(s){console.error("Erro ao excluir pessoa:",s)}}async function c(a){try{const s=await v(`${D}`,{method:"POST",body:{bucket:F("user-data").value.cartorio_token,path:a.link}},"$NdgRjioizH"),S=await(await fetch(s.data.value)).blob(),ee=URL.createObjectURL(S);window.open(ee,"_blank")}catch(s){console.error("Erro ao excluir pessoa:",s)}}const R=()=>{const a=g.query.origem||"criar",s=g.query.id;switch(a){case"atualizar":case"vizualizar":u.push(`/os/atualizar/${s}`);break;case"atualizar-lista":case"vizualizar-lista":u.push("/atos/lista");break;default:u.push("/os/criar-registro");break}};return(a,s)=>{const E=pe;return m(),U(ge,null,{default:o(()=>[t(j,null,{default:o(()=>[t(J,{cols:"5",class:"mt-2"},{default:o(()=>[e(z)?L("",!0):(m(),U(re,{key:0,modelValue:e(k).descricao,"onUpdate:modelValue":[s[0]||(s[0]=S=>e(k).descricao=S),e(C).descricao.$touch],"error-messages":e(C).descricao.$errors.map(S=>S.$message),onBlur:e(C).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"]))]),_:1}),e(z)?L("",!0):(m(),P("div",{key:0,onClick:Q,title:"Escanear"},s[1]||(s[1]=[$("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:He,alt:"Escanear"},null,-1)]))),e(z)?L("",!0):(m(),P("div",{key:1,onClick:V,title:"Criar"},[e(_)===!1?(m(),P("img",ha)):e(_)===!0?(m(),P("img",Aa)):(m(),P("img",xa))])),e(z)?L("",!0):(m(),P("div",{key:2,onClick:b,title:"Criar"},s[2]||(s[2]=[$("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:_e,alt:"Criar"},null,-1)])))]),_:1}),t(Ce,{headers:B,items:e(w),style:{height:"465px","max-width":"600px"}},{"item.actions":o(({item:S})=>[t(j,null,{default:o(()=>[$("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ee=>Z(S),title:"Visualizar Anexo"},[$("img",{style:{width:"30px",height:"30px"},onClick:ee=>c(S),src:Ae,alt:"Visualizar"},null,8,Ca)],8,wa),$("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ee=>q(S),title:"Deletar Pessoa"},[S.excluido?(m(),P("img",za)):(m(),P("img",Va))],8,$a)]),_:2},1024)]),_:1},8,["items"]),t(E,{onClick:R},{default:o(()=>[t(ae,{size:"large",color:"red"},{default:o(()=>s[3]||(s[3]=[X("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Qa as _,Xa as a,Ga as b,Ha as c,Ka as d,et as e};
