import{_ as ue}from"./xX_v-sZz.js";import{u as ae,C as se,H as re,r as c,D as ce,o as j,G as ne,w as t,b as e,v as o,V as te,A as F,d as B,s as Z,m as G,I as ie,a as b,c as Q,x as le,L as Re,n as Ie,M as Fe,K as Ve,F as Ce,g as Ae,N as $e,t as _e}from"./BdPNHGLk.js";import{V as O,u as y}from"./CA5u19fk.js";import{V as I}from"./-yuwXDtq.js";import{V as oe}from"./B3pn1MKo.js";import{V as de}from"./CxpX6iyZ.js";import{_ as Be,a as Ne}from"./CRDnUAoe.js";import{_ as Le,a as Ge,b as He,T as Je,W as Ke,S as We,r as Ee,D as Pe,c as Xe,d as Qe}from"./z9CfXJug.js";import{_ as ye}from"./xQXuZDXb.js";import{_ as me,a as ge,b as be}from"./BP1uhy__.js";import{_ as Ye}from"./DCZlzlpK.js";import{V as he}from"./DRKVsOm3.js";import{V as xe,a as pe,d as Ze}from"./Clvho6vr.js";import{_ as Te}from"./CvFFxtLg.js";import{c as et,r as tt,u as ot}from"./DdymXg__.js";import{_ as we}from"./CdP3NN9a.js";const St={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(X){const _=X,{$toast:C}=ae(),h=Z(),m=se(),i=re(),x=`${h.public.managemant}/updateAtos`,q=c(_.item_situacoes),A=ce({dt_abertura:_.item_dados[0].dt_abertura||null,status:_.item_dados[0].status||null,mne:_.item_dados[0].mne||null});async function M(){const{data:k,error:d,status:z}=await y(`${x}/${i.query.ato_id}`,{method:"PUT",body:{status:A.status,mne:A.mne,dt_abertura:A.dt_abertura}},"$EIT5jtTUdX");z.value==="success"&&C.success("Ato Atualizado com sucesso")}const S=()=>{const k=i.query.origem||"criar",d=i.query.id;k==="atualizar"?m.push(`/os/atualizar/${d}`):m.push("/os/criar-registro")};return(k,d)=>{const z=ue;return j(),ne(de,null,{default:t(()=>[e(O,{class:"mt-5"},{default:t(()=>[e(I,{cols:"3"},{default:t(()=>[e(oe,{label:"Situação",modelValue:o(A).status,"onUpdate:modelValue":d[0]||(d[0]=w=>o(A).status=w),items:o(q),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(I,{cols:"5"},{default:t(()=>[e(te,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:o(A).mne,"onUpdate:modelValue":d[1]||(d[1]=w=>o(A).mne=w)},null,8,["modelValue"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(I,{cols:"2"},{default:t(()=>[e(te,{modelValue:o(A).dt_abertura,"onUpdate:modelValue":d[2]||(d[2]=w=>o(A).dt_abertura=w),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(O,{class:"mb-3"},{default:t(()=>[e(z,{onClick:S},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>d[3]||(d[3]=[B("Voltar")])),_:1})]),_:1}),e(F,{class:"ml-10",onClick:M,size:"large",color:"green"},{default:t(()=>d[4]||(d[4]=[B("Atualizar")])),_:1})]),_:1})]),_:1})}}},at=["onClick"],st=["onClick"],rt=["onClick"],nt={key:0,style:{width:"30px",height:"30px"},src:ge,alt:"Visualizar",title:"Reativar"},lt={key:1,src:be,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},it=["onClick"],Dt={__name:"Partes",async setup(X){let _,C;const h=se(),m=re(),i=Z(),{$toast:x}=ae(),q=`${i.public.managemant}/pesquisarPessoas`,A=`${i.public.managemant}/listarPapeis`,M=`${i.public.managemant}/getLinkTipo`,S=`${i.public.managemant}/createAtosPessoa`,k=`${i.public.managemant}/updateAtosPessoa`,d=`${i.public.managemant}/getAtosPessoaById`,z=`${i.public.managemant}/download`,w=c(G("user-data").value.cartorio_token),V=c([]),$=c([]),f=c([]),E=c(!1),N=c(!1),D=c(!1),H=c(!1),K=c(null),s=c(null),l=c(null),R=c(null),a=c(null),u=c(m.query.tipo_ato_token),r=c(null),p=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],v=ce({papeis:null,nome:null,pessoa:null,documento:null}),{data:P}=([_,C]=ie(()=>y(A,{method:"POST",body:{tipo_ato_token:m.query.tipo_ato_token}},"$acoiTIUp00")),_=await _,C(),_);f.value=P.value;const U=async()=>{const{data:g}=await y(`${d}/${m.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),L=(Y=>Y.map(J=>({...J,pessoa:{...J.pessoa,documento:J.pessoa.doc_identificacao},papel:{...J.partes_tipos}})))(g.value);$.value=L};U();async function ee(){try{const{data:g,error:n}=await y(q,{method:"POST",body:{cartorio_token:w.value,documento:v.documento,nome:v.nome}},"$pr30MyPXfY");g.value.length>0?(V.value=g.value,v.pessoa=V.value[0]):V.value=[]}catch(g){console.error("Erro na requisição",g)}}const ve=()=>{N.value=!0},ke=async()=>{await U()},qe=async()=>{await U()},Oe=async()=>{const g={pessoa:v.pessoa,papel:f.value.find(W=>W.id===v.papeis),representante:{nome:null}},n=await y(`${d}/${m.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const W of n.data.value)if(W.pessoa_id===v.pessoa.id&&W.ato_id===Number(m.query.ato_id)&&W.tipo_parte_id===v.papeis){x.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:L,error:Y,status:J}=await y(S,{method:"POST",body:{ato_id:Number(m.query.ato_id),pessoa_id:v.pessoa.id,tipo_parte_id:v.papeis,user_id:G("user-data").value.usuario_id}},"$18isAgOJxG");J.value==="success"?(g.id=L.value.id,x.success("Pessoa Registrada com Sucesso!"),$.value.push(g)):x.error(Y.value.message)},ze=async g=>{var W;if(D.value=!0,r.value=null,!g.pessoa.id)return;const{data:n}=await y(M,{method:"POST",body:{tipo:"ficha",id:g.pessoa.id}},"$hmDzSF3F61");if(!((W=n.value)!=null&&W.link))return;const{data:L}=await y(z,{method:"POST",body:{bucket:"qvgjz",path:n.value.link}},"$l09I6nLRfk"),Y=n.value.link,J=L.value;/\.(tr7|tiff)$/i.test(Y)?r.value=J:fotoRender.value=`data:image/jpeg;base64,${J}`},Me=g=>{const n=$.value.filter(L=>L.pessoa.id!==g.pessoa.id).map(L=>({id:L.pessoa.id,nome:L.pessoa.nome}));l.value=g.id,K.value=n,E.value=!0,s.value=g.pessoa.nome,a.value=g.pessoa.id},Se=g=>{H.value=!0,R.value=g.id,s.value=g.pessoa.nome};async function De(g){g.excluido=!g.excluido;try{await y(`${k}/${g.id}`,{method:"PUT",body:JSON.stringify({excluido:g.excluido})},"$PUt0nEhmBF")}catch(n){console.error("Erro ao excluir pessoa:",n)}}const Ue=()=>{const g=m.query.origem||"criar",n=m.query.id;g==="atualizar"?h.push(`/os/atualizar/${n}`):h.push("/os/criar-registro")};return(g,n)=>{const L=Be,Y=Ge,J=He,W=Ne,je=ue;return j(),ne(de,null,{default:t(()=>[e(O,{class:"mt-5"},{default:t(()=>[e(I,{cols:"3"},{default:t(()=>[e(te,{label:"Documento",modelValue:o(v).documento,"onUpdate:modelValue":n[0]||(n[0]=T=>o(v).documento=T)},null,8,["modelValue"])]),_:1}),e(I,{cols:"4"},{default:t(()=>[e(te,{label:"Pessoa",modelValue:o(v).nome,"onUpdate:modelValue":n[1]||(n[1]=T=>o(v).nome=T)},null,8,["modelValue"])]),_:1}),b("div",null,[b("img",{class:"mt-1",src:ye,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:ee})]),b("div",null,[b("img",{class:"mt-1 ml-2",src:me,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ve})])]),_:1}),e(O,null,{default:t(()=>[e(I,{cols:"4"},{default:t(()=>[e(oe,{label:"Selecione a Pessoa",modelValue:o(v).pessoa,"onUpdate:modelValue":n[2]||(n[2]=T=>o(v).pessoa=T),items:o(V),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(I,{cols:"3"},{default:t(()=>[e(oe,{label:"Papel",modelValue:o(v).papeis,"onUpdate:modelValue":n[3]||(n[3]=T=>o(v).papeis=T),items:o(f),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),b("div",null,[b("img",{class:"mt-1",src:me,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Oe})])]),_:1}),e(O,null,{default:t(()=>[e(I,null,{default:t(()=>[e(he,{style:{height:"465px"},headers:p,items:o($)},{"item.actions":t(({item:T})=>[e(O,null,{default:t(()=>[b("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:fe=>ze(T),title:"Visualizar Ficha"},n[9]||(n[9]=[b("img",{style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar"},null,-1)]),8,at),b("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:fe=>Se(T),class:"mr-2",title:"Alterar Papel"},n[10]||(n[10]=[b("img",{style:{width:"30px",height:"30px"},src:Ye,alt:"Visualizar"},null,-1)]),8,st),b("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:fe=>De(T),title:"Deletar Pessoa"},[T.excluido?(j(),Q("img",nt)):(j(),Q("img",lt))],8,rt),b("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:fe=>Me(T),title:"Selecionar Representante"},n[11]||(n[11]=[b("img",{style:{width:"30px",height:"30px"},src:Le,alt:"Visualizar"},null,-1)]),8,it)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(L,{show:o(N),onClose:n[4]||(n[4]=T=>N.value=!1)},null,8,["show"]),e(Y,{representante_nome:o(s),representantes:o(K),ato_id:o(l),show:o(E),onClose:n[5]||(n[5]=T=>E.value=!1),onUpdateRepresentante:qe},null,8,["representante_nome","representantes","ato_id","show"]),e(J,{representante_nome:o(s),ato_token:o(u),ato_id:o(R),show:o(H),onClose:n[6]||(n[6]=T=>H.value=!1),onUpdatePapel:ke},null,8,["representante_nome","ato_token","ato_id","show"]),e(xe,{modelValue:o(D),"onUpdate:modelValue":n[8]||(n[8]=T=>le(D)?D.value=T:null),width:"600"},{default:t(()=>[e(pe,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(W,{"tiff-url":o(r)},null,8,["tiff-url"]),e(F,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:n[7]||(n[7]=T=>D.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(O,null,{default:t(()=>[e(je,{onClick:Ue},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>n[12]||(n[12]=[B("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},ut={key:0,class:"loading-overlay"},ct="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Ut={__name:"Minuta",emits:["page","doc"],setup(X,{emit:_}){Re("DocumentEditorContainer",[Je,Ke,We]);const C=Z(),{$toast:h}=ae(),m=se(),i=re(),x=_;Ee(`${C.public.docEditor}`);const q=`${C.public.managemant}/download`,A=`${C.public.managemant}/atos/files`,M=`${C.public.managemant}/subitituirModelo`,S=`${C.public.managemant}/upload`,k=c(null),d=c(!1),z=c("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),w=c(!1),V=async a=>{try{const u=await fetch(a);if(!u.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await u.blob()}catch(u){return console.error(u),null}},$=async()=>{try{const{data:a}=await y(`${A}/${i.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return a.value.link_ato}catch(a){console.error("Erro ao carregar o documento:",a),h.error(a)}},f=async()=>{w.value=!0;try{const a=await $(),{data:u,status:r}=await y(q,{method:"POST",body:{bucket:"qvgjz",path:a}},"$dvNFfvmIJC"),p=u.value,v=await V(p);if(v){const P=new FileReader;P.onload=()=>{const U=P.result;k.value.ej2Instances.documentEditor.open(U),x("doc",U)},P.readAsText(v)}}catch{console.error("Erro ao carregar o documento.")}finally{w.value=!1}},E=async()=>{const u=await k.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),r=new FileReader;r.onload=()=>{const p=r.result,P=k.value.ej2Instances.documentEditor.pageCount;x("page",P),x("doc",p)},r.readAsText(u)},N=async()=>{w.value=!0;try{const u=await k.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),r=new FormData;r.append("file",u,"anexo.sfdt"),r.append("cartorio_token",G("user-data").value.cartorio_token),r.append("token",i.query.ato_token_edit),r.append("tipo","ato_minuta");const{data:p,status:v}=await y(S,{method:"POST",body:r},"$xv11VtUdMy");if(v.value==="success"){h.success("Documento enviado!");const U=k.value.ej2Instances.documentEditor.pageCount;E(),x("page",U)}else h.error("Erro ao enviar documento para o sistema.")}catch(a){h.error("Erro ao salvar documento."),console.error(a)}finally{w.value=!1}},D=()=>{d.value=!1,H()},H=async()=>{l(!0);try{await K(),l(!0);const{data:a,status:u}=await y(M,{method:"POST",body:{ato_token:i.query.ato_token_edit}},"$zyzWHTXTBW");a.value&&s(a.value)}catch(a){console.error("Erro ao gerar a minuta:",a),h.error("Ocorreu um erro ao gerar a minuta.")}finally{l(!1)}},K=async()=>{try{const{data:a}=await y(q,{method:"POST",body:{bucket:"qvgjz",path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),u=await V(a.value);if(u){const r=new FileReader;r.onload=()=>{const p=r.result;k.value.ej2Instances.documentEditor.open(p),x("doc",p)},r.readAsText(u)}}catch(a){console.error("Erro ao carregar o modelo de minuta:",a)}},s=a=>{const u=k.value.ej2Instances.documentEditor,r=p=>{for(const[v,P]of Object.entries(p))if(/^<<.+>>$/.test(v))try{u.search.findAll(v),u.search.searchResults.length>0&&u.search.searchResults.replaceAll(P)}catch(U){console.error(`Erro ao substituir o marcador ${v}:`,U)}else if(v==="partes"&&Array.isArray(P)&&P.length>0)for(const U of P)typeof U=="object"&&r(U)};r(a)},l=a=>{w.value=a},R=()=>{const a=i.query.origem||"criar",u=i.query.id;a==="atualizar"?m.push(`/os/atualizar/${u}`):m.push("/os/criar-registro")};return Ie(async()=>{await f(),E()}),(a,u)=>{const r=ue,p=Te;return j(),Q(Ce,null,[e(o(Pe),{height:"900px",ref_key:"documentEditorContainer",ref:k,serviceUrl:ct,enableToolbar:!0,enableWordExport:!0},null,512),o(w)?(j(),Q("div",ut,[e(Fe,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):Ve("",!0),e(O,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e(r,{class:"mr-4"},{default:t(()=>[e(F,{size:"large",onClick:R,color:"red"},{default:t(()=>u[2]||(u[2]=[B("Voltar")])),_:1})]),_:1}),e(F,{size:"large",color:"green",onClick:N,disabled:o(w)},{default:t(()=>u[3]||(u[3]=[B("Atualizar")])),_:1},8,["disabled"]),e(F,{class:"ml-4",size:"large",color:"blue",onClick:u[0]||(u[0]=v=>d.value=!0)},{default:t(()=>u[4]||(u[4]=[B("Gerar Minuta")])),_:1})]),_:1}),e(p,{onConfirm:D,condMessage:o(z),show:o(d),onClose:u[1]||(u[1]=v=>d.value=!1)},null,8,["condMessage","show"])],64)}}},dt=["innerHTML"],jt={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(X){let _,C;const h=X,m=Z();Ee(`${m.public.docEditor}`);const{$toast:i}=ae(),x=se(),q=re(),A=`${m.public.managemant}/download`,M=`${m.public.managemant}/atos/files`,S=`${m.public.managemant}/lavrarAto`,k=`${m.public.managemant}/listarEscrevente`,d=c(G("user-data").value.cartorio_token),z=G("auth_token").value,w=c("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),V=c(!1),$=c(null),f=c(null),E=c(null),N=c([]),D=ce({escrevente:null}),H=async r=>{try{const p=await fetch(r);if(!p.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await p.blob()}catch(p){return console.error(p),null}},K=async()=>{try{const{data:r}=await y(`${M}/${q.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return r.value.link_ato}catch(r){console.error("Erro ao carregar o documento:",r),i.error(r)}},s=async()=>{try{const r=await K(),{data:p,status:v}=await y(A,{method:"POST",body:{bucket:"qvgjz",path:r}},"$7ljqltMqa0"),P=p.value,U=await H(P);if(U){const ee=new FileReader;ee.onload=()=>{const ve=ee.result;E.value.ej2Instances.documentEditor.open(ve)},ee.readAsText(U)}}catch{i.error("Erro ao carregar o documento.")}};s();const l=async()=>{if(!D.escrevente){i.error("Selecione um escrevente para realizar a ação");return}try{const{data:r,status:p}=await y(S,{method:"POST",body:{ato_token:q.query.ato_token_edit,qtd_paginas:h.pages,escrevente_token:D.escrevente,usuario_token:z,cartorio_token:d}},"$OWxZSQkyX8");p.value==="success"?($.value=r.value,f.value=r.value[0].selo,i.success("Ato lavrado com sucesso!")):i.error("Falha ao lavrar o ato.")}catch{i.error("Erro ao conectar com o servidor.")}},R=()=>{V.value=!1,l()},{data:a}=([_,C]=ie(()=>y(k,{method:"POST",body:{cartorio_token:d}},"$sMqfUUQcBM")),_=await _,C(),_);N.value=a.value[0].func_json_escreventes;const u=()=>{const r=q.query.origem||"criar",p=q.query.id;r==="atualizar"?x.push(`/os/atualizar/${p}`):x.push("/os/criar-registro")};return Ae(()=>h.document,(r,p)=>{s()}),(r,p)=>{const v=Te;return j(),Q(Ce,null,[e(O,null,{default:t(()=>[e(I,null,{default:t(()=>[e(o(Pe),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:E,height:"850px",width:"850px"},null,512)]),_:1}),e(I,null,{default:t(()=>[e(oe,{class:"mt-15",label:"Tabelião/escrevente",modelValue:o(D).escrevente,"onUpdate:modelValue":p[0]||(p[0]=P=>o(D).escrevente=P),items:o(N),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),b("img",{onClick:p[1]||(p[1]=P=>V.value=!0),style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Xe}),o($)?(j(),ne(pe,{key:0,width:"360px",class:"mr-16"},{default:t(()=>[e(O,null,{default:t(()=>[e(I,null,{default:t(()=>[e($e,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[B(" Livro: "+_e(o($)[0].livro_numero),1)]),_:1})]),_:1}),e(I,null,{default:t(()=>[e($e,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[B(" Folhas : "+_e(o($)[0].pagina_inicial)+" A "+_e(o($)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),b("div",{style:{border:"1px solid black","border-radius":"8px","padding-bottom":"20px","margin-top":"-10px"},class:"ml-2 mb-2 mr-2",innerHTML:o(f)},null,8,dt)]),_:1})):Ve("",!0)]),_:1})]),_:1}),e(F,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:u},{default:t(()=>p[3]||(p[3]=[B("Voltar")])),_:1}),e(v,{show:o(V),condMessage:o(w),onClose:p[2]||(p[2]=P=>V.value=!1),onConfirm:R},null,8,["show","condMessage"])],64)}}},mt=["onClick"],pt={key:0,style:{width:"30px",height:"30px"},src:ge,alt:"Visualizar",title:"Reativar"},vt={key:1,src:be,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Rt={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(X){let _,C;const h=se(),m=re(),i=Z(),{$toast:x}=ae(),q=`${i.public.managemant}/listarEscrevente`;`${i.public.managemant}`;const A=`${i.public.managemant}/createAtosObservacao`,M=`${i.public.managemant}/updateAtosObservacao`,S=`${i.public.managemant}/getAtosObservacaoById`,k=c(G("user-data").value.cartorio_token),d=c([]),z=c([]),w=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],V=ce({observacao:""}),$={observacao:{required:et.withMessage("O campo é obrigatório",tt)}},f=ot($,V),{data:E}=([_,C]=ie(()=>y(`${S}/${m.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),_=await _,C(),_);d.value=E.value.map(s=>({...s,created:we(s.created,"dd/mm/yyyy hh:mm")}));async function N(){if(V.observacao.trim()===""){x.error("O campo de observação está vazio.");return}if(await f.value.$validate()){const{data:s,error:l,status:R}=await y(A,{method:"POST",body:{ato_id:m.query.ato_id,observacao:V.observacao,user_id:G("user-data").value.usuario_id}},"$gnHMo4uCXD");R.value==="success"&&(d.value.push({created:we(s.value.created,"dd/mm/yyyy hh:mm"),observacao:s.value.observacao,id:s.value.id,escrevente:G("user-data").value.nome}),V.observacao="",x.success("Observação registrada com sucesso"))}else x.error("Preencha os campos obrigatórios.")}async function D(s){s.excluido=!s.excluido;try{await y(`${M}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$sP9AKdd3Ky")}catch(l){console.error("Erro ao excluir observação:",l)}}const{data:H}=([_,C]=ie(()=>y(q,{method:"POST",body:{cartorio_token:k}},"$HL9pndqGh0")),_=await _,C(),_);z.value=H.value[0].func_json_escreventes;const K=()=>{const s=m.query.origem||"criar",l=m.query.id;s==="atualizar"?h.push(`/os/atualizar/${l}`):h.push("/os/criar-registro")};return(s,l)=>{const R=ue;return j(),ne(de,null,{default:t(()=>[e(O,{class:"mt-5"},{default:t(()=>[e(te,{label:"Observação",modelValue:V.observacao,"onUpdate:modelValue":l[0]||(l[0]=a=>V.observacao=a),required:"","error-messages":o(f).observacao.$errors.length>0?o(f).observacao.$errors.map(a=>a.$message):[],onBlur:o(f).observacao.$touch,onInput:o(f).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),b("div",null,[b("img",{class:"btn-pointer ml-2",src:me,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:N})])]),_:1}),e(O,null,{default:t(()=>[e(I,null,{default:t(()=>[e(he,{style:{height:"465px"},headers:w,items:d.value},{"item.actions":t(({item:a})=>[b("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:u=>D(a),title:"Deletar Observação"},[a.excluido?(j(),Q("img",pt)):(j(),Q("img",vt))],8,mt)]),_:1},8,["items"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(R,{onClick:K},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>l[1]||(l[1]=[B("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},ft=["onClick"],_t=["onClick"],yt={key:0,style:{width:"30px",height:"30px"},src:ge,alt:"Visualizar",title:"Reativar"},gt={key:1,src:be,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},It={__name:"Anexos",async setup(X){let _,C;const h=Z(),{$toast:m}=ae(),i=se(),x=re(),q=`${h.public.biometria}/run-scanner`,A=`${h.public.managemant}/atos_anexos`,M=`${h.public.managemant}/atos_anexos`,S=`${h.public.managemant}/atos_anexos`,k=c(!1),d=c([]),z=ce({descricao:""}),w=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:V}=([_,C]=ie(()=>y(`${S}/${x.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),_=await _,C(),_);d.value=V.value;async function $(){try{await f(),await E()}catch(s){console.error("Erro ao executar scanner ou listar arquivos:",s)}}async function f(){try{const{data:s}=await y(q,{method:"GET"},"$KttjFhHivJ")}catch(s){m.error("Erro ao acionar o scanner:",s)}}async function E(){try{const{data:s,status:l}=await y("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:x.query.ato_token_edit,cartorio_token:G("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(s){console.error("Erro ao enviar o arquivo:",s)}}const N=async()=>{k.value=!0},D=async()=>{const{data:s,error:l,status:R}=await y(A,{method:"POST",body:{ato_id:x.query.ato_id,descricao:z.descricao,user_id:G("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");R.value==="success"&&(m.success("Anexo registrado com sucesso!"),d.value.push(s.value))};async function H(s){s.excluido=!s.excluido;try{await y(`${M}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$cdoFBGO0Ti")}catch(l){console.error("Erro ao excluir pessoa:",l)}}const K=()=>{const s=x.query.origem||"criar",l=x.query.id;s==="atualizar"?i.push(`/os/atualizar/${l}`):i.push("/os/criar-registro")};return(s,l)=>{const R=ue;return j(),ne(de,null,{default:t(()=>[e(O,null,{default:t(()=>[e(I,{cols:"5"},{default:t(()=>[e(te,{modelValue:o(z).descricao,"onUpdate:modelValue":l[0]||(l[0]=a=>o(z).descricao=a),label:"Descrição"},null,8,["modelValue"])]),_:1}),b("div",{onClick:$,title:"Escanear"},l[3]||(l[3]=[b("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Qe,alt:"Escanear"},null,-1)])),b("div",{onClick:D,title:"Criar"},l[4]||(l[4]=[b("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:me,alt:"Criar"},null,-1)]))]),_:1}),e(he,{headers:w,items:o(d),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:a})=>[e(O,null,{default:t(()=>[b("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:u=>N(a),title:"Visualizar Anexo"},l[5]||(l[5]=[b("img",{style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar"},null,-1)]),8,ft),b("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:u=>H(a),title:"Deletar Pessoa"},[a.excluido?(j(),Q("img",yt)):(j(),Q("img",gt))],8,_t)]),_:2},1024)]),_:1},8,["items"]),e(xe,{modelValue:o(k),"onUpdate:modelValue":l[2]||(l[2]=a=>le(k)?k.value=a:null),width:"600"},{default:t(()=>[e(pe,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(F,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:l[1]||(l[1]=a=>k.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(R,{onClick:K},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>l[6]||(l[6]=[B("Voltar")])),_:1})]),_:1})]),_:1})}}},Ft={__name:"TiposAtos",props:{show:Boolean,servicos:Array,tiposAtos:Array},emits:["close","save"],setup(X,{emit:_}){const h=c(X.show),m=c(""),i=c(""),x=Z(),q=G("auth_token").value,A=c(G("user-data").value.cartorio_token).value,M=c([]),S=c([]),k=_,d=`${x.public.managemant}/tipoAtos`,z=async()=>{const{data:$}=await y(d,{method:"POST",body:{usuario_token:q,cartorio_token:A}},"$6VlNS7ylT6");M.value=$.value,M.value.length>0&&(m.value=M.value[0].token)},w=async $=>{const{data:f}=await y(d,{method:"POST",body:{usuario_token:q,cartorio_token:A,servico_token:$}},"$pRqAaiCpuA");S.value=f.value};Ae(m,async $=>{$&&(await w($),i.value=S.value.length>0?S.value[0]:null)});const V=()=>{h.value=!1,k("close")};return z(),($,f)=>(j(),ne(xe,{persistent:"",modelValue:o(h),"onUpdate:modelValue":f[2]||(f[2]=E=>le(h)?h.value=E:null),"max-width":"500"},{default:t(()=>[e(pe,null,{default:t(()=>[e(de,null,{default:t(()=>[e(O,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:t(()=>f[3]||(f[3]=[b("h1",{class:"ml-4"},"Tipos de Atos",-1)])),_:1}),f[4]||(f[4]=b("hr",{class:"mb-5"},null,-1)),e(oe,{class:"mb-5",label:"Selecione o Serviço",modelValue:o(m),"onUpdate:modelValue":f[0]||(f[0]=E=>le(m)?m.value=E:null),items:o(M),"item-title":"descricao","item-value":"token"},null,8,["modelValue","items"]),e(oe,{"item-title":"descricao","item-value":"token",class:"mb-5",label:"Selecione o Tipo de Ato",modelValue:o(i),"onUpdate:modelValue":f[1]||(f[1]=E=>le(i)?i.value=E:null),items:o(S)},null,8,["modelValue","items"])]),_:1}),e(Ze,null,{default:t(()=>[e(F,{style:{"background-color":"red",color:"white"},onClick:V},{default:t(()=>f[5]||(f[5]=[B("Voltar")])),_:1}),e(F,{style:{"background-color":"green",color:"white"},onClick:$.save},{default:t(()=>f[6]||(f[6]=[B("Salvar")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{Ft as _,St as a,Dt as b,Ut as c,jt as d,Rt as e,It as f};
