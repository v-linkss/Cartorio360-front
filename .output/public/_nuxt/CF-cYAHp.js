import{_ as e}from"./4de_rhUN.js";import{a,b as t,c as s,d as o,V as r}from"./oKXwpsuu.js";import{r as l,h as u,o as n,A as i,w as d,b as c,d as m,c as v,t as p,y as _,q as f,v as g,_ as h,u as k,E as b,D as w,F as y,G as q,x as V,a as $,s as j,p as x,e as M}from"./Cqiv77yc.js";import{u as O}from"./D0-0VRaN.js";import{_ as A}from"./ToPptOUL.js";import{c as S,r as C,u as B,_ as E}from"./CnBBmU9u.js";import{V as I}from"./DGrEsPnk.js";import{V as P}from"./B5iMDmra.js";import{V as T}from"./sftuTnbG.js";const z={key:0},L={key:1},U={__name:"ErrorModalCard",props:{show:Boolean,errorMessage:String},emits:["close"],setup(e,{emit:h}){const k=e,b=l(k.show),w=h;u((()=>k.show),(e=>{b.value=e}));const y=()=>{b.value=!1,w("close")};return(l,u)=>(n(),i(r,{modelValue:f(b),"onUpdate:modelValue":u[0]||(u[0]=e=>g(b)?b.value=e:null),"max-width":"500"},{default:d((()=>[c(a,null,{default:d((()=>[c(t,{class:"text-h5"},{default:d((()=>[m("Erro na Requisição")])),_:1}),c(s,null,{default:d((()=>[e.errorMessage?(n(),v("div",z,p(e.errorMessage),1)):(n(),v("div",L,"Ocorreu um erro inesperado."))])),_:1}),c(o,null,{default:d((()=>[c(_,{style:{"background-color":"#429946",color:"white"},onClick:y},{default:d((()=>[m("OK")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]))}},F={style:{width:"600px","margin-top":"10px"}},X={style:{width:"180px","margin-top":"20px"}},D=(e=>(x("data-v-098d52a5"),e=e(),M(),e))((()=>$("img",{class:"btn-pointer mt-10 mb-5",src:A,alt:"Sair"},null,-1))),G=h({__name:"autenticacao",async setup(t){let s,o;const r=k(),u=b(),m=V(),v=`${m.public.managemant}/listarEscrevente`,p=l(w("user-data").value.cartorio_token).value,_=l(w("user-service").value.token).value||l(w("user-service").value).value,g=w("auth_token").value,h=`${m.public.managemant}/atoAutentica`,x=`${m.public.managemant}/etiquetaAutentica`,M=l(!1),A=l(""),z=y({escrevente:null,quantidade:1}),L=l([]),{data:G}=([s,o]=q((()=>O(v,{method:"POST",body:{cartorio_token:p}},"$nXL9eJBhI7"))),s=await s,o(),s);L.value=G.value[0].func_json_escreventes;const J={escrevente:{required:S.withMessage("O campo é obrigatorio",C)}},K=B(J,z),N=async()=>{if(await K.value.$validate()){const{data:e,status:a,error:t}=await O(h,{method:"POST",body:{usuario_token:g,cartorio_token:p,quantidade:Number(z.quantidade),ordemserv_token:_,ato_tipo_token:"bFsdV"}},"$dpfLzAlO85");"success"===a.value?Q(e.value.token):(M.value=!0,A.value=t.value.data.details)}},Q=async e=>{const{data:a,status:t}=await O(x,{method:"POST",body:{escrevente_token:z.escrevente,cartorio_token:p,ato_token:e}},"$fPnSl9XMLA");if("success"===t.value){const e=window.open("","_blank");e.document.open(),e.document.write(a.value.etiqueta),e.document.close()}},R=()=>{const e=u.query.origem||"criar",a=u.query.id;"atualizar"===e?r.push(`/ordens-servicos/atualizar/${a}`):r.push("/ordens-servicos/criar-registro")};return(t,s)=>{const o=e,r=U;return n(),i(a,{class:"mt-10",title:"Autenticação"},{default:d((()=>[c(T,null,{default:d((()=>[$("div",F,[c(I,{label:"Tabelião/escrivão",modelValue:f(z).escrevente,"onUpdate:modelValue":s[0]||(s[0]=e=>f(z).escrevente=e),items:f(L),"item-title":"nome","item-value":"token",required:"","error-messages":f(K).escrevente.$errors.map((e=>e.$message)),onBlur:f(K).escrevente.$touch,onInput:f(K).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),$("div",X,[c(j,{type:"number",label:"Quantidade",modelValue:f(z).quantidade,"onUpdate:modelValue":s[1]||(s[1]=e=>f(z).quantidade=e)},null,8,["modelValue"])]),c(P,null,{default:d((()=>[$("div",null,[c(o,{onClick:R},{default:d((()=>[D])),_:1})]),$("img",{class:"btn-pointer mt-10",src:E,onClick:N})])),_:1})])),_:1}),c(r,{show:f(M),errorMessage:f(A),onClose:s[2]||(s[2]=e=>M.value=!1)},null,8,["show","errorMessage"])])),_:1})}}},[["__scopeId","data-v-098d52a5"]]);export{G as default};
