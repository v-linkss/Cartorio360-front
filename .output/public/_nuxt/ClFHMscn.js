import{_ as $}from"./B16moC2y.js";import{r as U,m as I,n as L,z as O,p as B,w as r,v as T,o as j,b as n,B as v,C as p,q as l,a as b}from"./D7ENO5AD.js";import{u as F}from"./5esaczZp.js";import{V as N}from"./B2A0rb-z.js";import{V as c}from"./CEvvklSZ.js";import{V as M}from"./CfMx6KlI.js";import"./D3WrJDqK.js";const P=""+new URL("btn-csv.DS5dvxBS.png",import.meta.url).href,K={__name:"livro-diario",setup(Y){const f=`${T().public.managemant}/relatorios`,g=U(I("user-data").value.cartorio_token),a=L({data_inicial:_(),data_final:_(),paginaInicial:0,livro:0});function _(){const e=new Date,t=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${o}-${t}`}function u(e){if(!e)return null;const[t,o,i]=e.split("/");return`${i}-${o}-${t}`}const V=async()=>{const{data:e}=await F(f,{method:"POST",body:{cartorio_token:g,data_inicial:u(a.data_inicial),data_final:u(a.data_final),livro:a.livro,paginaInicial:a.paginaInicial}},"$YxyRzXktgB");if(e.value){const t=new Blob([e.value],{type:"application/pdf"}),o=URL.createObjectURL(t);window.open(o,"_blank"),setTimeout(()=>URL.revokeObjectURL(o),1e4)}},h=async()=>{const e=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cartorio_token:g.value,data_inicial:u(a.data_inicial),data_final:u(a.data_final),livro:a.livro,paginaInicial:a.paginaInicial,tipo_retorno:"csv"})});if(e.ok){const t=await e.blob();let o="relatorio.csv";const i=e.headers.get("Content-Disposition");if(i&&i.includes("filename=")&&(o=i.split("filename=")[1].replace(/['"]/g,"").trim()),o==="relatorio.csv"){const s=new Date,m=S=>S.toString().padStart(2,"0"),k=m(s.getDate()),w=m(s.getMonth()+1),C=s.getFullYear(),x=m(s.getHours()),R=m(s.getMinutes()),D=m(s.getSeconds());o=`livro_diario_${k}${w}${C}${x}${R}${D}.csv`}const y=URL.createObjectURL(t),d=document.createElement("a");d.href=y,d.download=o,document.body.appendChild(d),d.click(),setTimeout(()=>{URL.revokeObjectURL(y),document.body.removeChild(d)},1e3)}};return(e,t)=>{const o=O("mask");return j(),B(N,null,{default:r(()=>[n(M,{class:"mt-1"},{default:r(()=>[n(c,null,{default:r(()=>[v(n(p,{modelValue:l(a).data_inicial,"onUpdate:modelValue":t[0]||(t[0]=i=>l(a).data_inicial=i),label:"Data Inicial",placeholder:"dd/mm/yyyy"},null,8,["modelValue"]),[[o,"##/##/####"]])]),_:1}),n(c,null,{default:r(()=>[v(n(p,{modelValue:l(a).data_final,"onUpdate:modelValue":t[1]||(t[1]=i=>l(a).data_final=i),label:"Data Final",placeholder:"dd/mm/yyyy"},null,8,["modelValue"]),[[o,"##/##/####"]])]),_:1}),n(c,null,{default:r(()=>[n(p,{label:"N* Livro",type:"number",modelValue:l(a).livro,"onUpdate:modelValue":t[2]||(t[2]=i=>l(a).livro=i)},null,8,["modelValue"])]),_:1}),n(c,null,{default:r(()=>[n(p,{label:"Pagina Inicial",type:"number",modelValue:l(a).paginaInicial,"onUpdate:modelValue":t[3]||(t[3]=i=>l(a).paginaInicial=i)},null,8,["modelValue"])]),_:1}),n(c,null,{default:r(()=>[b("img",{onClick:V,style:{width:"40px",height:"40px",cursor:"pointer"},src:$,alt:"imprimir",title:"imprimir"}),b("img",{onClick:h,style:{width:"40px",height:"40px",cursor:"pointer","margin-left":"20px"},src:P,alt:"exportar",title:"exportar"})]),_:1}),n(c)]),_:1})]),_:1})}}};export{K as default};
