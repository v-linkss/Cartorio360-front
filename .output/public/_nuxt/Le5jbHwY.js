import{r as G,n as H,D as M,F as X,h as J,G as K,H as Q,o as _,A as C,w as s,b as o,d as b,q as e,a4 as W,c as Y,t as Z,C as N,s as m,I as $,y as q,v as ee,x as ae}from"./DRR9lf64.js";import{a as oe,u as le}from"./DpQ56Y3J.js";import{c as w,r as y,u as te,V as I}from"./CzE9nWNi.js";import{c as se}from"./DwxJipEU.js";import{a as ie,c as de,V as re}from"./Cq5hbXRZ.js";import{V as me}from"./BaMkntfk.js";import{V as u}from"./Cml2SLMY.js";import{V as d}from"./D7D83Ict.js";const ne={key:1},be={__name:"RegistroPessoas",props:{show:Boolean},emits:["close"],async setup(D,{emit:A}){let p,P;const U=D,c=G(U.show),S=A,{$toast:V}=H(),f=ae(),E=`${f.public.auth}/service/gerencia/createPessoa`,O=`${f.public.auth}/service/gerencia/listarEstadoCivil`,R=`${f.public.auth}/service/gerencia/listarCapacidadeCivil`,h=`${f.public.auth}/service/gerencia/listarCidades`,z={nome:"",nome_pai:"",nome_mae:"",profissao:"",local_trabalho:"",data_nascimento:"",doc_identificacao:"",cpf_pai:"",cpf_mae:"",tipo_pessoa:"FISICA",tabvalores_estadocivil_id:"",tabvalores_capacidadecivil_id:"",cidade_natural_id:"",cartorio_id:M("user-data").value.cartorio_id,user_id:M("user-data").value.usuario_id},t=X({...z});J(()=>U.show,i=>{c.value=i});const k=()=>{c.value=!1,S("close")};function v(i){if(i)return i.replace(/[.\-]/g,"");i=null}const{data:g,pending:ue,status:B,error:F}=([p,P]=K(async()=>oe("cliente-dados",async()=>{const[i,l,n]=await Promise.all([$fetch(O),$fetch(R),$fetch(h)]);return{estadoCivilItems:i,capacidadeCivilItems:l,cidadeNascimentoItems:n}})),p=await p,P(),p),T={nome:{required:w.withMessage("O campo é obrigatorio",y)},nome_mae:{required:w.withMessage("O campo é obrigatorio",y)},doc_identificacao:{required:w.withMessage("O campo é obrigatorio",y),cpf:se}},r=te(T,t);async function j(){if(await r.value.$validate()){const i={...t};for(const x in i)i[x]===""&&(i[x]=null);const l={...i,doc_identificacao:v(t.doc_identificacao),cpf_pai:v(t.cpf_pai),cpf_mae:v(t.cpf_mae)},{data:n,error:a,status:L}=await le(E,{method:"POST",body:l},"$BiOjXVCR5N");L.value==="error"&&a.value.statusCode===500?V.error("Erro ao cadastrar pessoa,o CPF já está cadastrado."):(V.success("Pessoa cadastrada com sucesso!"),k())}else V.error("Erro ao cadastrar pessoa, preencha os campos obrigatorios.")}return(i,l)=>{const n=Q("mask");return _(),C(re,{persistent:"",modelValue:e(c),"onUpdate:modelValue":l[13]||(l[13]=a=>ee(c)?c.value=a:null),"max-width":"1000"},{default:s(()=>[o(ie,null,{default:s(()=>[o(de,{class:"text-h5 mt-3"},{default:s(()=>[b("Criar Pessoa")]),_:1}),e(B)==="pending"?(_(),C(W,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):e(F)?(_(),Y("div",ne,Z(e(F).message),1)):N("",!0),e(B)==="success"?(_(),C(me,{key:2,class:"mt-5"},{default:s(()=>[o(u,null,{default:s(()=>[o(d,{cols:"12",md:"8"},{default:s(()=>[o(m,{modelValue:e(t).nome,"onUpdate:modelValue":l[0]||(l[0]=a=>e(t).nome=a),"error-messages":e(r).nome.$errors.map(a=>a.$message),label:"Nome",required:"",onBlur:e(r).nome.$touch,onInput:e(r).nome.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1}),o(d,{cols:"12",md:"4"},{default:s(()=>[$(o(m,{modelValue:e(t).doc_identificacao,"onUpdate:modelValue":l[1]||(l[1]=a=>e(t).doc_identificacao=a),"error-messages":e(r).doc_identificacao.$errors.map(a=>a.$message),label:"CPF",required:"",onBlur:e(r).doc_identificacao.$touch,onInput:e(r).doc_identificacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),[[n,"###.###.###-##"]])]),_:1})]),_:1}),o(u,null,{default:s(()=>[o(d,{cols:"12",md:"4"},{default:s(()=>[o(I,{modelValue:e(t).tabvalores_estadocivil_id,"onUpdate:modelValue":l[2]||(l[2]=a=>e(t).tabvalores_estadocivil_id=a),items:e(g).estadoCivilItems,"item-title":"descricao","item-value":"id",label:"Estado Civil"},null,8,["modelValue","items"])]),_:1}),o(d,{cols:"12",md:"4"},{default:s(()=>[o(m,{modelValue:e(t).profissao,"onUpdate:modelValue":l[3]||(l[3]=a=>e(t).profissao=a),label:"Profissão"},null,8,["modelValue"])]),_:1}),o(d,{cols:"12",md:"4"},{default:s(()=>[o(m,{modelValue:e(t).local_trabalho,"onUpdate:modelValue":l[4]||(l[4]=a=>e(t).local_trabalho=a),label:"Local de trabalho"},null,8,["modelValue"])]),_:1})]),_:1}),o(u,null,{default:s(()=>[o(d,{cols:"12",md:"4"},{default:s(()=>[o(m,{modelValue:e(t).data_nascimento,"onUpdate:modelValue":l[5]||(l[5]=a=>e(t).data_nascimento=a),type:"date","prepend-icon":"",label:"Data de nascimento"},null,8,["modelValue"])]),_:1}),o(d,{cols:"12",md:"4"},{default:s(()=>[o(I,{modelValue:e(t).tabvalores_capacidadecivil_id,"onUpdate:modelValue":l[6]||(l[6]=a=>e(t).tabvalores_capacidadecivil_id=a),items:e(g).capacidadeCivilItems,label:"Capacidade Civil","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),o(d,{cols:"12",md:"4"},{default:s(()=>[o(I,{modelValue:e(t).cidade_natural_id,"onUpdate:modelValue":l[7]||(l[7]=a=>e(t).cidade_natural_id=a),items:e(g).cidadeNascimentoItems,label:"Cidade de nascimento","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),o(u,null,{default:s(()=>[o(d,{cols:"12",md:"4"},{default:s(()=>[$(o(m,{modelValue:e(t).cpf_pai,"onUpdate:modelValue":l[8]||(l[8]=a=>e(t).cpf_pai=a),modelModifiers:{date:!0},label:"CPF do Pai"},null,8,["modelValue"]),[[n,"###.###.###-##"]])]),_:1}),o(d,{cols:"12",md:"4"},{default:s(()=>[o(m,{modelValue:e(t).nome_pai,"onUpdate:modelValue":l[9]||(l[9]=a=>e(t).nome_pai=a),modelModifiers:{date:!0},label:"Nome do Pai"},null,8,["modelValue"])]),_:1})]),_:1}),o(u,null,{default:s(()=>[o(d,{cols:"12",md:"4"},{default:s(()=>[$(o(m,{modelValue:e(t).cpf_mae,"onUpdate:modelValue":l[10]||(l[10]=a=>e(t).cpf_mae=a),modelModifiers:{date:!0},label:"CPF da Mãe"},null,8,["modelValue"]),[[n,"###.###.###-##"]])]),_:1}),o(d,{cols:"12",md:"4"},{default:s(()=>[o(m,{modelValue:e(t).nome_mae,"onUpdate:modelValue":l[11]||(l[11]=a=>e(t).nome_mae=a),modelModifiers:{date:!0},"error-messages":e(r).nome_mae.$errors.map(a=>a.$message),label:"Nome da Mãe",required:"",onBlur:e(r).nome_mae.$touch,onInput:e(r).nome_mae.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),o(u,null,{default:s(()=>[o(q,{class:"ml-5",color:"red",size:"large",onClick:k},{default:s(()=>[b("Fechar")]),_:1}),o(q,{class:"ml-5",color:"green",size:"large",onClick:l[12]||(l[12]=a=>j())},{default:s(()=>[b("Salvar")]),_:1})]),_:1})]),_:1})):N("",!0)]),_:1})]),_:1},8,["modelValue"])}}};export{be as _};
