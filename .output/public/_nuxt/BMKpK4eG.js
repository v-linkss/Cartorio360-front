import{_ as ve}from"./Cchcbirx.js";import{_ as Ve}from"./BIGqGZF5.js";import{c as me,r as pe,u as Pe}from"./OvnN72zf.js";import{G as be,u as ge,r,m as Z,C as ne,H as h,n as we,v as a,o as x,c as re,b as l,M as Ce,E as T,w as t,V as g,a as b,z as O,d as B,s as ye,I as J,g as Ie,K as ce}from"./XNnlJ8XN.js";import{u as y}from"./B-g2VJsW.js";import{V as k}from"./DpyCu15G.js";import{V as n}from"./CGTXWGXN.js";import{V as Ue}from"./DBCLqk0u.js";import{V as I}from"./Bdbrz3nV.js";import{V as ue}from"./Do7HTISC.js";import{_ as Te,d as Be,V as qe,a as _e,b as Me,c as fe}from"./Cx3vXUft.js";import{b as ze}from"./B6dCBK1b.js";import{_ as Oe}from"./BVz1G1IN.js";import{_ as Se}from"./BRXHyFwx.js";import{_ as Ae,a as Ne,b as je}from"./rINLOGP_.js";import{V as Re}from"./Dh-mdj2D.js";import{V as $e,a as ke}from"./C-GD02re.js";const De={key:0,class:"d-flex justify-center"},Ee={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal"],async setup(q,{emit:S}){let u,p;const V=q,$=S,P=be(),d=ye(),{$toast:C}=ge(),{id:M}=P.params,c=`${d.public.managemant}/atos_bens`,A=`${d.public.managemant}/atos_bens`,N=`${d.public.managemant}/atos_bens`,w=`${d.public.managemant}/registro_imoveis`,ee=`${d.public.managemant}/natureza_imoveis`,H=`${d.public.managemant}/tipo_logradouros`,j=`${d.public.managemant}/situacao_imoveis`,R=`${d.public.managemant}/listarCidades`,G=`${d.public.managemant}/listarTipoBens`,U=r(Z("user-data").value.cartorio_token),D=r(Z("user-data").value.usuario_id).value,E=r([]),F=r([]),Y=r([]),z=r([]),K=r([]),f=r([]),L=r(!0),s=ne({vlr_alienacao:null,tabvalores_tipo_regimovel_id:null,registro_cartorio:null,registro_matricula:null,registro_matricula_letra:null,tabvalores_nat_imovel_id:null,cib:null,end_cidade_id:null,end_quadra:null,end_lote:null,tabvalores_tipologradouro_id:null,end_logradouro:null,end_logradouro_numero:null,end_bairro:null,end_cep:null,end_complemento:null,tipo_id:null,descricao:null,inscricao_estadual:null,tabvalores_situacao_imoveis_id:null,tipo_id:null,vlr_alienacao:null,vlr_mercado:null,valor_mercado:"0.00",aliq_itbi:null,vlr_itbi:null,user_id:D,ato_id:Number(P.query.ato_id)||Number(V.ato_id)}),W=ne({...s}),le={descricao:{required:me.withMessage("O campo é obrigatório",pe)},tipo_id:{required:me.withMessage("O campo é obrigatório",pe)}},X=Pe(le,s),ae=async()=>{if(!await X.value.$validate()){C.error("Preencha todos os campos obrigatórios!");return}const{status:e}=await y(`${c}`,{method:"POST",body:s},"$0Mdv6RF9cH");e.value==="success"&&(C.success("Imovel criado com sucesso!"),$("saved"))},{data:oe}=([u,p]=h(()=>y(`${G}`,{method:"POST",body:{cartorio_token:U.value,imoveis:!0}},"$H1S2cTYpdB")),u=await u,p(),u);if(f.value=oe.value,V.isUpdate===!0){const{data:i}=([u,p]=h(()=>y(`${A}/${V.imovel_id}`,{method:"GET"},"$jHrIlABk8l")),u=await u,p(),u);i.value&&Object.keys(s).forEach(e=>{i.value[e]!==void 0&&(s[e]=i.value[e])}),Object.assign(W,s)}async function te(){try{const[i,e,m,_,o]=await Promise.all([$fetch(ee),$fetch(w),$fetch(j),$fetch(H),$fetch(R)]);F.value=i,E.value=e,K.value=m,Y.value=_,z.value=o}catch(i){console.error("Erro ao carregar os dados de imoveis pessoa:",i)}finally{L.value=!1}}const se=async i=>{const e={};if(Object.keys(s).forEach(_=>{s[_]!==W[_]&&(e[_]=s[_])}),Object.keys(e).length===0)return;const{status:m}=await y(`${N}/${i}`,{method:"PUT",body:e},"$BZjXR26AL9");m.value==="success"&&(C.success("Imovel Atualizado com sucesso!"),$("close-modal"))},ie=()=>{$("close-modal")};return we(()=>{M||V.ato_id?te():L.value=!1}),(i,e)=>{const m=ve,_=Ve;return a(L)?(x(),re("div",De,[l(Ce,{indeterminate:"",class:"loading-spinner",size:"64"})])):(x(),T(ue,{key:1},{default:t(()=>[l(k,null,{default:t(()=>[l(n,{class:"mt-5",cols:"12"},{default:t(()=>[l(Ue,{label:"Descrição",modelValue:a(s).descricao,"onUpdate:modelValue":e[0]||(e[0]=o=>a(s).descricao=o),"error-messages":a(X).descricao.$errors.map(o=>o.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),l(k,null,{default:t(()=>[l(n,{cols:"3"},{default:t(()=>[l(I,{label:"Tipo de Registro",modelValue:a(s).tabvalores_tipo_regimovel_id,"onUpdate:modelValue":e[1]||(e[1]=o=>a(s).tabvalores_tipo_regimovel_id=o),items:a(E),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"2"},{default:t(()=>[l(g,{label:"Cartório",modelValue:a(s).registro_cartorio,"onUpdate:modelValue":e[2]||(e[2]=o=>a(s).registro_cartorio=o)},null,8,["modelValue"])]),_:1}),l(n,{cols:"2"},{default:t(()=>[l(g,{label:"Matricula",modelValue:a(s).registro_matricula,"onUpdate:modelValue":e[3]||(e[3]=o=>a(s).registro_matricula=o)},null,8,["modelValue"])]),_:1}),l(n,null,{default:t(()=>[l(g,{label:"Letra",modelValue:a(s).registro_matricula_letra,"onUpdate:modelValue":e[4]||(e[4]=o=>a(s).registro_matricula_letra=o)},null,8,["modelValue"])]),_:1}),l(n,{cols:"2"},{default:t(()=>[l(I,{label:"Natureza",modelValue:a(s).tabvalores_nat_imovel_id,"onUpdate:modelValue":e[5]||(e[5]=o=>a(s).tabvalores_nat_imovel_id=o),items:a(F),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"1"},{default:t(()=>[l(g,{label:"CIB",modelValue:a(s).cib,"onUpdate:modelValue":e[6]||(e[6]=o=>a(s).cib=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(k,null,{default:t(()=>[l(n,{cols:"3"},{default:t(()=>[l(I,{label:"Cidade",modelValue:a(s).end_cidade_id,"onUpdate:modelValue":e[7]||(e[7]=o=>a(s).end_cidade_id=o),items:a(z),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"2"},{default:t(()=>[l(g,{label:"Quadra",modelValue:a(s).end_quadra,"onUpdate:modelValue":e[8]||(e[8]=o=>a(s).end_quadra=o)},null,8,["modelValue"])]),_:1}),l(n,{cols:"2"},{default:t(()=>[l(g,{label:"Lote",modelValue:a(s).end_lote,"onUpdate:modelValue":e[9]||(e[9]=o=>a(s).end_lote=o)},null,8,["modelValue"])]),_:1}),l(n,{cols:"4"},{default:t(()=>[l(I,{label:"Logradouro",modelValue:a(s).tabvalores_tipologradouro_id,"onUpdate:modelValue":e[10]||(e[10]=o=>a(s).tabvalores_tipologradouro_id=o),items:a(Y),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"1"},{default:t(()=>[l(g,{label:"N*",modelValue:a(s).end_logradouro_numero,"onUpdate:modelValue":e[11]||(e[11]=o=>a(s).end_logradouro_numero=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(k,null,{default:t(()=>[l(n,null,{default:t(()=>[l(g,{label:"Bairro",modelValue:a(s).end_bairro,"onUpdate:modelValue":e[12]||(e[12]=o=>a(s).end_bairro=o)},null,8,["modelValue"])]),_:1}),l(n,null,{default:t(()=>[l(g,{label:"CEP",modelValue:a(s).end_cep,"onUpdate:modelValue":e[13]||(e[13]=o=>a(s).end_cep=o)},null,8,["modelValue"])]),_:1}),l(n,null,{default:t(()=>[l(g,{label:"Complemento",modelValue:a(s).end_complemento,"onUpdate:modelValue":e[14]||(e[14]=o=>a(s).end_complemento=o)},null,8,["modelValue"])]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(I,{modelValue:a(s).tipo_id,"onUpdate:modelValue":e[15]||(e[15]=o=>a(s).tipo_id=o),items:a(f),label:"Tipo de imovel","item-title":"descricao","item-value":"id","error-messages":a(X).tipo_id.$errors.map(o=>o.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),l(n,{cols:"3"},{default:t(()=>[l(g,{label:"Inscrição Municipal"})]),_:1})]),_:1}),l(k,null,{default:t(()=>[l(n,{class:"mt-6",cols:"4"},{default:t(()=>[l(I,{label:"Situação",items:a(K),"item-title":"descricao","item-value":"id"},null,8,["items"])]),_:1}),l(n,{cols:"2"},{default:t(()=>[e[22]||(e[22]=b("label",null,"Valor Alienação",-1)),l(m,{label:"Valor Alienação",modelValue:a(s).vlr_alienacao,"onUpdate:modelValue":e[16]||(e[16]=o=>a(s).vlr_alienacao=o)},null,8,["modelValue"])]),_:1}),l(n,{cols:"2"},{default:t(()=>[e[23]||(e[23]=b("label",null,"Valor Avaliação",-1)),l(m,{label:"Valor Avaliação",modelValue:a(s).vlr_avaliacao,"onUpdate:modelValue":e[17]||(e[17]=o=>a(s).vlr_avaliacao=o)},null,8,["modelValue"])]),_:1}),l(n,{cols:"2"},{default:t(()=>[e[24]||(e[24]=b("label",null,"Valor Mercado",-1)),l(m,{label:"Valor Mercado",modelValue:a(s).vlr_mercado,"onUpdate:modelValue":e[18]||(e[18]=o=>a(s).vlr_mercado=o)},null,8,["modelValue"])]),_:1}),l(n,{cols:"1"},{default:t(()=>[e[25]||(e[25]=b("label",null,"%ITB",-1)),l(m,{label:"%ITB",modelValue:a(s).aliq_itbi,"onUpdate:modelValue":e[19]||(e[19]=o=>a(s).aliq_itbi=o)},null,8,["modelValue"])]),_:1}),l(n,{cols:"1"},{default:t(()=>[e[26]||(e[26]=b("label",null,"Valor ITB",-1)),l(m,{label:"Valor ITB",modelValue:a(s).vlr_itbi,"onUpdate:modelValue":e[20]||(e[20]=o=>a(s).vlr_itbi=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(k,{class:"mt-10"},{default:t(()=>[l(_,{onClick:ie},{default:t(()=>[l(O,{size:"large",color:"red"},{default:t(()=>e[27]||(e[27]=[B("Voltar")])),_:1})]),_:1}),q.isUpdate?(x(),T(O,{key:0,class:"ml-5",size:"large",color:"green",onClick:e[21]||(e[21]=o=>se(V.imovel_id))},{default:t(()=>e[28]||(e[28]=[B("Atualizar")])),_:1})):(x(),T(O,{key:1,class:"ml-5",size:"large",color:"green",onClick:ae},{default:t(()=>e[29]||(e[29]=[B("Salvar")])),_:1}))]),_:1})]),_:1}))}}},Fe=["onClick"],Le=["onClick"],He=["onClick"],Ge={key:0,style:{width:"30px",height:"30px"},src:Ne,alt:"Visualizar",title:"Reativar"},Ye={key:1,src:je,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ke={__name:"Partes",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal"],async setup(q,{emit:S}){let u,p;const V=q,$=S,P=be(),d=ye(),{$toast:C}=ge(),M=`${d.public.managemant}/partes_atos`,c=`${d.public.managemant}/listarPapeis`,A=`${d.public.managemant}/getLinkTipo`,N=`${d.public.managemant}/bens_pessoa`;`${d.public.managemant}`;const w=`${d.public.managemant}/bens_pessoa`,ee=`${d.public.managemant}/download`;r(Z("user-data").value.cartorio_token);const H=r([]),j=r([]),R=r([]),G=r(!1),U=r(!1),D=r(!1),E=r(null),F=r(null),Y=r(P.query.tipo_ato_token),z=r(null),K=[{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"%",align:"start",key:"percentual"},{value:"actions"}],f=ne({papeis:null,percentual:null,pessoa:null,documento:null}),{data:L}=([u,p]=h(()=>y(c,{method:"POST",body:{tipo_ato_token:P.query.tipo_ato_token}},"$X6FDd5A6WK")),u=await u,p(),u);R.value=L.value;const s=async()=>{const{data:i}=await y(`${w}/${V.imovel_id}`,{method:"GET"},"$Dyv7lSgcqT"),m=(_=>_.map(o=>({...o,pessoa:{...o.pessoa,documento:o.pessoa.doc_identificacao},papel:{...o.partes_tipos}})))(i.value);j.value=m};s();const W=async()=>{await s()},{data:le,status:X}=([u,p]=h(()=>y(M,{method:"POST",body:{ato_token:P.query.ato_token_edit}},"$Ir36YwSBFY")),u=await u,p(),u);H.value=le.value;const ae=async()=>{const i={pessoa:f.pessoa,papel:R.value.find(_=>_.id===f.papeis),percentual:f.percentual},{data:e,status:m}=await y(N,{method:"POST",body:{bem_id:V.imovel_id,ato_id:Number(P.query.ato_id),pessoa_id:f.pessoa.pessoa_id,tipo_parte_id:f.papeis,user_id:Z("user-data").value.usuario_id,percentual:f.percentual}},"$z4QOGPyvCc");m.value==="success"&&(i.id=e.value.id,C.success("Pessoa Registrada com Sucesso!"),j.value.push(i))},oe=async i=>{var Q;if(U.value=!0,z.value=null,!i.pessoa.id)return;const{data:e}=await y(A,{method:"POST",body:{tipo:"ficha",id:i.pessoa.id}},"$XYnqHmowsR");if(!((Q=e.value)!=null&&Q.link))return;const{data:m}=await y(ee,{method:"POST",body:{bucket:"qvgjz",path:e.value.link}},"$63DgHOk5hC"),_=e.value.link,o=m.value;/\.(tr7|tiff)$/i.test(_)?z.value=o:fotoRender.value=`data:image/jpeg;base64,${o}`},te=i=>{D.value=!0,F.value=i.id,E.value=i.pessoa.nome};async function se(i){i.excluido=!i.excluido;try{await y(`${pessoasUpdate}/${i.id}`,{method:"PUT",body:JSON.stringify({excluido:i.excluido})},"$3fKfAn4Pra")}catch(e){console.error("Erro ao excluir pessoa:",e)}}const ie=()=>{$("close-modal")};return(i,e)=>{const m=ve,_=Te,o=ze,Q=Be,xe=Ve;return x(),T(ue,null,{default:t(()=>[l(k,null,{default:t(()=>[l(n,{class:"mt-6",cols:"4"},{default:t(()=>[l(I,{label:"Selecione a Pessoa",modelValue:a(f).pessoa,"onUpdate:modelValue":e[0]||(e[0]=v=>a(f).pessoa=v),items:a(H),"item-title":"pessoa_nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),l(n,{class:"mt-6",cols:"3"},{default:t(()=>[l(I,{label:"Papel",modelValue:a(f).papeis,"onUpdate:modelValue":e[1]||(e[1]=v=>a(f).papeis=v),items:a(R),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"1"},{default:t(()=>[e[7]||(e[7]=b("label",null,"%",-1)),l(m,{modelValue:a(f).percentual,"onUpdate:modelValue":e[2]||(e[2]=v=>a(f).percentual=v)},null,8,["modelValue"])]),_:1}),b("div",null,[b("img",{class:"mt-7",src:Oe,style:{width:"40px",cursor:"pointer"},title:"Criar Imovel",onClick:ae})])]),_:1}),l(k,null,{default:t(()=>[l(n,null,{default:t(()=>[l(Re,{style:{height:"385px"},headers:K,items:a(j)},{"item.actions":t(({item:v})=>[l(k,null,{default:t(()=>[b("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:de=>oe(v),title:"Visualizar Ficha"},e[8]||(e[8]=[b("img",{style:{width:"30px",height:"30px"},src:Se,alt:"Visualizar"},null,-1)]),8,Fe),b("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:de=>te(v),class:"mr-2",title:"Alterar Papel"},e[9]||(e[9]=[b("img",{style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar"},null,-1)]),8,Le),b("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:de=>se(v),title:"Deletar Pessoa"},[v.excluido?(x(),re("img",Ge)):(x(),re("img",Ye))],8,He)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),l(_,{show:a(G),onClose:e[3]||(e[3]=v=>G.value=!1)},null,8,["show"]),l(o,{representante_nome:a(E),ato_token:a(Y),ato_id:a(F),show:a(D),onClose:e[4]||(e[4]=v=>D.value=!1),onUpdatePapel:W},null,8,["representante_nome","ato_token","ato_id","show"]),l($e,{modelValue:a(U),"onUpdate:modelValue":e[6]||(e[6]=v=>J(U)?U.value=v:null),width:"600"},{default:t(()=>[l(ke,{"max-width":"600",title:"Ficha"},{default:t(()=>[l(Q,{"tiff-url":a(z)},null,8,["tiff-url"]),l(O,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:e[5]||(e[5]=v=>U.value=!1)})]),_:1})]),_:1},8,["modelValue"]),l(k,{class:"mt-5"},{default:t(()=>[l(xe,{onClick:ie},{default:t(()=>[l(O,{size:"large",color:"red"},{default:t(()=>e[10]||(e[10]=[B("Voltar")])),_:1})]),_:1}),l(O,{class:"ml-5",size:"large",color:"green"},{default:t(()=>e[11]||(e[11]=[B("Salvar")])),_:1})]),_:1})]),_:1})}}},ml={__name:"Cadastro",props:{show:Boolean},emits:["close"],setup(q,{emit:S}){const u=q,p=r("dados"),V=r(u.show),$=r(!1),P=S;Ie(()=>u.show,M=>{V.value=M});const d=()=>{$.value=!0},C=()=>{V.value=!1,$.value=!1,P("close")};return(M,c)=>{const A=Ee,N=Ke;return x(),T($e,{persistent:"",modelValue:a(V),"onUpdate:modelValue":c[2]||(c[2]=w=>J(V)?V.value=w:null),"max-width":"1000"},{default:t(()=>[l(ke,null,{default:t(()=>[l(ue,null,{default:t(()=>[c[5]||(c[5]=b("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Cadastro de imoveis ",-1)),l(qe,{modelValue:a(p),"onUpdate:modelValue":c[0]||(c[0]=w=>J(p)?p.value=w:null),"bg-color":"#f5f2f2"},{default:t(()=>[l(_e,{value:"dados"},{default:t(()=>c[3]||(c[3]=[B("Dados")])),_:1}),a($)?(x(),T(_e,{key:0,value:"partes"},{default:t(()=>c[4]||(c[4]=[B("Partes")])),_:1})):ce("",!0)]),_:1},8,["modelValue"]),l(Me,{modelValue:a(p),"onUpdate:modelValue":c[1]||(c[1]=w=>J(p)?p.value=w:null)},{default:t(()=>[l(fe,{value:"dados"},{default:t(()=>[l(A,{onSaved:d,onCloseModal:C})]),_:1}),l(fe,{value:"partes"},{default:t(()=>[a($)?(x(),T(N,{key:0,onCloseModal:C})):ce("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{Ee as _,Ke as a,ml as b};
