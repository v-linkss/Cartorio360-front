import{r as f,E as D,p as h,c as $,s as l,C as L,J as N,b as t,w as r,F as T,A as B,m as E,o as _,O as F,V as p,z as O,d as y,v as P,t as R}from"./BtwXmbeX.js";import{u as V}from"./ClCFrOgm.js";import{f as U}from"./B0IxRygJ.js";import{V as A}from"./BztfSrD5.js";import{V as J}from"./CTZl9IIL.js";import{V as n}from"./CV0JjIny.js";import{V as j}from"./CuRmUW84.js";import{b as Y}from"./COegO6Kb.js";import"./05UC-GQp.js";import"./Ds7BxfkJ.js";import"./B_waI5bR.js";const se={__name:"index",setup(G){const c=B(),b=`${c.public.managemant}/lista_selos_transmitir`,g=`${c.public.managemant}/integra_selos`,C=`${c.public.ws}/enviar_ato`,u=f([]),v=f([]),d=f(!1),a=D({data_utilizacao:"",descricao:"",numero:""}),w=[{title:"Data",value:"data_utilizacao"},{title:"Descrição",value:"descricao"},{title:"Número",value:"numero"}],S=async()=>{d.value=!0;try{const{data:s,error:e,status:o}=await V(b,{method:"POST",body:{cartorio_token:E("user-data").value.cartorio_token}},"$Xe0bfknJZY");o.value==="success"?v.value=Array.isArray(s.value)?s.value.map(i=>({...i,data_utilizacao:i.data_utilizacao?U(i.data_utilizacao,"dd/mm/yyyy hh:mm"):null})):[]:console.error(e)}catch(s){console.error("Erro ao buscar selos:",s)}finally{d.value=!1}},k=async()=>{const s=u.value.map(m=>({selo_token:m})),{data:e,error:o,status:i}=await V(g,{method:"POST",body:s},"$Bhrd8mFcH5");if(i.value==="success"){const m=e.value,{data:H,error:M,status:x}=await V(C,{method:"POST",body:{user:"41140940406",pass:"RP6DEN",xmlData:m}},"$QOGY8cy73o");x.value==="success"&&($toast.success("Selos enviados com sucesso"),closeModal())}},z=h(()=>v.value.filter(s=>(!a.data_utilizacao||s.data_utilizacao.toLowerCase().includes(a.data_utilizacao.toLowerCase()))&&(!a.numero||s.numero.toLowerCase().includes(a.numero.toLowerCase()))&&(!a.descricao||s.descricao.toLowerCase().includes(a.descricao.toLowerCase()))));return S(),(s,e)=>(_(),$(T,null,[l(d)?(_(),L(F,{key:0,class:"d-flex justify-center align-center",indeterminate:"",size:"64",style:{position:"absolute",top:"40%",left:"50%"}})):N("",!0),t(A,{class:"mt-5"},{default:r(()=>[t(J,{class:"d-flex align-center"},{default:r(()=>[t(n,{cols:"12",md:"2"},{default:r(()=>[t(p,{modelValue:l(a).data_utilizacao,"onUpdate:modelValue":e[0]||(e[0]=o=>l(a).data_utilizacao=o),label:"Data",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",md:"3"},{default:r(()=>[t(p,{modelValue:l(a).descricao,"onUpdate:modelValue":e[1]||(e[1]=o=>l(a).descricao=o),label:"Descrição",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",md:"2"},{default:r(()=>[t(p,{modelValue:l(a).numero,"onUpdate:modelValue":e[2]||(e[2]=o=>l(a).numero=o),label:"Número",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",md:"5",class:"d-flex justify-end mb-2"},{default:r(()=>[t(O,{color:"green",size:"large",onClick:k},{default:r(()=>e[4]||(e[4]=[y("Enviar Selos")])),_:1})]),_:1})]),_:1}),t(j,{"show-select":"",density:"compact",headers:w,items:l(z),"item-key":"token","item-value":"token",modelValue:l(u),"onUpdate:modelValue":e[3]||(e[3]=o=>P(u)?u.value=o:null)},{"item.situacao":r(({item:o})=>[t(Y,{color:"green","text-color":"white",outlined:""},{default:r(()=>[y(R(o.situacao),1)]),_:2},1024)]),_:1},8,["items","modelValue"])]),_:1})],64))}};export{se as default};
