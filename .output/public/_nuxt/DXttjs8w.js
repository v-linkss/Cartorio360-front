import{_ as pe}from"./B7QldEpv.js";import{d as fe,e as _e,f as ve,g as Ve,h as be,i as Ce}from"./CCfGpZpV.js";import{_ as ye}from"./B8Oe3uQX.js";import{_ as ge,r as c,D as ke,u as Ie,K as xe,e as N,f as W,l as Pe,m as Ue,h as v,w as l,k as Ae,o as m,b as a,a as T,t as L,i as o,c as q,N as Fe,j as K,d as p,p as A,q as I,s as u,V as H}from"./BhgTmegS.js";import{$ as x,f as Re}from"./DNE-4qjk.js";import{f as Q,a as $e}from"./B0IxRygJ.js";import"./Dqy4Ahfy.js";import{u as De}from"./DYuPSs8K.js";import{V as w}from"./C7YQzpYh.js";import{V}from"./pKYlzCyR.js";import{V as F}from"./f21YSkhV.js";import{a as Se,V as C,b as Ee,c as y}from"./DWqwaPvM.js";import{V as r}from"./lvjsHrIc.js";import{V as Ne}from"./BSV5nnzr.js";import{V as Te}from"./DcVgSMIA.js";import"./C_vKVtg6.js";import"./CmttJgeJ.js";import"./BVz1G1IN.js";import"./DDW4i_2P.js";import"./DJvq3mCv.js";import"./B-pP4Jp6.js";import"./DLfaHWxR.js";import"./icIJ6WSX.js";import"./DkPnCiyC.js";import"./TDtrdbi3.js";import"./B53VSgPY.js";import"./D4BzWD0g.js";import"./BXmdzU3V.js";import"./Bf-9yseb.js";import"./DKrkSrzu.js";import"./UDNNvlic.js";import"./CcJiivin.js";import"./xF2-nV_b.js";const we={style:{color:"#525050",padding:"10px 0px 0px 30px"}},Be={style:{color:"#525050",padding:"25px 0px 0px 20px"}},Me={style:{"background-color":"#f5f2f2",padding:"20px 0px 20px 20px"}},ze={key:0,class:"d-flex justify-center"},Je={key:1},je={__name:"[id]",emits:["saved"],setup(Ge,{emit:Oe}){const b=c(null),X=ke(),{$toast:P}=Ie(),Y=xe(),{id:U}=Y.params,f=Ae(),Z=`${f.public.auth}/service/gerencia/updatePessoa`,h=`${f.public.auth}/service/gerencia/listarEstadoCivil`,ee=`${f.public.auth}/service/gerencia/listarCapacidadeCivil`,ae=`${f.public.auth}/service/gerencia/listarCidades`,oe=`${f.public.auth}/service/gerencia/getPessoaById`,le=`${f.public.auth}/service/gerencia/listarSexo`,te=`${f.public.managemant}/validarCpf`,B=c([]),M=c([]),z=c([]),J=c([]),R=c(!0),j=c(null),G=c(null);let $=!1;const O={nome:null,nome_pai:null,nome_mae:null,profissao:null,fone_celular:null,data_nascimento:null,doc_identificacao:null,cpf_pai:null,cpf_mae:null,tipo_pessoa:"FISICA",tabvalores_estadocivil_id:null,tabvalores_capacidadecivil_id:null,cidade_nascimento_id:null,tabvalores_sexo_id:null,cartorio_id:N("user-data").value.cartorio_id,user_id:N("user-data").value.usuario_id},se=[{label:"FÍSICA",value:"FISICA"},{label:"JURÍDICA",value:"JURIDICA"},{label:"ESTRANGEIRA",value:"ESTRANGEIRA"}],t=W({...O}),D=W({...O});function S(i){if(i)return i.replace(/[.\-]/g,"");i=null}async function ie(){try{const[i,e,n,d,_]=await Promise.all([x(h),x(ee),x(ae),x(`${oe}/${U}`),x(le)]),g=N("pessoa_token");g.value=d.token,B.value=i,M.value=e,z.value=n,J.value=_,(d.data_nascimento||d.created)&&(d.data_nascimento=d.data_nascimento?Q(d.data_nascimento,"dd/mm/yyyy"):null,d.created=d.created?Q(d.created,"dd/mm/yyyy"):null),G.value=d.created,j.value=d.link_ficha,Object.assign(D,d),Object.assign(t,d)}catch(i){console.error("Erro ao carregar os dados da pessoa:",i)}finally{R.value=!1}}Pe(()=>{U?ie():R.value=!1});function de(i){const e={};for(const n in i)switch(n){case"doc_identificacao":case"cpf_pai":case"cpf_mae":e[n]=S(i[n]);break;case"data_nascimento":e[n]=$e(i[n]);break;case"fone_celular":e[n]=i[n]?i[n].replace(/[^0-9]/g,""):null;break;default:e[n]=i[n]===""?null:i[n];break}return e}async function ne(){const i=de(t),e={};for(const d in i)i[d]!==D[d]&&(e[d]=i[d]);const{status:n}=await Re(`${Z}/${U}`,{method:"PUT",body:e});n.value==="success"?(P.success("Pessoa atualizada com sucesso!"),X.push("/pessoas/lista")):P.error("Erro ao atualizar pessoa.")}async function re(i){const e=S(i),n=S(D.doc_identificacao);if(e.length===11&&!$&&e!==n){$=!0;const d={cpf:e};try{const{data:_,error:g,status:E}=await De(te,{method:"POST",body:d},"$NdF8Uiv290");if(E.value==="error"&&g.value.statusCode===500){P.error(" o CPF já está cadastrado.");return}_.value.cpfValidation&&P.error("Já existe uma pessoa cadastrada com o CPF digitado.")}catch(_){console.error("Erro ao validar CPF:",_)}finally{$=!1}}}return(i,e)=>{const n=pe,d=fe,_=ye,g=_e,E=ve,ue=Ve,me=be,ce=Ce,k=Ue("mask");return m(),v(w,null,{default:l(()=>[a(Te,{width:"1300"},{default:l(()=>[a(V,{style:{"background-color":"#f5f2f2"}},{default:l(()=>[T("h1",we,L(o(U)?"Atualização de Pessoas":"Cadastramento de Pessoas"),1),T("h3",Be," Cadastrado em "+L(o(G)),1)]),_:1}),T("div",Me,[a(F,{modelValue:o(t).tipo_pessoa,"onUpdate:modelValue":e[0]||(e[0]=s=>o(t).tipo_pessoa=s),style:{width:"200px"},items:se,"item-title":"label","item-value":"value",label:"Tipo de pessoa","bg-color":"#F6F6F6",disabled:""},null,8,["modelValue"])]),o(R)?(m(),q("div",ze,[a(Fe,{indeterminate:"",class:"loading-spinner",size:"64"})])):(m(),q("div",Je,[a(Se,{modelValue:o(b),"onUpdate:modelValue":e[1]||(e[1]=s=>K(b)?b.value=s:null),"bg-color":"#f5f2f2"},{default:l(()=>[a(C,{value:"dados"},{default:l(()=>e[19]||(e[19]=[p("Dados")])),_:1}),o(t).tipo_pessoa==="FISICA"||o(t).tipo_pessoa==="ESTRANGEIRA"?(m(),v(C,{key:0,value:"documento"},{default:l(()=>e[20]||(e[20]=[p("Documentos")])),_:1})):A("",!0),o(t).tipo_pessoa==="JURIDICA"?(m(),v(C,{key:1,value:"representante"},{default:l(()=>e[21]||(e[21]=[p("Representantes")])),_:1})):A("",!0),a(C,{value:"endereco"},{default:l(()=>e[22]||(e[22]=[p("Endereços")])),_:1}),o(t).tipo_pessoa==="FISICA"||o(t).tipo_pessoa==="ESTRANGEIRA"?(m(),v(C,{key:2,value:"biometria"},{default:l(()=>e[23]||(e[23]=[p("Biometria")])),_:1})):A("",!0),a(C,{value:"restricao"},{default:l(()=>e[24]||(e[24]=[p("Restrições")])),_:1})]),_:1},8,["modelValue"]),a(Ee,{modelValue:o(b),"onUpdate:modelValue":e[18]||(e[18]=s=>K(b)?b.value=s:null)},{default:l(()=>[a(y,{value:"dados"},{default:l(()=>[o(t).tipo_pessoa==="FISICA"?(m(),v(w,{key:0},{default:l(()=>[a(V,null,{default:l(()=>[a(r,{cols:"12",md:"4"},{default:l(()=>[I(a(u,{modelValue:o(t).doc_identificacao,"onUpdate:modelValue":e[2]||(e[2]=s=>o(t).doc_identificacao=s),label:"CPF",onBlur:e[3]||(e[3]=s=>re(o(t).doc_identificacao))},null,8,["modelValue"]),[[k,"###.###.###-##"]])]),_:1}),a(r,{cols:"12",md:"6"},{default:l(()=>[a(u,{modelValue:o(t).nome,"onUpdate:modelValue":e[4]||(e[4]=s=>o(t).nome=s),label:"Nome"},null,8,["modelValue"])]),_:1}),a(r,{md:"2"},{default:l(()=>[a(Ne,{label:"Sexo",modelValue:o(t).tabvalores_sexo_id,"onUpdate:modelValue":e[5]||(e[5]=s=>o(t).tabvalores_sexo_id=s),items:o(J),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),a(V,null,{default:l(()=>[a(r,{cols:"12",md:"4"},{default:l(()=>[a(F,{modelValue:o(t).tabvalores_estadocivil_id,"onUpdate:modelValue":e[6]||(e[6]=s=>o(t).tabvalores_estadocivil_id=s),items:o(B),"item-title":"descricao","item-value":"id",label:"Estado Civil"},null,8,["modelValue","items"])]),_:1}),a(r,{cols:"12",md:"4"},{default:l(()=>[a(u,{modelValue:o(t).profissao,"onUpdate:modelValue":e[7]||(e[7]=s=>o(t).profissao=s),label:"Profissão"},null,8,["modelValue"])]),_:1}),a(r,{cols:"12",md:"4"},{default:l(()=>[a(u,{modelValue:o(t).local_trabalho,"onUpdate:modelValue":e[8]||(e[8]=s=>o(t).local_trabalho=s),label:"Local de trabalho"},null,8,["modelValue"])]),_:1})]),_:1}),a(V,null,{default:l(()=>[a(r,{cols:"12",md:"2"},{default:l(()=>[I(a(u,{modelValue:o(t).data_nascimento,"onUpdate:modelValue":e[9]||(e[9]=s=>o(t).data_nascimento=s),label:"Data de nascimento",placeholder:"dd/mm/yyyy"},null,8,["modelValue"]),[[k,"##/##/####"]])]),_:1}),a(r,{cols:"12",md:"2"},{default:l(()=>[I(a(u,{modelValue:o(t).fone_celular,"onUpdate:modelValue":e[10]||(e[10]=s=>o(t).fone_celular=s),label:"Celular",placeholder:"'(99) 99999-9999'"},null,8,["modelValue"]),[[k,"(##) #####-####"]])]),_:1}),a(r,{cols:"12",md:"4"},{default:l(()=>[a(F,{modelValue:o(t).tabvalores_capacidadecivil_id,"onUpdate:modelValue":e[11]||(e[11]=s=>o(t).tabvalores_capacidadecivil_id=s),items:o(M),label:"Capacidade Civil","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),a(r,{cols:"12",md:"4"},{default:l(()=>[a(F,{modelValue:o(t).cidade_nascimento_id,"onUpdate:modelValue":e[12]||(e[12]=s=>o(t).cidade_nascimento_id=s),items:o(z),label:"Cidade de nascimento","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),a(V,null,{default:l(()=>[a(r,{cols:"12",md:"4"},{default:l(()=>[I(a(u,{modelValue:o(t).cpf_pai,"onUpdate:modelValue":e[13]||(e[13]=s=>o(t).cpf_pai=s),modelModifiers:{date:!0},label:"CPF do Pai"},null,8,["modelValue"]),[[k,"###.###.###-##"]])]),_:1}),a(r,{cols:"12",md:"4"},{default:l(()=>[a(u,{modelValue:o(t).nome_pai,"onUpdate:modelValue":e[14]||(e[14]=s=>o(t).nome_pai=s),modelModifiers:{date:!0},label:"Nome do Pai"},null,8,["modelValue"])]),_:1})]),_:1}),a(V,null,{default:l(()=>[a(r,{cols:"12",md:"4"},{default:l(()=>[I(a(u,{modelValue:o(t).cpf_mae,"onUpdate:modelValue":e[15]||(e[15]=s=>o(t).cpf_mae=s),modelModifiers:{date:!0},label:"CPF da Mãe"},null,8,["modelValue"]),[[k,"###.###.###-##"]])]),_:1}),a(r,{cols:"12",md:"4"},{default:l(()=>[a(u,{modelValue:o(t).nome_mae,"onUpdate:modelValue":e[16]||(e[16]=s=>o(t).nome_mae=s),modelModifiers:{date:!0},label:"Nome da Mãe"},null,8,["modelValue"])]),_:1})]),_:1}),a(V,{class:"mb-3"},{default:l(()=>[a(n,{to:"/pessoas/lista"},{default:l(()=>[a(H,{size:"large",color:"red"},{default:l(()=>e[25]||(e[25]=[p("Voltar")])),_:1})]),_:1}),a(H,{onClick:e[17]||(e[17]=s=>ne()),class:"ml-4",size:"large",color:"green"},{default:l(()=>e[26]||(e[26]=[p("Salvar")])),_:1})]),_:1})]),_:1})):o(t).tipo_pessoa==="JURIDICA"?(m(),v(d,{key:1})):o(t).tipo_pessoa==="ESTRANGEIRA"?(m(),v(_,{key:2})):A("",!0)]),_:1}),a(y,{value:"documento"},{default:l(()=>[a(g)]),_:1}),a(y,{value:"representante"},{default:l(()=>[a(E)]),_:1}),a(y,{value:"endereco"},{default:l(()=>[a(ue)]),_:1}),a(y,{value:"biometria"},{default:l(()=>[a(w,{class:"mt-5"},{default:l(()=>[a(me,{"link-ficha":o(j)},null,8,["link-ficha"])]),_:1})]),_:1}),a(y,{value:"restricao"},{default:l(()=>[a(ce)]),_:1})]),_:1},8,["modelValue"])]))]),_:1})]),_:1})}}},Ia=ge(je,[["__scopeId","data-v-ec53f22f"]]);export{Ia as default};
