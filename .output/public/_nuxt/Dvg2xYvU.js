import{_ as oe}from"./BctZgZx-.js";import{a as ae,_ as re}from"./CzIfMk3v.js";import{_ as se}from"./DJMl3DUr.js";import{_ as ne}from"./BVz1G1IN.js";import{_ as le}from"./rq1FF7Er.js";import{_ as ie}from"./CP1ABfly.js";import{_ as ue}from"./CQ1hBUQ-.js";import{c as z,r as B,u as pe}from"./D9lSe22M.js";import{u as de}from"./k-_mmYeu.js";import{u as me,P as ce,L as _e,r as u,m as g,n as fe,G as I,z as ve,p as b,w as l,v as ge,o as h,b as s,a as n,t as ke,q as o,B as Ve,C as w,E as C,D as $e,V as xe,d as ye}from"./B2VtM2rW.js";import{u as O}from"./CHCsbJ5v.js";import{f as be}from"./BB7DuAK_.js";import{V as he}from"./SaEGSYn3.js";import{V as k}from"./CKJp8KVK.js";import{V}from"./BWDM5pjC.js";import{V as we}from"./CtpVxkyR.js";import{V as Ce}from"./DRPx7C5b.js";import"./LHNS4Z4N.js";import"./BeJLNKl7.js";import"./C5kxU3lb.js";import"./Cd2jDOOI.js";import"./_BT7bE8n.js";import"./ofnURvvQ.js";import"./Dv6nqkSV.js";import"./BcGgCMWD.js";const Oe={style:{color:"red","margin-left":"30px"}},Te=["onClick"],Re=["onClick"],Ae=["onClick","title"],Ue=["onClick"],ze=["title"],st={__name:"[id]",async setup(Be){let i,c;const{redirectTo:T}=de(),{$toast:R}=me(),S=ce(),{id:d}=S.params,E=_e(),_=ge(),P=`${_.public.managemant}/updateOrdensServico`,D=`${_.public.managemant}/getOrdensServicoById`,N=`${_.public.managemant}/listarAtos`,q=`${_.public.managemant}/updateAtos`,F=u(g("user-data").value.cartorio_id),M=u(g("user-data").value.usuario_id),G=u(g("user-service").value.token).value||null,L=u(g("user-data").value.cartorio_token).value,$=u([]),x=u(!1),A=u(null),m=u(null),r=fe({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),K=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],W=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],X={apresentante_nome:{required:z.withMessage("O campo é obrigatorio",B)},apresentante_cpf:{required:z.withMessage("O campo é obrigatorio",B)}},p=pe(X,r);function Y(a){if(a)return a.replace(/[.\-]/g,"");a=null}const Z=a=>{A.value=a,x.value=!0},j=a=>{T({item:a,id:d,numeroOs:m.value,origem:"vizualizar"})},H=a=>{T({item:a,id:d,numeroOs:m.value,origem:"atualizar"})};async function J(){const a={apresentante_cpf:Y(r.apresentante_cpf),apresentante_nome:r.apresentante_nome,user_id:M.value,cartorio_id:F.value},{error:t,status:v}=await O(`${P}/${d}`,{method:"PUT",body:a},"$Fud06ay483");v.value==="error"&&t.value.statusCode===500?R.error("Erro ao cadastrar ordem,erro no sistema."):(R.success("Ordem Atualizada com sucesso!"),E.push({path:"/os/lista"}))}const{data:f}=([i,c]=I(()=>O(`${D}/${d}`,{method:"GET"},"$wPUkUpDvPf")),i=await i,c(),i);m.value=f.value.numero,r.nacionalidade=f.value.estrangeiro,r.apresentante_cpf=f.value.apresentante_cpf,r.apresentante_nome=f.value.apresentante_nome;const{data:U}=([i,c]=I(()=>O(N,{method:"POST",body:{cartorio_token:L,ordemserv_token:G}},"$YXZ55K3IUf")),i=await i,c(),i);async function Q(a){a.excluido=!a.excluido;try{await be(`${q}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(t){console.error("Erro ao excluir pessoa:",t)}}return U.value.length>0?$.value=U.value:$.value=[],(a,t)=>{const v=oe,ee=re,te=ve("mask");return h(),b(he,{class:"mt-5"},{default:l(()=>[s(k,{class:"mb-5"},{default:l(()=>[t[6]||(t[6]=n("h1",null,"Ordem de Serviço nº",-1)),n("h1",Oe,ke(o(m)),1)]),_:1}),s(k,null,{default:l(()=>[s(V,{md:"3"},{default:l(()=>[s(we,{label:"Nacionalidade",items:W,modelValue:o(r).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>o(r).nacionalidade=e)},null,8,["modelValue"])]),_:1}),s(V,{md:"2"},{default:l(()=>[o(r).nacionalidade==="brasileiro"?Ve((h(),b(w,{key:0,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>o(r).apresentante_cpf=e),label:"CPF",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch,onInput:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[te,"###.###.###-##"]]):(h(),b(w,{key:1,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>o(r).apresentante_cpf=e),label:"Documento",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),s(V,{md:"4"},{default:l(()=>[s(w,{modelValue:o(r).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>o(r).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":o(p).apresentante_nome.$errors.map(e=>e.$message),onInput:o(p).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),s(V,null,{default:l(()=>[n("div",null,[n("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:se,alt:"Salvar",onClick:t[4]||(t[4]=e=>J())})])]),_:1})]),_:1}),s(k,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:l(()=>[t[10]||(t[10]=n("h1",{class:"ml-5"},"Atos",-1)),s(v,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:o(d),numeroOs:o(m)}}},{default:l(()=>t[7]||(t[7]=[n("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:ne,alt:"novo"},null,-1)])),_:1},8,["to"]),s(Ce,{headers:K,items:o($),"item-key":"id"},{"item.actions":l(({item:e})=>[s(k,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:l(()=>[n("div",{onClick:y=>j(e),title:"Visualizar"},t[8]||(t[8]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:le,alt:"Visualizar"},null,-1)]),8,Te),n("div",{onClick:y=>Z(e.token),title:"Reimprimir"},t[9]||(t[9]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ae,alt:"Reimprimir"},null,-1)]),8,Re),n("div",{class:$e({disabled:!e.btn_editar}),onClick:y=>e.btn_editar?H({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,rota:e.rota}):null,title:e.btn_editar?"Editar":"Desabilitado"},[n("img",{style:C({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ie,alt:"Editar"},null,4)],10,Ae),n("div",{onClick:y=>e.btn_cancelar?Q(e):null,title:"Excluir",style:C({cursor:e.btn_cancelar?"pointer":"not-allowed"})},[n("img",{style:C({width:"30px",height:"30px",cursor:e.btn_cancelar?"pointer":"not-allowed",opacity:e.btn_cancelar?"1":"0.5"}),src:ue,alt:"Cancelar",title:e.btn_cancelar?"Cancelar":"Não permitido"},null,12,ze)],12,Ue)]),_:2},1024)]),_:1},8,["items"]),s(ee,{show:o(x),ato_token:o(A),onClose:t[5]||(t[5]=e=>x.value=!1)},null,8,["show","ato_token"])]),_:1}),s(v,{to:"/os/lista"},{default:l(()=>[s(xe,{size:"large",color:"red"},{default:l(()=>t[11]||(t[11]=[ye("Voltar")])),_:1})]),_:1})]),_:1})}}};export{st as default};
