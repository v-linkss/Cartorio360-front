import{r as f,E as h,p as $,c as L,s as l,C as N,J as T,b as t,w as r,F as B,A as E,m as F,o as y,O,V as p,z as P,d as V,v as R,t as b}from"./qheerGNG.js";import{u as v}from"./CoczidDA.js";import{f as U}from"./B0IxRygJ.js";import{V as A}from"./cAyW47ab.js";import{V as J}from"./B5KVOyE5.js";import{V as n}from"./CKSFl6j_.js";import{V as j}from"./DP0qnU88.js";import{b as Y}from"./JAMpRLbl.js";import"./CW3LpxPk.js";import"./BwrWOjco.js";import"./DMtkWOXB.js";const se={__name:"index",setup(G){const c=E(),g=`${c.public.managemant}/lista_selos_transmitir`,C=`${c.public.managemant}/integra_selos`,w=`${c.public.ws}/enviar_ato`,i=f([]),_=f([]),d=f(!1),a=h({data_utilizacao:"",descricao:"",numero:""}),S=[{title:"Data",value:"data_utilizacao"},{title:"Descrição",value:"descricao"},{title:"Número",value:"numero"}],k=async()=>{d.value=!0;try{const{data:s,error:e,status:o}=await v(g,{method:"POST",body:{cartorio_token:F("user-data").value.cartorio_token}},"$Xe0bfknJZY");o.value==="success"?_.value=Array.isArray(s.value)?s.value.map(u=>({...u,data_utilizacao:u.data_utilizacao?U(u.data_utilizacao,"dd/mm/yyyy hh:mm"):null})):[]:console.error(e)}catch(s){console.error("Erro ao buscar selos:",s)}finally{d.value=!1}},z=async()=>{const s=i.value.map(m=>({selo_token:m})),{data:e,error:o,status:u}=await v(C,{method:"POST",body:s},"$Bhrd8mFcH5");if(u.value==="success"){const m=e.value,{data:H,error:M,status:D}=await v(w,{method:"POST",body:{user:"41140940406",pass:"RP6DEN",xmlData:m}},"$QOGY8cy73o");D.value==="success"&&($toast.success("Selos enviados com sucesso"),closeModal())}},x=$(()=>_.value.filter(s=>(!a.data_utilizacao||s.data_utilizacao.toLowerCase().includes(a.data_utilizacao.toLowerCase()))&&(!a.numero||s.numero.toLowerCase().includes(a.numero.toLowerCase()))&&(!a.descricao||s.descricao.toLowerCase().includes(a.descricao.toLowerCase()))));return k(),(s,e)=>(y(),L(B,null,[l(d)?(y(),N(O,{key:0,class:"d-flex justify-center align-center",indeterminate:"",size:"64",style:{position:"absolute",top:"40%",left:"50%"}})):T("",!0),t(A,{class:"mt-5"},{default:r(()=>[t(J,{class:"d-flex align-center"},{default:r(()=>[t(n,{cols:"12",md:"2"},{default:r(()=>[t(p,{modelValue:l(a).data_utilizacao,"onUpdate:modelValue":e[0]||(e[0]=o=>l(a).data_utilizacao=o),label:"Data",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",md:"3"},{default:r(()=>[t(p,{modelValue:l(a).descricao,"onUpdate:modelValue":e[1]||(e[1]=o=>l(a).descricao=o),label:"Descrição",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",md:"2"},{default:r(()=>[t(p,{modelValue:l(a).numero,"onUpdate:modelValue":e[2]||(e[2]=o=>l(a).numero=o),label:"Número",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",md:"5",class:"d-flex justify-end mb-2"},{default:r(()=>[t(P,{color:"green",size:"large",onClick:z},{default:r(()=>e[4]||(e[4]=[V("Enviar Selos")])),_:1})]),_:1})]),_:1}),t(j,{"show-select":"",density:"compact",headers:S,items:l(x),"item-key":"token","item-value":"token",modelValue:l(i),"onUpdate:modelValue":e[3]||(e[3]=o=>R(i)?i.value=o:null)},{"item.situacao":r(({item:o})=>[t(Y,{color:"green","text-color":"white",outlined:""},{default:r(()=>[V(b(o.situacao),1)]),_:2},1024)]),_:1},8,["items","modelValue"]),V(" "+b(l(i)),1)]),_:1})],64))}};export{se as default};
