import{r as R,n as Z,D as E,F as ee,h as z,G as ae,H as oe,o as b,A as y,w as t,b as a,d as g,q as e,a4 as le,c as te,t as se,C as j,s as u,I as M,y as h,v as L,x as G,V as ie}from"./D4Ul81L2.js";import{a as de,u as H}from"./CAG4ncxV.js";import{c as N,r as q,u as re,V as O}from"./C1BiXLQA.js";import{c as ne}from"./WmS-HKnJ.js";import{a as X,b as J,V as K,c as me}from"./BkUIGpbv.js";import{V as ue}from"./BilO1oej.js";import{V as v}from"./Ccml4xam.js";import{V as d}from"./Cn7GK_Ke.js";const ce={key:1},we={__name:"RegistroPessoas",props:{show:Boolean},emits:["close"],async setup(k,{emit:P}){let c,I;const C=k,r=R(C.show),p=P,{$toast:f}=Z(),_=G(),B=`${_.public.managemant}/createPessoa`,$=`${_.public.managemant}/listarEstadoCivil`,n=`${_.public.managemant}/listarCapacidadeCivil`,w=`${_.public.managemant}/listarCidades`,F={nome:"",nome_pai:"",nome_mae:"",profissao:"",local_trabalho:"",data_nascimento:"",doc_identificacao:"",cpf_pai:"",cpf_mae:"",tipo_pessoa:"FISICA",tabvalores_estadocivil_id:"",tabvalores_capacidadecivil_id:"",cidade_natural_id:"",cartorio_id:E("user-data").value.cartorio_id,user_id:E("user-data").value.usuario_id},s=ee({...F});z(()=>C.show,i=>{r.value=i});const S=()=>{r.value=!1,p("close")};function U(i){if(i)return i.replace(/[.\-]/g,"");i=null}const{data:x,pending:pe,status:A,error:D}=([c,I]=ae(async()=>de("cliente-dados",async()=>{const[i,l,V]=await Promise.all([$fetch($),$fetch(n),$fetch(w)]);return{estadoCivilItems:i,capacidadeCivilItems:l,cidadeNascimentoItems:V}})),c=await c,I(),c),Q={nome:{required:N.withMessage("O campo é obrigatorio",q)},nome_mae:{required:N.withMessage("O campo é obrigatorio",q)},doc_identificacao:{required:N.withMessage("O campo é obrigatorio",q),cpf:ne}},m=re(Q,s);async function W(){if(await m.value.$validate()){const i={...s};for(const T in i)i[T]===""&&(i[T]=null);const l={...i,doc_identificacao:U(s.doc_identificacao),cpf_pai:U(s.cpf_pai),cpf_mae:U(s.cpf_mae)},{data:V,error:o,status:Y}=await H(B,{method:"POST",body:l},"$BiOjXVCR5N");Y.value==="error"&&o.value.statusCode===500?f.error("Erro ao cadastrar pessoa,o CPF já está cadastrado."):(f.success("Pessoa cadastrada com sucesso!"),S())}else f.error("Erro ao cadastrar pessoa, preencha os campos obrigatorios.")}return(i,l)=>{const V=oe("mask");return b(),y(K,{persistent:"",modelValue:e(r),"onUpdate:modelValue":l[13]||(l[13]=o=>L(r)?r.value=o:null),"max-width":"1000"},{default:t(()=>[a(X,null,{default:t(()=>[a(J,{class:"text-h5 mt-3"},{default:t(()=>[g("Criar Pessoa")]),_:1}),e(A)==="pending"?(b(),y(le,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):e(D)?(b(),te("div",ce,se(e(D).message),1)):j("",!0),e(A)==="success"?(b(),y(ue,{key:2,class:"mt-5"},{default:t(()=>[a(v,null,{default:t(()=>[a(d,{cols:"12",md:"8"},{default:t(()=>[a(u,{modelValue:e(s).nome,"onUpdate:modelValue":l[0]||(l[0]=o=>e(s).nome=o),"error-messages":e(m).nome.$errors.map(o=>o.$message),label:"Nome",required:"",onBlur:e(m).nome.$touch,onInput:e(m).nome.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1}),a(d,{cols:"12",md:"4"},{default:t(()=>[M(a(u,{modelValue:e(s).doc_identificacao,"onUpdate:modelValue":l[1]||(l[1]=o=>e(s).doc_identificacao=o),"error-messages":e(m).doc_identificacao.$errors.map(o=>o.$message),label:"CPF",required:"",onBlur:e(m).doc_identificacao.$touch,onInput:e(m).doc_identificacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),[[V,"###.###.###-##"]])]),_:1})]),_:1}),a(v,null,{default:t(()=>[a(d,{cols:"12",md:"4"},{default:t(()=>[a(O,{modelValue:e(s).tabvalores_estadocivil_id,"onUpdate:modelValue":l[2]||(l[2]=o=>e(s).tabvalores_estadocivil_id=o),items:e(x).estadoCivilItems,"item-title":"descricao","item-value":"id",label:"Estado Civil"},null,8,["modelValue","items"])]),_:1}),a(d,{cols:"12",md:"4"},{default:t(()=>[a(u,{modelValue:e(s).profissao,"onUpdate:modelValue":l[3]||(l[3]=o=>e(s).profissao=o),label:"Profissão"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"4"},{default:t(()=>[a(u,{modelValue:e(s).local_trabalho,"onUpdate:modelValue":l[4]||(l[4]=o=>e(s).local_trabalho=o),label:"Local de trabalho"},null,8,["modelValue"])]),_:1})]),_:1}),a(v,null,{default:t(()=>[a(d,{cols:"12",md:"4"},{default:t(()=>[a(u,{modelValue:e(s).data_nascimento,"onUpdate:modelValue":l[5]||(l[5]=o=>e(s).data_nascimento=o),type:"date","prepend-icon":"",label:"Data de nascimento"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12",md:"4"},{default:t(()=>[a(O,{modelValue:e(s).tabvalores_capacidadecivil_id,"onUpdate:modelValue":l[6]||(l[6]=o=>e(s).tabvalores_capacidadecivil_id=o),items:e(x).capacidadeCivilItems,label:"Capacidade Civil","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),a(d,{cols:"12",md:"4"},{default:t(()=>[a(O,{modelValue:e(s).cidade_natural_id,"onUpdate:modelValue":l[7]||(l[7]=o=>e(s).cidade_natural_id=o),items:e(x).cidadeNascimentoItems,label:"Cidade de nascimento","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),a(v,null,{default:t(()=>[a(d,{cols:"12",md:"4"},{default:t(()=>[M(a(u,{modelValue:e(s).cpf_pai,"onUpdate:modelValue":l[8]||(l[8]=o=>e(s).cpf_pai=o),modelModifiers:{date:!0},label:"CPF do Pai"},null,8,["modelValue"]),[[V,"###.###.###-##"]])]),_:1}),a(d,{cols:"12",md:"4"},{default:t(()=>[a(u,{modelValue:e(s).nome_pai,"onUpdate:modelValue":l[9]||(l[9]=o=>e(s).nome_pai=o),modelModifiers:{date:!0},label:"Nome do Pai"},null,8,["modelValue"])]),_:1})]),_:1}),a(v,null,{default:t(()=>[a(d,{cols:"12",md:"4"},{default:t(()=>[M(a(u,{modelValue:e(s).cpf_mae,"onUpdate:modelValue":l[10]||(l[10]=o=>e(s).cpf_mae=o),modelModifiers:{date:!0},label:"CPF da Mãe"},null,8,["modelValue"]),[[V,"###.###.###-##"]])]),_:1}),a(d,{cols:"12",md:"4"},{default:t(()=>[a(u,{modelValue:e(s).nome_mae,"onUpdate:modelValue":l[11]||(l[11]=o=>e(s).nome_mae=o),modelModifiers:{date:!0},"error-messages":e(m).nome_mae.$errors.map(o=>o.$message),label:"Nome da Mãe",required:"",onBlur:e(m).nome_mae.$touch,onInput:e(m).nome_mae.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),a(v,null,{default:t(()=>[a(h,{class:"ml-5",color:"red",size:"large",onClick:S},{default:t(()=>[g("Fechar")]),_:1}),a(h,{class:"ml-5",color:"green",size:"large",onClick:l[12]||(l[12]=o=>W())},{default:t(()=>[g("Salvar")]),_:1})]),_:1})]),_:1})):j("",!0)]),_:1})]),_:1},8,["modelValue"])}}},ye={__name:"FichaCard",props:{show:Boolean,item:Object},emits:["close","confirmar"],setup(k,{emit:P}){const c=k,C=`${G().public.managemant}/getLinkTipo`,r=R(c.show),p=R(),f=P;z(()=>c.show,async n=>{r.value=n,await B()});const _=()=>{f("confirmar"),$()},B=async()=>{try{const{data:n}=await H(`${C}`,{method:"POST",body:{id:c.item.id,tipo:"ficha"}},"$4omB3S9Tg3");n.value&&n.value.link?p.value=`data:image/jpeg;base64,${n.value.link}`:p.value=null}catch(n){console.error("Erro ao buscar a imagem da ficha:",n)}},$=()=>{r.value=!1,p.value=null,f("close")};return(n,w)=>(b(),y(K,{persistent:"",modelValue:e(r),"onUpdate:modelValue":w[0]||(w[0]=F=>L(r)?r.value=F:null),"max-width":"700"},{default:t(()=>[a(X,null,{default:t(()=>[a(J,{class:"text-h5"},{default:t(()=>[g("Ficha de Firma")]),_:1}),a(ie,{src:e(p)},null,8,["src"]),a(me,null,{default:t(()=>[a(h,{style:{"background-color":"#429946",color:"white"},onClick:_},{default:t(()=>[g("Reconhecer")]),_:1}),a(h,{style:{"background-color":"red",color:"white"},onClick:$},{default:t(()=>[g("Voltar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{we as _,ye as a};
