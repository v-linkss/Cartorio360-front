import{_ as z}from"./DXPmIK4w.js";import{r as d,H as A,u as F,E as T,g as U,o as _,c as E,b as o,w as r,a as V,V as v,s as n,z as $,d as h,v as q,F as j,A as N,m as B,p as G,C as P,O as H}from"./BtwXmbeX.js";import{u as D}from"./ClCFrOgm.js";import{V as K,c as J}from"./wmiNdIZM.js";import{V as R}from"./BztfSrD5.js";import{V as I}from"./CTZl9IIL.js";import{V as y}from"./CV0JjIny.js";import{V as W}from"./WJsxTkHB.js";import{_ as Y,a as Z}from"./DJvq3mCv.js";import{f as Q}from"./B0IxRygJ.js";import{V as X}from"./CuRmUW84.js";import"./Ds7BxfkJ.js";import"./B_waI5bR.js";import"./COegO6Kb.js";import"./05UC-GQp.js";const ee={__name:"ImportaSelos",props:{show:Boolean,ato_token:String,ato_id:Number,representante_nome:String},emits:["close","update-papel"],setup(M,{emit:w}){const f=M,i=d(f.show);A();const m=N(),{$toast:C}=F(),e=d(!1),g=d(""),b=`${m.public.ws}/fornecer_selos_por_lote`,x=`${m.public.managemant}/fornecer_selos`;d([]);const t=T({nuLote:null}),s=w;U(()=>f.show,async p=>{i.value=p,p&&await getPapeis()});const c=()=>{i.value=!1,s("close")},a=async()=>{const{data:p,error:l,status:S}=await D(b,{method:"POST",body:{user:"41140940406",pass:"RP6DEN",statusSelo:"D",nuLote:t.nuLote},onResponseError({response:u}){var k;const L=((k=u._data)==null?void 0:k.details)||"Erro ao buscar lote de selos.";g.value=L,e.value=!0,console.error("Erro forneceSeloPorLote:",L)}},"$Z1bKGPif1c");if(S.value==="success"){const u=p.value.selos,{data:L,error:k,status:O}=await D(x,{method:"POST",body:{tipo_id:1,cartorio_id:B("user-data").value.cartorio_id,selos:u,user_id:B("user-data").value.usuario_id}},"$Kr3yBtlYBF");O.value==="success"&&(C.success("Selos importados com sucesso"),c())}};return(p,l)=>{const S=z;return _(),E(j,null,[o(W,{persistent:"",modelValue:n(i),"onUpdate:modelValue":l[1]||(l[1]=u=>q(i)?i.value=u:null),"max-width":"800"},{default:r(()=>[o(K,null,{default:r(()=>[o(R,null,{default:r(()=>[o(I,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:r(()=>[o(y,null,{default:r(()=>l[3]||(l[3]=[V("h1",{class:"ml-4"}," Importar selos do lote ",-1),V("p",{class:"ml-4 mt-3"}," Informe o codigo do lote para realizar a importação ",-1)])),_:1})]),_:1}),l[4]||(l[4]=V("hr",{class:"mb-5"},null,-1)),o(v,{label:"Lote",modelValue:n(t).nuLote,"onUpdate:modelValue":l[0]||(l[0]=u=>n(t).nuLote=u),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),o(J,null,{default:r(()=>[o($,{style:{"background-color":"red",color:"white"},onClick:c},{default:r(()=>l[5]||(l[5]=[h("Voltar")])),_:1}),o($,{style:{"background-color":"green",color:"white"},onClick:a},{default:r(()=>l[6]||(l[6]=[h("Importar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(S,{show:n(e),errorMessage:n(g),onClose:l[2]||(l[2]=u=>e.value=!1)},null,8,["show","errorMessage"])],64)}}},oe={class:"d-flex flex-column"},te=["onClick"],se={key:0,style:{width:"30px",height:"30px"},src:Y,alt:"Visualizar",title:"Reativar"},ae={key:1,src:Z,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},we={__name:"index",setup(M){const w=N(),f=d([]),i=d(!1),m=d(!1),C=`${w.public.managemant}/selos`,e=T({dt_compra:"",numero:"",lote_compra:"",sequencia:"",sigla:""}),g=[{title:"Data de compra",value:"dt_compra"},{title:"Selo",value:"numero"},{title:"Valor de compra",value:"lote_compra"}],b=async()=>{m.value=!0;try{const{data:t,error:s,status:c}=await D(C,{method:"GET"},"$g9WNETx7rH");c.value==="success"?f.value=Array.isArray(t.value)?t.value.map(a=>({...a,dt_compra:a.dt_compra?Q(a.dt_compra,"dd/mm/yyyy"):null})):[]:console.error(s)}catch(t){console.error("Erro ao buscar selos:",t)}finally{m.value=!1}},x=G(()=>f.value.filter(t=>(!e.dt_compra||t.dt_compra.toLowerCase().includes(e.dt_compra.toLowerCase()))&&(!e.numero||t.numero.toLowerCase().includes(e.numero.toLowerCase()))&&(!e.lote_compra||t.lote_compra.toLowerCase().includes(e.lote_compra.toLowerCase()))&&(!e.sequencia||t.sequencia.toLowerCase().includes(e.sequencia.toLowerCase()))&&(!e.sigla||t.sigla.toLowerCase().includes(e.sigla.toLowerCase()))));return b(),(t,s)=>{const c=ee;return n(m)?(_(),P(H,{key:0,class:"d-flex justify-center align-center",indeterminate:"",size:"64",style:{position:"absolute",top:"40%",left:"50%"}})):(_(),P(R,{key:1,class:"mt-5"},{default:r(()=>[V("div",oe,[o($,{class:"mb-10 mt-auto align-self-end",color:"green",size:"large",onClick:s[0]||(s[0]=a=>i.value=!0)},{default:r(()=>s[5]||(s[5]=[h(" Importar Selos TJ ")])),_:1})]),o(I,{class:"mb-4",style:{gap:"10rem"}},{default:r(()=>[o(y,{cols:"12",md:"2"},{default:r(()=>[o(v,{modelValue:n(e).dt_compra,"onUpdate:modelValue":s[1]||(s[1]=a=>n(e).dt_compra=a),label:"Data de Compra","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),o(y,{cols:"12",md:"2"},{default:r(()=>[o(v,{modelValue:n(e).numero,"onUpdate:modelValue":s[2]||(s[2]=a=>n(e).numero=a),label:"Selo","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),o(y,{cols:"12",md:"2"},{default:r(()=>[o(v,{modelValue:n(e).lote_compra,"onUpdate:modelValue":s[3]||(s[3]=a=>n(e).lote_compra=a),label:"Valor de Compra","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),o(X,{density:"compact",headers:g,items:n(x),"item-key":"selo"},{"item.actions":r(({item:a})=>[V("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:p=>t.deleteObservacao(a),title:"Deletar Observação"},[a.excluido?(_(),E("img",se)):(_(),E("img",ae))],8,te)]),_:1},8,["items"]),o(c,{show:n(i),onClose:s[4]||(s[4]=a=>i.value=!1)},null,8,["show"])]),_:1}))}}};export{we as default};
