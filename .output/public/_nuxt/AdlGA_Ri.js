import{_ as P}from"./cuqAgYGY.js";import{_ as q}from"./u3AOJQEl.js";import{_ as M}from"./BOvi4gWp.js";import{_ as O,u as R,r as l,e as v,f as F,c as N,b as o,w as r,a as e,i as n,F as T,k as D,o as E,s as L}from"./D7fmYdMW.js";import{u as f}from"./CSAuF1pc.js";import{f as y}from"./B0IxRygJ.js";import{V as B}from"./DOskrr6j.js";import{V as j}from"./NTwqZpB9.js";import{V as h}from"./xP-MEgnK.js";import{V as x}from"./AFyDiTu_.js";import"./XrDdW6cD.js";import"./ENtLSbV7.js";import"./Dzg5W5CI.js";import"./BGB1f2eI.js";import"./BjdXgUk-.js";import"./DXwAjUZW.js";import"./CXWVFV7j.js";import"./DR4EW3VF.js";import"./DMDLc3Zv.js";import"./CnBVGyc0.js";const z={style:{width:"1300px",margin:"0 auto"}},H={style:{display:"flex",gap:"4px","justify-content":"center"}},I=["disabled","onClick"],U={__name:"index",setup(J){const d=D(),{$toast:c}=R(),g=`${d.public.managemant}/cancela_lavratura`,b=`${d.public.managemant}/pesquisaAtos`,k=l(v("auth_token").value)||null,C=l(v("user-data").value.cartorio_token)||null,m=l([]),i=l(!1),p=l(""),_=l(null),u=F({protocolo:null}),V=[{title:"Protocolo",value:"protocolo"},{title:"Data lavratura/Parte",value:"dt_lavratura"},{title:"Situação/Serviço",key:"situacaoServico",value:t=>t.situacao?`${t.situacao}
${t.ato_servico}`:`${t.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];async function w(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(u));const{data:t}=await f(b,{method:"POST",body:{cartorio_token:C.value,protocolo:u.protocolo||null}},"$xahYxgiURx");t.value.length>0?m.value=t.value.map(a=>({...a,dt_lavratura:a.dt_lavratura?y(a.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:a.dt_abertura?y(a.dt_abertura,"dd/mm/yyyy"):null})):(m.value=[],c.error("Não existe ato Registrado!"))}catch(t){console.error("Erro na requisição",t)}}const $=t=>{_.value=t,p.value="Tem certeza que deseja cancelar este ato?",i.value=!0},S=async()=>{const{data:t,status:a}=await f(g,{method:"POST",body:{ato_token:_.value,user_token:k.value,cancelar_selo:!1}},"$0XhtmZH7s8");a.value==="success"&&t.value[0].status==="OK"?(c.success("Lavratura cancelada com sucesso!"),i.value=!1):t.value[0].status==="ERRO"&&c.error("erro ao cancelar ato")};return(t,a)=>{const A=P;return E(),N(T,null,[o(B,{class:"mt-5"},{default:r(()=>[o(h,{class:"mb-5"},{default:r(()=>a[2]||(a[2]=[e("h1",null,"Cancelamento de Lavratura",-1)])),_:1}),o(h,null,{default:r(()=>[o(x,{cols:"2"},{default:r(()=>[o(L,{modelValue:n(u).protocolo,"onUpdate:modelValue":a[0]||(a[0]=s=>n(u).protocolo=s),label:"Protocolo"},null,8,["modelValue"])]),_:1}),o(x,null,{default:r(()=>[e("div",null,[e("img",{onClick:w,style:{width:"40px",height:"40px",cursor:"pointer"},src:q,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),e("div",z,[a[4]||(a[4]=e("hr",{class:"mt-5 mb-5"},null,-1)),o(j,{headers:V,items:n(m),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":r(({item:s})=>[e("div",H,[e("div",{disabled:!s.btn_cancelar,onClick:K=>s.btn_cancelar?$(s.token):null,title:"Excluir"},a[3]||(a[3]=[e("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:M,alt:"Cancelar",title:"Cancelar"},null,-1)]),8,I)])]),_:1},8,["items"])]),o(A,{show:n(i),condMessage:n(p),onClose:a[1]||(a[1]=s=>i.value=!1),onConfirm:S},null,8,["show","condMessage"])],64)}}},_a=O(U,[["__scopeId","data-v-4c0b92ac"]]);export{_a as default};
