import{_ as te}from"./D5mCQR8p.js";import{u as oe,n as se,q as Q,r,s as le,o as q,v as re,w as a,b as e,x as t,V as K,y as G,d as T,z as Z,A as N,B as X,a as u,C as de,c as L,D as ee,E as Te,F as qe}from"./DzzstydT.js";import{u as f}from"./Bftbo3xK.js";import{V as w}from"./C4PLOs_7.js";import{V as D}from"./D1UnOdqG.js";import{V as ue}from"./DLJolKcC.js";import{V as ne}from"./jnWAYyfk.js";import{_ as Ee}from"./BNxvhN6M.js";import{_ as Se,a as De,b as Ue,c as Re,d as Ie,e as je}from"./DNzMQX9g.js";import{_ as me}from"./Dtn0WEdU.js";import{_ as ae,a as pe}from"./HBU26js5.js";import{_ as _e,a as Be}from"./BINKDG73.js";import{V as ye,a as ve}from"./9HXe_a2c.js";import{_ as fe}from"./DfjuBLsA.js";import{c as Me,r as Fe,u as Ne}from"./aGVAPUeD.js";import{V as Ge,a as H,b as Le,c as J}from"./Bg_NBlKt.js";import"./zRqxYRKE.js";const He={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(W){const l=W,{$toast:y}=oe(),b=Z(),_=se(),n=Q(),g=`${b.public.managemant}/updateAtos`,E=r(l.item_situacoes),h=le({dt_abertura:l.item_dados[0].dt_abertura||null,status:l.item_dados[0].status||null,mne:l.item_dados[0].mne||null});async function U(){const{data:$,error:d,status:P}=await f(`${g}/${n.query.id}`,{method:"PUT",body:{status:h.status,mne:h.mne}},"$EIT5jtTUdX");P.value==="success"&&y.success("Situação Atualizada com sucesso")}const R=()=>{const $=n.query.origem||"criar",d=n.query.id;$==="atualizar"?_.push(`/os/atualizar/${d}`):_.push("/os/criar-registro")};return($,d)=>{const P=te;return q(),re(ne,null,{default:a(()=>[e(w,{class:"mt-5"},{default:a(()=>[e(D,{cols:"3"},{default:a(()=>[e(ue,{label:"Situação",modelValue:t(h).status,"onUpdate:modelValue":d[0]||(d[0]=x=>t(h).status=x),items:t(E),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(D,{cols:"5"},{default:a(()=>[e(K,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:t(h).mne,"onUpdate:modelValue":d[1]||(d[1]=x=>t(h).mne=x)},null,8,["modelValue"])]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(D,{cols:"2"},{default:a(()=>[e(K,{modelValue:t(h).dt_abertura,"onUpdate:modelValue":d[2]||(d[2]=x=>t(h).dt_abertura=x),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(w,{class:"mb-3"},{default:a(()=>[e(P,{onClick:R},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[T("Voltar")]),_:1})]),_:1}),e(G,{class:"ml-10",onClick:U,size:"large",color:"green"},{default:a(()=>[T("Salvar")]),_:1})]),_:1})]),_:1})}}},Je=["onClick"],Ke=u("img",{style:{width:"30px",height:"30px"},src:me,alt:"Visualizar"},null,-1),Xe=[Ke],We=["onClick"],Ye=u("img",{style:{width:"30px",height:"30px"},src:Be,alt:"Visualizar"},null,-1),Qe=[Ye],Ze=["onClick"],ea={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},aa={key:1,src:pe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},ta=["onClick"],oa=u("img",{style:{width:"30px",height:"30px"},src:Ue,alt:"Visualizar"},null,-1),sa=[oa],la={__name:"Partes",props:{ato_token:{type:String,required:!0}},async setup(W){let l,y;const b=se(),_=Q(),n=Z(),{$toast:g}=oe(),E=`${n.public.managemant}/pesquisarPessoas`,h=`${n.public.managemant}/listarPapeis`,U=`${n.public.managemant}/getLinkTipo`,R=`${n.public.managemant}/createAtosPessoa`,$=`${n.public.managemant}/updateAtosPessoa`,d=`${n.public.managemant}/getAtosPessoaById`,P=r(N("user-data").value.cartorio_token),x=r([]),k=r([]),B=r([]),A=r(!1),I=r(!1),v=r(!1),C=r(!1),M=r(null),S=r(null),o=r(null),c=r(null),z=r(null),m=r("xkyaA"),O=r(null),ge=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],V=le({papeis:null,nome:null,pessoa:null,documento:null}),{data:he}=([l,y]=X(()=>f(h,{method:"POST",body:{tipo_ato_token:"xkyaA"}},"$acoiTIUp00")),l=await l,y(),l);B.value=he.value;const ie=async()=>{const{data:i}=await f(`${d}/${_.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),j=(Y=>Y.map(F=>({...F,pessoa:{...F.pessoa,documento:F.pessoa.doc_identificacao},papel:{...F.partes_tipos}})))(i.value);k.value=j};ie();async function xe(){try{const{data:i,error:s}=await f(E,{method:"POST",body:{cartorio_token:P.value,documento:V.documento,nome:V.nome}},"$pr30MyPXfY");i.value.length>0?(x.value=i.value,V.pessoa=x.value[0]):x.value=[]}catch(i){console.error("Erro na requisição",i)}}const be=()=>{I.value=!0},$e=async()=>{await ie()},ke=async()=>{await ie()},Ve=async()=>{const i={pessoa:V.pessoa,papel:B.value.find(F=>F.id===V.papeis),representante:{nome:null}},{data:s,error:j,status:Y}=await f(R,{method:"POST",body:{ato_id:_.query.ato_id,pessoa_id:V.pessoa.id,tipo_parte_id:V.papeis,user_id:N("user-data").value.usuario_id}},"$scHdIvxj2D");Y.value==="success"?(console.log(s.value),o.value=s.value.id,g.success("Pessoa Registrada com Sucesso!"),k.value.push(i)):g.error(s.details)},Pe=async i=>{v.value=!0,O.value=null;const{data:s}=await f(`${U}`,{method:"POST",body:{id:i.pessoa.id,tipo:"ficha"}},"$18isAgOJxG");s.value&&s.value.link?O.value=`data:image/jpeg;base64,${s.value.link}`:O.value=null},we=i=>{const s=k.value.filter(j=>j.pessoa.id!==i.pessoa.id).map(j=>({id:j.pessoa.id,nome:j.pessoa.nome}));o.value=i.id,M.value=s,A.value=!0,S.value=i.pessoa.nome,z.value=i.pessoa.id},Ae=i=>{C.value=!0,c.value=i.id,S.value=i.pessoa.nome};async function Ce(i){i.excluido=!i.excluido;try{await f(`${$}/${i.id}`,{method:"PUT",body:JSON.stringify({excluido:i.excluido})},"$hmDzSF3F61")}catch(s){console.error("Erro ao excluir pessoa:",s)}}const ze=()=>{const i=_.query.origem||"criar",s=_.query.id;i==="atualizar"?b.push(`/os/atualizar/${s}`):b.push("/os/criar-registro")};return(i,s)=>{const j=Ee,Y=Se,F=De,Oe=te;return q(),re(ne,null,{default:a(()=>[e(w,{class:"mt-5"},{default:a(()=>[e(D,{cols:"3"},{default:a(()=>[e(K,{label:"Documento",modelValue:t(V).documento,"onUpdate:modelValue":s[0]||(s[0]=p=>t(V).documento=p)},null,8,["modelValue"])]),_:1}),e(D,{cols:"4"},{default:a(()=>[e(K,{label:"Pessoa",modelValue:t(V).nome,"onUpdate:modelValue":s[1]||(s[1]=p=>t(V).nome=p)},null,8,["modelValue"])]),_:1}),u("div",null,[u("img",{class:"mt-3",src:me,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:xe})]),u("div",null,[u("img",{class:"mt-3 ml-2",src:ae,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:be})])]),_:1}),e(w,null,{default:a(()=>[e(D,{cols:"4"},{default:a(()=>[e(ue,{label:"Selecione a Pessoa",modelValue:t(V).pessoa,"onUpdate:modelValue":s[2]||(s[2]=p=>t(V).pessoa=p),items:t(x),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"3"},{default:a(()=>[e(ue,{label:"Papel",modelValue:t(V).papeis,"onUpdate:modelValue":s[3]||(s[3]=p=>t(V).papeis=p),items:t(B),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),u("div",null,[u("img",{class:"mt-3",src:ae,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Ve})])]),_:1}),e(w,null,{default:a(()=>[e(D,null,{default:a(()=>[e(de,{style:{height:"465px"},headers:ge,items:t(k)},{"item.actions":a(({item:p})=>[e(w,null,{default:a(()=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>Pe(p),title:"Visualizar Ficha"},Xe,8,Je),u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Ae(p),class:"mr-2",title:"Alterar Papel"},Qe,8,We),u("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Ce(p),title:"Deletar Pessoa"},[p.excluido?(q(),L("img",ea)):(q(),L("img",aa))],8,Ze),u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>we(p),title:"Selecionar Representante"},sa,8,ta)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(j,{show:t(I),onClose:s[4]||(s[4]=p=>I.value=!1)},null,8,["show"]),e(Y,{representante_nome:t(S),representantes:t(M),ato_id:t(o),show:t(A),onClose:s[5]||(s[5]=p=>A.value=!1),onUpdateRepresentante:ke},null,8,["representante_nome","representantes","ato_id","show"]),e(F,{representante_nome:t(S),ato_token:t(m),ato_id:t(c),show:t(C),onClose:s[6]||(s[6]=p=>C.value=!1),onUpdatePapel:$e},null,8,["representante_nome","ato_token","ato_id","show"]),e(ye,{modelValue:t(v),"onUpdate:modelValue":s[8]||(s[8]=p=>ee(v)?v.value=p:null),width:"600"},{default:a(()=>[e(ve,{"max-width":"600",title:"Ficha"},{default:a(()=>[e(Te,{src:t(O)},null,8,["src"]),e(G,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:s[7]||(s[7]=p=>v.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(w,null,{default:a(()=>[e(Oe,{onClick:ze},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[T("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},ra=["onClick"],na={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},ia={key:1,src:pe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},ca={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(W){let l,y;const b=se(),_=Q(),n=Z(),{$toast:g}=oe(),E=`${n.public.managemant}/listarEscrevente`;`${n.public.managemant}`;const h=`${n.public.managemant}/createAtosObservacao`,U=`${n.public.managemant}/updateAtosObservacao`,R=`${n.public.managemant}/getAtosObservacaoById`,$=r(N("user-data").value.cartorio_token),d=r([]),P=r([]),x=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],k=le({observacao:""}),B={observacao:{required:Me.withMessage("O campo é obrigatório",Fe)}},A=Ne(B,k),{data:I}=([l,y]=X(()=>f(`${R}/${_.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),l=await l,y(),l);d.value=I.value.map(o=>({...o,created:fe(o.created,"dd/mm/yyyy")}));async function v(){if(k.observacao.trim()===""){g.error("O campo de observação está vazio.");return}if(await A.value.$validate()){const{data:o,error:c,status:z}=await f(h,{method:"POST",body:{ato_id:_.query.ato_id,observacao:k.observacao,user_id:N("user-data").value.usuario_id}},"$gnHMo4uCXD");z.value==="success"&&(d.value.push({created:fe(o.value.created,"dd/mm/yyyy"),observacao:o.value.observacao,id:o.value.id,escrevente:N("user-data").value.nome}),k.observacao="",g.success("Observação registrada com sucesso"))}else g.error("Preencha os campos obrigatórios.")}async function C(o){o.excluido=!o.excluido;try{await f(`${U}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$sP9AKdd3Ky")}catch(c){console.error("Erro ao excluir observação:",c)}}const{data:M}=([l,y]=X(()=>f(E,{method:"POST",body:{cartorio_token:$}},"$HL9pndqGh0")),l=await l,y(),l);P.value=M.value[0].func_json_escreventes;const S=()=>{const o=_.query.origem||"criar",c=_.query.id;o==="atualizar"?b.push(`/os/atualizar/${c}`):b.push("/os/criar-registro")};return(o,c)=>{const z=te;return q(),re(ne,null,{default:a(()=>[e(w,{class:"mt-5"},{default:a(()=>[e(K,{label:"Observação",modelValue:k.observacao,"onUpdate:modelValue":c[0]||(c[0]=m=>k.observacao=m),required:"","error-messages":t(A).observacao.$errors.length>0?t(A).observacao.$errors.map(m=>m.$message):[],onBlur:t(A).observacao.$touch,onInput:t(A).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),u("div",null,[u("img",{class:"btn-pointer ml-2",src:ae,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:v})])]),_:1}),e(w,null,{default:a(()=>[e(D,null,{default:a(()=>[e(de,{style:{height:"465px"},headers:x,items:d.value},{"item.actions":a(({item:m})=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:O=>C(m),title:"Deletar Observação"},[m.excluido?(q(),L("img",na)):(q(),L("img",ia))],8,ra)]),_:1},8,["items"])]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(z,{onClick:S},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[T("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},ua=u("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Re,alt:"Escanear"},null,-1),da=[ua],ma=u("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ae,alt:"Criar"},null,-1),pa=[ma],_a=["onClick"],va=u("img",{style:{width:"30px",height:"30px"},src:me,alt:"Visualizar"},null,-1),fa=[va],ya=["onClick"],ga={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},ha={key:1,src:pe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},xa={__name:"Anexos",async setup(W){let l,y;const b=Z(),{$toast:_}=oe(),n=se(),g=Q(),E=`${b.public.biometria}/run-scanner`,h=`${b.public.managemant}/atos_anexos`,U=`${b.public.managemant}/atos_anexos`,R=`${b.public.managemant}/atos_anexos`,$=r(!1),d=r([]),P=le({descricao:""}),x=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:k}=([l,y]=X(()=>f(`${R}/${g.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),l=await l,y(),l);d.value=k.value;async function B(){try{await A(),await I()}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}}async function A(){try{const{data:o}=await f(E,{method:"GET"},"$KttjFhHivJ")}catch(o){_.error("Erro ao acionar o scanner:",o)}}async function I(){try{const{data:o,status:c}=await f("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:g.query.ato_token_edit,cartorio_token:N("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(o){console.error("Erro ao enviar o arquivo:",o)}}const v=async()=>{$.value=!0},C=async()=>{const{data:o,error:c,status:z}=await f(h,{method:"POST",body:{ato_id:g.query.ato_id,descricao:P.descricao,user_id:N("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");z.value==="success"&&(_.success("Anexo registrado com sucesso!"),d.value.push(o.value))};async function M(o){o.excluido=!o.excluido;try{await f(`${U}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$cdoFBGO0Ti")}catch(c){console.error("Erro ao excluir pessoa:",c)}}const S=()=>{const o=g.query.origem||"criar",c=g.query.id;o==="atualizar"?n.push(`/os/atualizar/${c}`):n.push("/os/criar-registro")};return(o,c)=>{const z=te;return q(),re(ne,null,{default:a(()=>[e(w,null,{default:a(()=>[e(D,{cols:"5"},{default:a(()=>[e(K,{modelValue:t(P).descricao,"onUpdate:modelValue":c[0]||(c[0]=m=>t(P).descricao=m),label:"Descrição"},null,8,["modelValue"])]),_:1}),u("div",{onClick:B,title:"Escanear"},da),u("div",{onClick:C,title:"Criar"},pa)]),_:1}),e(de,{headers:x,items:t(d),style:{height:"465px","max-width":"600px"}},{"item.actions":a(({item:m})=>[e(w,null,{default:a(()=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:O=>v(m),title:"Visualizar Anexo"},fa,8,_a),u("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:O=>M(m),title:"Deletar Pessoa"},[m.excluido?(q(),L("img",ga)):(q(),L("img",ha))],8,ya)]),_:2},1024)]),_:1},8,["items"]),e(ye,{modelValue:t($),"onUpdate:modelValue":c[2]||(c[2]=m=>ee($)?$.value=m:null),width:"600"},{default:a(()=>[e(ve,{"max-width":"600",title:"Anexo"},{default:a(()=>[e(G,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:c[1]||(c[1]=m=>$.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(z,{onClick:S},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[T("Voltar")]),_:1})]),_:1})]),_:1})}}},ba=u("h1",{class:"mb-2"},"Procuração",-1),ja={__name:"[id]",async setup(W){let l,y;const b=r(null),_=r(null),n=r(null),g=Z(),E=Q(),h=`${g.public.managemant}/listarSituacoes`,U=`${g.public.managemant}/getAtos`,R=r(N("user-data").value.cartorio_token),$=E.query.id?{ato_token:"xkyaA"}:{cartorio_token:R},d=r([]),P=r([]);async function x(){try{const{data:v}=await f(`${U}/${E.query.id}`,{method:"GET"},"$j0JpHHj7PB");P.value=v.value}catch(v){console.log(v)}}[l,y]=X(()=>x()),await l,y();const{data:k,status:B}=([l,y]=X(()=>f(h,{method:"POST",body:$},"$mGbp7gAEjS")),l=await l,y(),l);d.value=k.value;const A=v=>{b.value=v},I=v=>{_.value=v};return(v,C)=>{const M=He,S=la,o=Ie,c=je,z=ca,m=xa;return q(),L(qe,null,[ba,e(ve,{width:"1300"},{default:a(()=>[e(Ge,{modelValue:t(n),"onUpdate:modelValue":C[0]||(C[0]=O=>ee(n)?n.value=O:null),"bg-color":"#f5f2f2"},{default:a(()=>[e(H,{value:"dados"},{default:a(()=>[T("Dados")]),_:1}),e(H,{value:"partes"},{default:a(()=>[T("Partes")]),_:1}),e(H,{value:"minuta"},{default:a(()=>[T("Minuta")]),_:1}),e(H,{value:"livro"},{default:a(()=>[T("Livro")]),_:1}),e(H,{value:"observacao"},{default:a(()=>[T("Observações")]),_:1}),e(H,{value:"anexo"},{default:a(()=>[T("Anexos")]),_:1})]),_:1},8,["modelValue"]),e(Le,{modelValue:t(n),"onUpdate:modelValue":C[1]||(C[1]=O=>ee(n)?n.value=O:null)},{default:a(()=>[e(J,{value:"dados"},{default:a(()=>[e(M,{item_dados:t(P),item_situacoes:t(d)},null,8,["item_dados","item_situacoes"])]),_:1}),e(J,{value:"partes"},{default:a(()=>[e(S)]),_:1}),e(J,{value:"minuta"},{default:a(()=>[e(o,{onPage:A,onDoc:I})]),_:1}),e(J,{value:"livro"},{default:a(()=>[e(c,{pages:t(b),document:t(_)},null,8,["pages","document"])]),_:1}),e(J,{value:"observacao"},{default:a(()=>[e(z)]),_:1}),e(J,{value:"anexo"},{default:a(()=>[e(m)]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}};export{ja as default};
