import{_ as xe}from"./C-K-maSx.js";import{_ as fe}from"./DwlrPvmW.js";import{c as re,r as ue,u as Pe}from"./DaAN5YqY.js";import{D as ve,u as Ve,r as n,m as te,A as be,E as ge,n as we,v as o,o as C,c as se,b as e,L as Ce,q as H,w as t,V as p,a as d,H as W,d as S,s as ye,F as h,g as Ue,I as de}from"./CQUztZdQ.js";import{u as P}from"./L9C3kzld.js";import{V as g}from"./DbhB8jhS.js";import{V as i}from"./DHmMPa6H.js";import{V as Ie}from"./CVyqCs2z.js";import{V as w}from"./BA12yuSv.js";import{V as ie}from"./D8dNb-4Z.js";import{_ as Te,d as qe,V as Be,a as me,b as Me,c as ce}from"./DNO7CeGW.js";import{b as ze}from"./dY_WCbjZ.js";import{_ as pe}from"./DgCi1WA9.js";import{_ as _e,a as Se,b as Ae,c as De}from"./QXGxGPw_.js";import{V as Oe}from"./CT5zN_45.js";import{V as $e,a as ke}from"./lISH-0R7.js";const Ne={key:0,class:"d-flex justify-center"},Re={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},emits:["saved","close-modal"],async setup(Y,{emit:A}){let _,f;const V=Y,y=A,v=ve(),b=ye(),{$toast:U}=Ve(),{id:q}=v.params,m=`${b.public.managemant}/atos_bens`,D=`${b.public.managemant}/registro_imoveis`,O=`${b.public.managemant}/natureza_imoveis`,$=`${b.public.managemant}/tipo_logradouros`,B=`${b.public.managemant}/situacao_imoveis`,G=`${b.public.managemant}/listarCidades`,Q=`${b.public.managemant}/listarTipoBens`,N=n(te("user-data").value.cartorio_token),I=n(te("user-data").value.usuario_id).value;n([]),n([]);const M=n([]),R=n([]),E=n([]),X=n([]),z=n([]),J=n([]);n(!1);const c=n(!0),s=be({vlr_alienacao:null,tabvalores_tipo_regimovel_id:null,registro_cartorio:null,registro_matricula:null,registro_matricula_letra:null,tabvalores_nat_imovel_id:null,cib:null,end_cidade_id:null,end_quadra:null,end_lote:null,tabvalores_tipologradouro_id:null,end_logradouro:null,end_logradouro_numero:null,end_bairro:null,end_cep:null,end_complemento:null,tipo_id:null,descricao:null,inscricao_estadual:null,tabvalores_situacao_imoveis_id:null,tipo_id:null,vlr_alienacao:null,vlr_mercado:null,valor_mercado:"0.00",aliq_itbi:null,vlr_itbi:null,user_id:I,ato_id:Number(v.query.ato_id)||Number(V.ato_id)}),K={descricao:{required:re.withMessage("O campo é obrigatório",ue)},tipo_id:{required:re.withMessage("O campo é obrigatório",ue)}},F=Pe(K,s),ee=async()=>{if(console.log(s),!await F.value.$validate()){U.error("Preencha todos os campos obrigatórios!");return}const{status:a}=await P(`${m}`,{method:"POST",body:s},"$0Mdv6RF9cH");a.value==="success"&&(U.success("Imovel criado com sucesso!"),y("saved"))},{data:le}=([_,f]=ge(()=>P(`${Q}`,{method:"POST",body:{cartorio_token:N.value,imoveis:!0}},"$jHrIlABk8l")),_=await _,f(),_);J.value=le.value;async function oe(){try{const[T,a,k,r,l]=await Promise.all([$fetch(O),$fetch(D),$fetch(B),$fetch($),$fetch(G)]);R.value=T,M.value=a,z.value=k,E.value=r,X.value=l}catch(T){console.error("Erro ao carregar os dados de imoveis pessoa:",T)}finally{c.value=!1}}const ae=()=>{y("close-modal")};return we(()=>{q||V.ato_id?oe():c.value=!1}),(T,a)=>{const k=xe,r=fe;return o(c)?(C(),se("div",Ne,[e(Ce,{indeterminate:"",class:"loading-spinner",size:"64"})])):(C(),H(ie,{key:1},{default:t(()=>[e(g,null,{default:t(()=>[e(i,{class:"mt-5",cols:"12"},{default:t(()=>[e(Ie,{label:"Descrição",modelValue:o(s).descricao,"onUpdate:modelValue":a[0]||(a[0]=l=>o(s).descricao=l),"error-messages":o(F).descricao.$errors.map(l=>l.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(i,{cols:"3"},{default:t(()=>[e(w,{label:"Tipo de Registro",modelValue:o(s).tabvalores_tipo_regimovel_id,"onUpdate:modelValue":a[1]||(a[1]=l=>o(s).tabvalores_tipo_regimovel_id=l),items:o(M),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[e(p,{label:"Cartório",modelValue:o(s).registro_cartorio,"onUpdate:modelValue":a[2]||(a[2]=l=>o(s).registro_cartorio=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[e(p,{label:"Matricula",modelValue:o(s).registro_matricula,"onUpdate:modelValue":a[3]||(a[3]=l=>o(s).registro_matricula=l)},null,8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(p,{label:"Letra",modelValue:o(s).registro_matricula_letra,"onUpdate:modelValue":a[4]||(a[4]=l=>o(s).registro_matricula_letra=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[e(w,{label:"Natureza",modelValue:o(s).tabvalores_nat_imovel_id,"onUpdate:modelValue":a[5]||(a[5]=l=>o(s).tabvalores_nat_imovel_id=l),items:o(R),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"1"},{default:t(()=>[e(p,{label:"CIB",modelValue:o(s).cib,"onUpdate:modelValue":a[6]||(a[6]=l=>o(s).cib=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(i,{cols:"3"},{default:t(()=>[e(w,{label:"Cidade",modelValue:o(s).end_cidade_id,"onUpdate:modelValue":a[7]||(a[7]=l=>o(s).end_cidade_id=l),items:o(X),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[e(p,{label:"Quadra",modelValue:o(s).end_quadra,"onUpdate:modelValue":a[8]||(a[8]=l=>o(s).end_quadra=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[e(p,{label:"Lote",modelValue:o(s).end_lote,"onUpdate:modelValue":a[9]||(a[9]=l=>o(s).end_lote=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"4"},{default:t(()=>[e(w,{label:"Logradouro",modelValue:o(s).tabvalores_tipologradouro_id,"onUpdate:modelValue":a[10]||(a[10]=l=>o(s).tabvalores_tipologradouro_id=l),items:o(E),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"1"},{default:t(()=>[e(p,{label:"N*",modelValue:o(s).end_logradouro_numero,"onUpdate:modelValue":a[11]||(a[11]=l=>o(s).end_logradouro_numero=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(i,null,{default:t(()=>[e(p,{label:"Bairro",modelValue:o(s).end_bairro,"onUpdate:modelValue":a[12]||(a[12]=l=>o(s).end_bairro=l)},null,8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(p,{label:"CEP",modelValue:o(s).end_cep,"onUpdate:modelValue":a[13]||(a[13]=l=>o(s).end_cep=l)},null,8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(p,{label:"Complemento",modelValue:o(s).end_complemento,"onUpdate:modelValue":a[14]||(a[14]=l=>o(s).end_complemento=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"3"},{default:t(()=>[e(w,{modelValue:o(s).tipo_id,"onUpdate:modelValue":a[15]||(a[15]=l=>o(s).tipo_id=l),items:o(J),label:"Tipo de imovel","item-title":"descricao","item-value":"id","error-messages":o(F).tipo_id.$errors.map(l=>l.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(i,{cols:"3"},{default:t(()=>[e(p,{label:"Inscrição Municipal"})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(i,{class:"mt-6",cols:"4"},{default:t(()=>[e(w,{label:"Situação",items:o(z),"item-title":"descricao","item-value":"id"},null,8,["items"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[a[21]||(a[21]=d("label",null,"Valor Alienação",-1)),e(k,{label:"Valor Alienação",modelValue:o(s).vlr_alienacao,"onUpdate:modelValue":a[16]||(a[16]=l=>o(s).vlr_alienacao=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[a[22]||(a[22]=d("label",null,"Valor Avaliação",-1)),e(k,{label:"Valor Avaliação",modelValue:o(s).vlr_avaliacao,"onUpdate:modelValue":a[17]||(a[17]=l=>o(s).vlr_avaliacao=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[a[23]||(a[23]=d("label",null,"Valor Mercado",-1)),e(k,{label:"Valor Mercado",modelValue:o(s).vlr_mercado,"onUpdate:modelValue":a[18]||(a[18]=l=>o(s).vlr_mercado=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"1"},{default:t(()=>[a[24]||(a[24]=d("label",null,"%ITB",-1)),e(k,{label:"%ITB",modelValue:o(s).aliq_itbi,"onUpdate:modelValue":a[19]||(a[19]=l=>o(s).aliq_itbi=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"1"},{default:t(()=>[a[25]||(a[25]=d("label",null,"Valor ITB",-1)),e(k,{label:"Valor ITB",modelValue:o(s).vlr_itbi,"onUpdate:modelValue":a[20]||(a[20]=l=>o(s).vlr_itbi=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{class:"mt-10"},{default:t(()=>[e(r,{onClick:ae},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>a[26]||(a[26]=[S("Voltar")])),_:1})]),_:1}),e(W,{class:"ml-5",size:"large",color:"green",onClick:ee},{default:t(()=>a[27]||(a[27]=[S("Salvar")])),_:1})]),_:1})]),_:1}))}}},Ee=["onClick"],Fe=["onClick"],je=["onClick"],Le={key:0,style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar",title:"Reativar"},He={key:1,src:De,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},We={__name:"Partes",emits:["saved","close-modal"],async setup(Y,{emit:A}){let _,f;const V=A,y=ve(),v=ye();Ve();const b=`${v.public.managemant}/pesquisarPessoas`,U=`${v.public.managemant}/listarPapeis`,q=`${v.public.managemant}/getLinkTipo`;`${v.public.managemant}`;const m=`${v.public.managemant}/updateAtosPessoa`,D=`${v.public.managemant}/getAtosPessoaById`,O=`${v.public.managemant}/download`,$=n(te("user-data").value.cartorio_token),B=n([]),G=n([]),Q=n([]),N=n(!1),I=n(!1),M=n(!1),R=n(null),E=n(null),X=n("xkyaA"),z=n(null),J=[{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"%",align:"start"},{value:"actions"}],c=be({papeis:null,nome:null,pessoa:null,documento:null}),{data:s}=([_,f]=ge(()=>P(U,{method:"POST",body:{tipo_ato_token:y.query.tipo_ato_token}},"$X6FDd5A6WK")),_=await _,f(),_);Q.value=s.value;const K=async()=>{const{data:r}=await P(`${D}/${y.query.ato_id}`,{method:"GET"},"$Dyv7lSgcqT"),j=(L=>L.map(x=>({...x,pessoa:{...x.pessoa,documento:x.pessoa.doc_identificacao},papel:{...x.partes_tipos}})))(r.value);G.value=j};K();async function F(){try{const{data:r,error:l}=await P(b,{method:"POST",body:{cartorio_token:$.value,documento:c.documento,nome:c.nome}},"$Ir36YwSBFY");r.value.length>0?(B.value=r.value,c.pessoa=B.value[0]):B.value=[]}catch(r){console.error("Erro na requisição",r)}}const ee=()=>{N.value=!0},le=async()=>{await K()},oe=async()=>{V("saved")},ae=async r=>{var Z;if(I.value=!0,z.value=null,!r.pessoa.id)return;const{data:l}=await P(q,{method:"POST",body:{tipo:"ficha",id:r.pessoa.id}},"$z4QOGPyvCc");if(!((Z=l.value)!=null&&Z.link))return;const{data:j}=await P(O,{method:"POST",body:{bucket:"qvgjz",path:l.value.link}},"$XYnqHmowsR"),L=l.value.link,x=j.value;/\.(tr7|tiff)$/i.test(L)?z.value=x:fotoRender.value=`data:image/jpeg;base64,${x}`},T=r=>{M.value=!0,E.value=r.id,R.value=r.pessoa.nome};async function a(r){r.excluido=!r.excluido;try{await P(`${m}/${r.id}`,{method:"PUT",body:JSON.stringify({excluido:r.excluido})},"$63DgHOk5hC")}catch(l){console.error("Erro ao excluir pessoa:",l)}}const k=()=>{V("close-modal")};return(r,l)=>{const j=Te,L=ze,x=qe,Z=fe;return C(),H(ie,null,{default:t(()=>[e(g,null,{default:t(()=>[e(i,{cols:"3"},{default:t(()=>[e(p,{label:"Documento",modelValue:o(c).documento,"onUpdate:modelValue":l[0]||(l[0]=u=>o(c).documento=u)},null,8,["modelValue"])]),_:1}),e(i,{cols:"4"},{default:t(()=>[e(p,{label:"Pessoa",modelValue:o(c).nome,"onUpdate:modelValue":l[1]||(l[1]=u=>o(c).nome=u)},null,8,["modelValue"])]),_:1}),d("div",null,[d("img",{class:"mt-1",src:pe,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:F})]),d("div",null,[d("img",{class:"mt-1 ml-2",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ee})])]),_:1}),e(g,null,{default:t(()=>[e(i,{cols:"4"},{default:t(()=>[e(w,{label:"Selecione a Pessoa",modelValue:o(c).pessoa,"onUpdate:modelValue":l[2]||(l[2]=u=>o(c).pessoa=u),items:o(B),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"3"},{default:t(()=>[e(w,{label:"Papel",modelValue:o(c).papeis,"onUpdate:modelValue":l[3]||(l[3]=u=>o(c).papeis=u),items:o(Q),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"1"},{default:t(()=>[e(p,{label:"%"})]),_:1}),d("div",null,[d("img",{class:"mt-1",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Imovel",onClick:oe})])]),_:1}),e(g,null,{default:t(()=>[e(i,null,{default:t(()=>[e(Oe,{style:{height:"385px"},headers:J,items:o(G)},{"item.actions":t(({item:u})=>[e(g,null,{default:t(()=>[d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ne=>ae(u),title:"Visualizar Ficha"},l[8]||(l[8]=[d("img",{style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar"},null,-1)]),8,Ee),d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ne=>T(u),class:"mr-2",title:"Alterar Papel"},l[9]||(l[9]=[d("img",{style:{width:"30px",height:"30px"},src:Se,alt:"Visualizar"},null,-1)]),8,Fe),d("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ne=>a(u),title:"Deletar Pessoa"},[u.excluido?(C(),se("img",Le)):(C(),se("img",He))],8,je)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(j,{show:o(N),onClose:l[4]||(l[4]=u=>N.value=!1)},null,8,["show"]),e(L,{representante_nome:o(R),ato_token:o(X),ato_id:o(E),show:o(M),onClose:l[5]||(l[5]=u=>M.value=!1),onUpdatePapel:le},null,8,["representante_nome","ato_token","ato_id","show"]),e($e,{modelValue:o(I),"onUpdate:modelValue":l[7]||(l[7]=u=>h(I)?I.value=u:null),width:"600"},{default:t(()=>[e(ke,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(x,{"tiff-url":o(z)},null,8,["tiff-url"]),e(W,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:l[6]||(l[6]=u=>I.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(g,{class:"mt-5"},{default:t(()=>[e(Z,{onClick:k},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>l[10]||(l[10]=[S("Voltar")])),_:1})]),_:1}),e(W,{class:"ml-5",size:"large",color:"green"},{default:t(()=>l[11]||(l[11]=[S("Salvar")])),_:1})]),_:1})]),_:1})}}},rl={__name:"Cadastro",props:{show:Boolean},emits:["close"],setup(Y,{emit:A}){const _=Y,f=n("dados"),V=n(_.show),y=n(!1),v=A;Ue(()=>_.show,q=>{V.value=q});const b=()=>{y.value=!0},U=()=>{V.value=!1,y.value=!1,v("close")};return(q,m)=>{const D=Re,O=We;return C(),H($e,{persistent:"",modelValue:o(V),"onUpdate:modelValue":m[2]||(m[2]=$=>h(V)?V.value=$:null),"max-width":"1000"},{default:t(()=>[e(ke,null,{default:t(()=>[e(ie,null,{default:t(()=>[m[5]||(m[5]=d("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Cadastro de imoveis ",-1)),e(Be,{modelValue:o(f),"onUpdate:modelValue":m[0]||(m[0]=$=>h(f)?f.value=$:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(me,{value:"dados"},{default:t(()=>m[3]||(m[3]=[S("Dados")])),_:1}),o(y)?(C(),H(me,{key:0,value:"partes"},{default:t(()=>m[4]||(m[4]=[S("Partes")])),_:1})):de("",!0)]),_:1},8,["modelValue"]),e(Me,{modelValue:o(f),"onUpdate:modelValue":m[1]||(m[1]=$=>h(f)?f.value=$:null)},{default:t(()=>[e(ce,{value:"dados"},{default:t(()=>[e(D,{onSaved:b,onCloseModal:U})]),_:1}),e(ce,{value:"partes"},{default:t(()=>[o(y)?(C(),H(O,{key:0,onCloseModal:U})):de("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{Re as _,We as a,rl as b};
