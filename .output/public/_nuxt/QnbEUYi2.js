import{r as m,n as I,p as z,g as N,H as P,o as E,y as U,w as n,b as l,a as _,X as j,d as M,x as o,M as b,A as X}from"./Dlqmy1RL.js";import{c as H,r as J,u as L}from"./yghpo_da.js";import{u as f}from"./C_GLwl2T.js";import{V as W,c as Y}from"./R8R8AvG3.js";import{V as Z}from"./DAKMzE7Y.js";import{V as G}from"./BKuoGoND.js";import{V as K}from"./syGi6Sh6.js";import{V as Q}from"./Dwnwy4ft.js";import{V as ee}from"./jc2lIy5z.js";const te=""+new URL("selo.D9mIBRmY.png",import.meta.url).href,de={__name:"Selos",props:{show:Boolean,ato_token:String},emits:["close"],async setup(k,{emit:$}){let c,S;const d=k,r=m(d.show),p=X(),g=m(I("user-data").value.cartorio_token).value,y=`${p.public.managemant}/listarSelos`,C=`${p.public.managemant}/reimprimirSelo`,D=`${p.public.managemant}/listarEscrevente`,h=`${p.public.envioDoc}/print`,V=m([]),i=m([]),w=m([]),u=z({escrevente:null}),O=$,T={escrevente:{required:H.withMessage("O campo é obrigatorio",J)}},v=L(T,u),q=[{title:"Numero",value:"numero"},{title:"Referencia",value:"referencia"},{value:"actions"}];N(()=>d.show,s=>{r.value=s,s&&x()});const F=()=>{r.value=!1,u.escrevente=null,i.value=null,O("close")},{data:B}=([c,S]=P(()=>f(D,{method:"POST",body:{cartorio_token:g}},"$V2ulT7DYvP")),c=await c,S(),c);w.value=B.value[0].func_json_escreventes;const R=async()=>{if(await v.value.$validate()){const s=i.value.map(a=>({selo_token:a})),e={escrevente_token:u.escrevente,ato_token:d.ato_token,selos:s},{data:t,error:oe,status:A}=await f(`${C}`,{method:"POST",body:e},"$45J51uHTfa");if(A.value==="success"){if(t.value[0].tipo_etiqueta==="html"){const a=window.open("","_blank");a.document.open(),a.document.write(t.value[0].etiqueta),a.document.close()}else if(t.value[0].tipo_etiqueta==="zpl"){const{status:a}=await f(`${h}`,{method:"POST",body:{zpl:`^XA
^CF0,40
^FO50,30^FDCartório 360^FS
^CF0,30
^FO50,80^FDDocumento: 123456^FS
^FO50,120^FDData: 21/06/2025^FS
^FO50,160^FDAssinatura:___________________^FS
^FO50,210^GB700,3,3^FS
^CF0,25
^FO50,230^FDEste documento foi autenticado eletronicamente.^FS
^XZ`}},"$rLWIRtrfDz");if(a.value!=="success"){$toast.error("Não foi possivel fazer a impressao da etiqueta");return}}F()}}},x=async()=>{const{data:s,error:e}=await f(`${y}`,{method:"POST",body:{ato_token:d.ato_token}},"$qS5onK9VjE");s.value.selos===null?V.value=[]:V.value=s.value.selos};return(s,e)=>(E(),U(ee,{persistent:"",modelValue:o(r),"onUpdate:modelValue":e[2]||(e[2]=t=>b(r)?r.value=t:null),"max-width":"500"},{default:n(()=>[l(W,null,{default:n(()=>[l(Z,null,{default:n(()=>[l(G,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:n(()=>[e[4]||(e[4]=_("h1",{class:"ml-4"},"Reimpressão de Selos",-1)),l(j,{class:"mt-4 mr-4",style:{color:"red"},onClick:F},{default:n(()=>e[3]||(e[3]=[M("mdi-close")])),_:1})]),_:1}),e[5]||(e[5]=_("hr",{class:"mb-5"},null,-1)),l(K,{class:"mb-5",label:"Tabelião/escrivão",modelValue:o(u).escrevente,"onUpdate:modelValue":e[0]||(e[0]=t=>o(u).escrevente=t),items:o(w),"item-title":"nome","item-value":"token",required:"","error-messages":o(v).escrevente.$errors.map(t=>t.$message),onBlur:o(v).escrevente.$touch,onInput:o(v).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"]),l(Q,{headers:q,items:o(V),"item-value":"token","show-select":"",modelValue:o(i),"onUpdate:modelValue":e[1]||(e[1]=t=>b(i)?i.value=t:null)},null,8,["items","modelValue"])]),_:1}),l(Y,null,{default:n(()=>[_("div",null,[_("img",{src:te,style:{cursor:"pointer"},onClick:R})])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{de as _,te as a};
