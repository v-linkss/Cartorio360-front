import{_ as te}from"./wU7jWMkS.js";import{u as oe,n as se,q as Q,r,s as le,o as E,v as re,w as a,b as e,x as t,V as K,y as G,d as q,z as Z,A as N,B as X,a as c,C as de,c as L,D as ee,E as Oe,F as qe}from"./BYJ7JRuT.js";import{u as f}from"./BnhtCTf5.js";import{V as w}from"./0zu-vBh-.js";import{V as U}from"./X9E3iSdq.js";import{V as ce}from"./DC7q_MeC.js";import{V as ne}from"./rj-FfcAF.js";import{_ as Ee}from"./BjmVei3s.js";import{_ as Se,a as De,b as Ue,c as Re,d as Ie,e as je}from"./MvEQe3uj.js";import{_ as me}from"./r2eJLEJ6.js";import{_ as ae,a as pe}from"./HBU26js5.js";import{_ as _e,a as Be}from"./BU4w8LJX.js";import{V as ye,a as ve}from"./Cr_8dIbG.js";import{_ as fe}from"./IlJfZQNA.js";import{c as Me,r as Fe,u as Ne}from"./CBEtIhP-.js";import{V as Ge,a as H,b as Le,c as J}from"./CcZoWOHU.js";import"./CSpdCzvj.js";const He={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(W){const l=W,{$toast:y}=oe(),b=Z(),_=se(),n=Q(),h=`${b.public.managemant}/updateAtos`,S=r(l.item_situacoes),x=le({dt_abertura:l.item_dados[0].dt_abertura||null,status:l.item_dados[0].status||null,mne:l.item_dados[0].mne||null});async function R(){const{data:k,error:d,status:V}=await f(`${h}/${n.query.id}`,{method:"PUT",body:{status:x.status,mne:x.mne}},"$EIT5jtTUdX");V.value==="success"&&y.success("Situação Atualizada com sucesso")}const I=()=>{const k=n.query.origem||"criar",d=n.query.id;k==="atualizar"?_.push(`/os/atualizar/${d}`):_.push("/os/criar-registro")};return(k,d)=>{const V=te;return E(),re(ne,null,{default:a(()=>[e(w,{class:"mt-5"},{default:a(()=>[e(U,{cols:"3"},{default:a(()=>[e(ce,{label:"Situação",modelValue:t(x).status,"onUpdate:modelValue":d[0]||(d[0]=$=>t(x).status=$),items:t(S),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(U,{cols:"5"},{default:a(()=>[e(K,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:t(x).mne,"onUpdate:modelValue":d[1]||(d[1]=$=>t(x).mne=$)},null,8,["modelValue"])]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(U,{cols:"2"},{default:a(()=>[e(K,{modelValue:t(x).dt_abertura,"onUpdate:modelValue":d[2]||(d[2]=$=>t(x).dt_abertura=$),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(w,{class:"mb-3"},{default:a(()=>[e(V,{onClick:I},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[q("Voltar")]),_:1})]),_:1}),e(G,{class:"ml-10",onClick:R,size:"large",color:"green"},{default:a(()=>[q("Salvar")]),_:1})]),_:1})]),_:1})}}},Je=["onClick"],Ke=c("img",{style:{width:"30px",height:"30px"},src:me,alt:"Visualizar"},null,-1),Xe=[Ke],We=["onClick"],Ye=c("img",{style:{width:"30px",height:"30px"},src:Be,alt:"Visualizar"},null,-1),Qe=[Ye],Ze=["onClick"],ea={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},aa={key:1,src:pe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},ta=["onClick"],oa=c("img",{style:{width:"30px",height:"30px"},src:Ue,alt:"Visualizar"},null,-1),sa=[oa],la={__name:"Partes",props:{ato_token:{type:String,required:!0}},async setup(W){let l,y;const b=se(),_=Q(),n=Z(),{$toast:h}=oe(),S=`${n.public.managemant}/pesquisarPessoas`,x=`${n.public.managemant}/listarPapeis`,R=`${n.public.managemant}/getLinkTipo`,I=`${n.public.managemant}/createAtosPessoa`,k=`${n.public.managemant}/updateAtosPessoa`,d=`${n.public.managemant}/getAtosPessoaById`,V=r(N("user-data").value.cartorio_token),$=r([]),P=r([]),M=r([]),A=r(!1),j=r(!1),v=r(!1),C=r(!1),F=r(null),D=r(null),o=r(null),u=r(null),T=r(null),m=r("xkyaA"),z=r(null),ge=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],g=le({papeis:null,nome:null,pessoa:null,documento:null}),{data:he}=([l,y]=X(()=>f(x,{method:"POST",body:{tipo_ato_token:"xkyaA"}},"$acoiTIUp00")),l=await l,y(),l);M.value=he.value;const ie=async()=>{const{data:i}=await f(`${d}/${_.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),B=(Y=>Y.map(O=>({...O,pessoa:{...O.pessoa,documento:O.pessoa.doc_identificacao},papel:{...O.partes_tipos}})))(i.value);P.value=B};ie();async function xe(){try{const{data:i,error:s}=await f(S,{method:"POST",body:{cartorio_token:V.value,documento:g.documento,nome:g.nome}},"$pr30MyPXfY");i.value.length>0?($.value=i.value,g.pessoa=$.value[0]):$.value=[]}catch(i){console.error("Erro na requisição",i)}}const $e=()=>{j.value=!0},be=async()=>{await ie()},ke=async()=>{await ie()},Ve=async()=>{const i={pessoa:g.pessoa,papel:M.value.find(O=>O.id===g.papeis),representante:{nome:null}};for(const O of P.value)if(O.pessoa_id===g.pessoa.id&&O.tipo_parte_id===g.papeis){h.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:s,error:B,status:Y}=await f(I,{method:"POST",body:{ato_id:_.query.ato_id,pessoa_id:g.pessoa.id,tipo_parte_id:g.papeis,user_id:N("user-data").value.usuario_id}},"$scHdIvxj2D");Y.value==="success"&&(o.value=s.value.id,h.success("Pessoa Registrada com Sucesso!"),P.value.push(i))},Pe=async i=>{v.value=!0,z.value=null;const{data:s}=await f(`${R}`,{method:"POST",body:{id:i.pessoa.id,tipo:"ficha"}},"$18isAgOJxG");s.value&&s.value.link?z.value=`data:image/jpeg;base64,${s.value.link}`:z.value=null},we=i=>{const s=P.value.filter(B=>B.pessoa.id!==i.pessoa.id).map(B=>({id:B.pessoa.id,nome:B.pessoa.nome}));o.value=i.id,F.value=s,A.value=!0,D.value=i.pessoa.nome,T.value=i.pessoa.id},Ae=i=>{C.value=!0,u.value=i.id,D.value=i.pessoa.nome};async function Ce(i){i.excluido=!i.excluido;try{await f(`${k}/${i.id}`,{method:"PUT",body:JSON.stringify({excluido:i.excluido})},"$hmDzSF3F61")}catch(s){console.error("Erro ao excluir pessoa:",s)}}const Te=()=>{const i=_.query.origem||"criar",s=_.query.id;i==="atualizar"?b.push(`/os/atualizar/${s}`):b.push("/os/criar-registro")};return(i,s)=>{const B=Ee,Y=Se,O=De,ze=te;return E(),re(ne,null,{default:a(()=>[e(w,{class:"mt-5"},{default:a(()=>[e(U,{cols:"3"},{default:a(()=>[e(K,{label:"Documento",modelValue:t(g).documento,"onUpdate:modelValue":s[0]||(s[0]=p=>t(g).documento=p)},null,8,["modelValue"])]),_:1}),e(U,{cols:"4"},{default:a(()=>[e(K,{label:"Pessoa",modelValue:t(g).nome,"onUpdate:modelValue":s[1]||(s[1]=p=>t(g).nome=p)},null,8,["modelValue"])]),_:1}),c("div",null,[c("img",{class:"mt-3",src:me,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:xe})]),c("div",null,[c("img",{class:"mt-3 ml-2",src:ae,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:$e})])]),_:1}),e(w,null,{default:a(()=>[e(U,{cols:"4"},{default:a(()=>[e(ce,{label:"Selecione a Pessoa",modelValue:t(g).pessoa,"onUpdate:modelValue":s[2]||(s[2]=p=>t(g).pessoa=p),items:t($),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(U,{cols:"3"},{default:a(()=>[e(ce,{label:"Papel",modelValue:t(g).papeis,"onUpdate:modelValue":s[3]||(s[3]=p=>t(g).papeis=p),items:t(M),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),c("div",null,[c("img",{class:"mt-3",src:ae,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Ve})])]),_:1}),e(w,null,{default:a(()=>[e(U,null,{default:a(()=>[e(de,{style:{height:"465px"},headers:ge,items:t(P)},{"item.actions":a(({item:p})=>[e(w,null,{default:a(()=>[c("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ue=>Pe(p),title:"Visualizar Ficha"},Xe,8,Je),c("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ue=>Ae(p),class:"mr-2",title:"Alterar Papel"},Qe,8,We),c("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ue=>Ce(p),title:"Deletar Pessoa"},[p.excluido?(E(),L("img",ea)):(E(),L("img",aa))],8,Ze),c("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ue=>we(p),title:"Selecionar Representante"},sa,8,ta)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(B,{show:t(j),onClose:s[4]||(s[4]=p=>j.value=!1)},null,8,["show"]),e(Y,{representante_nome:t(D),representantes:t(F),ato_id:t(o),show:t(A),onClose:s[5]||(s[5]=p=>A.value=!1),onUpdateRepresentante:ke},null,8,["representante_nome","representantes","ato_id","show"]),e(O,{representante_nome:t(D),ato_token:t(m),ato_id:t(u),show:t(C),onClose:s[6]||(s[6]=p=>C.value=!1),onUpdatePapel:be},null,8,["representante_nome","ato_token","ato_id","show"]),e(ye,{modelValue:t(v),"onUpdate:modelValue":s[8]||(s[8]=p=>ee(v)?v.value=p:null),width:"600"},{default:a(()=>[e(ve,{"max-width":"600",title:"Ficha"},{default:a(()=>[e(Oe,{src:t(z)},null,8,["src"]),e(G,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:s[7]||(s[7]=p=>v.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(w,null,{default:a(()=>[e(ze,{onClick:Te},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[q("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},ra=["onClick"],na={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},ia={key:1,src:pe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},ua={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(W){let l,y;const b=se(),_=Q(),n=Z(),{$toast:h}=oe(),S=`${n.public.managemant}/listarEscrevente`;`${n.public.managemant}`;const x=`${n.public.managemant}/createAtosObservacao`,R=`${n.public.managemant}/updateAtosObservacao`,I=`${n.public.managemant}/getAtosObservacaoById`,k=r(N("user-data").value.cartorio_token),d=r([]),V=r([]),$=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],P=le({observacao:null}),M={observacao:{required:Me.withMessage("O campo é obrigatorio",Fe)}},A=Ne(M,P),{data:j}=([l,y]=X(()=>f(`${I}/${_.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),l=await l,y(),l);d.value=j.value.map(o=>({...o,created:fe(o.created,"dd/mm/yyyy")}));async function v(){if(await A.value.$validate()){const{data:o,error:u,status:T}=await f(x,{method:"POST",body:{ato_id:_.query.ato_id,observacao:P.observacao,user_id:N("user-data").value.usuario_id}},"$gnHMo4uCXD");T.value==="success"&&(d.value.push({data:fe(o.value.created,"dd/mm/yyyy"),observacao:o.value.observacao,id:o.value.id,escrevente:N("user-data").value.nome}),h.success("Observação registrada com sucesso"))}else h.error("Preencha os campos obrigatorios.")}async function C(o){o.excluido=!o.excluido;try{await f(`${R}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$sP9AKdd3Ky")}catch(u){console.error("Erro ao excluir observacao:",u)}}const{data:F}=([l,y]=X(()=>f(S,{method:"POST",body:{cartorio_token:k}},"$HL9pndqGh0")),l=await l,y(),l);V.value=F.value[0].func_json_escreventes;const D=()=>{const o=_.query.origem||"criar",u=_.query.id;o==="atualizar"?b.push(`/os/atualizar/${u}`):b.push("/os/criar-registro")};return(o,u)=>{const T=te;return E(),re(ne,null,{default:a(()=>[e(w,{class:"mt-5"},{default:a(()=>[e(K,{label:"Observação",modelValue:t(P).observacao,"onUpdate:modelValue":u[0]||(u[0]=m=>t(P).observacao=m),required:"","error-messages":t(A).observacao.$errors.map(m=>m.$message),onBlur:t(A).observacao.$touch,onInput:t(A).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),c("div",null,[c("img",{class:"btn-pointer ml-2",src:ae,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:v})])]),_:1}),e(w,null,{default:a(()=>[e(U,null,{default:a(()=>[e(de,{style:{height:"465px"},headers:$,items:t(d)},{"item.actions":a(({item:m})=>[c("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:z=>C(m),title:"Deletar Observação"},[m.excluido?(E(),L("img",na)):(E(),L("img",ia))],8,ra)]),_:1},8,["items"])]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(T,{onClick:D},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[q("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},ca=c("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Re,alt:"Escanear"},null,-1),da=[ca],ma=c("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ae,alt:"Criar"},null,-1),pa=[ma],_a=["onClick"],va=c("img",{style:{width:"30px",height:"30px"},src:me,alt:"Visualizar"},null,-1),fa=[va],ya=["onClick"],ga={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},ha={key:1,src:pe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},xa={__name:"Anexos",async setup(W){let l,y;const b=Z(),{$toast:_}=oe(),n=se(),h=Q(),S=`${b.public.biometria}/run-scanner`,x=`${b.public.managemant}/atos_anexos`,R=`${b.public.managemant}/atos_anexos`,I=`${b.public.managemant}/atos_anexos`,k=r(!1),d=r([]),V=le({descricao:""}),$=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:P}=([l,y]=X(()=>f(`${I}/${h.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),l=await l,y(),l);d.value=P.value;async function M(){try{await A(),await j()}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}}async function A(){try{const{data:o}=await f(S,{method:"GET"},"$KttjFhHivJ")}catch(o){_.error("Erro ao acionar o scanner:",o)}}async function j(){try{const{data:o,status:u}=await f("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:h.query.ato_token_edit,cartorio_token:N("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(o){console.error("Erro ao enviar o arquivo:",o)}}const v=async()=>{k.value=!0},C=async()=>{const{data:o,error:u,status:T}=await f(x,{method:"POST",body:{ato_id:h.query.ato_id,descricao:V.descricao,user_id:N("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");T.value==="success"&&(_.success("Anexo registrado com sucesso!"),d.value.push(o.value))};async function F(o){o.excluido=!o.excluido;try{await f(`${R}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$cdoFBGO0Ti")}catch(u){console.error("Erro ao excluir pessoa:",u)}}const D=()=>{const o=h.query.origem||"criar",u=h.query.id;o==="atualizar"?n.push(`/os/atualizar/${u}`):n.push("/os/criar-registro")};return(o,u)=>{const T=te;return E(),re(ne,null,{default:a(()=>[e(w,null,{default:a(()=>[e(U,{cols:"5"},{default:a(()=>[e(K,{modelValue:t(V).descricao,"onUpdate:modelValue":u[0]||(u[0]=m=>t(V).descricao=m),label:"Descrição"},null,8,["modelValue"])]),_:1}),c("div",{onClick:M,title:"Escanear"},da),c("div",{onClick:C,title:"Criar"},pa)]),_:1}),e(de,{headers:$,items:t(d),style:{height:"465px","max-width":"600px"}},{"item.actions":a(({item:m})=>[e(w,null,{default:a(()=>[c("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:z=>v(m),title:"Visualizar Anexo"},fa,8,_a),c("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:z=>F(m),title:"Deletar Pessoa"},[m.excluido?(E(),L("img",ga)):(E(),L("img",ha))],8,ya)]),_:2},1024)]),_:1},8,["items"]),e(ye,{modelValue:t(k),"onUpdate:modelValue":u[2]||(u[2]=m=>ee(k)?k.value=m:null),width:"600"},{default:a(()=>[e(ve,{"max-width":"600",title:"Anexo"},{default:a(()=>[e(G,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:u[1]||(u[1]=m=>k.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(T,{onClick:D},{default:a(()=>[e(G,{size:"large",color:"red"},{default:a(()=>[q("Voltar")]),_:1})]),_:1})]),_:1})}}},$a=c("h1",{class:"mb-2"},"Procuração",-1),ja={__name:"[id]",async setup(W){let l,y;const b=r(null),_=r(null),n=r(null),h=Z(),S=Q(),x=`${h.public.managemant}/listarSituacoes`,R=`${h.public.managemant}/getAtos`,I=r(N("user-data").value.cartorio_token),k=S.query.id?{ato_token:"xkyaA"}:{cartorio_token:I},d=r([]),V=r([]);async function $(){try{const{data:v}=await f(`${R}/${S.query.id}`,{method:"GET"},"$j0JpHHj7PB");V.value=v.value}catch(v){console.log(v)}}[l,y]=X(()=>$()),await l,y();const{data:P,status:M}=([l,y]=X(()=>f(x,{method:"POST",body:k},"$mGbp7gAEjS")),l=await l,y(),l);d.value=P.value;const A=v=>{b.value=v},j=v=>{_.value=v};return(v,C)=>{const F=He,D=la,o=Ie,u=je,T=ua,m=xa;return E(),L(qe,null,[$a,e(ve,{width:"1300"},{default:a(()=>[e(Ge,{modelValue:t(n),"onUpdate:modelValue":C[0]||(C[0]=z=>ee(n)?n.value=z:null),"bg-color":"#f5f2f2"},{default:a(()=>[e(H,{value:"dados"},{default:a(()=>[q("Dados")]),_:1}),e(H,{value:"partes"},{default:a(()=>[q("Partes")]),_:1}),e(H,{value:"minuta"},{default:a(()=>[q("Minuta")]),_:1}),e(H,{value:"livro"},{default:a(()=>[q("Livro")]),_:1}),e(H,{value:"observacao"},{default:a(()=>[q("Observações")]),_:1}),e(H,{value:"anexo"},{default:a(()=>[q("Anexos")]),_:1})]),_:1},8,["modelValue"]),e(Le,{modelValue:t(n),"onUpdate:modelValue":C[1]||(C[1]=z=>ee(n)?n.value=z:null)},{default:a(()=>[e(J,{value:"dados"},{default:a(()=>[e(F,{item_dados:t(V),item_situacoes:t(d)},null,8,["item_dados","item_situacoes"])]),_:1}),e(J,{value:"partes"},{default:a(()=>[e(D)]),_:1}),e(J,{value:"minuta"},{default:a(()=>[e(o,{onPage:A,onDoc:j})]),_:1}),e(J,{value:"livro"},{default:a(()=>[e(u,{pages:t(b),document:t(_)},null,8,["pages","document"])]),_:1}),e(J,{value:"observacao"},{default:a(()=>[e(T)]),_:1}),e(J,{value:"anexo"},{default:a(()=>[e(m)]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}};export{ja as default};
