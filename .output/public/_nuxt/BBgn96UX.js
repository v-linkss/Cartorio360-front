import{_ as le}from"./SFgSy8c6.js";import{_ as ue,a as de}from"./TqBp9VPQ.js";import{u as pe,B as me,r as l,m as r,C as ce,H as ve,Q as _e,E as g,w as i,s as fe,o as m,b as n,a as u,t as ge,v as t,R as be,V as O,K as M,x as ke,y as Ve,c as H,z as ye,d as Ce}from"./DNqa37ts.js";import{_ as xe}from"./BTCAHaEy.js";import{_ as $e}from"./BVz1G1IN.js";import{_ as he,a as we,b as Oe}from"./By6a24Bq.js";import{c as G,r as J,u as Re}from"./BPPh6Rmt.js";import{u as R}from"./t3Arjasg.js";import"./hwtBqxyr.js";import{V as Se}from"./DiDwurZf.js";import{V}from"./CEW8B1s9.js";import{V as y}from"./vhdmPbFS.js";import{V as Ee}from"./Db-2z3gp.js";import{V as De}from"./DcJEx7kN.js";import"./laOSfSzG.js";import"./Ca026VwB.js";import"./BGDAOq0v.js";import"./BfstPCe7.js";import"./k__Dlqjf.js";const Ae={style:{color:"red","margin-left":"30px"}},Be=["onClick","title"],Ne=["disabled","onClick"],Te={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:we,alt:"Visualizar",title:"Reativar"},qe={key:1,src:Oe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},oa={__name:"criar-registro",async setup(ze){var T,q,z,F,P,I,U;let b,S;const{$toast:v}=pe(),E=me(),C=fe(),j=`${C.public.managemant}/createOrdensServico`,K=`${C.public.managemant}/validarCpf`,Q=`${C.public.managemant}/listarAtos`,W=l(r("user-data").value.cartorio_id),X=l(r("user-data").value.usuario_id),Y=l((T=r("user-service").value)==null?void 0:T.token).value||null,Z=l(r("user-data").value.cartorio_token).value,D=l((q=r("user-service").value)==null?void 0:q.numero),k=l((z=r("user-service").value)==null?void 0:z.isDisabled);let A=l(!!((F=r("user-service").value)!=null&&F.numero)),x=l(r("ordem-button").value),$=!1;const h=l(!1),w=l([]),s=ce({nacionalidade:((P=r("user-service").value)==null?void 0:P.estrangeiro)||!1,apresentante_nome:(I=r("user-service").value)==null?void 0:I.apresentante_nome,apresentante_cpf:(U=r("user-service").value)==null?void 0:U.apresentante_cpf}),_=l(!1),ee=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],ae=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],te={apresentante_nome:{required:G.withMessage("O campo é obrigatorio",J)},apresentante_cpf:{required:G.withMessage("O campo é obrigatorio",J)}},p=Re(te,s);function B(o){if(o)return o.replace(/[.\-]/g,"");o=null}const oe=o=>{o.tipo==="PROCURAÇÃO GERAL"?E.push({path:`/fontes/atos/atos-sem-bem/atualizar/${o.id}`,query:{origem:"atualizar",id:r("user-service").value.id,ato_id:o.id,tipo_ato_token:o.tipo_token,ato_token_edit:o.token,numero_os:numeroOs}}):E.push({path:`/fontes/atos/atos-com-bem/atualizar/${o.id}`,query:{origem:"atualizar",id,ato_id:o.id,tipo_ato_token:o.tipo_token,ato_token_edit:o.token,numero_os:numeroOs.value}})};function re(){const o=r("user-service"),e=r("ordem-button");o.value=null,e.value=null}const se=()=>{h.value=!0};async function ie(){const o={apresentante_cpf:B(s.apresentante_cpf),apresentante_nome:s.apresentante_nome,user_id:X.value,cartorio_id:W.value,estrangeiro:s.nacionalidade};if(await p.value.$validate()){const{data:e,error:c,status:d}=await R(j,{method:"POST",body:o},"$HqnOwnLBio");if(d.value==="error"&&c.value.statusCode===500)v.error("Erro ao cadastrar ordem,erro no sistema.");else{v.success("Ordem registrada com sucesso!"),A.value=!0,x.value=!1,D.value=e.value.numero;const f=r("ordem-button");f.value=x.value;const a=r("user-service");a.value=a.value=JSON.stringify({numero:e.value.numero,id:e.value.id,apresentante_cpf:e.value.apresentante_cpf,apresentante_nome:e.value.apresentante_nome,estrangeiro:e.value.estrangeiro,token:e.value.token,isDisabled:!0}),_.value=!0}}}async function ne(o){const e=B(o);if(e.length===11&&!$){$=!0;const c={cpf:e};try{const{data:d,error:f,status:a}=await R(K,{method:"POST",body:c},"$DfuVr7OuaN");a.value==="error"&&f.value.statusCode===500?v.error("Erro ao cadastrar pessoa, o CPF já está cadastrado."):d.value.cpfValidation===!0?(s.apresentante_nome=d.value.nome,v.success("Cpf autenticado com sucesso!")):d.value.cpfValidation===!1&&v.error("Cpf não cadastrado!")}catch(d){console.error("Erro ao validar CPF:",d)}finally{$=!1}}}const{data:N}=([b,S]=ve(()=>R(Q,{method:"POST",body:{cartorio_token:Z,ordemserv_token:Y}},"$bJ1XcDsWLH")),b=await b,S(),b);return N.value.length>0?w.value=N.value:w.value=[],(o,e)=>{const c=le,d=de,f=_e("mask");return m(),g(Se,{class:"mt-5"},{default:i(()=>[n(V,{class:"mb-5"},{default:i(()=>{var a;return[e[8]||(e[8]=u("h1",null,"Ordem de Serviço nº",-1)),u("h1",Ae,ge(t(D)||((a=("useCookie"in o?o.useCookie:t(r))("user-service").value)==null?void 0:a.numero)),1)]}),_:1}),n(V,null,{default:i(()=>[n(y,{md:"3"},{default:i(()=>[n(Ee,{label:"Nacionalidade",items:ae,modelValue:t(s).nacionalidade,"onUpdate:modelValue":e[0]||(e[0]=a=>t(s).nacionalidade=a),disabled:t(k)||t(_)},null,8,["modelValue","disabled"])]),_:1}),n(y,{md:"2"},{default:i(()=>[t(s).nacionalidade===!1?be((m(),g(O,{key:0,autofocus:"",modelValue:t(s).apresentante_cpf,"onUpdate:modelValue":e[1]||(e[1]=a=>t(s).apresentante_cpf=a),label:"CPF",required:"","error-messages":t(p).apresentante_cpf.$errors.map(a=>a.$message),onBlur:t(p).apresentante_cpf.$touch,onInput:e[2]||(e[2]=a=>ne(t(s).apresentante_cpf)),disabled:t(k)||t(_)},null,8,["modelValue","error-messages","onBlur","disabled"])),[[f,"###.###.###-##"]]):(m(),g(O,{key:1,autofocus:"",modelValue:t(s).apresentante_cpf,"onUpdate:modelValue":e[3]||(e[3]=a=>t(s).apresentante_cpf=a),label:"Documento",required:"","error-messages":t(p).apresentante_cpf.$errors.map(a=>a.$message),onBlur:t(p).apresentante_cpf.$touch,disabled:t(k)||t(_)},null,8,["modelValue","error-messages","onBlur","disabled"]))]),_:1}),n(y,{md:"4"},{default:i(()=>[n(O,{modelValue:t(s).apresentante_nome,"onUpdate:modelValue":e[4]||(e[4]=a=>t(s).apresentante_nome=a),label:"Nome Apresentante",required:"","error-messages":t(p).apresentante_nome.$errors.map(a=>a.$message),onInput:t(p).apresentante_nome.$touch,disabled:t(k)||t(_)},null,8,["modelValue","error-messages","onInput","disabled"])]),_:1}),t(x)?(m(),g(y,{key:0},{default:i(()=>[u("div",null,[u("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:xe,alt:"Salvar",onClick:e[5]||(e[5]=a=>ie())})])]),_:1})):M("",!0)]),_:1}),t(A)?(m(),g(V,{key:0,style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:i(()=>[e[11]||(e[11]=u("h1",{class:"ml-5"},"Atos",-1)),n(c,{to:{path:"/os/criar-ato",query:{origem:"criar"}}},{default:i(()=>e[9]||(e[9]=[u("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:$e,alt:"novo"},null,-1)])),_:1}),n(De,{headers:ee,items:t(w),"item-key":"id"},{"item.actions":i(({item:a})=>[n(V,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:i(()=>[u("div",{onClick:e[6]||(e[6]=L=>se()),title:"Reimprimir"},e[10]||(e[10]=[u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ue,alt:"Reimprimir"},null,-1)])),u("div",{class:Ve({disabled:!a.btn_editar}),onClick:L=>a.btn_editar?oe({id:a.id,tipo:a.tipo,token:a.token,tipo_token:a.tipo_token}):null,title:a.btn_editar?"Editar":"Desabilitado"},[u("img",{style:ke({cursor:a.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:he,alt:"Editar"},null,4)],10,Be),u("div",{disabled:!a.btn_cancelar,onClick:L=>a.btn_cancelar?o.deleteEndereco(a):null,title:"Excluir"},[a.excluido?(m(),H("img",Te)):(m(),H("img",qe))],8,Ne)]),_:2},1024)]),_:1},8,["items"]),n(d,{show:t(h),onClose:e[7]||(e[7]=a=>h.value=!1)},null,8,["show"])]),_:1})):M("",!0),n(c,{to:"/os/lista"},{default:i(()=>[n(ye,{size:"large",color:"red",onClick:re},{default:i(()=>e[12]||(e[12]=[Ce("Voltar")])),_:1})]),_:1})]),_:1})}}};export{oa as default};
