import{_ as se}from"./CeWK_ytP.js";import{u as te,n as ae,q as W,r,s as ce,o as U,v as re,w as t,b as e,x as a,V as ee,y as F,d as D,z as X,A as L,B as K,a as m,C as ve,c as B,D as Q,E as Ie,F as je,G as Me,H as Re,I as $e,J as fe,K as be,t as le}from"./CropSq2V.js";import{u as $}from"./BcIQ9BCj.js";import{V as q}from"./BP1vB3BJ.js";import{V as S}from"./KPeMZ9U3.js";import{V as oe}from"./Doxf15c9.js";import{V as ue}from"./BnMVzetc.js";import{_ as Fe}from"./B4HC5FVQ.js";import{_ as Be,a as Ne,b as Le,T as Ge,W as He,r as ke,D as Ve,c as Je,d as Ke,e as We}from"./TzH1R2oh.js";import{_ as ge}from"./BO9-Zdnw.js";import{_ as ie,a as ye,b as he,c as Xe}from"./BERFvrep.js";import{V as we,a as de}from"./fXsN22MG.js";import{_ as xe}from"./DfjuBLsA.js";import{c as Ye,r as Ze,u as Qe}from"./CblQ7m_u.js";import{V as et,a as Y,b as tt,c as Z}from"./B3SkMjFy.js";import"./c1xK8bT8.js";import"./CkrlGOd0.js";const at={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(G){const s=G,{$toast:h}=te(),_=X(),v=ae(),n=W(),x=`${_.public.managemant}/updateAtos`,z=r(s.item_situacoes),w=ce({dt_abertura:s.item_dados[0].dt_abertura||null,status:s.item_dados[0].status||null,mne:s.item_dados[0].mne||null});async function I(){const{data:f,error:c,status:P}=await $(`${x}/${n.query.ato_id}`,{method:"PUT",body:{status:w.status,mne:w.mne,dt_abertura:w.dt_abertura}},"$EIT5jtTUdX");P.value==="success"&&h.success("Ato Atualizado com sucesso")}const T=()=>{const f=n.query.origem||"criar",c=n.query.id;f==="atualizar"?v.push(`/os/atualizar/${c}`):v.push("/os/criar-registro")};return(f,c)=>{const P=se;return U(),re(ue,null,{default:t(()=>[e(q,{class:"mt-5"},{default:t(()=>[e(S,{cols:"3"},{default:t(()=>[e(oe,{label:"Situação",modelValue:a(w).status,"onUpdate:modelValue":c[0]||(c[0]=k=>a(w).status=k),items:a(z),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(S,{cols:"5"},{default:t(()=>[e(ee,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:a(w).mne,"onUpdate:modelValue":c[1]||(c[1]=k=>a(w).mne=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(S,{cols:"2"},{default:t(()=>[e(ee,{modelValue:a(w).dt_abertura,"onUpdate:modelValue":c[2]||(c[2]=k=>a(w).dt_abertura=k),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(q,{class:"mb-3"},{default:t(()=>[e(P,{onClick:T},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[D("Voltar")]),_:1})]),_:1}),e(F,{class:"ml-10",onClick:I,size:"large",color:"green"},{default:t(()=>[D("Salvar")]),_:1})]),_:1})]),_:1})}}},ot=["onClick"],st=m("img",{style:{width:"30px",height:"30px"},src:ge,alt:"Visualizar"},null,-1),rt=[st],nt=["onClick"],lt=m("img",{style:{width:"30px",height:"30px"},src:Xe,alt:"Visualizar"},null,-1),it=[lt],ct=["onClick"],ut={key:0,style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar",title:"Reativar"},dt={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},mt=["onClick"],pt=m("img",{style:{width:"30px",height:"30px"},src:Le,alt:"Visualizar"},null,-1),_t=[pt],vt={__name:"Partes",async setup(G){let s,h;const _=ae(),v=W(),n=X(),{$toast:x}=te(),z=`${n.public.managemant}/pesquisarPessoas`,w=`${n.public.managemant}/listarPapeis`,I=`${n.public.managemant}/getLinkTipo`,T=`${n.public.managemant}/createAtosPessoa`,f=`${n.public.managemant}/updateAtosPessoa`,c=`${n.public.managemant}/getAtosPessoaById`,P=r(L("user-data").value.cartorio_token),k=r([]),V=r([]),j=r([]),O=r(!1),p=r(!1),l=r(!1),u=r(!1),C=r(null),y=r(null),o=r(null),d=r(null),M=r(null),A=r("xkyaA"),N=r(null),me=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],b=ce({papeis:null,nome:null,pessoa:null,documento:null}),{data:Ce}=([s,h]=K(()=>$(w,{method:"POST",body:{tipo_ato_token:"xkyaA"}},"$acoiTIUp00")),s=await s,h(),s);j.value=Ce.value;const pe=async()=>{const{data:g}=await $(`${c}/${v.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),R=(ne=>ne.map(H=>({...H,pessoa:{...H.pessoa,documento:H.pessoa.doc_identificacao},papel:{...H.partes_tipos}})))(g.value);V.value=R};pe();async function Pe(){try{const{data:g,error:i}=await $(z,{method:"POST",body:{cartorio_token:P.value,documento:b.documento,nome:b.nome}},"$pr30MyPXfY");g.value.length>0?(k.value=g.value,b.pessoa=k.value[0]):k.value=[]}catch(g){console.error("Erro na requisição",g)}}const Ae=()=>{p.value=!0},Ee=async()=>{await pe()},qe=async()=>{await pe()},Te=async()=>{const g={pessoa:b.pessoa,papel:j.value.find(J=>J.id===b.papeis),representante:{nome:null}},i=await $(`${c}/${v.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const J of i.data.value)if(J.pessoa_id===b.pessoa.id&&J.ato_id===Number(v.query.ato_id)&&J.tipo_parte_id===b.papeis){x.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:R,error:ne,status:H}=await $(T,{method:"POST",body:{ato_id:v.query.ato_id,pessoa_id:b.pessoa.id,tipo_parte_id:b.papeis,user_id:L("user-data").value.usuario_id}},"$18isAgOJxG");H.value==="success"&&(g.id=R.value.id,x.success("Pessoa Registrada com Sucesso!"),V.value.push(g))},ze=async g=>{l.value=!0,N.value=null;const{data:i}=await $(`${I}`,{method:"POST",body:{id:g.pessoa.id,tipo:"ficha"}},"$hmDzSF3F61");i.value&&i.value.link?N.value=`data:image/jpeg;base64,${i.value.link}`:N.value=null},Oe=g=>{const i=V.value.filter(R=>R.pessoa.id!==g.pessoa.id).map(R=>({id:R.pessoa.id,nome:R.pessoa.nome}));o.value=g.id,C.value=i,O.value=!0,y.value=g.pessoa.nome,M.value=g.pessoa.id},De=g=>{u.value=!0,d.value=g.id,y.value=g.pessoa.nome};async function Se(g){g.excluido=!g.excluido;try{await $(`${f}/${g.id}`,{method:"PUT",body:JSON.stringify({excluido:g.excluido})},"$l09I6nLRfk")}catch(i){console.error("Erro ao excluir pessoa:",i)}}const Ue=()=>{const g=v.query.origem||"criar",i=v.query.id;g==="atualizar"?_.push(`/os/atualizar/${i}`):_.push("/os/criar-registro")};return(g,i)=>{const R=Fe,ne=Be,H=Ne,J=se;return U(),re(ue,null,{default:t(()=>[e(q,{class:"mt-5"},{default:t(()=>[e(S,{cols:"3"},{default:t(()=>[e(ee,{label:"Documento",modelValue:a(b).documento,"onUpdate:modelValue":i[0]||(i[0]=E=>a(b).documento=E)},null,8,["modelValue"])]),_:1}),e(S,{cols:"4"},{default:t(()=>[e(ee,{label:"Pessoa",modelValue:a(b).nome,"onUpdate:modelValue":i[1]||(i[1]=E=>a(b).nome=E)},null,8,["modelValue"])]),_:1}),m("div",null,[m("img",{class:"mt-3",src:ge,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:Pe})]),m("div",null,[m("img",{class:"mt-3 ml-2",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Ae})])]),_:1}),e(q,null,{default:t(()=>[e(S,{cols:"4"},{default:t(()=>[e(oe,{label:"Selecione a Pessoa",modelValue:a(b).pessoa,"onUpdate:modelValue":i[2]||(i[2]=E=>a(b).pessoa=E),items:a(k),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(S,{cols:"3"},{default:t(()=>[e(oe,{label:"Papel",modelValue:a(b).papeis,"onUpdate:modelValue":i[3]||(i[3]=E=>a(b).papeis=E),items:a(j),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),m("div",null,[m("img",{class:"mt-3",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Te})])]),_:1}),e(q,null,{default:t(()=>[e(S,null,{default:t(()=>[e(ve,{style:{height:"465px"},headers:me,items:a(V)},{"item.actions":t(({item:E})=>[e(q,null,{default:t(()=>[m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:_e=>ze(E),title:"Visualizar Ficha"},rt,8,ot),m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:_e=>De(E),class:"mr-2",title:"Alterar Papel"},it,8,nt),m("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:_e=>Se(E),title:"Deletar Pessoa"},[E.excluido?(U(),B("img",ut)):(U(),B("img",dt))],8,ct),m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:_e=>Oe(E),title:"Selecionar Representante"},_t,8,mt)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(R,{show:a(p),onClose:i[4]||(i[4]=E=>p.value=!1)},null,8,["show"]),e(ne,{representante_nome:a(y),representantes:a(C),ato_id:a(o),show:a(O),onClose:i[5]||(i[5]=E=>O.value=!1),onUpdateRepresentante:qe},null,8,["representante_nome","representantes","ato_id","show"]),e(H,{representante_nome:a(y),ato_token:a(A),ato_id:a(d),show:a(u),onClose:i[6]||(i[6]=E=>u.value=!1),onUpdatePapel:Ee},null,8,["representante_nome","ato_token","ato_id","show"]),e(we,{modelValue:a(l),"onUpdate:modelValue":i[8]||(i[8]=E=>Q(l)?l.value=E:null),width:"600"},{default:t(()=>[e(de,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(Ie,{src:a(N)},null,8,["src"]),e(F,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:i[7]||(i[7]=E=>l.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(q,null,{default:t(()=>[e(J,{onClick:Ue},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[D("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},ft={key:0,class:"loading-overlay"},gt="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",yt={__name:"Minuta",props:{ato_token:{type:String,required:!0}},emits:["page","doc"],setup(G,{emit:s}){je("DocumentEditorContainer",[Ge,He]);const h=X(),{$toast:_}=te(),v=ae(),n=W(),x=s;ke(`${h.public.docEditor}`);const z=`${h.public.managemant}/download`,w=`${h.public.managemant}/atos/files`,I=`${h.public.managemant}/upload`,T=r(null),f=r(!1),c=async p=>{try{const l=await fetch(p);if(!l.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await l.blob()}catch(l){return console.error(l),_.error("Erro ao carregar o documento inicial."),null}},P=async()=>{try{const{data:p}=await $(`${w}/${n.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return p.value.link_ato}catch(p){console.error("Erro ao carregar o documento:",p),_.error(p)}},k=async()=>{f.value=!0;try{const p=await P(),{data:l,status:u}=await $(z,{method:"POST",body:{bucket:"qvgjz",path:p}},"$dvNFfvmIJC"),C=l.value,y=await c(C);if(y){const o=new FileReader;o.onload=()=>{const d=o.result;T.value.ej2Instances.documentEditor.open(d),x("doc",d)},o.readAsText(y)}else _.error("Erro ao carregar o documento do MinIO.")}catch(p){console.error("Erro ao carregar o documento:",p),_.error("Erro ao carregar o documento.")}finally{f.value=!1}},V=async()=>{const l=await T.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),u=new FileReader;u.onload=()=>{u.result;const y=T.value.ej2Instances.documentEditor.pageCount;x("page",y)},u.readAsText(l)},j=async()=>{f.value=!0;try{const l=await T.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),u=new FormData;u.append("file",l,"anexo.sfdt"),u.append("cartorio_token",L("user-data").value.cartorio_token),u.append("token",n.query.ato_token_edit),u.append("tipo","ato_minuta");const{data:C,status:y}=await $(I,{method:"POST",body:u},"$xv11VtUdMy");if(y.value==="success"){_.success("Documento enviado!");const d=T.value.ej2Instances.documentEditor.pageCount;V(),x("page",d)}else _.error("Erro ao enviar documento para o sistema.")}catch(p){_.error("Erro ao salvar documento."),console.error(p)}finally{f.value=!1}},O=()=>{const p=n.query.origem||"criar",l=n.query.id;p==="atualizar"?v.push(`/os/atualizar/${l}`):v.push("/os/criar-registro")};return Me(async()=>{await k(),V()}),(p,l)=>{const u=se;return U(),B(fe,null,[e(a(Ve),{height:"900px",ref_key:"documentEditorContainer",ref:T,serviceUrl:gt,enableToolbar:!0,enableWordExport:!0},null,512),a(f)?(U(),B("div",ft,[e(Re,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):$e("",!0),e(q,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e(u,{class:"mr-4"},{default:t(()=>[e(F,{size:"large",onClick:O,color:"red"},{default:t(()=>[D("Voltar")]),_:1})]),_:1}),e(F,{size:"large",color:"green",onClick:j,disabled:a(f)},{default:t(()=>[D("Salvar")]),_:1},8,["disabled"])]),_:1})],64)}}},ht={class:"d-flex align-center justify-center"},bt=["innerHTML"],xt={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(G){let s,h;const _=G,v=X();ke(`${v.public.docEditor}`);const{$toast:n}=te(),x=ae(),z=W(),w=`${v.public.managemant}/download`,I=`${v.public.managemant}/lavrarAto`,T=r("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),f=r(!1),c=r(null),P=r(null),k=r(null);[s,h]=K(()=>$(w,{method:"POST",body:{bucket:"qvgjz",path:"ato/fKumj/ato_minuta-2024-12-13T14:57:36.974Z"}},"$FnEbAJEARP")),s=await s,h();const V=async()=>{try{const{data:l,status:u}=await $(I,{method:"POST",body:{ato_token:z.query.ato_token_edit,qtd_paginas:_.pages}},"$7ljqltMqa0");u.value==="success"?(c.value=l.value,P.value=l.value[0].selo,n.success("Ato lavrado com sucesso!")):n.error("Falha ao lavrar o ato.")}catch{n.error("Erro ao conectar com o servidor.")}},j=()=>{f.value=!1,V()},O=function(){k.value.ej2Instances.documentEditor.open(_.document)},p=()=>{const l=z.query.origem||"criar",u=z.query.id;l==="atualizar"?x.push(`/os/atualizar/${u}`):x.push("/os/criar-registro")};return(l,u)=>{const C=Ke;return U(),B(fe,null,[e(q,null,{default:t(()=>[e(S,null,{default:t(()=>[e(a(Ve),{restrictEditing:!0,enableToolbar:!1,created:_.document?O:null,ref_key:"documentEditorContainer",ref:k,height:"850px",width:"850px"},null,8,["created"])]),_:1}),e(S,null,{default:t(()=>[m("div",ht,[m("div",null,[m("img",{onClick:u[0]||(u[0]=y=>f.value=!0),class:"ml-15",style:{height:"40px",width:"40px",cursor:"pointer","margin-top":"350px"},src:Je}),a(c)?(U(),re(de,{key:0,width:"360px",class:"mr-16"},{default:t(()=>[e(q,null,{default:t(()=>[e(S,null,{default:t(()=>[e(be,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[D(" Livro: "+le(a(c)[0].livro_numero),1)]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(be,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[D(" Folhas : "+le(a(c)[0].pagina_inicial)+" Á "+le(a(c)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),m("div",{style:{border:"1px solid black","border-radius":"8px","padding-bottom":"20px","margin-top":"-10px"},class:"ml-2 mb-2 mr-2",innerHTML:a(P)},null,8,bt)]),_:1})):$e("",!0)])])]),_:1})]),_:1}),e(F,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:p},{default:t(()=>[D("Voltar")]),_:1}),e(C,{show:a(f),condMessage:a(T),onClose:u[1]||(u[1]=y=>f.value=!1),onConfirm:j},null,8,["show","condMessage"])],64)}}},$t=["onClick"],kt={key:0,style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar",title:"Reativar"},Vt={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},wt={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(G){let s,h;const _=ae(),v=W(),n=X(),{$toast:x}=te(),z=`${n.public.managemant}/listarEscrevente`;`${n.public.managemant}`;const w=`${n.public.managemant}/createAtosObservacao`,I=`${n.public.managemant}/updateAtosObservacao`,T=`${n.public.managemant}/getAtosObservacaoById`,f=r(L("user-data").value.cartorio_token),c=r([]),P=r([]),k=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],V=ce({observacao:""}),j={observacao:{required:Ye.withMessage("O campo é obrigatório",Ze)}},O=Qe(j,V),{data:p}=([s,h]=K(()=>$(`${T}/${v.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),s=await s,h(),s);c.value=p.value.map(o=>({...o,created:xe(o.created,"dd/mm/yyyy hh:mm")}));async function l(){if(V.observacao.trim()===""){x.error("O campo de observação está vazio.");return}if(await O.value.$validate()){const{data:o,error:d,status:M}=await $(w,{method:"POST",body:{ato_id:v.query.ato_id,observacao:V.observacao,user_id:L("user-data").value.usuario_id}},"$gnHMo4uCXD");M.value==="success"&&(c.value.push({created:xe(o.value.created,"dd/mm/yyyy hh:mm"),observacao:o.value.observacao,id:o.value.id,escrevente:L("user-data").value.nome}),V.observacao="",x.success("Observação registrada com sucesso"))}else x.error("Preencha os campos obrigatórios.")}async function u(o){o.excluido=!o.excluido;try{await $(`${I}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$sP9AKdd3Ky")}catch(d){console.error("Erro ao excluir observação:",d)}}const{data:C}=([s,h]=K(()=>$(z,{method:"POST",body:{cartorio_token:f}},"$HL9pndqGh0")),s=await s,h(),s);P.value=C.value[0].func_json_escreventes;const y=()=>{const o=v.query.origem||"criar",d=v.query.id;o==="atualizar"?_.push(`/os/atualizar/${d}`):_.push("/os/criar-registro")};return(o,d)=>{const M=se;return U(),re(ue,null,{default:t(()=>[e(q,{class:"mt-5"},{default:t(()=>[e(ee,{label:"Observação",modelValue:V.observacao,"onUpdate:modelValue":d[0]||(d[0]=A=>V.observacao=A),required:"","error-messages":a(O).observacao.$errors.length>0?a(O).observacao.$errors.map(A=>A.$message):[],onBlur:a(O).observacao.$touch,onInput:a(O).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),m("div",null,[m("img",{class:"btn-pointer ml-2",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:l})])]),_:1}),e(q,null,{default:t(()=>[e(S,null,{default:t(()=>[e(ve,{style:{height:"465px"},headers:k,items:c.value},{"item.actions":t(({item:A})=>[m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:N=>u(A),title:"Deletar Observação"},[A.excluido?(U(),B("img",kt)):(U(),B("img",Vt))],8,$t)]),_:1},8,["items"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(M,{onClick:y},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[D("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},Ct=m("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:We,alt:"Escanear"},null,-1),Pt=[Ct],At=m("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ie,alt:"Criar"},null,-1),Et=[At],qt=["onClick"],Tt=m("img",{style:{width:"30px",height:"30px"},src:ge,alt:"Visualizar"},null,-1),zt=[Tt],Ot=["onClick"],Dt={key:0,style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar",title:"Reativar"},St={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ut={__name:"Anexos",async setup(G){let s,h;const _=X(),{$toast:v}=te(),n=ae(),x=W(),z=`${_.public.biometria}/run-scanner`,w=`${_.public.managemant}/atos_anexos`,I=`${_.public.managemant}/atos_anexos`,T=`${_.public.managemant}/atos_anexos`,f=r(!1),c=r([]),P=ce({descricao:""}),k=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:V}=([s,h]=K(()=>$(`${T}/${x.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),s=await s,h(),s);c.value=V.value;async function j(){try{await O(),await p()}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}}async function O(){try{const{data:o}=await $(z,{method:"GET"},"$KttjFhHivJ")}catch(o){v.error("Erro ao acionar o scanner:",o)}}async function p(){try{const{data:o,status:d}=await $("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:x.query.ato_token_edit,cartorio_token:L("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(o){console.error("Erro ao enviar o arquivo:",o)}}const l=async()=>{f.value=!0},u=async()=>{const{data:o,error:d,status:M}=await $(w,{method:"POST",body:{ato_id:x.query.ato_id,descricao:P.descricao,user_id:L("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");M.value==="success"&&(v.success("Anexo registrado com sucesso!"),c.value.push(o.value))};async function C(o){o.excluido=!o.excluido;try{await $(`${I}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$cdoFBGO0Ti")}catch(d){console.error("Erro ao excluir pessoa:",d)}}const y=()=>{const o=x.query.origem||"criar",d=x.query.id;o==="atualizar"?n.push(`/os/atualizar/${d}`):n.push("/os/criar-registro")};return(o,d)=>{const M=se;return U(),re(ue,null,{default:t(()=>[e(q,null,{default:t(()=>[e(S,{cols:"5"},{default:t(()=>[e(ee,{modelValue:a(P).descricao,"onUpdate:modelValue":d[0]||(d[0]=A=>a(P).descricao=A),label:"Descrição"},null,8,["modelValue"])]),_:1}),m("div",{onClick:j,title:"Escanear"},Pt),m("div",{onClick:u,title:"Criar"},Et)]),_:1}),e(ve,{headers:k,items:a(c),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:A})=>[e(q,null,{default:t(()=>[m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:N=>l(A),title:"Visualizar Anexo"},zt,8,qt),m("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:N=>C(A),title:"Deletar Pessoa"},[A.excluido?(U(),B("img",Dt)):(U(),B("img",St))],8,Ot)]),_:2},1024)]),_:1},8,["items"]),e(we,{modelValue:a(f),"onUpdate:modelValue":d[2]||(d[2]=A=>Q(f)?f.value=A:null),width:"600"},{default:t(()=>[e(de,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(F,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:d[1]||(d[1]=A=>f.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(M,{onClick:y},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[D("Voltar")]),_:1})]),_:1})]),_:1})}}},It={class:"mb-10"},jt=m("h1",null,"Ordem de Serviço nº",-1),Mt={style:{color:"red","margin-left":"30px"}},oa={__name:"[id]",async setup(G){let s,h;const _=r(null),v=r(null),n=r(null),x=X(),z=W(),w=`${x.public.managemant}/listarSituacoes`,I=`${x.public.managemant}/getAtos`,T=r(L("user-data").value.cartorio_token),f=z.query.id?{ato_token:"xkyaA"}:{cartorio_token:T},c=r([]),P=r([]),k=r("PROCURAÇÕES"),V=r("PROCURAÇÃO");async function j(){try{const{data:C}=await $(`${I}/${z.query.ato_id}`,{method:"GET"},"$j0JpHHj7PB");P.value=C.value}catch(C){console.log(C)}}[s,h]=K(()=>j()),await s,h();const{data:O,status:p}=([s,h]=K(()=>$(w,{method:"POST",body:f},"$mGbp7gAEjS")),s=await s,h(),s);c.value=O.value;const l=C=>{_.value=C},u=C=>{v.value=C};return(C,y)=>{const o=at,d=vt,M=yt,A=xt,N=wt,me=Ut;return U(),B(fe,null,[m("div",It,[e(q,{class:"mb-5 mt-5"},{default:t(()=>[jt,m("h1",Mt,le(a(z).query.numero_os),1)]),_:1}),e(q,null,{default:t(()=>[e(S,{md:"6"},{default:t(()=>[e(oe,{class:"mr-5",modelValue:a(k),"onUpdate:modelValue":y[0]||(y[0]=b=>Q(k)?k.value=b:null),disabled:""},null,8,["modelValue"])]),_:1}),e(S,{md:"6"},{default:t(()=>[e(oe,{modelValue:a(V),"onUpdate:modelValue":y[1]||(y[1]=b=>Q(V)?V.value=b:null),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),e(de,{width:"1300"},{default:t(()=>[e(et,{modelValue:a(n),"onUpdate:modelValue":y[2]||(y[2]=b=>Q(n)?n.value=b:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(Y,{value:"dados"},{default:t(()=>[D("Dados")]),_:1}),e(Y,{value:"partes"},{default:t(()=>[D("Partes")]),_:1}),e(Y,{value:"minuta"},{default:t(()=>[D("Minuta")]),_:1}),e(Y,{value:"livro"},{default:t(()=>[D("Livro")]),_:1}),e(Y,{value:"observacao"},{default:t(()=>[D("Observações")]),_:1}),e(Y,{value:"anexo"},{default:t(()=>[D("Anexos")]),_:1})]),_:1},8,["modelValue"]),e(tt,{modelValue:a(n),"onUpdate:modelValue":y[3]||(y[3]=b=>Q(n)?n.value=b:null)},{default:t(()=>[e(Z,{value:"dados"},{default:t(()=>[e(o,{item_dados:a(P),item_situacoes:a(c)},null,8,["item_dados","item_situacoes"])]),_:1}),e(Z,{value:"partes"},{default:t(()=>[e(d)]),_:1}),e(Z,{value:"minuta"},{default:t(()=>[e(M,{onPage:l,onDoc:u})]),_:1}),e(Z,{value:"livro"},{default:t(()=>[e(A,{pages:a(_),document:a(v)},null,8,["pages","document"])]),_:1}),e(Z,{value:"observacao"},{default:t(()=>[e(N)]),_:1}),e(Z,{value:"anexo"},{default:t(()=>[e(me)]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}};export{oa as default};
