import{_ as oe}from"./DPb5jq2a.js";import{a as ae,_ as re}from"./dXsF4MFc.js";import{_ as se}from"./Bd4UA481.js";import{_ as ne}from"./BVz1G1IN.js";import{_ as le}from"./DBYo90Sj.js";import{_ as ie}from"./9TTkgyo5.js";import{_ as ue}from"./EsOYsYPW.js";import{c as U,r as I,u as pe}from"./DnOoLqhe.js";import{u as de}from"./ByG5sPdk.js";import{u as me,K as ce,D as _e,r as u,e as g,f as fe,y as z,m as ve,h,w as l,k as ge,o as w,b as s,a as n,t as ke,i as o,q as ye,s as C,v as k,x as be,V as xe,d as Ve}from"./CjdyK_m5.js";import{u as O}from"./CT27lbGv.js";import{f as $e}from"./DhR0JXWd.js";import{V as he}from"./oklY1td0.js";import{V as y}from"./DWbd9EcM.js";import{V as b}from"./D4T2yNAN.js";import{V as we}from"./Rcy_4dQe.js";import{V as Ce}from"./Ckem3Z7V.js";import"./DyiIymhB.js";import"./CZEv6lO5.js";import"./CI7W-XCt.js";import"./BBORrtxt.js";import"./C_awkvvH.js";import"./781hVIPN.js";import"./DHwHzLJ3.js";import"./BmbD0RKA.js";import"./BjPv2kQ6.js";import"./B8JOU1RQ.js";const Oe={style:{color:"red","margin-left":"30px"}},Te=["onClick"],Re=["onClick","title"],Ae=["onClick","title"],Se=["onClick"],Ue=["title"],lt={__name:"[id]",async setup(Ie){let i,c;const{redirectTo:T}=de(),{$toast:R}=me(),B=ce(),{id:d}=B.params,N=_e(),_=ge(),D=`${_.public.managemant}/updateOrdensServico`,E=`${_.public.managemant}/getOrdensServicoById`,P=`${_.public.managemant}/listarAtos`,q=`${_.public.managemant}/updateAtos`,F=u(g("user-data").value.cartorio_id),M=u(g("user-data").value.usuario_id),G=u(g("user-service").value.token).value||null,K=u(g("user-data").value.cartorio_token).value,x=u([]),V=u(!1),A=u(null),m=u(null),r=fe({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),L=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],W=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],X={apresentante_nome:{required:U.withMessage("O campo é obrigatorio",I)},apresentante_cpf:{required:U.withMessage("O campo é obrigatorio",I)}},p=pe(X,r);function Y(a){if(a)return a.replace(/[.\-]/g,"");a=null}const Z=a=>{A.value=a,V.value=!0},j=a=>{T({item:a,id:d,numeroOs:m.value,origem:"vizualizar"})},H=a=>{T({item:a,id:d,numeroOs:m.value,origem:"atualizar"})};async function J(){const a={apresentante_cpf:Y(r.apresentante_cpf),apresentante_nome:r.apresentante_nome,user_id:M.value,cartorio_id:F.value},{error:t,status:v}=await O(`${D}/${d}`,{method:"PUT",body:a},"$Fud06ay483");v.value==="error"&&t.value.statusCode===500?R.error("Erro ao cadastrar ordem,erro no sistema."):(R.success("Ordem Atualizada com sucesso!"),N.push({path:"/os/lista"}))}const{data:f}=([i,c]=z(()=>O(`${E}/${d}`,{method:"GET"},"$wPUkUpDvPf")),i=await i,c(),i);m.value=f.value.numero,r.nacionalidade=f.value.estrangeiro,r.apresentante_cpf=f.value.apresentante_cpf,r.apresentante_nome=f.value.apresentante_nome;const{data:S}=([i,c]=z(()=>O(P,{method:"POST",body:{cartorio_token:K,ordemserv_token:G}},"$YXZ55K3IUf")),i=await i,c(),i);async function Q(a){a.excluido=!a.excluido;try{await $e(`${q}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(t){console.error("Erro ao excluir pessoa:",t)}}return S.value.length>0?x.value=S.value:x.value=[],(a,t)=>{const v=oe,ee=re,te=ve("mask");return w(),h(he,{class:"mt-5"},{default:l(()=>[s(y,{class:"mb-5"},{default:l(()=>[t[6]||(t[6]=n("h1",null,"Ordem de Serviço nº",-1)),n("h1",Oe,ke(o(m)),1)]),_:1}),s(y,null,{default:l(()=>[s(b,{md:"3"},{default:l(()=>[s(we,{label:"Nacionalidade",items:W,modelValue:o(r).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>o(r).nacionalidade=e)},null,8,["modelValue"])]),_:1}),s(b,{md:"2"},{default:l(()=>[o(r).nacionalidade==="brasileiro"?ye((w(),h(C,{key:0,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>o(r).apresentante_cpf=e),label:"CPF",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch,onInput:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[te,"###.###.###-##"]]):(w(),h(C,{key:1,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>o(r).apresentante_cpf=e),label:"Documento",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),s(b,{md:"4"},{default:l(()=>[s(C,{modelValue:o(r).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>o(r).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":o(p).apresentante_nome.$errors.map(e=>e.$message),onInput:o(p).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),s(b,null,{default:l(()=>[n("div",null,[n("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:se,alt:"Salvar",onClick:t[4]||(t[4]=e=>J())})])]),_:1})]),_:1}),s(y,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:l(()=>[t[9]||(t[9]=n("h1",{class:"ml-5"},"Atos",-1)),s(v,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:o(d),numeroOs:o(m)}}},{default:l(()=>t[7]||(t[7]=[n("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:ne,alt:"novo"},null,-1)])),_:1},8,["to"]),s(Ce,{headers:L,items:o(x),"item-key":"id"},{"item.actions":l(({item:e})=>[s(y,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:l(()=>[n("div",{onClick:$=>j(e),title:"Visualizar"},t[8]||(t[8]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:le,alt:"Visualizar"},null,-1)]),8,Te),n("div",{onClick:$=>Z(e.token),title:e.btn_selos?"Reimprimir Selo":"Não permitido"},[n("img",{style:k({opacity:e.btn_selos?"1":"0.5",cursor:e.btn_selos?"pointer":"not-allowed",width:"30px",height:"30px"}),src:ae,alt:"Reimprimir"},null,4)],8,Re),n("div",{class:be({disabled:!e.btn_editar}),onClick:$=>e.btn_editar?H({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,rota:e.rota}):null,title:e.btn_editar?"Editar":"Desabilitado"},[n("img",{style:k({opacity:e.btn_editar?"1":"0.5",cursor:e.btn_editar?"pointer":"not-allowed",width:"30px",height:"30px"}),src:ie,alt:"Editar"},null,4)],10,Ae),n("div",{onClick:$=>e.btn_cancelar?Q(e):null,title:"Excluir",style:k({cursor:e.btn_cancelar?"pointer":"not-allowed"})},[n("img",{style:k({width:"30px",height:"30px",cursor:e.btn_cancelar?"pointer":"not-allowed",opacity:e.btn_cancelar?"1":"0.5"}),src:ue,alt:"Cancelar",title:e.btn_cancelar?"Cancelar":"Não permitido"},null,12,Ue)],12,Se)]),_:2},1024)]),_:1},8,["items"]),s(ee,{show:o(V),ato_token:o(A),onClose:t[5]||(t[5]=e=>V.value=!1)},null,8,["show","ato_token"])]),_:1}),s(v,{to:"/os/lista"},{default:l(()=>[s(xe,{size:"large",color:"red"},{default:l(()=>t[10]||(t[10]=[Ve("Voltar")])),_:1})]),_:1})]),_:1})}}};export{lt as default};
