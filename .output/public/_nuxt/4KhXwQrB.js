import{_ as oe}from"./CBb0Lq8A.js";import{_ as se}from"./DpJOzKLq.js";import{_ as ae}from"./D5Gxa-sV.js";import{_ as ne}from"./CiyMiKB0.js";import{_ as O}from"./BMGF0xjM.js";import{_ as re,c as le}from"./CbZ9Gm3h.js";import{z as ie,D as ue,u as ce,r as l,m as g,A as me,E as de,c as pe,b as t,w as n,v as s,I as ve,s as fe,o as _e,V as q,a as i,H as R,d as z}from"./D1c8MT99.js";import{u as y}from"./BBBqhHrz.js";import{V}from"./DwksRT6y.js";import{V as c}from"./DZiR4O8B.js";import{V as ke}from"./6uGaMLD-.js";import{V as S}from"./C5u4n-cQ.js";import"./CHVlbpPm.js";import"./DkKyVs5P.js";import"./Cx7E1Brn.js";import"./DV1a2Ht0.js";import"./BH1-Tibl.js";import"./DUtQO6Xq.js";import"./CNj5vv1D.js";import"./C8eQ1OAb.js";import"./CdP3NN9a.js";import"./BpQyL2ns.js";const ge=["onClick"],ye=["onClick"],Ie={__name:"autencidade",props:{ato_token:{type:String,required:!0}},async setup(B){let p,$;const P=B;console.log(P.ato_token);const E=ie(),T=ue(),v=fe(),{$toast:U}=ce(),j=`${v.public.managemant}/listarEscrevente`,D=`${v.public.managemant}/pesquisarPessoas`,I=`${v.public.managemant}/atoReconhecimento`,N=`${v.public.managemant}/etiquetaAutenticidade`,f=l(g("user-data").value.cartorio_token),K=l(g("user-service").value.token).value||l(g("user-service").value).value,H=g("auth_token").value,w=l([]),A=l([]),m=l([]),_=l(!1),h=l(!1),b=l(!1),x=l(null),C=l(""),M=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],r=me({quantidade:1,escrevente:null,nome:null,documento:null}),{data:L}=([p,$]=de(()=>y(j,{method:"POST",body:{cartorio_token:f}},"$qpB20nOlUE")),p=await p,$(),p);A.value=L.value[0].func_json_escreventes;async function Q(){try{const{data:o,error:e}=await y(D,{method:"POST",body:{cartorio_token:f.value,documento:r.documento,nome:r.nome}},"$CfpM9wZnUE");o.value.length>0?w.value=o.value:w.value=[]}catch(o){console.error("Erro na requisição",o)}}const Z=()=>{h.value=!0};function W(o){m.value.push(o)}const G=o=>{x.value=o,b.value=!0};function J(o){m.value=m.value.filter(e=>e.token!==o.token)}async function X(){if(!r.escrevente){U.error("Por favor selecione um Escrevente");return}try{const o=m.value.map(u=>({pessoa_token:u.token})),{data:e,error:k,status:d}=await y(I,{method:"POST",body:{pessoas:o,cartorio_token:f.value,ordemserv_token:K,quantidade:r.quantidade,usuario_token:H,ato_tipo_token:P.ato_token}},"$LrKAtpxZwH");d.value==="success"&&e.value[0].status==="OK"?(Y(e.value[0].token),F()):(_.value=!0,C.value=ato_token.value.status_mensagem||k.value.data.details)}catch(o){_.value=!0,C.value=o,console.error("Erro na requisição",o)}}async function Y(o){try{const{data:e,error:k,status:d}=await y(N,{method:"POST",body:{ato_token:o,cartorio_token:f.value,escrevente_token:r.escrevente}},"$EE94jKo1pQ");if(d.value==="success"){const u=window.open("","_blank");u.document.open(),u.document.write(e.value[0].etiqueta),u.document.close()}}catch(e){console.error("Erro na requisição",e)}}const F=()=>{const o=T.query.origem||"criar",e=T.query.id;o==="atualizar"?E.push(`/os/atualizar/${e}`):E.push("/os/criar-registro")};return(o,e)=>{const k=oe,d=se,u=ae,ee=ne;return _e(),pe(ve,null,[t(V,{class:"mt-5"},{default:n(()=>[t(c,{cols:"5"},{default:n(()=>[t(ke,{label:"Tabelião/escrevente",modelValue:s(r).escrevente,"onUpdate:modelValue":e[0]||(e[0]=a=>s(r).escrevente=a),items:s(A),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"2"},{default:n(()=>[t(q,{label:"Quantidade",type:"number",modelValue:s(r).quantidade,"onUpdate:modelValue":e[1]||(e[1]=a=>s(r).quantidade=a)},null,8,["modelValue"])]),_:1})]),_:1}),t(V,null,{default:n(()=>[t(c,{cols:"3"},{default:n(()=>[t(q,{label:"Documento",modelValue:s(r).documento,"onUpdate:modelValue":e[2]||(e[2]=a=>s(r).documento=a)},null,8,["modelValue"])]),_:1}),t(c,{cols:"4"},{default:n(()=>[t(q,{label:"Pessoa",modelValue:s(r).nome,"onUpdate:modelValue":e[3]||(e[3]=a=>s(r).nome=a)},null,8,["modelValue"])]),_:1}),i("div",null,[i("img",{class:"btn-pointer mt-1",src:O,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:Q})]),i("div",null,[i("img",{class:"btn-pointer mt-1 ml-2",src:re,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Z})])]),_:1}),t(V,null,{default:n(()=>[t(c,{class:"mr-10"},{default:n(()=>[t(S,{style:{height:"465px"},headers:M,items:s(w)},{"item.actions":n(({item:a})=>[i("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:te=>G(a),title:"Visualizar Ficha"},e[8]||(e[8]=[i("img",{style:{width:"30px",height:"30px"},src:O,alt:"Visualizar"},null,-1)]),8,ge)]),_:1},8,["items"])]),_:1}),t(c,null,{default:n(()=>[t(S,{headers:M,items:s(m),style:{height:"465px"},"item-key":"id"},{"item.actions":n(({item:a})=>[i("div",{style:{display:"flex","justify-content":"flex-end"},onClick:te=>J(a),title:"Remover"},e[9]||(e[9]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:le,alt:"Remover"},null,-1)]),8,ye)]),_:1},8,["items"])]),_:1})]),_:1}),t(k,{show:s(h),onClose:e[4]||(e[4]=a=>h.value=!1)},null,8,["show"]),t(d,{show:s(b),item:s(x),onConfirmar:e[5]||(e[5]=a=>W(s(x))),onClose:e[6]||(e[6]=a=>b.value=!1)},null,8,["show","item"]),t(u,{show:s(_),errorMessage:s(C),onClose:e[7]||(e[7]=a=>_.value=!1)},null,8,["show","errorMessage"]),t(V,null,{default:n(()=>[t(ee,{onClick:F},{default:n(()=>[t(R,{size:"large",color:"red"},{default:n(()=>e[10]||(e[10]=[z("Voltar")])),_:1})]),_:1}),t(R,{class:"ml-5",onClick:X,size:"large",color:"green"},{default:n(()=>e[11]||(e[11]=[z("Salvar")])),_:1})]),_:1})],64)}}};export{Ie as default};
