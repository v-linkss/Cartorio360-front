import{_ as no}from"./BM5O2AHl.js";import{_ as ro,a as io}from"./M6DIDGcb.js";import{_ as uo}from"./D61GUFtg.js";import{_ as mo}from"./BIe6-2n3.js";import{_ as L}from"./BrcCccMj.js";import{_ as po}from"./Cw1dkSY0.js";import{_ as co,u as _o,r as u,m as C,n as vo,p as fo,q as yo,s as ko,c as S,b as s,w as n,a as r,v as l,x as Vo,y as bo,F as go,z as $o,o as g,A as f,V as d,B as ho,C as xo}from"./CxZkCJJO.js";import{_ as wo,a as Ao}from"./DJvq3mCv.js";import{u as Co}from"./C28TpzMU.js";import{u as y}from"./CQnvv-2I.js";import{f as $}from"./B0IxRygJ.js";import{f as So}from"./BibqZaSv.js";import{V as Uo}from"./BQ0TWYA2.js";import{V as Do}from"./DfcMba_O.js";import{V as U}from"./Dsp-y3Jd.js";import{V as i}from"./CLC37q8S.js";import{V as D}from"./DbLniB7v.js";import"./BQwL5JaM.js";import"./hDdAZVcF.js";import"./1arHLVoa.js";import"./BYI-Z_2T.js";import"./SYqJ8RP3.js";import"./RNUW-J5z.js";import"./D8mQnlH0.js";import"./BVz1G1IN.js";import"./C0TgggJK.js";import"./flODEQtC.js";import"./D43sOJMp.js";const Oo=""+new URL("btn_cancela_lavratura.DGZVG9h_.png",import.meta.url).href,Po={style:{width:"1300px",margin:"0 auto"}},To={style:{display:"flex",gap:"4px","justify-content":"center"}},No=["onClick"],Eo=["onClick"],Ro=["onClick","title"],Mo=["disabled","onClick"],Io=["onClick"],qo={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:wo,alt:"Visualizar",title:"Reativar"},zo={key:1,src:Ao,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Fo={__name:"index",setup(Lo){const _=$o(),{$toast:O}=_o(),B=`${_.public.managemant}/listarUsuarios`,H=`${_.public.managemant}/listar_tipo_atos`,j=`${_.public.managemant}/cancela_lavratura`,J=`${_.public.managemant}/updateAtos`,P=`${_.public.managemant}/pesquisaAtos`,{redirectTo:T}=Co(),k=u(C("auth_token").value)||null,h=u(C("user-data").value.cartorio_token)||null,x=u(!1),V=u([]),N=u([]),E=u([]),G=u(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),R=u(!1),w=u(!1),M=u(""),W=u(null),Y=u({}),A=u(!1),I=u(null),e=vo({numero:null,data_inicio:q(),data_fim:q(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:k.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),Z=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:t=>t.protocolo?`${t.id}
${t.protocolo}`:`${t.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:t=>t.dt_abertura?`${t.dt_abertura}
${t.apresentante_cpf}`:`${t.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:t=>t.dt_lavratura?`${t.dt_lavratura}
${t.apresentante_nome}`:`${t.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:t=>t.situacao?`${t.situacao}
${t.ato_servico}`:`${t.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function q(){const t=new Date,o=t.getFullYear(),m=String(t.getMonth()+1).padStart(2,"0");return`${String(t.getDate()).padStart(2,"0")}-${m}-${o}`}function c(t){if(!t)return null;const[o,m,p]=t.split("/");return`${p}-${m}-${o}`}async function z(){const t=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(t),{data:m}=await y(P,{method:"POST",body:{cartorio_token:C("user-data").value.cartorio_token,usuario_token:o.usuario_token||k.value,data_fim:c(o==null?void 0:o.data_fim),data_inicio:c(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");m.value.length>0&&(V.value=m.value.map(p=>({...p,dt_lavratura:p.dt_lavratura?$(p.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:$(p.dt_abertura,"dd/mm/yyyy")})))}async function K(){const{data:t}=await y(B,{method:"POST",body:{cartorio_token:h.value}},"$hvipqUJYtS");N.value=t.value}async function Q(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(e));const{data:t}=await y(P,{method:"POST",body:{cartorio_token:h.value,numero:e.numero||null,data_inicio:c(e.data_inicio)||null,data_fim:c(e.data_fim)||null,data_lavratura_inicio:c(e.data_lavratura_inicio)||null,data_lavratura_fim:c(e.data_lavratura_fim)||null,protocolo:e.protocolo||null,livro:e.livro||null,folha:e.folha||null,situacao:e.situacao||null,usuario_token:e.usuario_token,selo:e.selo||null,ato_tipo_token:e.ato_tipo_token,parte:e.parte||null}},"$OjamgBH6nj");t.value.length>0?V.value=t.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?$(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?$(o.dt_abertura,"dd/mm/yyyy"):null})):(V.value=[],O.error("Não existe ato Registrado!"))}catch(t){console.error("Erro na requisição",t)}}const X=t=>{T({item:t,id:t.id,numeroOs:t.numero_os,origem:"vizualizar-lista"})};async function oo(){const{data:t,error:o}=await y(H,{method:"POST",body:{cartorio_token:h.value,usuario_token:k.value,tipo_retorno:"servico_ato"}},"$QxIfw0Zxe4");E.value=t.value}const to=t=>{I.value=t,A.value=!0};async function ao(t){t.excluido=!t.excluido;try{await So(`${J}/${t.id}`,{method:"PUT",body:{excluido:t.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}const F=async t=>{const{data:o,status:m}=await y(j,{method:"POST",body:{ato_token:t,user_token:k.value,cancelar_selo:!1}},"$ceiptlfDNO");m.value==="success"&&o.value[0].status==="OK"?O.success("Lavratura cancelada com sucesso!"):o.value[0].status==="ERRO"&&(w.value=!0,M.value=o.value[0].status_mensagem)},eo=t=>{T({item:t,id:t.id,numeroOs:t.numero_os,origem:"atualizar-lista"})};return fo(()=>{yo(async()=>{const t=sessionStorage.getItem("pesquisaAto");if(t){const o=JSON.parse(t);Object.assign(e,o)}await z()})}),K(),oo(),(t,o)=>{const m=no,p=ro,lo=uo,so=mo,v=ko("mask");return g(),S(go,null,[s(Uo,{class:"mt-5"},{default:n(()=>[s(U,{class:"mb-5"},{default:n(()=>o[19]||(o[19]=[r("h1",null,"Atos",-1)])),_:1}),s(U,null,{default:n(()=>[s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(e).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=a=>l(e).data_inicio=a),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(e).data_fim,"onUpdate:modelValue":o[1]||(o[1]=a=>l(e).data_fim=a),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(e).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=a=>l(e).data_lavratura_inicio=a),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(e).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=a=>l(e).data_lavratura_fim=a),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(e).numero,"onUpdate:modelValue":o[4]||(o[4]=a=>l(e).numero=a),label:"N° OS"},null,8,["modelValue"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(e).selo,"onUpdate:modelValue":o[5]||(o[5]=a=>l(e).selo=a),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),s(U,null,{default:n(()=>[s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(e).protocolo,"onUpdate:modelValue":o[6]||(o[6]=a=>l(e).protocolo=a),label:"Protocolo"},null,8,["modelValue"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(e).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=a=>l(e).apresentante_cpf=a),label:"CPF",dense:""},null,8,["modelValue"]),[[v,"###.###.###-##"]])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(d,{modelValue:l(e).parte,"onUpdate:modelValue":o[8]||(o[8]=a=>l(e).parte=a),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(D,{modelValue:l(e).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=a=>l(e).ato_tipo_token=a),items:l(E),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(D,{items:l(N),modelValue:l(e).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=a=>l(e).usuario_token=a),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(D,{modelValue:l(e).situacao,"onUpdate:modelValue":o[11]||(o[11]=a=>l(e).situacao=a),items:l(G),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),s(i,{cols:"1"},{default:n(()=>[s(d,{modelValue:l(e).livro,"onUpdate:modelValue":o[12]||(o[12]=a=>l(e).livro=a),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"1"},{default:n(()=>[s(d,{modelValue:l(e).folha,"onUpdate:modelValue":o[13]||(o[13]=a=>l(e).folha=a),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),s(i,null,{default:n(()=>[r("div",null,[r("img",{onClick:Q,style:{width:"40px",height:"40px",cursor:"pointer"},src:L,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),r("div",Po,[o[23]||(o[23]=r("hr",{class:"mt-5 mb-5"},null,-1)),s(Do,{headers:Z,items:l(V),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":n(({item:a})=>[r("div",To,[r("div",{onClick:b=>X({id:a.id,tipo:`${a.tipo_servico} - ${a.tipo_ato}`,token:a.token,tipo_token:a.tipo_token,rota:a.rota,numero_os:a.numero_os}),title:"Visualizar"},o[20]||(o[20]=[r("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:L,alt:"Visualizar"},null,-1)]),8,No),r("div",{onClick:b=>to(a.token),title:"Reimprimir"},o[21]||(o[21]=[r("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:io,alt:"Reimprimir"},null,-1)]),8,Eo),r("div",{class:ho({disabled:!a.btn_editar}),onClick:b=>a.btn_editar?eo({id:a.id,tipo:`${a.tipo_servico} - ${a.tipo_ato}`,token:a.token,tipo_token:a.tipo_token,rota:a.rota,numero_os:a.numero_os}):null,title:a.btn_editar?"Editar":"Desabilitado"},[r("img",{style:xo({cursor:a.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:po,alt:"Editar"},null,4)],10,Ro),r("div",{disabled:!a.btn_cancelar,onClick:b=>a.btn_cancelar?F(a.token):null,title:"Excluir"},o[22]||(o[22]=[r("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:Oo,alt:"Cancelar",title:"Cancelar"},null,-1)]),8,Mo),r("div",{onClick:b=>ao(a),title:"Excluir"},[a.excluido?(g(),S("img",qo)):(g(),S("img",zo))],8,Io)])]),_:1},8,["items"])]),l(x)?(g(),Vo(m,{key:0,show:l(x),servicos:t.dadosData.servicos||[],tiposAtos:t.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=a=>x.value=!1),onUpdateAto:t.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):bo("",!0),s(p,{show:l(A),ato_token:l(I),onClose:o[15]||(o[15]=a=>A.value=!1)},null,8,["show","ato_token"]),s(lo,{show:l(R),numero_os:l(W),ordem:l(Y),onClose:o[16]||(o[16]=a=>R.value=!1),onRefreshValue:o[17]||(o[17]=a=>z())},null,8,["show","numero_os","ordem"]),s(so,{show:l(w),condMessage:l(M),onClose:o[18]||(o[18]=a=>w.value=!1),onConfirm:F},null,8,["show","condMessage"])],64)}}},yt=co(Fo,[["__scopeId","data-v-d68ef1b3"]]);export{yt as default};
