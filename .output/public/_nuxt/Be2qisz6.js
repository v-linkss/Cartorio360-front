import{_ as ne}from"./9FT2BGcq.js";import{u as ae,n as se,q as X,r as u,s as ue,o as U,v as ie,w as t,b as e,x as a,V as le,y as F,d as z,z as Q,A as G,B as K,a as d,c as L,C as te,t as re,D as Ie,E as Re,F as je,G as Fe,H as we,I as be,h as Ne,J as xe}from"./w3NWm4HW.js";import{u as $}from"./DOLxPJ5L.js";import{V as T}from"./Ba9CZdDb.js";import{V as O}from"./BlVTgBiw.js";import{V as oe}from"./Dat9v9YZ.js";import{V as de}from"./V8CB7uvp.js";import{_ as Le,V as Ge,a as Z,b as He,c as ee}from"./xFMdNX_5.js";import{_ as Je,a as We,b as Ke,T as Xe,W as Qe,S as Ye,r as Ce,D as Pe,c as Ze,d as et,e as tt}from"./DPDjNT_L.js";import{_ as _e}from"./DEOpz1QL.js";import{_ as ce,V as ve,a as fe,b as ge,c as Ae}from"./DiC6tfvJ.js";import{V as $e,a as me,b as ot,c as at,d as st}from"./D_bWhZb6.js";import{V as rt}from"./ARp0-J0n.js";import{_ as lt}from"./-MLJy1Cb.js";import{V as ke}from"./Bcwz0w56.js";import{_ as Ve}from"./DfjuBLsA.js";import{c as nt,r as it,u as ct}from"./DzWo8pPo.js";import"./CsBA56Xu.js";import"./CHF_v-Wu.js";import"./CmjBZBZA.js";import"./Bvu8p2Ty.js";const ut={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(J){const i=J,{$toast:f}=ae(),_=Q(),y=se(),c=X(),k=`${_.public.managemant}/updateAtos`,D=u(i.item_situacoes),A=ue({dt_abertura:i.item_dados[0].dt_abertura||null,status:i.item_dados[0].status||null,mne:i.item_dados[0].mne||null});async function R(){const{data:h,error:p,status:P}=await $(`${k}/${c.query.ato_id}`,{method:"PUT",body:{status:A.status,mne:A.mne,dt_abertura:A.dt_abertura}},"$EIT5jtTUdX");P.value==="success"&&f.success("Ato Atualizado com sucesso")}const S=()=>{const h=c.query.origem||"criar",p=c.query.id;h==="atualizar"?y.push(`/os/atualizar/${p}`):y.push("/os/criar-registro")};return(h,p)=>{const P=ne;return U(),ie(de,null,{default:t(()=>[e(T,{class:"mt-5"},{default:t(()=>[e(O,{cols:"3"},{default:t(()=>[e(oe,{label:"Situação",modelValue:a(A).status,"onUpdate:modelValue":p[0]||(p[0]=v=>a(A).status=v),items:a(D),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(T,null,{default:t(()=>[e(O,{cols:"5"},{default:t(()=>[e(le,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:a(A).mne,"onUpdate:modelValue":p[1]||(p[1]=v=>a(A).mne=v)},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:t(()=>[e(O,{cols:"2"},{default:t(()=>[e(le,{modelValue:a(A).dt_abertura,"onUpdate:modelValue":p[2]||(p[2]=v=>a(A).dt_abertura=v),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{class:"mb-3"},{default:t(()=>[e(P,{onClick:S},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[z("Voltar")]),_:1})]),_:1}),e(F,{class:"ml-10",onClick:R,size:"large",color:"green"},{default:t(()=>[z("Atualizar")]),_:1})]),_:1})]),_:1})}}},dt=["onClick"],mt=d("img",{style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar"},null,-1),pt=[mt],_t=["onClick"],vt=d("img",{style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar"},null,-1),ft=[vt],gt=["onClick"],yt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},ht={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},bt=["onClick"],$t=d("img",{style:{width:"30px",height:"30px"},src:Ke,alt:"Visualizar"},null,-1),xt=[$t],kt={__name:"Partes",async setup(J){let i,f;const _=se(),y=X(),c=Q(),{$toast:k}=ae(),D=`${c.public.managemant}/pesquisarPessoas`,A=`${c.public.managemant}/listarPapeis`,R=`${c.public.managemant}/getLinkTipo`,S=`${c.public.managemant}/createAtosPessoa`,h=`${c.public.managemant}/updateAtosPessoa`,p=`${c.public.managemant}/getAtosPessoaById`,P=u(G("user-data").value.cartorio_token),v=u([]),V=u([]),M=u([]),g=u(!1),j=u(!1),B=u(!1),x=u(!1),m=u(null),E=u(null),o=u(null),r=u(null),n=u(null),s=u("xkyaA"),w=u(null),I=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],l=ue({papeis:null,nome:null,pessoa:null,documento:null}),{data:N}=([i,f]=K(()=>$(A,{method:"POST",body:{tipo_ato_token:"xkyaA"}},"$acoiTIUp00")),i=await i,f(),i);M.value=N.value;const ye=async()=>{const{data:C}=await $(`${p}/${y.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),H=(pe=>pe.map(W=>({...W,pessoa:{...W.pessoa,documento:W.pessoa.doc_identificacao},papel:{...W.partes_tipos}})))(C.value);V.value=H};ye();async function Ee(){try{const{data:C,error:b}=await $(D,{method:"POST",body:{cartorio_token:P.value,documento:l.documento,nome:l.nome}},"$pr30MyPXfY");C.value.length>0?(v.value=C.value,l.pessoa=v.value[0]):v.value=[]}catch(C){console.error("Erro na requisição",C)}}const Te=()=>{j.value=!0},ze=async()=>{await ye()},Oe=async()=>{await ye()},qe=async()=>{const C={pessoa:l.pessoa,papel:M.value.find(Y=>Y.id===l.papeis),representante:{nome:null}},b=await $(`${p}/${y.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const Y of b.data.value)if(Y.pessoa_id===l.pessoa.id&&Y.ato_id===Number(y.query.ato_id)&&Y.tipo_parte_id===l.papeis){k.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:H,error:pe,status:W}=await $(S,{method:"POST",body:{ato_id:y.query.ato_id,pessoa_id:l.pessoa.id,tipo_parte_id:l.papeis,user_id:G("user-data").value.usuario_id}},"$18isAgOJxG");W.value==="success"&&(C.id=H.value.id,k.success("Pessoa Registrada com Sucesso!"),V.value.push(C))},De=async C=>{B.value=!0,w.value=null;const{data:b}=await $(`${R}`,{method:"POST",body:{id:C.pessoa.id,tipo:"ficha"}},"$hmDzSF3F61");b.value&&b.value.link?w.value=`data:image/jpeg;base64,${b.value.link}`:w.value=null},Se=C=>{const b=V.value.filter(H=>H.pessoa.id!==C.pessoa.id).map(H=>({id:H.pessoa.id,nome:H.pessoa.nome}));o.value=C.id,m.value=b,g.value=!0,E.value=C.pessoa.nome,n.value=C.pessoa.id},Ue=C=>{x.value=!0,r.value=C.id,E.value=C.pessoa.nome};async function Me(C){C.excluido=!C.excluido;try{await $(`${h}/${C.id}`,{method:"PUT",body:JSON.stringify({excluido:C.excluido})},"$l09I6nLRfk")}catch(b){console.error("Erro ao excluir pessoa:",b)}}const Be=()=>{const C=y.query.origem||"criar",b=y.query.id;C==="atualizar"?_.push(`/os/atualizar/${b}`):_.push("/os/criar-registro")};return(C,b)=>{const H=Le,pe=Je,W=We,Y=ne;return U(),ie(de,null,{default:t(()=>[e(T,{class:"mt-5"},{default:t(()=>[e(O,{cols:"3"},{default:t(()=>[e(le,{label:"Documento",modelValue:a(l).documento,"onUpdate:modelValue":b[0]||(b[0]=q=>a(l).documento=q)},null,8,["modelValue"])]),_:1}),e(O,{cols:"4"},{default:t(()=>[e(le,{label:"Pessoa",modelValue:a(l).nome,"onUpdate:modelValue":b[1]||(b[1]=q=>a(l).nome=q)},null,8,["modelValue"])]),_:1}),d("div",null,[d("img",{class:"mt-1",src:_e,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:Ee})]),d("div",null,[d("img",{class:"mt-1 ml-2",src:ce,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Te})])]),_:1}),e(T,null,{default:t(()=>[e(O,{cols:"4"},{default:t(()=>[e(oe,{label:"Selecione a Pessoa",modelValue:a(l).pessoa,"onUpdate:modelValue":b[2]||(b[2]=q=>a(l).pessoa=q),items:a(v),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(O,{cols:"3"},{default:t(()=>[e(oe,{label:"Papel",modelValue:a(l).papeis,"onUpdate:modelValue":b[3]||(b[3]=q=>a(l).papeis=q),items:a(M),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),d("div",null,[d("img",{class:"mt-1",src:ce,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:qe})])]),_:1}),e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(ve,{style:{height:"465px"},headers:I,items:a(V)},{"item.actions":t(({item:q})=>[e(T,null,{default:t(()=>[d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:he=>De(q),title:"Visualizar Ficha"},pt,8,dt),d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:he=>Ue(q),class:"mr-2",title:"Alterar Papel"},ft,8,_t),d("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:he=>Me(q),title:"Deletar Pessoa"},[q.excluido?(U(),L("img",yt)):(U(),L("img",ht))],8,gt),d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:he=>Se(q),title:"Selecionar Representante"},xt,8,bt)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(H,{show:a(j),onClose:b[4]||(b[4]=q=>j.value=!1)},null,8,["show"]),e(pe,{representante_nome:a(E),representantes:a(m),ato_id:a(o),show:a(g),onClose:b[5]||(b[5]=q=>g.value=!1),onUpdateRepresentante:Oe},null,8,["representante_nome","representantes","ato_id","show"]),e(W,{representante_nome:a(E),ato_token:a(s),ato_id:a(r),show:a(x),onClose:b[6]||(b[6]=q=>x.value=!1),onUpdatePapel:ze},null,8,["representante_nome","ato_token","ato_id","show"]),e($e,{modelValue:a(B),"onUpdate:modelValue":b[8]||(b[8]=q=>te(B)?B.value=q:null),width:"600"},{default:t(()=>[e(me,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(rt,{src:a(w)},null,8,["src"]),e(F,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:b[7]||(b[7]=q=>B.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(T,null,{default:t(()=>[e(Y,{onClick:Be},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[z("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},Vt=d("label",null,"Valor",-1),wt={style:{width:"800px","font-weight":"500"}},Ct=["onClick"],Pt=d("img",{style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar"},null,-1),At=[Pt],Et=["onClick"],Tt=d("img",{style:{width:"30px",height:"30px"},src:Ae,alt:"Editar"},null,-1),zt=[Tt],Ot=["onClick"],qt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Reativar",title:"Reativar"},Dt={key:1,src:ge,alt:"Excluir",style:{width:"30px",height:"30px"},title:"Excluir"},St=d("label",null,"Valor",-1),Ut={__name:"Bens",async setup(J){let i,f;const _=se(),y=X(),c=Q(),{$toast:k}=ae(),D=`${c.public.managemant}/atos_bens`,A=`${c.public.managemant}/atos_bens`,R=`${c.public.managemant}/atos_bens`,S=`${c.public.managemant}/listarTipoBens`,h=u(G("user-data").value.cartorio_token),p=u(G("user-data").value.usuario_id).value,P=u([]),v=u([]),V=u(!1),M=[{title:"Descrição",align:"start",key:"descricao"},{title:"Valor",align:"end",key:"valor_mercado"},{align:"end",value:"actions"}],g=ue({vlr_alienacao:null,descricao:null,tipo_id:null,tiposBens:[]}),j=async()=>{if(!g.vlr_alienacao&&!g.descricao){k.error("Os campos Descrição e Valor são Obrigatorios!");return}const{data:n,status:s}=await $(`${D}`,{method:"POST",body:{descricao:g.descricao,tipo_id:g.tipo_id,valor_mercado:g.vlr_alienacao,user_id:p,ato_id:Number.parseInt(y.query.ato_id),token:y.query.ato_token_edit}},"$aGIwRtPn6M");s.value==="success"&&(k.success("Bem registrado com sucesso!"),P.value.push(n.value),Object.assign(g,{vlr_alienacao:null,descricao:null,tipo_id:null}))},B=async n=>{const{status:s}=await $(`${A}/${n}`,{method:"PUT",body:{descricao:v.value.descricao,tipo_id:v.value.tipo_id,valor_mercado:v.value.valor_mercado}},"$4hUMyAQlzU");s.value==="success"&&(k.success("Bem Atualizado com sucesso!"),V.value=!1)},x=n=>{const s=P.value.find(w=>w.id===n);s&&(v.value=s,V.value=!0)},{data:m}=([i,f]=K(()=>$(`${S}`,{method:"POST",body:{cartorio_token:h.value,imoveis:!1}},"$da802I2H8c")),i=await i,f(),i);g.tiposBens=m.value;const{data:E}=([i,f]=K(()=>$(`${R}/${y.query.ato_id}`,{method:"GET"},"$iXfJJrO35d")),i=await i,f(),i);P.value=E.value;async function o(n){n.excluido=!n.excluido;try{await $(`${A}/${n.id}`,{method:"PUT",body:JSON.stringify({excluido:n.excluido})},"$PGKHfsa7Pl")}catch(s){console.error("Erro ao excluir pessoa:",s)}}const r=()=>{const n=y.query.origem||"criar",s=y.query.id;n==="atualizar"?_.push(`/os/atualizar/${s}`):_.push("/os/criar-registro")};return(n,s)=>{const w=lt,I=ne;return U(),ie(de,null,{default:t(()=>[e(O,{class:"mt-5",cols:"12"},{default:t(()=>[e(ke,{label:"Descrição",modelValue:a(g).descricao,"onUpdate:modelValue":s[0]||(s[0]=l=>a(g).descricao=l)},null,8,["modelValue"])]),_:1}),e(T,{class:"ml-1 mb-3"},{default:t(()=>[e(O,{class:"mt-6",cols:"8"},{default:t(()=>[e(oe,{label:"Selecione o Tipo",items:a(g).tiposBens,modelValue:a(g).tipo_id,"onUpdate:modelValue":s[1]||(s[1]=l=>a(g).tipo_id=l),"item-title":"descricao","item-value":"id"},null,8,["items","modelValue"])]),_:1}),e(O,{class:"ml-5",cols:"3"},{default:t(()=>[Vt,e(w,{modelValue:a(g).vlr_alienacao,"onUpdate:modelValue":s[2]||(s[2]=l=>a(g).vlr_alienacao=l)},null,8,["modelValue"])]),_:1}),d("div",null,[d("img",{class:"mt-7 ml-4",src:ce,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:j})])]),_:1}),e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(ve,{style:{height:"465px"},headers:M,items:a(P)},{"item.descricao":t(({item:l})=>[d("h3",wt,re(l.descricao),1)]),"item.actions":t(({item:l})=>[e(T,{style:{"margin-top":"-8px"},justify:"end"},{default:t(()=>[d("div",{style:{cursor:"pointer"},class:"mr-2",onClick:N=>n.redirectToFicha(l),title:"Visualizar Ficha"},At,8,Ct),d("div",{style:{cursor:"pointer"},class:"mr-2",onClick:N=>x(l.id),title:"Alterar Papel"},zt,8,Et),d("div",{style:{cursor:"pointer"},class:"mr-2",onClick:N=>o(l),title:"Deletar Pessoa"},[l.excluido?(U(),L("img",qt)):(U(),L("img",Dt))],8,Ot)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e($e,{modelValue:a(V),"onUpdate:modelValue":s[8]||(s[8]=l=>te(V)?V.value=l:null),"max-width":"600px"},{default:t(()=>[e(me,null,{default:t(()=>[e(ot,{style:{color:"green"}},{default:t(()=>[z("Atualizar Bem")]),_:1}),e(at,null,{default:t(()=>[e(O,{class:"mt-1",cols:"12"},{default:t(()=>[e(ke,{label:"Descrição",modelValue:a(v).descricao,"onUpdate:modelValue":s[3]||(s[3]=l=>a(v).descricao=l)},null,8,["modelValue"])]),_:1}),e(T,null,{default:t(()=>[e(O,{class:"mt-6 ml-3",cols:"8"},{default:t(()=>[e(oe,{label:"Selecione o Tipo",items:a(g).tiposBens,modelValue:a(v).tipo_id,"onUpdate:modelValue":s[4]||(s[4]=l=>a(v).tipo_id=l),"item-title":"descricao","item-value":"id"},null,8,["items","modelValue"])]),_:1}),e(O,{class:"ml-5",cols:"3"},{default:t(()=>[St,e(w,{modelValue:a(v).valor_mercado,"onUpdate:modelValue":s[5]||(s[5]=l=>a(v).valor_mercado=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(st,null,{default:t(()=>[e(Ie),e(F,{color:"green",text:"",onClick:s[6]||(s[6]=l=>V.value=!1)},{default:t(()=>[z("Cancelar")]),_:1}),e(F,{color:"green",text:"",onClick:s[7]||(s[7]=l=>B(a(v).id))},{default:t(()=>[z("Salvar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(T,null,{default:t(()=>[e(I,{onClick:r},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[z("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},Mt={key:0,class:"loading-overlay"},Bt="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",It={__name:"Minuta",emits:["page","doc"],setup(J,{emit:i}){Re("DocumentEditorContainer",[Xe,Qe,Ye]);const f=Q(),{$toast:_}=ae(),y=se(),c=X(),k=i;Ce(`${f.public.docEditor}`);const D=`${f.public.managemant}/download`,A=`${f.public.managemant}/atos/files`,R=`${f.public.managemant}/subitituirModelo`,S=`${f.public.managemant}/upload`,h=u(null),p=u(!1),P=async o=>{try{const r=await fetch(o);if(!r.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await r.blob()}catch(r){return console.error(r),_.error("Erro ao carregar o documento inicial."),null}},v=async()=>{try{const{data:o}=await $(`${A}/${c.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return o.value.link_ato}catch(o){console.error("Erro ao carregar o documento:",o),_.error(o)}},V=async()=>{p.value=!0;try{const o=await v(),{data:r,status:n}=await $(D,{method:"POST",body:{bucket:"qvgjz",path:o}},"$dvNFfvmIJC"),s=r.value,w=await P(s);if(w){const I=new FileReader;I.onload=()=>{const l=I.result;h.value.ej2Instances.documentEditor.open(l),k("doc",l)},I.readAsText(w)}}catch{_.error("Erro ao carregar o documento.")}finally{p.value=!1}},M=async()=>{const o=h.value.ej2Instances.documentEditor;console.log(o);const r=await o.saveAsBlob("Sfdt"),n=new FileReader;n.onload=()=>{const s=n.result,I=h.value.ej2Instances.documentEditor.pageCount;k("page",I),k("doc",s)},n.readAsText(r)},g=async()=>{p.value=!0;try{const r=await h.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),n=new FormData;n.append("file",r,"anexo.sfdt"),n.append("cartorio_token",G("user-data").value.cartorio_token),n.append("token",c.query.ato_token_edit),n.append("tipo","ato_minuta");const{data:s,status:w}=await $(S,{method:"POST",body:n},"$xv11VtUdMy");if(w.value==="success"){_.success("Documento enviado!");const l=h.value.ej2Instances.documentEditor.pageCount;M(),k("page",l)}else _.error("Erro ao enviar documento para o sistema.")}catch(o){_.error("Erro ao salvar documento."),console.error(o)}finally{p.value=!1}},j=async()=>{m(!0);try{await B(),m(!0);const{data:o,status:r}=await $(R,{method:"POST",body:{ato_token:c.query.ato_token_edit}},"$zyzWHTXTBW");o.value&&x(o.value)}catch(o){console.error("Erro ao gerar a minuta:",o),_.error("Ocorreu um erro ao gerar a minuta.")}finally{m(!1)}},B=async()=>{try{const{data:o}=await $(D,{method:"POST",body:{bucket:"qvgjz",path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),r=await P(o.value);if(r){const n=new FileReader;n.onload=()=>{const s=n.result;h.value.ej2Instances.documentEditor.open(s),k("doc",s)},n.readAsText(r)}}catch(o){console.error("Erro ao carregar o modelo de minuta:",o),_.error("Falha ao carregar o modelo de minuta.")}},x=o=>{const r=h.value.ej2Instances.documentEditor,n=s=>{for(const[w,I]of Object.entries(s))if(/^<<.+>>$/.test(w))try{r.search.findAll(w),r.search.searchResults.length>0&&r.search.searchResults.replaceAll(I)}catch(l){console.error(`Erro ao substituir o marcador ${w}:`,l)}else if(w==="partes"&&Array.isArray(I)&&I.length>0)for(const l of I)typeof l=="object"&&n(l)};n(o)},m=o=>{p.value=o},E=()=>{const o=c.query.origem||"criar",r=c.query.id;o==="atualizar"?y.push(`/os/atualizar/${r}`):y.push("/os/criar-registro")};return je(async()=>{await V(),M()}),(o,r)=>{const n=ne;return U(),L(be,null,[e(a(Pe),{height:"900px",ref_key:"documentEditorContainer",ref:h,serviceUrl:Bt,enableToolbar:!0,enableWordExport:!0},null,512),a(p)?(U(),L("div",Mt,[e(Fe,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):we("",!0),e(T,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e(n,{class:"mr-4"},{default:t(()=>[e(F,{size:"large",onClick:E,color:"red"},{default:t(()=>[z("Voltar")]),_:1})]),_:1}),e(F,{size:"large",color:"green",onClick:g,disabled:a(p)},{default:t(()=>[z("Atualizar")]),_:1},8,["disabled"]),e(F,{class:"ml-4",size:"large",color:"blue",onClick:j},{default:t(()=>[z("Gerar Minuta")]),_:1})]),_:1})],64)}}},Rt={class:"d-flex align-center justify-center"},jt=["innerHTML"],Ft={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},setup(J){const i=J,f=Q();Ce(`${f.public.docEditor}`);const{$toast:_}=ae(),y=se(),c=X(),k=`${f.public.managemant}/download`,D=`${f.public.managemant}/atos/files`,A=`${f.public.managemant}/lavrarAto`,R=u("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),S=u(!1),h=u(null),p=u(null),P=u(null),v=async x=>{try{const m=await fetch(x);if(!m.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await m.blob()}catch(m){return console.error(m),_.error("Erro ao carregar o documento inicial."),null}},V=async()=>{try{const{data:x}=await $(`${D}/${c.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return x.value.link_ato}catch(x){console.error("Erro ao carregar o documento:",x),_.error(x)}},M=async()=>{try{const x=await V(),{data:m,status:E}=await $(k,{method:"POST",body:{bucket:"qvgjz",path:x}},"$7ljqltMqa0"),o=m.value,r=await v(o);if(r){const n=new FileReader;n.onload=()=>{const s=n.result;P.value.ej2Instances.documentEditor.open(s),console.log("asdfdsf")},n.readAsText(r)}}catch{_.error("Erro ao carregar o documento.")}};M();const g=async()=>{try{const{data:x,status:m}=await $(A,{method:"POST",body:{ato_token:c.query.ato_token_edit,qtd_paginas:i.pages}},"$OWxZSQkyX8");m.value==="success"?(h.value=x.value,p.value=x.value[0].selo,_.success("Ato lavrado com sucesso!")):_.error("Falha ao lavrar o ato.")}catch{_.error("Erro ao conectar com o servidor.")}},j=()=>{S.value=!1,g()},B=()=>{const x=c.query.origem||"criar",m=c.query.id;x==="atualizar"?y.push(`/os/atualizar/${m}`):y.push("/os/criar-registro")};return Ne(()=>i.document,(x,m)=>{M()}),(x,m)=>{const E=et;return U(),L(be,null,[e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(a(Pe),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:P,height:"850px",width:"850px"},null,512)]),_:1}),e(O,null,{default:t(()=>[d("div",Rt,[d("div",null,[d("img",{onClick:m[0]||(m[0]=o=>S.value=!0),class:"ml-15",style:{height:"40px",width:"40px",cursor:"pointer","margin-top":"350px"},src:Ze}),a(h)?(U(),ie(me,{key:0,width:"360px",class:"mr-16"},{default:t(()=>[e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(xe,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[z(" Livro: "+re(a(h)[0].livro_numero),1)]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(xe,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[z(" Folhas : "+re(a(h)[0].pagina_inicial)+" Á "+re(a(h)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),d("div",{style:{border:"1px solid black","border-radius":"8px","padding-bottom":"20px","margin-top":"-10px"},class:"ml-2 mb-2 mr-2",innerHTML:a(p)},null,8,jt)]),_:1})):we("",!0)])])]),_:1})]),_:1}),z(" "+re(i.pages)+" ",1),e(F,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:B},{default:t(()=>[z("Voltar")]),_:1}),e(E,{show:a(S),condMessage:a(R),onClose:m[1]||(m[1]=o=>S.value=!1),onConfirm:j},null,8,["show","condMessage"])],64)}}},Nt=["onClick"],Lt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},Gt={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ht={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(J){let i,f;const _=se(),y=X(),c=Q(),{$toast:k}=ae(),D=`${c.public.managemant}/listarEscrevente`;`${c.public.managemant}`;const A=`${c.public.managemant}/createAtosObservacao`,R=`${c.public.managemant}/updateAtosObservacao`,S=`${c.public.managemant}/getAtosObservacaoById`,h=u(G("user-data").value.cartorio_token),p=u([]),P=u([]),v=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],V=ue({observacao:""}),M={observacao:{required:nt.withMessage("O campo é obrigatório",it)}},g=ct(M,V),{data:j}=([i,f]=K(()=>$(`${S}/${y.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),i=await i,f(),i);p.value=j.value.map(o=>({...o,created:Ve(o.created,"dd/mm/yyyy hh:mm")}));async function B(){if(V.observacao.trim()===""){k.error("O campo de observação está vazio.");return}if(await g.value.$validate()){const{data:o,error:r,status:n}=await $(A,{method:"POST",body:{ato_id:y.query.ato_id,observacao:V.observacao,user_id:G("user-data").value.usuario_id}},"$gnHMo4uCXD");n.value==="success"&&(p.value.push({created:Ve(o.value.created,"dd/mm/yyyy hh:mm"),observacao:o.value.observacao,id:o.value.id,escrevente:G("user-data").value.nome}),V.observacao="",k.success("Observação registrada com sucesso"))}else k.error("Preencha os campos obrigatórios.")}async function x(o){o.excluido=!o.excluido;try{await $(`${R}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$sP9AKdd3Ky")}catch(r){console.error("Erro ao excluir observação:",r)}}const{data:m}=([i,f]=K(()=>$(D,{method:"POST",body:{cartorio_token:h}},"$HL9pndqGh0")),i=await i,f(),i);P.value=m.value[0].func_json_escreventes;const E=()=>{const o=y.query.origem||"criar",r=y.query.id;o==="atualizar"?_.push(`/os/atualizar/${r}`):_.push("/os/criar-registro")};return(o,r)=>{const n=ne;return U(),ie(de,null,{default:t(()=>[e(T,{class:"mt-5"},{default:t(()=>[e(le,{label:"Observação",modelValue:V.observacao,"onUpdate:modelValue":r[0]||(r[0]=s=>V.observacao=s),required:"","error-messages":a(g).observacao.$errors.length>0?a(g).observacao.$errors.map(s=>s.$message):[],onBlur:a(g).observacao.$touch,onInput:a(g).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),d("div",null,[d("img",{class:"btn-pointer ml-2",src:ce,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:B})])]),_:1}),e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(ve,{style:{height:"465px"},headers:v,items:p.value},{"item.actions":t(({item:s})=>[d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:w=>x(s),title:"Deletar Observação"},[s.excluido?(U(),L("img",Lt)):(U(),L("img",Gt))],8,Nt)]),_:1},8,["items"])]),_:1})]),_:1}),e(T,null,{default:t(()=>[e(n,{onClick:E},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[z("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},Jt=d("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:tt,alt:"Escanear"},null,-1),Wt=[Jt],Kt=d("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ce,alt:"Criar"},null,-1),Xt=[Kt],Qt=["onClick"],Yt=d("img",{style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar"},null,-1),Zt=[Yt],eo=["onClick"],to={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},oo={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},ao={__name:"Anexos",async setup(J){let i,f;const _=Q(),{$toast:y}=ae(),c=se(),k=X(),D=`${_.public.biometria}/run-scanner`,A=`${_.public.managemant}/atos_anexos`,R=`${_.public.managemant}/atos_anexos`,S=`${_.public.managemant}/atos_anexos`,h=u(!1),p=u([]),P=ue({descricao:""}),v=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:V}=([i,f]=K(()=>$(`${S}/${k.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),i=await i,f(),i);p.value=V.value;async function M(){try{await g(),await j()}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}}async function g(){try{const{data:o}=await $(D,{method:"GET"},"$KttjFhHivJ")}catch(o){y.error("Erro ao acionar o scanner:",o)}}async function j(){try{const{data:o,status:r}=await $("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:k.query.ato_token_edit,cartorio_token:G("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(o){console.error("Erro ao enviar o arquivo:",o)}}const B=async()=>{h.value=!0},x=async()=>{const{data:o,error:r,status:n}=await $(A,{method:"POST",body:{ato_id:k.query.ato_id,descricao:P.descricao,user_id:G("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");n.value==="success"&&(y.success("Anexo registrado com sucesso!"),p.value.push(o.value))};async function m(o){o.excluido=!o.excluido;try{await $(`${R}/${o.id}`,{method:"PUT",body:JSON.stringify({excluido:o.excluido})},"$cdoFBGO0Ti")}catch(r){console.error("Erro ao excluir pessoa:",r)}}const E=()=>{const o=k.query.origem||"criar",r=k.query.id;o==="atualizar"?c.push(`/os/atualizar/${r}`):c.push("/os/criar-registro")};return(o,r)=>{const n=ne;return U(),ie(de,null,{default:t(()=>[e(T,null,{default:t(()=>[e(O,{cols:"5"},{default:t(()=>[e(le,{modelValue:a(P).descricao,"onUpdate:modelValue":r[0]||(r[0]=s=>a(P).descricao=s),label:"Descrição"},null,8,["modelValue"])]),_:1}),d("div",{onClick:M,title:"Escanear"},Wt),d("div",{onClick:x,title:"Criar"},Xt)]),_:1}),e(ve,{headers:v,items:a(p),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:s})=>[e(T,null,{default:t(()=>[d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:w=>B(s),title:"Visualizar Anexo"},Zt,8,Qt),d("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:w=>m(s),title:"Deletar Pessoa"},[s.excluido?(U(),L("img",to)):(U(),L("img",oo))],8,eo)]),_:2},1024)]),_:1},8,["items"]),e($e,{modelValue:a(h),"onUpdate:modelValue":r[2]||(r[2]=s=>te(h)?h.value=s:null),width:"600"},{default:t(()=>[e(me,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(F,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:r[1]||(r[1]=s=>h.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(n,{onClick:E},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[z("Voltar")]),_:1})]),_:1})]),_:1})}}},so={class:"mb-10"},ro=d("h1",null,"Ordem de Serviço nº",-1),lo={style:{color:"red","margin-left":"30px"}},Eo={__name:"[id]",async setup(J){let i,f;const _=u(null),y=u(null),c=u(null),k=Q(),D=X(),A=`${k.public.managemant}/listarSituacoes`,R=`${k.public.managemant}/getAtos`,S=u(G("user-data").value.cartorio_token),h=D.query.id?{ato_token:"xkyaA"}:{cartorio_token:S},p=u([]),P=u([]),v=u("PROCURAÇÕES"),V=u("PROCURAÇÃO");async function M(){try{const{data:m}=await $(`${R}/${D.query.ato_id}`,{method:"GET"},"$j0JpHHj7PB");P.value=m.value}catch(m){console.log(m)}}[i,f]=K(()=>M()),await i,f();const{data:g,status:j}=([i,f]=K(()=>$(A,{method:"POST",body:h},"$mGbp7gAEjS")),i=await i,f(),i);p.value=g.value;const B=m=>{_.value=m},x=m=>{y.value=m};return(m,E)=>{const o=ut,r=kt,n=Ut,s=It,w=Ft,I=Ht,l=ao;return U(),L(be,null,[d("div",so,[e(T,{class:"mb-5 mt-5"},{default:t(()=>[ro,d("h1",lo,re(a(D).query.numero_os),1)]),_:1}),e(T,null,{default:t(()=>[e(O,{md:"6"},{default:t(()=>[e(oe,{class:"mr-5",modelValue:a(v),"onUpdate:modelValue":E[0]||(E[0]=N=>te(v)?v.value=N:null),disabled:""},null,8,["modelValue"])]),_:1}),e(O,{md:"6"},{default:t(()=>[e(oe,{modelValue:a(V),"onUpdate:modelValue":E[1]||(E[1]=N=>te(V)?V.value=N:null),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),e(me,{width:"1300"},{default:t(()=>[e(Ge,{modelValue:a(c),"onUpdate:modelValue":E[2]||(E[2]=N=>te(c)?c.value=N:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(Z,{value:"dados"},{default:t(()=>[z("Dados")]),_:1}),e(Z,{value:"partes"},{default:t(()=>[z("Partes")]),_:1}),e(Z,{value:"bens"},{default:t(()=>[z("Bens")]),_:1}),e(Z,{value:"minuta"},{default:t(()=>[z("Minuta")]),_:1}),e(Z,{value:"livro"},{default:t(()=>[z("Livro")]),_:1}),e(Z,{value:"observacao"},{default:t(()=>[z("Observações")]),_:1}),e(Z,{value:"anexo"},{default:t(()=>[z("Anexos")]),_:1})]),_:1},8,["modelValue"]),e(He,{modelValue:a(c),"onUpdate:modelValue":E[3]||(E[3]=N=>te(c)?c.value=N:null)},{default:t(()=>[e(ee,{value:"dados"},{default:t(()=>[e(o,{item_dados:a(P),item_situacoes:a(p)},null,8,["item_dados","item_situacoes"])]),_:1}),e(ee,{value:"partes"},{default:t(()=>[e(r)]),_:1}),e(ee,{value:"bens"},{default:t(()=>[e(n)]),_:1}),e(ee,{value:"minuta"},{default:t(()=>[e(s,{onPage:B,onDoc:x})]),_:1}),e(ee,{value:"livro"},{default:t(()=>[e(w,{pages:a(_),document:a(y)},null,8,["pages","document"])]),_:1}),e(ee,{value:"observacao"},{default:t(()=>[e(I)]),_:1}),e(ee,{value:"anexo"},{default:t(()=>[e(l)]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}};export{Eo as default};
