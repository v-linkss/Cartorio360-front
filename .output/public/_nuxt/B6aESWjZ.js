import{_ as q,u as F}from"./DrL08pGn.js";import{_ as W,B as j,u as G,r,c as H,a as b,b as t,v as s,V as P,w as n,I as T,s as Q,o as p,z as f,O as X,d as v,E as y,J as _,K as h,m as S}from"./D20DkuN4.js";import{f as U}from"./B7KZih50.js";import{V as Y}from"./itHe4y2w.js";import{V as Z,a as w}from"./Cs0qACZ9.js";import"./BElGUO6U.js";import"./Nif8ni3S.js";const ee={class:"container-main"},oe={class:"container-form"},ae={__name:"index",setup(te){const O=j(),{$toast:$}=G(),u=r({senha:"",email:""}),k=r(!1),l=r(!1),x=r(!1),C=r(!1),E=r(!1),c=r(!1),g=()=>{x.value=!1,C.value=!1,c.value=!1,E.value=!1,l.value=!1},N=Q(),M=`${N.public.auth}/service/gerencia/listarMenu`,B=N.public.auth,A=async()=>{const{data:o,status:e,error:a}=await U(`${B}/login`,{method:"POST",body:{senha:u.value.senha,email:u.value.email}});return console.log(`${B}/login`,o),{data:o==null?void 0:o.value,status:e==null?void 0:e.value,error:a==null?void 0:a.value}},I=o=>{const e=S("user-data");e.value=JSON.stringify({nome:o.nome,usuario_id:o.id,cartorio_id:o.cartorios[0].cartorio_id,cartorio_nome:o.cartorios[0].cartorio_descricao,cartorio_token:o.cartorios[0].cartorio_token});const a=S("auth_token");a.value=o.token},R=o=>{var i,d,m;const e=(m=(d=(i=o==null?void 0:o.data)==null?void 0:i[0])==null?void 0:d.func_autentica_acesso_v1)==null?void 0:m[0],a=e==null?void 0:e.status_mensagem;if(!e){c.value=!0;return}switch(a){case"Esse email não está cadastrado no Durabil.":C.value=!0;break;case"Senha inválida.":x.value=!0;break;case"Seu cadastro está desativado. Entre em contato com o administrador da conta.":E.value=!0;break;default:c.value=!0;break}},z=async()=>{var i,d,m,K;const{data:o,status:e,error:a}=await A();if(console.log(o),e==="success"){const V=(K=(m=(d=(i=o==null?void 0:o[0])==null?void 0:i.func_autentica_acesso_v1)==null?void 0:d[0])==null?void 0:m.registro)==null?void 0:K[0];if(F().cartorioInfos=V.cartorios,I(V),V.cartorios.length>1){O.push({path:"/login/tipo-perfil"});return}$.success("Login realizado com sucesso!");const{data:D,status:J}=await U(M,{method:"POST",body:{perfil_descricao:V.cartorios[0].perfil_descricao}});if(J.value==="success"){const L=S("menu-navbar");L.value=D.value,O.push({path:"/"})}}else e==="error"&&(a==null?void 0:a.statusCode)===500?c.value=!0:R(a)};return(o,e)=>(p(),H("div",ee,[b("div",oe,[t(Y,{class:"image",width:300,height:"230",src:q}),e[10]||(e[10]=b("div",{class:"text"},"Log in",-1)),t(P,{autofocus:"",autocomplete:"email",type:"email",modelValue:s(u).email,"onUpdate:modelValue":e[0]||(e[0]=a=>s(u).email=a),"persistent-hint":"",class:"input",density:"compact",placeholder:"Email","prepend-inner-icon":"mdi-email-outline",variant:"outlined"},null,8,["modelValue"]),t(P,{modelValue:s(u).senha,"onUpdate:modelValue":e[1]||(e[1]=a=>s(u).senha=a),class:"input","append-inner-icon":s(k)?"mdi-eye-off":"mdi-eye",type:s(k)?"text":"password",density:"compact",placeholder:"Senha","prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":e[2]||(e[2]=a=>k.value=!s(k))},null,8,["modelValue","append-inner-icon","type"]),t(Z,{modelValue:s(l),"onUpdate:modelValue":e[4]||(e[4]=a=>T(l)?l.value=a:null),"max-width":"400",persistent:""},{activator:n(({props:a})=>[t(f,X({block:"",rounded:"",class:"button mb-10 mt-4"},a,{onClick:z,modelValue:s(l),"onUpdate:modelValue":e[3]||(e[3]=i=>T(l)?l.value=i:null)}),{default:n(()=>e[5]||(e[5]=[v(" Acessar ")])),_:2},1040,["modelValue"])]),default:n(()=>[s(x)?(p(),y(w,{key:0,text:"Senha inválida."},{actions:n(()=>[t(_),t(f,{onClick:g,style:{"background-color":"#429946",color:"white"}},{default:n(()=>e[6]||(e[6]=[v(" OK ")])),_:1})]),_:1})):h("",!0),s(C)?(p(),y(w,{key:1,text:"Esse email não está cadastrado."},{actions:n(()=>[t(_),t(f,{onClick:g,style:{"background-color":"#429946",color:"white"}},{default:n(()=>e[7]||(e[7]=[v(" OK ")])),_:1})]),_:1})):h("",!0),s(c)?(p(),y(w,{key:2,text:"Erro no sistema, fora do ar."},{actions:n(()=>[t(_),t(f,{onClick:g,style:{"background-color":"#429946",color:"white"}},{default:n(()=>e[8]||(e[8]=[v(" OK ")])),_:1})]),_:1})):h("",!0),s(E)?(p(),y(w,{key:3,text:"Seu cadastro está desativado. Entre em contato com o administrador da conta."},{actions:n(()=>[t(_),t(f,{onClick:g,style:{"background-color":"#429946",color:"white"}},{default:n(()=>e[9]||(e[9]=[v(" OK ")])),_:1})]),_:1})):h("",!0)]),_:1},8,["modelValue"]),e[11]||(e[11]=b("a",{class:"text-decoration-none",rel:"noopener noreferrer",style:{color:"#429946"}}," Esqueceu a senha?",-1))]),e[12]||(e[12]=b("div",{class:"background-image"},null,-1))]))}},de=W(ae,[["__scopeId","data-v-3e3ffabd"]]);export{de as default};
