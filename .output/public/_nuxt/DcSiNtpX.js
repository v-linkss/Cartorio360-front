import{n as re,u as te,A as F,r as S,s as ae,B as de,O as ue,o as g,c as ee,x as e,v as C,H as pe,t as fe,I,w as o,b as a,V as h,P as Q,y as Z,d as D,J as _e,z as le,a as J,C as ve,h as Ve,D as se}from"./DgXrkF5u.js";import{b as be,u as O}from"./D7zvLIPz.js";import{c as X,r as Y,u as ce}from"./BilDQGmq.js";import{c as ge}from"./DAyf5q1m.js";import{V as x}from"./tfQVPjDb.js";import{V as p}from"./ipD6B0nN.js";import{V as H}from"./BLKMo-uS.js";import{V as K}from"./DDeICuK_.js";import{V as ye,a as L,b as $e,c as G,_ as Ce,d as Pe,e as ke,f as he}from"./BV1lbIFK.js";import{_ as we}from"./DM0x_3z8.js";import{a as xe,V as Me}from"./BYXOoXnp.js";import{_ as Ie}from"./Bgy-olGj.js";import{_ as ne,a as Ue,b as Se}from"./MQ3lPPOi.js";const Te={key:1},Re={__name:"Dados",props:{isModal:{type:Boolean,default:!1}},emits:["saved","close-modal"],async setup(E,{emit:$}){let u,f;const w=E,d=$,m=re(),{$toast:y}=te(),_=le(),A=`${_.public.managemant}/createPessoa`,T=`${_.public.managemant}/updatePessoa`,N=`${_.public.managemant}/listarEstadoCivil`,c=`${_.public.managemant}/listarCapacidadeCivil`,P=`${_.public.managemant}/listarCidades`,R={nome:"",nome_pai:"",nome_mae:"",profissao:"",local_trabalho:"",data_nascimento:"",doc_identificacao:"",cpf_pai:"",cpf_mae:"",tipo_pessoa:"FISICA",tabvalores_estadocivil_id:"",tabvalores_capacidadecivil_id:"",cidade_natural_id:"",cartorio_id:F("user-data").value.cartorio_id,user_id:F("user-data").value.usuario_id},l=S(!1),z=F("pessoa-id"),s=ae({...R});function B(k){if(k)return k.replace(/[.\-]/g,"");k=null}const{data:v,status:V,pending:U,error:t}=([u,f]=de(async()=>be("cliente-dados",async()=>{const[k,r,q]=await Promise.all([$fetch(N),$fetch(c),$fetch(P)]);return{estadoCivilItems:k,capacidadeCivilItems:r,cidadeNascimentoItems:q}})),u=await u,f(),u),n={nome:{required:X.withMessage("O campo é obrigatorio",Y)},nome_mae:{required:X.withMessage("O campo é obrigatorio",Y)},doc_identificacao:{required:X.withMessage("O campo é obrigatorio",Y),cpf:ge}},b=ce(n,s);async function j(){if(await b.value.$validate()){const k={...s};for(const W in k)k[W]===""&&(k[W]=null);const r={...k,doc_identificacao:B(s.doc_identificacao),cpf_pai:B(s.cpf_pai),cpf_mae:B(s.cpf_mae)},{data:q,error:i,status:oe}=await O(A,{method:"POST",body:r},"$fcbWHpl5XR");if(oe.value==="error"&&i.value.statusCode===500)y.error("Erro ao cadastrar pessoa,o CPF já está cadastrado.");else{y.success("Pessoa cadastrada com sucesso!");const W=q.value.id;z.value=W;const me=F("pessoa_token");me.value=q.value.token,l.value=!0,d("saved")}}else y.error("Erro ao cadastrar pessoa, preencha os campos obrigatorios.")}async function M(){const k={...s};for(const W in k)k[W]===""&&(k[W]=null);const r={...k,doc_identificacao:B(s.doc_identificacao),cpf_mae:B(s.cpf_mae)},{data:q,error:i,status:oe}=await O(`${T}/${z.value}`,{method:"PUT",body:r},"$S30ZRYxneo");if(oe.value==="success"){if(w.isModal===!0){y.success("Pessoa atualizada com sucesso!"),d("close-modal");return}y.success("Pessoa atualizada com sucesso!"),m.push("/pessoas/lista")}}const ie=()=>{if(w.isModal===!0){d("close-modal");return}m.push("/pessoas/lista")};return(k,r)=>{const q=ue("mask");return g(),ee(_e,null,[e(U)?(g(),C(pe,{key:0,class:"loading-spinner",indeterminate:"",size:"64"})):e(t)?(g(),ee("div",Te,fe(e(t).message),1)):I("",!0),e(U)?I("",!0):(g(),C(K,{key:2},{default:o(()=>[a(x,null,{default:o(()=>[a(p,{md:"8"},{default:o(()=>[a(h,{modelValue:e(s).nome,"onUpdate:modelValue":r[0]||(r[0]=i=>e(s).nome=i),"error-messages":e(b).nome.$errors.map(i=>i.$message),label:"Nome",required:"",onBlur:e(b).nome.$touch,onInput:e(b).nome.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1}),a(p,{md:"4"},{default:o(()=>[Q(a(h,{modelValue:e(s).doc_identificacao,"onUpdate:modelValue":r[1]||(r[1]=i=>e(s).doc_identificacao=i),"error-messages":e(b).doc_identificacao.$errors.map(i=>i.$message),label:"CPF",required:"",onBlur:e(b).doc_identificacao.$touch,onInput:e(b).doc_identificacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),[[q,"###.###.###-##"]])]),_:1})]),_:1}),a(x,null,{default:o(()=>[a(p,{md:"4"},{default:o(()=>[a(H,{modelValue:e(s).tabvalores_estadocivil_id,"onUpdate:modelValue":r[2]||(r[2]=i=>e(s).tabvalores_estadocivil_id=i),items:e(v).estadoCivilItems,"item-title":"descricao","item-value":"id",label:"Estado Civil"},null,8,["modelValue","items"])]),_:1}),a(p,{md:"4"},{default:o(()=>[a(h,{modelValue:e(s).profissao,"onUpdate:modelValue":r[3]||(r[3]=i=>e(s).profissao=i),label:"Profissão"},null,8,["modelValue"])]),_:1}),a(p,{md:"4"},{default:o(()=>[a(h,{modelValue:e(s).local_trabalho,"onUpdate:modelValue":r[4]||(r[4]=i=>e(s).local_trabalho=i),label:"Local de trabalho"},null,8,["modelValue"])]),_:1})]),_:1}),a(x,null,{default:o(()=>[a(p,{md:"4"},{default:o(()=>[a(h,{modelValue:e(s).data_nascimento,"onUpdate:modelValue":r[5]||(r[5]=i=>e(s).data_nascimento=i),type:"date","prepend-icon":"",label:"Data de nascimento"},null,8,["modelValue"])]),_:1}),a(p,{md:"4"},{default:o(()=>[a(H,{modelValue:e(s).tabvalores_capacidadecivil_id,"onUpdate:modelValue":r[6]||(r[6]=i=>e(s).tabvalores_capacidadecivil_id=i),items:e(v).capacidadeCivilItems,label:"Capacidade Civil","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),a(p,{md:"4"},{default:o(()=>[a(H,{modelValue:e(s).cidade_natural_id,"onUpdate:modelValue":r[7]||(r[7]=i=>e(s).cidade_natural_id=i),items:e(v).cidadeNascimentoItems,label:"Cidade de nascimento","item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),a(x,null,{default:o(()=>[a(p,{md:"4"},{default:o(()=>[Q(a(h,{modelValue:e(s).cpf_pai,"onUpdate:modelValue":r[8]||(r[8]=i=>e(s).cpf_pai=i),modelModifiers:{date:!0},label:"CPF do Pai"},null,8,["modelValue"]),[[q,"###.###.###-##"]])]),_:1}),a(p,{md:"4"},{default:o(()=>[a(h,{modelValue:e(s).nome_pai,"onUpdate:modelValue":r[9]||(r[9]=i=>e(s).nome_pai=i),modelModifiers:{date:!0},label:"Nome do Pai"},null,8,["modelValue"])]),_:1})]),_:1}),a(x,null,{default:o(()=>[a(p,{md:"4"},{default:o(()=>[Q(a(h,{modelValue:e(s).cpf_mae,"onUpdate:modelValue":r[10]||(r[10]=i=>e(s).cpf_mae=i),modelModifiers:{date:!0},label:"CPF da Mãe"},null,8,["modelValue"]),[[q,"###.###.###-##"]])]),_:1}),a(p,{md:"4"},{default:o(()=>[a(h,{modelValue:e(s).nome_mae,"onUpdate:modelValue":r[11]||(r[11]=i=>e(s).nome_mae=i),modelModifiers:{date:!0},"error-messages":e(b).nome_mae.$errors.map(i=>i.$message),label:"Nome da Mãe",required:"",onBlur:e(b).nome_mae.$touch,onInput:e(b).nome_mae.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),a(x,{class:"mb-3"},{default:o(()=>[a(Z,{onClick:ie,size:"large",color:"red"},{default:o(()=>[D("Voltar")]),_:1}),a(Z,{onClick:r[12]||(r[12]=i=>e(l)?M():j()),class:"ml-4",size:"large",color:"green"},{default:o(()=>[D("Salvar")]),_:1})]),_:1})]),_:1}))],64)}}},Be=X.withMessage("CNPJ inválido",E=>{if(!E)return!1;const $=E.replace(/[^\d]+/g,"");if($.length!==14||/^(\d)\1+$/.test($))return!1;let u=$.length-2,f=$.substring(0,u);const w=$.substring(u);let d=0,m=u-7;for(let _=u;_>=1;_--)d+=parseInt(f.charAt(u-_),10)*m--,m<2&&(m=9);let y=d%11<2?0:11-d%11;if(y!==parseInt(w.charAt(0),10))return!1;u+=1,f=$.substring(0,u),d=0,m=u-7;for(let _=u;_>=1;_--)d+=parseInt(f.charAt(u-_),10)*m--,m<2&&(m=9);return y=d%11<2?0:11-d%11,y===parseInt(w.charAt(1),10)}),De={__name:"DadosJuridica",props:{isModal:{type:Boolean,default:!1}},emits:["saved","close-modal"],setup(E,{emit:$}){const u=E,f=$,w=re(),{$toast:d}=te(),m=le(),y=`${m.public.managemant}/createPessoa`,_=`${m.public.managemant}/updatePessoa`,A={nome:null,nome_fantasia:null,inscricao_estadual:null,observacao:null,doc_identificacao:null,tipo_pessoa:"JURIDICA",cartorio_id:F("user-data").value.cartorio_id,user_id:F("user-data").value.usuario_id},T=S(!1),N=F("pessoa-id"),c=ae({...A});function P(v){return v?v.replace(/[.\-/]/g,""):null}const R={nome:{required:X.withMessage("O campo é obrigatorio",Y)},doc_identificacao:{required:X.withMessage("O campo é obrigatorio",Y),cnpj:Be}},l=ce(R,c);async function z(){if(await l.value.$validate()){const v={...c};for(const b in v)v[b]===""&&(v[b]=null);const V={...v,doc_identificacao:P(c.doc_identificacao)},{data:U,error:t,status:n}=await O(y,{method:"POST",body:V},"$kpCGWBoNdd");if(n.value==="error"&&t.value.statusCode===500)console.log(t.value),d.error("Erro ao cadastrar Pessoa Juridica,o CNPJ já está cadastrado.");else{d.success("Pessoa Juridica cadastrada com sucesso!");const b=U.value.id;N.value=b;const j=F("pessoa_token");j.value=U.value.token,T.value=!0,f("saved")}}else d.error("Erro ao cadastrar pessoa juridica, preencha os campos obrigatorios.")}async function s(){const v={...c};for(const b in v)v[b]===""&&(v[b]=null);const V={...v,doc_identificacao:P(c.doc_identificacao)},{data:U,error:t,status:n}=await O(`${_}/${N.value}`,{method:"PUT",body:V},"$mSTT3Fc5La");if(n.value==="success"){if(u.isModal===!0){d.success("Pessoa Juridica atualizada com sucesso!"),f("close-modal");return}d.success("Pessoa Juridica atualizada com sucesso!"),w.push("/pessoas/lista")}}const B=()=>{if(u.isModal===!0){f("close-modal");return}w.push("/pessoas/lista")};return(v,V)=>{const U=ue("mask");return g(),C(K,{class:"mt-3",style:{height:"425px"}},{default:o(()=>[a(x,null,{default:o(()=>[a(p,{md:"8"},{default:o(()=>[a(h,{modelValue:e(c).nome,"onUpdate:modelValue":V[0]||(V[0]=t=>e(c).nome=t),"error-messages":e(l).nome.$errors.map(t=>t.$message),label:"Razão Social",required:"",onBlur:e(l).nome.$touch,onInput:e(l).nome.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1}),a(p,{md:"4"},{default:o(()=>[Q(a(h,{modelValue:e(c).doc_identificacao,"onUpdate:modelValue":V[1]||(V[1]=t=>e(c).doc_identificacao=t),"error-messages":e(l).doc_identificacao.$errors.map(t=>t.$message),label:"CNPJ",required:"",onBlur:e(l).doc_identificacao.$touch,onInput:e(l).doc_identificacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),[[U,"##.###.###/####-##"]])]),_:1})]),_:1}),a(x,null,{default:o(()=>[a(p,{md:"8"},{default:o(()=>[a(h,{modelValue:e(c).nome_fantasia,"onUpdate:modelValue":V[2]||(V[2]=t=>e(c).nome_fantasia=t),label:"Nome Fantasia"},null,8,["modelValue"])]),_:1}),a(p,{md:"4"},{default:o(()=>[a(h,{modelValue:e(c).inscricao_estadual,"onUpdate:modelValue":V[3]||(V[3]=t=>e(c).inscricao_estadual=t),label:"Inscrição Estadual"},null,8,["modelValue"])]),_:1})]),_:1}),a(x,null,{default:o(()=>[a(p,{md:"12"},{default:o(()=>[a(h,{modelValue:e(c).observacao,"onUpdate:modelValue":V[4]||(V[4]=t=>e(c).observacao=t),label:"Observação"},null,8,["modelValue"])]),_:1})]),_:1}),a(x,{class:"mb-3"},{default:o(()=>[a(Z,{onClick:B,size:"large",color:"red"},{default:o(()=>[D("Voltar")]),_:1}),a(Z,{onClick:V[5]||(V[5]=t=>e(T)?s():z()),class:"ml-4",size:"large",color:"green"},{default:o(()=>[D("Salvar")]),_:1})]),_:1})]),_:1})}}},Ae=["onClick"],Fe={key:0,style:{width:"30px",height:"30px"},src:Ue,alt:"Visualizar",title:"Reativar"},Ee={key:1,src:Se,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ne={__name:"Representantes",async setup(E){let $,u;const f=le(),{$toast:w}=te(),d=`${f.public.managemant}/pesquisarPessoas`,m=`${f.public.managemant}/listarPapeis`,y=`${f.public.managemant}/representante`,_=`${f.public.managemant}/updateAtosPessoa`,A=S(F("user-data").value.cartorio_token),T=S([]),N=S([]),c=S([]),P=S(!1),R=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{value:"actions"}],l=ae({papeis:null,nome:null,pessoa:null,documento:null}),{data:z}=([$,u]=de(()=>O(m,{method:"POST",body:{rotina:"CADASTRO_PJ"}},"$r2PAdeai2X")),$=await $,u(),$);c.value=z.value;async function s(){try{const{data:t,error:n}=await O(d,{method:"POST",body:{cartorio_token:A.value,documento:l.documento,nome:l.nome}},"$ssVep5GhCj");t.value.length>0?(T.value=t.value,l.pessoa=T.value[0]):T.value=[]}catch(t){console.error("Erro na requisição",t)}}const B=()=>{P.value=!0},v=async()=>{const t={pessoa:l.pessoa,papel:c.value.find(n=>n.id===l.papeis),representante:{nome:null}};try{const{data:n,error:b,status:j}=await O(y,{method:"POST",body:{ato_id:null,representante_id:l.pessoa.id,pessoa_id:l.pessoa.id,tipo_parte_id:l.papeis,user_id:F("user-data").value.usuario_id}},"$8XMY7eo5oW");j.value==="success"?(t.id=n.value.id,w.success("Pessoa Registrada com Sucesso!"),N.value.push(t)):w.error("Erro ao registrar a pessoa!")}catch{w.error("Erro no servidor. Tente novamente.")}};async function V(t){t.excluido=!t.excluido;try{await O(`${_}/${t.id}`,{method:"PUT",body:JSON.stringify({excluido:t.excluido})},"$bMZzCc9jB6")}catch(n){console.error("Erro ao excluir pessoa:",n)}}const U=()=>{if(props.isModal===!0){emit("close-modal");return}router.push("/pessoas/lista")};return(t,n)=>{const b=we,j=ze;return g(),C(K,{style:{height:"660px"}},{default:o(()=>[a(x,{class:"mt-1"},{default:o(()=>[a(p,{cols:"3"},{default:o(()=>[a(h,{label:"Documento",modelValue:e(l).documento,"onUpdate:modelValue":n[0]||(n[0]=M=>e(l).documento=M)},null,8,["modelValue"])]),_:1}),a(p,{cols:"4"},{default:o(()=>[a(h,{label:"Pessoa",modelValue:e(l).nome,"onUpdate:modelValue":n[1]||(n[1]=M=>e(l).nome=M)},null,8,["modelValue"])]),_:1}),J("div",null,[J("img",{class:"mt-1",src:Ie,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:s})]),J("div",null,[J("img",{class:"mt-1 ml-2",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:B})])]),_:1}),a(x,null,{default:o(()=>[a(p,{cols:"4"},{default:o(()=>[a(H,{label:"Selecione a Pessoa",modelValue:e(l).pessoa,"onUpdate:modelValue":n[2]||(n[2]=M=>e(l).pessoa=M),items:e(T),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),a(p,{cols:"3"},{default:o(()=>[a(H,{label:"Papel",modelValue:e(l).papeis,"onUpdate:modelValue":n[3]||(n[3]=M=>e(l).papeis=M),items:e(c),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),J("div",null,[J("img",{class:"mt-1",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:v})])]),_:1}),a(x,null,{default:o(()=>[a(p,null,{default:o(()=>[a(ve,{style:{height:"465px"},headers:R,items:e(N)},{"item.actions":o(({item:M})=>[a(x,null,{default:o(()=>[J("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ie=>V(M),title:"Deletar Pessoa"},[M.excluido?(g(),ee("img",Fe)):(g(),ee("img",Ee))],8,Ae)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),a(b,{onClick:U},{default:o(()=>[a(Z,{size:"large",color:"red"},{default:o(()=>[D("Voltar")]),_:1})]),_:1}),a(j,{show:e(P),onClose:n[4]||(n[4]=M=>P.value=!1)},null,8,["show"])]),_:1})}}},qe=J("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Cadastramento de pessoas ",-1),Je={style:{"background-color":"#f5f2f2",padding:"5px 0px 0px 20px"}},ze={__name:"RegistroPessoas",props:{show:Boolean},emits:["close"],setup(E,{emit:$}){const u=E,f=S(u.show),w=$,d=S("dados"),m=S(!1),y=S(!1),_=S(!1),A=ae({tipo_pessoa:"fisica"}),T=[{label:"FÍSICA",value:"fisica"},{label:"JURÍDICA",value:"juridica"},{label:"ESTRANGEIRA",value:"estrangeira"}],N=()=>{m.value=!0,_.value=!0},c=()=>{y.value=!0,_.value=!0};Ve(()=>u.show,R=>{f.value=R});const P=()=>{f.value=!1,w("close")};return(R,l)=>{const z=Re,s=De,B=Ce,v=Ne,V=Pe,U=ke,t=he;return g(),C(Me,{persistent:"",modelValue:e(f),"onUpdate:modelValue":l[3]||(l[3]=n=>se(f)?f.value=n:null),"max-width":"900"},{default:o(()=>[a(xe,null,{default:o(()=>[a(K,null,{default:o(()=>[qe,J("div",Je,[a(H,{modelValue:e(A).tipo_pessoa,"onUpdate:modelValue":l[0]||(l[0]=n=>e(A).tipo_pessoa=n),style:{width:"200px"},items:T,"item-title":"label","item-value":"value",label:"Tipo de pessoa","bg-color":"#F6F6F6",disabled:e(_)},null,8,["modelValue","disabled"])]),a(ye,{modelValue:e(d),"onUpdate:modelValue":l[1]||(l[1]=n=>se(d)?d.value=n:null),"bg-color":"#f5f2f2"},{default:o(()=>[a(L,{value:"dados"},{default:o(()=>[D("Dados")]),_:1}),e(m)?(g(),C(L,{key:0,value:"documento"},{default:o(()=>[D("Documentos")]),_:1})):I("",!0),e(y)?(g(),C(L,{key:1,value:"representante"},{default:o(()=>[D("Representantes")]),_:1})):I("",!0),e(y)||e(m)?(g(),C(L,{key:2,value:"endereco"},{default:o(()=>[D("Endereços")]),_:1})):I("",!0),e(m)?(g(),C(L,{key:3,value:"biometria"},{default:o(()=>[D("Biometria")]),_:1})):I("",!0),e(y)||e(m)?(g(),C(L,{key:4,value:"restricao"},{default:o(()=>[D("Restrições")]),_:1})):I("",!0)]),_:1},8,["modelValue"]),a($e,{modelValue:e(d),"onUpdate:modelValue":l[2]||(l[2]=n=>se(d)?d.value=n:null)},{default:o(()=>[a(G,{value:"dados"},{default:o(()=>[e(A).tipo_pessoa==="fisica"?(g(),C(z,{key:0,onSaved:N,onCloseModal:P,isModal:!0})):e(A).tipo_pessoa==="juridica"?(g(),C(s,{key:1,onSaved:c,onCloseModal:P,isModal:!0})):I("",!0)]),_:1}),R.showTabs?(g(),C(G,{key:0,value:"documento"},{default:o(()=>[a(B,{onCloseModal:P,isModal:!0})]),_:1})):I("",!0),e(y)?(g(),C(G,{key:1,value:"representante"},{default:o(()=>[a(v,{onCloseModal:P,isModal:!0})]),_:1})):I("",!0),e(y)||e(m)?(g(),C(G,{key:2,value:"endereco"},{default:o(()=>[a(V,{onCloseModal:P,isModal:!0})]),_:1})):I("",!0),R.showTabs?(g(),C(G,{key:3,value:"biometria"},{default:o(()=>[a(K,null,{default:o(()=>[a(U,{onCloseModal:P,isModal:!0})]),_:1})]),_:1})):I("",!0),R.showTabs?(g(),C(G,{key:4,value:"restricao"},{default:o(()=>[a(t,{onCloseModal:P,isModal:!0})]),_:1})):I("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{ze as _,Re as a,De as b,Ne as c};
