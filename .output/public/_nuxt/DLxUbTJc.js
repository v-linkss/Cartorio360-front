import{_ as A}from"./SfcPLjv6.js";import{_ as P}from"./D9URZlzC.js";import{_ as F}from"./grhImWzf.js";import{_ as M,u as N,r as l,m as v,n as O,c as D,b as o,w as r,a as e,q as n,F as E,v as R,o as T,C as I}from"./C_QhtBLz.js";import{u as f}from"./B4vN6-cw.js";import{f as y}from"./B0IxRygJ.js";import{V as L}from"./DwnRXDNo.js";import{V as B}from"./Dwl3MfYW.js";import{V as h}from"./DmcIHE_P.js";import{V as x}from"./DrkeLF9P.js";import"./D4MgDqwB.js";import"./RyFEI44N.js";import"./BLPoSnSm.js";import"./C1TCGrRl.js";import"./DKBS5VNc.js";import"./0Ioi84f3.js";import"./7pSU_w7h.js";import"./DPyB32ST.js";const j={style:{width:"1300px",margin:"0 auto"}},z={style:{display:"flex",gap:"4px","justify-content":"center"}},U=["disabled","onClick"],G={__name:"index",setup(H){const d=R(),{$toast:c}=N(),g=`${d.public.managemant}/cancela_lavratura`,b=`${d.public.managemant}/pesquisaAtos`,k=l(v("auth_token").value)||null,C=l(v("user-data").value.cartorio_token)||null,m=l([]),u=l(!1),p=l(""),_=l(null),i=O({protocolo:null}),V=[{title:"Protocolo",value:"protocolo"},{title:"Data lavratura/Parte",value:"dt_lavratura"},{title:"Situação/Serviço",key:"situacaoServico",value:t=>t.situacao?`${t.situacao}
${t.ato_servico}`:`${t.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];async function w(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(i));const{data:t}=await f(b,{method:"POST",body:{cartorio_token:C.value,protocolo:i.protocolo||null}},"$EsIaDpdnSx");t.value.length>0?m.value=t.value.map(a=>({...a,dt_lavratura:a.dt_lavratura?y(a.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:a.dt_abertura?y(a.dt_abertura,"dd/mm/yyyy"):null})):(m.value=[],c.error("Não existe ato Registrado!"))}catch(t){console.error("Erro na requisição",t)}}const $=t=>{_.value=t,p.value="Tem certeza que deseja cancelar este ato?",u.value=!0},S=async()=>{const{data:t,status:a}=await f(g,{method:"POST",body:{ato_token:_.value,user_token:k.value,cancelar_selo:!1}},"$Xx0FGnNZIU");a.value==="success"&&t.value[0].status==="OK"?(c.success("Lavratura cancelada com sucesso!"),u.value=!1):t.value[0].status==="ERRO"&&c.error("erro ao cancelar ato")};return(t,a)=>{const q=A;return T(),D(E,null,[o(L,{class:"mt-5"},{default:r(()=>[o(h,{class:"mb-5"},{default:r(()=>a[2]||(a[2]=[e("h1",null,"Cancelamento de Lavratura",-1)])),_:1}),o(h,null,{default:r(()=>[o(x,{cols:"2"},{default:r(()=>[o(I,{modelValue:n(i).protocolo,"onUpdate:modelValue":a[0]||(a[0]=s=>n(i).protocolo=s),label:"Protocolo"},null,8,["modelValue"])]),_:1}),o(x,null,{default:r(()=>[e("div",null,[e("img",{onClick:w,style:{width:"40px",height:"40px",cursor:"pointer"},src:P,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),e("div",j,[a[4]||(a[4]=e("hr",{class:"mt-5 mb-5"},null,-1)),o(B,{headers:V,items:n(m),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":r(({item:s})=>[e("div",z,[e("div",{disabled:!s.btn_cancelar,onClick:J=>s.btn_cancelar?$(s.token):null,title:"Excluir"},a[3]||(a[3]=[e("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:F,alt:"Cancelar",title:"Cancelar"},null,-1)]),8,U)])]),_:1},8,["items"])]),o(q,{show:n(u),condMessage:n(p),onClose:a[1]||(a[1]=s=>u.value=!1),onConfirm:S},null,8,["show","condMessage"])],64)}}},da=M(G,[["__scopeId","data-v-6f864c09"]]);export{da as default};
