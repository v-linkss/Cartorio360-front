import{r as f,m as i,H as q,p as F,c as y,a as T,b as c,v,I as L,w as p,K as n,F as h,s as $,o as t,bi as D,z as I,d as P,E as m,V as _}from"./D4w0Um61.js";import{u as k,V as S}from"./EzF2ViKA.js";import{V as w}from"./BbQ_dt4-.js";import{V as H}from"./DudaloxQ.js";import{V as O}from"./DchoNiw3.js";import"./CRuPGTBU.js";import"./C3YRJoRk.js";import"./0v8G9Lb8.js";import"./BQ0p2Qh_.js";const Q={key:0},ee={__name:"lista",async setup(z){let d,g;const V=$(),C=`${V.public.managemant}/getRelatorios`,U=`${V.public.managemant}/createRelatorio`,B=`${V.public.managemant}/listaQuery`,b=f([]),u=f(null),r=f([]),R={user_token:i("auth_token").value,cartorio_token:i("user-data").value.cartorio_token,user_name:i("user-data").value.nome},{data:E}=([d,g]=q(()=>k(C,{method:"POST",body:R},"$53NFRNGH7x")),d=await d,g(),d);b.value=Array.isArray(E.value)?E.value:[];const A=F(()=>b.value.every(o=>!o.codigo&&!o.value&&!o.parametros)?[]:b.value.map(o=>({label:o.codigo,value:o.codigo,parametros:o.parametros}))),N=async o=>{const a=A.value.find(e=>e.value===o);if(a){r.value=a.parametros.map(e=>({...e,value:null,showDatePicker:!1,items:[]}));for(const e of r.value)if(e.tipo==="TABLE"&&e.dominio)try{const{data:s}=await k(B,{method:"POST",body:{cartorio_token:R.cartorio_token,parametros:e.dominio}},"$c4psqRQWRs");e.items=Array.isArray(s.value)?s.value.map(l=>({label:l.nome,value:l.token})):[]}catch(s){console.error("Erro ao buscar dados para TABLE:",s)}}else r.value=[]},x=async()=>{const o=r.value.reduce((a,e)=>(a[e.parametro]=e.value,a),{});try{const a={...o,user_id:i("user-data").value.usuario_id},{data:e}=await k(U,{method:"POST",body:a},"$6CLQJHdzNf");window.open(e.value,"_blank"),r.value=[],u.value=null}catch(a){console.error("Erro ao criar o relatório:",a)}};return(o,a)=>(t(),y(h,null,[a[2]||(a[2]=T("h1",null,"Relatórios",-1)),T("div",null,[c(w,{modelValue:v(u),"onUpdate:modelValue":a[0]||(a[0]=e=>L(u)?u.value=e:null),items:v(A),class:"mb-5","item-title":"label","item-value":"value",label:"Selecione o relatório",required:"","onUpdate:search":N},null,8,["modelValue","items"])]),v(u)?(t(),y("div",Q,[c(H,null,{default:p(()=>[(t(!0),y(h,null,D(v(r),(e,s)=>(t(),m(S,{key:s},{default:p(()=>[c(O,{cols:"4"},{default:p(()=>[e.tipo!=="DATE"&&e.tipo!=="TABLE"?(t(),m(_,{key:0,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,label:e.label,required:e.obrigatorio},null,8,["modelValue","onUpdate:modelValue","label","required"])):n("",!0),e.tipo==="INTEGER"?(t(),m(_,{key:1,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,type:"number",outlined:""},null,8,["modelValue","onUpdate:modelValue"])):n("",!0),e.tipo==="DATE"?(t(),m(_,{key:2,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,type:"date"},null,8,["modelValue","onUpdate:modelValue"])):n("",!0),e.tipo==="TABLE"?(t(),m(w,{key:3,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,items:e.items,"item-title":"label","item-value":"value",label:e.label,required:e.obrigatorio},null,8,["modelValue","onUpdate:modelValue","items","label","required"])):n("",!0)]),_:2},1024)]),_:2},1024))),128)),c(I,{color:"green",class:"mt-4",onClick:x},{default:p(()=>a[1]||(a[1]=[P("Enviar")])),_:1})]),_:1})])):n("",!0)],64))}};export{ee as default};
