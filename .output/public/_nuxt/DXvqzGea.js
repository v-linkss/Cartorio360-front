import{_ as ee}from"./D10VG8wg.js";import{_ as te,a as oe}from"./CeHoD5i3.js";import{_ as ae}from"./FyAfmi6z.js";import{_ as se,a as re,b as ne}from"./BP1uhy__.js";import{_ as le}from"./Cc5qRDao.js";import{c as I,r as T,u as ie}from"./b9RSr7Gq.js";import{u as ue,H as de,C as pe,r as u,m as k,D as me,I as U,Q as ce,G as V,w as n,s as _e,o as c,b as r,a as l,t as fe,v as a,R as ve,V as w,y as ge,z as ke,c as z,A as he,d as xe}from"./Cokzuwzt.js";import{u as C,V as h}from"./B-VM5pXc.js";import{f as ye}from"./BJWjZbqh.js";import{V as $e}from"./D1UEJG3p.js";import{V as x}from"./Bs6SOBv7.js";import{V as be}from"./DLR9R274.js";import{V as Ve}from"./CZMmUZrJ.js";import"./BsdYkLvL.js";import"./DEDGJIxI.js";import"./C8_OzxXM.js";import"./D663BEgi.js";import"./CitRsHXM.js";const we={style:{color:"red","margin-left":"30px"}},Ce=["onClick"],Oe=["onClick","title"],Re=["disabled","onClick"],Ae={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:re,alt:"Visualizar",title:"Reativar"},Ee={key:1,src:ne,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Ye={__name:"[id]",async setup(Ie){let i,_;const{$toast:O}=ue(),B=de(),{id:p}=B.params,y=pe(),f=_e(),S=`${f.public.managemant}/updateOrdensServico`,q=`${f.public.managemant}/getOrdensServicoById`,D=`${f.public.managemant}/listarAtos`,P=`${f.public.managemant}/updateAtos`,N=u(k("user-data").value.cartorio_id),F=u(k("user-data").value.usuario_id),M=u(k("user-service").value.token).value||null,G=u(k("user-data").value.cartorio_token).value,$=u([]),b=u(!1),R=u(null),m=u(null),s=me({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),L=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],H=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],K={apresentante_nome:{required:I.withMessage("O campo é obrigatorio",T)},apresentante_cpf:{required:I.withMessage("O campo é obrigatorio",T)}},d=ie(K,s);function Q(o){if(o)return o.replace(/[.\-]/g,"");o=null}const W=o=>{R.value=o,b.value=!0},X=o=>{o.rota==="/fontes/atos/ato-sem-bem/geral"?y.push({path:`/fontes/atos/atos-sem-bem/atualizar/${o.id}`,query:{origem:"atualizar",id:p,ato_id:o.id,tipo_ato_token:o.tipo_token,ato_token_edit:o.token,numero_os:m.value}}):o.rota==="/fontes/atos/ato-com-bem/geral"&&y.push({path:`/fontes/atos/atos-com-bem/atualizar/${o.id}`,query:{origem:"atualizar",id:p,ato_id:o.id,tipo_ato_token:o.tipo_token,ato_token_edit:o.token,numero_os:m.value}})};async function Y(){const o={apresentante_cpf:Q(s.apresentante_cpf),apresentante_nome:s.apresentante_nome,user_id:F.value,cartorio_id:N.value},{error:t,status:g}=await C(`${S}/${p}`,{method:"PUT",body:o},"$Fud06ay483");g.value==="error"&&t.value.statusCode===500?O.error("Erro ao cadastrar ordem,erro no sistema."):(O.success("Ordem Atualizada com sucesso!"),y.push({path:"/os/lista"}))}const{data:v}=([i,_]=U(()=>C(`${q}/${p}`,{method:"GET"},"$wPUkUpDvPf")),i=await i,_(),i);m.value=v.value.numero,s.nacionalidade=v.value.estrangeiro,s.apresentante_cpf=v.value.apresentante_cpf,s.apresentante_nome=v.value.apresentante_nome;const{data:A}=([i,_]=U(()=>C(D,{method:"POST",body:{cartorio_token:G,ordemserv_token:M}},"$YXZ55K3IUf")),i=await i,_(),i);async function Z(o){o.excluido=!o.excluido;try{await ye(`${P}/${o.id}`,{method:"PUT",body:{excluido:o.excluido}})}catch(t){console.error("Erro ao excluir pessoa:",t)}}return A.value.length>0?$.value=A.value:$.value=[],(o,t)=>{const g=ee,j=oe,J=ce("mask");return c(),V($e,{class:"mt-5"},{default:n(()=>[r(h,{class:"mb-5"},{default:n(()=>[t[6]||(t[6]=l("h1",null,"Ordem de Serviço nº",-1)),l("h1",we,fe(a(m)),1)]),_:1}),r(h,null,{default:n(()=>[r(x,{md:"3"},{default:n(()=>[r(be,{label:"Nacionalidade",items:H,modelValue:a(s).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>a(s).nacionalidade=e)},null,8,["modelValue"])]),_:1}),r(x,{md:"2"},{default:n(()=>[a(s).nacionalidade==="brasileiro"?ve((c(),V(w,{key:0,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>a(s).apresentante_cpf=e),label:"CPF",required:"","error-messages":a(d).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(d).apresentante_cpf.$touch,onInput:a(d).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[J,"###.###.###-##"]]):(c(),V(w,{key:1,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>a(s).apresentante_cpf=e),label:"Documento",required:"","error-messages":a(d).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(d).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),r(x,{md:"4"},{default:n(()=>[r(w,{modelValue:a(s).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>a(s).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":a(d).apresentante_nome.$errors.map(e=>e.$message),onInput:a(d).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),r(x,null,{default:n(()=>[l("div",null,[l("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:ae,alt:"Salvar",onClick:t[4]||(t[4]=e=>Y())})])]),_:1})]),_:1}),r(h,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:n(()=>[t[9]||(t[9]=l("h1",{class:"ml-5"},"Atos",-1)),r(g,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:a(p),numeroOs:a(m)}}},{default:n(()=>t[7]||(t[7]=[l("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:se,alt:"novo"},null,-1)])),_:1},8,["to"]),r(Ve,{headers:L,items:a($),"item-key":"id"},{"item.actions":n(({item:e})=>[r(h,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:n(()=>[l("div",{onClick:E=>W(e.token),title:"Reimprimir"},t[8]||(t[8]=[l("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:te,alt:"Reimprimir"},null,-1)]),8,Ce),l("div",{class:ke({disabled:!e.btn_editar}),onClick:E=>e.btn_editar?X({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,rota:e.rota}):null,title:e.btn_editar?"Editar":"Desabilitado"},[l("img",{style:ge({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:le,alt:"Editar"},null,4)],10,Oe),l("div",{disabled:!e.btn_cancelar,onClick:E=>e.btn_cancelar?Z(e):null,title:"Excluir"},[e.excluido?(c(),z("img",Ae)):(c(),z("img",Ee))],8,Re)]),_:2},1024)]),_:1},8,["items"]),r(j,{show:a(b),ato_token:a(R),onClose:t[5]||(t[5]=e=>b.value=!1)},null,8,["show","ato_token"])]),_:1}),r(g,{to:"/os/lista"},{default:n(()=>[r(he,{size:"large",color:"red"},{default:n(()=>t[10]||(t[10]=[xe("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Ye as default};
