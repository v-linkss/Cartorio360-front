import{_ as $}from"./B16moC2y.js";import{r as U,e as I,f as L,m as O,h as T,w as r,k as B,o as j,b as l,q as v,s as p,i as n,a as b}from"./BmNTIIJ7.js";import{u as F}from"./D4mFQLWq.js";import{V as N}from"./DrYU_EIX.js";import{V as c}from"./CuCaVKY2.js";import{V as M}from"./DaoQRp90.js";import"./BNKUZkCc.js";const P=""+new URL("btn-csv.DS5dvxBS.png",import.meta.url).href,K={__name:"livro-diario",setup(Y){const f=`${B().public.managemant}/relatorios`,g=U(I("user-data").value.cartorio_token),a=L({data_inicial:_(),data_final:_(),paginaInicial:0,livro:0});function _(){const e=new Date,t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${i}-${t}`}function u(e){if(!e)return null;const[t,i,o]=e.split("/");return`${o}-${i}-${t}`}const V=async()=>{const{data:e}=await F(f,{method:"POST",body:{cartorio_token:g,data_inicial:u(a.data_inicial),data_final:u(a.data_final),livro:a.livro,paginaInicial:a.paginaInicial}},"$YxyRzXktgB");if(e.value){const t=new Blob([e.value],{type:"application/pdf"}),i=URL.createObjectURL(t);window.open(i,"_blank"),setTimeout(()=>URL.revokeObjectURL(i),1e4)}},h=async()=>{const e=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cartorio_token:g.value,data_inicial:u(a.data_inicial),data_final:u(a.data_final),livro:a.livro,paginaInicial:a.paginaInicial,tipo_retorno:"csv"})});if(e.ok){const t=await e.blob();let i="relatorio.csv";const o=e.headers.get("Content-Disposition");if(o&&o.includes("filename=")&&(i=o.split("filename=")[1].replace(/['"]/g,"").trim()),i==="relatorio.csv"){const s=new Date,m=S=>S.toString().padStart(2,"0"),k=m(s.getDate()),w=m(s.getMonth()+1),x=s.getFullYear(),C=m(s.getHours()),R=m(s.getMinutes()),D=m(s.getSeconds());i=`livro_diario_${k}${w}${x}${C}${R}${D}.csv`}const y=URL.createObjectURL(t),d=document.createElement("a");d.href=y,d.download=i,document.body.appendChild(d),d.click(),setTimeout(()=>{URL.revokeObjectURL(y),document.body.removeChild(d)},1e3)}};return(e,t)=>{const i=O("mask");return j(),T(N,null,{default:r(()=>[l(M,{class:"mt-1"},{default:r(()=>[l(c,null,{default:r(()=>[v(l(p,{modelValue:n(a).data_inicial,"onUpdate:modelValue":t[0]||(t[0]=o=>n(a).data_inicial=o),label:"Data Inicial",placeholder:"dd/mm/yyyy"},null,8,["modelValue"]),[[i,"##/##/####"]])]),_:1}),l(c,null,{default:r(()=>[v(l(p,{modelValue:n(a).data_final,"onUpdate:modelValue":t[1]||(t[1]=o=>n(a).data_final=o),label:"Data Final",placeholder:"dd/mm/yyyy"},null,8,["modelValue"]),[[i,"##/##/####"]])]),_:1}),l(c,null,{default:r(()=>[l(p,{label:"N* Livro",type:"number",modelValue:n(a).livro,"onUpdate:modelValue":t[2]||(t[2]=o=>n(a).livro=o)},null,8,["modelValue"])]),_:1}),l(c,null,{default:r(()=>[l(p,{label:"Pagina Inicial",type:"number",modelValue:n(a).paginaInicial,"onUpdate:modelValue":t[3]||(t[3]=o=>n(a).paginaInicial=o)},null,8,["modelValue"])]),_:1}),l(c,null,{default:r(()=>[b("img",{onClick:V,style:{width:"40px",height:"40px",cursor:"pointer"},src:$,alt:"imprimir",title:"imprimir"}),b("img",{onClick:h,style:{width:"40px",height:"40px",cursor:"pointer","margin-left":"20px"},src:P,alt:"exportar",title:"exportar"})]),_:1}),l(c)]),_:1})]),_:1})}}};export{K as default};
