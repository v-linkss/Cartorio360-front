import{_ as ko}from"./CUqjhfZx.js";import{_ as bo,a as go}from"./CnfDWxmd.js";import{_ as $o}from"./HYwzytM6.js";import{_ as wo}from"./BoUgyOuY.js";import{c as ho,r as Ao,u as Co}from"./BG4dw6j7.js";import{r as u,u as X,e as D,f as oo,g as xo,o as j,h as ao,w as n,b as l,a as s,d as F,t as So,i as t,V as K,j as Do,k as eo,_ as Oo,l as Uo,n as To,m as Po,c as Eo,p as No,F as Mo,q as S,s as c,v as qo,x as B}from"./LE0a20Pj.js";import{u as $}from"./15nnp_Li.js";import{V as Q,a as Io}from"./PP4Pe0Q9.js";import{V as H}from"./Mcoq2Atb.js";import{V as M}from"./B9O5Ruir.js";import{V as Ro}from"./C0o-YGO3.js";import{V as zo}from"./GBy-r3dV.js";import{_ as W}from"./BRipf9vU.js";import{_ as Fo}from"./BkoMhmkN.js";import{_ as Bo}from"./BrsXrfHp.js";import{_ as Lo}from"./40Mu4Pbg.js";import{u as jo}from"./ByVGb8a7.js";import{f as N}from"./B0IxRygJ.js";import{V as Ho}from"./Bq7DcDYD.js";import{V as m}from"./U90pyLBS.js";import{V as L}from"./5GJMbiJZ.js";import"./CT7MsWOg.js";import"./BVz1G1IN.js";import"./DJvq3mCv.js";import"./CumXHMvM.js";import"./llfAYgtB.js";import"./BMVlqJKO.js";import"./_aMdnNjg.js";import"./Ds54zvGE.js";import"./kGqfqzKx.js";import"./JKpCmkkq.js";import"./wIx7qESN.js";const Jo={class:"mb-5",style:{display:"flex","justify-content":"flex-start"}},Go={class:"ml-6"},Yo={class:"ml-6"},Zo="O cancelamento de atos é definitivo e não pode ser revertido. Informe o motivo do cancelamento para confirmar",Ko={__name:"CancelamentoAto",props:{show:Boolean,ato_token:String},emits:["close"],setup(J,{emit:f}){const y=J,b=u(y.show),q=eo(),{$toast:w}=X(),I=u(D("auth_token").value),O=`${q.public.managemant}/cancela_lavratura`,p=oo({motivo:null}),A=f,C={motivo:{required:ho.withMessage("O campo é obrigatorio",Ao)}},V=Co(C,p);xo(()=>y.show,k=>{b.value=k});const g=()=>{b.value=!1,A("close")},U=async()=>{var k,d;if(await V.value.$validate())try{const{data:i,status:T}=await $(O,{method:"POST",body:{ato_token:y.ato_token,user_token:I.value,cancelar_selo:!1,motivo_cancelamento:p.motivo}},"$VPLGcUZMk8");T.value==="success"&&Array.isArray(i.value)&&((k=i.value[0])==null?void 0:k.status)==="OK"?(w.success("Ato cancelado com sucesso!"),g()):Array.isArray(i.value)&&((d=i.value[0])==null?void 0:d.status)==="ERRO"?w.error(i.value[0].status_mensagem||"Erro ao cancelar ato"):w.error("Erro inesperado ao cancelar ato")}catch(i){console.error("Erro ao cancelar ato:",i),w.error("Erro ao cancelar ato")}};return(k,d)=>(j(),ao(zo,{persistent:"",modelValue:t(b),"onUpdate:modelValue":d[1]||(d[1]=i=>Do(b)?b.value=i:null),"max-width":"650"},{default:n(()=>[l(Q,null,{default:n(()=>[l(H,null,{default:n(()=>[l(M,{class:"mb-5 mt-1 ml-2"},{default:n(()=>d[2]||(d[2]=[s("h1",null,"Cancelamento de Ato",-1),s("h1",{style:{color:"red","margin-left":"18px"}},null,-1)])),_:1}),l(H,null,{default:n(()=>[l(Q,{variant:"outlined",class:"mb-5"},{default:n(()=>[l(Io,null,{default:n(()=>[F(So(Zo))]),_:1})]),_:1}),l(Ro,{label:"Motivo",modelValue:t(p).motivo,"onUpdate:modelValue":d[0]||(d[0]=i=>t(p).motivo=i),required:"","error-messages":t(V).motivo.$errors.map(i=>i.$message),onBlur:t(V).motivo.$touch,onInput:t(V).motivo.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),s("div",Jo,[s("div",Go,[l(K,{size:"large",color:"red",onClick:g},{default:n(()=>d[3]||(d[3]=[F("Fechar")])),_:1})]),s("div",Yo,[l(K,{size:"large",color:"green",disabled:!t(p).motivo||t(p).motivo.trim()==="",onClick:U},{default:n(()=>d[4]||(d[4]=[F(" Salvar ")])),_:1},8,["disabled"])])])]),_:1})]),_:1},8,["modelValue"]))}},Qo={style:{width:"1300px",margin:"0 auto"}},Wo={style:{display:"flex",gap:"4px","justify-content":"center"}},Xo=["onClick"],oa=["onClick"],aa=["onClick","title"],ea=["onClick"],ta=["title"],la=["onClick"],ra={__name:"index",setup(J){const f=eo(),{$toast:y}=X(),b=`${f.public.managemant}/listarUsuarios`,q=`${f.public.managemant}/listar_tipo_atos`,w=`${f.public.biometria}/run-scanner?format=pdf`,I=`${f.public.envioDoc}/upload`;`${f.public.managemant}`;const O=`${f.public.managemant}/pesquisaAtos`,{redirectTo:p}=jo(),A=u(D("auth_token").value)||null,C=u(D("user-data").value.cartorio_token)||null,V=u(!1),g=u([]),U=u([]),k=u([]),d=u(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),i=u(!1),T=u(!1),R=u(!1),G=u(null),to=u({}),z=u(!1),P=u(null),r=oo({numero:null,data_inicio:Y(),data_fim:Y(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:A.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),lo=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:a=>a.protocolo?`${a.id}
${a.protocolo}`:`${a.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:a=>a.dt_abertura?`${a.dt_abertura}
${a.apresentante_cpf}`:`${a.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:a=>a.dt_lavratura?`${a.dt_lavratura}
${a.apresentante_nome}`:`${a.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:a=>a.situacao?`${a.situacao}
${a.ato_servico}`:`${a.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function Y(){const a=new Date,o=a.getFullYear(),_=String(a.getMonth()+1).padStart(2,"0");return`${String(a.getDate()).padStart(2,"0")}-${_}-${o}`}function h(a){if(!a)return null;const[o,_,v]=a.split("/");return`${v}-${_}-${o}`}async function Z(){const a=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(a),{data:_}=await $(O,{method:"POST",body:{cartorio_token:D("user-data").value.cartorio_token,usuario_token:o.usuario_token||A.value,data_fim:h(o==null?void 0:o.data_fim),data_inicio:h(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");_.value.length>0&&(g.value=_.value.map(v=>({...v,dt_lavratura:v.dt_lavratura?N(v.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:N(v.dt_abertura,"dd/mm/yyyy")})))}async function ro(){const{data:a}=await $(b,{method:"POST",body:{cartorio_token:C.value}},"$hvipqUJYtS");U.value=a.value}async function no(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(r));const{data:a}=await $(O,{method:"POST",body:{cartorio_token:C.value,numero_os:r.numero||null,data_inicio:h(r.data_inicio)||null,data_fim:h(r.data_fim)||null,data_lavratura_inicio:h(r.data_lavratura_inicio)||null,data_lavratura_fim:h(r.data_lavratura_fim)||null,protocolo:r.protocolo||null,livro:r.livro||null,folha:r.folha||null,situacao:r.situacao||null,usuario_token:r.usuario_token,selo:r.selo||null,ato_tipo_token:r.ato_tipo_token,parte:r.parte||null}},"$OjamgBH6nj");a.value.length>0?g.value=a.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?N(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?N(o.dt_abertura,"dd/mm/yyyy"):null})):(g.value=[],y.error("Não existe ato Registrado!"))}catch(a){console.error("Erro na requisição",a)}}const so=a=>{p({item:a,id:a.id,numeroOs:a.numero_os,origem:"vizualizar-lista"})};async function io(){const{data:a,error:o}=await $(q,{method:"POST",body:{cartorio_token:C.value,usuario_token:A.value,tipo_retorno:"servico_ato"}},"$QxIfw0Zxe4");k.value=a.value}const uo=a=>{P.value=a,z.value=!0};function mo(a){G.value=a.numero,P.value=a.token,R.value=!0}const co=a=>{p({item:a,id:a.id,numeroOs:a.numero_os,origem:"atualizar-lista"})},po=async a=>{try{await vo(),await _o(a)}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}};async function _o(a){try{const{status:o,data:_}=await $(I,{method:"POST",body:{tipo:"ato_livro",token:a,cartorio_token:D("user-data").value.cartorio_token}},"$ceiptlfDNO");o.value==="success"&&y.success("Arquivo enviado com sucesso!")}catch(o){y.error(o),console.error("Erro ao enviar o arquivo:",o)}}async function vo(){try{const{data:a}=await $(w,{method:"GET"},"$zTNfED00Fu")}catch(a){y.error("Erro ao acionar o scanner:",a)}}return Uo(()=>{To(async()=>{const a=sessionStorage.getItem("pesquisaAto");if(a){const o=JSON.parse(a);Object.assign(r,o)}await Z()})}),ro(),io(),(a,o)=>{const _=ko,v=bo,fo=$o,yo=wo,Vo=Ko,x=Po("mask");return j(),Eo(Mo,null,[l(H,{class:"mt-5"},{default:n(()=>[l(M,{class:"mb-5"},{default:n(()=>o[20]||(o[20]=[s("h1",null,"Atos",-1)])),_:1}),l(M,null,{default:n(()=>[l(m,{cols:"2"},{default:n(()=>[S(l(c,{modelValue:t(r).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=e=>t(r).data_inicio=e),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(m,{cols:"2"},{default:n(()=>[S(l(c,{modelValue:t(r).data_fim,"onUpdate:modelValue":o[1]||(o[1]=e=>t(r).data_fim=e),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(m,{cols:"2"},{default:n(()=>[S(l(c,{modelValue:t(r).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=e=>t(r).data_lavratura_inicio=e),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(m,{cols:"2"},{default:n(()=>[S(l(c,{modelValue:t(r).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=e=>t(r).data_lavratura_fim=e),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[x,"##/##/####"]])]),_:1}),l(m,{cols:"2"},{default:n(()=>[l(c,{modelValue:t(r).numero,"onUpdate:modelValue":o[4]||(o[4]=e=>t(r).numero=e),label:"N° OS"},null,8,["modelValue"])]),_:1}),l(m,{cols:"2"},{default:n(()=>[l(c,{modelValue:t(r).selo,"onUpdate:modelValue":o[5]||(o[5]=e=>t(r).selo=e),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),l(M,null,{default:n(()=>[l(m,{cols:"2"},{default:n(()=>[l(c,{modelValue:t(r).protocolo,"onUpdate:modelValue":o[6]||(o[6]=e=>t(r).protocolo=e),label:"Protocolo"},null,8,["modelValue"])]),_:1}),l(m,{cols:"2"},{default:n(()=>[S(l(c,{modelValue:t(r).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=e=>t(r).apresentante_cpf=e),label:"CPF",dense:""},null,8,["modelValue"]),[[x,"###.###.###-##"]])]),_:1}),l(m,{cols:"3"},{default:n(()=>[l(c,{modelValue:t(r).parte,"onUpdate:modelValue":o[8]||(o[8]=e=>t(r).parte=e),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),l(m,{cols:"3"},{default:n(()=>[l(L,{modelValue:t(r).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=e=>t(r).ato_tipo_token=e),items:t(k),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),l(m,{cols:"2"},{default:n(()=>[l(L,{items:t(U),modelValue:t(r).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=e=>t(r).usuario_token=e),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),l(m,{cols:"3"},{default:n(()=>[l(L,{modelValue:t(r).situacao,"onUpdate:modelValue":o[11]||(o[11]=e=>t(r).situacao=e),items:t(d),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),l(m,{cols:"1"},{default:n(()=>[l(c,{modelValue:t(r).livro,"onUpdate:modelValue":o[12]||(o[12]=e=>t(r).livro=e),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),l(m,{cols:"1"},{default:n(()=>[l(c,{modelValue:t(r).folha,"onUpdate:modelValue":o[13]||(o[13]=e=>t(r).folha=e),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),l(m,null,{default:n(()=>[s("div",null,[s("img",{onClick:no,style:{width:"40px",height:"40px",cursor:"pointer"},src:W,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),s("div",Qo,[o[24]||(o[24]=s("hr",{class:"mt-5 mb-5"},null,-1)),l(Ho,{headers:lo,items:t(g),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":n(({item:e})=>[s("div",Wo,[s("div",{onClick:E=>so({id:e.id,tipo:`${e.tipo_servico} - ${e.tipo_ato}`,token:e.token,tipo_token:e.tipo_token,rota:e.rota,numero_os:e.numero_os}),title:"Visualizar"},o[21]||(o[21]=[s("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:W,alt:"Visualizar"},null,-1)]),8,Xo),s("div",{onClick:E=>uo(e.token),title:"Reimprimir"},o[22]||(o[22]=[s("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:go,alt:"Reimprimir"},null,-1)]),8,oa),s("div",{class:qo({disabled:!e.btn_editar}),onClick:E=>e.btn_editar?co({id:e.id,tipo:`${e.tipo_servico} - ${e.tipo_ato}`,token:e.token,tipo_token:e.tipo_token,rota:e.rota,numero_os:e.numero_os}):null,title:e.btn_editar?"Editar":"Desabilitado"},[s("img",{style:B({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:Fo,alt:"Editar"},null,4)],10,aa),s("div",{onClick:E=>e.btn_cancelar?mo(e):null,title:"Excluir",style:B({cursor:e.btn_cancelar?"pointer":"not-allowed"})},[s("img",{style:B({width:"30px",height:"30px",cursor:e.btn_cancelar?"pointer":"not-allowed",opacity:e.btn_cancelar?"1":"0.5"}),src:Bo,alt:"Cancelar",title:e.btn_cancelar?"Cancelar":"Não permitido"},null,12,ta)],12,ea),s("div",{onClick:E=>po(e.token)},o[23]||(o[23]=[s("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:Lo,alt:"escanear",title:"escanear"},null,-1)]),8,la)])]),_:1},8,["items"])]),t(V)?(j(),ao(_,{key:0,show:t(V),servicos:a.dadosData.servicos||[],tiposAtos:a.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=e=>V.value=!1),onUpdateAto:a.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):No("",!0),l(v,{show:t(z),ato_token:t(P),onClose:o[15]||(o[15]=e=>z.value=!1)},null,8,["show","ato_token"]),l(fo,{show:t(i),numero_os:t(G),ordem:t(to),onClose:o[16]||(o[16]=e=>i.value=!1),onRefreshValue:o[17]||(o[17]=e=>Z())},null,8,["show","numero_os","ordem"]),l(yo,{show:t(T),condMessage:a.condMessage,onClose:o[18]||(o[18]=e=>T.value=!1),onConfirm:a.cancelaAto},null,8,["show","condMessage","onConfirm"]),l(Vo,{show:t(R),ato_token:t(P),onClose:o[19]||(o[19]=e=>R.value=!1)},null,8,["show","ato_token"])],64)}}},Ia=Oo(ra,[["__scopeId","data-v-9ea35206"]]);export{Ia as default};
