import{_ as de}from"./Cm8rSNCH.js";import{_ as pe}from"./Cb89q7us.js";import{_ as ve}from"./B0Smkjfd.js";import{_ as fe}from"./CMsLqRGW.js";import{_ as _e}from"./6RYVis8C.js";import{_ as K}from"./C2wXVBaH.js";import{_ as ke}from"./BVz1G1IN.js";import{_ as he}from"./Cn_zBKmk.js";import{a as ye}from"./DJvq3mCv.js";import{D as ge,K as be,u as Ve,r as l,e as y,f as we,y as Pe,c as M,b as t,w as n,i as o,h as xe,p as $e,F as Ce,k as qe,o as C,s as O,a as m,V as Se,d as I}from"./BFubt5K-.js";import{u as f}from"./DO0JiUxm.js";import{V as q}from"./Cn46jq14.js";import{V as _}from"./CCJ0H2nG.js";import{V as Fe}from"./C1ZbU8qv.js";import{V as U}from"./0HI9nnWz.js";import"./BCTiy3FD.js";import"./CNVU-2UN.js";import"./BjBE1yu7.js";import"./D3GBDuUx.js";import"./B0IxRygJ.js";import"./DS_gXmtl.js";import"./Q4Fj7ezm.js";import"./CGSGkCFE.js";import"./CJw_lHYf.js";import"./BcLYmS-Z.js";import"./DXFSGs24.js";import"./BU3oJa_R.js";import"./B9P8d4Wk.js";import"./CKaoJ7m9.js";import"./CpdEvSWE.js";import"./kJoZuS00.js";import"./BAz72YtY.js";import"./TDtrdbi3.js";import"./BMR0Cjw9.js";const Te=["onClick"],Me={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:K,alt:"Possui Ficha",title:"Possui Ficha"},Oe={key:1,style:{width:"30px",height:"30px",cursor:"pointer"},src:he,alt:"Visualizar",title:"Não Possui Ficha"},Ae=["onClick"],ft={__name:"semelhanca",props:{ato_token:{type:String,required:!0}},emits:["ato-created"],async setup(L,{emit:W}){var D;let g,A;const Q=L,Z=W,R=ge(),z=be(),d=qe(),{$toast:G}=Ve(),H=`${d.public.managemant}/listarEscrevente`,Y=`${d.public.managemant}/pesquisarPessoas`,J=`${d.public.managemant}/atoReconhecimento`,X=`${d.public.managemant}/etiquetaReconhecimento`,ee=`${d.public.managemant}/download`,te=`${d.public.envioDoc}/print`,b=l(y("user-data").value.cartorio_token),oe=l(y("user-service").value.token).value||l(y("user-service").value).value,ae=y("auth_token").value,S=l(!1),F=l([]),E=l([]),k=l([]),V=l(!1),T=l(!1),w=l(!1),P=l(null),N=l(null),x=l(""),B=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],r=we({quantidade:1,escrevente:null,nome:null,documento:null}),{data:j}=([g,A]=Pe(()=>f(H,{method:"POST",body:{cartorio_token:b}},"$iEFsIjdWdW")),g=await g,A(),g);E.value=Array.isArray(j.value)&&((D=j.value[0])==null?void 0:D.func_json_escreventes)||[];async function se(){try{const{data:s,error:e}=await f(Y,{method:"POST",body:{cartorio_token:b.value,documento:r.documento,nome:r.nome}},"$uzKb8LPV3v");s.value.length>0?(F.value=s.value,Z("ato-created")):F.value=[]}catch(s){console.error("Erro na requisição",s)}}const ne=()=>{T.value=!0};function re(s){k.value.push(s)}const le=async s=>{P.value=s,w.value=!0;const{data:e}=await f(ee,{method:"POST",body:{bucket:y("user-data").value.cartorio_token,path:s.link_ficha}},"$MulQmK1LAp");N.value=e.value};function ie(s){k.value=k.value.filter(e=>e.token!==s.token)}async function ue(){var u,c,i,a;if(!r.escrevente){G.error("Por favor selecione um Escrevente");return}if(S.value)return;S.value=!0;const s=k.value.map(v=>({pessoa_token:v.token})),{data:e,error:p,status:h}=await f(J,{method:"POST",body:{pessoas:s,cartorio_token:b.value,ordemserv_token:oe,quantidade:r.quantidade,usuario_token:ae,ato_tipo_token:Q.ato_token}},"$fMGlIlw995");h.value==="success"&&Array.isArray(e.value)&&((u=e.value[0])==null?void 0:u.status)==="OK"?ce(e.value[0].token):($(),V.value=!0,x.value=Array.isArray(e.value)&&((c=e.value[0])==null?void 0:c.status_mensagem)||((a=(i=p==null?void 0:p.value)==null?void 0:i.data)==null?void 0:a.details)||"Não foi possível concluir o reconhecimento")}async function ce(s){var u,c;const{data:e,error:p,status:h}=await f(X,{method:"POST",body:{ato_token:s,cartorio_token:b.value,escrevente_token:r.escrevente}},"$oSnYNRtP6Z");if(h.value==="success"){if(e.value[0].tipo_etiqueta==="html"){const i=window.open("","_blank");i.document.open(),i.document.write(e.value[0].etiqueta),i.document.close()}else if(e.value[0].tipo_etiqueta==="zpl"){const{status:i,error:a}=await f(`${te}`,{method:"POST",body:{zpl:atob(e.value[0].etiqueta)},timeout:3e4},"$BtUyHn78O6");if(i.value!=="success"){V.value=!0;const v=(c=(u=a.value)==null?void 0:u.data)==null?void 0:c.message;v?x.value=v:x.value="O sistema demorou demais para responder e a impressão não foi feita.";return}}$()}}const me=()=>{V.value=!1,$()},$=()=>{const s=z.query.origem||"criar",e=z.query.id;s==="atualizar"?R.push(`/os/atualizar/${e}`):R.push("/os/criar-registro")};return(s,e)=>{const p=de,h=pe,u=ve,c=fe,i=_e;return C(),M(Ce,null,[t(q,{class:"mt-5"},{default:n(()=>[t(_,{cols:"5"},{default:n(()=>[t(Fe,{label:"Tabelião/escrevente",modelValue:o(r).escrevente,"onUpdate:modelValue":e[0]||(e[0]=a=>o(r).escrevente=a),items:o(E),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),t(_,{cols:"2"},{default:n(()=>[t(O,{label:"Quantidade",type:"number",modelValue:o(r).quantidade,"onUpdate:modelValue":e[1]||(e[1]=a=>o(r).quantidade=a)},null,8,["modelValue"])]),_:1})]),_:1}),t(q,null,{default:n(()=>[t(_,{cols:"3"},{default:n(()=>[t(O,{label:"Documento",modelValue:o(r).documento,"onUpdate:modelValue":e[2]||(e[2]=a=>o(r).documento=a)},null,8,["modelValue"])]),_:1}),t(_,{cols:"4"},{default:n(()=>[t(O,{label:"Pessoa",modelValue:o(r).nome,"onUpdate:modelValue":e[3]||(e[3]=a=>o(r).nome=a)},null,8,["modelValue"])]),_:1}),m("div",null,[m("img",{class:"btn-pointer mt-3",src:K,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:se})]),m("div",null,[m("img",{class:"btn-pointer mt-3 ml-2",src:ke,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ne})])]),_:1}),t(q,null,{default:n(()=>[t(_,{class:"mr-10"},{default:n(()=>[t(U,{style:{height:"465px"},headers:B,items:o(F)},{"item.actions":n(({item:a})=>[m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:v=>le(a),title:"Visualizar Ficha"},[a.link_ficha?(C(),M("img",Me)):(C(),M("img",Oe))],8,Te)]),_:1},8,["items"])]),_:1}),t(_,null,{default:n(()=>[t(U,{headers:B,items:o(k),style:{height:"465px"},"item-key":"id"},{"item.actions":n(({item:a})=>[m("div",{style:{display:"flex","justify-content":"flex-end"},onClick:v=>ie(a),title:"Remover"},e[7]||(e[7]=[m("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ye,alt:"Remover"},null,-1)]),8,Ae)]),_:1},8,["items"])]),_:1})]),_:1}),t(p,{show:o(T),onClose:e[4]||(e[4]=a=>T.value=!1)},null,8,["show"]),o(w)?(C(),xe(h,{key:0,show:o(w),item:o(P),"pessoa-obj":o(P),"link-view":o(N),onConfirmar:e[5]||(e[5]=a=>re(o(P))),onClose:e[6]||(e[6]=a=>w.value=!1)},null,8,["show","item","pessoa-obj","link-view"])):$e("",!0),t(q,null,{default:n(()=>[t(u,{onClick:$},{default:n(()=>[t(Se,{size:"large",color:"red"},{default:n(()=>e[8]||(e[8]=[I("Voltar")])),_:1})]),_:1}),t(c,{class:"ml-5",disabled:o(S),onSave:ue,size:"large",color:"green"},{default:n(()=>e[9]||(e[9]=[I("Salvar ")])),_:1},8,["disabled"])]),_:1}),t(i,{show:o(V),errorMessage:o(x),onClose:me},null,8,["show","errorMessage"])],64)}}};export{ft as default};
