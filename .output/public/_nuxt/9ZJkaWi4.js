import{_ as P}from"./HF4Ml83Y.js";import{_ as q}from"./Dk8pvTyo.js";import{_ as D,u as F,r as s,e as v,f as M,c as N,b as o,w as r,a as e,i as n,F as O,l as R,o as E,V as L}from"./CU3Zo7zV.js";import{u as f}from"./CtRFKmpg.js";import{f as y}from"./B0IxRygJ.js";import{V as T}from"./D2g-u1ww.js";import{V as I}from"./xjY2ucWR.js";import{V as h}from"./B7VvtvUw.js";import{V as x}from"./brzdacri.js";import"./Bf-BBYnu.js";import"./DPiD521o.js";import"./D9gNs-IC.js";import"./AdfK9-gI.js";import"./D9BPs4CK.js";import"./CMCd7fo7.js";import"./D3zW7hoK.js";import"./DNwQHCaa.js";const B=""+new URL("btn_cancela_lavratura.DGZVG9h_.png",import.meta.url).href,G={style:{width:"1300px",margin:"0 auto"}},U={style:{display:"flex",gap:"4px","justify-content":"center"}},j=["disabled","onClick"],z={__name:"index",setup(Z){const m=R(),{$toast:c}=F(),g=`${m.public.managemant}/cancela_lavratura`,b=`${m.public.managemant}/pesquisaAtos`,k=s(v("auth_token").value)||null,V=s(v("user-data").value.cartorio_token)||null,d=s([]),u=s(!1),p=s(""),_=s(null),i=M({protocolo:null}),C=[{title:"Protocolo",value:"protocolo"},{title:"Data lavratura/Parte",value:"dt_lavratura"},{title:"Situação/Serviço",key:"situacaoServico",value:t=>t.situacao?`${t.situacao}
${t.ato_servico}`:`${t.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];async function w(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(i));const{data:t}=await f(b,{method:"POST",body:{cartorio_token:V.value,protocolo:i.protocolo||null}},"$EsIaDpdnSx");t.value.length>0?d.value=t.value.map(a=>({...a,dt_lavratura:a.dt_lavratura?y(a.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:a.dt_abertura?y(a.dt_abertura,"dd/mm/yyyy"):null})):(d.value=[],c.error("Não existe ato Registrado!"))}catch(t){console.error("Erro na requisição",t)}}const $=t=>{_.value=t,p.value="Tem certeza que deseja cancelar este ato?",u.value=!0},S=async()=>{const{data:t,status:a}=await f(g,{method:"POST",body:{ato_token:_.value,user_token:k.value,cancelar_selo:!1}},"$Xx0FGnNZIU");a.value==="success"&&t.value[0].status==="OK"?(c.success("Lavratura cancelada com sucesso!"),u.value=!1):t.value[0].status==="ERRO"&&c.error("erro ao cancelar ato")};return(t,a)=>{const A=P;return E(),N(O,null,[o(T,{class:"mt-5"},{default:r(()=>[o(h,{class:"mb-5"},{default:r(()=>a[2]||(a[2]=[e("h1",null,"Cancelamento de Lavratura",-1)])),_:1}),o(h,null,{default:r(()=>[o(x,{cols:"2"},{default:r(()=>[o(L,{modelValue:n(i).protocolo,"onUpdate:modelValue":a[0]||(a[0]=l=>n(i).protocolo=l),label:"Protocolo"},null,8,["modelValue"])]),_:1}),o(x,null,{default:r(()=>[e("div",null,[e("img",{onClick:w,style:{width:"40px",height:"40px",cursor:"pointer"},src:q,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),e("div",G,[a[4]||(a[4]=e("hr",{class:"mt-5 mb-5"},null,-1)),o(I,{headers:C,items:n(d),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":r(({item:l})=>[e("div",U,[e("div",{disabled:!l.btn_cancelar,onClick:H=>l.btn_cancelar?$(l.token):null,title:"Excluir"},a[3]||(a[3]=[e("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:B,alt:"Cancelar",title:"Cancelar"},null,-1)]),8,j)])]),_:1},8,["items"])]),o(A,{show:n(u),condMessage:n(p),onClose:a[1]||(a[1]=l=>u.value=!1),onConfirm:S},null,8,["show","condMessage"])],64)}}},da=D(z,[["__scopeId","data-v-d50eb60d"]]);export{da as default};
