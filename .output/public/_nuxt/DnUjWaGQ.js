import{_ as ie}from"./TxHCakoW.js";import{_ as ue}from"./_BEDNBHg.js";import{_ as ce}from"./12qVIOnh.js";import{_ as me}from"./Bqe6zN_6.js";import{_ as B}from"./nzmtpFvE.js";import{_ as de}from"./BVz1G1IN.js";import{_ as pe}from"./Dht20DbW.js";import{a as ve}from"./DJvq3mCv.js";import{C as _e,J as fe,u as ke,r as l,e as v,f as he,s as ye,c as C,b as t,w as r,i as o,j as ge,k as Ve,F as be,l as we,o as V,V as $,a as i,v as j,d as N}from"./_kPzYe5F.js";import{u as _}from"./Bcx9gJqS.js";import{V as b}from"./B6U71WGb.js";import{V as u}from"./BQQ7PQtz.js";import{V as xe}from"./dT8FF4i9.js";import{V as z}from"./2L3XSKn9.js";import"./D2zDAOxT.js";import"./BfbZh52b.js";import"./j_oFcZLs.js";import"./DgGiS5O0.js";import"./B0IxRygJ.js";import"./D0AD9tYk.js";import"./BE8Ao4um.js";import"./B2LAdmTk.js";import"./BU7plF7r.js";import"./DzfAbnSv.js";import"./DW4Qp3v9.js";import"./DR1i2eWt.js";import"./BPoaSRdr.js";import"./BqyENJj0.js";import"./DKBEdGnO.js";import"./5vYTxwMN.js";const Pe=["onClick"],Ce={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:B,alt:"Possui Ficha",title:"Possui Ficha"},$e={key:1,style:{width:"30px",height:"30px",cursor:"pointer"},src:pe,alt:"Visualizar",title:"Não Possui Ficha"},qe=["onClick"],rt={__name:"semelhanca",props:{ato_token:{type:String,required:!0}},emits:["ato-created"],async setup(I,{emit:A}){let f,q;const D=I,U=A,F=_e(),S=fe(),c=we(),{$toast:K}=ke(),L=`${c.public.managemant}/listarEscrevente`,W=`${c.public.managemant}/pesquisarPessoas`,Q=`${c.public.managemant}/atoReconhecimento`,G=`${c.public.managemant}/etiquetaReconhecimento`,J=`${c.public.managemant}/download`,k=l(v("user-data").value.cartorio_token),Y=l(v("user-service").value.token).value||l(v("user-service").value).value,Z=v("auth_token").value,w=l([]),T=l([]),m=l([]),x=l(!1),P=l(!1),h=l(!1),y=l(null),M=l(null),R=l(""),E=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],n=he({quantidade:1,escrevente:null,nome:null,documento:null}),{data:H}=([f,q]=ye(()=>_(L,{method:"POST",body:{cartorio_token:k}},"$iEFsIjdWdW")),f=await f,q(),f);T.value=H.value[0].func_json_escreventes;async function X(){try{const{data:s,error:e}=await _(W,{method:"POST",body:{cartorio_token:k.value,documento:n.documento,nome:n.nome}},"$uzKb8LPV3v");s.value.length>0?(w.value=s.value,U("ato-created")):w.value=[]}catch(s){console.error("Erro na requisição",s)}}const ee=()=>{P.value=!0};function te(s){m.value.push(s)}const oe=async s=>{y.value=s,h.value=!0;const{data:e}=await _(J,{method:"POST",body:{bucket:v("user-data").value.cartorio_token,path:s.link_ficha}},"$MulQmK1LAp");M.value=e.value};function se(s){m.value=m.value.filter(e=>e.token!==s.token)}async function ae(){if(!n.escrevente){K.error("Por favor selecione um Escrevente");return}const s=m.value.map(e=>({pessoa_token:e.token}));try{const{data:e,error:g,status:d}=await _(Q,{method:"POST",body:{pessoas:s,cartorio_token:k.value,ordemserv_token:Y,quantidade:n.quantidade,usuario_token:Z,ato_tipo_token:D.ato_token}},"$fMGlIlw995");d.value==="success"&&e.value[0].status==="OK"?re(e.value[0].token):(x.value=!0,R.value=ato_token.value.status_mensagem||g.value.data.details)}catch(e){console.error("Erro na requisição",e)}}async function re(s){try{const{data:e,error:g,status:d}=await _(G,{method:"POST",body:{ato_token:s,cartorio_token:k.value,escrevente_token:n.escrevente}},"$oSnYNRtP6Z");if(d.value==="success"){O();const p=window.open("","_blank");p.document.open(),p.document.write(e.value[0].etiqueta),p.document.close()}}catch(e){console.error("Erro na requisição",e)}}const O=()=>{const s=S.query.origem||"criar",e=S.query.id;s==="atualizar"?F.push(`/os/atualizar/${e}`):F.push("/os/criar-registro")};return(s,e)=>{const g=ie,d=ue,p=ce,ne=me;return V(),C(be,null,[t(b,{class:"mt-5"},{default:r(()=>[t(u,{cols:"5"},{default:r(()=>[t(xe,{label:"Tabelião/escrevente",modelValue:o(n).escrevente,"onUpdate:modelValue":e[0]||(e[0]=a=>o(n).escrevente=a),items:o(T),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),t(u,{cols:"2"},{default:r(()=>[t($,{label:"Quantidade",type:"number",modelValue:o(n).quantidade,"onUpdate:modelValue":e[1]||(e[1]=a=>o(n).quantidade=a)},null,8,["modelValue"])]),_:1})]),_:1}),t(b,null,{default:r(()=>[t(u,{cols:"3"},{default:r(()=>[t($,{label:"Documento",modelValue:o(n).documento,"onUpdate:modelValue":e[2]||(e[2]=a=>o(n).documento=a)},null,8,["modelValue"])]),_:1}),t(u,{cols:"4"},{default:r(()=>[t($,{label:"Pessoa",modelValue:o(n).nome,"onUpdate:modelValue":e[3]||(e[3]=a=>o(n).nome=a)},null,8,["modelValue"])]),_:1}),i("div",null,[i("img",{class:"btn-pointer mt-3",src:B,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:X})]),i("div",null,[i("img",{class:"btn-pointer mt-3 ml-2",src:de,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ee})])]),_:1}),t(b,null,{default:r(()=>[t(u,{class:"mr-10"},{default:r(()=>[t(z,{style:{height:"465px"},headers:E,items:o(w)},{"item.actions":r(({item:a})=>[i("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:le=>oe(a),title:"Visualizar Ficha"},[a.link_ficha?(V(),C("img",Ce)):(V(),C("img",$e))],8,Pe)]),_:1},8,["items"])]),_:1}),t(u,null,{default:r(()=>[t(z,{headers:E,items:o(m),style:{height:"465px"},"item-key":"id"},{"item.actions":r(({item:a})=>[i("div",{style:{display:"flex","justify-content":"flex-end"},onClick:le=>se(a),title:"Remover"},e[8]||(e[8]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ve,alt:"Remover"},null,-1)]),8,qe)]),_:1},8,["items"])]),_:1})]),_:1}),t(g,{show:o(P),onClose:e[4]||(e[4]=a=>P.value=!1)},null,8,["show"]),o(h)?(V(),ge(d,{key:0,show:o(h),item:o(y),"pessoa-obj":o(y),"link-view":o(M),onConfirmar:e[5]||(e[5]=a=>te(o(y))),onClose:e[6]||(e[6]=a=>h.value=!1)},null,8,["show","item","pessoa-obj","link-view"])):Ve("",!0),t(b,null,{default:r(()=>[t(p,{onClick:O},{default:r(()=>[t(j,{size:"large",color:"red"},{default:r(()=>e[9]||(e[9]=[N("Voltar")])),_:1})]),_:1}),t(j,{class:"ml-5",onClick:ae,size:"large",color:"green"},{default:r(()=>e[10]||(e[10]=[N("Salvar")])),_:1})]),_:1}),t(ne,{show:o(x),errorMessage:o(R),onClose:e[7]||(e[7]=a=>x.value=!1)},null,8,["show","errorMessage"])],64)}}};export{rt as default};
