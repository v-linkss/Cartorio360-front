import{_ as no}from"./CoIO3KM6.js";import{_ as ro,a as io}from"./CVQsn95C.js";import{_ as uo}from"./BTmKN7sa.js";import{_ as mo}from"./Cr9uwW4M.js";import{_ as L}from"./CIGgdCGv.js";import{_ as po}from"./BeYqzoWR.js";import{_ as co,u as _o,r as u,e as C,f as vo,g as fo,n as yo,h as ko,c as S,b as s,w as n,a as r,i as l,j as Vo,k as bo,F as go,l as $o,o as g,m as f,V as d,p as ho,q as xo}from"./B5Cx9rgB.js";import{_ as wo,a as Ao}from"./DJvq3mCv.js";import{u as Co}from"./BXofU3m9.js";import{u as y}from"./BWNZFg0z.js";import{f as $}from"./B0IxRygJ.js";import{f as So}from"./m4eWvj9w.js";import{V as Uo}from"./D708q0sp.js";import{V as Do}from"./BDU_iOlI.js";import{V as U}from"./CayDjz4d.js";import{V as i}from"./CoNcj0UZ.js";import{V as D}from"./BmjxAdg4.js";import"./Ck7MbFX4.js";import"./C-KeilOI.js";import"./BtSPXjaV.js";import"./DBPE1kaV.js";import"./unOSj3yE.js";import"./B7DiE6OU.js";import"./BVz1G1IN.js";import"./_e-yvbHY.js";import"./DZLVBe30.js";import"./BXHlQV8Q.js";const Oo=""+new URL("btn_cancela_lavratura.DGZVG9h_.png",import.meta.url).href,Po={style:{width:"1300px",margin:"0 auto"}},To={style:{display:"flex",gap:"4px","justify-content":"center"}},No=["onClick"],Eo=["onClick"],Ro=["onClick","title"],Mo=["disabled","onClick"],Io=["onClick"],qo={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:wo,alt:"Visualizar",title:"Reativar"},zo={key:1,src:Ao,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Fo={__name:"index",setup(Lo){const _=$o(),{$toast:O}=_o(),j=`${_.public.managemant}/listarUsuarios`,B=`${_.public.managemant}/listar_tipo_atos`,H=`${_.public.managemant}/cancela_lavratura`,J=`${_.public.managemant}/updateAtos`,P=`${_.public.managemant}/pesquisaAtos`,{redirectTo:T}=Co(),k=u(C("auth_token").value)||null,h=u(C("user-data").value.cartorio_token)||null,x=u(!1),V=u([]),N=u([]),E=u([]),G=u(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),R=u(!1),w=u(!1),M=u(""),W=u(null),Y=u({}),A=u(!1),I=u(null),t=vo({numero:null,data_inicio:q(),data_fim:q(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:k.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),Z=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:a=>a.protocolo?`${a.id}
${a.protocolo}`:`${a.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:a=>a.dt_abertura?`${a.dt_abertura}
${a.apresentante_cpf}`:`${a.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:a=>a.dt_lavratura?`${a.dt_lavratura}
${a.apresentante_nome}`:`${a.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:a=>a.situacao?`${a.situacao}
${a.ato_servico}`:`${a.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function q(){const a=new Date,o=a.getFullYear(),m=String(a.getMonth()+1).padStart(2,"0");return`${String(a.getDate()).padStart(2,"0")}-${m}-${o}`}function c(a){if(!a)return null;const[o,m,p]=a.split("/");return`${p}-${m}-${o}`}async function z(){const a=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(a),{data:m}=await y(P,{method:"POST",body:{cartorio_token:C("user-data").value.cartorio_token,usuario_token:o.usuario_token||k.value,data_fim:c(o==null?void 0:o.data_fim),data_inicio:c(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");m.value.length>0&&(V.value=m.value.map(p=>({...p,dt_lavratura:p.dt_lavratura?$(p.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:$(p.dt_abertura,"dd/mm/yyyy")})))}async function K(){const{data:a}=await y(j,{method:"POST",body:{cartorio_token:h.value}},"$hvipqUJYtS");N.value=a.value}async function Q(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(t));const{data:a}=await y(P,{method:"POST",body:{cartorio_token:h.value,numero:t.numero||null,data_inicio:c(t.data_inicio)||null,data_fim:c(t.data_fim)||null,data_lavratura_inicio:c(t.data_lavratura_inicio)||null,data_lavratura_fim:c(t.data_lavratura_fim)||null,protocolo:t.protocolo||null,livro:t.livro||null,folha:t.folha||null,situacao:t.situacao||null,usuario_token:t.usuario_token,selo:t.selo||null,ato_tipo_token:t.ato_tipo_token,parte:t.parte||null}},"$OjamgBH6nj");a.value.length>0?V.value=a.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?$(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?$(o.dt_abertura,"dd/mm/yyyy"):null})):(V.value=[],O.error("Não existe ato Registrado!"))}catch(a){console.error("Erro na requisição",a)}}const X=a=>{T({item:a,id,numeroOs:a.numero_os,origem:"vizualizar"})};async function oo(){const{data:a,error:o}=await y(B,{method:"POST",body:{cartorio_token:h.value,usuario_token:k.value,tipo_retorno:"servico_ato"}},"$QxIfw0Zxe4");E.value=a.value}const ao=a=>{I.value=a,A.value=!0};async function eo(a){a.excluido=!a.excluido;try{await So(`${J}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}const F=async a=>{const{data:o,status:m}=await y(H,{method:"POST",body:{ato_token:a,user_token:k.value,cancelar_selo:!1}},"$ceiptlfDNO");m.value==="success"&&o.value[0].status==="OK"?O.success("Lavratura cancelada com sucesso!"):o.value[0].status==="ERRO"&&(w.value=!0,M.value=o.value[0].status_mensagem)},to=a=>{T({item:a,id:a.id,numeroOs:a.numero_os,origem:"atualizar"})};return fo(()=>{yo(async()=>{const a=sessionStorage.getItem("pesquisaAto");if(a){const o=JSON.parse(a);Object.assign(t,o)}await z()})}),K(),oo(),(a,o)=>{const m=no,p=ro,lo=uo,so=mo,v=ko("mask");return g(),S(go,null,[s(Uo,{class:"mt-5"},{default:n(()=>[s(U,{class:"mb-5"},{default:n(()=>o[19]||(o[19]=[r("h1",null,"Atos",-1)])),_:1}),s(U,null,{default:n(()=>[s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(t).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=e=>l(t).data_inicio=e),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(t).data_fim,"onUpdate:modelValue":o[1]||(o[1]=e=>l(t).data_fim=e),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(t).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=e=>l(t).data_lavratura_inicio=e),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(t).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=e=>l(t).data_lavratura_fim=e),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(t).numero,"onUpdate:modelValue":o[4]||(o[4]=e=>l(t).numero=e),label:"N° OS"},null,8,["modelValue"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(t).selo,"onUpdate:modelValue":o[5]||(o[5]=e=>l(t).selo=e),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),s(U,null,{default:n(()=>[s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(t).protocolo,"onUpdate:modelValue":o[6]||(o[6]=e=>l(t).protocolo=e),label:"Protocolo"},null,8,["modelValue"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(t).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=e=>l(t).apresentante_cpf=e),label:"CPF",dense:""},null,8,["modelValue"]),[[v,"###.###.###-##"]])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(d,{modelValue:l(t).parte,"onUpdate:modelValue":o[8]||(o[8]=e=>l(t).parte=e),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(D,{modelValue:l(t).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=e=>l(t).ato_tipo_token=e),items:l(E),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(D,{items:l(N),modelValue:l(t).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=e=>l(t).usuario_token=e),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(D,{modelValue:l(t).situacao,"onUpdate:modelValue":o[11]||(o[11]=e=>l(t).situacao=e),items:l(G),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),s(i,{cols:"1"},{default:n(()=>[s(d,{modelValue:l(t).livro,"onUpdate:modelValue":o[12]||(o[12]=e=>l(t).livro=e),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"1"},{default:n(()=>[s(d,{modelValue:l(t).folha,"onUpdate:modelValue":o[13]||(o[13]=e=>l(t).folha=e),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),s(i,null,{default:n(()=>[r("div",null,[r("img",{onClick:Q,style:{width:"40px",height:"40px",cursor:"pointer"},src:L,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),r("div",Po,[o[23]||(o[23]=r("hr",{class:"mt-5 mb-5"},null,-1)),s(Do,{headers:Z,items:l(V),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":n(({item:e})=>[r("div",To,[r("div",{onClick:b=>X({id:e.id,tipo:`${e.tipo_servico} - ${e.tipo_ato}`,token:e.token,tipo_token:e.tipo_token,rota:e.rota,numero_os:e.numero_os}),title:"Visualizar"},o[20]||(o[20]=[r("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:L,alt:"Visualizar"},null,-1)]),8,No),r("div",{onClick:b=>ao(e.token),title:"Reimprimir"},o[21]||(o[21]=[r("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:io,alt:"Reimprimir"},null,-1)]),8,Eo),r("div",{class:ho({disabled:!e.btn_editar}),onClick:b=>e.btn_editar?to({id:e.id,tipo:`${e.tipo_servico} - ${e.tipo_ato}`,token:e.token,tipo_token:e.tipo_token,rota:e.rota,numero_os:e.numero_os}):null,title:e.btn_editar?"Editar":"Desabilitado"},[r("img",{style:xo({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:po,alt:"Editar"},null,4)],10,Ro),r("div",{disabled:!e.btn_cancelar,onClick:b=>e.btn_cancelar?F(e.token):null,title:"Excluir"},o[22]||(o[22]=[r("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:Oo,alt:"Cancelar",title:"Cancelar"},null,-1)]),8,Mo),r("div",{onClick:b=>eo(e),title:"Excluir"},[e.excluido?(g(),S("img",qo)):(g(),S("img",zo))],8,Io)])]),_:1},8,["items"])]),l(x)?(g(),Vo(m,{key:0,show:l(x),servicos:a.dadosData.servicos||[],tiposAtos:a.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=e=>x.value=!1),onUpdateAto:a.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):bo("",!0),s(p,{show:l(A),ato_token:l(I),onClose:o[15]||(o[15]=e=>A.value=!1)},null,8,["show","ato_token"]),s(lo,{show:l(R),numero_os:l(W),ordem:l(Y),onClose:o[16]||(o[16]=e=>R.value=!1),onRefreshValue:o[17]||(o[17]=e=>z())},null,8,["show","numero_os","ordem"]),s(so,{show:l(w),condMessage:l(M),onClose:o[18]||(o[18]=e=>w.value=!1),onConfirm:F},null,8,["show","condMessage"])],64)}}},fa=co(Fo,[["__scopeId","data-v-259bace7"]]);export{fa as default};
