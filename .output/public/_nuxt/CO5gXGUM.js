import{_ as mo}from"./BdXP1ore.js";import{_ as po}from"./CYPMFKQS.js";import{_ as _o,a as co}from"./DSi0lSVa.js";import{_ as vo}from"./CjmZ3X69.js";import{_ as fo}from"./CXapBeC2.js";import{_ as yo}from"./BVz1G1IN.js";import{_ as j}from"./DWCQJ4ee.js";import{_ as ko}from"./BmgN79VX.js";import{_ as Vo,a as bo}from"./DJvq3mCv.js";import{_ as go,u as xo,m as ho,r as i,n as b,p as So,q as $o,s as Ao,v as wo,c as D,b as s,w as n,a as d,x as l,y as Co,z as Oo,F as Do,A as Uo,o as A,B as g,V as m,C as To,D as No}from"./AuXFuD2K.js";import{u as x}from"./C_Nbj1gy.js";import{f}from"./B0IxRygJ.js";import{f as qo}from"./CXgCLoWN.js";import{V as Eo}from"./DJsszn0K.js";import{V as Po}from"./CCe9l21U.js";import{V as U}from"./COTGujLi.js";import{V as u}from"./DOkV8UBr.js";import{V as T}from"./C7ojBwm7.js";import"./bK-KtW6V.js";import"./B1k05cC_.js";import"./dpjQ8kKY.js";import"./Bi_VzR0K.js";import"./C58pRxjJ.js";import"./Cy2xGWVI.js";import"./JEAC_LME.js";import"./DYzWH-zp.js";import"./C0xcawmg.js";const Io={style:{width:"1580px",margin:"0 auto"}},zo={style:{display:"flex",gap:"4px","justify-content":"center"}},Fo=["onClick"],Mo=["onClick"],Ro=["onClick","title"],Lo=["disabled","onClick"],Bo={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:Vo,alt:"Visualizar",title:"Reativar"},Jo={key:1,src:bo,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},jo={__name:"index",setup(Yo){const y=Uo(),{$toast:Y}=xo(),H=`${y.public.managemant}/listarUsuarios`,Q=`${y.public.managemant}/listarOrdensServico`,W=`${y.public.managemant}/tipoAtos`,X=`${y.public.managemant}/updateAtos`,N=`${y.public.managemant}/pesquisaAtos`,q=ho(),h=i(b("auth_token").value)||null,S=i(b("user-data").value.cartorio_token)||null,w=i(!1),E=i([]),c=i([]),P=i([]),I=i([]),Z=i(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),z=i(!1),F=i(!1),M=i(null),G=i(null),R=i(null),K=i({}),C=i(!1),L=i(null),a=So({numero:null,data_inicio:$(),data_fim:$(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,livro:null,folha:null,situacao:null,usuario_token:h.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),oo=[{title:"ID",value:"id"},{title:"Data Abertura",value:"dt_abertura"},{title:"Data lavratura",value:"dt_lavratura"},{title:"N° OS",value:"numero_os"},{title:"Protocolo",value:"protocolo"},{title:"Apresentante",value:"apresentante_nome"},{title:"CPF",value:"apresentante_cpf"},{title:"Tipo Serviço",value:"ato_servico"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function $(){const t=new Date,o=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0");return`${String(t.getDate()).padStart(2,"0")}-${r}-${o}`}function _(t){if(!t)return null;const[o,r,p]=t.split("/");return`${p}-${r}-${o}`}async function B(){const t=$(),o=sessionStorage.getItem("pesquisaOS"),r=JSON.parse(o),{data:p}=await x(N,{method:"POST",body:{cartorio_token:b("user-data").value.cartorio_token,usuario_token:h.value,data_fim:_(r==null?void 0:r.data_fim)||t,data_inicio:_(r==null?void 0:r.data_inicio)||t}},"$1U9Iv6Es1X");p.value.length>0&&(c.value=p.value.map(v=>({...v,dt_lavratura:f(v.dt_lavratura,"dd/mm/yyyy"),dt_abertura:f(v.dt_abertura,"dd/mm/yyyy")})))}async function to(){const{data:t}=await x(H,{method:"POST",body:{cartorio_token:S.value}},"$hvipqUJYtS");P.value=t.value}async function eo(){try{sessionStorage.setItem("pesquisaOS",JSON.stringify(a));const{data:t,error:o}=await x(N,{method:"POST",body:{cartorio_token:S.value,numero:a.numero||null,data_inicio:_(a.data_inicio)||null,data_fim:_(a.data_fim)||null,data_lavratura_inicio:_(a.data_lavratura_inicio)||null,data_lavratura_fim:_(a.data_lavratura_fim)||null,protocolo:a.protocolo||null,livro:a.livro||null,folha:a.folha||null,situacao:a.situacao||null,usuario_token:a.usuario_token,selo:a.selo||null,ato_tipo_token:a.ato_tipo_token,apresentante:a.apresentante_nome||null}},"$OjamgBH6nj");c.value.length>0?c.value=c.value.map(r=>({...r,dt_lavratura:r.data?f(r.dt_lavratura,"dd/mm/yyyy"):null,dt_abertura:r.dt_abertura?f(r.dt_abertura,"dd/mm/yyyy"):null})):(c.value=[],Y.error("Não existe ato Registrado!"))}catch(t){console.error("Erro na requisição",t)}}const ao=t=>{q.push({path:`/fontes/atos/atos-com-bem/atualizar/${t.id}`,query:{origem:"vizualizar-lista",id:t.id,ato_id:t.id,tipo_ato_token:t.tipo_token,tipo_ato:t.ato_servico,ato_token_edit:t.token,numero_os:t.numero_os,usa_imoveis:!0}})};async function lo(){const{data:t,error:o}=await x(W,{method:"POST",body:{cartorio_token:S.value,usuario_token:h.value}},"$QxIfw0Zxe4");I.value=t.value}const so=t=>{L.value=t,C.value=!0},J=async()=>{try{const t=$(),o=sessionStorage.getItem("pesquisaOS"),r=JSON.parse(o),{data:p,error:v}=await x(Q,{method:"POST",body:{cartorio_token:S.value,usuario_token:r.usuario_token||h.value,data_fim:_(r==null?void 0:r.data_fim)||t,data_inicio:_(r==null?void 0:r.data_inicio)||t}},"$ceiptlfDNO");p.value.length>0?E.value=p.value.map(k=>({...k,dt_lavratura:f(k.dt_lavratura,"dd/mm/yyyy"),dt_abertura:f(k.dt_abertura,"dd/mm/yyyy")})):E.value=[]}catch(t){console.error("Erro ao buscar serviços",t)}};async function ro(t){t.excluido=!t.excluido;try{await qo(`${X}/${t.id}`,{method:"PUT",body:{excluido:t.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}const no=t=>{(t.usa_imoveis||!t.usa_imoveis)&&q.push({path:`/fontes/atos/atos-com-bem/atualizar/${t.id}`,query:{origem:"atualizar-lista",id:t.id,ato_id:t.id,tipo_ato_token:t.tipo_token,tipo_ato:t.tipo,ato_token_edit:t.token,numero_os:t.numero_os,usa_imoveis:!0}})},io=()=>{const t=b("user-service"),o=b("ordem-button");t.value=null,M.value=!0,o.value=M.value};return $o(()=>{Ao(async()=>{const t=sessionStorage.getItem("pesquisaOS");if(t){const o=JSON.parse(t);Object.assign(a,o)}await J(),await B()})}),to(),lo(),B(),(t,o)=>{const r=mo,p=po,v=_o,k=vo,uo=fo,V=wo("mask");return A(),D(Do,null,[s(Eo,{class:"mt-5"},{default:n(()=>[s(U,{class:"mb-5"},{default:n(()=>[o[19]||(o[19]=d("h1",null,"Atos",-1)),s(r,{to:"/os/criar-registro"},{default:n(()=>[d("img",{style:{width:"60px",height:"60px",cursor:"pointer","margin-left":"70px"},src:yo,alt:"novo",onClick:io})]),_:1})]),_:1}),s(U,null,{default:n(()=>[s(u,{cols:"2"},{default:n(()=>[g(s(m,{modelValue:l(a).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=e=>l(a).data_inicio=e),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[V,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:n(()=>[g(s(m,{modelValue:l(a).data_fim,"onUpdate:modelValue":o[1]||(o[1]=e=>l(a).data_fim=e),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[V,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:n(()=>[g(s(m,{modelValue:l(a).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=e=>l(a).data_lavratura_inicio=e),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[V,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:n(()=>[g(s(m,{modelValue:l(a).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=e=>l(a).data_lavratura_fim=e),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[V,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:n(()=>[g(s(m,{modelValue:l(a).apresentante_cpf,"onUpdate:modelValue":o[4]||(o[4]=e=>l(a).apresentante_cpf=e),label:"CPF",dense:""},null,8,["modelValue"]),[[V,"###.###.###-##"]])]),_:1}),s(u,{cols:"2"},{default:n(()=>[s(m,{modelValue:l(a).selo,"onUpdate:modelValue":o[5]||(o[5]=e=>l(a).selo=e),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),s(U,null,{default:n(()=>[s(u,{cols:"2"},{default:n(()=>[s(m,{modelValue:l(a).numero,"onUpdate:modelValue":o[6]||(o[6]=e=>l(a).numero=e),label:"N° OS"},null,8,["modelValue"])]),_:1}),s(u,{cols:"2"},{default:n(()=>[s(m,{modelValue:l(a).protocolo,"onUpdate:modelValue":o[7]||(o[7]=e=>l(a).protocolo=e),label:"Protocolo"},null,8,["modelValue"])]),_:1}),s(u,{cols:"3"},{default:n(()=>[s(m,{modelValue:l(a).apresentante,"onUpdate:modelValue":o[8]||(o[8]=e=>l(a).apresentante=e),label:"Apresentante",dense:""},null,8,["modelValue"])]),_:1}),s(u,{cols:"3"},{default:n(()=>[s(T,{modelValue:l(a).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=e=>l(a).ato_tipo_token=e),items:l(I),"item-title":"descricao","item-value":"token",label:"Tipo Serviço",dense:""},null,8,["modelValue","items"])]),_:1}),s(u,{cols:"2"},{default:n(()=>[s(T,{items:l(P),modelValue:l(a).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=e=>l(a).usuario_token=e),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),s(u,{cols:"3"},{default:n(()=>[s(T,{modelValue:l(a).situacao,"onUpdate:modelValue":o[11]||(o[11]=e=>l(a).situacao=e),items:l(Z),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),s(u,{cols:"1"},{default:n(()=>[s(m,{modelValue:l(a).livro,"onUpdate:modelValue":o[12]||(o[12]=e=>l(a).livro=e),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),s(u,{cols:"1"},{default:n(()=>[s(m,{modelValue:l(a).folha,"onUpdate:modelValue":o[13]||(o[13]=e=>l(a).folha=e),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),s(u,null,{default:n(()=>[d("div",null,[d("img",{onClick:eo,style:{width:"40px",height:"40px",cursor:"pointer"},src:j,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),d("div",Io,[o[22]||(o[22]=d("hr",{class:"mt-5 mb-5"},null,-1)),s(Po,{headers:oo,items:l(c),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":n(({item:e})=>[d("div",zo,[d("div",{onClick:O=>ao(e),title:"Visualizar"},o[20]||(o[20]=[d("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:j,alt:"Visualizar"},null,-1)]),8,Fo),d("div",{onClick:O=>so(e.token),title:"Reimprimir"},o[21]||(o[21]=[d("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:co,alt:"Reimprimir"},null,-1)]),8,Mo),d("div",{class:To({disabled:!e.btn_editar}),onClick:O=>e.btn_editar?no({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,usa_imoveis:e.usa_imoveis}):null,title:e.btn_editar?"Editar":"Desabilitado"},[d("img",{style:No({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ko,alt:"Editar"},null,4)],10,Ro),d("div",{disabled:!e.btn_cancelar,onClick:O=>e.btn_cancelar?ro(e):null,title:"Excluir"},[e.excluido?(A(),D("img",Bo)):(A(),D("img",Jo))],8,Lo)])]),_:1},8,["items"])]),l(w)?(A(),Co(p,{key:0,show:l(w),servicos:t.dadosData.servicos||[],tiposAtos:t.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=e=>w.value=!1),onUpdateAto:t.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):Oo("",!0),s(v,{show:l(C),ato_token:l(L),onClose:o[15]||(o[15]=e=>C.value=!1)},null,8,["show","ato_token"]),s(k,{show:l(z),numero_os:l(R),ordem:l(K),onClose:o[16]||(o[16]=e=>z.value=!1),onRefreshValue:o[17]||(o[17]=e=>J())},null,8,["show","numero_os","ordem"]),s(uo,{show:l(F),numero_os:l(R),ordemserv_token:l(G),onClose:o[18]||(o[18]=e=>F.value=!1)},null,8,["show","numero_os","ordemserv_token"])],64)}}},bt=go(jo,[["__scopeId","data-v-195bdf8d"]]);export{bt as default};
