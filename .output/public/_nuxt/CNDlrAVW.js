import{_ as Q}from"./7M-Um4A2.js";import{c as ve,r as _e,u as fe}from"./BxM8NSod.js";import{z as J,D as K,u as Y,r as d,m as D,A as ee,E as Z,o as z,q as W,w as t,b as e,v as o,V as G,H as N,d as U,s as H,a as p,c as L,F as ge,J as De,K as Me,L as ye,I as xe,M as pe,t as se}from"./Caqe_Evm.js";import{u as b}from"./BLqYOKPT.js";import{V as A}from"./ChtuZHyl.js";import{V as M}from"./DOUcgSSU.js";import{V as re}from"./BcXrensE.js";import{V as te}from"./CPmQWUXx.js";import{_ as Re}from"./ZaRICACb.js";import{_ as Ie,a as je,b as Be,T as Ne,W as Ue,r as be,D as he,d as Fe,c as Le,e as We}from"./DsyyM_ZC.js";import{_ as ne}from"./CndiGs6d.js";import{_ as X,a as Ge,b as le,c as ie}from"./BB50QKf3.js";import{V as ue}from"./BRurQWJW.js";import{V as $e,a as ce}from"./DJUpc0ur.js";import{V as Je}from"./CxiUa29x.js";import{_ as Ke}from"./CdP3NN9a.js";const Pt={__name:"Dados",props:{ato_token:{type:String,required:!0}},emits:["saved"],async setup(I,{emit:v}){let _,g;const h=I,T=v,x=J(),w=K(),S=H(),{$toast:f}=Y(),C=`${S.public.managemant}/listarSituacoes`,O=`${S.public.managemant}/createAtos`,j=`${S.public.managemant}/getAtosTiposByToken`,R=d(D("user-data").value.cartorio_token),B=d(D("user-service").value.id).value||d(D("user-service").value).value,q=d([]),i=ee({dt_abertura:null,status:"EM EDIÇÃO",mne:null}),y={status:{required:ve.withMessage("O campo é obrigatorio",_e)}},n=fe(y,i),{data:c}=([_,g]=Z(()=>b(`${j}/${h.ato_token}`,{method:"GET"},"$9ZmTYsLk0K")),_=await _,g(),_);async function a(){if(await n.value.$validate()){const{data:l,error:r,status:F}=await b(O,{method:"POST",body:{ato_tipo_id:c.value.id,cartorio_id:D("user-data").value.cartorio_id,ordemserv_id:B,status:i.status,dt_abertura:i.dt_abertura,mne:i.mne,user_id:D("user-data").value.usuario_id,user_alteracao_id:D("user-data").value.usuario_id}},"$hyq5YcBEjF");F.value==="success"&&(f.success("Ato registrado com sucesso!"),T("saved",{id:l.value.id,token:l.value.token}))}else f.error("Preencha os campos obrigatorios.")}const{data:u}=([_,g]=Z(()=>b(C,{method:"POST",body:{cartorio_token:R.value}},"$S3qwbpImEh")),_=await _,g(),_);q.value=u.value;const V=()=>{const l=w.query.origem||"criar",r=w.query.id;l==="atualizar"?x.push(`/os/atualizar/${r}`):x.push("/os/criar-registro")};return(l,r)=>{const F=Q;return z(),W(te,null,{default:t(()=>[e(A,{class:"mt-5"},{default:t(()=>[e(M,{cols:"3"},{default:t(()=>[e(re,{label:"Situação",modelValue:o(i).status,"onUpdate:modelValue":r[0]||(r[0]=$=>o(i).status=$),items:o(q),"item-title":"descricao","item-value":"descricao",required:"","error-messages":o(n).status.$errors.map($=>$.$message),onBlur:o(n).status.$touch,onInput:o(n).status.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(M,{cols:"5"},{default:t(()=>[e(G,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:o(i).mne,"onUpdate:modelValue":r[1]||(r[1]=$=>o(i).mne=$)},null,8,["modelValue"])]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(M,{cols:"2"},{default:t(()=>[e(G,{modelValue:o(i).dt_abertura,"onUpdate:modelValue":r[2]||(r[2]=$=>o(i).dt_abertura=$),type:"date",label:"Data Lavratura",disabled:"",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(A,{class:"mb-3"},{default:t(()=>[e(F,{onClick:V},{default:t(()=>[e(N,{size:"large",color:"red"},{default:t(()=>r[3]||(r[3]=[U("Voltar")])),_:1})]),_:1}),e(N,{class:"ml-10",onClick:a,size:"large",color:"green"},{default:t(()=>r[4]||(r[4]=[U("Salvar")])),_:1})]),_:1})]),_:1})}}},Ye=["onClick"],He=["onClick"],Ze=["onClick"],Qe={key:0,style:{width:"30px",height:"30px"},src:le,alt:"Visualizar",title:"Reativar"},Xe={key:1,src:ie,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},et=["onClick"],At={__name:"Partes",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},async setup(I){let v,_;const g=I,h=J(),T=K(),x=H(),{$toast:w}=Y(),S=`${x.public.managemant}/pesquisarPessoas`,f=`${x.public.managemant}/listarPapeis`,C=`${x.public.managemant}/getLinkTipo`,O=`${x.public.managemant}/createAtosPessoa`,j=`${x.public.managemant}/getAtosPessoaById`,R=`${x.public.managemant}/updateAtosPessoa`,B=d(D("user-data").value.cartorio_token),q=d([]),i=d([]),y=d([]),n=d(!1),c=d(!1),a=d(!1),u=d(!1),V=d(null),l=d(null),r=d(null),F=d(null);d(null);const $=d(null),de=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],E=ee({papeis:null,nome:null,pessoa:null,documento:null}),{data:ke}=([v,_]=Z(()=>b(f,{method:"POST",body:{tipo_ato_token:g.ato_token}},"$fFKndZhA4W")),v=await v,_(),v);y.value=ke.value;async function we(){try{const{data:m,error:s}=await b(S,{method:"POST",body:{cartorio_token:B.value,documento:E.documento,nome:E.nome}},"$o3ZL1rvYrY");m.value.length>0?(q.value=m.value,E.pessoa=q.value[0]):q.value=[]}catch(m){console.error("Erro na requisição",m)}}const Ve=()=>{c.value=!0},Ce=m=>{i.value=i.value.map(s=>s.id===r.value?{...s,papel:{...s.papel,descricao:m}}:s)},Ee=m=>{const s=i.value.find(P=>P.pessoa.id===F.value);s.representante.nome=m},Pe=async()=>{const m={pessoa:E.pessoa,papel:y.value.find(P=>P.id===E.papeis),representante:{nome:null}},s=await b(`${j}/${g.ato_id}`,{method:"GET"},"$kXSxUa4grs");for(const P of s.data.value)if(P.pessoa_id===E.pessoa.id&&P.ato_id===g.ato_id&&P.tipo_parte_id===E.papeis){w.error("Pessoa Já Registrada Com Esse Papel!");return}try{const{data:P,error:me,status:oe}=await b(O,{method:"POST",body:{ato_id:g.ato_id,pessoa_id:E.pessoa.id,tipo_parte_id:E.papeis,user_id:D("user-data").value.usuario_id}},"$So3qnQu7ek");oe.value==="success"?(m.id=P.value.id,w.success("Pessoa Registrada com Sucesso!"),i.value.push(m)):w.error("Erro ao registrar a pessoa!")}catch{w.error("Erro no servidor. Tente novamente.")}},Ae=async m=>{a.value=!0,$.value=null;const{data:s}=await b(`${C}`,{method:"POST",body:{id:m.pessoa.id,tipo:"ficha"}},"$Q3kbIwtd9t");s.value&&s.value.link?$.value=`data:image/jpeg;base64,${s.value.link}`:$.value=null},Te=m=>{const s=i.value.filter(P=>P.pessoa.id!==m.pessoa.id).map(P=>({id:P.pessoa.id,nome:P.pessoa.nome}));r.value=m.id,V.value=s,n.value=!0,l.value=m.pessoa.nome,F.value=m.pessoa.id},Se=m=>{r.value=m.id,u.value=!0,l.value=m.pessoa.nome};async function qe(m){m.excluido=!m.excluido;try{await b(`${R}/${r.value}`,{method:"PUT",body:JSON.stringify({excluido:m.excluido})},"$9xStKwGd7o")}catch(s){console.error("Erro ao excluir pessoa:",s)}}const ze=()=>{const m=T.query.origem||"criar",s=T.query.id;m==="atualizar"?h.push(`/os/atualizar/${s}`):h.push("/os/criar-registro")};return(m,s)=>{const P=Re,me=je,oe=Be,Oe=Q;return z(),W(te,null,{default:t(()=>[e(A,{class:"mt-5"},{default:t(()=>[e(M,{cols:"3"},{default:t(()=>[e(G,{label:"Documento",modelValue:o(E).documento,"onUpdate:modelValue":s[0]||(s[0]=k=>o(E).documento=k)},null,8,["modelValue"])]),_:1}),e(M,{cols:"4"},{default:t(()=>[e(G,{label:"Pessoa",modelValue:o(E).nome,"onUpdate:modelValue":s[1]||(s[1]=k=>o(E).nome=k)},null,8,["modelValue"])]),_:1}),p("div",null,[p("img",{class:"mt-3",src:ne,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:we})]),p("div",null,[p("img",{class:"mt-3 ml-2",src:X,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Ve})])]),_:1}),e(A,null,{default:t(()=>[e(M,{cols:"4"},{default:t(()=>[e(re,{label:"Selecione a Pessoa",modelValue:o(E).pessoa,"onUpdate:modelValue":s[2]||(s[2]=k=>o(E).pessoa=k),items:o(q),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(M,{cols:"3"},{default:t(()=>[e(re,{label:"Papel",modelValue:o(E).papeis,"onUpdate:modelValue":s[3]||(s[3]=k=>o(E).papeis=k),items:o(y),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),p("div",null,[p("img",{class:"mt-3",src:X,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Pe})])]),_:1}),e(A,null,{default:t(()=>[e(M,null,{default:t(()=>[e(ue,{style:{height:"465px"},headers:de,items:o(i)},{"item.actions":t(({item:k})=>[e(A,null,{default:t(()=>[p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ae=>Ae(k),title:"Visualizar Ficha"},s[9]||(s[9]=[p("img",{style:{width:"30px",height:"30px"},src:ne,alt:"Visualizar"},null,-1)]),8,Ye),p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ae=>Se(k),class:"mr-2",title:"Alterar Papel"},s[10]||(s[10]=[p("img",{style:{width:"30px",height:"30px"},src:Ge,alt:"Visualizar"},null,-1)]),8,He),p("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ae=>qe(k),title:"Deletar Pessoa"},[k.excluido?(z(),L("img",Qe)):(z(),L("img",Xe))],8,Ze),p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ae=>Te(k),title:"Selecionar Representante"},s[11]||(s[11]=[p("img",{style:{width:"30px",height:"30px"},src:Ie,alt:"Visualizar"},null,-1)]),8,et)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(P,{show:o(c),onClose:s[4]||(s[4]=k=>c.value=!1)},null,8,["show"]),e(me,{representante_nome:o(l),representantes:o(V),ato_id:o(r),show:o(n),onClose:s[5]||(s[5]=k=>n.value=!1),onUpdateRepresentante:Ee},null,8,["representante_nome","representantes","ato_id","show"]),e(oe,{representante_nome:o(l),ato_token:g.ato_token,ato_id:o(r),show:o(u),onClose:s[6]||(s[6]=k=>u.value=!1),onUpdatePapel:Ce},null,8,["representante_nome","ato_token","ato_id","show"]),e($e,{modelValue:o(a),"onUpdate:modelValue":s[8]||(s[8]=k=>ge(a)?a.value=k:null),width:"600"},{default:t(()=>[e(ce,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(Je,{src:o($)},null,8,["src"]),e(N,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:s[7]||(s[7]=k=>a.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(A,null,{default:t(()=>[e(Oe,{onClick:ze},{default:t(()=>[e(N,{size:"large",color:"red"},{default:t(()=>s[12]||(s[12]=[U("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},tt={key:0,class:"loading-overlay"},ot="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Tt={__name:"Minuta",props:{ato_token:{type:String,required:!0}},emits:["page","doc"],setup(I,{emit:v}){const _=I;De("DocumentEditorContainer",[Ne,Ue]);const g=H(),{$toast:h}=Y(),T=J(),x=K(),w=v;be(`${g.public.docEditor}`);const S=`${g.public.managemant}/upload`,f=d(null),C=d(!1),O=async()=>{const c=await f.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),a=new FileReader;a.onload=()=>{const u=a.result;w("doc",u)},a.readAsText(c)},j=async()=>{C.value=!0;try{const c=await f.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),a=new FormData;a.append("file",c,"anexo.docx"),a.append("cartorio_token",D("user-data").value.cartorio_token),a.append("token",_.ato_token),a.append("tipo","ato_minuta");const{data:u,status:V}=await b(S,{method:"POST",body:a},"$071xxdqs20");if(V.value==="success"){h.success("Documento enviado!");const r=f.value.ej2Instances.documentEditor.pageCount;O(),w("page",r)}else h.error("Erro ao enviar documento para o sistema.")}catch(n){h.error("Erro ao salvar documento."),console.error(n)}finally{C.value=!1}},R=async()=>{i(!0);try{await B(),i(!0);const{data:n,status:c}=await b(substituirModelo,{method:"POST",body:{ato_token:_.ato_token}},"$0ktpWliD4l");n.value&&q(n.value)}catch(n){console.error("Erro ao gerar a minuta:",n),h.error("Ocorreu um erro ao gerar a minuta.")}finally{i(!1)}},B=async()=>{try{const{data:n}=await b(baixarDocumento,{method:"POST",body:{bucket:"qvgjz",path:"provider/modeloAto.sfdt"}},"$jXVvQjEE6u"),c=await fetchBlobFromMinIO(n.value);if(c){const a=new FileReader;a.onload=()=>{const u=a.result;f.value.ej2Instances.documentEditor.open(u),w("doc",u)},a.readAsText(c)}}catch(n){console.error("Erro ao carregar o modelo de minuta:",n),h.error("Falha ao carregar o modelo de minuta.")}},q=n=>{const c=f.value.ej2Instances.documentEditor,a=u=>{for(const[V,l]of Object.entries(u))if(/^<<.+>>$/.test(V))try{c.search.findAll(V),c.search.searchResults.length>0&&c.search.searchResults.replaceAll(l)}catch(r){console.error(`Erro ao substituir o marcador ${V}:`,r)}else if(V==="partes"&&Array.isArray(l)&&l.length>0)for(const r of l)typeof r=="object"&&a(r)};a(n)},i=n=>{C.value=n},y=()=>{const n=x.query.origem||"criar",c=x.query.id;n==="atualizar"?T.push(`/os/atualizar/${c}`):T.push("/os/criar-registro")};return(n,c)=>{const a=Q;return z(),L(xe,null,[e(o(he),{height:"900px",ref_key:"documentEditorContainer",ref:f,serviceUrl:ot,enableToolbar:!0,enableWordExport:!0},null,512),o(C)?(z(),L("div",tt,[e(Me,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):ye("",!0),e(A,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e(a,{class:"mr-4"},{default:t(()=>[e(N,{size:"large",onClick:y,color:"red"},{default:t(()=>c[0]||(c[0]=[U("Voltar")])),_:1})]),_:1}),e(N,{size:"large",color:"green",onClick:j,disabled:o(C)},{default:t(()=>c[1]||(c[1]=[U("Salvar")])),_:1},8,["disabled"]),e(N,{class:"ml-4",size:"large",color:"blue",onClick:R},{default:t(()=>c[2]||(c[2]=[U("Gerar Minuta")])),_:1})]),_:1})],64)}}},at={class:"d-flex align-center justify-center"},st=["innerHTML"],St={__name:"Livro",props:{ato_token:{type:String,required:!0},pages:{type:Number,required:!0},document:{type:String,required:!0}},setup(I){const v=I,_=H();be(`${_.public.docEditor}`);const{$toast:g}=Y(),h=J(),T=K(),x=`${_.public.managemant}/lavrarAto`,w=d("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),S=d(!1),f=d(null),C=d(null),O=d(null),j=async()=>{try{const{data:i,status:y}=await b(x,{method:"POST",body:{ato_token:v.ato_token,qtd_paginas:v.pages}},"$ZKnVBNYxp9");y.value==="success"?(f.value=i.value,C.value=i.value[0].selo,g.success("Ato lavrado com sucesso!")):g.error("Falha ao lavrar o ato.")}catch{g.error("Erro ao conectar com o servidor.")}},R=()=>{S.value=!1,j()},B=function(){O.value.ej2Instances.documentEditor.open(v.document)},q=()=>{const i=T.query.origem||"criar",y=T.query.id;i==="atualizar"?h.push(`/os/atualizar/${y}`):h.push("/os/criar-registro")};return(i,y)=>{const n=Le;return z(),L(xe,null,[e(A,null,{default:t(()=>[e(M,null,{default:t(()=>[(z(),W(o(he),{restrictEditing:!0,enableToolbar:!1,created:v.document?B:null,ref_key:"documentEditorContainer",ref:O,height:"850px",width:"850px",key:v.document},null,8,["created"]))]),_:1}),e(M,null,{default:t(()=>[p("div",at,[p("div",null,[p("img",{onClick:y[0]||(y[0]=c=>S.value=!0),class:"ml-15",style:{height:"40px",width:"40px",cursor:"pointer","margin-top":"350px"},src:Fe}),o(f)?(z(),W(ce,{key:0,class:"mr-16"},{default:t(()=>[e(A,{"no-gutters":""},{default:t(()=>[e(M,null,{default:t(()=>[e(pe,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[U(" Livro: "+se(o(f)[0].livro_numero),1)]),_:1})]),_:1}),e(M,null,{default:t(()=>[e(pe,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[U(" Folhas : "+se(o(f)[0].pagina_inicial)+" Á "+se(o(f)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),p("div",{innerHTML:o(C)},null,8,st)]),_:1})):ye("",!0)])])]),_:1})]),_:1}),e(N,{color:"red",size:"large",onClick:q},{default:t(()=>y[2]||(y[2]=[U("Voltar")])),_:1}),e(n,{show:o(S),condMessage:o(w),onClose:y[1]||(y[1]=c=>S.value=!1),onConfirm:R},null,8,["show","condMessage"])],64)}}},rt=["onClick"],nt={key:0,style:{width:"30px",height:"30px"},src:le,alt:"Visualizar",title:"Reativar"},lt={key:1,src:ie,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},qt={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(I){let v,_;const g=I,h=J(),T=K(),x=H(),{$toast:w}=Y(),S=`${x.public.managemant}/listarEscrevente`,f=`${x.public.managemant}/getAtosTiposByToken`,C=`${x.public.managemant}/createAtosObservacao`,O=`${x.public.managemant}/updateAtosObservacao`,j=d(D("user-data").value.cartorio_token),R=d([]),B=d([]),q=[{title:"Data",align:"start",key:"data"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],i=ee({observacao:null}),y={observacao:{required:ve.withMessage("O campo é obrigatorio",_e)}},n=fe(y,i);[v,_]=Z(()=>b(`${f}/${g.ato_token}`,{method:"GET"},"$aJM1TL1buW")),v=await v,_();async function c(){if(await n.value.$validate()){const{data:l,error:r,status:F}=await b(C,{method:"POST",body:{ato_id:g.ato_id,observacao:i.observacao,user_id:D("user-data").value.usuario_id}},"$dMg99jeUNP");F.value==="success"&&(R.value.push({data:Ke(l.value.created,"dd/mm/yyyy hh:mm"),observacao:l.value.observacao,id:l.value.id,escrevente:D("user-data").value.nome}),w.success("Observação registrada com sucesso"))}else w.error("Preencha os campos obrigatorios.")}async function a(l){l.excluido=!l.excluido;try{await b(`${O}/${l.id}`,{method:"PUT",body:JSON.stringify({excluido:l.excluido})},"$B6PdRx8Gp4")}catch(r){console.error("Erro ao excluir observacao:",r)}}const{data:u}=([v,_]=Z(()=>b(S,{method:"POST",body:{cartorio_token:j}},"$xFHPGua26S")),v=await v,_(),v);B.value=u.value[0].func_json_escreventes;const V=()=>{const l=T.query.origem||"criar",r=T.query.id;l==="atualizar"?h.push(`/os/atualizar/${r}`):h.push("/os/criar-registro")};return(l,r)=>{const F=Q;return z(),W(te,null,{default:t(()=>[e(A,{class:"mt-5"},{default:t(()=>[e(G,{label:"Observação",modelValue:o(i).observacao,"onUpdate:modelValue":r[0]||(r[0]=$=>o(i).observacao=$),required:"","error-messages":o(n).observacao.$errors.map($=>$.$message),onBlur:o(n).observacao.$touch,onInput:o(n).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),p("div",null,[p("img",{class:"btn-pointer ml-2",src:X,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:c})])]),_:1}),e(A,null,{default:t(()=>[e(M,null,{default:t(()=>[e(ue,{style:{height:"465px"},headers:q,items:o(R)},{"item.actions":t(({item:$})=>[p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:de=>a($),title:"Deletar Observação"},[$.excluido?(z(),L("img",nt)):(z(),L("img",lt))],8,rt)]),_:1},8,["items"])]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(F,{onClick:V},{default:t(()=>[e(N,{size:"large",color:"red"},{default:t(()=>r[1]||(r[1]=[U("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},it=["onClick"],ut=["onClick"],ct={key:0,style:{width:"30px",height:"30px"},src:le,alt:"Visualizar",title:"Reativar"},dt={key:1,src:ie,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},zt={__name:"Anexos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},setup(I){const v=I,_=H(),{$toast:g}=Y(),h=J(),T=K(),x=`${_.public.biometria}/run-scanner`,w=`${_.public.managemant}/atos_anexos`,S=`${_.public.managemant}/atos_anexos`,f=d(!1),C=d([]),O=ee({descricao:""}),j=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}];async function R(){try{await B(),await q()}catch(a){console.error("Erro ao executar scanner ou listar arquivos:",a)}}async function B(){try{const{data:a}=await b(x,{method:"GET"},"$WazoKp68Tw")}catch(a){g.error("Erro ao acionar o scanner:",a)}}async function q(){try{const{data:a,status:u}=await b("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:v.ato_token,cartorio_token:D("user-data").value.cartorio_token}},"$03Wxiia3aI")}catch(a){console.error("Erro ao enviar o arquivo:",a)}}const i=async()=>{f.value=!0},y=async()=>{const{data:a,error:u,status:V}=await b(w,{method:"POST",body:{ato_id:v.ato_id,descricao:O.descricao,user_id:D("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$D2PdkmlmwW");V.value==="success"&&(g.success("Anexo registrado com sucesso!"),C.value.push(a.value))};async function n(a){a.excluido=!a.excluido;try{await b(`${S}/${a.id}`,{method:"PUT",body:JSON.stringify({excluido:a.excluido})},"$WyW0hasRPI")}catch(u){console.error("Erro ao excluir pessoa:",u)}}const c=()=>{const a=T.query.origem||"criar",u=T.query.id;a==="atualizar"?h.push(`/os/atualizar/${u}`):h.push("/os/criar-registro")};return(a,u)=>{const V=Q;return z(),W(te,null,{default:t(()=>[e(A,null,{default:t(()=>[e(M,{cols:"5"},{default:t(()=>[e(G,{modelValue:o(O).descricao,"onUpdate:modelValue":u[0]||(u[0]=l=>o(O).descricao=l),label:"Descrição"},null,8,["modelValue"])]),_:1}),p("div",{onClick:R,title:"Escanear"},u[3]||(u[3]=[p("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:We,alt:"Escanear"},null,-1)])),p("div",{onClick:y,title:"Criar"},u[4]||(u[4]=[p("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:X,alt:"Criar"},null,-1)]))]),_:1}),e(ue,{headers:j,items:o(C),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:l})=>[e(A,null,{default:t(()=>[p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:r=>i(l),title:"Visualizar Anexo"},u[5]||(u[5]=[p("img",{style:{width:"30px",height:"30px"},src:ne,alt:"Visualizar"},null,-1)]),8,it),p("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:r=>n(l),title:"Deletar Pessoa"},[l.excluido?(z(),L("img",ct)):(z(),L("img",dt))],8,ut)]),_:2},1024)]),_:1},8,["items"]),e($e,{modelValue:o(f),"onUpdate:modelValue":u[2]||(u[2]=l=>ge(f)?f.value=l:null),width:"600"},{default:t(()=>[e(ce,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(N,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:u[1]||(u[1]=l=>f.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(V,{onClick:c},{default:t(()=>[e(N,{size:"large",color:"red"},{default:t(()=>u[6]||(u[6]=[U("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Pt as _,At as a,Tt as b,St as c,qt as d,zt as e};
