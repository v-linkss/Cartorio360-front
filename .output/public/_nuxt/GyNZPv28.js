import{y as q,ac as s,ad as x,f as T,ae as A}from"./DqnRh1oO.js";import{a as F}from"./eJwQp9Js.js";function j(n,r,i){const[e={},u]=typeof r=="string"?[{},r]:[r,i],t=q(()=>s(n)),a=e.key||x([u,typeof t.value=="string"?t.value:"",...R(e)]);if(!a||typeof a!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+a);if(!n)throw new Error("[nuxt] [useFetch] request is missing.");const c=a===u?"$f"+a:a;if(!e.baseURL&&typeof t.value=="string"&&t.value[0]==="/"&&t.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:d,lazy:y,default:b,transform:w,pick:g,watch:h,immediate:v,getCachedData:D,deep:E,dedupe:O,..._}=e,l=T({...A,..._,cache:typeof e.cache=="boolean"?void 0:e.cache}),k={server:d,lazy:y,default:b,transform:w,pick:g,immediate:v,getCachedData:D,deep:E,dedupe:O,watch:h===!1?[]:[l,t,...h||[]]};let o;return F(c,()=>{var m;(m=o==null?void 0:o.abort)==null||m.call(o,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),o=typeof AbortController<"u"?new AbortController:{};const p=s(e.timeout);let f;return p&&(f=setTimeout(()=>o.abort(new DOMException("Request aborted due to timeout.","AbortError")),p),o.signal.onabort=()=>clearTimeout(f)),(e.$fetch||globalThis.$fetch)(t.value,{signal:o.signal,...l}).finally(()=>{clearTimeout(f)})},k)}function R(n){var i;const r=[((i=s(n.method))==null?void 0:i.toUpperCase())||"GET",s(n.baseURL)];for(const e of[n.params||n.query]){const u=s(e);if(!u)continue;const t={};for(const[a,c]of Object.entries(u))t[s(a)]=s(c);r.push(t)}return r}export{j as u};
