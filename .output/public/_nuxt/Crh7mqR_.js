import{V as fe,c as qe}from"./LHNS4Z4N.js";import{V as ue}from"./SaEGSYn3.js";import{a as we,V as ie}from"./DbXmQOS5.js";import{V as ge}from"./_BT7bE8n.js";import{P as be,u as Ve,r as m,m as ae,n as re,G as ne,g as ve,x as Pe,q as o,o as k,c as j,b as e,S as Ie,p as N,w as t,C as E,a as S,t as Ue,A as Z,V as W,d as O,v as $e,z as Oe,B as he,s as de}from"./B2VtM2rW.js";import{_ as ye}from"./BYCAfPd1.js";import{_ as ke}from"./BctZgZx-.js";import{_ as ze}from"./DwC88zOO.js";import{c as R,r as L,u as Ce}from"./D9lSe22M.js";import{u as M}from"./CHCsbJ5v.js";import{V as q}from"./CKJp8KVK.js";import{V as g}from"./BWDM5pjC.js";import{V as Be}from"./BsYHYF8J.js";import{V as J}from"./CtpVxkyR.js";import{V as Ee}from"./C5pXoR1w.js";import{a as Ne}from"./VyiJpgDY.js";import{_ as Ae}from"./BVz1G1IN.js";import{_ as Re}from"./rq1FF7Er.js";import{_ as je}from"./CP1ABfly.js";import{_ as De,a as Le}from"./DJvq3mCv.js";import{V as Fe}from"./DRPx7C5b.js";const Ge={key:0,class:"d-flex justify-center"},He={key:0,class:"text-error text-caption mt-1"},Se={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(B,{emit:A}){let n,p;const f=B,P=A,U=be(),u=$e(),{$toast:x}=Ve(),{id:y}=U.params,$=`${u.public.managemant}/atos_bens`,h=`${u.public.managemant}/atos_bens`,T=`${u.public.managemant}/atos_bens`,V=`${u.public.managemant}/registro_imoveis`,F=`${u.public.managemant}/natureza_imoveis`,G=`${u.public.managemant}/tipo_logradouros`,w=`${u.public.managemant}/situacao_imoveis`,b=`${u.public.managemant}/listarCidades`,z=`${u.public.managemant}/listarTipoBens`,I=m(ae("user-data").value.cartorio_token),H=m(ae("user-data").value.usuario_id).value,X=m([]),K=m([]),me=m([]),ee=m([]),te=m([]),C=m([]),Y=m(!0),i=re({tabvalores_tipo_regimovel_id:null,registro_cartorio:null,registro_matricula:null,matricula_letra:null,tabvalores_nat_imovel_id:null,cib:null,sem_recebimento:!1,tabvalores_tipologradouro_id:null,tipo_id:null,descricao:null,inscricao_estadual:null,tabvalores_situacao_imoveis_id:null,vlr_avaliacao:null,vlr_mercado:null,valor_mercado:"0.00",aliq_itbi:null,vlr_itbi:null,vlr_pago_dinheiro:null,user_id:H,ato_id:Number(U.query.ato_id)||Number(f.ato_id)}),le=re({...i}),Q={descricao:{required:R.withMessage("O campo é obrigatório",L)},tipo_id:{required:R.withMessage("O campo é obrigatório",L)},registro_matricula:{required:R.withMessage("O campo é obrigatório",L)},inscricao_estadual:{required:R.withMessage("O campo é obrigatório",L)},vlr_avaliacao:{required:R.withMessage("O campo é obrigatório",L),notZero:R.withMessage("O valor não pode ser zero",c=>!!c&&Number(c.toString().replace(/,/g,""))>0)}},d=Ce(Q,i),se=async()=>{var s,r,oe,xe;if(!await d.value.$validate()){x.error("Preencha todos os campos obrigatórios!");return}if(Number((i.vlr_pago_dinheiro||"0").toString().replace(/,/g,""))===0&&!i.sem_recebimento){x.error("É obrigatório marcar a declaração quando não houver recebimento em espécie.");return}const _={...i,vlr_avaliacao:(s=i.vlr_avaliacao)==null?void 0:s.replace(/,/g,""),vlr_mercado:(r=i.vlr_mercado)==null?void 0:r.replace(/,/g,""),aliq_itbi:(oe=i.aliq_itbi)==null?void 0:oe.replace(/,/g,""),vlr_itbi:(xe=i.vlr_itbi)==null?void 0:xe.replace(/,/g,"")},{data:l,status:v}=await M(`${$}`,{method:"POST",body:_},"$0Mdv6RF9cH");v.value==="success"&&(x.success("Imovel criado com sucesso!"),P("saved",{id:l.value.id,token:l.value.token,ato_id:l.value.ato_id}))},{data:ce}=([n,p]=ne(()=>M(`${z}`,{method:"POST",body:{cartorio_token:I.value,imoveis:!0}},"$H1S2cTYpdB")),n=await n,p(),n);if(C.value=ce.value,f.isUpdate===!0){const{data:c}=([n,p]=ne(()=>M(`${h}/${f.imovel_id}`,{method:"GET"},"$jHrIlABk8l")),n=await n,p(),n);c.value&&Object.keys(i).forEach(a=>{c.value[a]!==void 0&&(i[a]=c.value[a])}),Object.assign(le,i)}async function D(){try{const[c,a,_,l,v]=await Promise.all([$fetch(F),$fetch(V),$fetch(w),$fetch(G),$fetch(b)]);K.value=c,X.value=a,te.value=_,me.value=l,ee.value=v}catch(c){console.error("Erro ao carregar os dados de imoveis pessoa:",c)}finally{Y.value=!1}}const pe=async c=>{const a={};if(Object.keys(i).forEach(v=>{i[v]!==le[v]&&(a[v]=i[v])}),Number((i.vlr_pago_dinheiro||"0").toString().replace(/,/g,""))===0&&!i.sem_recebimento){x.error("É obrigatório marcar a declaração quando não houver recebimento em espécie.");return}if(["vlr_avaliacao","vlr_mercado","aliq_itbi","vlr_itbi","vlr_pago_dinheiro"].forEach(v=>{var s;a[v]&&(a[v]=(s=a[v])==null?void 0:s.toString().replace(/,/g,""))}),Object.keys(a).length===0)return;const{status:l}=await M(`${T}/${c}`,{method:"PUT",body:a},"$BZjXR26AL9");l.value==="success"&&(x.success("Imovel Atualizado com sucesso!"),P("close-modal"))},_e=()=>{P("close-modal"),P("refresh-list")};return ve([()=>i.vlr_avaliacao?i.vlr_avaliacao.replace(/,/g,""):"0",()=>i.aliq_itbi?i.aliq_itbi.replace(/,/g,""):"0"],([c,a])=>{i.vlr_itbi=(Number(c)*Number(a)/100).toFixed(2)}),Pe(()=>{y||f.ato_id?D():Y.value=!1}),(c,a)=>{const _=ye,l=ke,v=ze;return o(Y)?(k(),j("div",Ge,[e(Ie,{indeterminate:"",class:"loading-spinner",size:"64"})])):(k(),N(ue,{key:1},{default:t(()=>[e(q,null,{default:t(()=>[e(g,{class:"mt-2",cols:"12"},{default:t(()=>[e(Be,{label:"Descrição",modelValue:o(i).descricao,"onUpdate:modelValue":a[0]||(a[0]=s=>o(i).descricao=s),"error-messages":o(d).descricao.$errors.map(s=>s.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(g,{cols:"3"},{default:t(()=>[e(J,{label:"Tipo de Registro",modelValue:o(i).tabvalores_tipo_regimovel_id,"onUpdate:modelValue":a[1]||(a[1]=s=>o(i).tabvalores_tipo_regimovel_id=s),items:o(X),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"2"},{default:t(()=>[e(E,{label:"Cartório",modelValue:o(i).registro_cartorio,"onUpdate:modelValue":a[2]||(a[2]=s=>o(i).registro_cartorio=s)},null,8,["modelValue"])]),_:1}),e(g,{cols:"2"},{default:t(()=>[e(E,{label:"Matricula",modelValue:o(i).registro_matricula,"onUpdate:modelValue":a[3]||(a[3]=s=>o(i).registro_matricula=s),"error-messages":o(d).registro_matricula.$errors.map(s=>s.$message)},null,8,["modelValue","error-messages"])]),_:1}),e(g,null,{default:t(()=>[e(E,{label:"Letra",modelValue:o(i).matricula_letra,"onUpdate:modelValue":a[4]||(a[4]=s=>o(i).matricula_letra=s)},null,8,["modelValue"])]),_:1}),e(g,{cols:"4"},{default:t(()=>[e(J,{label:"Natureza",modelValue:o(i).tabvalores_nat_imovel_id,"onUpdate:modelValue":a[5]||(a[5]=s=>o(i).tabvalores_nat_imovel_id=s),items:o(K),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(g,{cols:"2"},{default:t(()=>[e(E,{label:"CIB",modelValue:o(i).cib,"onUpdate:modelValue":a[6]||(a[6]=s=>o(i).cib=s)},null,8,["modelValue"])]),_:1}),e(g,{cols:"3"},{default:t(()=>[e(J,{modelValue:o(i).tipo_id,"onUpdate:modelValue":a[7]||(a[7]=s=>o(i).tipo_id=s),items:o(C),label:"Tipo de imovel","item-title":"descricao","item-value":"id","error-messages":o(d).tipo_id.$errors.map(s=>s.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(g,{cols:"3"},{default:t(()=>[e(E,{label:"Inscrição Municipal",modelValue:o(i).inscricao_estadual,"onUpdate:modelValue":a[8]||(a[8]=s=>o(i).inscricao_estadual=s),"error-messages":o(d).inscricao_estadual.$errors.map(s=>s.$message)},null,8,["modelValue","error-messages"])]),_:1}),e(g,{cols:"4"},{default:t(()=>[e(J,{label:"Situação",items:o(te),"item-title":"descricao","item-value":"id",modelValue:o(i).tabvalores_situacao_imoveis_id,"onUpdate:modelValue":a[9]||(a[9]=s=>o(i).tabvalores_situacao_imoveis_id=s)},null,8,["items","modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(g,{cols:"2"},{default:t(()=>{var s;return[a[17]||(a[17]=S("label",null,"Valor Avaliação",-1)),e(_,{label:"Valor Avaliação",modelValue:o(i).vlr_avaliacao,"onUpdate:modelValue":a[10]||(a[10]=r=>o(i).vlr_avaliacao=r)},null,8,["modelValue"]),o(d).vlr_avaliacao.$error?(k(),j("div",He,Ue((s=o(d).vlr_avaliacao.$errors[0])==null?void 0:s.$message),1)):Z("",!0)]}),_:1}),e(g,{cols:"2"},{default:t(()=>[a[18]||(a[18]=S("label",null,"Valor Mercado",-1)),e(_,{label:"Valor Mercado",modelValue:o(i).vlr_mercado,"onUpdate:modelValue":a[11]||(a[11]=s=>o(i).vlr_mercado=s)},null,8,["modelValue"])]),_:1}),e(g,{cols:"1"},{default:t(()=>[a[19]||(a[19]=S("label",null,"%ITB",-1)),e(_,{label:"%ITB",modelValue:o(i).aliq_itbi,"onUpdate:modelValue":a[12]||(a[12]=s=>o(i).aliq_itbi=s)},null,8,["modelValue"])]),_:1}),e(g,{cols:"2"},{default:t(()=>[a[20]||(a[20]=S("label",null,"Valor ITB",-1)),e(_,{label:"Valor ITB",modelValue:o(i).vlr_itbi,"onUpdate:modelValue":a[13]||(a[13]=s=>o(i).vlr_itbi=s)},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[a[21]||(a[21]=S("label",null,"Valor Recebido em R$",-1)),e(_,{label:"Valor Recebido em R$",modelValue:o(i).vlr_pago_dinheiro,"onUpdate:modelValue":a[14]||(a[14]=s=>o(i).vlr_pago_dinheiro=s),style:{width:"160px"}},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(Ee,{modelValue:o(i).sem_recebimento,"onUpdate:modelValue":a[15]||(a[15]=s=>o(i).sem_recebimento=s),label:"Não houve recebimento em R$"},null,8,["modelValue"])]),_:1})]),_:1}),e(q,{class:"mt-10"},{default:t(()=>[e(l,{onClick:_e},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>a[22]||(a[22]=[O("Voltar")])),_:1})]),_:1}),B.isUpdate?(k(),N(W,{key:0,class:"ml-5",size:"large",color:"green",onClick:a[16]||(a[16]=s=>pe(f.imovel_id))},{default:t(()=>a[23]||(a[23]=[O("Atualizar")])),_:1})):(k(),N(v,{key:1,class:"ml-5",onSave:se},{default:t(()=>a[24]||(a[24]=[O(" Salvar ")])),_:1}))]),_:1})]),_:1}))}}},Ye={key:0,class:"d-flex justify-center"},Me={__name:"Enderecos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(B,{emit:A}){let n,p;const f=B,P=A,U=be(),u=$e(),{$toast:x}=Ve(),{id:y}=U.params,$=`${u.public.managemant}/atos_bens`,h=`${u.public.managemant}/atos_bens`,T=`${u.public.managemant}/registro_imoveis`,V=`${u.public.managemant}/natureza_imoveis`,F=`${u.public.managemant}/tipo_logradouros`,G=`${u.public.managemant}/situacao_imoveis`,w=`${u.public.auth}/service/gerencia/cep`,b=`${u.public.managemant}/listarCidades`,z=`${u.public.managemant}/listarTipoBens`,I=m(ae("user-data").value.cartorio_token),H=m(ae("user-data").value.usuario_id).value,K=ae("auth_token").value,me=m(!1),ee=m([]),te=m([]),C=m([]),Y=m([]),i=m([]),le=m([]),Q=m(!0),d=re({end_cidade_id:null,end_quadra:null,end_lote:null,tabvalores_tipologradouro_id:null,end_logradouro:null,end_logradouro_numero:null,end_bairro:null,end_cep:null,end_complemento:null,user_id:H,ato_id:Number(U.query.ato_id)||Number(f.ato_id)}),se=re({...d}),ce={end_logradouro_numero:{required:R.withMessage("",L)},end_cep:{required:R.withMessage("O campo é obrigatório",L)},end_bairro:{required:R.withMessage("O campo é obrigatório",L)},end_cidade_id:{required:R.withMessage("O campo é obrigatório",L)},tabvalores_tipologradouro_id:{required:R.withMessage("O campo é obrigatório",L)}},D=Ce(ce,d),{data:pe}=([n,p]=ne(()=>M(`${z}`,{method:"POST",body:{cartorio_token:I.value,imoveis:!0}},"$W62VZQp5Tx")),n=await n,p(),n);if(le.value=pe.value,f.isUpdate===!0){const{data:_}=([n,p]=ne(()=>M(`${$}/${f.imovel_id}`,{method:"GET"},"$uGMUgsxHFk")),n=await n,p(),n);_.value&&Object.keys(d).forEach(l=>{_.value[l]!==void 0&&(d[l]=_.value[l])}),Object.assign(se,d)}async function _e(){try{const[_,l,v,s,r]=await Promise.all([$fetch(V),$fetch(T),$fetch(G),$fetch(F),$fetch(b)]);te.value=_,ee.value=l,i.value=v,C.value=s,Y.value=r}catch(_){console.error("Erro ao carregar os dados de imoveis pessoa:",_)}finally{Q.value=!1}}const c=async _=>{if(me.value=!0,!f.isUpdate&&!await D.value.$validate()){x.error("Preencha todos os campos obrigatórios!");return}const l={};if(Object.keys(d).forEach(s=>{d[s]!==se[s]&&(l[s]=d[s])}),Object.keys(l).length===0)return;const{status:v}=await M(`${h}/${_}`,{method:"PUT",body:l},"$JWP9Pf1MfJ");v.value==="success"&&x.success("Imovel Atualizado com sucesso!")},a=()=>{P("close-modal"),P("refresh-list")};return ve(()=>d.end_cep,async _=>{if(_&&_.length===8)try{const{data:l,error:v}=await M(`${w}/${_}`,{headers:{Authorization:K}},"$b99zbpjYFS");if(v.value){console.error("Erro ao buscar CEP:",v.value),x.error("Erro ao buscar CEP no servidor.");return}if(l.value.logradouro&&l.value.bairro&&l.value.localidade&&l.value.uf){d.end_logradouro=l.value.logradouro,d.end_bairro=l.value.bairro,d.end_complemento=l.value.complemento;let s=`${l.value.localidade}/${l.value.uf}`.toUpperCase();const r=Y.value.find(oe=>oe.descricao===s);r?d.end_cidade_id=r.id:x.error("Cidade não encontrada na lista!")}else x.error("CEP não retornou dados válidos!")}catch(l){console.error("Erro inesperado:",l),x.error("Erro inesperado. Verifique sua conexão.")}}),Pe(()=>{y||f.ato_id||f.imovel_id?_e():Q.value=!1}),(_,l)=>{const v=ke,s=Oe("mask");return o(Q)?(k(),j("div",Ye,[e(Ie,{indeterminate:"",class:"loading-spinner",size:"64"})])):(k(),N(ue,{key:1,style:{height:"500px"},class:"mt-2"},{default:t(()=>[e(q,null,{default:t(()=>[e(g,{cols:"2"},{default:t(()=>[he(e(E,{label:"CEP",modelValue:o(d).end_cep,"onUpdate:modelValue":l[0]||(l[0]=r=>o(d).end_cep=r),modelModifiers:{trim:!0},"error-messages":o(D).end_cep.$errors.map(r=>r.$message)},null,8,["modelValue","error-messages"]),[[s,"########"]])]),_:1}),e(g,{cols:"5"},{default:t(()=>[e(J,{label:"Cidade",modelValue:o(d).end_cidade_id,"onUpdate:modelValue":l[1]||(l[1]=r=>o(d).end_cidade_id=r),items:o(Y),"item-title":"descricao","item-value":"id","error-messages":o(D).end_cidade_id.$errors.map(r=>r.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(g,{cols:"2"},{default:t(()=>[e(E,{label:"Quadra",modelValue:o(d).end_quadra,"onUpdate:modelValue":l[2]||(l[2]=r=>o(d).end_quadra=r)},null,8,["modelValue"])]),_:1}),e(g,{cols:"2"},{default:t(()=>[e(E,{label:"Lote",modelValue:o(d).end_lote,"onUpdate:modelValue":l[3]||(l[3]=r=>o(d).end_lote=r)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(g,{cols:"4"},{default:t(()=>[e(J,{label:"Tipo de Logradouro",modelValue:o(d).tabvalores_tipologradouro_id,"onUpdate:modelValue":l[4]||(l[4]=r=>o(d).tabvalores_tipologradouro_id=r),items:o(C),"item-title":"descricao","item-value":"id","error-messages":o(D).tabvalores_tipologradouro_id.$errors.map(r=>r.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(g,{cols:"6"},{default:t(()=>[e(E,{label:"Logradouro",modelValue:o(d).end_logradouro,"onUpdate:modelValue":l[5]||(l[5]=r=>o(d).end_logradouro=r)},null,8,["modelValue"])]),_:1}),e(g,{cols:"1"},{default:t(()=>[e(E,{label:"N*",modelValue:o(d).end_logradouro_numero,"onUpdate:modelValue":l[6]||(l[6]=r=>o(d).end_logradouro_numero=r),"error-messages":o(D).end_logradouro_numero.$errors.map(r=>r.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(g,{cols:"6"},{default:t(()=>[e(E,{label:"Bairro",modelValue:o(d).end_bairro,"onUpdate:modelValue":l[7]||(l[7]=r=>o(d).end_bairro=r),"error-messages":o(D).end_bairro.$errors.map(r=>r.$message)},null,8,["modelValue","error-messages"])]),_:1}),e(g,{cols:"5"},{default:t(()=>[e(E,{label:"Complemento",modelValue:o(d).end_complemento,"onUpdate:modelValue":l[8]||(l[8]=r=>o(d).end_complemento=r)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,{class:"mt-10 justify-start"},{default:t(()=>[e(v,{onClick:a},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>l[11]||(l[11]=[O("Voltar")])),_:1})]),_:1}),B.isUpdate?(k(),N(W,{key:0,class:"ml-5",size:"large",color:"green",onClick:l[9]||(l[9]=r=>c(f.imovel_id))},{default:t(()=>l[12]||(l[12]=[O("Atualizar")])),_:1})):(k(),N(W,{key:1,class:"ml-5",size:"large",color:"green",onClick:l[10]||(l[10]=r=>c(f.imovel_id))},{default:t(()=>l[13]||(l[13]=[O("Salvar")])),_:1}))]),_:1})]),_:1}))}}},Qe={class:"ml-4"},Ze={__name:"Partes",props:{show:Boolean,ato_token:String,ato_id:Number,partes_imovel:Object},emits:["close","update-imovel"],setup(B,{emit:A}){const n=B,p=m(n.show),f=be(),P=$e(),{$toast:U}=Ve(),u=`${P.public.managemant}/bens_pessoa`,x=`${P.public.managemant}/listarPapeis`,y=m([]),$=re({percentual:null,tipo_parte_id:null}),h=m({}),T=A;ve(()=>n.show,async w=>{p.value=w,w&&(await F(),$.tipo_parte_id=n.partes_imovel.papel.descricao||null,$.percentual=n.partes_imovel.percentual.replace(/,/g,"")||null,h.value={tipo_parte_id:$.tipo_parte_id,percentual:$.percentual.replace(/,/g,"")})});const V=()=>{$.tipo_parte_id=null,$.percentual=null,p.value=!1,T("close")},F=async()=>{const{data:w}=await M(x,{method:"POST",body:{tipo_ato_token:f.query.tipo_ato_token}},"$IjSu4kwy4b");y.value=w.value},G=async()=>{const w={};Object.keys($).forEach(z=>{let I=$[z];z==="tipo_parte_id"&&I&&(I=I.id),I!==h.value[z]&&(w[z]=I)}),w.percentual&&(w.percentual=w.percentual.toString().replace(/,/g,""));const{status:b}=await M(`${u}/${n.partes_imovel.id}`,{method:"PUT",body:w},"$QkvGl1R6ZY");b.value==="success"&&(U.success("Parte Atualizada com Sucesso!"),T("update-imovel",w),V())};return(w,b)=>{const z=ye;return k(),N(ge,{persistent:"",modelValue:o(p),"onUpdate:modelValue":b[2]||(b[2]=I=>de(p)?p.value=I:null),"max-width":"800"},{default:t(()=>[e(fe,null,{default:t(()=>[e(ue,null,{default:t(()=>[e(q,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:t(()=>[S("h1",Qe," Altere o papel para: "+Ue(n.partes_imovel.pessoa.nome),1)]),_:1}),b[4]||(b[4]=S("hr",{class:"mb-5"},null,-1)),e(q,null,{default:t(()=>[e(g,{cols:"8"},{default:t(()=>[e(J,{class:"mt-6",label:"Selecione o Papel",modelValue:o($).tipo_parte_id,"onUpdate:modelValue":b[0]||(b[0]=I=>o($).tipo_parte_id=I),items:o(y),"item-title":"descricao","item-value":"descricao","return-object":""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"2"},{default:t(()=>[b[3]||(b[3]=S("label",null,"%",-1)),e(z,{modelValue:o($).percentual,"onUpdate:modelValue":b[1]||(b[1]=I=>o($).percentual=I)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(qe,null,{default:t(()=>[e(W,{style:{"background-color":"red",color:"white"},onClick:V},{default:t(()=>b[5]||(b[5]=[O("Voltar")])),_:1}),e(W,{style:{"background-color":"green",color:"white"},onClick:G},{default:t(()=>b[6]||(b[6]=[O("Salvar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Je=["onClick"],We=["onClick"],Xe=["onClick"],Ke={key:0,style:{width:"30px",height:"30px"},src:De,alt:"Visualizar",title:"Reativar"},eo={key:1,src:Le,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Te={__name:"Partes",props:{ato_token:{type:String},ato_token_selected:{type:String},ato_id:{type:Number},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(B,{emit:A}){let n,p;const f=B,P=A,U=be(),u=$e(),{$toast:x}=Ve(),y=`${u.public.managemant}/partes_atos`,$=`${u.public.managemant}/listarPapeis`,h=`${u.public.managemant}/getLinkTipo`,T=`${u.public.managemant}/bens_pessoa`,V=`${u.public.managemant}/bens_pessoa`,F=`${u.public.managemant}/bens_pessoa`,G=`${u.public.managemant}/download`,w=m(null),b=m([]),z=m([]),I=m([]),H=m(!1),X=m(!1),K=m(null),me=m(U.query.tipo_ato_token),ee=m(null),te=[{title:"Pessoa",align:"start",key:"pessoa.nome",width:"50%"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"%",align:"start",key:"percentual"},{value:"actions"}],C=re({papeis:null,percentual:null}),{data:Y}=([n,p]=ne(()=>M($,{method:"POST"},"$X6FDd5A6WK")),n=await n,p(),n);I.value=Y.value;const i=async()=>{const{data:c}=await M(`${V}/${f.imovel_id}`,{method:"GET"},"$Dyv7lSgcqT"),_=(l=>l.map(v=>({...v,pessoa:{...v.pessoa,documento:v.pessoa.doc_identificacao},papel:{...v.partes_tipos}})))(c.value);z.value=_};i();const le=async()=>{await i()},{data:Q,status:d}=([n,p]=ne(()=>M(y,{method:"POST",body:{ato_token:f.ato_token||U.query.ato_token_edit}},"$Ir36YwSBFY")),n=await n,p(),n);b.value=Q.value&&Object.keys(Q.value).length===0?[]:Q.value;const se=async()=>{const c={pessoa:{nome:C.pessoa.pessoa_nome},papel:I.value.find(l=>l.id===C.papeis),percentual:C.percentual},{data:a,status:_}=await M(T,{method:"POST",body:{bem_id:f.imovel_id,ato_id:Number(U.query.ato_id),pessoa_id:C.pessoa.pessoa_id,tipo_parte_id:C.papeis,user_id:ae("user-data").value.usuario_id,percentual:C.percentual.replace(/,/g,"")}},"$z4QOGPyvCc");_.value==="success"&&(c.id=a.value.id,x.success("Pessoa Registrada com Sucesso!"),z.value.push(c))},ce=async c=>{var s;if(H.value=!0,ee.value=null,!c.pessoa.id)return;const{data:a}=await M(h,{method:"POST",body:{tipo:"ficha",id:c.pessoa.id}},"$XYnqHmowsR");if(!((s=a.value)!=null&&s.link))return;const{data:_}=await M(G,{method:"POST",body:{bucket:ae("user-data").value.cartorio_token,path:a.value.link}},"$63DgHOk5hC"),l=a.value.link,v=_.value;/\.(tr7|tiff)$/i.test(l)?ee.value=v:fotoRender.value=`data:image/jpeg;base64,${v}`},D=c=>{X.value=!0,w.value=c,K.value=c.id};async function pe(c){c.excluido=!c.excluido;try{await M(`${F}/${c.id}`,{method:"PUT",body:JSON.stringify({excluido:c.excluido})},"$3fKfAn4Pra")}catch(a){console.error("Erro ao excluir pessoa:",a)}}const _e=()=>{P("close-modal"),P("refresh-list")};return(c,a)=>{const _=ye,l=Ze,v=Ne,s=ke;return k(),N(ue,{style:{height:"500px"}},{default:t(()=>[e(q,null,{default:t(()=>[e(g,{class:"mt-6",cols:"4"},{default:t(()=>[e(J,{label:"Selecione a Pessoa",modelValue:o(C).pessoa,"onUpdate:modelValue":a[0]||(a[0]=r=>o(C).pessoa=r),items:o(b),"item-title":"pessoa_nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(g,{class:"mt-6",cols:"3"},{default:t(()=>[e(J,{label:"Papel",modelValue:o(C).papeis,"onUpdate:modelValue":a[1]||(a[1]=r=>o(C).papeis=r),items:o(I),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"1"},{default:t(()=>[a[6]||(a[6]=S("label",null,"%",-1)),e(_,{modelValue:o(C).percentual,"onUpdate:modelValue":a[2]||(a[2]=r=>o(C).percentual=r)},null,8,["modelValue"])]),_:1}),S("div",null,[S("img",{class:"mt-7",src:Ae,style:{width:"40px",cursor:"pointer"},title:"Criar Imovel",onClick:se})])]),_:1}),e(q,null,{default:t(()=>[e(g,null,{default:t(()=>[e(Fe,{style:{height:"350px"},headers:te,items:o(z)},{"item.actions":t(({item:r})=>[e(q,null,{default:t(()=>[S("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:oe=>ce(r),title:"Visualizar Ficha"},a[7]||(a[7]=[S("img",{style:{width:"30px",height:"30px"},src:Re,alt:"Visualizar"},null,-1)]),8,Je),S("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:oe=>D(r),class:"mr-2",title:"Alterar Papel"},a[8]||(a[8]=[S("img",{style:{width:"30px",height:"30px"},src:je,alt:"Visualizar"},null,-1)]),8,We),S("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:oe=>pe(r),title:"Deletar Pessoa"},[r.excluido?(k(),j("img",Ke)):(k(),j("img",eo))],8,Xe)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(l,{partes_imovel:o(w),ato_token:o(me),ato_id:o(K),show:o(X),onClose:a[3]||(a[3]=r=>X.value=!1),onUpdateImovel:le},null,8,["partes_imovel","ato_token","ato_id","show"]),e(ge,{modelValue:o(H),"onUpdate:modelValue":a[5]||(a[5]=r=>de(H)?H.value=r:null),width:"600"},{default:t(()=>[e(fe,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(v,{"tiff-url":o(ee)},null,8,["tiff-url"]),e(W,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:a[4]||(a[4]=r=>H.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(q,{class:"mt-5"},{default:t(()=>[e(s,{onClick:_e},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>a[9]||(a[9]=[O("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},oo={key:0},ao={key:1},to={key:2},So={__name:"Cadastro",props:{show:Boolean,imovel_id:Number,ato_token:String,ato_id:Number,ato_token_selected:String},emits:["close","refresh"],setup(B,{emit:A}){const n=B,p=m("dados"),f=m(n.show),P=m(null),U=m(null),u=m(!1),x=A;ve(()=>n.show,T=>{f.value=T});const y=T=>{u.value=!0,U.value=T.ato_id,P.value=T.id},$=()=>{f.value=!1,u.value=!1,x("close")},h=()=>{x("refresh")};return(T,V)=>{const F=Se,G=Me,w=Te;return k(),N(ge,{persistent:"",modelValue:o(f),"onUpdate:modelValue":V[1]||(V[1]=b=>de(f)?f.value=b:null),"max-width":"1000"},{default:t(()=>[e(fe,{style:{height:"650px"}},{default:t(()=>[e(ue,null,{default:t(()=>[V[5]||(V[5]=S("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Cadastro de imoveis ",-1)),e(we,{modelValue:o(p),"onUpdate:modelValue":V[0]||(V[0]=b=>de(p)?p.value=b:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(ie,{value:"dados"},{default:t(()=>V[2]||(V[2]=[O("Dados")])),_:1}),o(u)?(k(),N(ie,{key:0,value:"enderecos"},{default:t(()=>V[3]||(V[3]=[O("Endereco")])),_:1})):Z("",!0),o(u)?(k(),N(ie,{key:1,value:"partes"},{default:t(()=>V[4]||(V[4]=[O("Partes")])),_:1})):Z("",!0)]),_:1},8,["modelValue"]),o(p)==="dados"?(k(),j("div",oo,[e(F,{onRefreshList:h,ato_id:n.ato_id,onSaved:y,onCloseModal:$},null,8,["ato_id"])])):Z("",!0),o(p)==="enderecos"&&o(u)?(k(),j("div",ao,[e(G,{onRefreshList:h,isUpdate:!1,ato_id:o(U),ato_token:n.ato_token,imovel_id:o(P),onCloseModal:$},null,8,["ato_id","ato_token","imovel_id"])])):Z("",!0),o(p)==="partes"&&o(u)?(k(),j("div",to,[e(w,{onRefreshList:h,imovel_id:o(P),ato_token:n.ato_token,ato_id:n.ato_id,ato_token_selected:n.ato_token_selected,onCloseModal:$},null,8,["imovel_id","ato_token","ato_id","ato_token_selected"])])):Z("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},lo={key:0},so={key:1},io={key:2},Mo={__name:"Atualizar",props:{show:Boolean,imovel_id:Number,ato_token_selected:String},emits:["close","refresh"],setup(B,{emit:A}){const n=B,p=m("dados"),f=m(n.show),P=A;ve(()=>n.show,x=>{f.value=x});const U=()=>{f.value=!1,P("close")},u=()=>{P("refresh")};return(x,y)=>{const $=Se,h=Me,T=Te;return k(),N(ge,{persistent:"",modelValue:o(f),"onUpdate:modelValue":y[1]||(y[1]=V=>de(f)?f.value=V:null),"max-width":"1000"},{default:t(()=>[e(fe,{style:{height:"650px"}},{default:t(()=>[e(ue,null,{default:t(()=>[y[5]||(y[5]=S("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Atualizar imovel ",-1)),e(we,{modelValue:o(p),"onUpdate:modelValue":y[0]||(y[0]=V=>de(p)?p.value=V:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(ie,{value:"dados"},{default:t(()=>y[2]||(y[2]=[O("Dados")])),_:1}),e(ie,{value:"enderecos"},{default:t(()=>y[3]||(y[3]=[O("Endereço")])),_:1}),e(ie,{value:"partes"},{default:t(()=>y[4]||(y[4]=[O("Partes")])),_:1})]),_:1},8,["modelValue"]),o(p)==="dados"?(k(),j("div",lo,[e($,{onRefreshList:u,isUpdate:!0,imovel_id:n.imovel_id,onCloseModal:U},null,8,["imovel_id"])])):Z("",!0),o(p)==="enderecos"?(k(),j("div",so,[e(h,{onRefreshList:u,isUpdate:!0,imovel_id:n.imovel_id,onCloseModal:U},null,8,["imovel_id"])])):Z("",!0),o(p)==="partes"?(k(),j("div",io,[e(T,{imovel_id:n.imovel_id,ato_token_selected:n.ato_token_selected,onCloseModal:U},null,8,["imovel_id","ato_token_selected"])])):Z("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{So as _,Mo as a};
