import{_ as oe}from"./Bnsfmrx1.js";import{a as ae,_ as re}from"./BeczrYij.js";import{_ as se}from"./aVwt5kOl.js";import{_ as ne}from"./BVz1G1IN.js";import{_ as le}from"./B_Gkvw8t.js";import{_ as ie}from"./DE1Jp4UM.js";import{_ as ue}from"./BBy1vgWz.js";import{c as I,r as S,u as pe}from"./D0wU2pAd.js";import{u as de}from"./CU7QEufJ.js";import{u as me,J as ce,C as _e,r as u,e as g,f as fe,s as z,h as ve,j as b,w as l,l as ge,o as h,b as s,a as n,t as ke,i as o,m as Ve,V as w,q as C,p as $e,v as xe,d as ye}from"./lXQ7b3du.js";import{u as O}from"./Dmr4rgiu.js";import{f as be}from"./CxH4kCfv.js";import{V as he}from"./C5RY8UZm.js";import{V as k}from"./DjK0vvIP.js";import{V}from"./D8ZmHRsW.js";import{V as we}from"./aBje7zLP.js";import{V as Ce}from"./kKYPUUuk.js";import"./nZEA19Cz.js";import"./107di9lY.js";import"./r3XG2wD4.js";import"./lS3DYVRv.js";import"./BDFDMeCY.js";import"./F8zxlvSZ.js";import"./CjdHb2zB.js";import"./DqUkBuGe.js";const Oe={style:{color:"red","margin-left":"30px"}},Te=["onClick"],Re=["onClick"],Ae=["onClick","title"],Ue=["onClick"],Ie=["title"],st={__name:"[id]",async setup(Se){let i,c;const{redirectTo:T}=de(),{$toast:R}=me(),B=ce(),{id:d}=B.params,E=_e(),_=ge(),N=`${_.public.managemant}/updateOrdensServico`,P=`${_.public.managemant}/getOrdensServicoById`,q=`${_.public.managemant}/listarAtos`,D=`${_.public.managemant}/updateAtos`,F=u(g("user-data").value.cartorio_id),M=u(g("user-data").value.usuario_id),G=u(g("user-service").value.token).value||null,L=u(g("user-data").value.cartorio_token).value,$=u([]),x=u(!1),A=u(null),m=u(null),r=fe({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),j=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],J=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],K={apresentante_nome:{required:I.withMessage("O campo é obrigatorio",S)},apresentante_cpf:{required:I.withMessage("O campo é obrigatorio",S)}},p=pe(K,r);function W(a){if(a)return a.replace(/[.\-]/g,"");a=null}const X=a=>{A.value=a,x.value=!0},Y=a=>{T({item:a,id:d,numeroOs:m.value,origem:"vizualizar"})},Z=a=>{T({item:a,id:d,numeroOs:m.value,origem:"atualizar"})};async function H(){const a={apresentante_cpf:W(r.apresentante_cpf),apresentante_nome:r.apresentante_nome,user_id:M.value,cartorio_id:F.value},{error:t,status:v}=await O(`${N}/${d}`,{method:"PUT",body:a},"$Fud06ay483");v.value==="error"&&t.value.statusCode===500?R.error("Erro ao cadastrar ordem,erro no sistema."):(R.success("Ordem Atualizada com sucesso!"),E.push({path:"/os/lista"}))}const{data:f}=([i,c]=z(()=>O(`${P}/${d}`,{method:"GET"},"$wPUkUpDvPf")),i=await i,c(),i);m.value=f.value.numero,r.nacionalidade=f.value.estrangeiro,r.apresentante_cpf=f.value.apresentante_cpf,r.apresentante_nome=f.value.apresentante_nome;const{data:U}=([i,c]=z(()=>O(q,{method:"POST",body:{cartorio_token:L,ordemserv_token:G}},"$YXZ55K3IUf")),i=await i,c(),i);async function Q(a){a.excluido=!a.excluido;try{await be(`${D}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(t){console.error("Erro ao excluir pessoa:",t)}}return U.value.length>0?$.value=U.value:$.value=[],(a,t)=>{const v=oe,ee=re,te=ve("mask");return h(),b(he,{class:"mt-5"},{default:l(()=>[s(k,{class:"mb-5"},{default:l(()=>[t[6]||(t[6]=n("h1",null,"Ordem de Serviço nº",-1)),n("h1",Oe,ke(o(m)),1)]),_:1}),s(k,null,{default:l(()=>[s(V,{md:"3"},{default:l(()=>[s(we,{label:"Nacionalidade",items:J,modelValue:o(r).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>o(r).nacionalidade=e)},null,8,["modelValue"])]),_:1}),s(V,{md:"2"},{default:l(()=>[o(r).nacionalidade==="brasileiro"?Ve((h(),b(w,{key:0,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>o(r).apresentante_cpf=e),label:"CPF",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch,onInput:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[te,"###.###.###-##"]]):(h(),b(w,{key:1,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>o(r).apresentante_cpf=e),label:"Documento",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),s(V,{md:"4"},{default:l(()=>[s(w,{modelValue:o(r).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>o(r).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":o(p).apresentante_nome.$errors.map(e=>e.$message),onInput:o(p).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),s(V,null,{default:l(()=>[n("div",null,[n("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:se,alt:"Salvar",onClick:t[4]||(t[4]=e=>H())})])]),_:1})]),_:1}),s(k,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:l(()=>[t[10]||(t[10]=n("h1",{class:"ml-5"},"Atos",-1)),s(v,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:o(d),numeroOs:o(m)}}},{default:l(()=>t[7]||(t[7]=[n("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:ne,alt:"novo"},null,-1)])),_:1},8,["to"]),s(Ce,{headers:j,items:o($),"item-key":"id"},{"item.actions":l(({item:e})=>[s(k,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:l(()=>[n("div",{onClick:y=>Y(e),title:"Visualizar"},t[8]||(t[8]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:le,alt:"Visualizar"},null,-1)]),8,Te),n("div",{onClick:y=>X(e.token),title:"Reimprimir"},t[9]||(t[9]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ae,alt:"Reimprimir"},null,-1)]),8,Re),n("div",{class:$e({disabled:!e.btn_editar}),onClick:y=>e.btn_editar?Z({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,rota:e.rota}):null,title:e.btn_editar?"Editar":"Desabilitado"},[n("img",{style:C({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ie,alt:"Editar"},null,4)],10,Ae),n("div",{onClick:y=>e.btn_cancelar?Q(e):null,title:"Excluir",style:C({cursor:e.btn_cancelar?"pointer":"not-allowed"})},[n("img",{style:C({width:"30px",height:"30px",cursor:e.btn_cancelar?"pointer":"not-allowed",opacity:e.btn_cancelar?"1":"0.5"}),src:ue,alt:"Cancelar",title:e.btn_cancelar?"Cancelar":"Não permitido"},null,12,Ie)],12,Ue)]),_:2},1024)]),_:1},8,["items"]),s(ee,{show:o(x),ato_token:o(A),onClose:t[5]||(t[5]=e=>x.value=!1)},null,8,["show","ato_token"])]),_:1}),s(v,{to:"/os/lista"},{default:l(()=>[s(xe,{size:"large",color:"red"},{default:l(()=>t[11]||(t[11]=[ye("Voltar")])),_:1})]),_:1})]),_:1})}}};export{st as default};
