import{_ as ke}from"./DXyt5CBz.js";import{_ as Ve}from"./CtEw_su1.js";import{_ as ge}from"./DhCXDVLf.js";import{_ as he,r as l,H as ye,o as h,j as J,w as s,b as o,a as u,t as Q,i as t,V as O,A as W,G as we,c as z,k as Y,v as N,d as R,C as be,J as Ce,u as xe,e as x,f as $e,s as qe,F as Pe,l as Me}from"./1sV7CVBy.js";import{V as Te,b as Fe,c as Ae}from"./B2ugnZ62.js";import{V as Ee}from"./BxtcdhEu.js";import{_ as Se}from"./CNyz2KlX.js";import{_ as X}from"./Cf-DPn2m.js";import{_ as Oe}from"./BVz1G1IN.js";import{_ as ze}from"./DAR3HiME.js";import{a as Ne}from"./DJvq3mCv.js";import{u as V}from"./kIL5RAz0.js";import{V as S}from"./5F2OPqJM.js";import{V as g}from"./DZsR0tSz.js";import{V as Re}from"./D2FDyxxU.js";import{V as G}from"./S6UqtFZg.js";import"./CidAOQ82.js";import"./CEgw615s.js";import"./rVKbnn3K.js";import"./KeJy3t0G.js";import"./B0IxRygJ.js";import"./hcUls8M2.js";import"./jl68zULs.js";import"./DECs2SM6.js";import"./2DWstfZE.js";import"./C0nSFqyy.js";import"./gdFJ_F4D.js";import"./CDE-C2Q9.js";import"./C4GYoaZy.js";import"./CGYC6V6S.js";const je={class:"random-numbers"},De={key:0,class:"error-message"},Be={__name:"ValidadorAutencidade",props:{show:Boolean},emits:["close","confirm"],setup(j,{emit:D}){const _=j,y=D,m=l(_.show),k=l([]),d=l(""),p=l("");function v(){k.value=[];for(let f=0;f<4;f++)k.value.push(Math.floor(Math.random()*10))}ye(()=>_.show,f=>{m.value=f,f&&(v(),d.value="",p.value="")});const $=()=>{m.value=!1,y("close")},q=()=>{d.value===k.value.join("")?(p.value="",m.value=!1,y("confirm")):p.value="Números digitados incorretos. Tente novamente."};return(f,i)=>(h(),J(Ee,{persistent:"",modelValue:t(m),"onUpdate:modelValue":i[1]||(i[1]=w=>W(m)?m.value=w:null),"max-width":"500"},{default:s(()=>[o(Te,null,{default:s(()=>[o(Fe,null,{default:s(()=>[u("div",null,[i[2]||(i[2]=u("p",null," Digite o código de validação para confirmar o ato de reconhecimento por autenticidade: ",-1)),u("div",je,[u("span",null,Q(t(k).join(" ")),1)]),o(O,{modelValue:t(d),"onUpdate:modelValue":i[0]||(i[0]=w=>W(d)?d.value=w:null),label:"Digite os números",maxlength:"4",outlined:"",dense:"",onKeyup:we(q,["enter"])},null,8,["modelValue"]),t(p)?(h(),z("div",De,Q(t(p)),1)):Y("",!0)])]),_:1}),o(Ae,null,{default:s(()=>[o(N,{style:{"background-color":"red",color:"white"},onClick:$},{default:s(()=>i[3]||(i[3]=[R("Cancelar")])),_:1}),o(N,{style:{"background-color":"green",color:"white"},onClick:q},{default:s(()=>i[4]||(i[4]=[R("Validar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Ue=he(Be,[["__scopeId","data-v-c978e7cc"]]),Ie=["onClick"],Ke={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:X,alt:"Possui Ficha",title:"Possui Ficha"},Ze={key:1,style:{width:"30px",height:"30px",cursor:"pointer"},src:ze,alt:"Visualizar",title:"Não Possui Ficha"},He=["onClick"],Co={__name:"autencidade",props:{ato_token:{type:String,required:!0}},emits:["ato-created"],async setup(j,{emit:D}){let _,y;const m=j,k=D,d=be(),p=Ce(),v=Me(),{$toast:$}=xe(),q=`${v.public.managemant}/listarEscrevente`,f=`${v.public.managemant}/pesquisarPessoas`,i=`${v.public.managemant}/atoReconhecimento`,w=`${v.public.managemant}/etiquetaAutenticidade`,ee=`${v.public.managemant}/download`,oe=`${v.public.envioDoc}/print`,P=l(x("user-data").value.cartorio_token),te=l(x("user-service").value.token).value||l(x("user-service").value).value,ae=x("auth_token").value,B=l([]),K=l([]),b=l([]),M=l(!1),U=l(!1),T=l(!1),F=l(null),Z=l(null),I=l(""),A=l(!1),H=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],r=$e({quantidade:1,escrevente:null,nome:null,documento:null}),{data:se}=([_,y]=qe(()=>V(q,{method:"POST",body:{cartorio_token:P}},"$qpB20nOlUE")),_=await _,y(),_);K.value=se.value[0].func_json_escreventes;async function ne(){try{const{data:a,error:e}=await V(f,{method:"POST",body:{cartorio_token:P.value,documento:r.documento,nome:r.nome}},"$CfpM9wZnUE");a.value.length>0?(k("ato-created"),B.value=a.value):B.value=[]}catch(a){console.error("Erro na requisição",a)}}const le=()=>{U.value=!0};function re(a){b.value.push(a)}const ie=async a=>{F.value=a,T.value=!0;const{data:e}=await V(ee,{method:"POST",body:{bucket:x("user-data").value.cartorio_token,path:a.link_ficha}},"$LrKAtpxZwH");Z.value=e.value};function ue(a){b.value=b.value.filter(e=>e.token!==a.token)}function ce(){A.value=!0}function me(){A.value=!1,de()}async function de(){if(!r.escrevente){$.error("Por favor selecione um Escrevente");return}try{const a=b.value.map(c=>({pessoa_token:c.token})),{data:e,error:E,status:C}=await V(i,{method:"POST",body:{pessoas:a,cartorio_token:P.value,ordemserv_token:te,quantidade:r.quantidade,usuario_token:ae,ato_tipo_token:m.ato_token}},"$EE94jKo1pQ");C.value==="success"&&e.value[0].status==="OK"?(pe(e.value[0].token),L()):(M.value=!0,I.value=ato_token.value.status_mensagem||E.value.data.details)}catch(a){M.value=!0,I.value=a,console.error("Erro na requisição",a)}}async function pe(a){try{const{data:e,error:E,status:C}=await V(w,{method:"POST",body:{ato_token:a,cartorio_token:P.value,escrevente_token:r.escrevente}},"$KyoIzBxZyr");if(C.value==="success"){if(e.value[0].tipo_etiqueta==="html"){const c=window.open("","_blank");c.document.open(),c.document.write(e.value[0].etiqueta),c.document.close()}else if(e.value[0].tipo_etiqueta==="zpl"){const{status:c}=await V(`${oe}`,{method:"POST",body:{zpl:atob(e.value[0].etiqueta)}},"$Vem9mHWYqw");if(c.value!=="success"){$.error("Não foi possivel fazer a impressao da etiqueta");return}}}}catch(e){console.error("Erro na requisição",e)}}const L=()=>{const a=p.query.origem||"criar",e=p.query.id;a==="atualizar"?d.push(`/os/atualizar/${e}`):d.push("/os/criar-registro")};return(a,e)=>{const E=ke,C=Ve,c=ge,ve=Ue,fe=Se;return h(),z(Pe,null,[o(S,{class:"mt-5"},{default:s(()=>[o(g,{cols:"5"},{default:s(()=>[o(Re,{label:"Tabelião/escrevente",modelValue:t(r).escrevente,"onUpdate:modelValue":e[0]||(e[0]=n=>t(r).escrevente=n),items:t(K),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),o(g,{cols:"2"},{default:s(()=>[o(O,{label:"Quantidade",type:"number",modelValue:t(r).quantidade,"onUpdate:modelValue":e[1]||(e[1]=n=>t(r).quantidade=n)},null,8,["modelValue"])]),_:1})]),_:1}),o(S,null,{default:s(()=>[o(g,{cols:"3"},{default:s(()=>[o(O,{label:"Documento",modelValue:t(r).documento,"onUpdate:modelValue":e[2]||(e[2]=n=>t(r).documento=n)},null,8,["modelValue"])]),_:1}),o(g,{cols:"4"},{default:s(()=>[o(O,{label:"Pessoa",modelValue:t(r).nome,"onUpdate:modelValue":e[3]||(e[3]=n=>t(r).nome=n)},null,8,["modelValue"])]),_:1}),u("div",null,[u("img",{class:"btn-pointer mt-1",src:X,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:ne})]),u("div",null,[u("img",{class:"btn-pointer mt-1 ml-2",src:Oe,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:le})])]),_:1}),o(S,null,{default:s(()=>[o(g,{class:"mr-10"},{default:s(()=>[o(G,{style:{height:"465px"},headers:H,items:t(B)},{"item.actions":s(({item:n})=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:_e=>ie(n),title:"Visualizar Ficha"},[n.link_ficha?(h(),z("img",Ke)):(h(),z("img",Ze))],8,Ie)]),_:1},8,["items"])]),_:1}),o(g,null,{default:s(()=>[o(G,{headers:H,items:t(b),style:{height:"465px"},"item-key":"id"},{"item.actions":s(({item:n})=>[u("div",{style:{display:"flex","justify-content":"flex-end"},onClick:_e=>ue(n),title:"Remover"},e[9]||(e[9]=[u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:Ne,alt:"Remover"},null,-1)]),8,He)]),_:1},8,["items"])]),_:1})]),_:1}),o(E,{show:t(U),onClose:e[4]||(e[4]=n=>U.value=!1)},null,8,["show"]),t(T)?(h(),J(C,{key:0,show:t(T),item:t(F),"pessoa-obj":t(F),"link-view":t(Z),onConfirmar:e[5]||(e[5]=n=>re(t(F))),onClose:e[6]||(e[6]=n=>T.value=!1)},null,8,["show","item","pessoa-obj","link-view"])):Y("",!0),o(c,{show:t(M),errorMessage:t(I),onClose:e[7]||(e[7]=n=>M.value=!1)},null,8,["show","errorMessage"]),o(ve,{show:t(A),onClose:e[8]||(e[8]=n=>A.value=!1),onConfirm:me},null,8,["show"]),o(S,null,{default:s(()=>[o(fe,{onClick:L},{default:s(()=>[o(N,{size:"large",color:"red"},{default:s(()=>e[10]||(e[10]=[R("Voltar")])),_:1})]),_:1}),o(N,{class:"ml-5",onClick:ce,size:"large",color:"green"},{default:s(()=>e[11]||(e[11]=[R("Salvar")])),_:1})]),_:1})],64)}}};export{Co as default};
