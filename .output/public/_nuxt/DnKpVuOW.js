import{_ as N}from"./DSqHEtss.js";import{a as M,b as F,c as L,d as P,V as R}from"./DNb9JB2K.js";import{r as l,h as D,o as w,A as S,w as a,b as t,d as C,c as A,t as U,y as X,q as e,v as j,_ as z,D as g,F as G,G as J,x as K,a as v,s as Q,p as W,e as H}from"./j1uFeTuL.js";import{u as $}from"./DW-1i10V.js";import{_ as Y}from"./ToPptOUL.js";import{c as Z,r as ee,u as te,_ as oe}from"./CDN0-eFS.js";import{V as ae}from"./CHrGFEw2.js";import{V as se}from"./CE29Pb3h.js";import{V as ne}from"./BSuZRSV0.js";const re={key:0},le={key:1},ie={__name:"ErrorModalCard",props:{show:Boolean,errorMessage:String},emits:["close"],setup(n,{emit:i}){const c=n,s=l(c.show),b=i;D(()=>c.show,f=>{s.value=f});const d=()=>{s.value=!1,b("close")};return(f,V)=>(w(),S(R,{modelValue:e(s),"onUpdate:modelValue":V[0]||(V[0]=h=>j(s)?s.value=h:null),"max-width":"500"},{default:a(()=>[t(M,null,{default:a(()=>[t(F,{class:"text-h5"},{default:a(()=>[C("Erro na Requisição")]),_:1}),t(L,null,{default:a(()=>[n.errorMessage?(w(),A("div",re,U(n.errorMessage),1)):(w(),A("div",le,"Ocorreu um erro inesperado."))]),_:1}),t(P,null,{default:a(()=>[t(X,{style:{"background-color":"#429946",color:"white"},onClick:d},{default:a(()=>[C("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ue=n=>(W("data-v-766b063a"),n=n(),H(),n),ce={style:{width:"600px","margin-top":"10px"}},de={style:{width:"180px","margin-top":"20px"}},me=ue(()=>v("img",{class:"btn-pointer mt-10 mb-5",src:Y,alt:"Sair"},null,-1)),_e={__name:"autenticacao",async setup(n){let i,c;const s=K(),b=`${s.public.managemant}/listarEscrevente`,d=l(g("user-data").value.cartorio_token).value,f=l(g("user-service").value.token).value||l(g("user-service").value).value,V=g("auth_token").value,h=`${s.public.managemant}/atoAutentica`,B=`${s.public.managemant}/etiquetaAutentica`,x=l(!1),y=l(""),r=G({escrevente:null,quantidade:1}),q=l([]),{data:I}=([i,c]=J(()=>$(b,{method:"POST",body:{cartorio_token:d}},"$nXL9eJBhI7")),i=await i,c(),i);q.value=I.value[0].func_json_escreventes;const T={escrevente:{required:Z.withMessage("O campo é obrigatorio",ee)}},k=te(T,r),E=async()=>{if(await k.value.$validate()){const{data:m,status:o,error:_}=await $(h,{method:"POST",body:{usuario_token:V,cartorio_token:d,quantidade:Number(r.quantidade),ordemserv_token:f,ato_tipo_token:"bFsdV"}},"$dpfLzAlO85");o.value==="success"?O(m.value.token):(x.value=!0,y.value=_.value.data.details,console.log(m))}},O=async m=>{const{data:o,status:_}=await $(B,{method:"POST",body:{escrevente_token:r.escrevente,cartorio_token:d,ato_token:m}},"$fPnSl9XMLA");if(_.value==="success"){const p=window.open("","_blank");p.document.open(),p.document.write(o.value.etiqueta),p.document.close()}};return(m,o)=>{const _=N,p=ie;return w(),S(M,{class:"mt-10",title:"Autenticação"},{default:a(()=>[t(ne,null,{default:a(()=>[v("div",ce,[t(ae,{label:"Tabelião/escrivão",modelValue:e(r).escrevente,"onUpdate:modelValue":o[0]||(o[0]=u=>e(r).escrevente=u),items:e(q),"item-title":"nome","item-value":"token",required:"","error-messages":e(k).escrevente.$errors.map(u=>u.$message),onBlur:e(k).escrevente.$touch,onInput:e(k).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),v("div",de,[t(Q,{type:"number",label:"Quantidade",modelValue:e(r).quantidade,"onUpdate:modelValue":o[1]||(o[1]=u=>e(r).quantidade=u)},null,8,["modelValue"])]),t(se,null,{default:a(()=>[v("div",null,[t(_,{to:"/ordens-servicos/criar-registro"},{default:a(()=>[me]),_:1})]),v("img",{class:"btn-pointer mt-10",src:oe,onClick:E})]),_:1})]),_:1}),t(p,{show:e(x),errorMessage:e(y),onClose:o[2]||(o[2]=u=>x.value=!1)},null,8,["show","errorMessage"])]),_:1})}}},xe=z(_e,[["__scopeId","data-v-766b063a"]]);export{xe as default};
