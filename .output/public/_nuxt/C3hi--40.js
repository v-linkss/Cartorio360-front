import{_ as q}from"./CAQ71nZ1.js";import{P as O,Q as N,R as E,b as e,S as R,T as G,U as B,W as I,X as F,A as L,Y as j,Z as J,$ as D,F as M,a0 as W,u as Y,e as P,f as z,r as H,m as Q,h as X,w as l,k as Z,o as $,a as u,q as T,s as w,i,c as K,d as x,a1 as ee,t as ae,p as oe}from"./D6lRYQBj.js";import{V as te}from"./d8dejLhV.js";import{V as b}from"./DnTmIxDG.js";import{V as r}from"./CDCdXqNw.js";import{V as A}from"./DoLUSq4B.js";import{m as le,V as U,a as se,b as ne}from"./Dd-ZuqGt.js";const re=O({...le({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),v=N()({name:"VRadio",props:re(),setup(s,y){let{slots:m}=y;return E(()=>e(U,R(s,{class:["v-radio",s.class],style:s.style,type:"radio"}),m)),{}}}),ie=O({height:{type:[Number,String],default:"auto"},...G(),...B(se(),["multiple"]),trueIcon:{type:I,default:"$radioOn"},falseIcon:{type:I,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),de=N()({name:"VRadioGroup",inheritAttrs:!1,props:ie(),emits:{"update:modelValue":s=>!0},setup(s,y){let{attrs:m,slots:p}=y;const h=F(),V=L(()=>s.id||`radio-group-${h}`),o=j(s,"modelValue");return E(()=>{const[_,g]=J(m),C=D.filterProps(s),k=U.filterProps(s),t=p.label?p.label({label:s.label,props:{for:V.value}}):s.label;return e(D,R({class:["v-radio-group",s.class],style:s.style},_,C,{modelValue:o.value,"onUpdate:modelValue":a=>o.value=a,id:V.value}),{...p,default:a=>{let{id:n,messagesId:c,isDisabled:d,isReadonly:S}=a;return e(M,null,[t&&e(W,{id:n.value},{default:()=>[t]}),e(ne,R(k,{id:n.value,"aria-describedby":c.value,defaultsTarget:"VRadio",trueIcon:s.trueIcon,falseIcon:s.falseIcon,type:s.type,disabled:d.value,readonly:S.value,"aria-labelledby":t?n.value:void 0,multiple:!1},g,{modelValue:o.value,"onUpdate:modelValue":f=>o.value=f}),p)])}})}),{}}}),ue={class:"mb-6"},ce={class:"mb-6"},me={class:"mb-4"},fe={key:0,class:"mt-6"},pe={class:"bg-success text-white pa-4 mb-4 rounded"},ve={class:"bg-grey-lighten-4 pa-4 rounded"},ke={__name:"censec",setup(s){const y=Z(),{$toast:m}=Y(),p=`${y.public.auth}/service/gerencia/integra_censec`,V=P("auth_token").value,o=z({data_inicial:g(),data_final:g(),validar:null,file_name:""}),_=H(null);function g(){const t=new Date,a=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0");return`${String(t.getDate()).padStart(2,"0")}-${n}-${a}`}function C(t){if(!t)return null;const[a,n,c]=t.split("/");return`${c}-${n}-${a}`}const k=async()=>{if(!o.validar){m.warning("Selecione um tipo de validação antes de enviar!");return}try{const t=await fetch(`${p}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${V}`},body:JSON.stringify({cartorio_token:P("user-data").value.cartorio_token,data_inicial:C(o.data_inicial),data_final:C(o.data_final),validar:o.validar,file_name:o.file_name})});if(!t.ok)throw new Error(`Erro ao gerar dados (HTTP ${t.status})`);if(o.validar==="ATOS"){const a=await t.text(),n=window.open("","_blank");n?(n.document.open(),n.document.write(a),n.document.close()):m.warning("Não foi possível abrir a nova aba (bloqueador de pop-up?).")}else{if(!o.file_name){m.warning("Digite o nome do arquivo!");return}const a=await t.blob(),n=t.headers.get("Content-Disposition"),c=n&&n.match(/filename="(.+)"/),d=c?c[1]:`${o.file_name}.json`,S=window.URL.createObjectURL(a),f=document.createElement("a");f.href=S,f.download=d,document.body.appendChild(f),f.click(),f.remove(),window.URL.revokeObjectURL(S),m.success("Arquivo baixado com sucesso!")}}catch(t){console.error(t),m.error("Erro ao processar a requisição.")}};return(t,a)=>{const n=q,c=Q("mask");return $(),X(te,{class:"mt-5"},{default:l(()=>[e(b,{class:"mb-10"},{default:l(()=>a[4]||(a[4]=[u("h1",null,"Integração CENSEC",-1)])),_:1}),u("div",null,[u("div",ue,[a[5]||(a[5]=u("h3",{class:"text-h6 mb-2"},"Período de Consulta",-1)),e(b,null,{default:l(()=>[e(r,{cols:"12",md:"2"},{default:l(()=>[T(e(w,{modelValue:i(o).data_inicial,"onUpdate:modelValue":a[0]||(a[0]=d=>i(o).data_inicial=d),label:"Data Inicio",placeholder:"dd/mm/yyyy"},null,8,["modelValue"]),[[c,"##/##/####"]])]),_:1}),e(r,{cols:"12",md:"2"},{default:l(()=>[T(e(w,{modelValue:i(o).data_final,"onUpdate:modelValue":a[1]||(a[1]=d=>i(o).data_final=d),label:"Data Fim",placeholder:"dd/mm/yyyy"},null,8,["modelValue"]),[[c,"##/##/####"]])]),_:1})]),_:1})]),e(A,{class:"my-6"}),u("div",ce,[e(b,null,{default:l(()=>[e(r,{cols:"12",sm:"6",md:"4"}),e(r,{cols:"12",sm:"6",md:"4"},{default:l(()=>a[6]||(a[6]=[u("h3",{class:"text-h6 mb-4"},"Gerar Arquivo",-1)])),_:1})]),_:1}),e(de,{modelValue:i(o).validar,"onUpdate:modelValue":a[2]||(a[2]=d=>i(o).validar=d),class:"mt-2"},{default:l(()=>[e(b,null,{default:l(()=>[e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:l(()=>[e(v,{label:"VALIDAR ATOS",value:"ATOS",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:l(()=>[e(v,{label:"CESDI",value:"CESDI",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:l(()=>[e(v,{label:"CEP",value:"CEP",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:l(()=>[e(v,{label:"RCTO",value:"RCTO",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:l(()=>[e(v,{label:"CCN",value:"CCN",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:l(()=>[e(v,{label:"CTP",value:"CTP",color:"primary"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e(A,{class:"my-6"}),u("div",me,[a[7]||(a[7]=u("h3",{class:"text-h6 mb-4"},"Arquivo",-1)),e(b,{align:"center"},{default:l(()=>[e(r,{cols:"12",md:"8"},{default:l(()=>[e(w,{label:"Nome do arquivo",modelValue:i(o).file_name,"onUpdate:modelValue":a[3]||(a[3]=d=>i(o).file_name=d),disabled:!i(o).validar||i(o).validar==="ATOS"},null,8,["modelValue","disabled"])]),_:1}),e(r,{cols:"12",md:"4",class:"d-flex justify-end"},{default:l(()=>[e(n,{text:"Enviar",onSave:k,class:"px-8"})]),_:1})]),_:1})])]),i(_)?($(),K("div",fe,[u("div",pe,[e(ee,{class:"mr-2"},{default:l(()=>a[8]||(a[8]=[x("mdi-check-circle")])),_:1}),a[9]||(a[9]=x(" Dados CENSEC Retornados "))]),u("div",ve,[u("pre",null,ae(JSON.stringify(i(_),null,2)),1)])])):oe("",!0)]),_:1})}}};export{ke as default};
