import{_ as ro}from"./fnMpgsdM.js";import{_ as no,a as io}from"./BOZZBWFA.js";import{_ as uo}from"./CeLaRBCF.js";import{_ as mo}from"./C206BADE.js";import{_ as L}from"./BKZiS51m.js";import{_ as po}from"./CBmuzA38.js";import{_ as co,a as _o}from"./DJvq3mCv.js";import{_ as vo,u as fo,m as yo,r as u,n as S,p as ko,q as Vo,s as bo,v as go,c as C,b as s,w as r,a as d,x as l,y as ho,z as $o,F as xo,A as wo,o as g,B as y,V as m,C as Ao,D as So,E as Co,G as Uo}from"./7QQ78_SJ.js";import{u as k}from"./CvJ5mIUm.js";import{f as h}from"./B0IxRygJ.js";import{f as Do}from"./DiHD2oYc.js";import{V as Oo}from"./DywUR6NN.js";import{V as Po}from"./DAPZDfxj.js";import{V as U}from"./kmWoQJrD.js";import{V as i}from"./DGCSf-V-.js";import{V as D}from"./BJdbowPo.js";import{V as To}from"./etdSuCcO.js";import"./r7kzVClg.js";import"./OH7MLOb4.js";import"./CSGl7g6P.js";import"./BG3sBu3h.js";import"./7_cBxn72.js";import"./DvvejYZr.js";import"./BVz1G1IN.js";import"./CUNmude2.js";import"./CnAO4DWi.js";const No=["innerHTML"],Eo={style:{width:"1300px",margin:"0 auto"}},Mo={style:{display:"flex",gap:"4px","justify-content":"center"}},Ro=["onClick"],qo=["onClick"],zo=["onClick","title"],Io=["onClick"],Lo={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:co,alt:"Visualizar",title:"Reativar"},Fo={key:1,src:_o,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Ho={__name:"index",setup(Bo){const _=wo(),{$toast:O}=fo(),F=`${_.public.managemant}/listarUsuarios`,H=`${_.public.managemant}/listar_tipo_atos`,B=`${_.public.managemant}/cancela_lavratura`,j=`${_.public.managemant}/updateAtos`,P=`${_.public.managemant}/pesquisaAtos`,T=yo(),V=u(S("auth_token").value)||null,$=u(S("user-data").value.cartorio_token)||null,x=u(!1),b=u([]),N=u([]),E=u([]),J=u(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),M=u(!1),w=u(!1),R=u(""),W=u(null),Y=u({}),A=u(!1),q=u(null),t=ko({numero:null,data_inicio:z(),data_fim:z(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:V.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),G=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:o=>o.protocolo?`${o.id}
${o.protocolo}`:`${o.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:o=>o.dt_abertura?`${o.dt_abertura}
${o.apresentante_cpf}`:`${o.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:o=>o.dt_lavratura?`${o.dt_lavratura}
${o.apresentante_nome}`:`${o.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:o=>o.situacao?`${o.situacao}
${o.ato_servico}`:`${o.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function z(){const o=new Date,a=o.getFullYear(),n=String(o.getMonth()+1).padStart(2,"0");return`${String(o.getDate()).padStart(2,"0")}-${n}-${a}`}function c(o){if(!o)return null;const[a,n,p]=o.split("/");return`${p}-${n}-${a}`}async function I(){const o=sessionStorage.getItem("pesquisaAto"),a=JSON.parse(o),{data:n}=await k(P,{method:"POST",body:{cartorio_token:S("user-data").value.cartorio_token,usuario_token:a.usuario_token||V.value,data_fim:c(a==null?void 0:a.data_fim),data_inicio:c(a==null?void 0:a.data_inicio)}},"$1U9Iv6Es1X");n.value.length>0&&(b.value=n.value.map(p=>({...p,dt_lavratura:p.dt_lavratura?h(p.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:h(p.dt_abertura,"dd/mm/yyyy")})))}async function K(){const{data:o}=await k(F,{method:"POST",body:{cartorio_token:$.value}},"$hvipqUJYtS");N.value=o.value}async function Q(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(t));const{data:o,error:a}=await k(P,{method:"POST",body:{cartorio_token:$.value,numero:t.numero||null,data_inicio:c(t.data_inicio)||null,data_fim:c(t.data_fim)||null,data_lavratura_inicio:c(t.data_lavratura_inicio)||null,data_lavratura_fim:c(t.data_lavratura_fim)||null,protocolo:t.protocolo||null,livro:t.livro||null,folha:t.folha||null,situacao:t.situacao||null,usuario_token:t.usuario_token,selo:t.selo||null,ato_tipo_token:t.ato_tipo_token,parte:t.parte||null}},"$OjamgBH6nj");o.value.length>0?b.value=o.value.map(n=>({...n,dt_lavratura:n.dt_lavratura?h(n.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:n.dt_abertura?h(n.dt_abertura,"dd/mm/yyyy"):null})):(b.value=[],O.error("Não existe ato Registrado!"))}catch(o){console.error("Erro na requisição",o)}}const X=o=>{T.push({path:`/fontes/atos/atos-com-bem/atualizar/${o.id}`,query:{origem:"vizualizar-lista",id:o.id,ato_id:o.id,tipo_ato_token:o.tipo_token,tipo_ato:o.ato_servico,ato_token_edit:o.token,numero_os:o.numero_os,usa_imoveis:!0}})};async function Z(){const{data:o,error:a}=await k(H,{method:"POST",body:{cartorio_token:$.value,usuario_token:V.value,tipo_retorno:"servico_ato"}},"$QxIfw0Zxe4");E.value=o.value.map(n=>({...n,descricao:n.descricao.replace(/\(/g,"<br>(")}))}const oo=o=>{q.value=o,A.value=!0};async function ao(o){o.excluido=!o.excluido;try{await Do(`${j}/${o.id}`,{method:"PUT",body:{excluido:o.excluido}})}catch(a){console.error("Erro ao excluir pessoa:",a)}}const eo=async o=>{const{data:a,status:n}=await k(B,{method:"POST",body:{ato_token:o,user_token:V.value,cancelar_selo:!1}},"$ceiptlfDNO");n.value==="success"&&a.value[0].status==="OK"?O.success("Lavratura cancelada com sucesso!"):a.value[0].status==="ERRO"&&(w.value=!0,R.value=a.value[0].status_mensagem)},to=o=>{(o.usa_imoveis||!o.usa_imoveis)&&T.push({path:`/fontes/atos/atos-com-bem/atualizar/${o.id}`,query:{origem:"atualizar-lista",id:o.id,ato_id:o.id,tipo_ato_token:o.tipo_token,tipo_ato:o.tipo,ato_token_edit:o.token,numero_os:o.numero_os,usa_imoveis:!0}})};return Vo(()=>{bo(async()=>{const o=sessionStorage.getItem("pesquisaAto");if(o){const a=JSON.parse(o);Object.assign(t,a)}await I()})}),K(),Z(),(o,a)=>{const n=ro,p=no,lo=uo,so=mo,v=go("mask");return g(),C(xo,null,[s(Oo,{class:"mt-5"},{default:r(()=>[s(U,{class:"mb-5"},{default:r(()=>a[19]||(a[19]=[d("h1",null,"Atos",-1)])),_:1}),s(U,null,{default:r(()=>[s(i,{cols:"2"},{default:r(()=>[y(s(m,{modelValue:l(t).data_inicio,"onUpdate:modelValue":a[0]||(a[0]=e=>l(t).data_inicio=e),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:r(()=>[y(s(m,{modelValue:l(t).data_fim,"onUpdate:modelValue":a[1]||(a[1]=e=>l(t).data_fim=e),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:r(()=>[y(s(m,{modelValue:l(t).data_lavratura_inicio,"onUpdate:modelValue":a[2]||(a[2]=e=>l(t).data_lavratura_inicio=e),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:r(()=>[y(s(m,{modelValue:l(t).data_lavratura_fim,"onUpdate:modelValue":a[3]||(a[3]=e=>l(t).data_lavratura_fim=e),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:r(()=>[s(m,{modelValue:l(t).numero,"onUpdate:modelValue":a[4]||(a[4]=e=>l(t).numero=e),label:"N° OS"},null,8,["modelValue"])]),_:1}),s(i,{cols:"2"},{default:r(()=>[s(m,{modelValue:l(t).selo,"onUpdate:modelValue":a[5]||(a[5]=e=>l(t).selo=e),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),s(U,null,{default:r(()=>[s(i,{cols:"2"},{default:r(()=>[s(m,{modelValue:l(t).protocolo,"onUpdate:modelValue":a[6]||(a[6]=e=>l(t).protocolo=e),label:"Protocolo"},null,8,["modelValue"])]),_:1}),s(i,{cols:"2"},{default:r(()=>[y(s(m,{modelValue:l(t).apresentante_cpf,"onUpdate:modelValue":a[7]||(a[7]=e=>l(t).apresentante_cpf=e),label:"CPF",dense:""},null,8,["modelValue"]),[[v,"###.###.###-##"]])]),_:1}),s(i,{cols:"3"},{default:r(()=>[s(m,{modelValue:l(t).parte,"onUpdate:modelValue":a[8]||(a[8]=e=>l(t).parte=e),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"3"},{default:r(()=>[s(D,{modelValue:l(t).ato_tipo_token,"onUpdate:modelValue":a[9]||(a[9]=e=>l(t).ato_tipo_token=e),items:l(E),"item-value":"token",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},{item:r(({props:e,item:f})=>[s(To,Ao(So(e)),{title:r(()=>[d("span",{innerHTML:f.raw.descricao},null,8,No)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),s(i,{cols:"2"},{default:r(()=>[s(D,{items:l(N),modelValue:l(t).usuario_token,"onUpdate:modelValue":a[10]||(a[10]=e=>l(t).usuario_token=e),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),s(i,{cols:"3"},{default:r(()=>[s(D,{modelValue:l(t).situacao,"onUpdate:modelValue":a[11]||(a[11]=e=>l(t).situacao=e),items:l(J),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),s(i,{cols:"1"},{default:r(()=>[s(m,{modelValue:l(t).livro,"onUpdate:modelValue":a[12]||(a[12]=e=>l(t).livro=e),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"1"},{default:r(()=>[s(m,{modelValue:l(t).folha,"onUpdate:modelValue":a[13]||(a[13]=e=>l(t).folha=e),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),s(i,null,{default:r(()=>[d("div",null,[d("img",{onClick:Q,style:{width:"40px",height:"40px",cursor:"pointer"},src:L,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),d("div",Eo,[a[22]||(a[22]=d("hr",{class:"mt-5 mb-5"},null,-1)),s(Po,{headers:G,items:l(b),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":r(({item:e})=>[d("div",Mo,[d("div",{onClick:f=>X(e),title:"Visualizar"},a[20]||(a[20]=[d("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:L,alt:"Visualizar"},null,-1)]),8,Ro),d("div",{onClick:f=>oo(e.token),title:"Reimprimir"},a[21]||(a[21]=[d("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:io,alt:"Reimprimir"},null,-1)]),8,qo),d("div",{class:Co({disabled:!e.btn_editar}),onClick:f=>e.btn_editar?to({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,usa_imoveis:e.usa_imoveis}):null,title:e.btn_editar?"Editar":"Desabilitado"},[d("img",{style:Uo({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:po,alt:"Editar"},null,4)],10,zo),d("div",{onClick:f=>ao(e),title:"Excluir"},[e.excluido?(g(),C("img",Lo)):(g(),C("img",Fo))],8,Io)])]),_:1},8,["items"])]),l(x)?(g(),ho(n,{key:0,show:l(x),servicos:o.dadosData.servicos||[],tiposAtos:o.dadosData.tiposAtos||[],onClose:a[14]||(a[14]=e=>x.value=!1),onUpdateAto:o.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):$o("",!0),s(p,{show:l(A),ato_token:l(q),onClose:a[15]||(a[15]=e=>A.value=!1)},null,8,["show","ato_token"]),s(lo,{show:l(M),numero_os:l(W),ordem:l(Y),onClose:a[16]||(a[16]=e=>M.value=!1),onRefreshValue:a[17]||(a[17]=e=>I())},null,8,["show","numero_os","ordem"]),s(so,{show:l(w),condMessage:l(R),onClose:a[18]||(a[18]=e=>w.value=!1),onConfirm:eo},null,8,["show","condMessage"])],64)}}},ya=vo(Ho,[["__scopeId","data-v-c85eccdf"]]);export{ya as default};
