import{_ as L}from"./DWVuanQ9.js";import{P as U,Q as q,R as F,b as e,S as h,T as j,U as B,W as R,X as J,A as M,Y as W,Z as Y,$ as I,F as z,a0 as H,u as Q,e as $,f as X,r as Z,m as K,h as D,w as o,k as ee,o as T,a as c,q as P,s as k,i,a1 as ae,d as O,t as te,p as oe}from"./DAXHVUaZ.js";import{V as le}from"./Cwnh_cnW.js";import{V as u}from"./Dff3iLlp.js";import{V as w}from"./C1zAWlGE.js";import{a as A,V as N,b as se}from"./CD_Flf9A.js";import{V as E}from"./CCc6I9Xp.js";import{m as ne,V as G,a as ie,b as re}from"./DVhNtvur.js";import"./D3AH7Ov6.js";import"./5KnsWSUG.js";import"./CyT4IHjo.js";const de=U({...ne({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),b=q()({name:"VRadio",props:de(),setup(s,p){let{slots:m}=p;return F(()=>e(G,h(s,{class:["v-radio",s.class],style:s.style,type:"radio"}),m)),{}}}),ue=U({height:{type:[Number,String],default:"auto"},...j(),...B(ie(),["multiple"]),trueIcon:{type:R,default:"$radioOn"},falseIcon:{type:R,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),me=q()({name:"VRadioGroup",inheritAttrs:!1,props:ue(),emits:{"update:modelValue":s=>!0},setup(s,p){let{attrs:m,slots:v}=p;const x=J(),y=M(()=>s.id||`radio-group-${x}`),t=W(s,"modelValue");return F(()=>{const[V,_]=Y(m),g=I.filterProps(s),S=G.filterProps(s),l=v.label?v.label({label:s.label,props:{for:y.value}}):s.label;return e(I,h({class:["v-radio-group",s.class],style:s.style},V,g,{modelValue:t.value,"onUpdate:modelValue":a=>t.value=a,id:y.value}),{...v,default:a=>{let{id:n,messagesId:d,isDisabled:r,isReadonly:C}=a;return e(z,null,[l&&e(H,{id:n.value},{default:()=>[l]}),e(re,h(S,{id:n.value,"aria-describedby":d.value,defaultsTarget:"VRadio",trueIcon:s.trueIcon,falseIcon:s.falseIcon,type:s.type,disabled:r.value,readonly:C.value,"aria-labelledby":l?n.value:void 0,multiple:!1},_,{modelValue:t.value,"onUpdate:modelValue":f=>t.value=f}),v)])}})}),{}}}),ce={class:"mb-6"},fe={class:"mb-6"},pe={class:"mb-4"},ve={class:"bg-grey-lighten-4 pa-4 rounded"},Re={__name:"censec",setup(s){const p=ee(),{$toast:m}=Q(),v=`${p.public.auth}/service/gerencia/integra_censec`;`${p.public.ws}`;const y=$("auth_token").value,t=X({data_inicio:_(),data_fim:_(),validar:null,file_name:""}),V=Z(null);function _(){const l=new Date,a=l.getFullYear(),n=String(l.getMonth()+1).padStart(2,"0");return`${String(l.getDate()).padStart(2,"0")}-${n}-${a}`}function g(l){if(!l)return null;const[a,n,d]=l.split("/");return`${d}-${n}-${a}`}const S=async()=>{if(console.log("Token:",y),!t.validar){m.warning("Selecione um tipo de validação antes de enviar!");return}try{const l=await fetch(`${v}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify({cartorio_token:$("user-data").value.cartorio_token,data_inicio:g(t.data_inicio),data_fim:g(t.data_fim),validar:t.validar,file_name:t.file_name})});if(!l.ok)throw new Error(`Erro ao gerar dados (HTTP ${l.status})`);if(t.validar==="ATOS"){const a=await l.text(),n=window.open("","_blank");n?(n.document.open(),n.document.write(a),n.document.close()):m.warning("Não foi possível abrir a nova aba (bloqueador de pop-up?).")}else{if(!t.file_name){m.warning("Digite o nome do arquivo!");return}const a=await l.blob(),n=l.headers.get("Content-Disposition"),d=n&&n.match(/filename="(.+)"/),r=d?d[1]:`${t.file_name}.json`,C=window.URL.createObjectURL(a),f=document.createElement("a");f.href=C,f.download=r,document.body.appendChild(f),f.click(),f.remove(),window.URL.revokeObjectURL(C),m.success("Arquivo baixado com sucesso!")}}catch(l){console.error(l),m.error("Erro ao processar a requisição.")}};return(l,a)=>{const n=L,d=K("mask");return T(),D(le,{class:"py-6"},{default:o(()=>[e(w,{class:"mb-5"},{default:o(()=>[e(u,{cols:"12",class:"mx-auto",style:{"max-width":"1200px"}},{default:o(()=>a[4]||(a[4]=[c("h1",{class:"text-h4 font-weight-bold"},"Integração CENSEC",-1)])),_:1})]),_:1}),e(N,{elevation:"2",class:"mx-auto","max-width":"1200"},{default:o(()=>[e(A,{class:"pa-6"},{default:o(()=>[c("div",ce,[a[5]||(a[5]=c("h3",{class:"text-h6 mb-4"},"Período de Consulta",-1)),e(w,null,{default:o(()=>[e(u,{cols:"12",md:"6"},{default:o(()=>[P(e(k,{modelValue:i(t).data_inicio,"onUpdate:modelValue":a[0]||(a[0]=r=>i(t).data_inicio=r),label:"Data Início",placeholder:"dd/mm/yyyy","prepend-inner-icon":"mdi-calendar-start",variant:"outlined",density:"comfortable"},null,8,["modelValue"]),[[d,"##/##/####"]])]),_:1}),e(u,{cols:"12",md:"6"},{default:o(()=>[P(e(k,{modelValue:i(t).data_fim,"onUpdate:modelValue":a[1]||(a[1]=r=>i(t).data_fim=r),label:"Data Fim",placeholder:"dd/mm/yyyy","prepend-inner-icon":"mdi-calendar-end",variant:"outlined",density:"comfortable"},null,8,["modelValue"]),[[d,"##/##/####"]])]),_:1})]),_:1})]),e(E,{class:"my-6"}),c("div",fe,[a[6]||(a[6]=c("h3",{class:"text-h6 mb-4"},"Tipo de Validação",-1)),e(me,{modelValue:i(t).validar,"onUpdate:modelValue":a[2]||(a[2]=r=>i(t).validar=r),class:"mt-2"},{default:o(()=>[e(w,null,{default:o(()=>[e(u,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:o(()=>[e(b,{label:"VALIDAR ATOS",value:"ATOS",color:"primary"})]),_:1}),e(u,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:o(()=>[e(b,{label:"CESDI",value:"CESDI",color:"primary"})]),_:1}),e(u,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:o(()=>[e(b,{label:"CEP",value:"CEP",color:"primary"})]),_:1}),e(u,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:o(()=>[e(b,{label:"RCTO",value:"RCTO",color:"primary"})]),_:1}),e(u,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:o(()=>[e(b,{label:"CCN",value:"CCN",color:"primary"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e(E,{class:"my-6"}),c("div",pe,[a[7]||(a[7]=c("h3",{class:"text-h6 mb-4"},"Arquivo",-1)),e(w,{align:"center"},{default:o(()=>[e(u,{cols:"12",md:"8"},{default:o(()=>[e(k,{label:"Nome do arquivo",modelValue:i(t).file_name,"onUpdate:modelValue":a[3]||(a[3]=r=>i(t).file_name=r),disabled:!i(t).validar||i(t).validar==="ATOS","prepend-inner-icon":"mdi-file-document-outline",variant:"outlined",density:"comfortable",hint:"Selecione um tipo de validação primeiro","persistent-hint":""},null,8,["modelValue","disabled"])]),_:1}),e(u,{cols:"12",md:"4",class:"d-flex justify-end"},{default:o(()=>[e(n,{text:"Enviar",onSave:S,class:"px-8"})]),_:1})]),_:1})])]),_:1})]),_:1}),i(V)?(T(),D(N,{key:0,elevation:"2",class:"mx-auto mt-6","max-width":"1200"},{default:o(()=>[e(se,{class:"bg-success text-white pa-4"},{default:o(()=>[e(ae,{class:"mr-2"},{default:o(()=>a[8]||(a[8]=[O("mdi-check-circle")])),_:1}),a[9]||(a[9]=O(" Dados CENSEC Retornados "))]),_:1}),e(A,{class:"pa-6"},{default:o(()=>[c("pre",ve,te(JSON.stringify(i(V),null,2)),1)]),_:1})]),_:1})):oe("",!0)]),_:1})}}};export{Re as default};
