import{cb as op,cc as ap,cd as np,ce as sp,cf as lp,cg as hp,ch as pp,F as rn,ci as up,cj as cp,ck as dp,cl as fp,cm as gp,cn as vp,co as yp,cp as mp,cq as Cp,cr as Mp,cs as bp,ct as jp,cu as Ip,cv as Tp,cw as Sp,aK as Np,cx as Dp,cy as wp,y as Hl,cz as Op,j as fr,k as gr,c as po,a as Ql,cA as xp,cB as Ap,cC as zp,cD as Pp,cE as Ep,cF as Lp,d as vr,b as Je,cG as kp,cH as Yp,U as Fp,cI as Up,cJ as Rp,cK as Bp,cL as Hp,cM as Qp,cN as Xp,cO as Wp,cP as Vp,cQ as qp,cR as _p,cS as Zp,ab as Gp,bA as Jp,cT as Kp,cU as $p,cV as eu,Z as tu,cW as iu,cX as ru,cY as ou,cZ as au,c_ as nu,c$ as su,d0 as lu,d1 as hu,d2 as pu,aG as uu,d3 as cu,d4 as du,bu as fu,bv as gu,A as ka,d5 as vu,d6 as yu,d7 as mu,d8 as Cu,d9 as Mu,da as bu,P as br,n as Ya,p as ju,db as Iu,q as Tu,a9 as Su,bt as Nu,I as Du,am as wu,a8 as Ou,dc as xu,g as on,dd as Au,de as zu,by as Pu,df as Eu,bx as Lu,dg as ku,dh as Yu,o as ri,di as Fu,M as Uu,dj as Ru,dk as Bu,dl as Hu,f as Qu,bQ as Xu,r as gi,dm as Wu,dn as Vu,D as Xl,R as qu,z as _u,h as Zu,Q as Gu,dp as Ju,dq as Ku,dr as $u,ds as ec,dt as tc,du as ic,dv as rc,az as oc,dw as ac,dx as nc,dy as sc,t as uo,dz as lc,dA as hc,T as pc,aD as uc,dB as cc,ac as dc,dC as fc,dD as gc,i as ot,dE as vc,dF as yc,dG as mc,dH as Cc,dI as Mc,dJ as bc,dK as jc,dL as Ic,dM as Tc,dN as Sc,dO as Nc,dP as Dc,dQ as wc,dR as Oc,dS as xc,E as Ac,bM as zc,dT as Pc,dU as Ec,H as vi,a7 as Lc,dV as kc,dW as Yc,s as Fc,w as wt,dX as Uc,m as Rc,G as Bc,dY as Hc,x as Qc,dZ as Xc,af as Wl,an as Wc,ai as Vl,av as Vc,aw as qc,ak as ql,b6 as _c,v as yr,d_ as Zc,aJ as Gc,u as Jc,l as Kc,e as An}from"./CtwmuydX.js";import{u as zn}from"./DJzZkYSJ.js";import{V as $c,a as ed,c as td}from"./QDtQG_BW.js";import{m as id,a as Pn,b as rd,V as En}from"./9lCRtzq_.js";import{m as od,V as Fa}from"./DUqk-AUj.js";import{V as ad}from"./Cp-QozIr.js";/**
* vue v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const nd=()=>{},sd=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:op,BaseTransitionPropsValidators:ap,Comment:np,DeprecationTypes:sp,EffectScope:lp,ErrorCodes:hp,ErrorTypeStrings:pp,Fragment:rn,KeepAlive:up,ReactiveEffect:cp,Static:dp,Suspense:fp,Teleport:gp,Text:vp,TrackOpTypes:yp,Transition:mp,TransitionGroup:Cp,TriggerOpTypes:Mp,VueElement:bp,assertNumber:jp,callWithAsyncErrorHandling:Ip,callWithErrorHandling:Tp,camelize:Sp,capitalize:Np,cloneVNode:Dp,compatUtils:wp,compile:nd,computed:Hl,createApp:Op,createBlock:fr,createCommentVNode:gr,createElementBlock:po,createElementVNode:Ql,createHydrationRenderer:xp,createPropsRestProxy:Ap,createRenderer:zp,createSSRApp:Pp,createSlots:Ep,createStaticVNode:Lp,createTextVNode:vr,createVNode:Je,customRef:kp,defineAsyncComponent:Yp,defineComponent:Fp,defineCustomElement:Up,defineEmits:Rp,defineExpose:Bp,defineModel:Hp,defineOptions:Qp,defineProps:Xp,defineSSRCustomElement:Wp,defineSlots:Vp,devtools:qp,effect:_p,effectScope:Zp,getCurrentInstance:Gp,getCurrentScope:Jp,getCurrentWatcher:Kp,getTransitionRawChildren:$p,guardReactiveProps:eu,h:tu,handleError:iu,hasInjectionContext:ru,hydrate:ou,hydrateOnIdle:au,hydrateOnInteraction:nu,hydrateOnMediaQuery:su,hydrateOnVisible:lu,initCustomFormatter:hu,initDirectivesForSSR:pu,inject:uu,isMemoSame:cu,isProxy:du,isReactive:fu,isReadonly:gu,isRef:ka,isRuntimeOnly:vu,isShallow:yu,isVNode:mu,markRaw:Cu,mergeDefaults:Mu,mergeModels:bu,mergeProps:br,nextTick:Ya,normalizeClass:ju,normalizeProps:Iu,normalizeStyle:Tu,onActivated:Su,onBeforeMount:Nu,onBeforeUnmount:Du,onBeforeUpdate:wu,onDeactivated:Ou,onErrorCaptured:xu,onMounted:on,onRenderTracked:Au,onRenderTriggered:zu,onScopeDispose:Pu,onServerPrefetch:Eu,onUnmounted:Lu,onUpdated:ku,onWatcherCleanup:Yu,openBlock:ri,popScopeId:Fu,provide:Uu,proxyRefs:Ru,pushScopeId:Bu,queuePostFlushCb:Hu,reactive:Qu,readonly:Xu,ref:gi,registerRuntimeCompiler:Wu,render:Vu,renderList:Xl,renderSlot:qu,resolveComponent:_u,resolveDirective:Zu,resolveDynamicComponent:Gu,resolveFilter:Ju,resolveTransitionHooks:Ku,setBlockTracking:$u,setDevtoolsHook:ec,setTransitionHooks:tc,shallowReactive:ic,shallowReadonly:rc,shallowRef:oc,ssrContextKey:ac,ssrUtils:nc,stop:sc,toDisplayString:uo,toHandlerKey:lc,toHandlers:hc,toRaw:pc,toRef:uc,toRefs:cc,toValue:dc,transformVNodeArgs:fc,triggerRef:gc,unref:ot,useAttrs:vc,useCssModule:yc,useCssVars:mc,useHost:Cc,useId:Mc,useModel:bc,useSSRContext:jc,useShadowRoot:Ic,useSlots:Tc,useTemplateRef:Sc,useTransitionState:Nc,vModelCheckbox:Dc,vModelDynamic:wc,vModelRadio:Oc,vModelSelect:xc,vModelText:Ac,vShow:zc,version:Pc,warn:Ec,watch:vi,watchEffect:Lc,watchPostEffect:kc,watchSyncEffect:Yc,withAsyncContext:Fc,withCtx:wt,withDefaults:Uc,withDirectives:Rc,withKeys:Bc,withMemo:Hc,withModifiers:Qc,withScopeId:Xc},Symbol.toStringTag,{value:"Module"}));var Ln="ej2_instances",ld=0,hd=!1;function mo(l,t){var e=t;return e.unshift(void 0),new(Function.prototype.bind.apply(l,e))}function pd(l){var t,e=new Uint16Array(5),i=window.msCrypto||window.crypto;i.getRandomValues(e);var r="ej2"+dd(e),o=function(a){a.source===window&&typeof a.data=="string"&&a.data.length<=32&&a.data===r&&(l(),t())};return window.addEventListener("message",o,!1),window.postMessage(r,"*"),t=function(){window.removeEventListener("message",o),l=o=r=void 0}}function Z(l,t){for(var e=t,i=l.replace(/\[/g,".").replace(/\]/g,"").split("."),r=0;r<i.length&&!ue(e);r++)e=e[i[parseInt(r.toString(),10)]];return e}function Ae(l,t,e){var i=l.replace(/\[/g,".").replace(/\]/g,"").split("."),r=e||{},o=r,a,n=i.length,s;for(a=0;a<n;a++)s=i[parseInt(a.toString(),10)],!(s==="__proto__"||s==="constructor"||s==="prototype")&&(a+1===n?o[""+s]=t===void 0?{}:t:d(o[""+s])&&(o[""+s]={}),o=o[""+s]);return r}function an(l,t){delete l[""+t]}var bi=typeof window<"u"?window:{};function yi(l){var t={};return!d(l)&&l.constructor===t.constructor}function mi(l,t){if(!d(t))for(var e=l,i=t,r=Object.keys(t),o="deepMerge",a=0,n=r;a<n.length;a++){var s=n[a];!d(e[""+o])&&e[""+o].indexOf(s)!==-1&&(yi(i[""+s])||Array.isArray(i[""+s]))?y(e[""+s],e[""+s],i[""+s],!0):e[""+s]=i[""+s]}}function y(l,t,e,i){var r=l&&typeof l=="object"?l:{},o=arguments.length,a=[l,t,e,i];i&&(o=o-1);for(var n=function(h){if(!a[parseInt(h.toString(),10)])return"continue";var p=a[parseInt(h.toString(),10)];Object.keys(p).forEach(function(u){var c=r[""+u],f=p[""+u],g;Array.isArray(f)&&Array.isArray(c)&&(f.length,c.length);var v=!0;i&&v&&(yi(f)||Array.isArray(f))?yi(f)?(g=c||{},Array.isArray(g)&&Object.prototype.hasOwnProperty.call(g,"isComplexArray")?y(g,{},f,i):r[""+u]=y(g,{},f,i)):(g=c||[],r[""+u]=y([],g,f,g&&g.length||f&&f.length)):r[""+u]=f})},s=1;s<o;s++)n(s);return r}function d(l){return l==null}function ue(l){return typeof l>"u"}function Ve(l){return l+"_"+ld++}function ud(l,t){var e;return function(){for(var i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var a=function(){return e=null,l.apply(i,r)};clearTimeout(e),e=setTimeout(a,t)}}function nn(l,t){var e=l;return e===t?!0:e===document||!e?!1:nn(e.parentNode,t)}function mr(l){try{throw new Error(l)}catch(t){throw new Error(t.message+`
`+t.stack)}}function Zy(l,t){var e=document.createElement("div"),i=[].slice.call(document.getElementsByTagName("head")[0].querySelectorAll("base, link, style")),r=[].slice.call(document.getElementsByTagName("body")[0].querySelectorAll("link, style"));if(r.length)for(var o=0,a=r.length;o<a;o++)i.push(r[parseInt(o.toString(),10)]);var n="";d(t)&&(t=window.open("","print","height=452,width=1024,tabbar=no")),e.appendChild(l.cloneNode(!0));for(var s=0,a=i.length;s<a;s++)n+=i[parseInt(s.toString(),10)].outerHTML;t.document.write("<!DOCTYPE html> <html><head>"+n+"</head><body>"+e.innerHTML+"<script> (function() { window.ready = true; })(); <\/script></body></html>"),t.document.close(),t.focus();var h=setInterval(function(){t.ready&&(t.print(),t.close(),clearInterval(h))},500);return t}function ee(l){var t=l+"";return t.match(/auto|cm|mm|in|px|pt|pc|%|em|ex|ch|rem|vw|vh|vmin|vmax/)?t:t+"px"}function Hi(){return hd}function Gy(l){return l}function Pi(l,t){var e=typeof l=="string"?document.querySelector(l):l;if(e[""+Ln])for(var i=0,r=e[""+Ln];i<r.length;i++){var o=r[i];if(o instanceof t)return o}return null}function cd(){if(!(typeof window>"u")){var l=new Uint16Array(5),t=window.msCrypto||window.crypto;return t.getRandomValues(l)}}function dd(l){for(var t="",e=0;e<5;e++)t+=(e?",":"")+l[parseInt(e.toString(),10)];return t}var fd={latn:{_digits:"0123456789",_type:"numeric"}},kn={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"∞",nan:"NaN",exponential:"E"},Yn=[0,1,2,3,4,5,6,7,8,9],Le=function(){function l(){}return l.getMainObject=function(t,e){var i="main."+e;return Z(i,t)},l.getNumberingSystem=function(t){return Z("supplemental.numberingSystems",t)||this.numberingSystems},l.reverseObject=function(t,e){for(var i=e||Object.keys(t),r={},o=0,a=i;o<a.length;o++){var n=a[o];Object.prototype.hasOwnProperty.call(r,t[""+n])||(r[t[""+n]]=n)}return r},l.getSymbolRegex=function(t){var e=t.map(function(r){return r.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}).join("|"),i=RegExp;return new i(e,"g")},l.getSymbolMatch=function(t){for(var e=Object.keys(kn),i={},r=0,o=e;r<o.length;r++){var a=o[r];i[t[""+a]]=kn[""+a]}return i},l.constructRegex=function(t){for(var e=t.length,i="",r=0;r<e;r++)r!==e-1?i+=t[parseInt(r.toString(),10)]+"|":i+=t[parseInt(r.toString(),10)];return i},l.convertValueParts=function(t,e,i){return t.replace(e,function(r){return i[""+r]})},l.getDefaultNumberingSystem=function(t){var e={};return e.obj=Z("numbers",t),e.nSystem=Z("defaultNumberingSystem",e.obj),e},l.getCurrentNumericOptions=function(t,e,i,r){var o={},a=this.getDefaultNumberingSystem(t);if(!ue(a.nSystem)||r){var n=r?Z("obj.mapperDigits",a):Z(a.nSystem+"._digits",e);if(!ue(n)){o.numericPair=this.reverseObject(n,Yn);var s=RegExp;o.numberParseRegex=new s(this.constructRegex(n),"g"),o.numericRegex="["+n[0]+"-"+n[9]+"]",i&&(o.numericRegex=n[0]+"-"+n[9],o.symbolNumberSystem=Z(r?"numberSymbols":"symbols-numberSystem-"+a.nSystem,a.obj),o.symbolMatch=this.getSymbolMatch(o.symbolNumberSystem),o.numberSystem=a.nSystem)}}return o},l.getNumberMapper=function(t,e,i){var r={mapper:{}},o=this.getDefaultNumberingSystem(t);if(!ue(o.nSystem)){r.numberSystem=o.nSystem,r.numberSymbols=Z("symbols-numberSystem-"+o.nSystem,o.obj),r.timeSeparator=Z("timeSeparator",r.numberSymbols);var a=Z(o.nSystem+"._digits",e);if(!ue(a))for(var n=0,s=Yn;n<s.length;n++){var h=s[n];r.mapper[parseInt(h.toString(),10)]=a[parseInt(h.toString(),10)]}}return r},l.nPair="numericPair",l.nRegex="numericRegex",l.numberingSystems=fd,l}(),gd={DJF:"Fdj",ERN:"Nfk",ETB:"Br",NAD:"$",ZAR:"R",XAF:"FCFA",GHS:"GH₵",XDR:"XDR",AED:"د.إ.",BHD:"د.ب.",DZD:"د.ج.",EGP:"ج.م.",ILS:"₪",IQD:"د.ع.",JOD:"د.ا.",KMF:"CF",KWD:"د.ك.",LBP:"ل.ل.",LYD:"د.ل.",MAD:"د.م.",MRU:"أ.م.",OMR:"ر.ع.",QAR:"ر.ق.",SAR:"ر.س.",SDG:"ج.س.",SOS:"S",SSP:"£",SYP:"ل.س.",TND:"د.ت.",YER:"ر.ي.",CLP:"$",INR:"₹",TZS:"TSh",EUR:"€",AZN:"₼",RUB:"₽",BYN:"Br",ZMW:"K",BGN:"лв.",NGN:"₦",XOF:"CFA",BDT:"৳",CNY:"¥",BAM:"КМ",UGX:"USh",USD:"$",CZK:"Kč",GBP:"£",DKK:"kr.",KES:"Ksh",CHF:"CHF",MVR:"ރ.",BTN:"Nu.",XCD:"EC$",AUD:"$",BBD:"$",BIF:"FBu",BMD:"$",BSD:"$",BWP:"P",BZD:"$",CAD:"$",NZD:"$",FJD:"$",FKP:"£",GIP:"£",GMD:"D",GYD:"$",HKD:"$",IDR:"Rp",JMD:"$",KYD:"$",LRD:"$",MGA:"Ar",MOP:"MOP$",MUR:"Rs",MWK:"MK",MYR:"RM",PGK:"K",PHP:"₱",PKR:"Rs",RWF:"RF",SBD:"$",SCR:"SR",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",ANG:"NAf.",SZL:"E",TOP:"T$",TTD:"$",VUV:"VT",WST:"WS$",ARS:"$",BOB:"Bs",BRL:"R$",COP:"$",CRC:"₡",CUP:"$",DOP:"$",GTQ:"Q",HNL:"L",MXN:"$",NIO:"C$",PAB:"B/.",PEN:"S/",PYG:"₲",UYU:"$",VES:"Bs.S",IRR:"ريال",GNF:"FG",CDF:"FC",HTG:"G",XPF:"FCFP",HRK:"kn",HUF:"Ft",AMD:"֏",ISK:"kr",JPY:"¥",GEL:"₾",CVE:"​",KZT:"₸",KHR:"៛",KPW:"₩",KRW:"₩",KGS:"сом",AOA:"Kz",LAK:"₭",MZN:"MTn",MKD:"ден",MNT:"₮",BND:"$",MMK:"K",NOK:"kr",NPR:"रु",AWG:"Afl.",SRD:"$",PLN:"zł",AFN:"؋",STN:"Db",MDL:"L",RON:"lei",UAH:"₴",LKR:"රු.",ALL:"Lekë",RSD:"дин.",TJS:"смн",THB:"฿",TMT:"m.",TRY:"₺",UZS:"сўм",VND:"₫",TWD:"NT$"};function vd(l){return Z(l||"",gd)}var sn="USD",_l=null,Zl=null;function yd(l){_l=l}function md(l){Zl=l}var Fn=RegExp,Un={"en-US":{d:"M/d/y",D:"EEEE, MMMM d, y",f:"EEEE, MMMM d, y h:mm a",F:"EEEE, MMMM d, y h:mm:s a",g:"M/d/y h:mm a",G:"M/d/yyyy h:mm:ss tt",m:"MMMM d",M:"MMMM d",r:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",R:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",s:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",t:"h:mm tt",T:"h:m:s tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",U:"dddd, MMMM d, yyyy h:mm:ss tt",y:"MMMM yyyy",Y:"MMMM yyyy"}},se;(function(l){l.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,l.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*[0# ]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,l.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;var t=/[0-9]/g;l.defaultCurrency="$";var e=["infinity","nan","group","decimal"],i=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,r={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};l.dateConverterMapper=/dddd|ddd/ig;var o="sun";l.islamicRegex=/^islamic/;var a={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};l.formatRegex=new Fn("(^[ncpae]{1})([0-1]?[0-9]|20)?$","i"),l.currencyFormatRegex=new Fn("(^[ca]{1})([0-1]?[0-9]|20)?$","i"),l.curWithoutNumberRegex=/(c|a)$/ig;var n={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};l.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi,l.basicPatterns=["short","medium","long","full"],l.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}},islamic:{months:{"stand-alone":{abbreviated:{1:"Muh.",2:"Saf.",3:"Rab. I",4:"Rab. II",5:"Jum. I",6:"Jum. II",7:"Raj.",8:"Sha.",9:"Ram.",10:"Shaw.",11:"Dhuʻl-Q.",12:"Dhuʻl-H."},narrow:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},wide:{1:"Muharram",2:"Safar",3:"Rabiʻ I",4:"Rabiʻ II",5:"Jumada I",6:"Jumada II",7:"Rajab",8:"Shaʻban",9:"Ramadan",10:"Shawwal",11:"Dhuʻl-Qiʻdah",12:"Dhuʻl-Hijjah"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"AH"},eraAbbr:{0:"AH"},eraNarrow:{0:"AH"}},dateFormats:{full:"EEEE, MMMM d, y G",long:"MMMM d, y G",medium:"MMM d, y G",short:"M/d/y GGGGG"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y G",yyyy:"y G",yyyyM:"M/y GGGGG",yyyyMd:"M/d/y GGGGG",yyyyMEd:"E, M/d/y GGGGG",yyyyMMM:"MMM y G",yyyyMMMd:"MMM d, y G",yyyyMMMEd:"E, MMM d, y G",yyyyMMMM:"MMMM y G",yyyyQQQ:"QQQ y G",yyyyQQQQ:"QQQQ y G"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"€","symbol-alt-narrow":"€"},GBP:{displayName:"British Pound","symbol-alt-narrow":"£"}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"×",perMille:"‰",infinity:"∞",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"¤#,##0.00",accounting:"¤#,##0.00;(¤#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}},l.blazorDefaultObject={numbers:{mapper:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},mapperDigits:"0123456789",numberSymbols:{decimal:".",group:",",plusSign:"+",minusSign:"-",percentSign:"%",nan:"NaN",timeSeparator:":",infinity:"∞"},timeSeparator:":",currencySymbol:"$",currencypData:{nlead:"$",nend:"",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentpData:{nlead:"",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentnData:{nlead:"-",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},currencynData:{nlead:"($",nend:")",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalnData:{nlead:"-",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalpData:{nlead:"",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2}},dates:{dayPeriods:{am:"AM",pm:"PM"},dateSeperator:"/",days:{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}},months:{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}},eras:{1:"AD"}}},l.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"},l.month="months",l.days="days",l.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"};function s(E,L,k,U,B){var R,$=k||"date";if(B)R=c({skeleton:E},B).format||c({skeleton:"d"},"en-US").format;else{if(l.basicPatterns.indexOf(E)!==-1){if(R=Z($+"Formats."+E,L),$==="dateTime"){var oe=Z("dateFormats."+E,L),he=Z("timeFormats."+E,L);R=R.replace("{1}",oe).replace("{0}",he)}}else R=Z("dateTimeFormats.availableFormats."+E,L);ue(R)&&E==="yMd"&&(R="M/d/y")}return R}l.getResultantPattern=s;function h(E,L,k,U){var B={},R=k||"gregorian";if(B.parserObject=Le.getMainObject(E,L)||l.defaultObject,U)B.numericObject=Z("numbers",B.parserObject);else{var $="dates.calendars."+R;B.dateObject=Z($,B.parserObject)}return B}l.getDependables=h;function p(E,L,k,U){return Z(E+"Formats-numberSystem-"+L+(U?".accounting":".standard"),k)||(U?Z(E+"Formats-numberSystem-"+L+".standard",k):"")}l.getSymbolPattern=p;function u(E){return E.match(l.dateConverterMapper),E}l.ConvertDateToWeekFormat=u;function c(E,L){var k=E.format||E.skeleton,U=Z((L||"en-US")+"."+k,Un);return U||(U=Z("en-US."+k,Un)),U&&(U=u(U),E.format=U.replace(/tt/,"a")),E}l.compareBlazorDateFormats=c;function f(E){var L=E.match(l.formatRegex),k={},U=L[1].toUpperCase();return k.isAccount=U==="A",k.type=l.patternMatcher[""+U],E.length>1&&(k.fractionDigits=parseInt(L[2],10)),k}l.getProperNumericSkeleton=f;function g(E,L,k,U){var B=U?{}:{nlead:"",nend:""},R=E.match(l.customRegex);if(R){U||(B.nlead=v(R[1],k),B.nend=v(R[10],k),B.groupPattern=R[4]);var $=R[7];if($&&L){var oe=$.match(t);d(oe)?B.minimumFraction=0:B.minimumFraction=oe.length,B.maximumFraction=$.length-1}}return B}l.getFormatData=g;function v(E,L){return E?(E=E.replace(l.defaultCurrency,L),L===""?E.trim():E):""}l.changeCurrencySymbol=v;function m(E,L,k,U){var B=k?"."+k:".symbol",R=U?"$":Z("currencies."+L+B,E)||Z("currencies."+L+".symbol-alt-narrow",E)||"$";return R}l.getCurrencySymbol=m;function C(E,L,k){for(var U={},B=E.split(";"),R=["pData","nData","zeroData"],$=0;$<B.length;$++)U[""+R[parseInt($.toString(),10)]]=M(B[parseInt($.toString(),10)],L,k);return d(U.nData)&&(U.nData=y({},U.pData),U.nData.nlead=d(L)?"-"+U.nData.nlead:L.minusSymbol+U.nData.nlead),U}l.customFormat=C;function M(E,L,k){var U={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},B=E.match(l.customRegex);if(d(B)||B[5]===""&&E!=="N/A")return U.type=void 0,U;U.nlead=B[1],U.nend=B[10];var R=B[6],$=!!R.match(/ $/g),oe=R.replace(/ $/g,"").indexOf(" ")!==-1;U.useGrouping=R.indexOf(",")!==-1||oe,R=R.replace(/,/g,""),R=/\s$/.test(R)?R.replace(/ /g,""):R;var he=B[7];if(R.indexOf("0")!==-1&&(U.minimumIntegerDigits=R.length-R.indexOf("0")),d(he)||(U.minimumFractionDigits=he.lastIndexOf("0"),U.maximumFractionDigits=he.lastIndexOf("#"),U.minimumFractionDigits===-1&&(U.minimumFractionDigits=0),(U.maximumFractionDigits===-1||U.maximumFractionDigits<U.minimumFractionDigits)&&(U.maximumFractionDigits=U.minimumFractionDigits)),d(L)?y(U,I([U.nlead,U.nend],"%","%")):(L.isCustomFormat=!0,y(U,I([U.nlead,U.nend],"$",L.currencySymbol)),U.isCurrency||y(U,I([U.nlead,U.nend],"%",L.percentSymbol))),!d(k)){var pe=p(U.type,L.numberMapper.numberSystem,k,!1);U.useGrouping&&(U.groupSeparator=oe?" ":L.numberMapper.numberSymbols[e[2]],U.groupData=_l.getGroupingDetails(pe.split(";")[0])),U.nlead=U.nlead.replace(/'/g,""),U.nend=$?" "+U.nend.replace(/'/g,""):U.nend.replace(/'/g,"")}return U}l.customNumberFormat=M;function I(E,L,k){for(var U={nlead:E[0],nend:E[1]},B=0;B<2;B++){var R=E[parseInt(B.toString(),10)],$=R.indexOf(L);if($!==-1&&($<R.indexOf("'")||$>R.lastIndexOf("'"))){U[""+n[parseInt(B.toString(),10)]]=R.substr(0,$)+k+R.substr($+1),U[""+n[""+L]]=!0,U.type=U.isCurrency?"currency":"percent";break}}return U}l.isCurrencyPercent=I;function N(E){var L=(Z("dateFormats.short",E)||"").match(/[dM]([^dM])[dM]/i);return L?L[1]:"/"}l.getDateSeparator=N;function O(E,L,k,U){var B=h(k,E,L.calendar),R=L.format||s(L.skeleton,B.dateObject,L.type);if(U){if(R=R.replace(i,function(Ue){return r[""+Ue]}),R.indexOf("z")!==-1){var $=R.match(/z/g).length,oe=void 0,he={timeZone:{}};he.numMapper=Le.getNumberMapper(B.parserObject,Le.getNumberingSystem(k)),he.timeZone=Z("dates.timeZoneNames",B.parserObject);var pe=new Date,Te=pe.getTimezoneOffset(),Pe=$<4?"+H;-H":he.timeZone.hourFormat;Pe=Pe.replace(/:/g,he.numMapper.timeSeparator),Te===0?oe=he.timeZone.gmtZeroFormat:(oe=Zl.getTimeZoneValue(Te,Pe),oe=he.timeZone.gmtFormat.replace(/\{0\}/,oe)),R=R.replace(/[z]+/,'"'+oe+'"')}R=R.replace(/ $/,"")}return R}l.getActualDateTimeFormat=O;function x(E,L){if(E.indexOf(",")!==-1){var k=E.split(",");E=k[0]+Z("numberMapper.numberSymbols.group",L)+k[1].replace(".",Z("numberMapper.numberSymbols.decimal",L))}else E=E.replace(".",Z("numberMapper.numberSymbols.decimal",L));return E}l.processSymbol=x;function D(E,L,k,U){var B=h(k,E,"",!0),R={custom:!0};B.numericObject;var $,oe={},he=(L.format||"").match(l.currencyFormatRegex);l.formatRegex.test(L.format)&&f(L.format||"N");var pe={};if(he){pe.numberMapper=Le.getNumberMapper(B.parserObject,Le.getNumberingSystem(k),!0);var Te=m(B.numericObject,L.currency||sn,L.altSymbol),Pe=p("currency",pe.numberMapper.numberSystem,B.numericObject,/a/i.test(L.format));Pe=Pe.replace(/\u00A4/g,Te);var Ue=Pe.split(";");oe.hasNegativePattern=Ue.length>1,oe.nData=g(Ue[1]||"-"+Ue[0],!0,Te),oe.pData=g(Ue[0],!1,Te),!he[2]&&!L.minimumFractionDigits&&!L.maximumFractionDigits&&($=g(Pe.split(";")[0],!0,"",!0).minimumFraction)}var Se;if(l.formatRegex.test(L.format)||!L.format){if(y(R,f(L.format||"N")),R.custom=!1,Se="###0",R.fractionDigits||L.minimumFractionDigits||L.maximumFractionDigits||$){var Pt=0;R.fractionDigits&&(L.minimumFractionDigits=L.maximumFractionDigits=R.fractionDigits),Se=A(Se,$||R.fractionDigits||L.minimumFractionDigits||Pt,L.maximumFractionDigits||Pt)}if(L.minimumIntegerDigits&&(Se=P(Se,L.minimumIntegerDigits)),L.useGrouping&&(Se=V(Se)),R.type==="currency"||R.type&&Hi()){var jt=Se;Se=oe.pData.nlead+jt+oe.pData.nend,(oe.hasNegativePattern||Hi())&&(Se+=";"+oe.nData.nlead+jt+oe.nData.nend)}R.type==="percent"&&(Se+=" %")}else Se=L.format.replace(/'/g,'"');return Object.keys(pe).length>0&&(Se=U?Se:x(Se,pe)),Se}l.getActualNumberFormat=D;function A(E,L,k){E+=".";for(var U=0;U<L;U++)E+="0";if(L<k)for(var B=k-L,R=0;R<B;R++)E+="#";return E}l.fractionDigitsPattern=A;function P(E,L){for(var k=E.split("."),U="",B=0;B<L;B++)U+="0";return k[1]?U+"."+k[1]:U}l.minimumIntegerPattern=P;function V(E){var L=E.split("."),k=L[0],U=3-k.length%3,B=U&&U===1?"#":U===2?"##":"";k=B+k,E="";for(var R=k.length-1;R>0;R=R-3)E=","+k[R-2]+k[R-1]+k[parseInt(R.toString(),10)]+E;return E=E.slice(1),L[1]?E+"."+L[1]:E}l.groupingPattern=V;function q(E,L){var k=o,U=Z("supplemental.weekData.firstDay",L),B=E;return/en-/.test(B)&&(B=B.slice(3)),B=B.slice(0,2).toUpperCase()+B.substr(2),U&&(k=U[""+B]||U[B.slice(0,2)]||o),a[""+k]}l.getWeekData=q;function re(E,L,k){var U=vd(k);if(L!==U)for(var B=0,R=E;B<R.length;B++){var $=R[B];$.nend=$.nend.replace(L,U),$.nlead=$.nlead.replace(L,U)}}l.replaceBlazorCurrency=re;function ae(E,L){var k=new Date(E.getFullYear(),0,1),U=k.getDay(),B;U=U>=0?U:U+7;var R=Math.floor((E.getTime()-k.getTime()-(E.getTimezoneOffset()-k.getTimezoneOffset())*6e4)/864e5)+1;if(U<4){if(B=Math.floor((R+U-L-1)/7)+1,B>52){var $=new Date(E.getFullYear()+1,0,1),oe=$.getDay();oe=oe>=0?oe:oe+7,B=oe<4?1:53}}else B=Math.floor((R+U-L-1)/7);return B}l.getWeekOfYear=ae})(se||(se={}));var Rn=/^(.*?):[ \t]*([^\r\n]*)$/gm,Bn="GET",Zi=function(){function l(t,e,i,r){this.mode=!0,this.emitError=!0,this.options={},typeof t=="string"?(this.url=t,this.type=e?e.toUpperCase():Bn,this.mode=d(i)?!0:i):typeof t=="object"&&(this.options=t,mi(this,this.options)),this.type=this.type?this.type.toUpperCase():Bn,this.contentType=this.contentType!==void 0?this.contentType:r}return l.prototype.send=function(t){var e=this;this.data=d(t)?this.data:t;var i={cancel:!1,httpRequest:null},r=new Promise(function(o,a){e.httpRequest=new XMLHttpRequest,e.httpRequest.onreadystatechange=function(){e.stateChange(o,a)},d(e.onLoad)||(e.httpRequest.onload=e.onLoad),d(e.onProgress)||(e.httpRequest.onprogress=e.onProgress),d(e.onAbort)||(e.httpRequest.onabort=e.onAbort),d(e.onError)||(e.httpRequest.onerror=e.onError),d(e.onUploadProgress)||(e.httpRequest.upload.onprogress=e.onUploadProgress),e.httpRequest.open(e.type,e.url,e.mode),!d(e.data)&&e.contentType!==null&&e.httpRequest.setRequestHeader("Content-Type",e.contentType||"application/json; charset=utf-8"),e.beforeSend&&(i.httpRequest=e.httpRequest,e.beforeSend(i)),i.cancel||e.httpRequest.send(d(e.data)?null:e.data)});return r},l.prototype.successHandler=function(t){return this.onSuccess&&this.onSuccess(t,this),t},l.prototype.failureHandler=function(t){return this.onFailure&&this.onFailure(this.httpRequest),t},l.prototype.stateChange=function(t,e){var i=this.httpRequest.responseText;if(this.dataType&&this.dataType.toLowerCase()==="json")if(i==="")i=void 0;else try{i=JSON.parse(i)}catch{}this.httpRequest.readyState===4&&(this.httpRequest.status>=200&&this.httpRequest.status<=299||this.httpRequest.status===304?t(this.successHandler(i)):this.emitError?e(new Error(this.failureHandler(this.httpRequest.statusText))):t())},l.prototype.getResponseHeader=function(t){for(var e={},i=Rn.exec(this.httpRequest.getAllResponseHeaders());i;)e[i[1].toLowerCase()]=i[2],i=Rn.exec(this.httpRequest.getAllResponseHeaders());var r=e[t.toLowerCase()];return d(r)?null:r},l}(),Jy=function(){function l(t,e,i){this.type="GET",this.emitError=!0,typeof t=="string"?(this.url=t,this.type=d(e)?this.type:e.toUpperCase(),this.contentType=i):yi(t)&&Object.keys(t).length>0&&mi(this,t),this.contentType=d(this.contentType)?"application/json; charset=utf-8":this.contentType}return l.prototype.send=function(t){var e=this,i={"application/json":"json","multipart/form-data":"formData","application/octet-stream":"blob","application/x-www-form-urlencoded":"formData"};try{d(this.fetchRequest)&&this.type==="GET"?this.fetchRequest=new Request(this.url,{method:this.type}):d(this.fetchRequest)&&(this.data=d(t)?this.data:t,this.fetchRequest=new Request(this.url,{method:this.type,headers:{"Content-Type":this.contentType},body:this.data}));var r={cancel:!1,fetchRequest:this.fetchRequest};return this.triggerEvent(this.beforeSend,r),r.cancel?null:(this.fetchResponse=fetch(this.fetchRequest),this.fetchResponse.then(function(o){if(e.triggerEvent(e.onLoad,o),!o.ok)throw o;for(var a="text",n=0,s=Object.keys(i);n<s.length;n++){var h=s[n];o.headers.get("Content-Type")&&o.headers.get("Content-Type").indexOf(h)!==-1&&(a=i[h])}return o[a]()}).then(function(o){return e.triggerEvent(e.onSuccess,o,e),o}).catch(function(o){var a={};return e.emitError&&(e.triggerEvent(e.onFailure,o),a=Promise.reject(o)),a}))}catch(o){return o}},l.prototype.triggerEvent=function(t,e,i){!d(t)&&typeof t=="function"&&t(e,i)},l}(),Cd=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i,Md=/msie|trident/i,bd=/Trident\/7\./,jd=/(ipad|iphone|ipod touch)/i,Id=/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i,Td=/android/i,Sd=/trident|windows phone|edge/i,Nd=/(version)[ /]([\w.]+)/i,Fo={OPERA:/(opera|opr)(?:.*version|)[ /]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ /]([\w.]+)/i,CHROME:/(chrome|crios)[ /]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ /]([\w.]+)/i,SAFARI:/(safari)[ /]([\w.]+)/i,WEBKIT:/(webkit)[ /]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};typeof window<"u"&&(window.browserDetails=window.browserDetails||{});var S=function(){function l(){}return l.extractBrowserDetail=function(){for(var t={culture:{}},e=Object.keys(Fo),i=[],r=0,o=e;r<o.length;r++){var a=o[r];if(i=l.userAgent.match(Fo[""+a]),i){if(t.name=i[1].toLowerCase()==="opr"?"opera":i[1].toLowerCase(),t.name=i[1].toLowerCase()==="crios"?"chrome":t.name,t.version=i[2],t.culture.name=t.culture.language=navigator.language,l.userAgent.match(bd)){t.name="msie";break}var n=l.userAgent.match(Nd);t.name==="safari"&&n&&(t.version=n[2]);break}}return t},l.getEvent=function(t){var e={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return l.isPointer?e[""+t].isPointer:l.isTouch?e[""+t].isTouch+(l.isDevice?"":" "+e[""+t].isDevice):e[""+t].isDevice},l.getTouchStartEvent=function(){return l.getEvent("start")},l.getTouchEndEvent=function(){return l.getEvent("end")},l.getTouchMoveEvent=function(){return l.getEvent("move")},l.getTouchCancelEvent=function(){return l.getEvent("cancel")},l.isSafari=function(){return l.isDevice&&l.isIos&&l.isTouch&&typeof window<"u"&&window.navigator.userAgent.toLowerCase().indexOf("iphone")===-1&&window.navigator.userAgent.toLowerCase().indexOf("safari")>-1},l.getValue=function(t,e){var i=typeof window<"u"?window.browserDetails:{};return typeof navigator<"u"&&navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1&&l.isTouch===!0&&!Fo.CHROME.test(navigator.userAgent)&&(i.isIos=!0,i.isDevice=!0,i.isTouch=!0,i.isPointer=!0,i.isPointer="pointerEnabled"in window.navigator),typeof window<"u"&&window.Capacitor&&window.Capacitor.getPlatform()==="ios"&&(i.isPointer=!1),typeof i[""+t]>"u"?i[""+t]=e.test(l.userAgent):i[""+t]},Object.defineProperty(l,"userAgent",{get:function(){return l.uA},set:function(t){l.uA=t,window.browserDetails={}},enumerable:!0,configurable:!0}),Object.defineProperty(l,"info",{get:function(){return ue(window.browserDetails.info)?window.browserDetails.info=l.extractBrowserDetail():window.browserDetails.info},enumerable:!0,configurable:!0}),Object.defineProperty(l,"isIE",{get:function(){return l.getValue("isIE",Md)},enumerable:!0,configurable:!0}),Object.defineProperty(l,"isTouch",{get:function(){return ue(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window.navigator||window&&window.navigator&&window.navigator.maxTouchPoints>0||"ontouchstart"in window:window.browserDetails.isTouch},enumerable:!0,configurable:!0}),Object.defineProperty(l,"isPointer",{get:function(){return ue(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer},enumerable:!0,configurable:!0}),Object.defineProperty(l,"isMSPointer",{get:function(){return ue(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer},enumerable:!0,configurable:!0}),Object.defineProperty(l,"isDevice",{get:function(){return l.getValue("isDevice",Cd)},enumerable:!0,configurable:!0}),Object.defineProperty(l,"isIos",{get:function(){return l.getValue("isIos",jd)},enumerable:!0,configurable:!0}),Object.defineProperty(l,"isIos7",{get:function(){return l.getValue("isIos7",Id)},enumerable:!0,configurable:!0}),Object.defineProperty(l,"isAndroid",{get:function(){return l.getValue("isAndroid",Td)},enumerable:!0,configurable:!0}),Object.defineProperty(l,"isWebView",{get:function(){return ue(window.browserDetails.isWebView)&&(window.browserDetails.isWebView=!(ue(window.cordova)&&ue(window.PhoneGap)&&ue(window.phonegap)&&window.forge!=="object")),window.browserDetails.isWebView},enumerable:!0,configurable:!0}),Object.defineProperty(l,"isWindows",{get:function(){return l.getValue("isWindows",Sd)},enumerable:!0,configurable:!0}),Object.defineProperty(l,"touchStartEvent",{get:function(){return ue(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=l.getTouchStartEvent():window.browserDetails.touchStartEvent},enumerable:!0,configurable:!0}),Object.defineProperty(l,"touchMoveEvent",{get:function(){return ue(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=l.getTouchMoveEvent():window.browserDetails.touchMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(l,"touchEndEvent",{get:function(){return ue(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=l.getTouchEndEvent():window.browserDetails.touchEndEvent},enumerable:!0,configurable:!0}),Object.defineProperty(l,"touchCancelEvent",{get:function(){return ue(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=l.getTouchCancelEvent():window.browserDetails.touchCancelEvent},enumerable:!0,configurable:!0}),l.uA=typeof navigator<"u"?navigator.userAgent:"",l}(),b=function(){function l(){}return l.addOrGetEventData=function(t){return"__eventList"in t?t.__eventList.events:(t.__eventList={},t.__eventList.events=[])},l.add=function(t,e,i,r,o){var a=l.addOrGetEventData(t),n;o?n=ud(i,o):n=i,r&&(n=n.bind(r));for(var s=e.split(" "),h=0;h<s.length;h++)a.push({name:s[parseInt(h.toString(),10)],listener:i,debounce:n}),S.isIE?t.addEventListener(s[parseInt(h.toString(),10)],n):t.addEventListener(s[parseInt(h.toString(),10)],n,{passive:!1});return n},l.remove=function(t,e,i){for(var r=l.addOrGetEventData(t),o=e.split(" "),a=function(s){var h=-1,p;r&&r.length!==0&&r.some(function(u,c){return u.name===o[parseInt(s.toString(),10)]&&u.listener===i?(h=c,p=u.debounce,!0):!1}),h!==-1&&r.splice(h,1),p&&t.removeEventListener(o[parseInt(s.toString(),10)],p)},n=0;n<o.length;n++)a(n)},l.clearEvents=function(t){for(var e=l.addOrGetEventData(t),i=y([],void 0,e),r=0;r<i.length;r++){var o=i[parseInt(r.toString(),10)];t.removeEventListener(o.name,o.debounce),e.shift()}},l.trigger=function(t,e,i){for(var r=l.addOrGetEventData(t),o=0,a=r;o<a.length;o++){var n=a[o];n.name===e&&n.debounce.call(this,i)}},l}(),Ua=function(){return Ua=Object.assign||function(l){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(l[r]=t[r])}return l},Ua.apply(this,arguments)},Dd=/^svg|^path|^g/;function Ie(l,t){var e=Dd.test(l)?document.createElementNS("http://www.w3.org/2000/svg",l):document.createElement(l);return typeof t>"u"||(e.innerHTML=t.innerHTML?t.innerHTML:"",t.className!==void 0&&(e.className=t.className),t.id!==void 0&&(e.id=t.id),t.styles!==void 0&&(e.style.cssText=t.styles),t.attrs!==void 0&&ge(e,t.attrs)),e}function Ky(l,t){var e=l.style.cssText.split(";").reduce(function(o,a){var n=a.split(":"),s=n[0],h=n[1];return s&&h&&(o[s.trim()]=h.trim()),o},{}),i=t.split(";").reduce(function(o,a){var n=a.split(":"),s=n[0],h=n[1];return s&&h&&(o[s.trim()]=h.trim()),o},{}),r=document.createElement("div");Object.keys(Ua({},e,i)).forEach(function(o){r.style.setProperty(o,i[o]||e[o])}),l.style.cssText=r.style.cssText}function W(l,t){for(var e=Gl(t),i=RegExp,r=0,o=l;r<o.length;r++)for(var a=o[r],n=0,s=e;n<s.length;n++){var h=s[n];if(yi(a)){var p=Z("attributes.className",a);d(p)?Ae("attributes.className",h,a):new i("\\b"+h+"\\b","i").test(p)||Ae("attributes.className",p+" "+h,a)}else a.classList.contains(h)||a.classList.add(h)}return l}function G(l,t){for(var e=Gl(t),i=0,r=l;i<r.length;i++){var o=r[i],a=yi(o),n=a?Z("attributes.className",o):o.className!=="";if(n)for(var s=0,h=e;s<h.length;s++){var p=h[s];if(a){var u=Z("attributes.className",o),c=u.split(" "),f=c.indexOf(p);f!==-1&&c.splice(f,1),Ae("attributes.className",c.join(" "),o)}else o.classList.remove(p)}}return l}function Gl(l){var t=[];return typeof l=="string"?t.push(l):t=l,t}function st(l){var t=l;return t.style.visibility===""&&t.offsetWidth>0}function Hn(l,t,e){for(var i=document.createDocumentFragment(),r=0,o=l;r<o.length;r++){var a=o[r];i.appendChild(a)}return t.insertBefore(i,t.firstElementChild),e&&Jl(t),l}function Qi(l,t,e){var i=document.createDocumentFragment();if(l instanceof NodeList)for(;l.length>0;)i.appendChild(l[0]);else for(var r=0,o=l;r<o.length;r++){var a=o[r];i.appendChild(a)}return t.appendChild(i),e&&Jl(t),l}function Jl(l){var t=l.querySelectorAll("script");t.forEach(function(e){var i=document.createElement("script");i.text=e.innerHTML,document.head.appendChild(i),X(i)})}function X(l){var t=l.parentNode;if(t)return t.removeChild(l)}function it(l){var t=l.parentNode;b.clearEvents(l),t.removeChild(l)}function ge(l,t){for(var e=Object.keys(t),i=l,r=0,o=e;r<o.length;r++){var a=o[r];if(yi(i)){var n=a;a==="tabindex"&&(n="tabIndex"),i.attributes[""+n]=t[""+a]}else i.setAttribute(a,t[""+a])}return i}function te(l,t,e){return t===void 0&&(t=document),l=Kl(l),t.querySelector(l)}function me(l,t,e){t===void 0&&(t=document),l=Kl(l);var i=t.querySelectorAll(l);return i}function Kl(l){var t=/(!|"|\$|%|&|'|\(|\)|\*|\/|:|;|<|=|\?|@|\]|\^|`|{|}|\||\+|~)/g;if(l.match(/#[0-9]/g)||l.match(t)){for(var e=l.split(","),i=0;i<e.length;i++){for(var r=e[parseInt(i.toString(),10)].split(" "),o=0;o<r.length;o++)if(r[parseInt(o.toString(),10)].indexOf("#")>-1&&!r[parseInt(o.toString(),10)].match(/\[.*\]/)){var a=r[parseInt(o.toString(),10)].split("#");if(a[1].match(/^\d/)||a[1].match(t)){var n=r[parseInt(o.toString(),10)].split(".");n[0]=n[0].replace(/#/,"[id='")+"']",r[parseInt(o.toString(),10)]=n.join(".")}}e[parseInt(i.toString(),10)]=r.join(" ")}return e.join(",")}return l}function ce(l,t){var e=l;if(typeof e.closest=="function")return e.closest(t);for(;e&&e.nodeType===1;){if($l(e,t))return e;e=e.parentNode}return null}function de(l,t){t!==void 0&&Object.keys(t).forEach(function(e){l.style[""+e]=t[""+e]})}function lt(l,t,e){W([l],t),G([l],e)}function $l(l,t){var e=l.matches||l.msMatchesSelector||l.webkitMatchesSelector;return e?e.call(l,t):[].indexOf.call(document.querySelectorAll(t),l)!==-1}var Co=function(){function l(t){this.ranArray=[],this.boundedEvents={},!d(t)&&(this.context=t)}return l.prototype.on=function(t,e,i,r){if(!d(e)){var o=i||this.context;if(this.notExist(t)){this.boundedEvents[""+t]=[{handler:e,context:o,id:r}];return}d(r)?this.isHandlerPresent(this.boundedEvents[""+t],e)||this.boundedEvents[""+t].push({handler:e,context:o}):this.ranArray.indexOf(r)===-1&&(this.ranArray.push(r),this.boundedEvents[""+t].push({handler:e,context:o,id:r}))}},l.prototype.off=function(t,e,i){if(!this.notExist(t)){var r=Z(t,this.boundedEvents);if(e){for(var o=0;o<r.length;o++)if(i){if(r[parseInt(o.toString(),10)].id===i){r.splice(o,1);var a=this.ranArray.indexOf(i);a!==-1&&this.ranArray.splice(a,1);break}}else if(e===r[parseInt(o.toString(),10)].handler){r.splice(o,1);break}}else delete this.boundedEvents[""+t]}},l.prototype.notify=function(t,e,i,r){if(this.notExist(t)){i&&i.call(this,e);return}e&&(e.name=t);var o="Blazor",a=Z(t,this.boundedEvents).slice(0);if(window[""+o])return this.blazorCallback(a,e,i,r,0);for(var n=0,s=a;n<s.length;n++){var h=s[n];h.handler.call(h.context,e)}i&&i.call(this,e)},l.prototype.blazorCallback=function(t,e,i,r,o){var a=this,n=o===t.length-1;if(o<t.length){var s=t[parseInt(o.toString(),10)],h=s.handler.call(s.context,e);if(h&&typeof h.then=="function"){if(!i)return h;h.then(function(p){if(p=typeof p=="string"&&a.isJson(p)?JSON.parse(p,a.dateReviver):p,y(e,e,p,!0),i&&n)i.call(s.context,e);else return a.blazorCallback(t,e,i,r,o+1)}).catch(function(p){r&&r.call(s.context,typeof p=="string"&&a.isJson(p)?JSON.parse(p,a.dateReviver):p)})}else if(i&&n)i.call(s.context,e);else return this.blazorCallback(t,e,i,r,o+1)}},l.prototype.dateReviver=function(t,e){var i=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/;return typeof e=="string"&&e.match(i)!==null?new Date(e):e},l.prototype.isJson=function(t){try{JSON.parse(t)}catch{return!1}return!0},l.prototype.destroy=function(){this.boundedEvents=this.context=void 0},l.prototype.offIntlEvents=function(){var t=this.boundedEvents.notifyExternalChange;if(t){for(var e=0;e<t.length;e++){var i=t[parseInt(e.toString(),10)].context;i&&i.detectFunction&&i.randomId&&i.isReactMock&&(this.off("notifyExternalChange",i.detectFunction,i.randomId),e--)}this.boundedEvents.notifyExternalChange.length||delete this.boundedEvents.notifyExternalChange}},l.prototype.notExist=function(t){return Object.prototype.hasOwnProperty.call(this.boundedEvents,t)===!1||this.boundedEvents[""+t].length<=0},l.prototype.isHandlerPresent=function(t,e){for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.handler===e)return!0}return!1},l}(),wd=new RegExp("]"),Ci=function(){function l(t,e){this.isRendered=!1,this.isComplexArraySetter=!1,this.isServerRendered=!1,this.allowServerDataBinding=!0,this.isProtectedOnChange=!0,this.properties={},this.changedProperties={},this.oldProperties={},this.bulkChanges={},this.refreshing=!1,this.ignoreCollectionWatch=!1,this.finalUpdate=function(){},this.childChangedProperties={},this.modelObserver=new Co(this),ue(e)||(typeof e=="string"?this.element=document.querySelector(e):this.element=e,d(this.element)||(this.isProtectedOnChange=!1,this.addInstance())),ue(t)||this.setProperties(t,!0),this.isDestroyed=!1}return l.prototype.setProperties=function(t,e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!!e,mi(this,t),e!==!0&&(mi(this.changedProperties,t),this.dataBind()),this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.isProtectedOnChange=i},l.callChildDataBind=function(t,e){for(var i=Object.keys(t),r=0,o=i;r<o.length;r++){var a=o[r];if(e[""+a]instanceof Array)for(var n=0,s=e[""+a];n<s.length;n++){var h=s[n];h.dataBind!==void 0&&h.dataBind()}else e[""+a].dataBind()}},l.prototype.clearChanges=function(){this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.childChangedProperties={}},l.prototype.dataBind=function(){if(l.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){var t=this.isProtectedOnChange,e=this.changedProperties,i=this.oldProperties;this.clearChanges(),this.isProtectedOnChange=!0,this.onPropertyChanged(e,i),this.isProtectedOnChange=t}},l.prototype.serverDataBind=function(t){},l.prototype.saveChanges=function(t,e,i){this.isProtectedOnChange||(this.oldProperties[""+t]=i,this.changedProperties[""+t]=e,this.finalUpdate(),this.finalUpdate=pd(this.dataBind.bind(this)))},l.prototype.addEventListener=function(t,e){this.modelObserver.on(t,e)},l.prototype.removeEventListener=function(t,e){this.modelObserver.off(t,e)},l.prototype.trigger=function(t,e,i,r){var o=this;if(this.isDestroyed!==!0){var a=this.isProtectedOnChange;this.isProtectedOnChange=!1;var n=this.modelObserver.notify(t,e,i,r);if(wd.test(t)){var s=Z(t,this);if(s){var h="Blazor";if(window[""+h]){var p=s.call(this,e);p&&typeof p.then=="function"?i?p.then(function(u){i&&(u=typeof u=="string"&&o.modelObserver.isJson(u)?JSON.parse(u):u,i.call(o,u))}).catch(function(u){r&&(u=typeof u=="string"&&o.modelObserver.isJson(u)?JSON.parse(u):u,r.call(o,u))}):n=p:i&&i.call(this,e)}else s.call(this,e),i&&i.call(this,e)}else i&&i.call(this,e)}return this.isProtectedOnChange=a,n}},l.prototype.addInstance=function(){var t="e-"+this.getModuleName().toLowerCase();W([this.element],["e-lib",t]),d(this.element.ej2_instances)?Ae("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)},l.prototype.destroy=function(){var t=this;this.element.ej2_instances=this.element.ej2_instances?this.element.ej2_instances.filter(function(e){return co?co(e)!==co(t):e!==t}):[],G([this.element],["e-"+this.getModuleName()]),this.element.ej2_instances.length===0&&G([this.element],["e-lib"]),this.clearChanges(),this.modelObserver.destroy(),this.isDestroyed=!0},l}();function Q(l,t){var e,i,r=typeof l=="string"?document.getElementById(l):l;if(r&&r.ej2_instances){for(i=0;i<r.ej2_instances.length;i++)if(e=r.ej2_instances[parseInt(i.toString(),10)],typeof t=="string"){var o=e.getModuleName();if(t===o)return e}else if(e instanceof t)return e}}var co,Od=function(l){co=l};function eh(l,t,e,i){return(!Object.prototype.hasOwnProperty.call(l.properties,t)||!(l.properties[""+t]instanceof i))&&(l.properties[""+t]=mo(i,[l,t,e])),l.properties[""+t]}function Ra(l,t,e,i,r,o){for(var a=[],n=e?e.length:0,s=0;s<n;s++){var h=i;if(r){var p=mo(h,[l,t,{},!0]);p.setProperties(e[parseInt(s.toString(),10)],!0),a.push(p)}else a.push(mo(h,[l,t,e[parseInt(s.toString(),10)],!1]))}return a}function th(l,t){return function(){return Object.prototype.hasOwnProperty.call(this.properties,t)||(this.properties[""+t]=l),this.properties[""+t]}}function xd(l,t){return function(e){if(this.properties[""+t]!==e){var i=Object.prototype.hasOwnProperty.call(this.properties,t)?this.properties[""+t]:l;this.saveChanges(t,e,i),this.properties[""+t]=e}}}function Ad(l,t,e){return function(){return eh(this,t,l,e)}}function zd(l,t,e){return function(i){eh(this,t,l,e).setProperties(i)}}function Pd(l,t,e){return function(){var i=this;if(!Object.prototype.hasOwnProperty.call(this.properties,t)){var r=Ra(this,t,l,e,!1);this.properties[""+t]=r}var o=this.controlParent!==void 0&&this.controlParent.ignoreCollectionWatch||this.ignoreCollectionWatch;return!Object.prototype.hasOwnProperty.call(this.properties[""+t],"push")&&!o&&["push","pop"].forEach(function(a){var n={value:Ld(a,t,e,i.properties[""+t]).bind(i),configurable:!0};Object.defineProperty(i.properties[""+t],a,n)}),Object.prototype.hasOwnProperty.call(this.properties[""+t],"isComplexArray")||Object.defineProperty(this.properties[""+t],"isComplexArray",{value:!0}),this.properties[""+t]}}function Ed(l,t,e){return function(i){this.isComplexArraySetter=!0;var r=Ra(this,t,l,e,!1),o=Ra(this,t,i,e,!0);this.isComplexArraySetter=!1,this.saveChanges(t,o,r),this.properties[""+t]=o}}function Ld(l,t,e,i){return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var a=this.propName?this.getParentKey()+"."+t+"-":t+"-";switch(l){case"push":for(var n=0;n<r.length;n++){var s=r[parseInt(n.toString(),10)];Array.prototype[""+l].apply(i,[s]);var h=Qn(a+(i.length-1),s,!this.controlParent,l);this.serverDataBind(h,r[parseInt(n.toString(),10)],!1,l)}break;case"pop":{Array.prototype[""+l].apply(i);var h=Qn(a+i.length,null,!this.controlParent,l);this.serverDataBind(h,{ejsAction:"pop"},!1,l);break}}return i}}function Qn(l,t,e,i){var r=l;if(e&&(r={},r[""+l]=t,t&&typeof t=="object")){var o="ejsAction";r[""+l][""+o]=i}return r}function T(l){return function(t,e){var i={set:xd(l,e),get:th(l,e),enumerable:!0,configurable:!0};Object.defineProperty(t,e,i),xo(t,e,"prop",l)}}function Ke(l,t){return function(e,i){var r={set:zd(l,i,t),get:Ad(l,i,t),enumerable:!0,configurable:!0};Object.defineProperty(e,i,r),xo(e,i,"complexProp",l,t)}}function qi(l,t){return function(e,i){var r={set:Ed(l,i,t),get:Pd(l,i,t),enumerable:!0,configurable:!0};Object.defineProperty(e,i,r),xo(e,i,"colProp",l,t)}}function Y(){return function(l,t){var e={set:function(i){var r=this.properties[""+t];if(r!==i){var o=ih(this,t);ue(r)===!1&&o.context.removeEventListener(o.prefix,r),o.context.addEventListener(o.prefix,i),this.properties[""+t]=i}},get:th(void 0,t),enumerable:!0,configurable:!0};Object.defineProperty(l,t,e),xo(l,t,"event")}}function Qe(l){}function xo(l,t,e,i,r){ue(l.propList)&&(l.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]}),l.propList[e+"s"].push({propertyName:t,defaultValue:i,type:r}),l.propList[e+"Names"].push(t)}function ih(l,t){if(Object.prototype.hasOwnProperty.call(l,"parentObj")===!1)return{context:l,prefix:t};var e=Z("propName",l);return e&&(t=e+"-"+t),ih(Z("parentObj",l),t)}var kd=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Qt=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},ai=function(l){kd(t,l);function t(i){var r=l.call(this,i,void 0)||this;return r.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"},r}e=t,t.prototype.animate=function(i,r){r=r||{};var o=this.getModel(r);if(typeof i=="string")for(var a=Array.prototype.slice.call(me(i,document)),n=0,s=a;n<s.length;n++){var h=s[n];o.element=h,e.delayAnimation(o)}else o.element=i,e.delayAnimation(o)},t.stop=function(i,r){i.style.animation="",i.removeAttribute("e-animate");var o=i.getAttribute("e-animation-id");if(o){var a=parseInt(o,10);cancelAnimationFrame(a),i.removeAttribute("e-animation-id")}r&&r.end&&r.end.call(this,r)},t.delayAnimation=function(i){ni==="Disable"||ni===Ba.Disable?(i.begin&&i.begin.call(this,i),i.end&&i.end.call(this,i)):i.delay?setTimeout(function(){e.applyAnimation(i)},i.delay):e.applyAnimation(i)},t.applyAnimation=function(i){var r=this;i.timeStamp=0;var o=0,a=0,n=0,s=i.duration;i.element.setAttribute("e-animate","true");var h=function(p){try{if(p){n=n===0?p:n,i.timeStamp=p+i.timeStamp-n,n=p,!o&&i.begin&&i.begin.call(r,i),o=o+1;var u=i.timeStamp/o;i.timeStamp<s&&i.timeStamp+u<s&&i.element.getAttribute("e-animate")?(i.element.style.animation=i.name+" "+i.duration+"ms "+i.timingFunction,i.progress&&i.progress.call(r,i),requestAnimationFrame(h)):(cancelAnimationFrame(a),i.element.removeAttribute("e-animation-id"),i.element.removeAttribute("e-animate"),i.element.style.animation="",i.end&&i.end.call(r,i))}else a=requestAnimationFrame(h),i.element.setAttribute("e-animation-id",a.toString())}catch(c){cancelAnimationFrame(a),i.element.removeAttribute("e-animation-id"),i.fail&&i.fail.call(r,c)}};h()},t.prototype.getModel=function(i){return{name:i.name||this.name,delay:i.delay||this.delay,duration:i.duration!==void 0?i.duration:this.duration,begin:i.begin||this.begin,end:i.end||this.end,fail:i.fail||this.fail,progress:i.progress||this.progress,timingFunction:this.easing[i.timingFunction]?this.easing[i.timingFunction]:i.timingFunction||this.easing[this.timingFunction]}},t.prototype.onPropertyChanged=function(i,r){},t.prototype.getModuleName=function(){return"animation"},t.prototype.destroy=function(){};var e;return Qt([T("FadeIn")],t.prototype,"name",void 0),Qt([T(400)],t.prototype,"duration",void 0),Qt([T("ease")],t.prototype,"timingFunction",void 0),Qt([T(0)],t.prototype,"delay",void 0),Qt([Y()],t.prototype,"progress",void 0),Qt([Y()],t.prototype,"begin",void 0),Qt([Y()],t.prototype,"end",void 0),Qt([Y()],t.prototype,"fail",void 0),t=e=Qt([Qe],t),t}(Ci);function jr(l,t,e){var i=Yd(t);return i.rippleFlag===!1||i.rippleFlag===void 0?function(){}:(l.setAttribute("data-ripple","true"),b.add(l,"mousedown",Xn,{parent:l,rippleOptions:i}),b.add(l,"mouseup",Wn,{parent:l,rippleOptions:i,done:e}),b.add(l,"mouseleave",ki,{parent:l,rippleOptions:i}),S.isPointer&&b.add(l,"transitionend",ki,{parent:l,rippleOptions:i}),function(){l.removeAttribute("data-ripple"),b.remove(l,"mousedown",Xn),b.remove(l,"mouseup",Wn),b.remove(l,"mouseleave",ki),b.remove(l,"transitionend",ki)})}function Yd(l){var t={selector:l&&l.selector?l.selector:null,ignore:l&&l.ignore?l.ignore:null,rippleFlag:l&&l.rippleFlag,isCenterRipple:l&&l.isCenterRipple,duration:l&&l.duration?l.duration:350};return t}function Xn(l){var t=l.target,e=this.rippleOptions.selector,i=e?ce(t,e):t;if(!(!i||this.rippleOptions&&ce(t,this.rippleOptions.ignore))){var r=i.getBoundingClientRect(),o=l.pageX-document.body.scrollLeft,a=l.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),n=Math.max(Math.abs(o-r.left),Math.abs(o-r.right)),s=Math.max(Math.abs(a-r.top),Math.abs(a-r.bottom)),h=Math.sqrt(n*n+s*s),p=h*2+"px",u=o-r.left-h,c=a-r.top-h;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(u=0,c=0,p="100%"),i.classList.add("e-ripple");var f=this.rippleOptions.duration.toString(),g="width: "+p+";height: "+p+";left: "+u+"px;top: "+c+"px;transition-duration: "+f+"ms;",v=Ie("div",{className:"e-ripple-element",styles:g});i.appendChild(v),window.getComputedStyle(v).getPropertyValue("opacity"),v.style.transform="scale(1)",i!==this.parent&&b.add(i,"mouseleave",ki,{parent:this.parent,rippleOptions:this.rippleOptions})}}function Wn(l){rh(l,this)}function ki(l){rh(l,this)}function rh(l,t){var e=t.rippleOptions.duration,i=l.target,r=t.rippleOptions.selector,o=r?ce(i,r):i;if(!(!o||o&&o.className.indexOf("e-ripple")===-1)){var a=me(".e-ripple-element",o),n=a[a.length-1];n&&(n.style.opacity="0.5"),t.parent!==o&&b.remove(o,"mouseleave",ki),setTimeout(function(){n&&n.parentNode&&n.parentNode.removeChild(n),o.getElementsByClassName("e-ripple-element").length||o.classList.remove("e-ripple"),t.done&&t.done(l)},e)}}var ni,Ba;(function(l){l.Default="Default",l.Enable="Enable",l.Disable="Disable"})(Ba||(Ba={}));var Fd="Module",Ud=function(){function l(t){this.loadedModules=[],this.parent=t}return l.prototype.inject=function(t,e){var i=t.length;if(i===0){this.clean();return}this.loadedModules.length&&this.clearUnusedModule(t);for(var r=0;r<i;r++)for(var o=t[parseInt(r.toString(),10)],a=0,n=e;a<n.length;a++){var s=n[a],h=o.member;if(s&&s.prototype.getModuleName()===o.member&&!this.isModuleLoaded(h)){var p=mo(s,o.args),u=this.getMemberName(h);o.isProperty?Ae(u,s,this.parent):Ae(u,p,this.parent);var c=o;c.member=u,this.loadedModules.push(c)}}},l.prototype.clean=function(){for(var t=0,e=this.loadedModules;t<e.length;t++){var i=e[t];i.isProperty||Z(i.member,this.parent).destroy()}this.loadedModules=[]},l.prototype.getNonInjectedModules=function(t){var e=this;return t.filter(function(i){return!e.isModuleLoaded(i.member)})},l.prototype.clearUnusedModule=function(t){for(var e=this,i=t.map(function(s){return e.getMemberName(s.member)}),r=this.loadedModules.filter(function(s){return i.indexOf(s.member)===-1}),o=0,a=r;o<a.length;o++){var n=a[o];n.isProperty||Z(n.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(n),1),an(this.parent,n.member)}},l.prototype.getMemberName=function(t){return t[0].toLowerCase()+t.substring(1)+Fd},l.prototype.isModuleLoaded=function(t){for(var e=0,i=this.loadedModules;e<i.length;e++){var r=i[e];if(r.member===this.getMemberName(t))return!0}return!1},l}(),Be=function(){function l(t,e,i,r){this.isComplexArraySetter=!1,this.properties={},this.changedProperties={},this.childChangedProperties={},this.oldProperties={},this.finalUpdate=function(){},this.callChildDataBind=Z("callChildDataBind",Ci),this.parentObj=t,this.controlParent=this.parentObj.controlParent||this.parentObj,this.propName=e,this.isParentArray=r,this.setProperties(i,!0)}return l.prototype.updateChange=function(t,e){t===!0?this.parentObj.childChangedProperties[""+e]=t:delete this.parentObj.childChangedProperties[""+e],this.parentObj.updateChange&&this.parentObj.updateChange(t,this.parentObj.propName)},l.prototype.updateTimeOut=function(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{var t=setTimeout(this.parentObj.dataBind.bind(this.parentObj)),e=function(){clearTimeout(t)};this.finalUpdate=e}},l.prototype.clearChanges=function(){this.finalUpdate(),this.updateChange(!1,this.propName),this.oldProperties={},this.changedProperties={}},l.prototype.setProperties=function(t,e){e===!0?(mi(this,t),this.updateChange(!1,this.propName),this.clearChanges()):mi(this,t)},l.prototype.dataBind=function(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){var t=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(Ae(this.propName+"."+t,this.changedProperties,this.parentObj.changedProperties),Ae(this.propName+"."+t,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()},l.prototype.saveChanges=function(t,e,i,r){this.controlParent.isProtectedOnChange||(r||this.serverDataBind(t,e,!0),this.oldProperties[""+t]=i,this.changedProperties[""+t]=e,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())},l.prototype.serverDataBind=function(t,e,i,r){},l.prototype.getParentKey=function(t){var e="",i=this.propName;if(this.isParentArray){e=this.parentObj[this.propName].indexOf(this);var r=this.parentObj[this.propName].length;r=t?r:r>0?r-1:0,e=e!==-1?"-"+e:"-"+r,i=i+e}return this.controlParent!==this.parentObj&&(i=this.parentObj.getParentKey()+"."+this.propName+e),i},l}(),Ir;(function(l){var t=[28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990];function e(r){var o=r.getDate(),a=r.getMonth(),n=r.getFullYear(),s=a+1,h=n;s<3&&(h-=1,s+=12);var p=Math.floor(h/100),u=p-Math.floor(p/4)-2,c=Math.floor(365.25*(h+4716))+Math.floor(30.6001*(s+1))+o-u-1524;p=Math.floor((c-186721625e-2)/36524.25),u=p-Math.floor(p/4)+1;var f=c+u+1524,g=Math.floor((f-122.1)/365.25),v=Math.floor(365.25*g),m=Math.floor((f-v)/30.6001);o=f-v-Math.floor(30.6001*m),a=Math.floor((f-v)/20.6001),a>13&&(g+=1,a-=12),a-=1,n=g-4716;var C=c-24e5,M=10631/30,I=c-1948084,N=Math.floor(I/10631);I=I-10631*N;var O=Math.floor((I-.1335)/M),x=30*N+O;I=I-Math.floor(O*M+.1335);var D=Math.floor((I+28.5001)/29.5);D===13&&(D=12);for(var A=I-Math.floor(29.5001*D-29),P=0;P<t.length&&!(t[parseInt(P.toString(),10)]>C);P++);var V=P+16260,q=Math.floor((V-1)/12),re=q+1,ae=V-12*q,E=C-t[P-1]+1;return(E+"").length>2&&(E=A,ae=D,re=x),{year:re,month:ae,date:E}}l.getHijriDate=e;function i(r,o,a){var n=r,s=o,h=a,p=n-1,u=p*12+1+(s-1),c=u-16260,f=h+t[c-1]-1,g=f+24e5,v=Math.floor(g+.5),m=Math.floor((v-186721625e-2)/36524.25);m=v+1+m-Math.floor(m/4);var C=m+1524,M=Math.floor((C-122.1)/365.25),I=Math.floor(365.25*M),N=Math.floor((C-I)/30.6001),O=C-I-Math.floor(N*30.6001),x=N-(N>13.5?13:1),D=M-(x>2.5?4716:4715);return D<=0&&x--,new Date(D+"/"+x+"/"+O)}l.toGregorian=i})(Ir||(Ir={}));var Rd=/\/MMMMM|MMMM|MMM|a|LLLL|LLL|EEEEE|EEEE|E|K|cccc|ccc|WW|W|G+|z+/gi,Vn="stand-alone",Bd=["sun","mon","tue","wed","thu","fri","sat"],qn={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate",f:"getMilliseconds"},Hd={M:"month",d:"day",E:"weekday",c:"weekday",y:"year",m:"minute",h:"hour",H:"hour",s:"second",L:"month",a:"designator",z:"timeZone",Z:"timeZone",G:"era",f:"milliseconds"},Qd="timeSeparator",oh=function(){function l(){}return l.dateFormat=function(t,e,i){var r=this,o=se.getDependables(i,t,e.calendar);Z("parserObject.numbers",o);var a=o.dateObject,n={isIslamic:se.islamicRegex.test(e.calendar)};n.firstDayOfWeek=se.getWeekData(t,i);var s=e.format||se.getResultantPattern(e.skeleton,o.dateObject,e.type,!1,"");if(n.dateSeperator=se.getDateSeparator(o.dateObject),ue(s))mr("Format options or type given must be invalid");else{s=se.ConvertDateToWeekFormat(s),n.pattern=s,n.numMapper=Le.getNumberMapper(o.parserObject,Le.getNumberingSystem(i));for(var h=s.match(Rd)||[],p=0,u=h;p<u.length;p++){var c=u[p],f=c.length,g=c[0];switch(g==="K"&&(g="h"),g){case"E":case"c":n.weekday=o.dateObject[""+se.days][""+Vn][se.monthIndex[""+f]];break;case"M":case"L":n.month=o.dateObject[""+se.month][""+Vn][se.monthIndex[""+f]];break;case"a":n.designator=Z("dayPeriods.format.wide",a);break;case"G":{var v=f<=3?"eraAbbr":f===4?"eraNames":"eraNarrow";n.era=Z("eras."+v,o.dateObject);break}case"z":n.timeZone=Z("dates.timeZoneNames",o.parserObject);break}}}return function(m){return isNaN(m.getDate())?null:r.intDateFormatter(m,n)}},l.intDateFormatter=function(t,e){for(var i=e.pattern,r="",o=i.match(se.dateParseRegex),a=this.getCurrentDateValue(t,e.isIslamic),n=0,s=o;n<s.length;n++){var h=s[n],p=h.length,u=h[0];u==="K"&&(u="h");var c=void 0,f="",g=void 0,v=void 0,m="";switch(u){case"M":case"L":c=a.month,p>2?r+=e.month[""+c]:g=!0;break;case"E":case"c":r+=e.weekday[""+Bd[t.getDay()]];break;case"H":case"h":case"m":case"s":case"d":case"f":if(g=!0,u==="d")c=a.date;else if(u==="f"){g=!1,v=!0,f=t[""+qn[""+u]]().toString(),f=f.substring(0,p);var C=f.length;if(p!==C){if(p>3)continue;for(var M=0;M<p-C;M++)f="0"+f.toString()}m+=f}else c=t[""+qn[""+u]]();u==="h"&&(c=c%12||12);break;case"y":v=!0,m+=a.year,p===2&&(m=m.substr(m.length-2));break;case"a":{var I=t.getHours()<12?"am":"pm";r+=e.designator[""+I];break}case"G":{var N=t.getFullYear()<0?0:1,O=e.era[""+N];d(O)&&(O=e.era[N?0:1]),r+=O||"";break}case"'":r+=h==="''"?"'":h.replace(/'/g,"");break;case"z":{var x=t.getTimezoneOffset(),D=p<4?"+H;-H":e.timeZone.hourFormat;D=D.replace(/:/g,e.numMapper.timeSeparator),x===0?r+=e.timeZone.gmtZeroFormat:(v=!0,m=this.getTimeZoneValue(x,D)),m=e.timeZone.gmtFormat.replace(/\{0\}/,m);break}case":":r+=e.numMapper.numberSymbols[""+Qd];break;case"/":r+=e.dateSeperator;break;case"W":g=!0,c=se.getWeekOfYear(t,e.firstDayOfWeek);break;default:r+=h}g&&(v=!0,m=this.checkTwodigitNumber(c,p)),v&&(r+=Le.convertValueParts(m,se.latnParseRegex,e.numMapper.mapper))}return r},l.getCurrentDateValue=function(t,e){return e?Ir.getHijriDate(t):{year:t.getFullYear(),month:t.getMonth()+1,date:t.getDate()}},l.checkTwodigitNumber=function(t,e){var i=t+"";return e===2&&i.length!==2?"0"+i:i},l.getTimeZoneValue=function(t,e){var i=this,r=e.split(";"),o=r[t>0?1:0],a=Math.abs(t);return o=o.replace(/HH?|mm/g,function(n){var s=n.length,h=n.indexOf("H")!==-1;return i.checkTwodigitNumber(Math.floor(h?a/60:a%60),s)})},l}();md(oh);var _n={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},Xd="percentSign",Wd="minusSign",ji=["infinity","nan","group","decimal","exponential"],ah=function(){function l(){}return l.numberFormatter=function(t,e,i){var r=this,o=y({},e),a={},n={},s,h=se.getDependables(i,t,"",!0);h.numericObject,n.numberMapper=Le.getNumberMapper(h.parserObject,Le.getNumberingSystem(i),!0),n.currencySymbol=se.getCurrencySymbol(h.numericObject,o.currency||sn,e.altSymbol,e.ignoreCurrency),n.percentSymbol=n.numberMapper.numberSymbols[""+Xd],n.minusSymbol=n.numberMapper.numberSymbols[""+Wd];var p=n.numberMapper.numberSymbols;if(e.format&&!se.formatRegex.test(e.format))a=se.customFormat(e.format,n,h.numericObject),!ue(o.useGrouping)&&o.useGrouping&&(o.useGrouping=a.pData.useGrouping);else{y(o,se.getProperNumericSkeleton(e.format||"N")),o.isCurrency=o.type==="currency",o.isPercent=o.type==="percent",s=se.getSymbolPattern(o.type,n.numberMapper.numberSystem,h.numericObject,o.isAccount),o.groupOne=this.checkValueRange(o.maximumSignificantDigits,o.minimumSignificantDigits,!0),this.checkValueRange(o.maximumFractionDigits,o.minimumFractionDigits,!1,!0),ue(o.fractionDigits)||(o.minimumFractionDigits=o.maximumFractionDigits=o.fractionDigits),ue(o.useGrouping)&&(o.useGrouping=!0),o.isCurrency&&(s=s.replace(/\u00A4/g,se.defaultCurrency));{var u=s.split(";");a.nData=se.getFormatData(u[1]||"-"+u[0],!0,n.currencySymbol),a.pData=se.getFormatData(u[0],!1,n.currencySymbol),o.useGrouping&&(o.groupSeparator=p[ji[2]],o.groupData=this.getGroupingDetails(u[0]))}var c=ue(o.minimumFractionDigits);if(c&&(o.minimumFractionDigits=a.nData.minimumFraction),ue(o.maximumFractionDigits)){var f=a.nData.maximumFraction;o.maximumFractionDigits=ue(f)&&o.isPercent?0:f}var g=o.minimumFractionDigits,v=o.maximumFractionDigits;!ue(g)&&!ue(v)&&g>v&&(o.maximumFractionDigits=g)}return y(a.nData,o),y(a.pData,o),function(m){return isNaN(m)?p[ji[1]]:isFinite(m)?r.intNumberFormatter(m,a,n,e):p[ji[0]]}},l.getGroupingDetails=function(t){var e={},i=t.match(se.negativeDataRegex);if(i&&i[4]){var r=i[4],o=r.lastIndexOf(",");if(o!==-1){var a=r.split(".")[0];e.primary=a.length-o-1;var n=r.lastIndexOf(",",o-1);n!==-1&&(e.secondary=o-1-n)}}return e},l.checkValueRange=function(t,e,i,r){var o=r?"f":"s",a=0,n=_n["l"+o],s=_n["m"+o];if(ue(t)||(this.checkRange(t,n,r),a++),ue(e)||(this.checkRange(e,s,r),a++),a===2)if(t<e)mr(s+"specified must be less than the"+n);else return!0;else i&&a===1&&mr("Both"+s+"and"+s+"must be present");return!1},l.checkRange=function(t,e,i){var r=i?[0,20]:[1,21];(t<r[0]||t>r[1])&&mr(e+"value must be within the range"+r[0]+"to"+r[1])},l.intNumberFormatter=function(t,e,i,r){var o;if(!ue(e.nData.type)){t<0?(t=t*-1,o=e.nData):t===0?o=e.zeroData||e.pData:o=e.pData;var a="";if(o.isPercent&&(t=t*100),o.groupOne)a=this.processSignificantDigits(t,o.minimumSignificantDigits,o.maximumSignificantDigits);else if(a=this.processFraction(t,o.minimumFractionDigits,o.maximumFractionDigits,r),o.minimumIntegerDigits&&(a=this.processMinimumIntegers(a,o.minimumIntegerDigits)),i.isCustomFormat&&o.minimumFractionDigits<o.maximumFractionDigits&&/\d+\.\d+/.test(a)){for(var n=a.split("."),s=n[1],h=s.length,p=h-1;p>=0&&(s[parseInt(p.toString(),10)]==="0"&&p>=o.minimumFractionDigits);p--)s=s.slice(0,p);a=n[0]+"."+s}return o.type==="scientific"&&(a=t.toExponential(o.maximumFractionDigits),a=a.replace("e",i.numberMapper.numberSymbols[ji[4]])),a=a.replace(".",i.numberMapper.numberSymbols[ji[3]]),a=o.format==="#,###,,;(#,###,,)"?this.customPivotFormat(parseInt(a,10)):a,o.useGrouping&&(a=this.groupNumbers(a,o.groupData.primary,o.groupSeparator||",",i.numberMapper.numberSymbols[ji[3]]||".",o.groupData.secondary)),a=Le.convertValueParts(a,se.latnParseRegex,i.numberMapper.mapper),o.nlead==="N/A"?o.nlead:a==="0"&&r&&r.format==="0"?a+o.nend:o.nlead+a+o.nend}},l.processSignificantDigits=function(t,e,i){var r=t+"",o,a=r.length;return a<e?t.toPrecision(e):(r=t.toPrecision(i),o=+r,o+"")},l.groupNumbers=function(t,e,i,r,o){for(var a=!d(o)&&o!==0,n=t.split(r),s=n[0],h=s.length,p="";h>e;)p=s.slice(h-e,h)+(p.length?i+p:""),h-=e,a&&(e=o,a=!1);return n[0]=s.slice(0,h)+(p.length?i:"")+p,n.join(r)},l.processFraction=function(t,e,i,r){var o=(t+"").split(".")[1],a=o?o.length:0;if(e&&a<e){var n="";if(a===0)n=t.toFixed(e);else{n+=t;for(var s=0;s<e-a;s++)n+="0";return n}return t.toFixed(e)}else if(!d(i)&&(a>i||i===0))return t.toFixed(i);var h=t+"";return h[0]==="0"&&r&&r.format==="###.00"&&(h=h.slice(1)),h},l.processMinimumIntegers=function(t,e){var i=t.split("."),r=i[0],o=r.length;if(o<e){for(var a=0;a<e-o;a++)r="0"+r;i[0]=r}return i.join(".")},l.customPivotFormat=function(t){if(t>=5e5){t/=1e6;var e=t.toString().split(".");e[0];var i=e[1];return i&&+i.substring(0,1)>=5?Math.ceil(t).toString():Math.floor(t).toString()}return""},l}();yd(ah);var Zn="stand-alone",Vd=/^[0-9]*$/,Gn={minute:"setMinutes",hour:"setHours",second:"setSeconds",day:"setDate",month:"setMonth",milliseconds:"setMilliseconds"},qd="months",_d=function(){function l(){}return l.dateParser=function(t,e,i){var r=this,o=se.getDependables(i,t,e.calendar),a=Le.getCurrentNumericOptions(o.parserObject,Le.getNumberingSystem(i),!1,Hi()),n={},s=e.format||se.getResultantPattern(e.skeleton,o.dateObject,e.type,!1,""),h="",p;if(ue(s))mr("Format options or type given must be invalid");else{s=se.ConvertDateToWeekFormat(s),n={isIslamic:se.islamicRegex.test(e.calendar),pattern:s,evalposition:{},culture:t};for(var u=s.match(se.dateParseRegex)||[],c=u.length,f=0,g=0,v=!1,m=a.numericRegex,C=Le.getNumberMapper(o.parserObject,Le.getNumberingSystem(i)),M=0;M<c;M++){var I=u[parseInt(M.toString(),10)],N=I.length,O=I[0]==="K"?"h":I[0],x=void 0,D=void 0,A=Hd[""+O],P=N===2?"":"?";switch(v&&(f=g,v=!1),O){case"E":case"c":{var V=void 0;V=o.dateObject[""+se.days][""+Zn][se.monthIndex[""+N]];var q=Le.reverseObject(V);h+="("+Object.keys(q).join("|")+")";break}case"M":case"L":case"d":case"m":case"s":case"h":case"H":case"f":if(D=!0,(O==="M"||O==="L")&&N>2){var re=void 0;re=o.dateObject[""+qd][""+Zn][se.monthIndex[""+N]],n[""+A]=Le.reverseObject(re),h+="("+Object.keys(n[""+A]).join("|")+")"}else if(O==="f"){if(N>3)continue;x=!0,h+="("+m+m+"?"+m+"?)"}else x=!0,h+="("+m+m+P+")";O==="h"&&(n.hour12=!0);break;case"W":{var ae=N===1?"?":"";h+="("+m+ae+m+")";break}case"y":D=x=!0,N===2?h+="("+m+m+")":h+="("+m+"{"+N+",})";break;case"a":{D=!0;var E=Z("dayPeriods.format.wide",o.dateObject);n[""+A]=Le.reverseObject(E),h+="("+Object.keys(n[""+A]).join("|")+")";break}case"G":{D=!0;var L=N<=3?"eraAbbr":N===4?"eraNames":"eraNarrow";n[""+A]=Le.reverseObject(Z("eras."+L,o.dateObject)),h+="("+Object.keys(n[""+A]).join("|")+"?)";break}case"z":{var k=new Date().getTimezoneOffset();D=k!==0,n[""+A]=Z("dates.timeZoneNames",o.parserObject);var U=n[""+A];p=N<4;var B=p?"+H;-H":U.hourFormat;B=B.replace(/:/g,C.timeSeparator),h+="("+this.parseTimeZoneRegx(B,U,m)+")?",v=!0,g=p?6:12;break}case"'":{var R=I.replace(/'/g,"");h+="("+R+")?";break}default:h+="([\\D])";break}if(D&&(n.evalposition[""+A]={isNumber:x,pos:M+1+f,hourOnly:p}),M===c-1&&!d(h)){var $=RegExp;n.parserRegex=new $("^"+h+"$","i")}}}return function(oe){var he=r.internalDateParse(oe,n,a);if(d(he)||!Object.keys(he).length)return null;if(n.isIslamic){var pe={},Te=he.year,Pe=he.day,Ue=he.month,Se=Te?Te+"":"",Pt=Se.length===2;(!Te||!Ue||!Pe||Pt)&&(pe=Ir.getHijriDate(new Date)),Pt&&(Te=parseInt((pe.year+"").slice(0,2)+Se,10));var jt=Ir.toGregorian(Te||pe.year,Ue||pe.month,Pe||pe.date);he.year=jt.getFullYear(),he.month=jt.getMonth()+1,he.day=jt.getDate()}return r.getDateObject(he)}},l.getDateObject=function(t,e){var i=e||new Date;i.setMilliseconds(0);var r=["hour","minute","second","milliseconds","month","day"],o=t.year,a=t.designator,n=t.timeZone;if(!ue(o)){var s=(o+"").length;if(s<=2){var h=Math.floor(i.getFullYear()/100)*100;o+=h}i.setFullYear(o)}for(var p=0,u=r;p<u.length;p++){var c=u[p],f=t[""+c];if(ue(f)&&c==="day"&&i.setDate(1),!ue(f))if(c==="month"){if(f-=1,f<0||f>11)return new Date("invalid");var g=i.getDate();i.setDate(1),i[Gn[""+c]](f);var v=new Date(i.getFullYear(),f+1,0).getDate();i.setDate(g<v?g:v)}else{if(c==="day"){var m=new Date(i.getFullYear(),i.getMonth()+1,0).getDate();if(f<1||f>m)return null}i[""+Gn[""+c]](f)}}if(!ue(a)){var C=i.getHours();a==="pm"?i.setHours(C+(C===12?0:12)):C===12&&i.setHours(0)}if(!ue(n)){var M=n-i.getTimezoneOffset();M!==0&&i.setMinutes(i.getMinutes()+M)}return i},l.internalDateParse=function(t,e,i){var r=t.match(e.parserRegex),o={hour:0,minute:0,second:0};if(d(r))return null;for(var a=Object.keys(e.evalposition),n=0,s=a;n<s.length;n++){var h=s[n],p=e.evalposition[""+h],u=r[p.pos];if(p.isNumber)o[""+h]=this.internalNumberParser(u,i);else if(h==="timeZone"&&!ue(u)){var c=p.pos,f=void 0,g=r[c+1],v=!ue(g);p.hourOnly?f=this.getZoneValue(v,g,r[c+4],i)*60:(f=this.getZoneValue(v,g,r[c+7],i)*60,f+=this.getZoneValue(v,r[c+4],r[c+10],i)),d(f)||(o[""+h]=f)}else{var m=["en-US","en-MH","en-MP"];u=h==="month"&&!e.isIslamic&&(e.culture==="en"||e.culture==="en-GB"||e.culture==="en-US")?u[0].toUpperCase()+u.substring(1).toLowerCase():u,u=h!=="month"&&h==="designator"&&e.culture&&e.culture.indexOf("en-")!==-1&&m.indexOf(e.culture)===-1?u.toLowerCase():u,o[""+h]=e[""+h][""+u]}}return e.hour12&&(o.hour12=!0),o},l.internalNumberParser=function(t,e){return t=Le.convertValueParts(t,e.numberParseRegex,e.numericPair),Vd.test(t)?+t:null},l.parseTimeZoneRegx=function(t,e,i){var r=e.gmtFormat,o,a="("+i+")("+i+")";o=t.replace("+","\\+"),t.indexOf("HH")!==-1?o=o.replace(/HH|mm/g,"("+a+")"):o=o.replace(/H|m/g,"("+a+"?)");var n=o.split(";").map(function(s){return r.replace("{0}",s)});return o=n.join("|")+"|"+e.gmtZeroFormat,o},l.getZoneValue=function(t,e,i,r){var o=t?e:i;if(!o)return 0;var a=this.internalNumberParser(o,r);return t?-a:a},l}(),Zd=RegExp,Gd=new Zd("^([^0-9]*)(([0-9,]*[0-9]+)(.[0-9]+)?)([Ee][+-]?[0-9]+)?([^0-9]*)$"),Jd=/,/g,Kd=["minusSign","infinity"],$d=function(){function l(){}return l.numberParser=function(t,e,i){var r=this,o=se.getDependables(i,t,"",!0),a={custom:!0};se.formatRegex.test(e.format)||!e.format?(y(a,se.getProperNumericSkeleton(e.format||"N")),a.custom=!1,a.fractionDigits||e.maximumFractionDigits&&(a.maximumFractionDigits=e.maximumFractionDigits)):y(a,se.customFormat(e.format,null,null)),Z("numbers",o.parserObject);var n=Le.getCurrentNumericOptions(o.parserObject,Le.getNumberingSystem(i),!0,Hi());a.symbolRegex=Le.getSymbolRegex(Object.keys(n.symbolMatch)),a.infinity=n.symbolNumberSystem[Kd[1]];var s;if(s=se.getSymbolPattern(a.type,n.numberSystem,o.numericObject,a.isAccount),s){s=s.replace(/\u00A4/g,se.defaultCurrency);var h=s.split(";");a.nData=se.getFormatData(h[1]||"-"+h[0],!0,""),a.pData=se.getFormatData(h[0],!0,"")}return function(p){return r.getParsedNumber(p,a,n)}},l.getParsedNumber=function(t,e,i){var r,o,a,n,s,h;if(t.indexOf(e.infinity)!==-1)return 1/0;t=Le.convertValueParts(t,e.symbolRegex,i.symbolMatch),t=Le.convertValueParts(t,i.numberParseRegex,i.numericPair),t=t.indexOf("-")!==-1?t.replace("-.","-0."):t,t.indexOf(".")===0&&(t="0"+t);var p=t.match(Gd);if(d(p))return NaN;n=p[1],a=p[2];var u=p[5];return s=p[6],r=e.custom?n===e.nData.nlead&&s===e.nData.nend:n.indexOf(e.nData.nlead)!==-1&&s.indexOf(e.nData.nend)!==-1,o=r?e.nData.isPercent:e.pData.isPercent,a=a.replace(Jd,""),u&&(a+=u),h=+a,(e.type==="percent"||o)&&(h=h/100),(e.custom||e.fractionDigits)&&(h=parseFloat(h.toFixed(e.custom?r?e.nData.maximumFractionDigits:e.pData.maximumFractionDigits:e.fractionDigits))),e.maximumFractionDigits&&(h=this.convertMaxFracDigits(a,e,h,r)),r&&(h*=-1),h},l.convertMaxFracDigits=function(t,e,i,r){var o=t.split(".");return o[1]&&o[1].length>e.maximumFractionDigits&&(i=+i.toFixed(e.custom?r?e.nData.maximumFractionDigits:e.pData.maximumFractionDigits:e.maximumFractionDigits)),i},l}(),Jn=new Co,ef=!1,Rt={},ln="en-US",Ha=["numericObject","dateObject"],Mo=function(){function l(t){t&&(this.culture=t)}return l.prototype.getDateFormat=function(t){return oh.dateFormat(this.getCulture(),t||{type:"date",skeleton:"short"},Rt)},l.prototype.getNumberFormat=function(t){return t&&!t.currency&&(t.currency=sn),ah.numberFormatter(this.getCulture(),t||{},Rt)},l.prototype.getDateParser=function(t){return _d.dateParser(this.getCulture(),t||{skeleton:"short",type:"date"},Rt)},l.prototype.getNumberParser=function(t){return $d.numberParser(this.getCulture(),t||{format:"N"},Rt)},l.prototype.formatNumber=function(t,e){return this.getNumberFormat(e)(t)},l.prototype.formatDate=function(t,e){return this.getDateFormat(e)(t)},l.prototype.parseDate=function(t,e){return this.getDateParser(e)(t)},l.prototype.parseNumber=function(t,e){return this.getNumberParser(e)(t)},l.prototype.getDatePattern=function(t,e){return se.getActualDateTimeFormat(this.getCulture(),t,Rt,e)},l.prototype.getNumberPattern=function(t,e){return se.getActualNumberFormat(this.getCulture(),t,Rt,e)},l.prototype.getFirstDayOfWeek=function(){return se.getWeekData(this.getCulture(),Rt)},l.prototype.getCulture=function(){return this.culture||ln},l}();function Gi(l,t){var e=se.getDependables(Rt,l,"",!0)[Ha[0]],i=se.getDependables(Rt,l,"")[Ha[1]],r=Z("defaultNumberingSystem",e),o=Z("symbols-numberSystem-"+r,e),a=se.getSymbolPattern("decimal",r,e,!1);return y(o,se.getFormatData(a,!0,"",!0),{dateSeparator:se.getDateSeparator(i)})}function $y(l){return se.getDependables(Rt,"",l,!1)[Ha[1]]}var tf=["grid","pivotview","treegrid","spreadsheet","rangeNavigator","DocumentEditor","listbox","inplaceeditor","PdfViewer","richtexteditor","DashboardLayout","chart","stockChart","circulargauge","diagram","heatmap","lineargauge","maps","slider","smithchart","barcode","sparkline","treemap","bulletChart","kanban","daterangepicker","schedule","gantt","signature","query-builder","drop-down-tree","carousel","filemanager","uploader","accordion","tab","treeview"],Kn=[115,121,110,99,102,117,115,105,111,110,46,105,115,76,105,99,86,97,108,105,100,97,116,101,100],Qa,nh=function(){function l(t){this.isValidated=!1,this.isLicensed=!0,this.version="29",this.platform=/JavaScript|ASPNET|ASPNETCORE|ASPNETMVC|FileFormats|essentialstudio/i,this.errors={noLicense:"<span>This application was built using a trial version of Syncfusion<sup>®</sup> Essential Studio<sup>®</sup>. To remove the license validation message permanently, a valid license key must be included.</span>",trailExpired:"<span>This application was built using a trial version of Syncfusion<sup>®</sup> Essential Studio<sup>®</sup>. To remove the license validation message permanently, a valid license key must be included.</span>",versionMismatched:"<span>The included Syncfusion<sup>®</sup> license key is invalid.</span>",platformMismatched:"<span>The included Syncfusion<sup>®</sup> license key is invalid.</span>",invalidKey:"<span>The included Syncfusion<sup>®</sup> license key is invalid.</span>"},this.minVersion=null,this.manager=function(){var e=null;function i(o){e=o}function r(){return e}return{setKey:i,getKey:r}}(),this.npxManager=function(){var e="npxKeyReplace";function i(){return e}return{getKey:i}}(),this.manager.setKey(t)}return l.prototype.validate=function(){var t=[115,121,110,99,102,117,115,105,111,110,46,108,105,99,101,110,115,101,67,111,110,116,101,110,116],e=[115,121,110,99,102,117,115,105,111,110,46,99,108,97,105,109,65,99,99,111,117,110,116,85,82,76];if(!this.isValidated&&bi&&!Z(Yr(Kn),bi)&&!Z("Blazor",bi)){var i=void 0,r=void 0;if(this.manager&&this.manager.getKey()||this.npxManager&&this.npxManager.getKey()!=="npxKeyReplace"){var o=this.getInfoFromKey();if(o&&o.length)for(var a=0,n=o;a<n.length;a++){var s=n[a];if(!this.platform.test(s.platform)||s.invalidPlatform)i=this.errors.platformMismatched;else if(s.minVersion>=s.lastValue&&s.minVersion!==s.lastValue||s.lastValue<parseInt(this.version,10)?(i=this.errors.versionMismatched,i=i.replace("##LicenseVersion",s.version),i=i.replace("##Requireversion",this.version+".x")):(s.lastValue==null||isNaN(s.lastValue))&&(i=this.errors.versionMismatched,i=i.replace("##LicenseVersion",s.version),i=i.replace("##Requireversion",this.version+".x")),s.expiryDate){var h=new Date(s.expiryDate),p=new Date;if(h!==p&&h<p)i=this.errors.trailExpired;else break}}else i=this.errors.invalidKey}else{var u=Z(Yr(t),bi);r=Z(Yr(e),bi),u&&u!==""?i=u:i=this.errors.noLicense}if(i&&typeof document<"u"&&!d(document)){Qa=r&&r!==""?r:"https://www.syncfusion.com/account/claim-license-key?pl=SmF2YVNjcmlwdA==&vs=Mjk=&utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information";var c=Ie("div",{innerHTML:`<img src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzE5OV80KSI+CjxwYXRoIGQ9Ik0xMiAyMUMxNi45NzA2IDIxIDIxIDE2Ljk3MDYgMjEgMTJDMjEgNy4wMjk0NCAxNi45NzA2IDMgMTIgM0M3LjAyOTQ0IDMgMyA3LjAyOTQ0IDMgMTJDMyAxNi45NzA2IDcuMDI5NDQgMjEgMTIgMjFaIiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBmaWxsPSIjNjE2MDYzIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS44MTI1IDlDMTIuNDMzOCA5IDEyLjkzNzUgOC40OTYzMiAxMi45Mzc1IDcuODc1QzEyLjkzNzUgNy4yNTM2OCAxMi40MzM4IDYuNzUgMTEuODEyNSA2Ljc1QzExLjE5MTIgNi43NSAxMC42ODc1IDcuMjUzNjggMTAuNjg3NSA3Ljg3NUMxMC42ODc1IDguNDk2MzIgMTEuMTkxMiA5IDExLjgxMjUgOVoiIGZpbGw9IiM3MzczNzMiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xOTlfNCI+CjxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K' style="top: 6px;
                    position: absolute;
                    left: 16px;
                    width: 24px;
                    height: 24px;"/>`+i+' <a style="text-decoration: none;color: #0D6EFD;font-weight: 500;" href='+Qa+">Claim your free account</a>"});c.setAttribute("style",`position: fixed;
                top: 10px;
                left: 10px;
                right: 10px;
                font-size: 14px;
                background: #EEF2FF;
                color: #222222;
                z-index: 999999999;
                text-align: left;
                border: 1px solid #EEEEEE;
                padding: 10px 11px 10px 50px;
                border-radius: 8px;
                font-family: Helvetica Neue, Helvetica, Arial;`),document.body.appendChild(c),this.isLicensed=!1}this.isValidated=!0,Ae(Yr(Kn),this.isValidated,bi)}return this.isLicensed},l.prototype.getDecryptedData=function(t){try{return atob(t)}catch{return""}},l.prototype.getInfoFromKey=function(){try{var t="",e=[5439488,7929856,5111808,6488064,4587520,7667712,5439488,6881280,5177344,7208960,4194304,4456448,6619136,7733248,5242880,7077888,6356992,7602176,4587520,7274496,7471104,7143424],i=[],r=[],o=!1,a=!1;this.manager.getKey()?t=this.manager.getKey():(a=!0,t=this.npxManager.getKey().split("npxKeyReplace")[1]);for(var n=t.split(";"),s=0,h=n;s<h.length;s++){var p=h[s],u=this.getDecryptedData(p);if(u){var c=0,f="";if(a){for(var m=u[u.length-1],C=[],g=0;g<u.length;g++)C[parseInt(g.toString(),10)]=u[parseInt(g.toString(),10)].charCodeAt(0)-m.charCodeAt(0);for(var g=0;g<C.length;g++)f+=String.fromCharCode(C[parseInt(g.toString(),10)])}else for(var g=0;g<u.length;g++,c++){c===e.length&&(c=0);var v=u.charCodeAt(g);f+=String.fromCharCode(v^e[parseInt(c.toString(),10)]>>16)}if(this.platform.test(f)){if(i=f.split(";"),o=!1,i.length>3){var M=parseInt(i[1].split(".")[0],10),I=parseInt(i[4],10);r.push({platform:i[0],version:i[1],expiryDate:i[2],lastValue:I,minVersion:M})}}else f&&f.split(";").length>3&&(o=!0)}}return o&&!r.length?[{invalidPlatform:o}]:r.length?r:null}catch{return null}},l}(),sh=new nh;function Yr(l){for(var t="",e=0,i=l;e<i.length;e++){var r=i[e];t+=String.fromCharCode(r)}return t}function rf(l){sh=new nh(l)}var of=function(l){return sh.validate()},af=function(){var l=`
    <div style="
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 99999;
    ">
        <div style="
    background: #FFFFFF;
    height: 455px;
    width: 840px;
    font-family: Helvetica Neue, Helvetica, Arial;
    color: #000000;
    box-shadow: 0px 4.8px 14.4px rgb(0 0 0 / 18%), 0px 25.6px 57.6px rgb(0 0 0 / 22%);
    display: block;
    margin: 8% auto;
    border-radius: 20px;
    ">
            <div style="
    position: absolute;
width: 838px;
height: 62px;
background-color: #F9F9F9;
border: 1px solid #EEEEEE;
border-top-left-radius: 20px;
border-top-right-radius: 20px;
">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ2IiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTQ2IDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNNDAuNTk2NSAxNS4wMDc4SDMyLjQyNUMzMS41NTU3IDE1LjAwNzggMzAuOTAzNyAxNS4xODEyIDMwLjUxMjUgMTUuNDg0NkMzMC4xMjEzIDE1LjgzMTQgMjkuOTA0IDE2LjMwODIgMjkuOTA0IDE3LjA0NTFDMjkuOTA0IDE3LjYwODYgMzAuMDc3OCAxOC4wNDIxIDMwLjQyNTYgMTguMzAyMkMzMC43NzMzIDE4LjYwNTYgMzEuMjk0OSAxOC43MzU2IDMxLjk5MDMgMTguNzM1NkgzNi4zMzY5QzM4LjExODkgMTguNzM1NiAzOS40MjI5IDE5LjA4MjQgNDAuMTYxOCAxOS43MzI2QzQwLjk0NDIgMjAuNDI2MiA0MS4yOTE5IDIxLjU1MzIgNDEuMjkxOSAyMy4xMTM3QzQxLjI5MTkgMjQuNzE3NiA0MC44NTcyIDI1Ljg4OCAzOS45ODc5IDI2LjY2ODJDMzkuMTE4NiAyNy40MDUxIDM3LjcyNzcgMjcuNzk1MyAzNS44NTg3IDI3Ljc5NTNIMjcuMDc4N1YyNS4wMjFIMzUuMzM3MkMzNi4yOTM0IDI1LjAyMSAzNi45NDU0IDI0Ljg5MSAzNy4zMzY2IDI0LjYzMDlDMzcuNzI3NyAyNC4zNzA4IDM3LjkwMTYgMjMuODk0IDM3LjkwMTYgMjMuMjg3MUMzNy45MDE2IDIyLjYzNjkgMzcuNzI3NyAyMi4xNjAxIDM3LjM4IDIxLjlDMzcuMDMyMyAyMS42Mzk5IDM2LjQyMzggMjEuNDY2NSAzNS41NTQ1IDIxLjQ2NjVIMzEuNjQyNkMyOS44NjA1IDIxLjQ2NjUgMjguNTEzMSAyMS4xMTk4IDI3LjY4NzMgMjAuMzgyOEMyNi44NjE0IDE5LjY0NTkgMjYuNDI2OCAxOC41MTg5IDI2LjQyNjggMTcuMDAxN0MyNi40MjY4IDE1LjM1NDUgMjYuODYxNCAxNC4xNDA4IDI3LjczMDcgMTMuMzYwNkMyOC42IDEyLjU4MDMgMjkuOTkwOSAxMi4yMzM1IDMxLjkwMzQgMTIuMjMzNUg0MC41OTY1VjE1LjAwNzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik00OC4wNzI3IDI1LjI4MTFINTAuNTA2OFYxNi4zOTQ5SDUzLjU0OTNWMjcuNTM1MkM1My41NDkzIDI5LjA1MjQgNTMuMjAxNiAzMC4xNzk0IDUyLjUwNjIgMzAuOTE2M0M1MS44MTA3IDMxLjY1MzIgNTAuNzI0MSAzMiA0OS4yNDYzIDMySDQzLjMzNVYyOS42NTkySDQ4LjcyNDdDNDkuMjg5NyAyOS42NTkyIDQ5Ljc2NzkgMjkuNTI5MiA1MC4wNzIxIDI5LjIyNThDNTAuMzc2NCAyOC45NjU3IDUwLjU1MDIgMjguNTMyMiA1MC41NTAyIDI4LjAxMlYyNy44Mzg2SDQ3Ljg5ODlDNDYuMjAzNyAyNy44Mzg2IDQ0Ljk0MzIgMjcuNDkxOSA0NC4yNDc4IDI2Ljg0MTZDNDMuNTA4OSAyNi4xNDgxIDQzLjE2MTEgMjUuMDY0NCA0My4xNjExIDIzLjQ2MDVWMTYuMzk0OUg0Ni4xNjAyVjIzLjIwMDVDNDYuMTYwMiAyNC4wNjc0IDQ2LjI5MDYgMjQuNjMwOSA0Ni41NTE0IDI0Ljg5MUM0Ni43MjUzIDI1LjE1MTEgNDcuMjQ2OSAyNS4yODExIDQ4LjA3MjcgMjUuMjgxMVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTU1Ljg5NjUgMTYuMzk0OUg2MS41OTA0QzYzLjMyOTEgMTYuMzk0OSA2NC41NDYxIDE2LjY5ODMgNjUuMjg1IDE3LjM0ODVDNjYuMDIzOSAxNy45OTg4IDY2LjM3MTYgMTkuMDgyNCA2Ni4zNzE2IDIwLjU1NjNWMjcuNzk1M0g2My4zMjkxVjIwLjk0NjRDNjMuMzI5MSAyMC4wNzk0IDYzLjE5ODcgMTkuNTE1OSA2Mi45Mzc5IDE5LjI5OTJDNjIuNjc3MSAxOS4wMzkxIDYyLjE1NTUgMTguOTA5MSA2MS4zMjk3IDE4LjkwOTFINTguODk1NlYyNy44Mzg2SDU1Ljg1M1YxNi4zOTQ5SDU1Ljg5NjVaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03NC45MzQyIDI1LjM2NzhINzguMTUwNlYyNy43OTUySDc0LjAyMTRDNzIuOTc4MiAyNy43OTUyIDcyLjEwODkgMjcuNjY1MiA3MS40NTcgMjcuNDkxOEM3MC44MDUgMjcuMjc1IDcwLjE5NjUgMjYuOTI4MyA2OS43MTgzIDI2LjQ1MTRDNjkuMTk2OCAyNS45MzEzIDY4Ljc2MjEgMjUuMjgxMSA2OC40NTc4IDI0LjU0NDJDNjguMTUzNiAyMy44MDcyIDY4LjAyMzIgMjIuOTgzNiA2OC4wMjMyIDIyLjE2QzY4LjAyMzIgMjEuMjkzMSA2OC4xNTM2IDIwLjQ2OTUgNjguNDU3OCAxOS42ODkyQzY4Ljc2MjEgMTguOTA5IDY5LjE1MzMgMTguMzAyMSA2OS43MTgzIDE3Ljc4MTlDNzAuMjM5OSAxNy4zMDUxIDcwLjgwNSAxNi45NTgzIDcxLjUwMDQgMTYuNzQxNkM3Mi4xOTU5IDE2LjUyNDkgNzMuMDIxNyAxNi40MzgyIDc0LjA2NDkgMTYuNDM4Mkg3OC4xOTQxVjE4LjkwOUg3NC45MzQyQzczLjQ5OTggMTguOTA5IDcyLjU0MzYgMTkuMTY5MSA3MS45Nzg1IDE5LjY0NTlDNzEuNDU2OSAyMC4xMjI3IDcxLjE1MjcgMjAuOTg5NyA3MS4xNTI3IDIyLjIwMzRDNzEuMTUyNyAyMi44OTY5IDcxLjI4MzEgMjMuNDYwNSA3MS41MDA0IDIzLjkzNzNDNzEuNzE3NyAyNC40MTQxIDcyLjA2NTUgMjQuNzYwOSA3Mi41MDAxIDI1LjA2NDNDNzIuNzE3NCAyNS4xOTQ0IDcyLjk3ODIgMjUuMjgxMSA3My4yODI1IDI1LjM2NzhDNzMuNjMwMiAyNS4zMjQ0IDc0LjE1MTggMjUuMzY3OCA3NC45MzQyIDI1LjM2NzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik04MC44NDU2IDE4LjY0ODlINzguNjcyNFYxNi4zNTE1SDgwLjg0NTZWMTUuMTgxMUM4MC44NDU2IDE0LjAxMDggODEuMDYzIDEzLjIzMDUgODEuNDk3NiAxMi44NDA0QzgxLjkzMjMgMTIuNDUwMyA4Mi43NTgxIDEyLjIzMzUgODMuOTc1MSAxMi4yMzM1SDg2Ljg0MzhWMTQuNDAwOUg4NS40MDk1Qzg0Ljg4NzkgMTQuNDAwOSA4NC41NDAyIDE0LjQ4NzYgODQuMzIyOSAxNC42NjFDODQuMTA1NSAxNC44MzQ0IDgzLjk3NTEgMTUuMDk0NSA4My45NzUxIDE1LjQ0MTJWMTYuMzUxNUg4Ni44NDM4VjE4LjY0ODlIODMuOTc1MVYyNy43OTUzSDgwLjg0NTZWMTguNjQ4OVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTk4LjQwNTYgMjcuNzk1M0g5Mi43MTE2QzkxLjAxNjUgMjcuNzk1MyA4OS44NDI5IDI3LjQ0ODUgODkuMDYwNSAyNi43OTgzQzg4LjMyMTYgMjYuMTQ4MSA4Ny45MzA0IDI1LjA2NDQgODcuOTMwNCAyMy41OTA2VjE2LjM5NDlIOTAuOTI5NVYyMy40MTcyQzkwLjkyOTUgMjQuMTk3NCA5MS4wNTk5IDI0LjY3NDMgOTEuMzIwNyAyNC45MzQ0QzkxLjU4MTUgMjUuMTk0NCA5Mi4xMDMxIDI1LjMyNDUgOTIuOTI4OSAyNS4zMjQ1SDk1LjM2M1YxNi4zOTQ5SDk4LjQwNTZWMjcuNzk1M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTEwMC42MjIgMjUuNDExMkgxMDcuMDExQzEwNy41NzcgMjUuNDExMiAxMDguMDExIDI1LjMyNDUgMTA4LjI3MiAyNS4xNTExQzEwOC41MzMgMjQuOTc3NyAxMDguNjYzIDI0LjY3NDMgMTA4LjY2MyAyNC4zMjc1QzEwOC42NjMgMjMuOTM3NCAxMDguNTMzIDIzLjY3NzMgMTA4LjI3MiAyMy40NjA1QzEwOC4wMTEgMjMuMjg3MSAxMDcuNTc3IDIzLjIwMDUgMTA3LjA1NSAyMy4yMDA1SDEwNC40NDdDMTAyLjg4MiAyMy4yMDA1IDEwMS44MzkgMjIuOTgzNyAxMDEuMzE4IDIyLjUwNjlDMTAwLjc1MiAyMi4wMzAxIDEwMC40OTIgMjEuMjA2NSAxMDAuNDkyIDE5Ljk5MjdDMTAwLjQ5MiAxOC43NzkgMTAwLjgzOSAxNy44Njg3IDEwMS40OTEgMTcuMjYxOEMxMDIuMTQzIDE2LjY5ODMgMTAzLjE4NyAxNi4zOTQ5IDEwNC41MzQgMTYuMzk0OUgxMTEuMDU0VjE4Ljc3OUgxMDUuNzA4QzEwNC44MzggMTguNzc5IDEwNC4yNzMgMTguODY1NyAxMDQuMDEyIDE4Ljk5NTdDMTAzLjc1MiAxOS4xNjkxIDEwMy42MjEgMTkuNDI5MiAxMDMuNjIxIDE5LjgxOTRDMTAzLjYyMSAyMC4xNjYxIDEwMy43NTIgMjAuNDI2MiAxMDMuOTY5IDIwLjU5OTZDMTA0LjE4NiAyMC43NzMgMTA0LjU3NyAyMC44NTk3IDEwNS4wNTYgMjAuODU5N0gxMDcuNzk0QzEwOS4wNTQgMjAuODU5NyAxMTAuMDExIDIxLjE2MzEgMTEwLjY2MyAyMS43MjY2QzExMS4zMTUgMjIuMjkwMiAxMTEuNjYyIDIzLjE1NzEgMTExLjY2MiAyNC4yNDA4QzExMS42NjIgMjUuMjgxMSAxMTEuMzU4IDI2LjE0ODEgMTEwLjc5MyAyNi43OTgzQzExMC4yMjggMjcuNDQ4NSAxMDkuNDQ2IDI3Ljc5NTMgMTA4LjUzMyAyNy43OTUzSDEwMC43MDlWMjUuNDExMkgxMDAuNjIyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTE2LjU3NCAxNS4wOTQ0SDExMy40MDFWMTIuMjc2OUgxMTYuNTc0VjE1LjA5NDRaTTExNi41NzQgMjcuNzk1M0gxMTMuNDAxVjE2LjM5NDlIMTE2LjU3NFYyNy43OTUzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMwLjMwOSAyMi4xMTY3QzEzMC4zMDkgMjMuODkzOSAxMjkuNzQ0IDI1LjMyNDQgMTI4LjY1NyAyNi40MDgxQzEyNy41NzEgMjcuNDkxOCAxMjYuMDkzIDI4LjAxMiAxMjQuMjI0IDI4LjAxMkMxMjIuMzU1IDI4LjAxMiAxMjAuODc3IDI3LjQ5MTggMTE5Ljc5IDI2LjQwODFDMTE4LjcwNCAyNS4zMjQ0IDExOC4xMzkgMjMuODkzOSAxMTguMTM5IDIyLjExNjdDMTE4LjEzOSAyMC4zMzk0IDExOC43MDQgMTguOTA5IDExOS43OSAxNy44MjUzQzEyMC44NzcgMTYuNzQxNiAxMjIuMzk4IDE2LjIyMTQgMTI0LjIyNCAxNi4yMjE0QzEyNi4wNDkgMTYuMjIxNCAxMjcuNTI3IDE2Ljc0MTYgMTI4LjY1NyAxNy44MjUzQzEyOS43NDQgMTguODY1NiAxMzAuMzA5IDIwLjI5NjEgMTMwLjMwOSAyMi4xMTY3Wk0xMjEuMjY4IDIyLjExNjdDMTIxLjI2OCAyMy4yMDA0IDEyMS41MjkgMjQuMDY3MyAxMjIuMDUxIDI0LjY3NDJDMTIyLjU3MiAyNS4yODExIDEyMy4yNjggMjUuNTg0NSAxMjQuMTggMjUuNTg0NUMxMjUuMDkzIDI1LjU4NDUgMTI1Ljc4OSAyNS4yODExIDEyNi4zMSAyNC42NzQyQzEyNi44MzIgMjQuMDY3MyAxMjcuMDkzIDIzLjIwMDQgMTI3LjA5MyAyMi4xMTY3QzEyNy4wOTMgMjEuMDMzIDEyNi44MzIgMjAuMTY2MSAxMjYuMzEgMTkuNjAyNUMxMjUuNzg5IDE4Ljk5NTcgMTI1LjA5MyAxOC42OTIyIDEyNC4xMzcgMTguNjkyMkMxMjMuMjI0IDE4LjY5MjIgMTIyLjUyOSAxOC45OTU3IDEyMi4wMDcgMTkuNjAyNUMxMjEuNTI5IDIwLjE2NjEgMTIxLjI2OCAyMS4wMzMgMTIxLjI2OCAyMi4xMTY3WiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMxLjc4NyAxNi4zOTQ5SDEzNy40ODFDMTM5LjIxOSAxNi4zOTQ5IDE0MC40MzYgMTYuNjk4MyAxNDEuMTc1IDE3LjM0ODVDMTQxLjkxNCAxNy45OTg4IDE0Mi4yNjIgMTkuMDgyNCAxNDIuMjYyIDIwLjU1NjNWMjcuNzk1M0gxMzkuMjE5VjIwLjk0NjRDMTM5LjIxOSAyMC4wNzk0IDEzOS4wODkgMTkuNTE1OSAxMzguODI4IDE5LjI5OTJDMTM4LjU2NyAxOS4wMzkxIDEzOC4wNDYgMTguOTA5MSAxMzcuMjIgMTguOTA5MUgxMzQuNzg2VjI3LjgzODZIMTMxLjc0M1YxNi4zOTQ5SDEzMS43ODdaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDMuNzM3NDNIMFYxMC44NDY0SDcuMTI4MzFWMy43Mzc0M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTIzLjI1MTMgLTIuMTU3MjVlLTA1TDE4LjU1MTMgNS41MTY4NUwyNC4wODMxIDEwLjIwNDFMMjguNzgzMSA0LjY4NzI1TDIzLjI1MTMgLTIuMTU3MjVlLTA1WiIgZmlsbD0iI0ZGODYwMCIvPgo8cGF0aCBkPSJNMTUuNjA0MSAzLjczNzQzSDguNDc1ODNWMTAuODQ2NEgxNS42MDQxVjMuNzM3NDNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDEyLjE5MDJIMFYxOS4yOTkySDcuMTI4MzFWMTIuMTkwMloiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMTIuMTkwMkg4LjQ3NTgzVjE5LjI5OTJIMTUuNjA0MVYxMi4xOTAyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMDc5NyAxMi4xOTAySDE2Ljk1MTRWMTkuMjk5MkgyNC4wNzk3VjEyLjE5MDJaIiBmaWxsPSIjRkY4NjAwIi8+CjxwYXRoIGQ9Ik03LjEyODMxIDIwLjY4NjNIMFYyNy43OTUzSDcuMTI4MzFWMjAuNjg2M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMjAuNjg2M0g4LjQ3NTgzVjI3Ljc5NTNIMTUuNjA0MVYyMC42ODYzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMTIzMiAyMC42ODYzSDE2Ljk5NDlWMjcuNzk1M0gyNC4xMjMyVjIwLjY4NjNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik0xNDYgMTUuODMxM0MxNDYgMTYuODcxNyAxNDUuMTc0IDE3LjY5NTMgMTQ0LjEzMSAxNy42OTUzQzE0My4wODggMTcuNjk1MyAxNDIuMjYyIDE2Ljg3MTcgMTQyLjI2MiAxNS44MzEzQzE0Mi4yNjIgMTQuNzkxIDE0My4wODggMTQuMDEwNyAxNDQuMTMxIDE0LjAxMDdDMTQ1LjEzMSAxMy45Njc0IDE0NiAxNC43OTEgMTQ2IDE1LjgzMTNaTTE0Mi45NTcgMTQuNzkxQzE0Mi42OTcgMTUuMDUxMSAxNDIuNTY2IDE1LjQ0MTIgMTQyLjU2NiAxNS44MzEzQzE0Mi41NjYgMTYuNjk4MyAxNDMuMjYyIDE3LjM5MTggMTQ0LjEzMSAxNy4zOTE4QzE0NSAxNy4zOTE4IDE0NS42OTYgMTYuNjk4MyAxNDUuNjk2IDE1LjgzMTNDMTQ1LjY5NiAxNS4wMDc3IDE0NSAxNC4yNzA4IDE0NC4xNzQgMTQuMjcwOEMxNDMuNjUzIDE0LjI3MDggMTQzLjI2MiAxNC40NDQyIDE0Mi45NTcgMTQuNzkxWk0xNDQuODcgMTYuOTE1SDE0NC40NzlMMTQzLjkxNCAxNi4wOTE0VjE2LjkxNUgxNDMuNjA5VjE0Ljc0NzZIMTQzLjk1N0MxNDQuNDM1IDE0Ljc0NzYgMTQ0LjY1MyAxNC45NjQ0IDE0NC42NTMgMTUuMzU0NUMxNDQuNjUzIDE1LjY1NzkgMTQ0LjQ3OSAxNS44NzQ3IDE0NC4xNzQgMTUuOTYxNEwxNDQuODcgMTYuOTE1Wk0xNDQuMDQ0IDE1LjY1NzlDMTQ0LjI2MSAxNS42NTc5IDE0NC4zOTIgMTUuNTI3OSAxNDQuMzkyIDE1LjM1NDVDMTQ0LjM5MiAxNS4xMzc4IDE0NC4yNjEgMTUuMDUxMSAxNDQuMDAxIDE1LjA1MTFIMTQzLjkxNFYxNS42NTc5SDE0NC4wNDRaIiBmaWxsPSIjMzU0M0E4Ii8+Cjwvc3ZnPgo=" style="
    text-align: left;
    width: 146px;
    position: absolute;
    top: 14px;
    left: 31px;
">
            </div>
            <div style="
    position: relative;
    top: 80px;
    left: 32px;
    font-size: 20px;
    text-align: left;
    font-weight: 700;
    letter-spacing: 0.02em;
    font-style: normal;
    line-height: 125%;
    ">Claim your FREE account and get a key in less than a minute</div>
            <ul style="
        font-size: 15px;
        font-weight: 400;
        color: #333333;
        letter-spacing: 0.01em;
        position: relative;
        left: 32px;
        top: 88px;
        line-height: 180%;
        ">
                <li><span>Access to a 30-day free trial of any of our products.</span></li>
                <li><span>Access to 24x5 support by developers via the <a href="https://support.syncfusion.com/create?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">support tickets</a>, <a href="https://www.syncfusion.com/forums?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">forum</a>, <a href="https://www.syncfusion.com/feedback?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">feature &amp; feedback page</a> and chat.</span></li>
                <li><span>200+ <a href="https://www.syncfusion.com/succinctly-free-ebooks?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">ebooks </a>on the latest technologies, industry trends, and research topics.</span>
                </li>
                <li><span>Largest collection of over 7500 flat and wireframe icons for free with Syncfusion<sup>®</sup> <a href="https://www.syncfusion.com/downloads/metrostudio?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">Metro Studio.</a></span></li>
                <li><span>Free and unlimited access to Syncfusion<sup>®</sup> technical <a href="https://www.syncfusion.com/blogs/?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">blogs</a> and <a href="https://www.syncfusion.com/resources/techportal/whitepapers?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">whitepapers.</a></span></li>
            </ul>
            <div style="
            font-size: 18px;
            font-weight: 700;
            position: relative;
            line-height: 125%;
            letter-spacing: 0.02em;
            top: 90px;
            left: 32px;
    ">Syncfusion is trusted by 29,000+ businesses worldwide</div>
            <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIyMzAiIGhlaWdodD0iMTU2Ij4KPHBhdGggZD0iTTAgMCBDMTAuMjAxNTE3OTEgOC44MjE1MTgwNSAxNi4yMjU4NjAxNyAxOS4zODQ1MTIyMiAxNy4yODEyNSAzMi45NzI2NTYyNSBDMTcuNDE3OTUwMTYgNDUuOTc2MjU4NTUgMTMuMTkyNTE4MDQgNTcuNjM2ODk1NzMgNC4yNDYwOTM3NSA2Ny4xMzI4MTI1IEMtNS44MzQzNzk4NyA3Ni42NDQzNzA1IC0xNi43MjM2MTUyMyA4MC40NzU4MTc3IC0zMC40MTAxNTYyNSA4MC4yMjI2NTYyNSBDLTQzLjEyNjA0NDAyIDc5LjI2MTgzMzU2IC01NC4yMDMwOTQ1MyA3My40MDM0NzMyNCAtNjIuNzE4NzUgNjMuOTcyNjU2MjUgQy03MS4xNDgwNjkyNSA1MS44OTg2NTk5MiAtNzMuMTk0NzM3MSA0MC4zOTM3NzYxNCAtNzEuNzE4NzUgMjUuOTcyNjU2MjUgQy02OS4wOTkxNjQzNyAxNC41NTg3NDc0NCAtNjIuMzc0NTczNzggNC42NDI1NDI1NiAtNTIuNzE4NzUgLTIuMDI3MzQzNzUgQy0zNS45MDE4NDE2MSAtMTEuOTUyMDc2NTcgLTE1Ljg5MjUyMDU5IC0xMi4xNTE1ODYzNiAwIDAgWiAiIGZpbGw9IiMwODY4NDIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzODguNzE4NzUsNDIuMDI3MzQzNzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzcuMzY3MjM5MTYgNC4wNDIzMjQxMSAxMS4xMDI1Mzc1MyAxMS4zOTA0MDEzMyAxNCAxOSBDMTQuMzg5NjU4MjYgMjAuOTg5NzkzMzQgMTQuNzQwMDUyODkgMjIuOTg5MTQ0ODEgMTUgMjUgQzE1LjY2IDI1IDE2LjMyIDI1IDE3IDI1IEMxNy4xMDA1NDY4NyAyNC4xNDQwNjI1IDE3LjIwMTA5Mzc1IDIzLjI4ODEyNSAxNy4zMDQ2ODc1IDIyLjQwNjI1IEMxOC45MTc0Mjc1NSAxNC41MDU2MzU4IDIzLjYwODM5NDI3IDUuNzcxNDMyNzMgMzAuMTc5Njg3NSAwLjg5NDUzMTI1IEMzMy43MzEzMzY1NCAtMC44NTA4MDcwMSAzNi4wNzI1NTM3NiAtMC42MjM0MDQxNyA0MCAwIEM0Ny43ODg2NDkxMyAzLjU4Mjc3ODYgNTEuMzQ3MDc2MTEgMTAuOTI1MDE3NDYgNTQuMzUyNzgzMiAxOC41ODg4NjcxOSBDNjAuNjYxMjYyNjMgMzUuNzMzMjUxOTkgNjMuMjM3ODY0ODggNTQuNDE0MDMxNTkgNjMuMDYyNSA3Mi42MjUgQzYzLjA1Nzk4ODI4IDczLjUzMzc4OTA2IDYzLjA1MzQ3NjU2IDc0LjQ0MjU3ODEyIDYzLjA0ODgyODEyIDc1LjM3ODkwNjI1IEM2My4wMzcyMTIwMiA3Ny41ODU5NjY5NSA2My4wMTkyODQ1MyA3OS43OTI5OTI5OSA2MyA4MiBDNTkuMDQgODIgNTUuMDggODIgNTEgODIgQzUwLjkzMDA2ODM2IDgwLjkwMzQ5MTIxIDUwLjg2MDEzNjcyIDc5LjgwNjk4MjQyIDUwLjc4ODA4NTk0IDc4LjY3NzI0NjA5IEM1MC4zMzA4MzIxNSA0MS45ODYzMDU3MyA1MC4zMzA4MzIxNSA0MS45ODYzMDU3MyAzOSA4IEMzOC4wMSA3LjY3IDM3LjAyIDcuMzQgMzYgNyBDMjUuMTQyMTkxNjggMTYuMjQ0MTIxMzEgMjQuODI2NDcwMzkgMzguNDA3NTg2NzUgMjMuNjgzNTkzNzUgNTEuNjcyMzYzMjggQzIzLjA0MTM0NzcxIDU5Ljc3NjY1NDY5IDIyLjUwMDE0OTM2IDY3Ljg4NTgxMjE3IDIyIDc2IEMxOC4wNCA3NiAxNC4wOCA3NiAxMCA3NiBDOS44OTUxMDI1NCA3NC40NzU4NDQ3MyA5Ljg5NTEwMjU0IDc0LjQ3NTg0NDczIDkuNzg4MDg1OTQgNzIuOTIwODk4NDQgQzkuMjg4Njk2MTIgMzkuNjQwNjkzMTMgOS4yODg2OTYxMiAzOS42NDA2OTMxMyAtMSA5IEMtMy4wMzU2NDA0IDcuNzQxNDM2NTkgLTMuMDM1NjQwNCA3Ljc0MTQzNjU5IC01IDcgQy0xNS44NDgzODY5NyAxNi40OTIzMzg2IC0xNi4wNTg3MjYyNSA0MC4yNTk3NTY0MSAtMTcgNTQgQy0xNy40NzQyMTEwMiA2My4zMjgyOTc4NCAtMTcuNzQ3NjYxNTkgNzIuNjYzNDc4NzQgLTE4IDgyIEMtMjIuMjkgODIgLTI2LjU4IDgyIC0zMSA4MiBDLTMxLjg5MjU5MjA1IDU1LjgxNzI5OTc3IC0yOS45NTA2NDQ2MiAyMi44Mzc1NTI0MSAtMTIgMiBDLTguNDczMzg5NDMgLTAuNjQ0OTU3OTMgLTQuMjE5NTgzOTggLTAuOTU4OTk2MzYgMCAwIFogIiBmaWxsPSIjRkZDQzAwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MjgsMzcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzUuODg3MjkwNzMgMS40NDk4NTUxOCA5LjE2NjM4NTEzIDEuMjgxNTYyNTYgMTQuNzUgLTAuODM5ODQzNzUgQzIwLjM1Nzc0OTYyIC0yLjU0NjE0OTE0IDI1LjU0MDY3MjkyIC0xLjM4Mjk1NTEgMzAuNjI1IDEuMjUgQzMyLjkzNzM1MDYzIDMuMjczMzA2OCAzNC4xMDM0MzU0MiA0LjU3NzExOTE4IDM1LjEyNSA3LjQzNzUgQzM0LjM0MTI1IDguMTggMzMuNTU3NSA4LjkyMjUgMzIuNzUgOS42ODc1IEMyOS4xMTkwMTcwMyAxMy40OTEzODY5MiAyOC4yMzgzODk0NyAxNS4wMzE0NzA1OCAyNy44MTI1IDIwLjMxMjUgQzI3Ljk2MDg4MjA0IDI1LjAxNzA4MzQ0IDI5LjE5MzUzOTM2IDI4LjU3NDg0NDU4IDMyLjY2MDE1NjI1IDMxLjkxNzk2ODc1IEMzNC4xMDgzOTEwMSAzMy4xNDAyMzc4IDM1LjYxMjk3ODE1IDM0LjI5NTA4MzQ5IDM3LjEyNSAzNS40Mzc1IEMzNi4wNzAxOTM1MiA0Mi40Njk1NDMyIDMyLjAzNjA5MDQ5IDQ3Ljk3MzE5OTEgMjcuNzUgNTMuNSBDMjQuMjczODU5MzcgNTYuMDY1NzIyODUgMjEuNDA5Njc2NTkgNTYuNjI0MTU5MTggMTcuMTI1IDU2LjQzNzUgQzE1LjExMjc3OTUzIDU1LjgwODY4MTEgMTMuMTEyMjMyNjggNTUuMTQxMzExNTcgMTEuMTI1IDU0LjQzNzUgQzcuMTMyMjAwNjEgNTQuMDEwODUwMDcgMy44Njk5NzIwNCA1NC4xNzkwNDAzMSAwLjA2MjUgNTUuNSBDLTMuNzQ1OTgyNzYgNTYuNzE1NDczMjIgLTYuMDIwMDcxMDYgNTYuNDcwMDcwMjUgLTkuODc1IDU1LjQzNzUgQy0xNy44OTY4MjA0OCA1MC4zNjI0NzA3MiAtMjMuMjI0ODkxNjcgNDAuMjQ1NjM5MjYgLTI1LjQzMzU5Mzc1IDMxLjEzMjgxMjUgQy0yNi42OTE4Nzk2IDIzLjQ0OTQ3NDE1IC0yNy4zMTA4Njc4MiAxNC4yMDI1NjkzMiAtMjIuODc1IDcuNDM3NSBDLTE5LjE4NzExNTEzIDMuMTY0NjQwMjkgLTE0Ljk1ODc1MDk1IC0wLjQ2NDczMTYxIC05LjI2NTYyNSAtMS41NzQyMTg3NSBDLTYuMDIyMDAxNTYgLTEuNTU4MzE4NjQgLTMuMTQ1MDkxMDYgLTAuNzc5NDY1MjEgMCAwIFogIiBmaWxsPSIjMDAwMDAwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMjIuODc1LDU1LjU2MjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzYuOTk4NjY1NzYgNi41NjU2MTQ1OCAxMy4yMzU0MjQ3IDEzLjIxNDc1OTU1IDE0LjE3OTY4NzUgMjMuMTg3NSBDMTMuOTYxMTk2MzQgMjguMjczOTc0MSAxMi4yNTY2NDk1NCAzMi4wNjY5ODMyNiA5LjAzNTE1NjI1IDM1Ljk3NjU2MjUgQzAuNTMzMzg4MDQgNDMuNTgzNDA3NzQgLTguOTc3NTY4MjUgNDUuMDAzODkwNjcgLTE5Ljg1NTQ2ODc1IDQ0Ljg5ODQzNzUgQy0yMS4xODA5NDcyNyA0NC44OTE2Njk5MiAtMjEuMTgwOTQ3MjcgNDQuODkxNjY5OTIgLTIyLjUzMzIwMzEyIDQ0Ljg4NDc2NTYyIEMtMjQuNzAzMTU0MzQgNDQuODczMDM2MTYgLTI2Ljg3MzA3MDQ3IDQ0Ljg1NTEwMjQ1IC0yOS4wNDI5Njg3NSA0NC44MzU5Mzc1IEMtMjkuMzcyOTY4NzUgNDUuNDk1OTM3NSAtMjkuNzAyOTY4NzUgNDYuMTU1OTM3NSAtMzAuMDQyOTY4NzUgNDYuODM1OTM3NSBDLTMyLjQxNzk2ODc1IDQ2Ljk2MDkzNzUgLTMyLjQxNzk2ODc1IDQ2Ljk2MDkzNzUgLTM1LjA0Mjk2ODc1IDQ2LjgzNTkzNzUgQy0zNy4wNDI5Njg3NSA0NC44MzU5Mzc1IC0zNy4wNDI5Njg3NSA0NC44MzU5Mzc1IC0zNy40MTQwNjI1IDQyLjM1NTQ2ODc1IEMtMzcuNzgyMzI5OTcgMzkuNzMzNjQ1MzEgLTM3Ljc4MjMyOTk3IDM5LjczMzY0NTMxIC0zOS44MjgxMjUgMzguNTM1MTU2MjUgQy00MC41Nzk2NDg0NCAzOC4yMDEyODkwNiAtNDEuMzMxMTcxODcgMzcuODY3NDIxODcgLTQyLjEwNTQ2ODc1IDM3LjUyMzQzNzUgQy00Ny4zNTI0NjU4MyAzNC44NTM3NjUzOCAtNTEuNDU1NzUyNzEgMzEuNTMwNDMxOTUgLTU1LjA0Mjk2ODc1IDI2LjgzNTkzNzUgQy01Ni4wNDI5Njg3NSAyMy4zMzU5Mzc1IC01Ni4wNDI5Njg3NSAyMy4zMzU5Mzc1IC01Ni4wNDI5Njg3NSAyMC44MzU5Mzc1IEMtNTEuMzM2NTk3OTUgMTYuMTI5NTY2NyAtNDUuMzAzOTE4MTcgMTQuNTc0NTc2MzMgLTM5LjA0Mjk2ODc1IDEyLjgzNTkzNzUgQy0zOC4zODI5Njg3NSAxMi44MzU5Mzc1IC0zNy43MjI5Njg3NSAxMi44MzU5Mzc1IC0zNy4wNDI5Njg3NSAxMi44MzU5Mzc1IEMtMzYuOTIxNzk2ODggMTEuOTA5MTAxNTYgLTM2LjgwMDYyNSAxMC45ODIyNjU2MiAtMzYuNjc1NzgxMjUgMTAuMDI3MzQzNzUgQy0zNi41MDgyMDMxMyA4LjgyOTgwNDY5IC0zNi4zNDA2MjUgNy42MzIyNjU2MyAtMzYuMTY3OTY4NzUgNi4zOTg0Mzc1IEMtMzYuMDA1NTQ2ODggNS4yMDM0NzY1NiAtMzUuODQzMTI1IDQuMDA4NTE1NjMgLTM1LjY3NTc4MTI1IDIuNzc3MzQzNzUgQy0zNS40NjY5NTMxMyAxLjgwNjY3OTY5IC0zNS4yNTgxMjUgMC44MzYwMTU2MyAtMzUuMDQyOTY4NzUgLTAuMTY0MDYyNSBDLTM0LjM4Mjk2ODc1IC0wLjQ5NDA2MjUgLTMzLjcyMjk2ODc1IC0wLjgyNDA2MjUgLTMzLjA0Mjk2ODc1IC0xLjE2NDA2MjUgQy0zMC4wNzc2OTExNyAxLjI4MTI3NiAtMjkuNDg3MTQ2NjEgMy4yODE5NjA5NyAtMjguODU1NDY4NzUgNy4wMjM0Mzc1IEMtMjguNjk2OTE0MDYgNy45MjQ0OTIxOSAtMjguNTM4MzU5MzggOC44MjU1NDY4OCAtMjguMzc1IDkuNzUzOTA2MjUgQy0yOC4yNjU0Mjk2OSAxMC40NDA5NzY1NiAtMjguMTU1ODU5MzcgMTEuMTI4MDQ2ODcgLTI4LjA0Mjk2ODc1IDExLjgzNTkzNzUgQy0yNy4xMjUxNTYyNSAxMS45MzM5MDYyNSAtMjYuMjA3MzQzNzUgMTIuMDMxODc1IC0yNS4yNjE3MTg3NSAxMi4xMzI4MTI1IEMtMTguMDQ1MDgyNTkgMTMuMDEyMTUwNTIgLTEyLjIzNzYzMDI1IDEzLjk0OTA5MTA3IC02LjA0Mjk2ODc1IDE3LjgzNTkzNzUgQy00LjY2MTcxODU3IDIwLjU5ODQzNzg2IC00Ljg1MjE3NTY5IDIyLjc4MzI0ODQ5IC01LjA0Mjk2ODc1IDI1LjgzNTkzNzUgQy03LjA0Mjk2ODc1IDI3LjgzNTkzNzUgLTcuMDQyOTY4NzUgMjcuODM1OTM3NSAtMTAuNjY3OTY4NzUgMjcuOTYwOTM3NSBDLTExLjc4MTcxODc1IDI3LjkxOTY4NzUgLTEyLjg5NTQ2ODc1IDI3Ljg3ODQzNzUgLTE0LjA0Mjk2ODc1IDI3LjgzNTkzNzUgQy0xMy4zODI5Njg3NSAyNi41MTU5Mzc1IC0xMi43MjI5Njg3NSAyNS4xOTU5Mzc1IC0xMi4wNDI5Njg3NSAyMy44MzU5Mzc1IEMtMTUuNzk1MjI3MTUgMjIuMTc5MDk2MTMgLTE5LjMwNjQ5OTM2IDIxLjMzMzg1NTg3IC0yMy4zNTU0Njg3NSAyMC43MTA5Mzc1IEMtMjUuMjMyMzQzNzUgMjAuNDIyMTg3NSAtMjcuMTA5MjE4NzUgMjAuMTMzNDM3NSAtMjkuMDQyOTY4NzUgMTkuODM1OTM3NSBDLTI4LjU0Nzk2ODc1IDI4LjI1MDkzNzUgLTI4LjU0Nzk2ODc1IDI4LjI1MDkzNzUgLTI4LjA0Mjk2ODc1IDM2LjgzNTkzNzUgQy0xMi4wNjE3Nzk5MSAzNy4zODI2NDE3MiAtMTIuMDYxNzc5OTEgMzcuMzgyNjQxNzIgMi4wODIwMzEyNSAzMC42NDg0Mzc1IEM0Ljc2MDcwNTQxIDI2LjYzMDQyNjI2IDQuNzc1MjY3NDcgMjMuNTI1MDYwNDMgMy45NTcwMzEyNSAxOC44MzU5Mzc1IEMxLjAxMTM1NTYzIDguNTI2MDcyODEgLTguODY3NTEyMiAyLjM4NDg3MDU4IC0xNy43MzQzNzUgLTIuNTYyNSBDLTMxLjY3NjMzMzk0IC05LjMxMTI2NDA3IC00NS42NDMxNzQyMiAtMTEuNTY4NzI4NjMgLTYxLjA0Mjk2ODc1IC0xMS4xNjQwNjI1IEMtNjEuMDQyOTY4NzUgLTEwLjE3NDA2MjUgLTYxLjA0Mjk2ODc1IC05LjE4NDA2MjUgLTYxLjA0Mjk2ODc1IC04LjE2NDA2MjUgQy02My4wMjI5Njg3NSAtOC4xNjQwNjI1IC02NS4wMDI5Njg3NSAtOC4xNjQwNjI1IC02Ny4wNDI5Njg3NSAtOC4xNjQwNjI1IEMtNjcuNzkyOTY4NzUgLTkuOTE0MDYyNSAtNjcuNzkyOTY4NzUgLTkuOTE0MDYyNSAtNjguMDQyOTY4NzUgLTEyLjE2NDA2MjUgQy02NS45Njg1NDMxOCAtMTUuNTIyNjU2MjggLTYzLjQ3ODY1NTM5IC0xNi41NTA0NzkzNSAtNTkuNzkyOTY4NzUgLTE3LjQ3NjU2MjUgQy0zOS4xODA0NTMyNSAtMjAuODM2MzExNzIgLTE1Ljg1MjQ2NDU2IC0xMy4zOTczMDI3NCAwIDAgWiBNLTQ3LjM1NTQ2ODc1IDIwLjgzNTkzNzUgQy00OC4yMzg0NzY1NiAyMS4wMjE1NjI1IC00OS4xMjE0ODQzOCAyMS4yMDcxODc1IC01MC4wMzEyNSAyMS4zOTg0Mzc1IEMtNTAuNjk1MTE3MTkgMjEuNTQyODEyNSAtNTEuMzU4OTg0MzcgMjEuNjg3MTg3NSAtNTIuMDQyOTY4NzUgMjEuODM1OTM3NSBDLTUyLjUwMDI0MDQ0IDI1LjcyNDc4Mzk5IC01Mi41MDAyNDA0NCAyNS43MjQ3ODM5OSAtNTAuNTAzOTA2MjUgMjcuNDY4NzUgQy00Ni40NjI2MDg1IDMwLjM1OTcxNTgxIC00Mi45NDE1MjEwNyAzMi42MTEyOTk0MiAtMzguMDQyOTY4NzUgMzMuODM1OTM3NSBDLTM2LjcwMzk1MDgzIDMyLjcyNDY3MDkxIC0zNi43MDM5NTA4MyAzMi43MjQ2NzA5MSAtMzYuOTQ1MzEyNSAyOS44OTQ1MzEyNSBDLTM2Ljk1NjkxNDA2IDI4LjY5OTU3MDMxIC0zNi45Njg1MTU2MyAyNy41MDQ2MDkzOCAtMzYuOTgwNDY4NzUgMjYuMjczNDM3NSBDLTM2Ljk4OTQ5MjE5IDI1LjA3NTg5ODQ0IC0zNi45OTg1MTU2MiAyMy44NzgzNTkzOCAtMzcuMDA3ODEyNSAyMi42NDQ1MzEyNSBDLTM3LjAxOTQxNDA2IDIxLjcxNzY5NTMxIC0zNy4wMzEwMTU2MyAyMC43OTA4NTkzNyAtMzcuMDQyOTY4NzUgMTkuODM1OTM3NSBDLTQwLjYzODE2MTY3IDE5LjczMjI5MjMgLTQzLjg0MDg2MTA3IDIwLjA4NjE1NDUzIC00Ny4zNTU0Njg3NSAyMC44MzU5Mzc1IFogIiBmaWxsPSIjMjIxRTIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NTEuMDQyOTY4NzUsNTguMTY0MDYyNSkiLz4KPHBhdGggZD0iTTAgMCBDMy4zIDAgNi42IDAgMTAgMCBDMTMuOTk1NTQ4MTcgOC40NTIxMjExMyAxNi45NDE0Njg4MSAxNy4xNzE5NjY3OSAyMCAyNiBDMjAuMzMgMTcuNDIgMjAuNjYgOC44NCAyMSAwIEMyNC42MyAwIDI4LjI2IDAgMzIgMCBDMzIgMTguNDggMzIgMzYuOTYgMzIgNTYgQzI4IDU3IDI4IDU3IDIwIDU3IEMxNy4zNiA0OS40MSAxNC43MiA0MS44MiAxMiAzNCBDMTEuNjcgNDIuMjUgMTEuMzQgNTAuNSAxMSA1OSBDNS41NTUgNTkuNDk1IDUuNTU1IDU5LjQ5NSAwIDYwIEMwIDQwLjIgMCAyMC40IDAgMCBaICIgZmlsbD0iI0Q4MUYyNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTk1LDUyKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjE3MDQ2ODc1IDAuMDI3MDcwMzEgMi4zNDA5Mzc1IDAuMDU0MTQwNjMgMy41NDY4NzUgMC4wODIwMzEyNSBDNC40Mzg5MDYyNSAwLjExNjgzNTk0IDUuMzMwOTM3NSAwLjE1MTY0MDYyIDYuMjUgMC4xODc1IEM3LjUzODE4NzMxIDYuMjE4NDU0OTcgOC44MTk3NDQ4OSAxMi4yNTA3NjY0NyAxMC4wOTUyMTQ4NCAxOC4yODQ0MjM4MyBDMTAuNTI5OTIzMzUgMjAuMzM2MjQxNDggMTAuOTY2NDMxOTEgMjIuMzg3Njc4NjMgMTEuNDA0Nzg1MTYgMjQuNDM4NzIwNyBDMTIuMDM1MDI5NTggMjcuMzg5MTUwNjYgMTIuNjU4NzU5NzQgMzAuMzQwODk0MzcgMTMuMjgxMjUgMzMuMjkyOTY4NzUgQzEzLjQ3ODExNDAxIDM0LjIwNzczNDgzIDEzLjY3NDk3ODAzIDM1LjEyMjUwMDkyIDEzLjg3NzgwNzYyIDM2LjA2NDk4NzE4IEMxNC4wNTc5OTQzOCAzNi45MjU1MDE4NiAxNC4yMzgxODExNSAzNy43ODYwMTY1NCAxNC40MjM4MjgxMiAzOC42NzI2MDc0MiBDMTQuNTgzNzEyMTYgMzkuNDI1Mzk0NzQgMTQuNzQzNTk2MTkgNDAuMTc4MTgyMDcgMTQuOTA4MzI1MiA0MC45NTM3ODExMyBDMTUuMjUgNDMuMTg3NSAxNS4yNSA0My4xODc1IDE1LjI1IDQ4LjE4NzUgQzExLjI5IDQ4LjE4NzUgNy4zMyA0OC4xODc1IDMuMjUgNDguMTg3NSBDMi45MiA0NS44Nzc1IDIuNTkgNDMuNTY3NSAyLjI1IDQxLjE4NzUgQy0yLjcgNDEuNTE3NSAtNy42NSA0MS44NDc1IC0xMi43NSA0Mi4xODc1IEMtMTMuNDEgNDQuMTY3NSAtMTQuMDcgNDYuMTQ3NSAtMTQuNzUgNDguMTg3NSBDLTE5LjM3IDQ4LjE4NzUgLTIzLjk5IDQ4LjE4NzUgLTI4Ljc1IDQ4LjE4NzUgQy0yNi44MDgzMTEyNiA0Mi4yMDY0MzQ4NSAtMjQuNzAyMzE0NTggMzYuMzU1OTk3NzMgLTIyLjMxNjQwNjI1IDMwLjUzOTA2MjUgQy0yMS45OTcxOTcxMSAyOS43NTk4NTQ0MyAtMjEuNjc3OTg3OTggMjguOTgwNjQ2MzYgLTIxLjM0OTEwNTgzIDI4LjE3NzgyNTkzIEMtMjAuNjc5NDY4MTMgMjYuNTQ4NjI2IC0yMC4wMDc5ODYzNCAyNC45MjAxODI4OSAtMTkuMzM0NzE2OCAyMy4yOTI0ODA0NyBDLTE4LjY0OTcxMDY3IDIxLjYzMDYwMDMgLTE3Ljk3MDA3MDg4IDE5Ljk2NjQ5ODY1IC0xNy4yOTU2NTQzIDE4LjMwMDI5Mjk3IEMtMTYuMzEzOTk1MTggMTUuODc1MDE3NSAtMTUuMzE3MDg2OTUgMTMuNDU2NTQxMzggLTE0LjMxNjQwNjI1IDExLjAzOTA2MjUgQy0xNC4wMTgzNTU4NyAxMC4yOTUzMjM3OSAtMTMuNzIwMzA1NDggOS41NTE1ODUwOCAtMTMuNDEzMjIzMjcgOC43ODUzMDg4NCBDLTEwLjMyNjYxNzczIDEuNDMzOTIzMTMgLTcuOTE5NDc2MjUgLTAuMjM3NTg0MjkgMCAwIFogTS0zLjc1IDE1LjE4NzUgQy01LjQgMjAuMTM3NSAtNy4wNSAyNS4wODc1IC04Ljc1IDMwLjE4NzUgQy02LjExIDMwLjE4NzUgLTMuNDcgMzAuMTg3NSAtMC43NSAzMC4xODc1IEMtMS40MDM0OTYzMyAyMi42MzcxMTU3OCAtMS40MDM0OTYzMyAyMi42MzcxMTU3OCAtMi43NSAxNS4xODc1IEMtMy4wOCAxNS4xODc1IC0zLjQxIDE1LjE4NzUgLTMuNzUgMTUuMTg3NSBaICIgZmlsbD0iIzIzNDM5QSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTcwLjc1LDUzLjgxMjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuNzg5Mjg3NzggMi4zMDgzNzYwOSAzLjc1MTc2ODg4IDQuMjY1OTI4MzQgNC4yNzM0Mzc1IDcuOTEwMTU2MjUgQzQuNjM2ODE4NzQgMTUuNjExMDQzMzQgMS45NDAyMDM5IDIxLjI4NjM5NDY0IC0yLjc5Njg3NSAyNy4yNjk1MzEyNSBDLTkuMDAxNDUwMzQgMzMuOTU4MDYzNDcgLTE1LjA5NjEwOTIxIDM3LjE0MTAyMzg5IC0yNC4yNSAzNy41IEMtMjguMDQyMTE1NTYgMzcuMzY0OTExOTEgLTI5Ljc2NDgxODA0IDM3LjEzMTcwMTkgLTMzLjEyNSAzNS4yNSBDLTM2LjYxNDUyNjY5IDMxLjA2MjU2Nzk3IC0zNy40NTgyNTE2IDI3Ljc5OTc2MzM3IC0zNy4zMDg1OTM3NSAyMi40Mjk2ODc1IEMtMzYuMzE4MDI0MjMgMTQuNjMwNTE5ODYgLTMxLjc1MTQwMDU4IDguMTU2MDQwNzUgLTI2IDMgQy0xNy42OTY1MDc2NiAtMi42NTI1NDYzMSAtOS4yMjAwNTQ5MyAtNS42NTc3NjA5OCAwIDAgWiAiIGZpbGw9IiMwNjg4MkYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwNDUsNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNzQ5ODUzMjUgLTAuMDg3MTc0NyA3LjQ5OTQ0NTU1IC0wLjE0MDQ1MDAzIDExLjI1IC0wLjE4NzUgQzEyLjMxMzQ3NjU2IC0wLjIxMjYzNjcyIDEzLjM3Njk1MzEyIC0wLjIzNzc3MzQ0IDE0LjQ3MjY1NjI1IC0wLjI2MzY3MTg4IEMxNS40OTc0NjA5NCAtMC4yNzMzMzk4NCAxNi41MjIyNjU2MyAtMC4yODMwMDc4MSAxNy41NzgxMjUgLTAuMjkyOTY4NzUgQzE4LjUyMDc1MTk1IC0wLjMwODY3OTIgMTkuNDYzMzc4OTEgLTAuMzI0Mzg5NjUgMjAuNDM0NTcwMzEgLTAuMzQwNTc2MTcgQzIzLjU2MjEwMzM5IDAuMDc0NjIyNTkgMjQuODI1NjM1MDMgMC43MTY2NzQ2NSAyNyAzIEMyNy45MTMwODU5NCA1LjYzNTQ5ODA1IDI3LjkxMzA4NTk0IDUuNjM1NDk4MDUgMjguNDg0Mzc1IDguNzYxNzE4NzUgQzI4LjgwMzQxNzk3IDEwLjQzOTExMTMzIDI4LjgwMzQxNzk3IDEwLjQzOTExMTMzIDI5LjEyODkwNjI1IDEyLjE1MDM5MDYyIEMyOS4zMzM4NjcxOSAxMy4zMTc2MzY3MiAyOS41Mzg4MjgxMiAxNC40ODQ4ODI4MSAyOS43NSAxNS42ODc1IEMyOS45NzA0Mjk2OSAxNi44NjYzNDc2NiAzMC4xOTA4NTkzOCAxOC4wNDUxOTUzMSAzMC40MTc5Njg3NSAxOS4yNTk3NjU2MiBDMzAuOTYwMTAyNjQgMjIuMTcwNzg4OTEgMzEuNDg2NzY4MjIgMjUuMDgzNzY2MzEgMzIgMjggQzM1LjA3NTc1MDg3IDIxLjMyMzQ4NDU3IDM4LjA0NTYyMTcyIDE0LjYyMjgwNzQ2IDQwLjgxMjUgNy44MTI1IEM0MS4xMjM4MDg1OSA3LjA1MTMwODU5IDQxLjQzNTExNzE5IDYuMjkwMTE3MTkgNDEuNzU1ODU5MzggNS41MDU4NTkzOCBDNDIuNTA1ODE1MTcgMy42NzEzNTIxMyA0My4yNTMxOTk4MiAxLjgzNTc5NDExIDQ0IDAgQzQ4LjI5IDAgNTIuNTggMCA1NyAwIEM1NS44NzQ5NzQ1OCA2Ljc1MDE1MjU0IDU1Ljg3NDk3NDU4IDYuNzUwMTUyNTQgNTQuMzQxNzk2ODggMTAuMzIxMjg5MDYgQzU0LjAwNDc0NzMxIDExLjExNTIxMDU3IDUzLjY2NzY5Nzc1IDExLjkwOTEzMjA4IDUzLjMyMDQzNDU3IDEyLjcyNzExMTgyIEM1Mi45NTY4Nzg2NiAxMy41NjQ4MjExNyA1Mi41OTMzMjI3NSAxNC40MDI1MzA1MiA1Mi4yMTg3NSAxNS4yNjU2MjUgQzUxLjg0NTIwMzg2IDE2LjE0MDIzMzc2IDUxLjQ3MTY1NzcxIDE3LjAxNDg0MjUzIDUxLjA4Njc5MTk5IDE3LjkxNTk1NDU5IEM0OS44OTczNDQ2IDIwLjY5NjY1Mjc4IDQ4LjY5ODc0NTQ1IDIzLjQ3MzI5OTM5IDQ3LjUgMjYuMjUgQzQ2LjY5MzQyMDAxIDI4LjEzMjU1OTY1IDQ1Ljg4NzQyNDAyIDMwLjAxNTM2OTYzIDQ1LjA4MjAzMTI1IDMxLjg5ODQzNzUgQzQzLjYxMDkxMDIyIDM1LjMzMjU2NDA1IDQyLjEzODAzMjE4IDM4Ljc2NTkwNDg3IDQwLjY1ODIwMzEyIDQyLjE5NjI4OTA2IEM0MC4zNjE0MzY3NyA0Mi44ODQzNDYzMSA0MC4wNjQ2NzA0MSA0My41NzI0MDM1NiAzOS43NTg5MTExMyA0NC4yODEzMTEwNCBDMzkuMjA1MDIxMiA0NS41MzU2OTMxMSAzOC42MTMyMzIxNyA0Ni43NzM1MzU2NyAzOCA0OCBDMzMuMzggNDggMjguNzYgNDggMjQgNDggQzIzLjcxODAxNzU4IDQ2Ljg2OTgxNDQ1IDIzLjQzNjAzNTE2IDQ1LjczOTYyODkxIDIzLjE0NTUwNzgxIDQ0LjU3NTE5NTMxIEMyMi4wOTM1MjM1MyA0MC4zNzQ2MTE1MyAyMS4wMjMxNzA3NiAzNi4xNzg4ODk2NSAxOS45NDcyNjU2MiAzMS45ODQzNzUgQzE5LjQ4NDU3MjAzIDMwLjE2OTg5MDMxIDE5LjAyNjgzOTQ1IDI4LjM1NDEzMjkyIDE4LjU3NDIxODc1IDI2LjUzNzEwOTM4IEMxNy45MjE5MzU4OSAyMy45MjIyNTYxNiAxNy4yNTE4MjE4MSAyMS4zMTI1MzE3MyAxNi41NzgxMjUgMTguNzAzMTI1IEMxNi4yODA5ODYwMiAxNy40ODcyODcyOSAxNi4yODA5ODYwMiAxNy40ODcyODcyOSAxNS45Nzc4NDQyNCAxNi4yNDY4ODcyMSBDMTQuODEwMjA5MzQgMTEuODA0OTMzNDYgMTMuNzk5Njc2MzYgOC44OTA1NzQxMSAxMCA2IEM3LjQ0MzcyNDc1IDQuODk3OTA2NjcgNy40NDM3MjQ3NSA0Ljg5NzkwNjY3IDQuNzUgNC4yNSBDMy44NTc5Njg3NSA0LjAwNzY1NjI1IDIuOTY1OTM3NSAzLjc2NTMxMjUgMi4wNDY4NzUgMy41MTU2MjUgQzEuMzcxNDA2MjUgMy4zNDU0Njg3NSAwLjY5NTkzNzUgMy4xNzUzMTI1IDAgMyBDMCAyLjAxIDAgMS4wMiAwIDAgWiAiIGZpbGw9IiMyMTI5NjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM2LDU0KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjYzIDAgNy4yNiAwIDExIDAgQzE1IDkuNjI1IDE1IDkuNjI1IDE1IDEzIEMxNS42NiAxMyAxNi4zMiAxMyAxNyAxMyBDMTcuMTkzMzU5MzggMTIuMzk2NzE4NzUgMTcuMzg2NzE4NzUgMTEuNzkzNDM3NSAxNy41ODU5Mzc1IDExLjE3MTg3NSBDMTcuODQ2MzI4MTIgMTAuMzcyNjU2MjUgMTguMTA2NzE4NzUgOS41NzM0Mzc1IDE4LjM3NSA4Ljc1IEMxOC43NTc4NTE1NiA3LjU2NjY0MDYyIDE4Ljc1Nzg1MTU2IDcuNTY2NjQwNjIgMTkuMTQ4NDM3NSA2LjM1OTM3NSBDMjAgNCAyMCA0IDIyIDAgQzI1LjYzIDAgMjkuMjYgMCAzMyAwIEMzMS42MTIzNzc3OCA0LjQ4OTM2NjAxIDMwLjA5OTAyNzU4IDguODM1MTMyMDUgMjguMjA3MDMxMjUgMTMuMTM2NzE4NzUgQzI3LjcyNjY1NDA1IDE0LjI0Mjg1NTIyIDI3LjcyNjY1NDA1IDE0LjI0Mjg1NTIyIDI3LjIzNjU3MjI3IDE1LjM3MTMzNzg5IEMyNi41ODgzNzkzNiAxNi44NTIwMjc5OSAyNS45MjY0NjI4MyAxOC4zMjY4MDAwNiAyNS4yNDk3NTU4NiAxOS43OTQ2Nzc3MyBDMjEuMjM0Nzg2MTQgMjkuMDI3NTEyNzMgMjUuMDc1MDY3NzkgMzYuMzYzMTg5NTkgMjguNTYyNSA0NS4yNSBDMjkuNDAxNTk1MTQgNDcuMzk5MzA1OTEgMzAuMjM2NDQwNzggNDkuNTUwMjc3MTYgMzEuMDY2NDA2MjUgNTEuNzAzMTI1IEMzMS40MzcwOTIyOSA1Mi42NDgzMzAwOCAzMS44MDc3NzgzMiA1My41OTM1MzUxNiAzMi4xODk2OTcyNyA1NC41NjczODI4MSBDMzMgNTcgMzMgNTcgMzMgNjAgQzMxLjU2MTYzMjQ5IDU5Ljg4NTQxMzA3IDMwLjEyNDI5MDM0IDU5Ljc1NzkwODg0IDI4LjY4NzUgNTkuNjI1IEMyNy44ODY5OTIxOSA1OS41NTUzOTA2MyAyNy4wODY0ODQzOCA1OS40ODU3ODEyNSAyNi4yNjE3MTg3NSA1OS40MTQwNjI1IEMyNCA1OSAyNCA1OSAyMSA1NyBDMTkuNjEzMjgxMjUgNTMuOTYwOTM3NSAxOS42MTMyODEyNSA1My45NjA5Mzc1IDE4LjMxMjUgNTAuMzc1IEMxNy44NzU1MDc4MSA0OS4xODY0ODQzNyAxNy40Mzg1MTU2MyA0Ny45OTc5Njg3NSAxNi45ODgyODEyNSA0Ni43NzM0Mzc1IEMxNi42NjIxNDg0NCA0NS44NTgyMDMxMyAxNi4zMzYwMTU2MyA0NC45NDI5Njg3NSAxNiA0NCBDMTQuMjExNzgyMjYgNDYuNjgyMzI2NjEgMTIuNzk4NTczOTYgNDkuMzAyODg5NjEgMTEuMzc1IDUyLjE4NzUgQzEwLjkyODk4NDM4IDUzLjA4ODU1NDY5IDEwLjQ4Mjk2ODc1IDUzLjk4OTYwOTM4IDEwLjAyMzQzNzUgNTQuOTE3OTY4NzUgQzkuNjg1NzAzMTIgNTUuNjA1MDM5MDYgOS4zNDc5Njg3NSA1Ni4yOTIxMDkzNyA5IDU3IEM1LjcgNTYuNjcgMi40IDU2LjM0IC0xIDU2IEMtMC4zOTQ5ODQ5MyA0OS4xNzY3NzQ1NCAyLjkyNjY1MjAyIDQzLjQ2Njc3Nzg3IDUuOTM3NSAzNy40MzE2NDA2MiBDOC40NDU2MTQ0IDMyLjE0NzgyNjM3IDkuNzA2Nzk0NDIgMjguODM0MjUxNjYgOCAyMyBDNi43NTQ5MDE0NiAxOS41MzQxMTc5NSA1LjM3Mjc0NjExIDE2LjE0MTA0NzgxIDMuOTM3NSAxMi43NSBDMy4xOTE5Mjc4NyAxMC45NzU5MjA2OSAyLjQ1MDgyOTQ5IDkuMTk5OTUyNjcgMS43MTQ4NDM3NSA3LjQyMTg3NSBDMS4zODYwNTIyNSA2LjY0NDI0ODA1IDEuMDU3MjYwNzQgNS44NjY2MjEwOSAwLjcxODUwNTg2IDUuMDY1NDI5NjkgQzAgMyAwIDMgMCAwIFogIiBmaWxsPSIjRDgxRTI1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMTgzLDUyKSIvPgo8cGF0aCBkPSJNMCAwIEMtMC42NiAzLjYzIC0xLjMyIDcuMjYgLTIgMTEgQy0yLjgyNSAxMC44MzUgLTMuNjUgMTAuNjcgLTQuNSAxMC41IEMtMTEuNDA5NDk0MjQgOS40MzI1NTU0MyAtMTEuNDA5NDk0MjQgOS40MzI1NTU0MyAtMTggMTEgQy0xNy45MDQ4MDU0NiAxMi44OTU3NjM2NiAtMTcuOTA0ODA1NDYgMTIuODk1NzYzNjYgLTE3IDE1IEMtMTQuNTcyODYxMyAxNi44NzM4MTgyMSAtMTQuNTcyODYxMyAxNi44NzM4MTgyMSAtMTEuNjI1IDE4LjUgQy03LjkzODczNzE5IDIwLjYzOTc4MzE2IC01LjIyOTM2OTIyIDIyLjMxNTc1MDIyIC0zIDI2IEMtMS41MDg4MTc1MSAzMS42NDUxOTA4NSAtMi4xNzg0MTgzNiAzNC45MjExNTMwNiAtNSA0MCBDLTkuMzQ2NDcyNTcgNDUuMTQ3MTM4NTcgLTEzLjQ5MjA4MjkgNDcuMDc2ODA4NDEgLTIwLjEyNSA0Ny43NSBDLTI1Ljk4NTQzMDQyIDQ4LjIyMDQyOTExIC0zMS4zMDM1NDk3NiA0Ny4zMzMyMTE3NiAtMzcgNDYgQy0zOC4wOTg5ODcwMiA0Mi43MDMwMzg5NSAtMzcuODcxMjQ0NDQgNDEuNTk1MDUwOTcgLTM3LjA2MjUgMzguMzEyNSBDLTM2Ljg2Nzg1MTU2IDM3LjUwNDI1NzgxIC0zNi42NzMyMDMxMyAzNi42OTYwMTU2MyAtMzYuNDcyNjU2MjUgMzUuODYzMjgxMjUgQy0zNi4zMTY2Nzk2OSAzNS4yNDgzOTg0NCAtMzYuMTYwNzAzMTIgMzQuNjMzNTE1NjMgLTM2IDM0IEMtMzQuODQ1IDM0LjMzIC0zMy42OSAzNC42NiAtMzIuNSAzNSBDLTI4LjE4MjA3NzU3IDM2LjA3MzcyODQ5IC0yNC40NDM3NDM0NCAzNi4zMDEyNzA3NCAtMjAgMzYgQy0xOS4wMSAzNS4zNCAtMTguMDIgMzQuNjggLTE3IDM0IEMtMTcuMTc4MjU1OTkgMzIuMDY3MDg1MjEgLTE3LjE3ODI1NTk5IDMyLjA2NzA4NTIxIC0xOCAzMCBDLTE5LjkwMzM3ODEzIDI4LjYwODcxNTU2IC0xOS45MDMzNzgxMyAyOC42MDg3MTU1NiAtMjIuMjUgMjcuNTYyNSBDLTMxLjA3MTA4MzE3IDIyLjkxMzE3MTEzIC0zMS4wNzEwODMxNyAyMi45MTMxNzExMyAtMzIuNjYwMTU2MjUgMTcuOTI5Njg3NSBDLTMzLjUwOTcyNjg3IDEzLjA2MzIxNTAxIC0zMy4wODExMzgwMSA5LjYxMDg4NDM3IC0zMC4yOTI5Njg3NSA1LjUgQy0yMi4zNjg4Mzc3IC0zLjY5Mjk0OTYyIC0xMC42NjIyMzUzMyAtMi42NjU1NTg4MyAwIDAgWiAiIGZpbGw9IiMyMjM5ODUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE0Niw1NSkiLz4KPHBhdGggZD0iTTAgMCBDNC4yNTM4MDEzOCAxLjUxOTIxNDc4IDUuODUwNjA1NjkgNC4xMzEwOTAyNCA4IDggQzEwLjIxNjIxNjM0IDE0LjEzODE3MjIyIDExLjE3ODUwNDM3IDIwLjIzMzA3NjcgOC41NjI1IDI2LjM3NSBDNyAyOSA3IDI5IDYgMzAgQzMuNjM2NzE4NzUgMzAuMjk2ODc1IDMuNjM2NzE4NzUgMzAuMjk2ODc1IDEgMzAgQy0wLjczMDQ2ODc1IDI4LjM5MDYyNSAtMC43MzA0Njg3NSAyOC4zOTA2MjUgLTIuMTg3NSAyNi4yNSBDLTIuOTIwMzMyMDMgMjUuMjA1ODU5MzggLTIuOTIwMzMyMDMgMjUuMjA1ODU5MzggLTMuNjY3OTY4NzUgMjQuMTQwNjI1IEMtNC45MTMwODMwNCAyMi4xMzk2Nzg4OCAtNS45ODkwNDQ2MiAyMC4xMjczMTg0MyAtNyAxOCBDLTcuMTk5MTYwMTYgMTkuMjY0NTcwMzEgLTcuMTk5MTYwMTYgMTkuMjY0NTcwMzEgLTcuNDAyMzQzNzUgMjAuNTU0Njg3NSBDLTcuNTc4OTQ1MzEgMjEuNjUwMzkwNjIgLTcuNzU1NTQ2ODggMjIuNzQ2MDkzNzUgLTcuOTM3NSAyMy44NzUgQy04LjExMTUyMzQ0IDI0Ljk2NTU0Njg4IC04LjI4NTU0Njg4IDI2LjA1NjA5Mzc1IC04LjQ2NDg0Mzc1IDI3LjE3OTY4NzUgQy05IDMwIC05IDMwIC0xMCAzMiBDLTExLjg3NSAzMS43NSAtMTEuODc1IDMxLjc1IC0xNCAzMSBDLTE1LjI1IDI4LjkzNzUgLTE1LjI1IDI4LjkzNzUgLTE2IDI3IEMtMTYuNDMzMTI1IDI3LjQ3NDM3NSAtMTYuODY2MjUgMjcuOTQ4NzUgLTE3LjMxMjUgMjguNDM3NSBDLTIxLjI2ODUzMTg1IDMyLjEwMDQ5MjQ1IC0yNi43NTQ4NDI1IDMxLjMyNjM3NjY4IC0zMS44MjAzMTI1IDMxLjI4MTI1IEMtMzYuMjA3MDY0MDkgMzAuODkzMjMyNjYgLTM3LjkwMzMwOTI4IDMwLjA5NjY5MDcyIC00MSAyNyBDLTQyLjU2MjUgMjQuNSAtNDIuNTYyNSAyNC41IC00MyAyMiBDLTQxLjYyNSAxOS42ODc1IC00MS42MjUgMTkuNjg3NSAtNDAgMTggQy00MS4zMiAxNy4wMSAtNDIuNjQgMTYuMDIgLTQ0IDE1IEMtNDQgMTEuNzUgLTQ0IDExLjc1IC00MyA4IEMtMzcuODIzNzMwOTQgMy44MDUyMDc0OSAtMzIuMDE2MTEwNTQgMy40NTA1OTcyMiAtMjUuNjI1IDMuNjg3NSBDLTI0LjgxOTMzNTk0IDMuNjk3MTY3OTcgLTI0LjAxMzY3MTg4IDMuNzA2ODM1OTQgLTIzLjE4MzU5Mzc1IDMuNzE2Nzk2ODggQy0xNy4zNDEzMjczMSAzLjgyOTMzNjM1IC0xNy4zNDEzMjczMSAzLjgyOTMzNjM1IC0xNSA1IEMtMTUuMzEyNSA2LjkzNzUgLTE1LjMxMjUgNi45Mzc1IC0xNiA5IEMtMjAuMjg5NzAxMzQgMTAuNDI5OTAwNDUgLTI0LjU3MTM0MzI0IDEwLjQzODEyMTc2IC0yOS4wNjY0MDYyNSAxMC43MTg3NSBDLTMxLjkzMTY1NzQ2IDEwLjgxNTkwNjYxIC0zMS45MzE2NTc0NiAxMC44MTU5MDY2MSAtMzQgMTIgQy0zMy4wMzU3ODEyNSAxMi4xMDk1NzAzMSAtMzIuMDcxNTYyNSAxMi4yMTkxNDA2MiAtMzEuMDc4MTI1IDEyLjMzMjAzMTI1IEMtMjkuODE0ODQzNzUgMTIuNDkwNTg1OTQgLTI4LjU1MTU2MjUgMTIuNjQ5MTQwNjMgLTI3LjI1IDEyLjgxMjUgQy0yNS4zNzA1NDY4NyAxMy4wMzg3MzA0NyAtMjUuMzcwNTQ2ODcgMTMuMDM4NzMwNDcgLTIzLjQ1MzEyNSAxMy4yNjk1MzEyNSBDLTIwLjA1NDQ1OTUzIDEzLjk4ODQ3OTcxIC0xOC40MjUxMDM5MSAxNC41NjkwMDk5MSAtMTYgMTcgQy0xNS42NyAxNy45OSAtMTUuMzQgMTguOTggLTE1IDIwIEMtMTQuODc4ODI4MTMgMTkuMzI0NTMxMjUgLTE0Ljc1NzY1NjI1IDE4LjY0OTA2MjUgLTE0LjYzMjgxMjUgMTcuOTUzMTI1IEMtMTQuNDY1MjM0MzggMTcuMDYxMDkzNzUgLTE0LjI5NzY1NjI1IDE2LjE2OTA2MjUgLTE0LjEyNSAxNS4yNSBDLTEzLjk2MjU3ODEzIDE0LjM2ODI4MTI1IC0xMy44MDAxNTYyNSAxMy40ODY1NjI1IC0xMy42MzI4MTI1IDEyLjU3ODEyNSBDLTEzLjAzMjAzNzM2IDEwLjEzMDUyMjU2IC0xMi4yMjAwMjg4MyA4LjE5NDAwMTQzIC0xMSA2IEMtOC43Njk1MzEyNSA2LjEyMTA5Mzc1IC04Ljc2OTUzMTI1IDYuMTIxMDkzNzUgLTYgNyBDLTMuNzYxNzE4NzUgOS43MjI2NTYyNSAtMy43NjE3MTg3NSA5LjcyMjY1NjI1IC0xLjY4NzUgMTMuMDYyNSBDLTAuOTkwMTE3MTkgMTQuMTY3MjI2NTYgLTAuMjkyNzM0MzggMTUuMjcxOTUzMTIgMC40MjU3ODEyNSAxNi40MTAxNTYyNSBDMS4yMDUwMTk1MyAxNy42OTIxMjg5MSAxLjIwNTAxOTUzIDE3LjY5MjEyODkxIDIgMTkgQzEuODAwODM5ODQgMTcuODA1MDM5MDYgMS44MDA4Mzk4NCAxNy44MDUwMzkwNiAxLjU5NzY1NjI1IDE2LjU4NTkzNzUgQzEuMDY1MTA0MTcgMTMuMzkwNjI1IDAuNTMyNTUyMDggMTAuMTk1MzEyNSAwIDcgQy0wLjIwNzUzOTA2IDUuODk5MTQwNjMgLTAuNDE1MDc4MTMgNC43OTgyODEyNSAtMC42Mjg5MDYyNSAzLjY2NDA2MjUgQy0wLjc1MTM2NzE5IDIuNzg0OTIxODcgLTAuODczODI4MTMgMS45MDU3ODEyNSAtMSAxIEMtMC42NyAwLjY3IC0wLjM0IDAuMzQgMCAwIFogTS0yOCAxOCBDLTI2LjE4Nzc3NDY2IDIwLjA2MjQ5OTQgLTI2LjE4Nzc3NDY2IDIwLjA2MjQ5OTQgLTI0IDIyIEMtMjMuMDEgMjIgLTIyLjAyIDIyIC0yMSAyMiBDLTIxLjMzIDIxLjAxIC0yMS42NiAyMC4wMiAtMjIgMTkgQy0yNC45NyAxOC41MDUgLTI0Ljk3IDE4LjUwNSAtMjggMTggWiBNLTM5IDIyIEMtMzkgMjIuNjYgLTM5IDIzLjMyIC0zOSAyNCBDLTM2LjAzIDI0LjMzIC0zMy4wNiAyNC42NiAtMzAgMjUgQy0zMi4zNTk2ODc0NCAyMi45MDI1MDAwNSAtMzMuNTQ2MTY5OTQgMjIuMDMwOTQyOTYgLTM2Ljc1IDIxLjgxMjUgQy0zNy40OTI1IDIxLjg3NDM3NSAtMzguMjM1IDIxLjkzNjI1IC0zOSAyMiBaICIgZmlsbD0iIzIyMUUyMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjIwLDY3KSIvPgo8cGF0aCBkPSJNMCAwIEMyLjA1NDY4NzUgLTAuMTk5MjE4NzUgMi4wNTQ2ODc1IC0wLjE5OTIxODc1IDUuODY3MTg3NSAwLjM2MzI4MTI1IEM4LjI4Mjg5NDcyIDIuNDI4NzM2NjggMTAuMDk2NDE2NDkgNC43MzM5NTQ2IDExLjg2NzE4NzUgNy4zNjMyODEyNSBDMTIuMTQ5NDkyMTkgNi44NDYzNjcxOSAxMi40MzE3OTY4NyA2LjMyOTQ1MzEzIDEyLjcyMjY1NjI1IDUuNzk2ODc1IEMxNC4yNzE2ODgxMyAzLjQ3NTU5ODQ4IDE1LjU3MTg3NDIgMS45NzEyNTAyOCAxNy44NjcxODc1IDAuMzYzMjgxMjUgQzI2LjQ3NDM3MzUgLTAuNzg0MzQzNTUgMzQuOTQxNzAyNzcgMi4yOTMwNDg0MyA0Mi44NjcxODc1IDUuMzYzMjgxMjUgQzQxLjE2MTc1MzAxIDkuMTA0MjM0MzIgMzkuMjkzODYwOCAxMS4wMjMxMTQxMiAzNS44NjcxODc1IDEzLjM2MzI4MTI1IEMzNC44NzcxODc1IDEzLjM2MzI4MTI1IDMzLjg4NzE4NzUgMTMuMzYzMjgxMjUgMzIuODY3MTg3NSAxMy4zNjMyODEyNSBDMzIuMjA3MTg3NSAxMi4zNzMyODEyNSAzMS41NDcxODc1IDExLjM4MzI4MTI1IDMwLjg2NzE4NzUgMTAuMzYzMjgxMjUgQzI4LjY3MjY0MDY5IDkuNzgzMzQ0MjYgMjguNjcyNjQwNjkgOS43ODMzNDQyNiAyNi4yNDIxODc1IDkuNjc1NzgxMjUgQzI1LjQyNDkyMTg4IDkuNjEwMDM5MDYgMjQuNjA3NjU2MjUgOS41NDQyOTY4OCAyMy43NjU2MjUgOS40NzY1NjI1IEMyMi44MjU4OTg0NCA5LjQyMDQ4ODI4IDIyLjgyNTg5ODQ0IDkuNDIwNDg4MjggMjEuODY3MTg3NSA5LjM2MzI4MTI1IEMyMS43NTg4NzYwNCA5Ljk5OTk5MjUyIDIxLjY1MDU2NDU4IDEwLjYzNjcwMzggMjEuNTM4OTcwOTUgMTEuMjkyNzA5MzUgQzIwLjQxMzg1NTQzIDE3Ljg5NjI5MTI1IDE5LjI3NjQ4MDM1IDI0LjQ5NzY3NjE0IDE4LjEzMTgzNTk0IDMxLjA5NzkwMDM5IEMxNy43MDU4MDczNiAzMy41NjQxNTA1NiAxNy4yODI5NDkwNyAzNi4wMzA5NTA1MSAxNi44NjMyODEyNSAzOC40OTgyOTEwMiBDMTYuMjYwODYwODcgNDIuMDM2ODAwMzYgMTUuNjQ3MjEwNTMgNDUuNTczMjAwOSAxNS4wMzEyNSA0OS4xMDkzNzUgQzE0Ljg0NDcwODU2IDUwLjIxOTc3NjQ2IDE0LjY1ODE2NzExIDUxLjMzMDE3NzkyIDE0LjQ2NTk3MjkgNTIuNDc0MjI3OTEgQzE0LjI4NTkzNzE5IDUzLjQ5NTIxMDcyIDE0LjEwNTkwMTQ5IDU0LjUxNjE5MzU0IDEzLjkyMDQxMDE2IDU1LjU2ODExNTIzIEMxMy42ODcyNDU5NCA1Ni45MjM3OTg2IDEzLjY4NzI0NTk0IDU2LjkyMzc5ODYgMTMuNDQ5MzcxMzQgNTguMzA2ODY5NTEgQzEzLjI1NzI1MDY3IDU4Ljk4NTQ4NTM4IDEzLjA2NTEzIDU5LjY2NDEwMTI2IDEyLjg2NzE4NzUgNjAuMzYzMjgxMjUgQzExLjg3NzE4NzUgNjAuODU4MjgxMjUgMTEuODc3MTg3NSA2MC44NTgyODEyNSAxMC44NjcxODc1IDYxLjM2MzI4MTI1IEM5LjU4MDQ1Mjg0IDU0LjQ1OTA5MjQzIDguMjk5Mjc3MDIgNDcuNTUzODg4ODYgNy4wMjE5NzI2NiA0MC42NDc5NDkyMiBDNi41ODY3MzE3NyAzOC4yOTg0Mjc0MSA2LjE1MDIxNTc5IDM1Ljk0OTE0MTQ1IDUuNzEyNDAyMzQgMzMuNjAwMDk3NjYgQzUuMDgzNTYyMzcgMzAuMjI0ODk1MzcgNC40NTkzMDI5NCAyNi44NDg4NzMzNSAzLjgzNTkzNzUgMjMuNDcyNjU2MjUgQzMuNTQwNjQxNDggMjEuODk1OTAxMTggMy41NDA2NDE0OCAyMS44OTU5MDExOCAzLjIzOTM3OTg4IDIwLjI4NzI5MjQ4IEMzLjA1OTE5MzEyIDE5LjMwNjU3Nzc2IDIuODc5MDA2MzUgMTguMzI1ODYzMDQgMi42OTMzNTkzOCAxNy4zMTU0Mjk2OSBDMi41MzM0NzUzNCAxNi40NTM4MzI0IDIuMzczNTkxMzEgMTUuNTkyMjM1MTEgMi4yMDg4NjIzIDE0LjcwNDUyODgxIEMxLjg2NzE4NzUgMTIuMzYzMjgxMjUgMS44NjcxODc1IDEyLjM2MzI4MTI1IDEuODY3MTg3NSA4LjM2MzI4MTI1IEMtMS43NjI4MTI1IDkuMDIzMjgxMjUgLTUuMzkyODEyNSA5LjY4MzI4MTI1IC05LjEzMjgxMjUgMTAuMzYzMjgxMjUgQy05LjQ2MjgxMjUgMTEuMzUzMjgxMjUgLTkuNzkyODEyNSAxMi4zNDMyODEyNSAtMTAuMTMyODEyNSAxMy4zNjMyODEyNSBDLTE1LjA4OTc3ODMxIDEyLjEyNDAzOTggLTE3LjI0OTM5NzE2IDEwLjU3NzUwMzY3IC0yMC4xMzI4MTI1IDYuMzYzMjgxMjUgQy0xMy40NzU0Nzc3IDMuMTIxMTc0OTQgLTcuMjY2ODA3MzkgMS4yMzc3NTI5MSAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3NzUuMTMyODEyNSwzNS42MzY3MTg3NSkiLz4KPHBhdGggZD0iTTAgMCBDOC41OCAwIDE3LjE2IDAgMjYgMCBDMjYgMy4zIDI2IDYuNiAyNiAxMCBDMjAuNzIgMTAgMTUuNDQgMTAgMTAgMTAgQzEwIDEzLjYzIDEwIDE3LjI2IDEwIDIxIEMxMy45NiAyMSAxNy45MiAyMSAyMiAyMSBDMjIgMjQuMyAyMiAyNy42IDIyIDMxIEMxOC4wNCAzMSAxNC4wOCAzMSAxMCAzMSBDMTAgMzUuMjkgMTAgMzkuNTggMTAgNDQgQzE3LjkyIDQzLjUwNSAxNy45MiA0My41MDUgMjYgNDMgQzI2IDQ2LjMgMjYgNDkuNiAyNiA1MyBDMjIuODY0NjI0MDIgNTQuMDQ1MTI1MzMgMjAuMjI4NTQ5MDIgNTQuMzE1Mzc3MTMgMTYuOTM3NSA1NC41NjI1IEMxNS44NzQwMjM0NCA1NC42NDYyODkwNiAxNC44MTA1NDY4OCA1NC43MzAwNzgxMyAxMy43MTQ4NDM3NSA1NC44MTY0MDYyNSBDOS4xNDgzOTI5NSA1NS4wNDIwODc4NCA0LjU3MjAyNDE4IDU1IDAgNTUgQzAgMzYuODUgMCAxOC43IDAgMCBaICIgZmlsbD0iI0Q4MUUyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAzNSw1MikiLz4KPHBhdGggZD0iTTAgMCBDMS45MTAxNTYyNSAwLjgyMDMxMjUgMS45MTAxNTYyNSAwLjgyMDMxMjUgNC41MzUxNTYyNSAyLjMyMDMxMjUgQzQuNTM1MTU2MjUgNC45NjAzMTI1IDQuNTM1MTU2MjUgNy42MDAzMTI1IDQuNTM1MTU2MjUgMTAuMzIwMzEyNSBDMS43NzIzOTQ0OCA5Ljc5NzYyNzg0IC0wLjc5MDkzMTM1IDkuMjExNjE2NjMgLTMuNDY0ODQzNzUgOC4zMjAzMTI1IEMtNS4wMjYwMjgwMyA4LjI1MjkwMzg1IC02LjU4OTg2ODk1IDguMjM1MTY3OTQgLTguMTUyMzQzNzUgOC4yNTc4MTI1IEMtOC45NjA1ODU5NCA4LjI2NjgzNTk0IC05Ljc2ODgyODEzIDguMjc1ODU5MzcgLTEwLjYwMTU2MjUgOC4yODUxNTYyNSBDLTExLjIxNjQ0NTMxIDguMjk2NzU3ODEgLTExLjgzMTMyODEzIDguMzA4MzU5MzggLTEyLjQ2NDg0Mzc1IDguMzIwMzEyNSBDLTEyLjc5NDg0Mzc1IDkuMzEwMzEyNSAtMTMuMTI0ODQzNzUgMTAuMzAwMzEyNSAtMTMuNDY0ODQzNzUgMTEuMzIwMzEyNSBDLTEyLjU4NDQxNDA2IDExLjcwNzAzMTI1IC0xMS43MDM5ODQzNyAxMi4wOTM3NSAtMTAuNzk2ODc1IDEyLjQ5MjE4NzUgQy05LjYzNTQyOTY5IDEzLjAxMjk2ODc1IC04LjQ3Mzk4NDM4IDEzLjUzMzc1IC03LjI3NzM0Mzc1IDE0LjA3MDMxMjUgQy01LjU1NDUxMTcyIDE0LjgzNjAxNTYzIC01LjU1NDUxMTcyIDE0LjgzNjAxNTYzIC0zLjc5Njg3NSAxNS42MTcxODc1IEMwLjI0MTM3MzEyIDE3LjY4MTI4NjE5IDMuNTY0NTg1NyAxOS42ODc5ODkzIDUuOTEwMTU2MjUgMjMuNjMyODEyNSBDNi45OTYzOTk0NiAyOC4zMDM2NTgzIDYuMzE4NTczOSAzMS44ODQwNDY4MSA0LjAzNTE1NjI1IDM2LjA3MDMxMjUgQy0wLjE5NDIwMDc5IDM5Ljg3NjczMzg0IC00LjYxMjE4MDA4IDQxLjI1NzA5NTU4IC0xMC4yODUxNTYyNSA0MS4zODI4MTI1IEMtMTUuNjc4ODQ0MzEgNDEuMDMwMDkxNzUgLTE5Ljg2NjQ0MTQ4IDQwLjE3ODc3ODc4IC0yNC40NjQ4NDM3NSAzNy4zMjAzMTI1IEMtMjQuNDY0ODQzNzUgMzQuMDIwMzEyNSAtMjQuNDY0ODQzNzUgMzAuNzIwMzEyNSAtMjQuNDY0ODQzNzUgMjcuMzIwMzEyNSBDLTIzLjE2NTQ2ODc1IDI3Ljk4MDMxMjUgLTIxLjg2NjA5Mzc1IDI4LjY0MDMxMjUgLTIwLjUyNzM0Mzc1IDI5LjMyMDMxMjUgQy0xNS41OTQwNTE2OSAzMS41NDQyMDkyNCAtMTEuODI1MTI2MDMgMzEuNjYwNjQ3ODggLTYuNDY0ODQzNzUgMzEuMzIwMzEyNSBDLTYuNDY0ODQzNzUgMzAuMDAwMzEyNSAtNi40NjQ4NDM3NSAyOC42ODAzMTI1IC02LjQ2NDg0Mzc1IDI3LjMyMDMxMjUgQy03LjQxNzQ2MDk0IDI2Ljk1Njc5Njg3IC04LjM3MDA3ODEyIDI2LjU5MzI4MTI1IC05LjM1MTU2MjUgMjYuMjE4NzUgQy0yMi40OTU3MTQwNSAyMS4wMzAxNzczIC0yMi40OTU3MTQwNSAyMS4wMzAxNzczIC0yNS40NjQ4NDM3NSAxNS4zMjAzMTI1IEMtMjYuMjE3MDIwNTkgMTEuNDI4OTQ4NjQgLTI1LjgyMjM5NTM5IDguMjE0MTkxNTkgLTI0LjMzOTg0Mzc1IDQuNTA3ODEyNSBDLTE4LjQ5MTUxODczIC0yLjMxNTIzMzM1IC04LjEzNzk4MzIgLTIuMjQ0MDcxNDQgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTY5LjQ2NDg0Mzc1LDQwLjY3OTY4NzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzguOTEgMCAxNy44MiAwIDI3IDAgQzI3IDMuMyAyNyA2LjYgMjcgMTAgQzIxLjM5IDEwIDE1Ljc4IDEwIDEwIDEwIEMxMCAxMy42MyAxMCAxNy4yNiAxMCAyMSBDMTQuMjkgMjEgMTguNTggMjEgMjMgMjEgQzIzIDI0LjMgMjMgMjcuNiAyMyAzMSBDMTguNzEgMzEgMTQuNDIgMzEgMTAgMzEgQzEwIDM3LjkzIDEwIDQ0Ljg2IDEwIDUyIEM2LjcgNTIgMy40IDUyIDAgNTIgQzAgMzQuODQgMCAxNy42OCAwIDAgWiAiIGZpbGw9IiNEODFFMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExMDEsNTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuOTcgMCA1Ljk0IDAgOSAwIEM5IDEzLjUzIDkgMjcuMDYgOSA0MSBDNS4zNyA0MSAxLjc0IDQxIC0yIDQxIEMtMy4yMTY4NzUgNDEuMjQ3NSAtNC40MzM3NSA0MS40OTUgLTUuNjg3NSA0MS43NSBDLTEwLjMxMDAyNjQxIDQyLjA5ODg2OTkyIC0xMy4zMDg5OTE4NSA0MC43MzUwMDM3OSAtMTcgMzggQy0yMC42ODY4MTg5NSAzMy4xNjEwNTAxMyAtMjAuNjk0NzYzNjEgMjcuODUzMTQ1NTEgLTIwIDIyIEMtMTguNzI2MDcyMzggMTguMzEyMzE0NzcgLTE3Ljc0NDY5MDYyIDE2LjU4MzY3NjQzIC0xNC42ODc1IDE0LjE4NzUgQy05LjYzMTE5NDU5IDExLjk1MzMxODU0IC02LjQ1NjIyNjA3IDExLjkwODc1NDc5IC0xIDEzIEMtMC42NyA4LjcxIC0wLjM0IDQuNDIgMCAwIFogTS05LjQzNzUgMjEuMDYyNSBDLTExLjI1OTI1OTU5IDI0LjQ4NzQwODAyIC0xMS42MzY3NDE4MyAyNi4xNzk1NDkgLTExIDMwIEMtOS40NTY2NDk3MSAzMi45NTA0NzU1MyAtOS40NTY2NDk3MSAzMi45NTA0NzU1MyAtNyAzNSBDLTQuNDE0MTc4NzIgMzUuNTg0MDIxMzMgLTQuNDE0MTc4NzIgMzUuNTg0MDIxMzMgLTIgMzUgQzAuMzI4NjYyMjkgMzMuMTExNTM4MTcgMC4zMjg2NjIyOSAzMy4xMTE1MzgxNyAwLjE5NTMxMjUgMjkuOTYwOTM3NSBDMC4xNzIxMDkzOCAyOC43Nzc1NzgxMiAwLjE0ODkwNjI1IDI3LjU5NDIxODc1IDAuMTI1IDI2LjM3NSBDMC4xMDY5NTMxMyAyNS4xODY0ODQzNyAwLjA4ODkwNjI1IDIzLjk5Nzk2ODc1IDAuMDcwMzEyNSAyMi43NzM0Mzc1IEMwLjA0NzEwOTM4IDIxLjg1ODIwMzEzIDAuMDIzOTA2MjUgMjAuOTQyOTY4NzUgMCAyMCBDLTUuMTAxNDUzNyAxOC41Nzg2MzU2MiAtNS4xMDE0NTM3IDE4LjU3ODYzNTYyIC05LjQzNzUgMjEuMDYyNSBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjEzMSw0MCkiLz4KPHBhdGggZD0iTTAgMCBDOS45IDAgMTkuOCAwIDMwIDAgQzMwIDMuMyAzMCA2LjYgMzAgMTAgQzI2LjcgMTAgMjMuNCAxMCAyMCAxMCBDMjAgMjMuODYgMjAgMzcuNzIgMjAgNTIgQzE1LjA1IDUyLjQ5NSAxNS4wNSA1Mi40OTUgMTAgNTMgQzEwIDM4LjgxIDEwIDI0LjYyIDEwIDEwIEM2LjcgMTAgMy40IDEwIDAgMTAgQzAgNi43IDAgMy40IDAgMCBaICIgZmlsbD0iI0Q4MUUyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA2Niw1MikiLz4KPHBhdGggZD0iTTAgMCBDLTAuNDgxMTQ5MSA1Ljc3Mzc4OTI1IC0yLjE4NDY3MTgxIDkuOTU4NTk4MzYgLTUgMTUgQy00LjMxOTM3NSAxNC4yOTg3NSAtMy42Mzg3NSAxMy41OTc1IC0yLjkzNzUgMTIuODc1IEMtMS45NjMyMDUxNCAxMS45MTE3MTQxMyAtMC45ODM1MTk0NiAxMC45NTM4NjU2MSAwIDEwIEMwLjU1NDI5Njg3IDkuNDYxMTcxODggMS4xMDg1OTM3NSA4LjkyMjM0Mzc1IDEuNjc5Njg3NSA4LjM2NzE4NzUgQzUuMjUwOTM2OCA1LjA4MTYzODE0IDcuODk2NjgzMzIgMi44ODQwMTU1MyAxMyAzIEMxNS4wMDY0OTYwNyA0LjUzNjM3NTAxIDE1Ljg3Mzg5MDQ5IDUuNTg4MTQ4NyAxNi42MTcxODc1IDguMDE1NjI1IEMxNy4yNTE1NjExIDEzLjUxMzUyOTUzIDE2Ljg0OTMwMTA3IDE3LjA2MTIxMTQ3IDE0IDIyIEMxMS4wNTUwNzk0MyAyNS40MDk5MDgwMyA4LjEyMTcwMjE1IDI4LjEzNTQyMDQ2IDQgMzAgQzEuNjY3MTQ1MiAzMC4wNDcyNTM5OSAtMC42NjcyNDM5MyAzMC4wNTE4OTk3MyAtMyAzMCBDLTMuMjY1NTQ2ODggMzEuMDczNzg5MDYgLTMuNTMxMDkzNzUgMzIuMTQ3NTc4MTIgLTMuODA0Njg3NSAzMy4yNTM5MDYyNSBDLTQuMTYxMzk0MjEgMzQuNjkwMTIwMSAtNC41MTgxNjg2NiAzNi4xMjYzMTcxMiAtNC44NzUgMzcuNTYyNSBDLTUuMDQ5MDIzNDQgMzguMjY2OTcyNjYgLTUuMjIzMDQ2ODggMzguOTcxNDQ1MzEgLTUuNDAyMzQzNzUgMzkuNjk3MjY1NjIgQy02LjUxMjk0ODE1IDQ0LjE2MDI0OTk4IC03LjcxMjAxMjE2IDQ4LjU4NDg3MDUyIC05IDUzIEMtMTMuODc1IDUxLjI1IC0xMy44NzUgNTEuMjUgLTE1IDQ5IEMtMTUuODA3NzM2NjkgNDEuNjExMTk1NTcgLTE0LjQ0MzM4Mzc0IDM1LjkyMzE3NjkzIC0xMS44NzEwOTM3NSAyOS4wNDI5Njg3NSBDLTEwLjkzNjk5MDk5IDI1Ljc3OTg5MjMxIC0xMC44OTM4OTA4MiAyMy4yNTE1MDY5MSAtMTEuMDYyNSAxOS44NzUgQy0xMS4zNDcwMDEzMyAxMi4zOTk0ODI0MiAtOC41MjkxMDMxNSA3LjAzNDkyMzc4IC0zLjgxMjUgMS4zNzUgQy0yIDAgLTIgMCAwIDAgWiBNMTAgMTAgQzcuOTU1NDM5NDEgMTIuMTcyNjQ2NTUgNy45NTU0Mzk0MSAxMi4xNzI2NDY1NSA1Ljg3NSAxNC44NzUgQzUuMTUwNTQ2ODggMTUuNzc5OTIxODcgNC40MjYwOTM3NSAxNi42ODQ4NDM3NSAzLjY3OTY4NzUgMTcuNjE3MTg3NSBDMS44MDc5NDc2NiAxOS43ODY1NTgxMSAxLjgwNzk0NzY2IDE5Ljc4NjU1ODExIDIgMjIgQzYuMDE1MzA1MDUgMjEuMDg3NDMwNjcgNy43MTEyODI3NSAyMC4zNDk0OTk4MyAxMC4zNzUgMTcuMTI1IEMxMi4zMDc1Njg0OSAxMy45OTU1NjM5MiAxMi4zMDc1Njg0OSAxMy45OTU1NjM5MiAxMiAxMCBDMTEuMzQgMTAgMTAuNjggMTAgMTAgMTAgWiAiIGZpbGw9IiMyMjFFMjAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDY2NSw3MCkiLz4KPHBhdGggZD0iTTAgMCBDMy4zIDAgNi42IDAgMTAgMCBDMTAgMTQuMTkgMTAgMjguMzggMTAgNDMgQzEzLjk2IDQzIDE3LjkyIDQzIDIyIDQzIEMyMy4zMiA0My4zMyAyNC42NCA0My42NiAyNiA0NCBDMjYgNDcuMyAyNiA1MC42IDI2IDU0IEMxMy4xMyA1My41MDUgMTMuMTMgNTMuNTA1IDAgNTMgQzAgMzUuNTEgMCAxOC4wMiAwIDAgWiAiIGZpbGw9IiNEODFFMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExMzMsNTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMyAwIDYuNiAwIDEwIDAgQzEwLjMzIDQuNjIgMTAuNjYgOS4yNCAxMSAxNCBDMTIuNTQ2ODc1IDEzLjQ0MzEyNSAxMi41NDY4NzUgMTMuNDQzMTI1IDE0LjEyNSAxMi44NzUgQzE4LjM5OTA1MzgzIDExLjkwOTg5MTA3IDIwLjEwMjI4MDU4IDEyLjEzOTcyNDgyIDI0IDE0IEMyNS45NTA0Njk0MiAxNS42MTQxODE1OSAyNi44NzAxODY5MyAxNi43NDAzNzM4NiAyOCAxOSBDMjguMDcxODE4MjEgMjEuNzE3NjAxMDggMjguMDkyOTk1MDYgMjQuNDA4NTkzODggMjguMDYyNSAyNy4xMjUgQzI4LjA1Nzk4ODI4IDI3Ljg3OTEwMTU2IDI4LjA1MzQ3NjU2IDI4LjYzMzIwMzEyIDI4LjA0ODgyODEyIDI5LjQxMDE1NjI1IEMyOC4wMzcwMzQ5OSAzMS4yNzM0NzEyNyAyOC4wMTkwOTk0MiAzMy4xMzY3NDU1NSAyOCAzNSBDMjMuNTQ1IDM1LjQ5NSAyMy41NDUgMzUuNDk1IDE5IDM2IEMxOC45Mzk0MTQwNiAzNS4wODQ3NjU2MyAxOC44Nzg4MjgxMiAzNC4xNjk1MzEyNSAxOC44MTY0MDYyNSAzMy4yMjY1NjI1IEMxOC43MzI2MTcxOSAzMi4wMzgwNDY4NyAxOC42NDg4MjgxMiAzMC44NDk1MzEyNSAxOC41NjI1IDI5LjYyNSBDMTguNDgxMjg5MDYgMjguNDQxNjQwNjMgMTguNDAwMDc4MTIgMjcuMjU4MjgxMjUgMTguMzE2NDA2MjUgMjYuMDM5MDYyNSBDMTguMTg5MTUwNjQgMjMuMDg0ODEwOTkgMTguMTg5MTUwNjQgMjMuMDg0ODEwOTkgMTcgMjEgQzE1LjMzMzg4MDk1IDIwLjk1NzI3OSAxMy42NjYxNzExNSAyMC45NTkzNjE2OCAxMiAyMSBDMTAuNDUwNDk3MzIgMjIuNTQ5NTAyNjggMTAuNzgzNDQ4MDcgMjQuMDk5OTA1OTQgMTAuNjgzNTkzNzUgMjYuMjUzOTA2MjUgQzEwLjY0MTY5OTIyIDI3LjEwNzkxMDE2IDEwLjU5OTgwNDY5IDI3Ljk2MTkxNDA2IDEwLjU1NjY0MDYyIDI4Ljg0MTc5Njg4IEMxMC41MTczMjQyMiAyOS43Mzk2Mjg5MSAxMC40NzgwMDc4MSAzMC42Mzc0NjA5NCAxMC40Mzc1IDMxLjU2MjUgQzEwLjM5NDMxNjQxIDMyLjQ2NDE5OTIyIDEwLjM1MTEzMjgxIDMzLjM2NTg5ODQ0IDEwLjMwNjY0MDYyIDM0LjI5NDkyMTg4IEMxMC4yMDAyMjAxNiAzNi41Mjk3NTE1NiAxMC4wOTk1NzUxOSAzOC43NjQ4NTQ4NiAxMCA0MSBDNi43IDQxIDMuNCA0MSAwIDQxIEMwIDI3LjQ3IDAgMTMuOTQgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDA1LDQwKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjI5IDAgOC41OCAwIDEzIDAgQzkuOTk1NDE0NiAxNi4wODQxMjA5OCA2Ljc1MDQyOTQ2IDMyLjA3MjY0NDI3IDMgNDggQy0xLjI5IDQ4IC01LjU4IDQ4IC0xMCA0OCBDLTkuMzUyMDc5OTYgNDIuMjQzMTY0OTggLTguMzkyNDE1OTEgMzYuNjQxMDIxMyAtNy4xODc1IDMwLjk3NjU2MjUgQy03LjAxMzcxODI2IDMwLjE0OTE3NTcyIC02LjgzOTkzNjUyIDI5LjMyMTc4ODk0IC02LjY2MDg4ODY3IDI4LjQ2OTMyOTgzIEMtNi4yOTYwMjY4NiAyNi43MzYyMTU3NCAtNS45Mjk1NTA3IDI1LjAwMzQ0MDc3IC01LjU2MTUyMzQ0IDIzLjI3MDk5NjA5IEMtNC45OTczNjgxOSAyMC42MTI1OTg0NyAtNC40Mzk3NTU1NCAxNy45NTI4ODU2NSAtMy44ODI4MTI1IDE1LjI5Mjk2ODc1IEMtMy41MjY0Mjg0MSAxMy42MDQwODUwMSAtMy4xNjk2NzA5OSAxMS45MTUyOCAtMi44MTI1IDEwLjIyNjU2MjUgQy0yLjY0NTgwODExIDkuNDMwNzc3ODkgLTIuNDc5MTE2MjEgOC42MzQ5OTMyOSAtMi4zMDczNzMwNSA3LjgxNTA5Mzk5IEMtMS4xMTUxOTMxMyAyLjIzMDM4NjI2IC0xLjExNTE5MzEzIDIuMjMwMzg2MjYgMCAwIFogIiBmaWxsPSIjMjIzMTc1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5OCw1NCkiLz4KPHBhdGggZD0iTTAgMCBDMCAzIDAgMyAtMSA1IEMtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAwIDE2IEMwLjc1NDE0MjM1IDIyLjQ5MDU2OTM3IC0wLjI2NzY1MDE5IDI1LjU4MjA3Mjg1IC00IDMxIEMtMy45Mjc0OTIxNCAzNC41NTI4ODQ5NCAtMy4zMTc3NDE2NCAzNi40OTE2MTMzNyAtMS40Mzc1IDM5LjUgQzAuNDMyMjMyNTQgNDIuNzUxNzA4NzYgMC40OTI4MjA0OCA0NC4yNjg2NDQ5NCAwIDQ4IEMtMS4xNzkwNDA1IDUxLjQwNDQxNTYzIC0yLjU0MTk2MzU0IDU0LjcwNjM5OTc4IC00IDU4IEMtMTMuMDQyMzMyOTIgNTUuOTEzMzA3NzkgLTE5LjIzMTExMzk5IDQ5LjIyNDI2NTc5IC0yNC42ODc1IDQyLjExMzI4MTI1IEMtMjUuOTc2NzY1MDIgNDAuMDM3NDExMDkgLTI2LjU2ODUwMjU3IDM4LjM4OTQxNzA0IC0yNyAzNiBDLTIyLjM3NSAzMyAtMjIuMzc1IDMzIC0xOSAzMyBDLTE5IDMzLjk5IC0xOSAzNC45OCAtMTkgMzYgQy0xNi4wMjk4MjMwNiAzNS4zNzE4OTgyNyAtMTYuMDI5ODIzMDYgMzUuMzcxODk4MjcgLTEzIDM0IEMtMTEuODAxNjE3OTEgMzEuNjcxNDU1MzcgLTExLjgwMTYxNzkxIDMxLjY3MTQ1NTM3IC0xMSAyOSBDLTEwLjMyMzI0MjE5IDI4LjI5NDg4MjgxIC05LjY0NjQ4NDM4IDI3LjU4OTc2NTYyIC04Ljk0OTIxODc1IDI2Ljg2MzI4MTI1IEMtNi4yODY2NTkzNyAyMi45NTIxNDY5MyAtNi42NDc5NDA5OCAyMC4wOTMyNzg3OCAtNi45Mzc1IDE1LjUgQy03LjQ2Nzc4NzQgNi4zMzQ3MzQyNSAtNy40Njc3ODc0IDYuMzM0NzM0MjUgLTQgMiBDLTEuODEyNSAwLjY4NzUgLTEuODEyNSAwLjY4NzUgMCAwIFogIiBmaWxsPSIjMTg3MjRFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ4LDYwKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjIyNzM1OTE0IDUuMDI2MTMzNCA0LjM0Mzc1IDYuNjc1NjQ0OTEgNC4zNDM3NSAxMy41OTc2NTYyNSBDLTEuOTI2MjUgMTMuNTk3NjU2MjUgLTguMTk2MjUgMTMuNTk3NjU2MjUgLTE0LjY1NjI1IDEzLjU5NzY1NjI1IEMtMTIuMzAwNDg3NzkgMTguNzcwMzg3NjYgLTEyLjMwMDQ4Nzc5IDE4Ljc3MDM4NzY2IC04LjUzMTI1IDE5LjU5NzY1NjI1IEMtMy43NTI5OTc1NyAxOS41OTc2NTYyNSAtMC4wNTEzNDIxNSAxOC4zNjE2NzI4MyA0LjM0Mzc1IDE2LjU5NzY1NjI1IEM0LjY1NjI1IDE5LjQxMDE1NjI1IDQuNjU2MjUgMTkuNDEwMTU2MjUgNC4zNDM3NSAyMi41OTc2NTYyNSBDMC45MDEyMjIwNSAyNS45MjU0MzMyNyAtMy40MTQ1NjU0OCAyNi4zMjk5Njg0IC04LjAyMzQzNzUgMjYuNjYwMTU2MjUgQy0xMy42ODcyNjY0IDI2LjUyNTcwMzM0IC0xOC4xMzQxNTE4MiAyNS4xMTk3NTQ0MyAtMjIuMTU2MjUgMjEuMDk3NjU2MjUgQy0yNC43NzM1ODM1MyAxNi43MzU0MzM3IC0yNS4zMTY1NTAzOCAxMi41OTU3NjMyOCAtMjQuNjU2MjUgNy41OTc2NTYyNSBDLTIzLjI5NDg1NjcgMy44NjEyMjM1NSAtMjEuNDAxMzMxNDIgMS4xNzA3OTU4IC0xOC4yMTg3NSAtMS4yNzczNDM3NSBDLTEyLjMxODQ0Njg5IC0zLjg2NzcyMDcyIC01LjI1NTA1Mjk0IC00LjQ0OTQ0MzQxIDAgMCBaIE0tMTMuNjU2MjUgNC41OTc2NTYyNSBDLTEzLjk4NjI1IDUuOTE3NjU2MjUgLTE0LjMxNjI1IDcuMjM3NjU2MjUgLTE0LjY1NjI1IDguNTk3NjU2MjUgQy0xMS4wMjYyNSA4LjU5NzY1NjI1IC03LjM5NjI1IDguNTk3NjU2MjUgLTMuNjU2MjUgOC41OTc2NTYyNSBDLTQuOTgzMjM1NTkgMy42NzQ2NDYzMyAtNC45ODMyMzU1OSAzLjY3NDY0NjMzIC03LjUzMTI1IDIuNjYwMTU2MjUgQy0xMC4yMTA5NzMzNSAyLjU4MTM0MDg2IC0xMS40ODU2NTkxNSAzLjAyNTg0OTA4IC0xMy42NTYyNSA0LjU5NzY1NjI1IFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDkxLjY1NjI1LDU1LjQwMjM0Mzc1KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjUyMDkwNTk1IDQuNTExMTYwNzUgMyA2LjQxMTcwNDg5IDMgMTIuNTYyNSBDLTMuMjcgMTIuNTYyNSAtOS41NCAxMi41NjI1IC0xNiAxMi41NjI1IEMtMTMuNjQ0MjM3NzkgMTcuNzM1MjMxNDEgLTEzLjY0NDIzNzc5IDE3LjczNTIzMTQxIC05Ljg3NSAxOC41NjI1IEMtNS4wOTY3NDc1NyAxOC41NjI1IC0xLjM5NTA5MjE1IDE3LjMyNjUxNjU4IDMgMTUuNTYyNSBDMy4zMTI1IDE4LjM3NSAzLjMxMjUgMTguMzc1IDMgMjEuNTYyNSBDLTAuNDQyNTI3OTUgMjQuODkwMjc3MDIgLTQuNzU4MzE1NDggMjUuMjk0ODEyMTUgLTkuMzY3MTg3NSAyNS42MjUgQy0xNS4wMzEwMTY0IDI1LjQ5MDU0NzA5IC0xOS40Nzc5MDE4MiAyNC4wODQ1OTgxOCAtMjMuNSAyMC4wNjI1IEMtMjYuMTE3MzMzNTMgMTUuNzAwMjc3NDUgLTI2LjY2MDMwMDM4IDExLjU2MDYwNzAzIC0yNiA2LjU2MjUgQy0yNC42Mzg2MDY3IDIuODI2MDY3MyAtMjIuNzQ1MDgxNDIgMC4xMzU2Mzk1NSAtMTkuNTYyNSAtMi4zMTI1IEMtMTIuNjA1NTU1NjYgLTUuMzY2NzY4MjUgLTUuOTgyNDU3MiAtNC44NjA3NDY0OCAwIDAgWiBNLTE1IDMuNTYyNSBDLTE1LjMzIDQuODgyNSAtMTUuNjYgNi4yMDI1IC0xNiA3LjU2MjUgQy0xMi4zNyA3LjU2MjUgLTguNzQgNy41NjI1IC01IDcuNTYyNSBDLTYuMzI2OTg1NTkgMi42Mzk0OTAwOCAtNi4zMjY5ODU1OSAyLjYzOTQ5MDA4IC04Ljg3NSAxLjYyNSBDLTExLjU1NDcyMzM1IDEuNTQ2MTg0NjEgLTEyLjgyOTQwOTE1IDEuOTkwNjkyODMgLTE1IDMuNTYyNSBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE2OSw1Ni40Mzc1KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjMgMCA2LjYgMCAxMCAwIEMxMCAxOC4xNSAxMCAzNi4zIDEwIDU1IEM3LjAzIDU1IDQuMDYgNTUgMSA1NSBDMCA1NCAwIDU0IC0wLjEyMDI1NDUyIDUxLjgyOTY5NjY2IEMtMC4xMTgwMzM5MSA1MC44NzI2MTMwNyAtMC4xMTU4MTMyOSA0OS45MTU1Mjk0OCAtMC4xMTM1MjUzOSA0OC45Mjk0NDMzNiBDLTAuMTEzNDQ5ODYgNDcuODQ4Mzk4MjggLTAuMTEzMzc0MzMgNDYuNzY3MzUzMjEgLTAuMTEzMjk2NTEgNDUuNjUzNTQ5MTkgQy0wLjEwODEzNTIyIDQ0LjQ3NzUyNjQgLTAuMTAyOTczOTQgNDMuMzAxNTAzNiAtMC4wOTc2NTYyNSA0Mi4wODk4NDM3NSBDLTAuMDk2MjQxMyA0MC44OTI2NzIyNyAtMC4wOTQ4MjYzNSAzOS42OTU1MDA3OSAtMC4wOTMzNjg1MyAzOC40NjIwNTEzOSBDLTAuMDg3NzQ5NzkgMzQuNjIwNTA5MzQgLTAuMDc1MTk0MTEgMzAuNzc5MDI0NTcgLTAuMDYyNSAyNi45Mzc1IEMtMC4wNTc0ODc0MSAyNC4zNDA0OTU2MyAtMC4wNTI5MjQwOSAyMS43NDM0OTAzNSAtMC4wNDg4MjgxMiAxOS4xNDY0ODQzOCBDLTAuMDM3Nzc0MjcgMTIuNzY0MzAwNjggLTAuMDIwNDk3MDggNi4zODIxNjAwNyAwIDAgWiAiIGZpbGw9IiNEODFGMjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExNjYsNTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMyAwIDYuNiAwIDEwIDAgQzEwIDAuNjYgMTAgMS4zMiAxMCAyIEMxMC45OSAxLjM0IDExLjk4IDAuNjggMTMgMCBDMTYuMzkyMTAyODcgLTAuNTQ2MTg2MDYgMTkuNjA2NTQzNSAtMC41MzU4MDg5MiAyMyAwIEMyNi42MTk5NTgyMSAyLjY1OTU2MTEzIDI4LjIwNjgzODE3IDQuNjQ4NDIzNTEgMjkgOSBDMjkuMDc4MTg2MzYgMTAuNTEzOTU2OTYgMjkuMTA3ODk5MDkgMTIuMDMwOTM1MDcgMjkuMDk3NjU2MjUgMTMuNTQ2ODc1IEMyOS4wOTQ0MzM1OSAxNC4zOTEyMTA5NCAyOS4wOTEyMTA5NCAxNS4yMzU1NDY4NyAyOS4wODc4OTA2MiAxNi4xMDU0Njg3NSBDMjkuMDc5NTExNzIgMTYuOTc4MTY0MDYgMjkuMDcxMTMyODEgMTcuODUwODU5MzcgMjkuMDYyNSAxOC43NSBDMjkuMDU3OTg4MjggMTkuNjM4MTY0MDYgMjkuMDUzNDc2NTYgMjAuNTI2MzI4MTIgMjkuMDQ4ODI4MTIgMjEuNDQxNDA2MjUgQzI5LjAzNzA3NDIyIDIzLjYyNzYzMzE2IDI5LjAxOTEzOTY2IDI1LjgxMzgyNTI4IDI5IDI4IEMyNS43IDI4IDIyLjQgMjggMTkgMjggQzE4LjUwNSAxOC4xIDE4LjUwNSAxOC4xIDE4IDggQzE2LjY4IDcuNjcgMTUuMzYgNy4zNCAxNCA3IEMxMy4wMSA3LjY2IDEyLjAyIDguMzIgMTEgOSBDMTAuNDE0MDczNjYgMTIuMTE2MTA1NTQgMTAuNDE0MDczNjYgMTIuMTE2MTA1NTQgMTAuMzEyNSAxNS42MjUgQzEwLjI0Njc1NzgxIDE2LjgxMzUxNTYzIDEwLjE4MTAxNTYzIDE4LjAwMjAzMTI1IDEwLjExMzI4MTI1IDE5LjIyNjU2MjUgQzEwLjA3NTg5ODQ0IDIwLjE0MTc5Njg3IDEwLjAzODUxNTYyIDIxLjA1NzAzMTI1IDEwIDIyIEM2LjcgMjEuNjcgMy40IDIxLjM0IDAgMjEgQzAgMTQuMDcgMCA3LjE0IDAgMCBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAzNiw1MykiLz4KPHBhdGggZD0iTTAgMCBDNy44MjQzNDA1OCAtMC4xMTcwMzA3NCA3LjgyNDM0MDU4IC0wLjExNzAzMDc0IDEwLjQ4ODI4MTI1IDIuNDE0MDYyNSBDMTIuNzg3NDM3MTMgNi4yMDk3NTk4NSAxMy43NDA2OTg2IDkuNTU1ODA4MzkgMTMgMTQgQzExLjk1MTAwNjYgMTUuNzE2NTM0NjYgMTAuOTAxMjc3MjcgMTcuNDMyNzI1OTggOS44MzIwMzEyNSAxOS4xMzY3MTg3NSBDOC4yODEzNDc3OCAyMi42MDkzNzYxMSA5LjE2NDUxNTkyIDI1LjM1OTY3NjUzIDEwIDI5IEMxMC4zNTA2MjUgMjkuNzAxMjUgMTAuNzAxMjUgMzAuNDAyNSAxMS4wNjI1IDMxLjEyNSBDMTIuMzk2NjM0OTIgMzMuNzkzMjY5ODUgMTIuMTk1NTczOTMgMzYuMDY2MzkwOTggMTIgMzkgQzExIDQwIDExIDQwIDguMTI4OTA2MjUgNDAuMTMyODEyNSBDNi45NTE5OTIxOSA0MC4xMzAyMzQzOCA1Ljc3NTA3ODEyIDQwLjEyNzY1NjI1IDQuNTYyNSA0MC4xMjUgQzMuMzg4MTY0MDYgNDAuMTI3NTc4MTIgMi4yMTM4MjgxMiA0MC4xMzAxNTYyNSAxLjAwMzkwNjI1IDQwLjEzMjgxMjUgQy0yIDQwIC0yIDQwIC00IDM5IEMtMy4yNDgxNzUxOCAzMS40ODE3NTE4MiAtMy4yNDgxNzUxOCAzMS40ODE3NTE4MiAtMS45Mzc1IDI4LjkzNzUgQy0wLjQzNzQ4NjY0IDI1LjgzNzQ3MjM5IC0wLjY0OTM5MDYgMjMuMzg5MjI0MiAtMSAyMCBDLTIuMzE0MzE2OTUgMTcuOTg3NDUyMTggLTMuNjQ3MjE4ODUgMTUuOTg2ODk3MzEgLTUgMTQgQy01Ljg1NTE0NzQgOS42MjkyNDY2MSAtNC43NjA4MzQzNiA3LjI4MzU1ODE3IC0yLjUgMy42MjUgQy0xLjY3OTQ5NTggMi40MDc5MTg3NiAtMC44NTAyODE2NCAxLjE5NjQ2NzczIDAgMCBaICIgZmlsbD0iI0ZBRkJGQiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1Nyw4MikiLz4KPHBhdGggZD0iTTAgMCBDMy45MDkzODcwMyAzLjczOTQxMzY4IDMuOTA5Mzg3MDMgMy43Mzk0MTM2OCA0LjEzMjgxMjUgNi44NDc2NTYyNSBDNC4xMzAyMzQzOCA3LjU3ODU1NDY5IDQuMTI3NjU2MjUgOC4zMDk0NTMxMyA0LjEyNSA5LjA2MjUgQzQuMTIzNzEwOTQgOS44NjU1ODU5NCA0LjEyMjQyMTg4IDEwLjY2ODY3MTg4IDQuMTIxMDkzNzUgMTEuNDk2MDkzNzUgQzQuMDAyNzk5MjggMTMuOTQyMTE4MSAzLjYyMDk4NDQgMTYuMjE4MTI5NDkgMy4xODc1IDE4LjYyNSBDMi43MDMyNTg3MiAyMi4yNzU5MjQ0MiAzLjIxMzk4MTIzIDIzLjg4MzIwMTQgNS40Mzc1IDI2LjgxMjUgQzUuOTEwNTg1OTQgMjcuMzM0NTcwMzEgNi4zODM2NzE4NyAyNy44NTY2NDA2MiA2Ljg3MTA5Mzc1IDI4LjM5NDUzMTI1IEM4IDMwIDggMzAgOCAzNCBDOC42NiAzNCA5LjMyIDM0IDEwIDM0IEM3Ljk4MzAzMjM0IDI5LjA1NjczNDA2IDcuOTgzMDMyMzQgMjkuMDU2NzM0MDYgNS4yNSAyNC41IEMzLjUwMjExMTMyIDIxLjAwNDIyMjYzIDQuMzAxODA1ODYgMTguODA4MzMxNjUgNSAxNSBDNS4yMjA5MzE1MSAxMC40OTc1NjgxMyA1LjIzOTU1NzQ5IDYuMzU4MTI2NzUgNCAyIEM3LjQ0NTAwNjYgNC45MzU2NjQyMyA3LjU3NDgyNDY0IDcuMjU3NDQyOTQgNy45Njg3NSAxMS41OTc2NTYyNSBDNy45OTg4MzUyIDEzLjkxMDQ1NTggNy43MDc4ODYzOCAxNS44NjYzODczNSA3LjI1IDE4LjEyNSBDNi45ODQxMjA2MSAyMi4yNDYxMzA1MyA3LjEwOTg0MDQyIDIyLjY4NTU3NDIyIDkuNDM3NSAyNS43NSBDOS45MTA1ODU5NCAyNi4yODEwOTM3NSAxMC4zODM2NzE4NyAyNi44MTIxODc1IDEwLjg3MTA5Mzc1IDI3LjM1OTM3NSBDMTIgMjkgMTIgMjkgMTIgMzMgQzE0LjMxIDMzLjY2IDE2LjYyIDM0LjMyIDE5IDM1IEMxOSAzNS45OSAxOSAzNi45OCAxOSAzOCBDMTkuNjM5Mzc1IDM4LjI4ODc1IDIwLjI3ODc1IDM4LjU3NzUgMjAuOTM3NSAzOC44NzUgQzIzIDQwIDIzIDQwIDI0IDQyIEMxOS4yNDAwNTc5OSA0OC4wNjgxMzc5OSAxMy45MjU3ODgzNiA1My40MjgxMzM2MyA3IDU3IEM0IDU2IDQgNTYgMi43OTY4NzUgNTMuOTI1NzgxMjUgQy0wLjc2MDI4NTczIDQ1LjA0NjE1MjQyIC0wLjc2MDI4NTczIDQ1LjA0NjE1MjQyIDEgNDAgQzEuNTE1NjI1IDM5LjE3NSAyLjAzMTI1IDM4LjM1IDIuNTYyNSAzNy41IEM0LjM4NzAyNzU2IDM0LjMyNjkwODU4IDQuNTE2NDQxMTggMzIuNjE1MDg4MjUgNCAyOSBDMy4zNCAyOC4wMzA2MjUgMi42OCAyNy4wNjEyNSAyIDI2LjA2MjUgQy0wLjQxMDU3NzgyIDIyLjM3MTMwMjcyIC0wLjQwODMyNzU1IDIwLjMyODI3MTk5IDAgMTYgQzAuMzMgMTUuMDEgMC42NiAxNC4wMiAxIDEzIEMxLjA5MjQ3MzgxIDExLjUyMzEzODg5IDEuMTI5OTkwNzEgMTAuMDQyMjQ0OTkgMS4xMjUgOC41NjI1IEMxLjEyODg2NzE5IDcuNDE5NzQ2MDkgMS4xMjg4NjcxOSA3LjQxOTc0NjA5IDEuMTMyODEyNSA2LjI1MzkwNjI1IEMxLjAwMjc2MDE1IDQuMDQ2ODQxNDEgMC42MDg1NjE5OSAyLjEyMDMwNzI0IDAgMCBaICIgZmlsbD0iIzI5N0Q1QiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3NCw2MSkiLz4KPHBhdGggZD0iTTAgMCBDMCAyLjY0IDAgNS4yOCAwIDggQy0wLjk5IDcuNjcgLTEuOTggNy4zNCAtMyA3IEMtNi41NTg4MDA1MSA2LjYyNjg5OTk1IC05LjgyNzU4NTIyIDYuMzQwNTE2NjkgLTEzIDguMTI1IEMtMTQuNDYyMjEyMTcgMTAuODY2NjQ3ODEgLTE0LjMxODMzNzMzIDEyLjk0Mzk2MTYyIC0xNCAxNiBDLTEyLjMyMDg1NTg1IDE5LjIyNTQwMTU2IC0xMi4zMjA4NTU4NSAxOS4yMjU0MDE1NiAtOS4zMTI1IDE5Ljc1IEMtNS43MDcwOTgyNCAyMC4wMjIxMDU3OSAtMi41NTAxMDA2NiAxOS42MzkwMTgxMiAxIDE5IEMxIDIxLjMxIDEgMjMuNjIgMSAyNiBDLTYuMzQ1MjM2NzIgMjguMjcwMzQ1ODkgLTEyLjM4MTY4ODY4IDI4Ljg3NjE2MTQyIC0xOS4zNzUgMjUuMjUgQy0yMi44MjkzNDgyMSAyMi4yODkxMzAxIC0yNC42OTA4NzcyNCAyMC4yNzgzNDkyMiAtMjUuMzE2NDA2MjUgMTUuNjY3OTY4NzUgQy0yNS41ODIxMzY1MiA5Ljk1MDQ4MTkxIC0yNC45Njg0NzE1MiA2LjM5NzQ5NTQ3IC0yMSAyIEMtMTQuMTcwMDE0MTEgLTMuMjEyMzU3NjUgLTcuODE4OTkzNjcgLTEuODY5NzU5MzYgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDAyLDU0KSIvPgo8cGF0aCBkPSJNMCAwIEMzIDMuMTkwMzcxOTkgMyAzLjE5MDM3MTk5IDMgNiBDLTAuMDkyNjI3NjcgNy41NDYzMTM4NCAtMy4zNjcwODkxIDcuMzkwNjA3MTYgLTYuNzg1MTU2MjUgNy42MjEwOTM3NSBDLTcuODgxNTAzOTEgNy44MDg2NTIzNCAtNy44ODE1MDM5MSA3LjgwODY1MjM0IC05IDggQy05LjMzIDguNjYgLTkuNjYgOS4zMiAtMTAgMTAgQy03LjY5IDEwLjMzIC01LjM4IDEwLjY2IC0zIDExIEMtMi40Mzc1IDEyLjkzNzUgLTIuNDM3NSAxMi45Mzc1IC0yIDE1IEMtMyAxNiAtMyAxNiAtNS4yODUxNTYyNSAxNi4wOTc2NTYyNSBDLTYuNjU5OTQxNDEgMTYuMDgwMjUzOTEgLTYuNjU5OTQxNDEgMTYuMDgwMjUzOTEgLTguMDYyNSAxNi4wNjI1IEMtOC45ODE2MDE1NiAxNi4wNTM0NzY1NiAtOS45MDA3MDMxMiAxNi4wNDQ0NTMxMyAtMTAuODQ3NjU2MjUgMTYuMDM1MTU2MjUgQy0xMS41NTc5Mjk2OSAxNi4wMjM1NTQ2OSAtMTIuMjY4MjAzMTMgMTYuMDExOTUzMTMgLTEzIDE2IEMtMTMuMzMgMTcuNjUgLTEzLjY2IDE5LjMgLTE0IDIxIEMtMTIuNzYyNSAyMC42NDkzNzUgLTExLjUyNSAyMC4yOTg3NSAtMTAuMjUgMTkuOTM3NSBDLTcuMDk2NzA4IDE5LjA0NDA2NzI3IC01LjEzMjI1ODM2IDE4Ljk5MTE4NzA2IC0yIDIwIEMtMS42NyAyMS4zMiAtMS4zNCAyMi42NCAtMSAyNCBDLTcuMDgzMDUwMzggMjguMTkwNTQ1ODIgLTExLjYyMjE1Nzc3IDI5Ljk3NTQ2ODkgLTE5IDI5IEMtMjEuMDYyNSAyNy4zNzUgLTIxLjA2MjUgMjcuMzc1IC0yMiAyNSBDLTIyLjU2NDA4OTkgMjAuMDM2MDA4OTIgLTIxLjQ2ODAwNjg0IDE1LjcxMzA3NDU4IC0yMCAxMSBDLTE4LjM3NSA5IC0xOC4zNzUgOSAtMTcgOCBDLTE3LjQ5NSA3LjU2Njg3NSAtMTcuOTkgNy4xMzM3NSAtMTguNSA2LjY4NzUgQy0yMCA1IC0yMCA1IC0yMCAyIEMtNi4wODE1NDUwNiAtMS4zMTY3MzgyIC02LjA4MTU0NTA2IC0xLjMxNjczODIgMCAwIFogIiBmaWxsPSIjMjIxRTIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2NTIsNzEpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIgMiAyIDIgMi4zMTI1IDUuMTg3NSBDMS45Njk4MjgxOCA5LjM2ODA5NjIyIDAuNjY2NjA4NjQgMTIuMTgwNjg4NTMgLTEgMTYgQy0xLjU4NzYzMjQ0IDIwLjExMzQyNzEgLTEuMzMwNDM1NTggMjEuNTA0MzQ2NjQgMSAyNSBDMy4zMzQ1ODYzNSAyOC41MDE4Nzk1MyAzLjY3MjYwNzI3IDI5Ljg4MDI4MDQ3IDMgMzQgQzEuOTUxMDA2NiAzNS43MTY1MzQ2NiAwLjkwMTI3NzI3IDM3LjQzMjcyNTk4IC0wLjE2Nzk2ODc1IDM5LjEzNjcxODc1IEMtMS43MTg2NTIyMiA0Mi42MDkzNzYxMSAtMC44MzU0ODQwOCA0NS4zNTk2NzY1MyAwIDQ5IEMwLjM1MDYyNSA0OS43MDEyNSAwLjcwMTI1IDUwLjQwMjUgMS4wNjI1IDUxLjEyNSBDMi4zODM4NTAwOCA1My43Njc3MDAxNyAyLjEzMjA5ODM3IDU2LjA5MzgzNTkxIDIgNTkgQzEuMDEgNTkgMC4wMiA1OSAtMSA1OSBDLTEuMjg4NzUgNTcuNzgzMTI1IC0xLjU3NzUgNTYuNTY2MjUgLTEuODc1IDU1LjMxMjUgQy0yLjQ4MDE5MTExIDUyLjgzMDc4MTA3IC0zLjEwNzk3MDM0IDUwLjc2NzAxMTM3IC00LjE4NzUgNDguNDM3NSBDLTUuMzQyMzE4NDQgNDQuOTczMDQ0NjggLTQuODE4NjU2ODYgNDIuNTI2NTIxODcgLTQgMzkgQy0zLjIyNjU2MjUgMzcuNzMxNTYyNSAtMy4yMjY1NjI1IDM3LjczMTU2MjUgLTIuNDM3NSAzNi40Mzc1IEMtMC42MTEwNTMyMSAzMy4zNDA0ODE1MiAtMC41NTY2MDA4MSAzMS41NDcxOTM1MyAtMSAyOCBDLTIuNDI2MjE2ODQgMjUuMjg4NzM2MTYgLTIuNDI2MjE2ODQgMjUuMjg4NzM2MTYgLTQgMjMgQy00IDIyLjM0IC00IDIxLjY4IC00IDIxIEMtNi45NyAyMSAtOS45NCAyMSAtMTMgMjEgQy0xNi44OTY3Nzg1MSAyNy4wMDIyMTQ0NSAtMTYuODk2Nzc4NTEgMjcuMDAyMjE0NDUgLTE3IDM0IEMtMTYuMzQgMzQuOTY5Mzc1IC0xNS42OCAzNS45Mzg3NSAtMTUgMzYuOTM3NSBDLTEyLjUzNTY0NjkzIDQwLjcxMTA0MDY0IC0xMi40NTUwODUxNiA0Mi41NjI4MzYyOCAtMTMgNDcgQy0xMy45MzU3ODk5NSA0OS4zNTk4MTgxMyAtMTQuOTMzNDc4MDggNTEuNjk2MzEyNjQgLTE2IDU0IEMtMTYuNjkxNDA1MjIgNTYuNzc4ODg2MTMgLTE2LjY5MTQwNTIyIDU2Ljc3ODg4NjEzIC0xNyA1OSBDLTE3Ljk5IDU5IC0xOC45OCA1OSAtMjAgNTkgQy0yMC4yNTgxMzMwMiA1NS4zODYxMzc3NCAtMjAuMTY4MTU2NjcgNTMuMzI5MzA2OCAtMTguNSA1MC4wNjI1IEMtMTYuNjczNDE0OTMgNDYuMzMzMjIyMTUgLTE2LjQ4NjE3MTMzIDQ0LjExMDYyOTM5IC0xNyA0MCBDLTE4LjMxNDMxNjk1IDM3Ljk4NzQ1MjE4IC0xOS42NDcyMTg4NSAzNS45ODY4OTczMSAtMjEgMzQgQy0yMS41IDMxIC0yMS41IDMxIC0yMSAyOCBDLTIwLjMxOTM3NSAyNy4wNzE4NzUgLTE5LjYzODc1IDI2LjE0Mzc1IC0xOC45Mzc1IDI1LjE4NzUgQy0xNi4yOTQzMTIzNCAyMC44MzkwMjk5NyAtMTYuODYxMjA4MTUgMTcuODI0MTczMzMgLTE4IDEzIEMtMTguNjU5OTY3OSAxMS4zMzA2Njk0MiAtMTkuMzI1NTg4NjkgOS42NjM1NDc5IC0yMCA4IEMtMjAuMTI1IDQuNjg3NSAtMjAuMTI1IDQuNjg3NSAtMjAgMiBDLTE5LjM0IDIgLTE4LjY4IDIgLTE4IDIgQy0xOCAyLjY2IC0xOCAzLjMyIC0xOCA0IEMtMTYuNjggNCAtMTUuMzYgNCAtMTQgNCBDLTE0IDQuNjYgLTE0IDUuMzIgLTE0IDYgQy0xNC45OSA2IC0xNS45OCA2IC0xNyA2IEMtMTUuOTcwMjgxNCAxMS4yMzU1MDE3NyAtMTUuOTcwMjgxNCAxMS4yMzU1MDE3NyAtMTMuNzUgMTYgQy0xMC45NzQxNDAxOSAxNy41ODYyMDU2MSAtOS4xMjcxMzUyNSAxNy41MTA1NTI2OSAtNiAxNyBDLTIuMzk2ODM5NzggMTMuNjg4OTg3OTEgLTEuNDQ3Mjk0NzYgMTAuODA4NDE4NyAtMSA2IEMtMy4zMSA2LjMzIC01LjYyIDYuNjYgLTggNyBDLTguMDQyNzIxIDUuMzMzODgwOTUgLTguMDQwNjM4MzIgMy42NjYxNzExNSAtOCAyIEMtNS45NTQ0Nzk1OCAtMC4wNDU1MjA0MiAtMi43Mjk0MTkxNCAwLjIzOTQyMjczIDAgMCBaICIgZmlsbD0iIzIyNzg1NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3MCw2MikiLz4KPHBhdGggZD0iTTAgMCBDMC45NDg3NSAwLjY2IDEuODk3NSAxLjMyIDIuODc1IDIgQzMuMzAxNTM3MjcgNi4zNTA2ODAxOCAzLjQ1MjcyODcyIDguMjkzODg3MTIgMC42MjUgMTEuNzUgQy0wLjI4MjUgMTIuNDkyNSAtMS4xOSAxMy4yMzUgLTIuMTI1IDE0IEMtMi43MDYzNjcxOSAxNC41MTY5MTQwNiAtMy4yODc3MzQzOCAxNS4wMzM4MjgxMiAtMy44ODY3MTg3NSAxNS41NjY0MDYyNSBDLTYuNzk2MjA2MzYgMTcuNDI5OTAwMDYgLTkuMjc0ODQ0NzUgMTcuNzMzMjU1NzkgLTEyLjY4NzUgMTguMTg3NSBDLTEzLjgyMzE2NDA2IDE4LjM0NjA1NDY5IC0xNC45NTg4MjgxMiAxOC41MDQ2MDkzOCAtMTYuMTI4OTA2MjUgMTguNjY3OTY4NzUgQy0xOS4xMjUgMTkgLTE5LjEyNSAxOSAtMjIuMTI1IDE5IEMtMjMuOTMxNDYxMTggMTUuMzg3MDc3NjQgLTI1LjEyNSAxMi45OTMwMDYgLTI1LjEyNSA4LjkzNzUgQy0yMy41NjkwNzIyNyA0LjM2Njk2MjI5IC0yMS4wMzM3Mjg5IDEuMTk5NzcyNDUgLTE2LjkzNzUgLTEuMzc1IEMtMTEuMDE1MDAyNTMgLTIuNjkxMTEwNTUgLTUuMzkzODE5MTMgLTMuMDkxNTc5MjYgMCAwIFogTS0xOC4xMjUgNSBDLTE4Ljc4NSA2LjMyIC0xOS40NDUgNy42NCAtMjAuMTI1IDkgQy0xOC44MDUgNy42OCAtMTcuNDg1IDYuMzYgLTE2LjEyNSA1IEMtMTYuNzg1IDUgLTE3LjQ0NSA1IC0xOC4xMjUgNSBaIE0tMTIuMTI1IDkgQy0xMy45NTgwMDkwOSAxMS4xMDU3NTY0MyAtMTMuOTU4MDA5MDkgMTEuMTA1NzU2NDMgLTE1LjEyNSAxMyBDLTkuMzI4NzM4OTMgMTIuNjAwMjU3ODYgLTUuNzEwMjc1MzcgMTEuODk3NDg0MDcgLTEuMTI1IDggQy0xLjEyNSA3LjAxIC0xLjEyNSA2LjAyIC0xLjEyNSA1IEMtNS45NTc3NzI2OCA0LjQzMTQzODUxIC04LjM2ODA4Njg2IDYuMDU5ODA3MTEgLTEyLjEyNSA5IFogIiBmaWxsPSIjMjIxRTIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1ODUuMTI1LDQ5KSIvPgo8cGF0aCBkPSJNMCAwIEMyLjk3IDAgNS45NCAwIDkgMCBDOS4zMyAxLjMyIDkuNjYgMi42NCAxMCA0IEMxMC41MTU2MjUgMy4zNCAxMS4wMzEyNSAyLjY4IDExLjU2MjUgMiBDMTQuODI2NDEzMTkgLTAuNjc4MDgyNjIgMTYuODgzOTk1MjUgLTAuMzgxMTExNTUgMjEgMCBDMjEuNjYgMC4zMyAyMi4zMiAwLjY2IDIzIDEgQzIyLjY3IDMuNjQgMjIuMzQgNi4yOCAyMiA5IEMxOSAxMCAxOSAxMCAxNy4wNjI1IDkuMzEyNSBDMTYuMzgxODc1IDkuMjA5Mzc1IDE1LjcwMTI1IDkuMTA2MjUgMTUgOSBDMTEuNjQ5OTE3OTUgMTEuNzc1NzgyMjcgMTAuMTM2Mzk1ODYgMTMuNjg5OTI2MiA5LjY4MzU5Mzc1IDE4LjAzOTA2MjUgQzkuNjAyMzgyODEgMTkuMjIyNDIxODcgOS41MjExNzE4OCAyMC40MDU3ODEyNSA5LjQzNzUgMjEuNjI1IEM5LjM1MzcxMDk0IDIyLjgxMzUxNTYzIDkuMjY5OTIxODcgMjQuMDAyMDMxMjUgOS4xODM1OTM3NSAyNS4yMjY1NjI1IEM5LjEyMzAwNzgxIDI2LjE0MTc5Njg3IDkuMDYyNDIxODcgMjcuMDU3MDMxMjUgOSAyOCBDNi4wMyAyOCAzLjA2IDI4IDAgMjggQzAgMTguNzYgMCA5LjUyIDAgMCBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE3Niw1MykiLz4KPHBhdGggZD0iTTAgMCBDMC40OTUgMS40ODUgMC40OTUgMS40ODUgMSAzIEMwLjAxIDMuOTkgLTAuOTggNC45OCAtMiA2IEMtMi43MjcwMzEyNSA1LjczNDQ1MzEzIC0zLjQ1NDA2MjUgNS40Njg5MDYyNSAtNC4yMDMxMjUgNS4xOTUzMTI1IEMtMjUuMTQ4Njk1MTMgLTIuMTYyNDkwMzQgLTQ1LjE2MzM2MjQ5IC0xLjA2MjQxOCAtNjYgNiBDLTY2LjMzIDQuMzUgLTY2LjY2IDIuNyAtNjcgMSBDLTQ4Ljc3Mzk1ODUzIC05LjkzNTYyNDg4IC0xOC43MTE0Nzg5MyAtOC4zODU4NDYyMiAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MjAsMzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEMyLjMzIDEuNjUgMi42NiAzLjMgMyA1IEM0LjY1IDUgNi4zIDUgOCA1IEM3LjAxIDYuNDg1IDcuMDEgNi40ODUgNiA4IEM1LjgzMjg2NDMxIDEwLjYyNTMxNTI0IDUuODMyODY0MzEgMTAuNjI1MzE1MjQgNiAxMyBDNi45MDc1IDEyLjQ4NDM3NSA3LjgxNSAxMS45Njg3NSA4Ljc1IDExLjQzNzUgQzEyIDEwIDEyIDEwIDE0LjM3NSAxMC4zMTI1IEMxNC45MTEyNSAxMC41MzkzNzUgMTUuNDQ3NSAxMC43NjYyNSAxNiAxMSBDMTUuNjcgMTIuMzIgMTUuMzQgMTMuNjQgMTUgMTUgQzE2Ljk4IDE0LjY3IDE4Ljk2IDE0LjM0IDIxIDE0IEMxOS42OCAxNi42NCAxOC4zNiAxOS4yOCAxNyAyMiBDMTYuMjM4MTY0MDYgMjEuNzgzNDM3NSAxNS40NzYzMjgxMyAyMS41NjY4NzUgMTQuNjkxNDA2MjUgMjEuMzQzNzUgQzMuNTQ5MjExNDUgMTguMzM5MTEzMiAtMy45OTQ5NjA1MyAxOC41NDQyMTE5MSAtMTUgMjIgQy0xNi4zMiAxOS4zNiAtMTcuNjQgMTYuNzIgLTE5IDE0IEMtMTYuNjkgMTQuMzMgLTE0LjM4IDE0LjY2IC0xMiAxNSBDLTEyLjY2IDEzLjM1IC0xMy4zMiAxMS43IC0xNCAxMCBDLTEwLjI4MTExNzYxIDEwLjUwNzEyMDMzIC03LjI2NTQ1NzYxIDExLjExNjA4MjE1IC00IDEzIEMtMy43OTkxMzU1NyA5LjI4NDAwODA5IC0zLjg0ODA1NjMgOC4yMjc5MTU1NSAtNiA1IEMtNC4zNSA1IC0yLjcgNSAtMSA1IEMtMC42NyAzLjM1IC0wLjM0IDEuNyAwIDAgWiAiIGZpbGw9IiNGM0Y4RjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNjAsMzcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuNzQyMTY3OTcgMC4wNTQxNDA2MyAxLjc0MjE2Nzk3IDAuMDU0MTQwNjMgMy41MTk1MzEyNSAwLjEwOTM3NSBDNC4zOTk5NjA5NCAwLjE1NTc4MTI1IDUuMjgwMzkwNjMgMC4yMDIxODc1IDYuMTg3NSAwLjI1IEM1Ljg1NzUgMS45IDUuNTI3NSAzLjU1IDUuMTg3NSA1LjI1IEMzLjIwNzUgNS41OCAxLjIyNzUgNS45MSAtMC44MTI1IDYuMjUgQy0xLjA1MDMzMjAzIDcuMzU0MDgyMDMgLTEuMDUwMzMyMDMgNy4zNTQwODIwMyAtMS4yOTI5Njg3NSA4LjQ4MDQ2ODc1IEMtMi43NDE2MTc3NyAxNC41MzkxODMxOCAtMy44MTM2MDk0MSAxOC40MDQ2OTk1NSAtOC44MTI1IDIyLjI1IEMtMTEuNTc3MDIwMzMgMjMuNjMyMjYwMTYgLTEzLjg1ODYzNjMgMjMuMzQ1MjUzODcgLTE2LjkzNzUgMjMuMzEyNSBDLTE4LjAzMzIwMzEyIDIzLjMwMzQ3NjU2IC0xOS4xMjg5MDYyNSAyMy4yOTQ0NTMxMyAtMjAuMjU3ODEyNSAyMy4yODUxNTYyNSBDLTIxLjUyMjM4MjgxIDIzLjI2Nzc1MzkxIC0yMS41MjIzODI4MSAyMy4yNjc3NTM5MSAtMjIuODEyNSAyMy4yNSBDLTIyLjQ4MjUgMjEuNiAtMjIuMTUyNSAxOS45NSAtMjEuODEyNSAxOC4yNSBDLTE5LjgzMjUgMTcuOTIgLTE3Ljg1MjUgMTcuNTkgLTE1LjgxMjUgMTcuMjUgQy0xNS41ODE3NTc4MSAxNi4zNTc5Njg3NSAtMTUuMzUxMDE1NjIgMTUuNDY1OTM3NSAtMTUuMTEzMjgxMjUgMTQuNTQ2ODc1IEMtMTQuNzg3MTQ4NDQgMTMuMzc2NDA2MjUgLTE0LjQ2MTAxNTYzIDEyLjIwNTkzNzUgLTE0LjEyNSAxMSBDLTEzLjgxMTc1NzgxIDkuODM5ODQzNzUgLTEzLjQ5ODUxNTYyIDguNjc5Njg3NSAtMTMuMTc1NzgxMjUgNy40ODQzNzUgQy0xMC40NDExMzY5OSAwLjk5NjQ1MTA5IC02Ljc2ODAwODc1IC0wLjI3MzQ1NDkgMCAwIFogIiBmaWxsPSIjRjVGOUY2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDM2LjgxMjUsODQuNzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuOTcgMCA1Ljk0IDAgOSAwIEM5IDkuMjQgOSAxOC40OCA5IDI4IEM2LjAzIDI4IDMuMDYgMjggMCAyOCBDMCAxOC43NiAwIDkuNTIgMCAwIFogIiBmaWxsPSIjMDA4NDJBIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDk5LDUzKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjgwODE5NTIyIDAuMDEzNzU3MzUgNC44MDgxOTUyMiAwLjAxMzc1NzM1IDcuODEyNSAyLjg3NSBDOC40OTMxMjUgNC4xMTI1IDguNDkzMTI1IDQuMTEyNSA5LjE4NzUgNS4zNzUgQzYuODc3NSA1LjcwNSA0LjU2NzUgNi4wMzUgMi4xODc1IDYuMzc1IEMxLjg1NzUgOC4wMjUgMS41Mjc1IDkuNjc1IDEuMTg3NSAxMS4zNzUgQzQuNjUyNSAxMC44OCA0LjY1MjUgMTAuODggOC4xODc1IDEwLjM3NSBDOC42ODA5ODE3NSAxNC41MjAyNDY3MSA4LjMyNjA0MzA3IDE2LjE1NDk2MSA2LjA2MjUgMTkuNzUgQzMuMTg3NSAyMi4zNzUgMy4xODc1IDIyLjM3NSAwLjE4NzUgMjMuMTI1IEMtNC4xMzU1MDE1OSAyMi4wNDQyNDk2IC01LjQ3Mjc4ODMxIDIwLjA5MTAxMjY4IC03LjgxMjUgMTYuMzc1IEMtOC4xMjUgMTMgLTguMTI1IDEzIC03LjgxMjUgMTAuMzc1IEMtNS41MDI1IDEwLjM3NSAtMy4xOTI1IDEwLjM3NSAtMC44MTI1IDEwLjM3NSBDLTEuMTQyNSA5LjA1NSAtMS40NzI1IDcuNzM1IC0xLjgxMjUgNi4zNzUgQy00Ljc4MjUgNS44OCAtNC43ODI1IDUuODggLTcuODEyNSA1LjM3NSBDLTUuNjI4MjEwMTUgMC44NjA4MDA5NyAtNS4wOTkzMDg2NyAwLjE5NDExNzE3IDAgMCBaICIgZmlsbD0iI0U1RUZFQiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2MC44MTI1LDU3LjYyNSkiLz4KPHBhdGggZD0iTTAgMCBDMTUuNTEgMCAzMS4wMiAwIDQ3IDAgQzQ3IDEuNjUgNDcgMy4zIDQ3IDUgQzMxLjQ5IDUgMTUuOTggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1OTUsNzIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuNjIgMCA5LjI0IDAgMTQgMCBDMTQgMS4zMiAxNCAyLjY0IDE0IDQgQzEwLjcgNCA3LjQgNCA0IDQgQzQgNS45OCA0IDcuOTYgNCAxMCBDNy4zIDEwIDEwLjYgMTAgMTQgMTAgQzE0IDExLjMyIDE0IDEyLjY0IDE0IDE0IEMxMC43IDE0IDcuNCAxNCA0IDE0IEM0IDE1Ljk4IDQgMTcuOTYgNCAyMCBDNy4zIDIwIDEwLjYgMjAgMTQgMjAgQzE0LjMzIDIxLjMyIDE0LjY2IDIyLjY0IDE1IDI0IEMxMC4wNSAyNCA1LjEgMjQgMCAyNCBDMCAxNi4wOCAwIDguMTYgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDU2LDg1KSIvPgo8cGF0aCBkPSJNMCAwIEMxNC41MiAwIDI5LjA0IDAgNDQgMCBDNDMuMzQgMS42NSA0Mi42OCAzLjMgNDIgNSBDMjguMTQgNSAxNC4yOCA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0MSw5NCkiLz4KPHBhdGggZD0iTTAgMCBDMTMuODYgMCAyNy43MiAwIDQyIDAgQzQyLjY2IDEuNjUgNDMuMzIgMy4zIDQ0IDUgQzI5LjQ4IDUgMTQuOTYgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1NDEsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuOTUxOTMyMjEgNS44NTU3OTY2MyAzLjYyOTIyNzk1IDE1LjU1OTg2NzYxIDAuOTE0MDYyNSAyMS4yOTI5Njg3NSBDMC40NDc0MjE4NyAyMS44MzU2NjQwNiAtMC4wMTkyMTg3NSAyMi4zNzgzNTkzOCAtMC41IDIyLjkzNzUgQy0zLjIyMjkwNTM0IDI1LjY1Mjg1NDI2IC0zLjIyMjkwNTM0IDI1LjY1Mjg1NDI2IC0zLjExMzI4MTI1IDI4LjQwNjI1IEMtMi44NDc1MjI1NiAzMC42NDI3NjQ2OSAtMi41MDI2MTIyNCAzMi44MDU0MjU3OCAtMiAzNSBDLTYuNjI1IDM4IC02LjYyNSAzOCAtMTAgMzggQy0xMC4zMyAzOS4zMiAtMTAuNjYgNDAuNjQgLTExIDQyIEMtMTIuMzIgNDIgLTEzLjY0IDQyIC0xNSA0MiBDLTE2LjcwMzEyNSA0MC4xMDE1NjI1IC0xNi43MDMxMjUgNDAuMTAxNTYyNSAtMTguMjUgMzcuNjI1IEMtMTguNzcwNzgxMjUgMzYuODEyODkwNjIgLTE5LjI5MTU2MjUgMzYuMDAwNzgxMjUgLTE5LjgyODEyNSAzNS4xNjQwNjI1IEMtMjEgMzMgLTIxIDMzIC0yMSAzMSBDLTE4LjA5NDUxMTE4IDI4Ljk1ODMwNTE1IC0xNi41OTg1Nzk1NCAyOCAtMTMgMjggQy0xMyAyOC45OSAtMTMgMjkuOTggLTEzIDMxIEMtMTAuMDI5ODIzMDYgMzAuMzcxODk4MjcgLTEwLjAyOTgyMzA2IDMwLjM3MTg5ODI3IC03IDI5IEMtNS44MDE2MTc5MSAyNi42NzE0NTUzNyAtNS44MDE2MTc5MSAyNi42NzE0NTUzNyAtNSAyNCBDLTQuMzI1ODIwMzEgMjMuMjk4NzUgLTMuNjUxNjQwNjMgMjIuNTk3NSAtMi45NTcwMzEyNSAyMS44NzUgQy0wLjI3MTkxNzk2IDE3LjkzMDQwMjQ0IC0wLjU4MDIxNDc2IDE0Ljk1NDI2NzczIC0wLjgxMjUgMTAuMzEyNSBDLTEuMDkwOTg5MDUgMi4xODE5NzgxMSAtMS4wOTA5ODkwNSAyLjE4MTk3ODExIDAgMCBaICIgZmlsbD0iI0VCRjNFRiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM0Miw2NSkiLz4KPHBhdGggZD0iTTAgMCBDLTAuNDAyODE3NzEgNS44NDA4NTY3NCAtMS4xMTI3NzkgOS4zNzczNTg4MSAtNSAxNCBDLTguMjkwNzY2NiAxNi43MTg0NTkzNyAtMTAuMDk2NDA4NjQgMTcuOTMzMDY3MzEgLTE0LjM3NSAxOC4yNSBDLTE1LjI0MTI1IDE4LjE2NzUgLTE2LjEwNzUgMTguMDg1IC0xNyAxOCBDLTE2LjY2ODA5NTE4IDExLjY5MzgwODQyIC0xNS41MDUxNjQ5NyA3LjU2NTU1NTkzIC0xMSAzIEMtNy4yMTg5MzIxOCAwLjU1ODA2MDM3IC00LjQ5MzYzOTc2IC0wLjM5NjQ5NzYzIDAgMCBaICIgZmlsbD0iIzAwMDAwMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQ1LDM3KSIvPgo8cGF0aCBkPSJNMCAwIEM0Ljc1MDUzNTExIC0wLjA3NDM1MjIyIDkuNTAwNzI4ODcgLTAuMTI4Njk2OTEgMTQuMjUxNzA4OTggLTAuMTY0Nzk0OTIgQzE1Ljg2NjY3Nzg5IC0wLjE3OTg0ODc2IDE3LjQ4MTYwNjEzIC0wLjIwMDI5NjQ4IDE5LjA5NjQzNTU1IC0wLjIyNjMxODM2IEMyMS40MjI0NjU1NSAtMC4yNjI4NTI4NiAyMy43NDc5NTM0MSAtMC4yNzk3NjAxNSAyNi4wNzQyMTg3NSAtMC4yOTI5Njg3NSBDMjcuMTUxMDcxODUgLTAuMzE2MTk0NTMgMjcuMTUxMDcxODUgLTAuMzE2MTk0NTMgMjguMjQ5Njc5NTcgLTAuMzM5ODg5NTMgQzMyLjY1ODMwNTk5IC0wLjM0MTM1Nzg4IDM1LjUyNjI3Nzc5IDAuMjE1ODYwOTQgMzkgMyBDMzkgMy42NiAzOSA0LjMyIDM5IDUgQzI2LjEzIDUgMTMuMjYgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1NDEsNTApIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEM1LjE4NDE5OTU5IDMuNzk2NTQ1NjcgNS4zODczNDU0OCA3LjExNjc2MjIgNS4yMzgyODEyNSAxMS44NjMyODEyNSBDNC45NDYwNDkxMyAxNC40ODM3ODg5NyA0LjA0MjM4MTk1IDE2LjU4OTQ5MTczIDMgMTkgQzIuNDgyMDk2ODIgMjMuMDU2OTA4MjUgMi42OTk5NDI5NCAyNC41NDk5MTQ0MSA1IDI4IEM3LjMzNDU4NjM1IDMxLjUwMTg3OTUzIDcuNjcyNjA3MjcgMzIuODgwMjgwNDcgNyAzNyBDNi4zNDg5OTE3IDM4LjE2Njk1MjY0IDUuNjU4MzE0NjEgMzkuMzEyMzI1OTggNC45Mzc1IDQwLjQzNzUgQzMuMTY4MTQxMTcgNDMuMjg2MDQyMjIgMi45OTk2OTkxNiA0My45ODI4NTIyOSAzLjA2MjUgNDcuNTYyNSBDNC4wMDI5NTg2MSA1MS4wMTA4NDgyMyA1LjM3ODg4Njc3IDUzLjgyODI1NjcyIDcgNTcgQzcgNTguMzIgNyA1OS42NCA3IDYxIEM1LjAyIDYxLjQ5NSA1LjAyIDYxLjQ5NSAzIDYyIEMyLjcxMTI1IDYwLjc4MzEyNSAyLjQyMjUgNTkuNTY2MjUgMi4xMjUgNTguMzEyNSBDMS41MTk4MDg4OSA1NS44MzA3ODEwNyAwLjg5MjAyOTY2IDUzLjc2NzAxMTM3IC0wLjE4NzUgNTEuNDM3NSBDLTEuMzQyMzE4NDQgNDcuOTczMDQ0NjggLTAuODE4NjU2ODYgNDUuNTI2NTIxODcgMCA0MiBDMC43NzM0Mzc1IDQwLjczMTU2MjUgMC43NzM0Mzc1IDQwLjczMTU2MjUgMS41NjI1IDM5LjQzNzUgQzMuNDExMzY2MjEgMzYuMzAyNDY1OTkgMy41MTMyNzU5MiAzNC41OTI5MzE0MSAzIDMxIEMyLjM0IDMwLjAxIDEuNjggMjkuMDIgMSAyOCBDLTEuMzMwNDM1NTggMjQuNTA0MzQ2NjQgLTEuNTg3NjMyNDQgMjMuMTEzNDI3MSAtMSAxOSBDLTAuNTA1IDE3Ljg2NTYyNSAtMC4wMSAxNi43MzEyNSAwLjUgMTUuNTYyNSBDMi41NDM3NjAwOCAxMC43MDg1Njk4MSAyLjY5NzAxMDU0IDcuMDQ3NDY4NDUgMSAyLjA2MjUgQzAuNjcgMS4zODE4NzUgMC4zNCAwLjcwMTI1IDAgMCBaICIgZmlsbD0iI0U5RjFFRSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2OSw1OSkiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwLjMzIDIuNjQgMC42NiA0IDEgQzUuMTU2NjQ3MzcgNi40ODI2OTA2OSA1LjExNDE2MjU1IDExLjgwMzM5Mjc0IDUuMDYyNSAxNy4zNzUgQzUuMDU3OTg4MjggMTguMzAxODM1OTQgNS4wNTM0NzY1NiAxOS4yMjg2NzE4OCA1LjA0ODgyODEyIDIwLjE4MzU5Mzc1IEM1LjAzNzExNTc0IDIyLjQ1NTc5NzA5IDUuMDIwNzEzNzIgMjQuNzI3ODYzODggNSAyNyBDMy4zNSAyNy4zMyAxLjcgMjcuNjYgMCAyOCBDLTIuNjA1MTM5NTkgMjQuMDkyMjkwNjIgLTIuMjkzNjc1NjUgMjAuNzc3NzA5MjEgLTIuMjUgMTYuMjUgQy0yLjI1NzczNDM4IDE1LjQ2MzY3MTg4IC0yLjI2NTQ2ODc1IDE0LjY3NzM0Mzc1IC0yLjI3MzQzNzUgMTMuODY3MTg3NSBDLTIuMjU2ODM4MzYgOC44NzA4NDc1NSAtMS41OTU2NjE5NSA0LjczNjMyOTkxIDAgMCBaICIgZmlsbD0iIzIyMUUyMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTY5LDcxKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjY3NTQyOTc2IDAuMjg2MDQ4OTggMy4zNDM4NTM0MyAwLjYxNzgxMjMzIDUgMSBDNi4wNjgwODM3NCA3LjI3NDk5MTk3IDcuMDQzNjc4MzkgMTMuODY4OTY0ODMgNSAyMCBDNC40NDQ5NTIwOSAyNS44ODM1MDc4OCA1Ljc0ODA2MTcyIDI4LjIyMzcxNTY1IDkgMzMgQzkuNjgyNDU2MDcgMzcuMDA5NDI5NCA5LjA2MjU0MzA2IDM5LjEyMDM1OTYxIDYuOTM3NSA0Mi40Mzc1IEM1LjE4NzQ3ODQxIDQ1LjI2MTExNjM5IDQuOTk5MzU1NTggNDUuOTYzOTEyNyA1LjA2MjUgNDkuNSBDNi4wNjQxNTYzNSA1My4yMzk1MTcwMiA3LjQxMDgyMDg0IDU2LjQ3NjE2Nzk1IDkgNjAgQzkgNjAuNjYgOSA2MS4zMiA5IDYyIEM4LjAxIDYyIDcuMDIgNjIgNiA2MiBDNS4xMjcyMDEzOCA2MC4xMzM2MDAxOSA0LjI3NzQ4OTczIDU4LjI1NjM5Mzg5IDMuNDM3NSA1Ni4zNzUgQzIuOTYxODM1OTQgNTUuMzMwODU5MzggMi40ODYxNzE4OCA1NC4yODY3MTg3NSAxLjk5NjA5Mzc1IDUzLjIxMDkzNzUgQzAuODc4NDcyMzMgNDkuNjA4MjUxOTcgMS4wMTg2Mjk2NiA0Ny42MDg1ODA1MSAyIDQ0IEMyLjUxNTYyNSA0My4xNzUgMy4wMzEyNSA0Mi4zNSAzLjU2MjUgNDEuNSBDNS4zODcwMjc1NiAzOC4zMjY5MDg1OCA1LjUxNjQ0MTE4IDM2LjYxNTA4ODI1IDUgMzMgQzQuMzE5Mzc1IDMyLjA3MTg3NSAzLjYzODc1IDMxLjE0Mzc1IDIuOTM3NSAzMC4xODc1IEMwLjMyMzM1MDI2IDI1Ljg4NjgwMjA0IDAuODgyMTgxNzcgMjIuNzc3MDAxIDIgMTggQzIuMzMgMTcuMzQgMi42NiAxNi42OCAzIDE2IEMzLjQxNzQwMjY4IDExLjA1OTExNzE1IDMuNDg3NDY4NzMgNi40MjIxNjY2NCAxIDIgQzAuMzQgMS42NyAtMC4zMiAxLjM0IC0xIDEgQy0wLjY3IDAuNjcgLTAuMzQgMC4zNCAwIDAgWiAiIGZpbGw9IiMxRDc1NTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzAsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuMzMgMC42NiAwLjY2IDEuMzIgMSAyIEMwLjY3IDIuNjYgMC4zNCAzLjMyIDAgNCBDMC4wMjM3OTA0IDYuMzExMDc4NzggMC4wMjM3OTA0IDYuMzExMDc4NzggMC4zMTI1IDguODc1IEMwLjM5MTEzMjgxIDkuNzM4NjcxODcgMC40Njk3NjU2MyAxMC42MDIzNDM3NSAwLjU1MDc4MTI1IDExLjQ5MjE4NzUgQzEuMDAzMjA3MjQgMTQuMDE3OTA0NzUgMS44MTI2MDgzMyAxNS43NDgyMTM0IDMgMTggQzMuNzA0NDkyODkgMjMuNDAxMTEyMTcgMS45Mjk0NDIzOSAyNS42MDU4MzY0MiAtMSAzMCBDLTEuNjc4NzgwNTkgMzQuMDcyNjgzNTYgLTEuMzQxNzI0MDYgMzUuNDk4MDkyNzkgMSAzOC45Mzc1IEMzLjQ1MjU5MTI5IDQyLjY5MzAzMDQxIDMuNTUxNTQyOTEgNDQuNTg3NjU2NyAzIDQ5IEMyLjA2NTUzNDY1IDUxLjAzMTQ0NjQxIDEuMDY3NzUyMjQgNTMuMDM1MzM1ODcgMCA1NSBDLTAuNjk5MDc0MTQgNTcuNzM1NzI1ODUgLTAuNjk5MDc0MTQgNTcuNzM1NzI1ODUgLTEgNjAgQy0yLjMyIDU5LjY3IC0zLjY0IDU5LjM0IC01IDU5IEMtNC41MjI2OTE2MiA1Ny41NDEwNTc0IC00LjA0MzA4OTU4IDU2LjA4Mjg2NTA0IC0zLjU2MjUgNTQuNjI1IEMtMy4xNjIyNDYwOSA1My40MDY4MzU5NCAtMy4xNjIyNDYwOSA1My40MDY4MzU5NCAtMi43NTM5MDYyNSA1Mi4xNjQwNjI1IEMtMiA1MCAtMiA1MCAtMSA0OCBDLTAuNTQzMTA3NzYgNDQuMDcwNzI2NzUgLTAuOTU5NzA3MDkgNDEuNzM5NDU4MTMgLTMgMzguNDM3NSBDLTUuNzU4MjkzODQgMzMuNjk2NjgyNDYgLTUuNzU4MjkzODQgMzMuNjk2NjgyNDYgLTUgMzAgQy00LjM0IDI5LjA1MTI1IC0zLjY4IDI4LjEwMjUgLTMgMjcuMTI1IEMtMC41ODgzOTUzIDIzLjM1Njg2NzY2IC0wLjUyMDEwNzIzIDIxLjM5OTAxNzAyIC0xIDE3IEMtMS4zMyAxNi4xOTU2MjUgLTEuNjYgMTUuMzkxMjUgLTIgMTQuNTYyNSBDLTMuNDY1MDU4MjkgMTAuODA4Mjg4MTIgLTMuMzIwMjAxNTkgOC4wMzQ1NDAwMiAtMyA0IEMtMS41IDEuNSAtMS41IDEuNSAwIDAgWiAiIGZpbGw9IiNGMUY2RjQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNTEsNjApIi8+CjxwYXRoIGQ9Ik0wIDAgQzMgMSAzIDEgNSA0IEM1IDQuOTkgNSA1Ljk4IDUgNyBDNS42NiA2LjY3IDYuMzIgNi4zNCA3IDYgQzguNTQwMjM5OTYgNS45MzA0OTQ1OSAxMC4wODMzNDk4OCA1LjkxNTQ3NjQzIDExLjYyNSA1LjkzNzUgQzEyLjg1MDg5ODQ0IDUuOTUxMDM1MTYgMTIuODUwODk4NDQgNS45NTEwMzUxNiAxNC4xMDE1NjI1IDUuOTY0ODQzNzUgQzE1LjA0MTI4OTA2IDUuOTgyMjQ2MDkgMTUuMDQxMjg5MDYgNS45ODIyNDYwOSAxNiA2IEMxNS4yMzY4NzUgNi43NDI1IDE0LjQ3Mzc1IDcuNDg1IDEzLjY4NzUgOC4yNSBDMTEuMDU1OTU5NzIgMTAuNzU4MDE3NDUgMTEuMDU1OTU5NzIgMTAuNzU4MDE3NDUgOS42NTIzNDM3NSAxMy4wOTc2NTYyNSBDNy41MTM0ODk4OSAxNS41NjAxMTkyIDYuMDYwMDUxNDUgMTUuNzE4NTYzODUgMi44NzUgMTYuMTg3NSBDLTAuMzYzMTQzNTQgMTYuNDU4MzM3OTMgLTAuMzYzMTQzNTQgMTYuNDU4MzM3OTMgLTMgMTggQy00LjY2NjE3MTE1IDE4LjA0MDYzODMyIC02LjMzMzg4MDk1IDE4LjA0MjcyMSAtOCAxOCBDLTcuMjU5NDMzNTkgMTYuOTMwNzIyNjYgLTcuMjU5NDMzNTkgMTYuOTMwNzIyNjYgLTYuNTAzOTA2MjUgMTUuODM5ODQzNzUgQy0xLjU0NzYwNyA4LjUwMTAxOTAzIC0xLjU0NzYwNyA4LjUwMTAxOTAzIDAgMCBaICIgZmlsbD0iI0VGRjVGMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyNiw1NSkiLz4KPHBhdGggZD0iTTAgMCBDMS44NzUgMS4xMjUgMS44NzUgMS4xMjUgMyAzIEMzLjY4NzUgNi4xODc1IDMuNjg3NSA2LjE4NzUgNCA5IEMwLjM3IDkgLTMuMjYgOSAtNyA5IEMtNi4wMSA5Ljk5IC01LjAyIDEwLjk4IC00IDEyIEMtMC4zNTQ1ODE1NSAxMS43NjUyMjgwMSAtMC4zNTQ1ODE1NSAxMS43NjUyMjgwMSAzIDExIEMyLjY3IDEyLjY1IDIuMzQgMTQuMyAyIDE2IEMtNC4yNDE1OTc5NyAxNy4zNDYyMjcwMSAtNC4yNDE1OTc5NyAxNy4zNDYyMjcwMSAtNy44NzUgMTUuNjg3NSBDLTEwIDE0IC0xMCAxNCAtMTEgMTIgQy0xMS41NzE0Mjg1NyA0LjkxNDI4NTcxIC0xMS41NzE0Mjg1NyA0LjkxNDI4NTcxIC05LjQzNzUgMS41IEMtNi4wODk2NTY1MSAtMC41NjAyMTEzOCAtMy44NTk4NTc1MyAtMC40OTEyNTQ1OSAwIDAgWiBNLTUgMyBDLTUuOTkgNC40ODUgLTUuOTkgNC40ODUgLTcgNiBDLTQuNjkgNiAtMi4zOCA2IDAgNiBDLTAuNjYgNS4wMSAtMS4zMiA0LjAyIC0yIDMgQy0yLjk5IDMgLTMuOTggMyAtNSAzIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTAwLDkzKSIvPgo8cGF0aCBkPSJNMCAwIEMxMC44OSAwIDIxLjc4IDAgMzMgMCBDMzIuNjcgMS4zMiAzMi4zNCAyLjY0IDMyIDQgQzI5LjA3ODAyMzEgNS40NjA5ODg0NSAyNi41MDEwNjUyNSA1LjExMTM0OTAxIDIzLjI0MjE4NzUgNS4wOTc2NTYyNSBDMjIuMjQ3NjEwMzIgNS4wOTU1MzM4MyAyMi4yNDc2MTAzMiA1LjA5NTUzMzgzIDIxLjIzMjk0MDY3IDUuMDkzMzY4NTMgQzE5LjExMzU4MTM3IDUuMDg3NzY3NTQgMTYuOTk0MzI3NDEgNS4wNzUyMTUgMTQuODc1IDUuMDYyNSBDMTMuNDM4ODAzNjEgNS4wNTc0ODUxMiAxMi4wMDI2MDU1NiA1LjA1MjkyMjE5IDEwLjU2NjQwNjI1IDUuMDQ4ODI4MTIgQzcuMDQ0MjM2NTUgNS4wMzc3OTc4MiAzLjUyMjEyODU1IDUuMDIwNTMyNTkgMCA1IEMwIDMuMzUgMCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTQ5LDcyKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjIxNzQ5MjE5IC0wLjA3NDE5MTM0IDguNDM0NjM4MTEgLTAuMTI4NjIwNCAxMi42NTI1ODc4OSAtMC4xNjQ3OTQ5MiBDMTQuMDg3MjI1NTIgLTAuMTc5ODc1ODkgMTUuNTIxODE3MDggLTAuMjAwMzQzOCAxNi45NTYyOTg4MyAtMC4yMjYzMTgzNiBDMTkuMDE5MTU4NTkgLTAuMjYyNzM0MzcgMjEuMDgxNDA4NTggLTAuMjc5NzMyNDMgMjMuMTQ0NTMxMjUgLTAuMjkyOTY4NzUgQzI1LjAwNjIxOTQ4IC0wLjMxNjUzNDQyIDI1LjAwNjIxOTQ4IC0wLjMxNjUzNDQyIDI2LjkwNTUxNzU4IC0wLjM0MDU3NjE3IEMzMCAwIDMwIDAgMzEuOTI4NDY2OCAxLjM5MzMxMDU1IEMzMyAzIDMzIDMgMzMgNSBDMjIuMTEgNSAxMS4yMiA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0OSw3OSkiLz4KPHBhdGggZD0iTTAgMCBDMC42NiAwIDEuMzIgMCAyIDAgQzIuMDg2MzY3MTkgMC41Njg0NzY1NiAyLjE3MjczNDM3IDEuMTM2OTUzMTIgMi4yNjE3MTg3NSAxLjcyMjY1NjI1IEMzLjM1MjcwNTM2IDcuNzE4MDc4MSA1LjI4MTQzMTU2IDExLjIwNTAwMzg1IDkgMTYgQzkgMTYuNjYgOSAxNy4zMiA5IDE4IEM4LjI3NTU0Njg3IDE3Ljg0NjYwMTU2IDcuNTUxMDkzNzUgMTcuNjkzMjAzMTIgNi44MDQ2ODc1IDE3LjUzNTE1NjI1IEM0LjA3MzM2NjA3IDE2Ljk3MzE0OTc3IDQuMDczMzY2MDcgMTYuOTczMTQ5NzcgMS41NzAzMTI1IDE2Ljc0NjA5Mzc1IEMtNC45MDkwNjM1OCAxNS45Mjg0MDg5MSAtNy44MDY5NTYzOCAxMy44OTExMzYyMyAtMTEuODIwMzEyNSA4Ljc3NzM0Mzc1IEMtMTMgNyAtMTMgNyAtMTMgNiBDLTYuMzc1IDUuODc1IC02LjM3NSA1Ljg3NSAtMyA3IEMtMi44NzYyNSA2LjQwMTg3NSAtMi43NTI1IDUuODAzNzUgLTIuNjI1IDUuMTg3NSBDLTIgMyAtMiAzIDAgMCBaICIgZmlsbD0iI0YyRjdGNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5NCw1NSkiLz4KPHBhdGggZD0iTTAgMCBDMSAyIDEgMiAwLjkzNzUgNS44MTI1IEMwLjg3OTY0ODA4IDkuMzg2NDYzMTggMS42NDA2MzE3NyAxMS42ODY1Mzk5NCAzIDE1IEMzLjQ3NzIyODgxIDE5LjM3NDU5NzM5IDMuNDk4NjQwNDQgMjEuMjg5ODE1MTMgMC45Mzc1IDI0LjkzNzUgQy0xLjA1MTY1MDY5IDI4LjA4MTY0MTQxIC0xLjI4MzkwMDM2IDI4LjY1NDU4MTU5IC0wLjkzNzUgMzIuMTI1IEMtMC4wNDE1OTEyMiAzNS44MjgwODk2MSAwLjc4Mzk2MDg3IDM3LjEwOTUxNDE4IDMgNDAgQzMuNjQwNzA0NzggNDQuOTEyMDY5OTQgMi4yODAwNjUxNiA0Ny43MTM0Nzc1IDAgNTIgQy0wLjY5OTA3NDE0IDU0LjczNTcyNTg1IC0wLjY5OTA3NDE0IDU0LjczNTcyNTg1IC0xIDU3IEMtMS45OSA1NyAtMi45OCA1NyAtNCA1NyBDLTMuMjQ3ODEzNDEgNTAuNDgxMDQ5NTYgLTMuMjQ3ODEzNDEgNTAuNDgxMDQ5NTYgLTEuOTM3NSA0Ny45Mzc1IEMtMC41NTU0NjYzNyA0NS4wODEyOTcxNyAtMC42Mjk3ODY4MiA0My4xNDY4MTIgLTEgNDAgQy0xLjkyMzQ0MjExIDM4LjIzNzkyNDggLTEuOTIzNDQyMTEgMzguMjM3OTI0OCAtMy4wNjI1IDM2LjUgQy00LjcyOTM3MDExIDMzLjgyMjM2ODIyIC01LjAwMjU5OTI2IDMzLjEzMjU2MjEgLTQuOTM3NSAyOS44MTI1IEMtNCAyNyAtNCAyNyAtMi40Mzc1IDI1LjE4NzUgQy0wLjE2NjczOTU4IDIxLjczMTk5NTAyIC0wLjYxNDU0MzE5IDE4LjAyNTA1ODY1IC0xIDE0IEMtMS4zMyAxMy4wMSAtMS42NiAxMi4wMiAtMiAxMSBDLTIuMTY3OTY4NzUgOS4wNjI1IC0yLjE2Nzk2ODc1IDkuMDYyNSAtMi4xODc1IDcgQy0yLjIwMTY3OTY5IDYuMzE5Mzc1IC0yLjIxNTg1OTM4IDUuNjM4NzUgLTIuMjMwNDY4NzUgNC45Mzc1IEMtMiAzIC0yIDMgMCAwIFogIiBmaWxsPSIjMTQ3MDRCIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ4LDYyKSIvPgo8cGF0aCBkPSJNMCAwIEMxMi44NyAwIDI1Ljc0IDAgMzkgMCBDMzUuMDM1MDk2OTkgMy45NjQ5MDMwMSAzNS4wMzUwOTY5OSAzLjk2NDkwMzAxIDMwLjY1MTg1NTQ3IDQuMTEzNTI1MzkgQzI5LjIyMzYyMzAzIDQuMTEzMzY2ODggMjcuNzk1Mzg0NTggNC4xMDc3MDczNSAyNi4zNjcxODc1IDQuMDk3NjU2MjUgQzI1LjIzOTQzNDA1IDQuMDk1NTMzODMgMjUuMjM5NDM0MDUgNC4wOTU1MzM4MyAyNC4wODg4OTc3MSA0LjA5MzM2ODUzIEMyMS42ODQyMjQ5IDQuMDg3NzY0NjUgMTkuMjc5NjQ0NzMgNC4wNzUyMTE1NyAxNi44NzUgNC4wNjI1IEMxNS4yNDYwOTUwOSA0LjA1NzQ4NTUgMTMuNjE3MTg4NzMgNC4wNTI5MjI1IDExLjk4ODI4MTI1IDQuMDQ4ODI4MTIgQzcuOTkyMTUxNzMgNC4wMzc3OTM5NyAzLjk5NjA5MTU4IDQuMDIwNTI2NzkgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFGNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0MSwxMDIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNDQ1MDA2NiAyLjkzNTY2NDIzIDMuNTc0ODI0NjQgNS4yNTc0NDI5NCAzLjk2ODc1IDkuNTk3NjU2MjUgQzMuOTk4ODM1MiAxMS45MTA0NTU4IDMuNzA3ODg2MzggMTMuODY2Mzg3MzUgMy4yNSAxNi4xMjUgQzIuOTg0MTIwNjEgMjAuMjQ2MTMwNTMgMy4xMDk4NDA0MiAyMC42ODU1NzQyMiA1LjQzNzUgMjMuNzUgQzUuOTEwNTg1OTQgMjQuMjgxMDkzNzUgNi4zODM2NzE4NyAyNC44MTIxODc1IDYuODcxMDkzNzUgMjUuMzU5Mzc1IEM4IDI3IDggMjcgOCAzMSBDMTAuMzEgMzEuNjYgMTIuNjIgMzIuMzIgMTUgMzMgQzE1IDMzLjk5IDE1IDM0Ljk4IDE1IDM2IEMxNi4zMiAzNi42NiAxNy42NCAzNy4zMiAxOSAzOCBDMTkgMzguOTkgMTkgMzkuOTggMTkgNDEgQzE3LjkxNzE4NzUgNDAuNDc0MDYyNSAxNy45MTcxODc1IDQwLjQ3NDA2MjUgMTYuODEyNSAzOS45Mzc1IEMxNC4wNzY4ODc3IDM4Ljc1NjQ4MjEyIDE0LjA3Njg4NzcgMzguNzU2NDgyMTIgMTEuNSAzOS41NjI1IEM5IDQwIDkgNDAgNi4xODc1IDM4LjU2MjUgQzUuNDY1NjI1IDM4LjA0Njg3NSA0Ljc0Mzc1IDM3LjUzMTI1IDQgMzcgQzQuMTk1MjkyOTcgMzYuMTY0Njg3NSA0LjE5NTI5Mjk3IDM2LjE2NDY4NzUgNC4zOTQ1MzEyNSAzNS4zMTI1IEM1LjMwMzg2MTMxIDMwLjQ2NzI5MzAxIDUuMzAzODYxMzEgMzAuNDY3MjkzMDEgMy45MTc5Njg3NSAyNS44NjcxODc1IEMyLjk3NDUwMDc2IDI0LjU0MTY1Mzk2IDIuMDI5MTkzNjQgMjMuMjE3NDI3NDggMS4wODIwMzEyNSAyMS44OTQ1MzEyNSBDLTAuNjgwNTA5NzQgMTguODA4NDkzNzggMC4yMzQyODE5NyAxNi4zNTczNzkwNyAxIDEzIEMxLjA4MjI5MTcgMTEuNDM5MTEyMjkgMS4xMjI0NDU5OSA5Ljg3NTU1MzM3IDEuMTI1IDguMzEyNSBDMS4xMjg4NjcxOSA3LjIyMzg4NjcyIDEuMTI4ODY3MTkgNy4yMjM4ODY3MiAxLjEzMjgxMjUgNi4xMTMyODEyNSBDMC45OTc4MDczMiAzLjk2NTExMDU5IDAuNTg3NzI5NCAyLjA2NjM4MTk1IDAgMCBaICIgZmlsbD0iI0VGRjVGMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3OCw2MykiLz4KPHBhdGggZD0iTTAgMCBDOS4yNCAwIDE4LjQ4IDAgMjggMCBDMjggMS42NSAyOCAzLjMgMjggNSBDMTguNzYgNSA5LjUyIDUgMCA1IEMwIDMuMzUgMCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTEwLDk0KSIvPgo8cGF0aCBkPSJNMCAwIEM5LjI0IDAgMTguNDggMCAyOCAwIEMyOCAxLjY1IDI4IDMuMyAyOCA1IEMxOC43NiA1IDkuNTIgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1MTAsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzkuMjQgMCAxOC40OCAwIDI4IDAgQzI4IDEuNjUgMjggMy4zIDI4IDUgQzE4Ljc2IDUgOS41MiA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTUxMCw1MCkiLz4KPHBhdGggZD0iTTAgMCBDMCAzIDAgMyAtMSA1IEMtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAwIDE2IEMwLjc1NDE0MjM1IDIyLjQ5MDU2OTM3IC0wLjI2NzY1MDE5IDI1LjU4MjA3Mjg1IC00IDMxIEMtMy45Mjc0OTIxNCAzNC41NTI4ODQ5NCAtMy4zMTc3NDE2NCAzNi40OTE2MTMzNyAtMS40Mzc1IDM5LjUgQzAuNDMyMjMyNTQgNDIuNzUxNzA4NzYgMC40OTI4MjA0OCA0NC4yNjg2NDQ5NCAwIDQ4IEMtMS4xNzkwNDA1IDUxLjQwNDQxNTYzIC0yLjU0MTk2MzU0IDU0LjcwNjM5OTc4IC00IDU4IEMtNC45OSA1Ny42NyAtNS45OCA1Ny4zNCAtNyA1NyBDLTYuNTc1MjcyMSA1NC40NTE2MzI2IC02LjE4NjYwNjY3IDUyLjM0MDI4Mjc1IC00LjkzNzUgNTAuMDYyNSBDLTMuNjI5MDkzODEgNDcuMTg0MDA2MzkgLTMuNjg2MTgxNDMgNDUuMTM4MTg1NzMgLTQgNDIgQy00LjQ5NSA0MS4wMSAtNC45OSA0MC4wMiAtNS41IDM5IEMtNy4yMTc0NTA3IDM1LjU2NTA5ODYgLTcuNTUyMzU3MzMgMzMuNzg3NTkzMTMgLTcgMzAgQy01Ljk4MjkyOTY5IDI4LjY2Nzc1MzkxIC01Ljk4MjkyOTY5IDI4LjY2Nzc1MzkxIC00Ljk0NTMxMjUgMjcuMzA4NTkzNzUgQy0yLjU3NzgwMDU3IDIzLjI4MTkyMTg1IC0yLjgyMDAzNjc0IDIwLjUwMjM1NDg2IC0zLjQzNzUgMTYuMDYyNSBDLTQuMjQwNTQ3MzkgMTAuMDc2NjY0NDYgLTMuNzgyNzc2OTMgNi4zMjc0MTg5MSAtMSAxIEMtMC42NyAwLjY3IC0wLjM0IDAuMzQgMCAwIFogIiBmaWxsPSIjRTRFRUVBIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ4LDYwKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjkwOTM4NzAzIDMuNzM5NDEzNjggMy45MDkzODcwMyAzLjczOTQxMzY4IDQuMTMyODEyNSA2Ljg0NzY1NjI1IEM0LjEzMDIzNDM4IDcuNTc4NTU0NjkgNC4xMjc2NTYyNSA4LjMwOTQ1MzEzIDQuMTI1IDkuMDYyNSBDNC4xMjI0MjE4OCA5Ljg2MzAwNzgxIDQuMTE5ODQzNzUgMTAuNjYzNTE1NjMgNC4xMTcxODc1IDExLjQ4ODI4MTI1IEM0LjAwMTcwMTk1IDEzLjk2MzUyMTY0IDMuNjUxMDI0NzkgMTYuMzA3MDIyNDggMy4yNSAxOC43NSBDMi43NjIwMjY5NSAyMi40MjA4OTQxOCAyLjc2MjAyNjk1IDIyLjQyMDg5NDE4IDQuOTM3NSAyNS41NjI1IEM1Ljk1ODQzNzUgMjYuNzY5MDYyNSA1Ljk1ODQzNzUgMjYuNzY5MDYyNSA3IDI4IEM4LjA0NzU1MTk0IDMzLjMxNDE0MzcgNi44NDIyMzI0NCAzNi40OTk3OTg2MyA0IDQxIEMzLjM3MDk3MDM5IDQ1LjkyNzM5ODU3IDQuNzQ3ODkzNDUgNDguNjgzNDYyNDQgNyA1MyBDNyA1NC4zMiA3IDU1LjY0IDcgNTcgQzQgNTYgNCA1NiAyLjc5Njg3NSA1My45MjU3ODEyNSBDLTAuNzYwMjg1NzMgNDUuMDQ2MTUyNDIgLTAuNzYwMjg1NzMgNDUuMDQ2MTUyNDIgMSA0MCBDMS41MTU2MjUgMzkuMTc1IDIuMDMxMjUgMzguMzUgMi41NjI1IDM3LjUgQzQuMzg3MDI3NTYgMzQuMzI2OTA4NTggNC41MTY0NDExOCAzMi42MTUwODgyNSA0IDI5IEMzLjM0IDI4LjAzMDYyNSAyLjY4IDI3LjA2MTI1IDIgMjYuMDYyNSBDLTAuNDEwNTc3ODIgMjIuMzcxMzAyNzIgLTAuNDA4MzI3NTUgMjAuMzI4MjcxOTkgMCAxNiBDMC4zMyAxNS4wMSAwLjY2IDE0LjAyIDEgMTMgQzEuMDkyNDczODEgMTEuNTIzMTM4ODkgMS4xMjk5OTA3MSAxMC4wNDIyNDQ5OSAxLjEyNSA4LjU2MjUgQzEuMTI4ODY3MTkgNy40MTk3NDYwOSAxLjEyODg2NzE5IDcuNDE5NzQ2MDkgMS4xMzI4MTI1IDYuMjUzOTA2MjUgQzEuMDAyNzYwMTUgNC4wNDY4NDE0MSAwLjYwODU2MTk5IDIuMTIwMzA3MjQgMCAwIFogIiBmaWxsPSIjRTZGMEVDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzc0LDYxKSIvPgo8cGF0aCBkPSJNMCAwIEM4LjI1IDAgMTYuNSAwIDI1IDAgQzI1LjY2IDEuNjUgMjYuMzIgMy4zIDI3IDUgQzE4LjA5IDUgOS4xOCA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU4Nyw1NykiLz4KPHBhdGggZD0iTTAgMCBDOC4yNSAwIDE2LjUgMCAyNSAwIEMyNSAxLjY1IDI1IDMuMyAyNSA1IEMxNi40MiA1IDcuODQgNSAtMSA1IEMtMC42NyAzLjM1IC0wLjM0IDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjQsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEMyLjMzIDEuNjUgMi42NiAzLjMgMyA1IEM0LjY1IDUgNi4zIDUgOCA1IEM3LjAxIDYuNDg1IDcuMDEgNi40ODUgNiA4IEM1LjgzMjg2NDMxIDEwLjYyNTMxNTI0IDUuODMyODY0MzEgMTAuNjI1MzE1MjQgNiAxMyBDNi42NiAxMy4zMyA3LjMyIDEzLjY2IDggMTQgQzcuMzQgMTQgNi42OCAxNCA2IDE0IEM2IDE0LjY2IDYgMTUuMzIgNiAxNiBDMi43IDE2IC0wLjYgMTYgLTQgMTYgQy00IDE1LjM0IC00IDE0LjY4IC00IDE0IEMtNC42NiAxMy42NyAtNS4zMiAxMy4zNCAtNiAxMyBDLTUuMzQgMTMgLTQuNjggMTMgLTQgMTMgQy0zLjc5OTEzNTU3IDkuMjg0MDA4MDkgLTMuODQ4MDU2MyA4LjIyNzkxNTU1IC02IDUgQy00LjM1IDUgLTIuNyA1IC0xIDUgQy0wLjY3IDMuMzUgLTAuMzQgMS43IDAgMCBaICIgZmlsbD0iI0Q4RTdFMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2MCwzNykiLz4KPHBhdGggZD0iTTAgMCBDMCAxLjY1IDAgMy4zIDAgNSBDLTAuNzYzMTI1IDQuNzczMTI1IC0xLjUyNjI1IDQuNTQ2MjUgLTIuMzEyNSA0LjMxMjUgQy0zLjE5OTM3NSA0LjIwOTM3NSAtNC4wODYyNSA0LjEwNjI1IC01IDQgQy02LjgzNTQ3OTkgNS4zMzM3ODU3NSAtNi44MzU0Nzk5IDUuMzMzNzg1NzUgLTggNyBDLTcuMzQgOC42NSAtNi42OCAxMC4zIC02IDEyIEMtMy42OSAxMiAtMS4zOCAxMiAxIDEyIEMxIDEzLjMyIDEgMTQuNjQgMSAxNiBDLTUuMjAwODE5NjcgMTcuMzM3NDMxNjkgLTUuMjAwODE5NjcgMTcuMzM3NDMxNjkgLTguODEyNSAxNS44MTI1IEMtMTEuMTQwMzY2MTcgMTMuODgzNjk2NiAtMTIuMTcyMjU2MTEgMTIuODk3MTAzNjEgLTEzIDEwIEMtMTIuODU1NzAyNCA2LjUzNjg1NzUgLTEyLjM0NTYyNDk3IDQuNTI1MzQ5OTYgLTEwLjQzNzUgMS42MjUgQy02Ljg1NzUyODY3IC0wLjc2MTY0NzU1IC00LjI0ODUyOTc0IC0wLjI4MzIzNTMyIDAgMCBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE5Miw5MykiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQzEuNjUgMyAzLjMgMyA1IDMgQzUgNC4zMiA1IDUuNjQgNSA3IEMzLjM1IDcgMS43IDcgMCA3IEMwIDkuOTcgMCAxMi45NCAwIDE2IEMxLjY1IDE1LjY3IDMuMyAxNS4zNCA1IDE1IEM1IDE2LjMyIDUgMTcuNjQgNSAxOSBDMS43MTMwMzc2NyAxOS43OTk1MzEzOCAwLjI4OTc2ODA4IDIwLjA5NjU4OTM2IC0zIDE5IEMtNC4yNjIzNzczMSAxNi40NzUyNDUzOCAtNC4wOTg1NjQwNCAxNC42ODc5OTUzNCAtNC4wNjI1IDExLjg3NSBDLTQuMDUzNDc2NTYgMTAuOTY0OTIxODggLTQuMDQ0NDUzMTMgMTAuMDU0ODQzNzUgLTQuMDM1MTU2MjUgOS4xMTcxODc1IEMtNC4wMjM1NTQ2OSA4LjQxODUxNTYyIC00LjAxMTk1MzEzIDcuNzE5ODQzNzUgLTQgNyBDLTQuOTkgNyAtNS45OCA3IC03IDcgQy0zLjg2MjA2ODk3IDAgLTMuODYyMDY4OTcgMCAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxMzcsOTApIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuMzMgMS42NSAwLjY2IDMuMyAxIDUgQzAuMDUxMjUgNC43OTM3NSAtMC44OTc1IDQuNTg3NSAtMS44NzUgNC4zNzUgQy0zLjQyMTg3NSA0LjE4OTM3NSAtMy40MjE4NzUgNC4xODkzNzUgLTUgNCBDLTcuMzQ5NzM4MTggNS44OTc1NTE0NCAtNy4zNDk3MzgxOCA1Ljg5NzU1MTQ0IC03LjEyNSA5LjEyNSBDLTcuMDYzMTI1IDEwLjU0ODEyNSAtNy4wNjMxMjUgMTAuNTQ4MTI1IC03IDEyIEMtNC4zNiAxMiAtMS43MiAxMiAxIDEyIEMxIDEzLjMyIDEgMTQuNjQgMSAxNiBDLTUuMzI5OTc5ODggMTcuMjE3MzAzODIgLTUuMzI5OTc5ODggMTcuMjE3MzAzODIgLTguMzEyNSAxNi4yNSBDLTEwIDE1IC0xMCAxNSAtMTIgMTIgQy0xMi40NDUwNTU3NiA3Ljk5NDQ5ODEzIC0xMi4zNDMxOTE2NyA1LjY3MjA4MzY5IC0xMC41IDIuMDYyNSBDLTYuODg4MjI0MDkgLTAuOTE3MjE1MTMgLTQuNTg5MTk0MjEgLTAuMzgyNDMyODUgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTIyLDkzKSIvPgo8cGF0aCBkPSJNMCAwIEM3LjU5IDAgMTUuMTggMCAyMyAwIEMyMy4zMyAxLjY1IDIzLjY2IDMuMyAyNCA1IEMxNi4wOCA1IDguMTYgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRjcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1ODcsNTApIi8+CjxwYXRoIGQ9Ik0wIDAgQzcuMjYgMCAxNC41MiAwIDIyIDAgQzIyIDEuNjUgMjIgMy4zIDIyIDUgQzE0LjQxIDUgNi44MiA1IC0xIDUgQy0wLjY3IDMuMzUgLTAuMzQgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYyNyw1MCkiLz4KPHBhdGggZD0iTTAgMCBDMy45NiAwIDcuOTIgMCAxMiAwIEMxMiAzLjY2NjY2NjY3IDEyIDcuMzMzMzMzMzMgMTIgMTEgQzguMDQgMTEgNC4wOCAxMSAwIDExIEMwIDcuMzMzMzMzMzMgMCAzLjY2NjY2NjY3IDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc4MiwxMTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzkuMjQgMCAxOC40OCAwIDI4IDAgQzI4IDEuMzIgMjggMi42NCAyOCA0IEMxOC43NiA0IDkuNTIgNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTEwLDEwMikiLz4KPHBhdGggZD0iTTAgMCBDMCAxLjY1IDAgMy4zIDAgNSBDLTAuNTU1NTg1OTQgNC41MTQwMjM0NCAtMS4xMTExNzE4OCA0LjAyODA0Njg4IC0xLjY4MzU5Mzc1IDMuNTI3MzQzNzUgQy00LjM3OTY1MzUgMS43NDk2NzE5NyAtNS44NjQwNjM4NiAxLjU2NzMyNDE5IC05LjA2MjUgMS41NjI1IEMtOS45MTk3MjY1NiAxLjU0MzE2NDA2IC0xMC43NzY5NTMxMyAxLjUyMzgyODEzIC0xMS42NjAxNTYyNSAxLjUwMzkwNjI1IEMtMTQuMTc3NTgwNDEgMS43OTY0NDEzNyAtMTQuMTc3NTgwNDEgMS43OTY0NDEzNyAtMTUuODA4NTkzNzUgNC4wMjczNDM3NSBDLTE2LjM5ODMzOTg0IDUuMDAzODA4NTkgLTE2LjM5ODMzOTg0IDUuMDAzODA4NTkgLTE3IDYgQy0xNS4wMiA2IC0xMy4wNCA2IC0xMSA2IEMtMTAuNjcgNy42NSAtMTAuMzQgOS4zIC0xMCAxMSBDLTExLjMyIDExIC0xMi42NCAxMSAtMTQgMTEgQy0xNCAxMC4zNCAtMTQgOS42OCAtMTQgOSBDLTE1LjMyIDkgLTE2LjY0IDkgLTE4IDkgQy0xOC4zMyA3LjM1IC0xOC42NiA1LjcgLTE5IDQgQy0xOS42NiA0LjY2IC0yMC4zMiA1LjMyIC0yMSA2IEMtMjEgNC4wMiAtMjEgMi4wNCAtMjEgMCBDLTEzLjk3OTM2NDY0IC0yLjM5MDAwMzUzIC02Ljg1MjIxNDU0IC0zLjUzNjYyNjg2IDAgMCBaICIgZmlsbD0iIzE5NzM0RiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3MCw1NykiLz4KPHBhdGggZD0iTTAgMCBDNi45MyAwIDEzLjg2IDAgMjEgMCBDMjEgMS42NSAyMSAzLjMgMjEgNSBDMTQuMDcgNSA3LjE0IDUgMCA1IEMwIDMuMzUgMCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjI5LDk0KSIvPgo8cGF0aCBkPSJNMCAwIEMwIDAuOTkgMCAxLjk4IDAgMyBDLTAuOTkgMyAtMS45OCAzIC0zIDMgQy0zIDMuNjYgLTMgNC4zMiAtMyA1IEMtMi4wMSA1LjMzIC0xLjAyIDUuNjYgMCA2IEMwIDcuMzIgMCA4LjY0IDAgMTAgQy02LjYyNSAxMi44NzUgLTYuNjI1IDEyLjg3NSAtMTAgMTQgQy0xMS4xOTI4NzQxMSAxMC4xMjMxNTkxMyAtMTIgNy4wODM3ODA3NyAtMTIgMyBDLTEwLjc1MzM2NjY5IDIuNDkxNjY0MDkgLTkuNTAyNTA2MTMgMS45OTM2ODg1NSAtOC4yNSAxLjUgQy03LjU1MzkwNjI1IDEuMjIxNTYyNSAtNi44NTc4MTI1IDAuOTQzMTI1IC02LjE0MDYyNSAwLjY1NjI1IEMtNCAwIC00IDAgMCAwIFogIiBmaWxsPSIjMUM3NTUxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzI5LDgwKSIvPgo8cGF0aCBkPSJNMCAwIEM2LjYgMCAxMy4yIDAgMjAgMCBDMjAgMS42NSAyMCAzLjMgMjAgNSBDMTMuNCA1IDYuOCA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFFNzBDMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU4Nyw5NCkiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwIDIuNjQgMCA0IDAgQzQgNy45MiA0IDE1Ljg0IDQgMjQgQzIuNjggMjQgMS4zNiAyNCAwIDI0IEMwIDE2LjA4IDAgOC4xNiAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwNzcsODUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuNjA4NzUgLTAuMDIwNjI1IDMuMjE3NSAtMC4wNDEyNSA0Ljg3NSAtMC4wNjI1IEM1Ljc3OTkyMTg4IC0wLjA3NDEwMTU2IDYuNjg0ODQzNzUgLTAuMDg1NzAzMTIgNy42MTcxODc1IC0wLjA5NzY1NjI1IEMxMCAwIDEwIDAgMTIgMSBDMTEuMzQgMi4zMiAxMC42OCAzLjY0IDEwIDUgQzguMzUgNSA2LjcgNSA1IDUgQzQuNjcgOC42MyA0LjM0IDEyLjI2IDQgMTYgQzIuNjggMTYgMS4zNiAxNiAwIDE2IEMwIDEwLjcyIDAgNS40NCAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxNDksOTMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzYuMjcgMCAxMi41NCAwIDE5IDAgQzE4LjY3IDEuNjUgMTguMzQgMy4zIDE4IDUgQzEyLjM5IDUgNi43OCA1IDEgNSBDMC42NyAzLjM1IDAuMzQgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYwOSw3OSkiLz4KPHBhdGggZD0iTTAgMCBDNi45MyAwIDEzLjg2IDAgMjEgMCBDMjEgMS4zMiAyMSAyLjY0IDIxIDQgQzEzLjc0IDQgNi40OCA0IC0xIDQgQy0wLjY3IDIuNjggLTAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjEsNjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuODEyNSAyLjE4NzUgMC44MTI1IDIuMTg3NSAxIDUgQy0xLjEyNSA3Ljg3NSAtMS4xMjUgNy44NzUgLTQgMTAgQy02LjgxMjUgOS44MTI1IC02LjgxMjUgOS44MTI1IC05IDkgQy05Ljc1IDYuNzUgLTkuNzUgNi43NSAtMTAgNCBDLTcuMTk2NDEzNTIgLTAuMTQ5MzA3OTkgLTQuODI5NDYzOCAtMC40MzkwNDIxNiAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxMDgsNDApIi8+CjxwYXRoIGQ9Ik0wIDAgQzYuOTMgMCAxMy44NiAwIDIxIDAgQzIxIDEuMzIgMjEgMi42NCAyMSA0IEMxNC4wNyA0IDcuMTQgNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjI5LDEwMikiLz4KPHBhdGggZD0iTTAgMCBDNi42IDAgMTMuMiAwIDIwIDAgQzIwLjMzIDEuMzIgMjAuNjYgMi42NCAyMSA0IEMxNC4wNyA0IDcuMTQgNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTk1LDY1KSIvPgo8cGF0aCBkPSJNMCAwIEM2LjYgMCAxMy4yIDAgMjAgMCBDMjAgMS4zMiAyMCAyLjY0IDIwIDQgQzEzLjQgNCA2LjggNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTg3LDEwMikiLz4KPHBhdGggZD0iTTAgMCBDMC4zMyAwLjY2IDAuNjYgMS4zMiAxIDIgQzAuNjcgMi42NiAwLjM0IDMuMzIgMCA0IEMwLjAyMzc5MDQgNi4zMTEwNzg3OCAwLjAyMzc5MDQgNi4zMTEwNzg3OCAwLjMxMjUgOC44NzUgQzAuMzkxMTMyODEgOS43Mzg2NzE4NyAwLjQ2OTc2NTYzIDEwLjYwMjM0Mzc1IDAuNTUwNzgxMjUgMTEuNDkyMTg3NSBDMS4wMDMyMDcyNCAxNC4wMTc5MDQ3NSAxLjgxMjYwODMzIDE1Ljc0ODIxMzQgMyAxOCBDMy42ODc1MDI5NCAyMy4yNzA4NTU4NiAyLjE2OTQxODg1IDI1Ljg0MDEzNzc1IC0xIDMwIEMtMS42NiAyOS42NyAtMi4zMiAyOS4zNCAtMyAyOSBDLTIuNTA1IDI3Ljk3OTA2MjUgLTIuNTA1IDI3Ljk3OTA2MjUgLTIgMjYuOTM3NSBDLTAuNTQwNjAwMTQgMjIuNjUwNTEyOSAtMC4yNjA1MDE3MyAxOC44MDI1MjcwNCAtMiAxNC41NjI1IEMtMy40NjUwNTgyOSAxMC44MDgyODgxMiAtMy4zMjAyMDE1OSA4LjAzNDU0MDAyIC0zIDQgQy0xLjUgMS41IC0xLjUgMS41IDAgMCBaICIgZmlsbD0iI0U1RUZFQiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1MSw2MCkiLz4KPHBhdGggZD0iTTAgMCBDMC4zMyAwIDAuNjYgMCAxIDAgQzAuOTg4Mzk4NDQgMC43NTAyMzQzNyAwLjk3Njc5Njg3IDEuNTAwNDY4NzUgMC45NjQ4NDM3NSAyLjI3MzQzNzUgQzAuOTE5NjU0NTMgNy4zOTkxODY2NiAwLjk4NDI4NjYxIDEyLjMwMTE4MTk1IDEuNzUgMTcuMzc1IEMyLjE5NjY0NjM5IDIxLjE0NzM1MTI3IDIuMTA3NDI3NTkgMjEuODEwMjExMjYgMC4xMjUgMjUuMzEyNSBDLTAuOTI2ODc1IDI2LjY0MjgxMjUgLTAuOTI2ODc1IDI2LjY0MjgxMjUgLTIgMjggQy0yLjc4MjE1NTg4IDMwLjcyODI1MDQgLTIuNzgyMTU1ODggMzAuNzI4MjUwNCAtMyAzMyBDLTMuOTkgMzMgLTQuOTggMzMgLTYgMzMgQy01LjY2Mzk0OTIgMjkuMzg3NDUzODUgLTUuNDU0NzA0MzIgMjcuNDg1NTg5OSAtMi45Mjk2ODc1IDI0Ljc4OTA2MjUgQy0wLjM4MTE3MzczIDIxLjEwNTU4MzA5IC0wLjgyNDUyNDMzIDE4LjI5NzIzMDcyIC0xLjM3NSAxNC4wNjI1IEMtMS45OTMyNTI0NiA4Ljg4OTQ2NTc5IC0yLjA0NDM3NzU4IDQuOTExMTE3NTYgMCAwIFogIiBmaWxsPSIjMkE3RDVDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ0LDYyKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjE2MTE1Nzc2IDEuMzY5ODM1MDMgMy45OTI3MDkyIDEuOTg5MDYzOCA2IDUgQzYuNTMwNzQ3NDEgMTAuNTE5NzczMDggNS4zMDE0OTUxMSAxNC4wMjg3NzA1NSAzIDE5IEMyLjMwODU5NDc4IDIxLjc3ODg4NjEzIDIuMzA4NTk0NzggMjEuNzc4ODg2MTMgMiAyNCBDMS4wMSAyNCAwLjAyIDI0IC0xIDI0IEMtMS4yNTgxMzMwMiAyMC4zODYxMzc3NCAtMS4xNjgxNTY2NyAxOC4zMjkzMDY4IDAuNSAxNS4wNjI1IEMyLjczMzE5NzQyIDEwLjUwMzA1NTI2IDIuNjIzNDM0NjEgNi44MzEzMzkxNiAxIDIuMDYyNSBDMC42NyAxLjM4MTg3NSAwLjM0IDAuNzAxMjUgMCAwIFogIiBmaWxsPSIjMTc3MjREIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzUxLDk3KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjMzIDAuOTkgMC42NiAxLjk4IDEgMyBDMC41MDUgMy45MDc1IDAuMDEgNC44MTUgLTAuNSA1Ljc1IEMtMi4zNzE1ODI0MSA5LjgwNTA5NTIzIC0yLjA1NTkwNDQyIDExLjcwMDk2MDU3IC0xIDE2IEMtMC4wODA4Mzc4IDE4LjM3NzMwOTU2IDAuOTUxMzM0NzMgMjAuNjc0Njk4NzUgMiAyMyBDMiAyMy42NiAyIDI0LjMyIDIgMjUgQzEuMDEgMjUgMC4wMiAyNSAtMSAyNSBDLTEuODcyNzk4NjIgMjMuMTMzNjAwMTkgLTIuNzIyNTEwMjcgMjEuMjU2MzkzODkgLTMuNTYyNSAxOS4zNzUgQy00LjI3NTk5NjA5IDE3LjgwODc4OTA2IC00LjI3NTk5NjA5IDE3LjgwODc4OTA2IC01LjAwMzkwNjI1IDE2LjIxMDkzNzUgQy02LjEzMjU2NzY4IDEyLjU3MjY2NDE5IC02LjAzOTIzNjQyIDEwLjYzNzMyNzQ1IC01IDcgQy0zLjU1NDMxMTQ1IDQuNDMwOTQwMzUgLTEuODIzMDY5ODYgMi4zMzcyNjkwNSAwIDAgWiAiIGZpbGw9IiMxMzZGNEEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzcsOTQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEM1LjE4NDE5OTU5IDMuNzk2NTQ1NjcgNS4zODczNDU0OCA3LjExNjc2MjIgNS4yMzgyODEyNSAxMS44NjMyODEyNSBDNC45NDYwNDkxMyAxNC40ODM3ODg5NyA0LjA0MjM4MTk1IDE2LjU4OTQ5MTczIDMgMTkgQzIuNzkzNDQ5MzQgMjIuNDQyNTEwOTcgMi45MDYxNjA2OSAyNC43MTg0ODIwOCA0IDI4IEMyLjA2MjUgMjcuNjI1IDIuMDYyNSAyNy42MjUgMCAyNyBDLTEuNDIxNTEzNDUgMjQuMTU2OTczMDkgLTEuMjM5MjI2MDYgMjIuMTY5NzQ1MjggLTEgMTkgQy0wLjUwNSAxNy44NjU2MjUgLTAuMDEgMTYuNzMxMjUgMC41IDE1LjU2MjUgQzIuNTQzNzYwMDggMTAuNzA4NTY5ODEgMi42OTcwMTA1NCA3LjA0NzQ2ODQ1IDEgMi4wNjI1IEMwLjY3IDEuMzgxODc1IDAuMzQgMC43MDEyNSAwIDAgWiAiIGZpbGw9IiNEREVBRTUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNjksNTkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIgMiAyIDIgMi4yNSA1LjMxMjUgQzIuMDE4NjM0NTIgOC43MjUxNDA4NCAxLjQ3NjUyODggMTAuOTU0NjU5MzUgMCAxNCBDLTAuNjYgMTMuMzQgLTEuMzIgMTIuNjggLTIgMTIgQy0xLjYyNSA4Ljg3NSAtMS42MjUgOC44NzUgLTEgNiBDLTMuMzEgNi4zMyAtNS42MiA2LjY2IC04IDcgQy04LjA0MjcyMSA1LjMzMzg4MDk1IC04LjA0MDYzODMyIDMuNjY2MTcxMTUgLTggMiBDLTUuOTU0NDc5NTggLTAuMDQ1NTIwNDIgLTIuNzI5NDE5MTQgMC4yMzk0MjI3MyAwIDAgWiAiIGZpbGw9IiMwQzZCNDUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzAsNjIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuMjkgMCA4LjU4IDAgMTMgMCBDMTMgMS42NSAxMyAzLjMgMTMgNSBDOC43MSA1IDQuNDIgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjksNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuMzIgMCAyLjY0IDAgNCAwIEM0IDUuMjggNCAxMC41NiA0IDE2IEMyLjY4IDE2IDEuMzYgMTYgMCAxNiBDMCAxMC43MiAwIDUuNDQgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTY5LDkzKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjI5IDAgOC41OCAwIDEzIDAgQzEyLjY3IDAuOTkgMTIuMzQgMS45OCAxMiAzIEMxMC42OCAzIDkuMzYgMyA4IDMgQzggNS42NCA4IDguMjggOCAxMSBDNy4wMSAxMSA2LjAyIDExIDUgMTEgQzUgOC4zNiA1IDUuNzIgNSAzIEMzLjM1IDIuNjcgMS43IDIuMzQgMCAyIEMwIDEuMzQgMCAwLjY4IDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc0OSwxMTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS42NSAxMiAzLjMgMTIgNSBDOC4wNCA1IDQuMDggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1OTUsNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS42NSAxMiAzLjMgMTIgNSBDOC4wNCA1IDQuMDggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1MTgsNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS42NSAxMiAzLjMgMTIgNSBDOC4wNCA1IDQuMDggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRjcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1MTgsNzIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMCAxLjk4IDAgMyAwIEMzIDIuNjQgMyA1LjI4IDMgOCBDNS42NCA4IDguMjggOCAxMSA4IEMxMC42NyA4Ljk5IDEwLjM0IDkuOTggMTAgMTEgQzYuNyAxMSAzLjQgMTEgMCAxMSBDMCA3LjM3IDAgMy43NCAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3OTgsMTE2KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjEyMTE3MTg4IDAuNjAzMjgxMjUgMC4yNDIzNDM3NSAxLjIwNjU2MjUgMC4zNjcxODc1IDEuODI4MTI1IEMwLjUzNDc2NTYzIDIuNjI3MzQzNzUgMC43MDIzNDM3NSAzLjQyNjU2MjUgMC44NzUgNC4yNSBDMS4wMzc0MjE4OCA1LjAzODkwNjI1IDEuMTk5ODQzNzUgNS44Mjc4MTI1IDEuMzY3MTg3NSA2LjY0MDYyNSBDMS45MTcxMzYxNyA5LjAxNDkwNDM4IDEuOTE3MTM2MTcgOS4wMTQ5MDQzOCAzLjA2MjUgMTEuMDkzNzUgQzQuMzcxMjUzNjQgMTMuNzU0ODgyNCA0LjEzMjY4NDUxIDE2LjA4MDk0MDc2IDQgMTkgQzMuMDEgMTkgMi4wMiAxOSAxIDE5IEMwLjcxMTI1IDE3Ljc4MzEyNSAwLjQyMjUgMTYuNTY2MjUgMC4xMjUgMTUuMzEyNSBDLTAuNDgzNjM3NyAxMi44NDMxNjk5MSAtMS4xMzkxMzY4MSAxMC42Njc2MTc2MyAtMi4xMjUgOC4zMTI1IEMtMy4xMDE2MzIyIDUuNzMxNDAwNjMgLTMuMTU2Mzg1NjggMy43MzY3NDk0NSAtMyAxIEMtMSAwIC0xIDAgMCAwIFogIiBmaWxsPSIjMEU2QzQ3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzY4LDEwMikiLz4KPHBhdGggZD0iTTAgMCBDNC45NSAwIDkuOSAwIDE1IDAgQzE0LjM0IDEuMzIgMTMuNjggMi42NCAxMyA0IEM5LjA0IDQgNS4wOCA0IDEgNCBDMC42NyAyLjY4IDAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MTEsODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNjI1NDM5MjIgMC41MTc5MTk4OSA3LjI1MDczNjc2IDEuMDM2Mzk3MjcgMTAuODc1IDEuNTYyNSBDMTIuOTMwODIyNzEgMS44NzcxMDUwMiAxMi45MzA4MjI3MSAxLjg3NzEwNTAyIDE1IDIgQzE1IDMuNjUgMTUgNS4zIDE1IDcgQzkuNTQ1MjA4MTUgNi40MzE3OTI1MiA1LjA4OTQwNzQ0IDUuMDUzNjIwNTUgMCAzIEMwIDIuMDEgMCAxLjAyIDAgMCBaICIgZmlsbD0iI0VFRjRGMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5MSw3MykiLz4KPHBhdGggZD0iTTAgMCBDMy42MyAwIDcuMjYgMCAxMSAwIEMxMSAyLjMxIDExIDQuNjIgMTEgNyBDMTAuMzQgNyA5LjY4IDcgOSA3IEM5IDUuNjggOSA0LjM2IDkgMyBDNy4wMiAzIDUuMDQgMyAzIDMgQzIuNjcgNC4zMiAyLjM0IDUuNjQgMiA3IEMxLjM0IDcgMC42OCA3IDAgNyBDMCA0LjY5IDAgMi4zOCAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MTMsMTIwKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjI5IDAgOC41OCAwIDEzIDAgQzEzIDEuMzIgMTMgMi42NCAxMyA0IEM4LjcxIDQgNC40MiA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRjcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjksODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIuMzMgMS4zMiAxMi42NiAyLjY0IDEzIDQgQzguNzEgNCA0LjQyIDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU3Miw4NykiLz4KPHBhdGggZD0iTTAgMCBDMy40NDQ0NzI5OSAyLjkzNTIwOTUxIDMuNTc3ODc2MSA1LjI1NjU4Mjc0IDMuOTY0ODQzNzUgOS41OTc2NTYyNSBDMy45OTg0NTQwNiAxMS44OTQzNjEgMy43Mzc5MTUwOSAxMy44NzUxMjQzMyAzLjMxMjUgMTYuMTI1IEMyLjkwNDY5NjM3IDIxLjE4MTc2NSA0LjE4MDYwNDkgMjIuODk5MDYxNjcgNyAyNyBDNi4zNCAyNy4zMyA1LjY4IDI3LjY2IDUgMjggQy0wLjA2ODA5Mzg0IDIxLjI0ODM4NzEgLTAuMDY4MDkzODQgMjEuMjQ4Mzg3MSAwLjE4NzUgMTYuNTYyNSBDMC40NTU2MjUgMTUuMzg2ODc1IDAuNzIzNzUgMTQuMjExMjUgMSAxMyBDMS4wODIyOTE3IDExLjQzOTExMjI5IDEuMTIyNDQ1OTkgOS44NzU1NTMzNyAxLjEyNSA4LjMxMjUgQzEuMTI4ODY3MTkgNy4yMjM4ODY3MiAxLjEyODg2NzE5IDcuMjIzODg2NzIgMS4xMzI4MTI1IDYuMTEzMjgxMjUgQzAuOTk3ODA3MzIgMy45NjUxMTA1OSAwLjU4NzcyOTQgMi4wNjYzODE5NSAwIDAgWiAiIGZpbGw9IiNEMEUyREIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzgsNjMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuMjkgMCA4LjU4IDAgMTMgMCBDMTIuNjcgMS4zMiAxMi4zNCAyLjY0IDEyIDQgQzguMDQgNCA0LjA4IDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU3Miw2NSkiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQy0xLjU3OTY3ODA3IDMuNjc1MjgyMjMgLTMuMTYzOTE5MDMgNC4zMzk4OTY5NCAtNC43NSA1IEMtNi4wNzI1NzgxMyA1LjU1Njg3NSAtNi4wNzI1NzgxMyA1LjU1Njg3NSAtNy40MjE4NzUgNi4xMjUgQy0xMCA3IC0xMCA3IC0xNCA3IEMtMTQgNS42OCAtMTQgNC4zNiAtMTQgMyBDLTQuNTg5OTc3MjIgLTAuNDQ0MTkxMzQgLTQuNTg5OTc3MjIgLTAuNDQ0MTkxMzQgMCAwIFogIiBmaWxsPSIjRUZGNUYzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzMxLDczKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzEyIDEuMzIgMTIgMi42NCAxMiA0IEM4LjA0IDQgNC4wOCA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1OTUsODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS4zMiAxMiAyLjY0IDEyIDQgQzguMDQgNCA0LjA4IDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0OSw4NykiLz4KPHBhdGggZD0iTTAgMCBDMy45NiAwIDcuOTIgMCAxMiAwIEMxMiAxLjMyIDEyIDIuNjQgMTIgNCBDOC4wNCA0IDQuMDggNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTE4LDg3KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzEyIDEuMzIgMTIgMi42NCAxMiA0IEM4LjA0IDQgNC4wOCA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1NDksNjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS4zMiAxMiAyLjY0IDEyIDQgQzguMDQgNCA0LjA4IDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTUxOCw2NSkiLz4KPHBhdGggZD0iTTAgMCBDMy4zNzQ2MjcxNSAwLjU0NzIzNjgzIDUuMDgyMzUgMS4wNTQ5IDggMyBDNy4zNCA0Ljk4IDYuNjggNi45NiA2IDkgQzQgOCAyIDcgMCA2IEMwIDQuMDIgMCAyLjA0IDAgMCBaICIgZmlsbD0iIzFENzY1MiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5Myw5MykiLz4KPHBhdGggZD0iTTAgMCBDMCAzIDAgMyAtMSA1IEMtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAwIDE2IEMwLjEyNzgxNzg2IDE4LjY3Mzk0OTY0IDAuMDQzOTE4NzEgMjEuMzIwOTU4NTcgMCAyNCBDLTAuNjYgMjQgLTEuMzIgMjQgLTIgMjQgQy0zLjcyNzI5MzA0IDE3LjI5MDY3OTkxIC00Ljc4MjM1NDYyIDEwLjgxODQwMzYgLTMgNCBDLTEuNDQ5MjE4NzUgMS43MTA5Mzc1IC0xLjQ0OTIxODc1IDEuNzEwOTM3NSAwIDAgWiAiIGZpbGw9IiNEOUU4RTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNDgsNjApIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuMzMgMCAwLjY2IDAgMSAwIEMxIDEuNjUgMSAzLjMgMSA1IEMxLjg4Njg3NSA0LjY5MDYyNSAyLjc3Mzc1IDQuMzgxMjUgMy42ODc1IDQuMDYyNSBDOS4xNjA2NzE0NiAyLjMwNjk1NDQ0IDkuMTYwNjcxNDYgMi4zMDY5NTQ0NCAxMiAyIEMxMi45OSAyLjY2IDEzLjk4IDMuMzIgMTUgNCBDMTQuNjcgNC42NiAxNC4zNCA1LjMyIDE0IDYgQzExLjY4MDI1NzY2IDYuNDE3NTUzNjIgOS4zNDIxNDIwNyA2LjczNTU2NDYgNyA3IEM1LjA1MDkzNzUgNy4yNzg0Mzc1IDUuMDUwOTM3NSA3LjI3ODQzNzUgMy4wNjI1IDcuNTYyNSBDMi4wNTE4NzUgNy43MDY4NzUgMS4wNDEyNSA3Ljg1MTI1IDAgOCBDMCA1LjM2IDAgMi43MiAwIDAgWiAiIGZpbGw9IiMxODcyNEUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMTcsNjgpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMzMzMzMzMzMgMCA2LjY2NjY2NjY3IDAgMTAgMCBDMTAgMS45OCAxMCAzLjk2IDEwIDYgQzcuMzYgNiA0LjcyIDYgMiA2IEMyIDQuNjggMiAzLjM2IDIgMiBDMS4zNCAyIDAuNjggMiAwIDIgQzAgMS4zNCAwIDAuNjggMCAwIFogIiBmaWxsPSIjMDA2NDNDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzg1LDExNykiLz4KPHBhdGggZD0iTTAgMCBDMi45NyAwIDUuOTQgMCA5IDAgQzguNjcgMS42NSA4LjM0IDMuMyA4IDUgQzUuNjkgNSAzLjM4IDUgMSA1IEMwLjY3IDMuMzUgMC4zNCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjE0LDk0KSIvPgo8cGF0aCBkPSJNMCAwIEMwIDAuOTkgMCAxLjk4IDAgMyBDLTMuNjMgNC4zMiAtNy4yNiA1LjY0IC0xMSA3IEMtMTEuMzMgNS42OCAtMTEuNjYgNC4zNiAtMTIgMyBDLTEwLjc1MzM2NjY5IDIuNDkxNjY0MDkgLTkuNTAyNTA2MTMgMS45OTM2ODg1NSAtOC4yNSAxLjUgQy03LjU1MzkwNjI1IDEuMjIxNTYyNSAtNi44NTc4MTI1IDAuOTQzMTI1IC02LjE0MDYyNSAwLjY1NjI1IEMtNCAwIC00IDAgMCAwIFogIiBmaWxsPSIjRUZGNUYyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzI5LDgwKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjA3MDc3Mzc1IDMuMjEyMzIxMjUgMSA1LjYzOTM3ODA3IDEgOSBDMS4zMyA5Ljk5IDEuNjYgMTAuOTggMiAxMiBDMS4wMSAxMiAwLjAyIDEyIC0xIDEyIEMtMS4zMyAxMC4zNSAtMS42NiA4LjcgLTIgNyBDLTMuOTggNyAtNS45NiA3IC04IDcgQy03LjIzNjg3NSA2LjQwMTg3NSAtNi40NzM3NSA1LjgwMzc1IC01LjY4NzUgNS4xODc1IEMtMy42NTE2NDI1IDMuNTMwNDA2NjggLTEuODAyMTcyMSAxLjg5NzAyMzI2IDAgMCBaICIgZmlsbD0iIzBENkI0NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2OCw3NSkiLz4KPHBhdGggZD0iTTAgMCBDMS4yMDE1NzEzMSAzLjYwNDcxMzkzIDEuNTQ5ODEzNDggNy4xMTUwMzA4OCAxLjg3NSAxMC44NzUgQzEuOTYwMDc4MTMgMTEuNTgyNjk1MzEgMi4wNDUxNTYyNSAxMi4yOTAzOTA2MyAyLjEzMjgxMjUgMTMuMDE5NTMxMjUgQzIuNDc2OTI2MjggMTcuMjE5MjgzNTEgMi4yMzk3Mzc5MiAxOC43MTA2NjExMyAtMC40OTIxODc1IDIyLjAwNzgxMjUgQy0xLjMxOTc2NTYyIDIyLjY2NTIzNDM3IC0yLjE0NzM0Mzc1IDIzLjMyMjY1NjI1IC0zIDI0IEMtMi4xMjUgMjAuMTI1IC0yLjEyNSAyMC4xMjUgLTEgMTkgQy0wLjkzOTY4OTYzIDE1LjM4NTE0NzQyIC0wLjk4MDA1NDkzIDExLjc4NDEzNTc2IC0xLjAzOTA2MjUgOC4xNjk5MjE4OCBDLTEuMTAwMTMzMTUgMi4yMDAyNjYyOSAtMS4xMDAxMzMxNSAyLjIwMDI2NjI5IDAgMCBaICIgZmlsbD0iI0RERUFFNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM0Miw2NSkiLz4KPHBhdGggZD0iTTAgMCBDMSAyIDEgMiAwLjkzNzUgNS42ODc1IEMwLjg2OTQ3NzA3IDkuODIxNzgyMyAxLjY5NjU0Mzg5IDEzLjA4OTYzMTY4IDMgMTcgQzIuMzQgMTcgMS42OCAxNyAxIDE3IEMwLjY3IDE4LjMyIDAuMzQgMTkuNjQgMCAyMSBDLTEuMzk3NzM2NjEgMTQuOTA5ODYxOSAtMi40MzkxOTg3NCA5LjI1ODU4MjExIC0yIDMgQy0xLjM0IDIuMDEgLTAuNjggMS4wMiAwIDAgWiAiIGZpbGw9IiMyMTc4NTUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNDgsNjIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuMTk0Njk1NzEgMC41OTkyNDIyNCA4LjAwOTk5ODM0IDEuNTc0OTk5NDEgMTIgMyBDMTIgMy45OSAxMiA0Ljk4IDEyIDYgQzcuNjgyMjU0MiA1LjQ5MjAyOTkxIDMuOTY2OTc4ODYgNC44MDMxNzIyMSAwIDMgQzAgMi4wMSAwIDEuMDIgMCAwIFogIiBmaWxsPSIjRTdGMEVDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzkzLDgwKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjY3NTQyOTc2IDAuMjg2MDQ4OTggMy4zNDM4NTM0MyAwLjYxNzgxMjMzIDUgMSBDNS44NDY4MTEzMyA2LjA4MDg2Nzk2IDYuMDkwMzgwOTkgMTAuODQ4MjgzNzcgNiAxNiBDNS4zNCAxNiA0LjY4IDE2IDQgMTYgQzMuOTUxMDE1NjMgMTUuNDA4MzIwMzEgMy45MDIwMzEyNSAxNC44MTY2NDA2MyAzLjg1MTU2MjUgMTQuMjA3MDMxMjUgQzMuMjYxOTU4IDcuODg5NzQ5MDkgMy4yNjE5NTggNy44ODk3NDkwOSAxIDIgQzAuMzQgMS42NyAtMC4zMiAxLjM0IC0xIDEgQy0wLjY3IDAuNjcgLTAuMzQgMC4zNCAwIDAgWiAiIGZpbGw9IiMxNzcyNEUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzAsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNjA4ODEzMSAwLjgzNTA2MTE3IDMuNjA4ODEzMSAwLjgzNTA2MTE3IDUuODEyNSAtMC41IEM1LjgxMjUgMS4xNSA1LjgxMjUgMi44IDUuODEyNSA0LjUgQzMuNDc5MTY2NjcgNC4xNjY2NjY2NyAxLjE0NTgzMzMzIDMuODMzMzMzMzMgLTEuMTg3NSAzLjUgQy0yLjQ2NjI1IDMuMzU1NjI1IC0zLjc0NSAzLjIxMTI1IC01LjA2MjUgMy4wNjI1IEMtNi4wOTM3NSAyLjg3Njg3NSAtNy4xMjUgMi42OTEyNSAtOC4xODc1IDIuNSBDLTguNTE3NSAxLjg0IC04Ljg0NzUgMS4xOCAtOS4xODc1IDAuNSBDLTUuOTIyMjU5MDcgLTAuNDE4MzQ5MDEgLTMuMzE1NTMyMDkgLTAuNDc3MDk4NDIgMCAwIFogIiBmaWxsPSIjMUI3NDUxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzk5LjE4NzUsNzEuNSkiLz4KPHBhdGggZD0iTTAgMCBDMi45NyAwIDUuOTQgMCA5IDAgQzguNjcgMS4zMiA4LjM0IDIuNjQgOCA0IEM1LjAzIDQgMi4wNiA0IC0xIDQgQy0wLjY3IDIuNjggLTAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiNEQ0VERTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwNDAsOTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTEuNjcgMC45OSAxMS4zNCAxLjk4IDExIDMgQzcuNyAzIDQuNCAzIDEgMyBDMC42NyAyLjAxIDAuMzQgMS4wMiAwIDAgWiAiIGZpbGw9IiNFNzIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3NjYsMTIwKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzExLjY3IDAuOTkgMTEuMzQgMS45OCAxMSAzIEM3LjcgMyA0LjQgMyAxIDMgQzAuNjcgMi4wMSAwLjM0IDEuMDIgMCAwIFogIiBmaWxsPSIjRTkyMDI2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzY2LDExNikiLz4KPHBhdGggZD0iTTAgMCBDOS40MTAwMjI3OCAtMC4zNjkwMjA1IDkuNDEwMDIyNzggLTAuMzY5MDIwNSAxNCAyIEMxNCAzLjY1IDE0IDUuMyAxNCA3IEMxMy41MDUgNi41MjU2MjUgMTMuMDEgNi4wNTEyNSAxMi41IDUuNTYyNSBDOS45MzI3MzUyOSAzLjk1Nzk1OTU1IDguODAwMzY5MDkgMy43NDk5ODYwOSA1Ljg3NSAzLjUgQzQuNTk2MjUgMy4zMzUgMy4zMTc1IDMuMTcgMiAzIEMxLjM0IDIuMDEgMC42OCAxLjAyIDAgMCBaICIgZmlsbD0iIzNEODk2QiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1Niw1NSkiLz4KPHBhdGggZD0iTTAgMCBDMC4yODQ4ODI4MSAwLjU3NDkyMTg4IDAuNTY5NzY1NjIgMS4xNDk4NDM3NSAwLjg2MzI4MTI1IDEuNzQyMTg3NSBDMS41OTM5MzI5NyAzLjE5MzQ0NzYyIDIuMzQwMTUwNTEgNC42MzcwMzEgMy4xMDU0Njg3NSA2LjA3MDMxMjUgQzMuNDYyNTM5MDYgNi43NDgzNTkzOCAzLjgxOTYwOTM4IDcuNDI2NDA2MjUgNC4xODc1IDguMTI1IEM0LjU1MjMwNDY5IDguODA4MjAzMTMgNC45MTcxMDkzOCA5LjQ5MTQwNjI1IDUuMjkyOTY4NzUgMTAuMTk1MzEyNSBDNS41MjYyODkwNiAxMC43OTA4NTkzNyA1Ljc1OTYwOTM4IDExLjM4NjQwNjI1IDYgMTIgQzUuNjcgMTIuNjYgNS4zNCAxMy4zMiA1IDE0IEM0LjM0IDE0IDMuNjggMTQgMyAxNCBDLTEuMDc4Nzc0NjIgNS45NjQ5ODkwNiAtMS4wNzg3NzQ2MiA1Ljk2NDk4OTA2IC0wLjc1IDEuOTM3NSBDLTAuNTAyNSAxLjI5ODEyNSAtMC4yNTUgMC42NTg3NSAwIDAgWiAiIGZpbGw9IiMwQzZCNDUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzgsMTAzKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzExLjAxIDEuNDg1IDExLjAxIDEuNDg1IDEwIDMgQzguMTI1IDMuMzI4MTI1IDguMTI1IDMuMzI4MTI1IDYgMy4yNSBDNS4yOTg3NSAzLjIzNDUzMTI1IDQuNTk3NSAzLjIxOTA2MjUgMy44NzUgMy4yMDMxMjUgQzIgMyAyIDMgMCAyIEMwIDEuMzQgMCAwLjY4IDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc2NiwxMjQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNjMgMCA3LjI2IDAgMTEgMCBDMTAuNjcgMC45OSAxMC4zNCAxLjk4IDEwIDMgQzcuMDMgMyA0LjA2IDMgMSAzIEMwLjY3IDIuMDEgMC4zNCAxLjAyIDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgxMywxMTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNDk1IDAuMzkxODc1IDAuOTkgMC43ODM3NSAxLjUgMS4xODc1IEMwLjE2NjY2NjY3IDEuODU0MTY2NjcgLTEuMTY2NjY2NjcgMi41MjA4MzMzMyAtMi41IDMuMTg3NSBDLTMuNDkgMy43NDQzNzUgLTMuNDkgMy43NDQzNzUgLTQuNSA0LjMxMjUgQy02LjUgNS4xODc1IC02LjUgNS4xODc1IC0xMC41IDUuMTg3NSBDLTEwLjUgNC4xOTc1IC0xMC41IDMuMjA3NSAtMTAuNSAyLjE4NzUgQy0zLjI4Nzc0NjE3IC0xLjA2ODUxNzUxIC0zLjI4Nzc0NjE3IC0xLjA2ODUxNzUxIDAgMCBaICIgZmlsbD0iIzEyNkY0QSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyNy41LDc3LjgxMjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuNjQgMCA1LjI4IDAgOCAwIEM3LjY3IDEuMzIgNy4zNCAyLjY0IDcgNCBDNC42OSA0IDIuMzggNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjRDdFQkRFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDA5LDk2KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjU1NzgwMTk2IDAuNjA5OTA4OTEgNi42ODI4NTg5IDEuNTc4MzY4MSAxMCAzIEM5LjY3IDMuOTkgOS4zNCA0Ljk4IDkgNiBDNS44NTI2MjgxOCA1LjMwMDU4NDA0IDIuOTc0MTExMjQgNC4yMzkyMTMwMiAwIDMgQzAgMi4wMSAwIDEuMDIgMCAwIFogIiBmaWxsPSIjREZFQkU2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzk0LDg3KSIvPgo8cGF0aCBkPSJNMCAwIEMtMSAzIC0xIDMgLTIuODQ3NjU2MjUgNC4xNjc5Njg3NSBDLTMuNTc4NTU0NjkgNC41MDQ0MTQwNiAtNC4zMDk0NTMxMiA0Ljg0MDg1OTM3IC01LjA2MjUgNS4xODc1IEMtNS43OTU5NzY1NiA1LjUzMTY3OTY5IC02LjUyOTQ1MzEyIDUuODc1ODU5MzggLTcuMjg1MTU2MjUgNi4yMzA0Njg3NSBDLTguMTM0MDAzOTEgNi42MTEzODY3MiAtOC4xMzQwMDM5MSA2LjYxMTM4NjcyIC05IDcgQy05LjMzIDUuNjggLTkuNjYgNC4zNiAtMTAgMyBDLTYuMjcwMzQ4NjEgMC45NjU2NDQ2OSAtNC4zMzA5NDk1OCAwIDAgMCBaICIgZmlsbD0iI0U4RjFFRCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyOCw4NykiLz4KPHBhdGggZD0iTTAgMCBDMi4zOTI3MzIzNSAzLjU4OTA5ODUzIDMuMTUzMTA5ODYgNS4yNjMxMzQ3OCAzLjE4NzUgOS41IEMzLjIwMTY3OTY5IDEwLjI5NDA2MjUgMy4yMTU4NTkzOCAxMS4wODgxMjUgMy4yMzA0Njg3NSAxMS45MDYyNSBDMyAxNCAzIDE0IDEgMTYgQy0wLjE1NzAzOTggMTIuNTI4ODgwNTkgLTAuMDMzOTY0ODkgOS43NzM2ODM0NiAwLjA2MjUgNi4xNTYyNSBDMC4wOTg0MjE3OSAzLjgxNDI1MTIzIDAuMDk4NDIxNzkgMy44MTQyNTEyMyAtMSAxIEMtMC42NyAwLjY3IC0wLjM0IDAuMzQgMCAwIFogIiBmaWxsPSIjMjI3OTU2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzc3LDYyKSIvPgo8cGF0aCBkPSJNMCAwIEMwLjY2IDAuMzMgMS4zMiAwLjY2IDIgMSBDMS4zNCAzLjk3IDAuNjggNi45NCAwIDEwIEMtMC45OSA5LjY3IC0xLjk4IDkuMzQgLTMgOSBDLTIuNDQyNzEwODcgNS42NTYyNjUyNSAtMS42NDgyNjExMSAyLjk2Njg3MDAxIDAgMCBaICIgZmlsbD0iI0RDRUFFNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM0NCwxMDgpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMjcyODY2ODIgMi43ODE5MzY4IDQuOTY0Mjc2OTcgNi4yNzk1NDA2NyA3IDEwIEM2LjAxIDEwLjMzIDUuMDIgMTAuNjYgNCAxMSBDMy4zMjU5MTY5MiA5LjczMzA4NDkzIDIuNjYwOTk1MDMgOC40NjEyOTI1MSAyIDcuMTg3NSBDMS42Mjg3NSA2LjQ3OTgwNDY5IDEuMjU3NSA1Ljc3MjEwOTM3IDAuODc1IDUuMDQyOTY4NzUgQzAgMyAwIDMgMCAwIFogIiBmaWxsPSIjRDVFNURGIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzc5LDEwNCkiLz4KPHBhdGggZD0iTTAgMCBDMi42NCAwIDUuMjggMCA4IDAgQzcuMzQgMS4zMiA2LjY4IDIuNjQgNiA0IEMzLjAzIDMuNTA1IDMuMDMgMy41MDUgMCAzIEMwIDIuMDEgMCAxLjAyIDAgMCBaICIgZmlsbD0iI0ZDRkRGQyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAzOCw5OSkiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQy0zLjQ2NSA0LjQ4NSAtMy40NjUgNC40ODUgLTcgNiBDLTcuMzMgNS4wMSAtNy42NiA0LjAyIC04IDMgQy0zLjM3NSAwIC0zLjM3NSAwIDAgMCBaICIgZmlsbD0iI0Q2RTZERiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyOSw5MykiLz4KPHBhdGggZD0iTTAgMCBDLTAuNzUgNy43NSAtMC43NSA3Ljc1IC0zIDEwIEMtNC40NzgzMjI2IDcuMDQzMzU0ODEgLTQuMDYwMzI3ODMgNC4yNTc3MDI2MyAtNCAxIEMtMiAwIC0yIDAgMCAwIFogIiBmaWxsPSIjMkM3RTVEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzcyLDY2KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjkzMDQ1OTMzIDIuNTUxNDQ4MjQgMS4wODU2NDA5MSAzLjc0MDA2NDc4IDAuMjIyNjU2MjUgNi4zNTkzNzUgQy0wLjE2MDE5NTMxIDcuMTQ4MjgxMjUgLTAuNTQzMDQ2ODggNy45MzcxODc1IC0wLjkzNzUgOC43NSBDLTEuNTA3OTEwMTYgOS45NDg4MjgxMyAtMS41MDc5MTAxNiA5Ljk0ODgyODEzIC0yLjA4OTg0Mzc1IDExLjE3MTg3NSBDLTIuMzkwMTk1MzEgMTEuNzc1MTU2MjUgLTIuNjkwNTQ2ODggMTIuMzc4NDM3NSAtMyAxMyBDLTMuNjYgMTIuNjcgLTQuMzIgMTIuMzQgLTUgMTIgQy00LjQ2MjMxMTI4IDguMTI4NjQxMiAtMy40MjI1MjcgNi4wMjgxNTg3NSAtMSAzIEMtMC42NyAyLjAxIC0wLjM0IDEuMDIgMCAwIFogIiBmaWxsPSIjRENFOUU0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQyLDEwMykiLz4KPHBhdGggZD0iTTAgMCBDMC45OSAwLjMzIDEuOTggMC42NiAzIDEgQzIuNTQ2MjUgMS43NDI1IDIuMDkyNSAyLjQ4NSAxLjYyNSAzLjI1IEMwLjMxMzU5MjA0IDUuNDY5MzA1NzggLTAuODgyODA4MDMgNy42Nzk2NzgyMiAtMiAxMCBDLTMuMDYzNTE2NzUgNi42MTYwODMwNyAtMy4yMTQ0Mjk4MiA1LjQxOTUzNjYgLTEuNTYyNSAyLjE4NzUgQy0xLjA0Njg3NSAxLjQ2NTYyNSAtMC41MzEyNSAwLjc0Mzc1IDAgMCBaICIgZmlsbD0iI0RCRTlFMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3OCw5NikiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQy0yLjUgNC42ODc1IC0yLjUgNC42ODc1IC01IDYgQy01LjY2IDUuMDEgLTYuMzIgNC4wMiAtNyAzIEMtMy4zNzUgMCAtMy4zNzUgMCAwIDAgWiAiIGZpbGw9IiMwRDZDNDYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMjksOTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEMyIDAuNjYgMiAxLjMyIDIgMiBDMy4zMiAyIDQuNjQgMiA2IDIgQzYgMi42NiA2IDMuMzIgNiA0IEM0LjY4IDQgMy4zNiA0IDIgNCBDMS42NyA1LjMyIDEuMzQgNi42NCAxIDggQy0wLjM1NDM5NjY4IDUuMjkxMjA2NjUgLTAuMDY1MDE0NTEgMi45OTA2NjczMiAwIDAgWiAiIGZpbGw9IiMxOTczNEYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNTAsNjQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuMzIgMC42NiAyLjY0IDEuMzIgNCAyIEM0IDIuOTkgNCAzLjk4IDQgNSBDMSA1IDEgNSAtMC42ODc1IDMuNSBDLTEuMTIwNjI1IDMuMDA1IC0xLjU1Mzc1IDIuNTEgLTIgMiBDLTEuMzQgMS4zNCAtMC42OCAwLjY4IDAgMCBaICIgZmlsbD0iIzE1NzI0QyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5MiwxMDEpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMC4zMyAxLjk4IDAuNjYgMyAxIEMyLjM0IDMuOTcgMS42OCA2Ljk0IDEgMTAgQzAuMDEgOS4wMSAtMC45OCA4LjAyIC0yIDcgQy0xLjM0IDQuNjkgLTAuNjggMi4zOCAwIDAgWiAiIGZpbGw9IiMyOTdENUIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzMsNzMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIgMC42NjY2NjY2NyA0IDEuMzMzMzMzMzMgNiAyIEM1LjY3IDIuNjYgNS4zNCAzLjMyIDUgNCBDMi4zNTEzOTU3MyA0LjU5MzU1NjE0IC0wLjI5MTk3MzIyIDQuNzQyMDkyNjkgLTMgNSBDLTIuNjI1IDMuMDYyNSAtMi42MjUgMy4wNjI1IC0yIDEgQy0xLjM0IDAuNjcgLTAuNjggMC4zNCAwIDAgWiAiIGZpbGw9IiMzMzgzNjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMjYsNzApIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuMzEgMCA0LjYyIDAgNyAwIEM3IDEuMzIgNyAyLjY0IDcgNCBDNS42OCA0IDQuMzYgNCAzIDQgQzMgMy4zNCAzIDIuNjggMyAyIEMyLjAxIDIgMS4wMiAyIDAgMiBDMCAxLjM0IDAgMC42OCAwIDAgWiAiIGZpbGw9IiM2N0EyOEEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNTMsNjQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMCAxLjk4IDAgMyAwIEMyLjY4NzUgMS44NzUgMi42ODc1IDEuODc1IDIgNCBDMS4wMSA0LjY2IDAuMDIgNS4zMiAtMSA2IEMtMS42MjUgNC4xMjUgLTEuNjI1IDQuMTI1IC0yIDIgQy0xLjM0IDEuMzQgLTAuNjggMC42OCAwIDAgWiAiIGZpbGw9IiMxNDcwNEIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMjgsMTAxKSIvPgo8cGF0aCBkPSJNMCAwIEM0Ljc1IDEuODc1IDQuNzUgMS44NzUgNyAzIEM2LjY3IDMuOTkgNi4zNCA0Ljk4IDYgNiBDMy45NjE2NjU3NiA0LjcyNjA0MTEgMS45NjE0Nzg3NCAzLjM4OTM4MDc3IDAgMiBDMCAxLjM0IDAgMC42OCAwIDAgWiAiIGZpbGw9IiNFOEYxRUUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzOTQsOTMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuOTggMCAzLjk2IDAgNiAwIEM2IDAuOTkgNiAxLjk4IDYgMyBDMy42OSAzIDEuMzggMyAtMSAzIEMtMC42NyAyLjAxIC0wLjM0IDEuMDIgMCAwIFogIiBmaWxsPSIjRjhGQkY5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDEyLDkwKSIvPgo8cGF0aCBkPSJNMCAwIEMwLjMzIDEuMzIgMC42NiAyLjY0IDEgNCBDMS42NiA0IDIuMzIgNCAzIDQgQzMuNjYgNS42NSA0LjMyIDcuMyA1IDkgQzMuMDYyNSA4LjYyNSAzLjA2MjUgOC42MjUgMSA4IEMtMC4zNTQzOTY2OCA1LjI5MTIwNjY1IC0wLjA2NTAxNDUxIDIuOTkwNjY3MzIgMCAwIFogIiBmaWxsPSIjRDRFNERFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzY4LDc4KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjk5IDAuMzMgMS45OCAwLjY2IDMgMSBDMi4zNCAzLjMxIDEuNjggNS42MiAxIDggQzAuMzQgOCAtMC4zMiA4IC0xIDggQy0xLjEyNSAyLjI1IC0xLjEyNSAyLjI1IDAgMCBaICIgZmlsbD0iI0VGRjVGMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3MCw3NCkiLz4KPHBhdGggZD0iTTAgMCBDMi4wMDcyMDkyMyAwLjI4Njc0NDE4IDQuMDA4NTk0NCAwLjYxODY2NzAxIDYgMSBDNiAxLjY2IDYgMi4zMiA2IDMgQzQuMzUgMyAyLjcgMyAxIDMgQzEgMy45OSAxIDQuOTggMSA2IEMwLjM0IDYgLTAuMzIgNiAtMSA2IEMtMS4wNDI3MjEgNC4zMzM4ODA5NSAtMS4wNDA2MzgzMiAyLjY2NjE3MTE1IC0xIDEgQy0wLjY3IDAuNjcgLTAuMzQgMC4zNCAwIDAgWiAiIGZpbGw9IiM3MkE5OTMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNjMsNjMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuOTM3NSAwLjY4NzUgMS45Mzc1IDAuNjg3NSA0IDIgQzQuNzUgNC42MjUgNC43NSA0LjYyNSA1IDcgQzQuMzQgNyAzLjY4IDcgMyA3IEMwIDIuNjE1Mzg0NjIgMCAyLjYxNTM4NDYyIDAgMCBaICIgZmlsbD0iIzBDNkI0NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1MSw5NykiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwIDIuNjQgMCA0IDAgQzQgMC45OSA0IDEuOTggNCAzIEMyLjAyIDMuNjYgMC4wNCA0LjMyIC0yIDUgQy0xLjM0IDMuMzUgLTAuNjggMS43IDAgMCBaICIgZmlsbD0iI0U2RjBFQyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyNSw4MCkiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwIDIuNjQgMCA0IDAgQzMuNjcgMS4zMiAzLjM0IDIuNjQgMyA0IEMyLjAxIDQgMS4wMiA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMwMDg0MjgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxNjksODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMCAxLjk4IDAgMyAwIEMyLjM0IDEuMzIgMS42OCAyLjY0IDEgNCBDMC42NyAyLjY4IDAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MTcsMTAyKSIvPgo8L3N2Zz4K" style="
            width: 742.5px;
            position: relative;
            top: 107px;
            left: 32px;
            ">
            <a href=`+Qa+` style="
        float: left;
        border-radius: 56px;
        background: #0D6EFD;
        padding-top: 8px;
        width: 280px;
        height: 38px;
        text-align: center;
        position: relative;
        top: 127px;
        left: 274px;
        font-size: 16px;
        color: white;
        text-decoration: none;
        letter-spacing: 0.02em;
    ">Claim your FREE account</a>
            <div style="
    font-size: 14px;
    position: relative;
    top: 180px;
    left: 19px;
    letter-spacing: 0.02em;
    font-weight: 500;
    line-height: 125%;
">have a Syncfusion<sup>®</sup> account? <a href="https://www.syncfusion.com/account/login?ReturnUrl=/account/login" style="text-decoration: none;
color: #0D6EFD;
font-weight: 500;">Sign In</a></div>
        </div>
    </div>`;if(typeof document<"u"&&!d(document)){var t=Ie("div",{innerHTML:l});document.body.appendChild(t)}},nf=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Fr=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},Xa=0,Uo,$n=0,Ro=0,es=!0,ts=!1,ct=function(l){nf(t,l);function t(e,i){var r=l.call(this,e,i)||this;return r.randomId=cd(),r.isStringTemplate=!1,r.needsID=!1,r.isReactHybrid=!1,r.isAngular=!1,r.isReact=!1,r.isVue=!1,d(r.enableRtl)&&r.setProperties({enableRtl:ef},!0),d(r.locale)&&r.setProperties({locale:ln},!0),r.moduleLoader=new Ud(r),r.localObserver=new Co(r),Jn.on("notifyExternalChange",r.detectFunction,r,r.randomId),typeof window<"u"&&typeof document<"u"&&!of()&&tf.indexOf(r.getModuleName())!==-1&&(Ro=Ro+1,Ro>5&&(es=!1)),ue(i)||r.appendTo(),r}return t.prototype.requiredModules=function(){return[]},t.prototype.destroy=function(){this.isDestroyed||(this.enablePersistence&&(this.setPersistData(),this.detachUnloadEvent()),this.localObserver.destroy(),!this.refreshing&&(G([this.element],["e-control"]),this.trigger("destroyed",{cancel:!1}),l.prototype.destroy.call(this),this.moduleLoader.clean(),Jn.off("notifyExternalChange",this.detectFunction,this.randomId)))},t.prototype.refresh=function(){this.refreshing=!0,this.moduleLoader.clean(),this.destroy(),this.clearChanges(),this.localObserver=new Co(this),this.preRender(),this.injectModules(),this.render(),this.refreshing=!1},t.prototype.accessMount=function(){this.mount&&!this.isReactHybrid&&this.mount()},t.prototype.getRootElement=function(){return this.isReactHybrid?this.actualElement:this.element},t.prototype.getLocalData=function(){var e=this.getModuleName()+this.element.id;return window.localStorage.getItem(e)},t.prototype.attachUnloadEvent=function(){this.handleUnload=this.handleUnload.bind(this),window.addEventListener("pagehide",this.handleUnload)},t.prototype.handleUnload=function(){this.setPersistData()},t.prototype.detachUnloadEvent=function(){window.removeEventListener("pagehide",this.handleUnload)},t.prototype.appendTo=function(e){if(!d(e)&&typeof e=="string"?this.element=te(e,document):d(e)||(this.element=e),!d(this.element)){var i="e-"+this.getModuleName().toLowerCase();W([this.element],["e-control",i]),this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),this.attachUnloadEvent());var r=Z("ej2_instances",this.element);(!r||r.indexOf(this)===-1)&&l.prototype.addInstance.call(this),this.preRender(),this.injectModules();var o={schedule:"all",diagram:"all",PdfViewer:"all",grid:["logger"],richtexteditor:["link","table","image","audio","video","formatPainter","emojiPicker","pasteCleanup","htmlEditor","toolbar","importExport"],treegrid:["filter"],gantt:["tooltip"],chart:["Export","Zoom"],accumulationchart:["Export"],"query-builder":"all"},a=this.getModuleName();if(this.requiredModules&&(!o[""+a]||o[""+a]!=="all"))for(var n=this.requiredModules(),s=0,h=this.moduleLoader.getNonInjectedModules(n);s<h.length;s++){var p=h[s],u=p.name?p.name:p.member;if(!(o[""+a]&&o[""+a].indexOf(p.member)!==-1)){var c=a.charAt(0).toUpperCase()+a.slice(1);console.warn('[WARNING] :: Module "'+u+'" is not available in '+c+" component! You either misspelled the module name or forgot to load it.")}}!es&&!ts&&(af(),ts=!0),this.render(),this.mount?this.accessMount():this.trigger("created")}},t.prototype.renderComplete=function(e){this.isRendered=!0},t.prototype.dataBind=function(){this.injectModules(),l.prototype.dataBind.call(this)},t.prototype.on=function(e,i,r){if(typeof e=="string")this.localObserver.on(e,i,r);else for(var o=0,a=e;o<a.length;o++){var n=a[o];this.localObserver.on(n.event,n.handler,n.context)}},t.prototype.off=function(e,i){if(typeof e=="string")this.localObserver.off(e,i);else for(var r=0,o=e;r<o.length;r++){var a=o[r];this.localObserver.off(a.event,a.handler)}},t.prototype.notify=function(e,i){this.isDestroyed!==!0&&this.localObserver.notify(e,i)},t.prototype.getInjectedModules=function(){return this.injectedModules},t.Inject=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(var r=0;r<e.length;r++)this.prototype.injectedModules.indexOf(e[parseInt(r.toString(),10)])===-1&&this.prototype.injectedModules.push(e[parseInt(r.toString(),10)])},t.prototype.createElement=function(e,i,r){return Ie(e,i)},t.prototype.triggerStateChange=function(e,i){this.isReactHybrid&&(this.setState(),this.currentContext={calls:e,args:i})},t.prototype.injectModules=function(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)},t.prototype.detectFunction=function(e){var i=Object.keys(e);i.length&&(this[i[0]]=e[i[0]])},t.prototype.mergePersistData=function(){var e;e=window.localStorage.getItem(this.getModuleName()+this.element.id),d(e)||e===""||this.setProperties(JSON.parse(e),!0)},t.prototype.setPersistData=function(){this.isDestroyed||window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData())},t.prototype.renderReactTemplates=function(e){d(e)||e()},t.prototype.clearTemplate=function(e,i){},t.prototype.getUniqueID=function(e){return this.isHistoryChanged()&&(Xa=0),Uo=this.pageID(location.href),$n=history.length,e+"_"+Uo+"_"+Xa++},t.prototype.pageID=function(e){var i=0;if(e.length===0)return i;for(var r=0;r<e.length;r++){var o=e.charCodeAt(r);i=(i<<5)-i+o,i=i&i}return Math.abs(i)},t.prototype.isHistoryChanged=function(){return Uo!==this.pageID(location.href)||$n!==history.length},t.prototype.addOnPersist=function(e){for(var i=this,r={},o=0,a=e;o<a.length;o++){var n=a[o],s=Z(n,this);ue(s)||Ae(n,this.getActualProperties(s),r)}return JSON.stringify(r,function(h,p){return i.getActualProperties(p)})},t.prototype.getActualProperties=function(e){return e instanceof Be?Z("properties",e):e},t.prototype.ignoreOnPersist=function(e){return JSON.stringify(this.iterateJsonProperties(this.properties,e))},t.prototype.iterateJsonProperties=function(e,i){for(var r={},o=function(p){if(i.indexOf(p)===-1){var u=e[""+p];if(typeof u=="object"&&!(u instanceof Array)){var c=i.filter(function(f){var g=RegExp;return new g(p+".").test(f)}).map(function(f){return f.replace(p+".","")});r[""+p]=a.iterateJsonProperties(a.getActualProperties(u),c)}else r[""+p]=u}},a=this,n=0,s=Object.keys(e);n<s.length;n++){var h=s[n];o(h)}return r},Fr([T(!1)],t.prototype,"enablePersistence",void 0),Fr([T()],t.prototype,"enableRtl",void 0),Fr([T()],t.prototype,"locale",void 0),t=Fr([Qe],t),t}(Ci);(function(){typeof window<"u"&&window.addEventListener("popstate",function(){Xa=0})})();var lh=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ne=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},sf={left:0,top:0,bottom:0,right:0},Bo={isDragged:!1},lf=function(l){lh(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return Ne([T(0)],t.prototype,"left",void 0),Ne([T(0)],t.prototype,"top",void 0),t}(Be),hf=function(l){lh(t,l);function t(i,r){var o=l.call(this,r,i)||this;return o.dragLimit=e.getDefaultPosition(),o.borderWidth=e.getDefaultPosition(),o.padding=e.getDefaultPosition(),o.diffX=0,o.prevLeft=0,o.prevTop=0,o.dragProcessStarted=!1,o.eleTop=0,o.tapHoldTimer=0,o.externalInitialize=!1,o.diffY=0,o.parentScrollX=0,o.parentScrollY=0,o.droppables={},o.bind(),o}e=t,t.prototype.bind=function(){this.toggleEvents(),S.isIE&&W([this.element],"e-block-touch"),this.droppables[this.scope]={}},t.getDefaultPosition=function(){return y({},sf)},t.prototype.toggleEvents=function(i){var r;ue(this.handle)||(r=te(this.handle,this.element));var o=this.enableTapHold&&S.isDevice&&S.isTouch?this.mobileInitialize:this.initialize;i?b.remove(r||this.element,S.isSafari()?"touchstart":S.touchStartEvent,o):b.add(r||this.element,S.isSafari()?"touchstart":S.touchStartEvent,o,this)},t.prototype.mobileInitialize=function(i){var r=this,o=i.currentTarget;this.tapHoldTimer=setTimeout(function(){r.externalInitialize=!0,r.removeTapholdTimer(),r.initialize(i,o)},this.tapHoldThreshold),b.add(document,S.isSafari()?"touchmove":S.touchMoveEvent,this.removeTapholdTimer,this),b.add(document,S.isSafari()?"touchend":S.touchEndEvent,this.removeTapholdTimer,this)},t.prototype.removeTapholdTimer=function(){clearTimeout(this.tapHoldTimer),b.remove(document,S.isSafari()?"touchmove":S.touchMoveEvent,this.removeTapholdTimer),b.remove(document,S.isSafari()?"touchend":S.touchEndEvent,this.removeTapholdTimer)},t.prototype.getScrollableParent=function(i,r){var o={vertical:"scrollHeight",horizontal:"scrollWidth"},a={vertical:"clientHeight",horizontal:"clientWidth"};return d(i)?null:i[o[""+r]]>i[a[""+r]]?(r==="vertical"?i.scrollTop>0:i.scrollLeft>0)?(r==="vertical"?(this.parentScrollY=this.parentScrollY+(this.parentScrollY===0?i.scrollTop:i.scrollTop-this.parentScrollY),this.tempScrollHeight=i.scrollHeight):(this.parentScrollX=this.parentScrollX+(this.parentScrollX===0?i.scrollLeft:i.scrollLeft-this.parentScrollX),this.tempScrollWidth=i.scrollWidth),d(i)?i:this.getScrollableParent(i.parentNode,r)):this.getScrollableParent(i.parentNode,r):this.getScrollableParent(i.parentNode,r)},t.prototype.getScrollableValues=function(){this.parentScrollX=0,this.parentScrollY=0,this.element.classList.contains("e-dialog")&&this.element.classList.contains("e-dlg-modal"),this.getScrollableParent(this.element.parentNode,"vertical"),this.getScrollableParent(this.element.parentNode,"horizontal")},t.prototype.initialize=function(i,r){if(this.currentStateTarget=i.target,!this.isDragStarted()){if(this.isDragStarted(!0),this.externalInitialize=!1,this.target=i.currentTarget||r,this.dragProcessStarted=!1,this.abort){var o=this.abort;typeof o=="string"&&(o=[o]);for(var a=0;a<o.length;a++)if(!d(ce(i.target,o[parseInt(a.toString(),10)]))){this.isDragStarted()&&this.isDragStarted(!0);return}}this.preventDefault&&!ue(i.changedTouches)&&i.type!=="touchstart"&&i.preventDefault(),this.element.setAttribute("aria-grabbed","true");var n=this.getCoordinates(i);if(this.initialPosition={x:n.pageX,y:n.pageY},!this.clone){var s=this.element.getBoundingClientRect();this.getScrollableValues(),i.clientX===i.pageX&&(this.parentScrollX=0),i.clientY===i.pageY&&(this.parentScrollY=0),this.relativeXPosition=n.pageX-(s.left+this.parentScrollX),this.relativeYPosition=n.pageY-(s.top+this.parentScrollY)}this.externalInitialize?this.intDragStart(i):(b.add(document,S.isSafari()?"touchmove":S.touchMoveEvent,this.intDragStart,this),b.add(document,S.isSafari()?"touchend":S.touchEndEvent,this.intDestroy,this)),this.toggleEvents(!0),i.type!=="touchstart"&&this.isPreventSelect&&document.body.classList.add("e-prevent-select"),this.externalInitialize=!1,b.trigger(document.documentElement,S.isSafari()?"touchstart":S.touchStartEvent,i)}},t.prototype.intDragStart=function(i){this.removeTapholdTimer();var r=!ue(i.changedTouches);if(!(r&&i.changedTouches.length!==1)){var o=this.getCoordinates(i),a,n=getComputedStyle(this.element);this.margin={left:parseInt(n.marginLeft,10),top:parseInt(n.marginTop,10),right:parseInt(n.marginRight,10),bottom:parseInt(n.marginBottom,10)};var s=this.element;if(this.clone&&this.dragTarget){var h=ce(i.target,this.dragTarget);d(h)||(s=h)}this.isReplaceDragEle&&(s=this.currentStateCheck(i.target,s)),this.offset=this.calculateParentPosition(s),this.position=this.getMousePosition(i,this.isDragScroll);var p=this.initialPosition.x-o.pageX,u=this.initialPosition.y-o.pageY,c=Math.sqrt(p*p+u*u);if(c>=this.distance||this.externalInitialize){var f=this.getHelperElement(i);if(!f||d(f))return;r&&i.preventDefault();var g=this.helperElement=f;if(this.parentClientRect=this.calculateParentPosition(g.offsetParent),this.dragStart){var v=this.getProperTargetElement(i),m={event:i,element:s,target:v,bindEvents:null,dragElement:g};this.trigger("dragStart",m)}this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0}),a={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top},this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top),this.getScrollableValues();var C=getComputedStyle(s),M=parseFloat(C.marginTop);this.clone&&M!==0&&(a.top+=M),this.eleTop=isNaN(parseFloat(C.top))?0:parseFloat(C.top)-this.offset.top,this.enableScrollHandler&&!this.clone&&(a.top-=this.parentScrollY,a.left-=this.parentScrollX);var I=this.getProcessedPositionValue({top:a.top-this.diffY+"px",left:a.left-this.diffX+"px"});this.dragArea&&typeof this.dragArea!="string"&&this.dragArea.classList.contains("e-kanban-content")&&this.dragArea.style.position==="relative"&&(a.top+=this.dragArea.scrollTop),this.dragElePosition={top:a.top,left:a.left},de(g,this.getDragPosition({position:"absolute",left:I.left,top:I.top})),b.remove(document,S.isSafari()?"touchmove":S.touchMoveEvent,this.intDragStart),b.remove(document,S.isSafari()?"touchend":S.touchEndEvent,this.intDestroy),this.bindDragEvents(g)}}},t.prototype.bindDragEvents=function(i){st(i)?(b.add(document,S.isSafari()?"touchmove":S.touchMoveEvent,this.intDrag,this),b.add(document,S.isSafari()?"touchend":S.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,i)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))},t.prototype.elementInViewport=function(i){for(this.top=i.offsetTop,this.left=i.offsetLeft,this.width=i.offsetWidth,this.height=i.offsetHeight;i.offsetParent;)i=i.offsetParent,this.top+=i.offsetTop,this.left+=i.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth},t.prototype.getProcessedPositionValue=function(i){return this.queryPositionInfo?this.queryPositionInfo(i):i},t.prototype.calculateParentPosition=function(i){if(d(i))return{left:0,top:0};var r=i.getBoundingClientRect(),o=getComputedStyle(i);return{left:r.left+window.pageXOffset-parseInt(o.marginLeft,10),top:r.top+window.pageYOffset-parseInt(o.marginTop,10)}},t.prototype.intDrag=function(i){if(!(!ue(i.changedTouches)&&i.changedTouches.length!==1)){this.clone&&i.changedTouches&&S.isDevice&&S.isTouch&&i.preventDefault();var r,o;this.position=this.getMousePosition(i,this.isDragScroll);var a=this.getDocumentWidthHeight("Height");a<this.position.top&&(this.position.top=a);var n=this.getDocumentWidthHeight("Width");if(n<this.position.left&&(this.position.left=n),this.drag){var s=this.getProperTargetElement(i);this.trigger("drag",{event:i,element:this.element,target:s})}var h=this.checkTargetElement(i);if(h.target&&h.instance){var p=!0;this.hoverObject&&(this.hoverObject.instance!==h.instance?this.triggerOutFunction(i,h):p=!1),p&&(h.instance.dragData[this.scope]=this.droppables[this.scope],h.instance.intOver(i,h.target),this.hoverObject=h)}else this.hoverObject&&this.triggerOutFunction(i,h);var u=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);var c=this.parentClientRect.left,f=this.parentClientRect.top,g=this.getCoordinates(i),v=g.pageX,m=g.pageY,C=this.position.left-this.diffX,M=this.position.top-this.diffY,I=getComputedStyle(u);if(this.dragArea){if(this.enableAutoScroll&&this.setDragArea(),this.pageX!==v||this.skipDistanceCheck){var N=u.offsetWidth+(parseFloat(I.marginLeft)+parseFloat(I.marginRight));this.dragLimit.left>C&&C>0?r=this.dragLimit.left:this.dragLimit.right+window.pageXOffset<C+N&&C>0?r=C-(C-this.dragLimit.right)+window.pageXOffset-N:r=C<0?this.dragLimit.left:C}if(this.pageY!==m||this.skipDistanceCheck){var O=u.offsetHeight+(parseFloat(I.marginTop)+parseFloat(I.marginBottom));this.dragLimit.top>M&&M>0?o=this.dragLimit.top:this.dragLimit.bottom+window.pageYOffset<M+O&&M>0?o=M-(M-this.dragLimit.bottom)+window.pageYOffset-O:o=M<0?this.dragLimit.top:M}}else r=C,o=M;var x=f+this.borderWidth.top,D=c+this.borderWidth.left;this.dragProcessStarted&&(d(o)&&(o=this.prevTop),d(r)&&(r=this.prevLeft));var A,P;if(this.helperElement.classList.contains("e-treeview"))this.dragArea?(this.dragLimit.top=this.clone?this.dragLimit.top:0,A=o-x<0?this.dragLimit.top:o-this.borderWidth.top,P=r-D<0?this.dragLimit.left:r-this.borderWidth.left):(A=o-this.borderWidth.top,P=r-this.borderWidth.left);else if(this.dragArea){var V=this.helperElement.classList.contains("e-dialog");this.dragLimit.top=this.clone?this.dragLimit.top:0,A=o-x<0?this.dragLimit.top:o-x,P=r-D<0?V?r-(D-this.borderWidth.left):this.dragElePosition.left:r-D}else A=o-x,P=r-D;var q=parseFloat(getComputedStyle(this.element).marginTop);if(q>0&&(this.clone&&(A+=q,M<0&&(q+M>=0?A=q+M:A-=q),this.dragArea&&(A=this.dragLimit.bottom<A?this.dragLimit.bottom:A)),o-x<0))if(M+q+(u.offsetHeight-x)>=0){var re=this.dragLimit.top+M-x;re+q+x<0?A-=q+x:A=re}else A-=q+x;if(this.dragArea&&this.helperElement.classList.contains("e-treeview")){var O=u.offsetHeight+(parseFloat(I.marginTop)+parseFloat(I.marginBottom));A=A+O>this.dragLimit.bottom?this.dragLimit.bottom-O:A}this.enableScrollHandler&&!this.clone&&(A-=this.parentScrollY,P-=this.parentScrollX),this.dragArea&&typeof this.dragArea!="string"&&this.dragArea.classList.contains("e-kanban-content")&&this.dragArea.style.position==="relative"&&(A+=this.dragArea.scrollTop);var ae=this.getProcessedPositionValue({top:A+"px",left:P+"px"});this.isPreventScroll&&(ae=this.getProcessedPositionValue({top:this.position.top-this.parentClientRect.top-2+"px",left:this.position.left-this.parentClientRect.left-2+"px"})),de(u,this.getDragPosition(ae)),!this.elementInViewport(u)&&this.enableAutoScroll&&!this.helperElement.classList.contains("e-treeview")&&this.helperElement.scrollIntoView();var E=document.querySelectorAll(":hover");if(this.enableAutoScroll&&this.helperElement.classList.contains("e-treeview")){E.length===0&&(E=this.getPathElements(i));var L=this.getScrollParent(E,!1);this.elementInViewport(this.helperElement)?this.getScrollPosition(L,A):this.elementInViewport(this.helperElement)||(E=[].slice.call(document.querySelectorAll(":hover")),E.length===0&&(E=this.getPathElements(i)),L=this.getScrollParent(E,!0),this.getScrollPosition(L,A))}this.dragProcessStarted=!0,this.prevLeft=r,this.prevTop=o,this.position.left=r,this.position.top=o,this.pageX=v,this.pageY=m}},t.prototype.getScrollParent=function(i,r){for(var o=r?i.reverse():i,a,n=o.length-1;n>=0;n--)if(a=window.getComputedStyle(o[parseInt(n.toString(),10)])["overflow-y"],(a==="auto"||a==="scroll")&&o[parseInt(n.toString(),10)].scrollHeight>o[parseInt(n.toString(),10)].clientHeight)return o[parseInt(n.toString(),10)];if(a=window.getComputedStyle(document.scrollingElement)["overflow-y"],a==="visible")return document.scrollingElement.style.overflow="auto",document.scrollingElement},t.prototype.getScrollPosition=function(i,r){if(i&&i===document.scrollingElement)i.clientHeight+document.scrollingElement.scrollTop-this.helperElement.clientHeight<r&&i.getBoundingClientRect().height+this.parentClientRect.top>r?i.scrollTop+=this.helperElement.clientHeight:i.scrollTop>r-this.helperElement.clientHeight&&(i.scrollTop-=this.helperElement.clientHeight);else if(i&&i!==document.scrollingElement){var o=document.scrollingElement.scrollTop,a=this.helperElement.clientHeight;i.clientHeight+i.getBoundingClientRect().top-a+o<r?i.scrollTop+=this.helperElement.clientHeight:i.getBoundingClientRect().top>r-a-o&&(i.scrollTop-=this.helperElement.clientHeight)}},t.prototype.getPathElements=function(i){var r=i.clientX>0?i.clientX:0,o=i.clientY>0?i.clientY:0;return document.elementsFromPoint(r,o)},t.prototype.triggerOutFunction=function(i,r){this.hoverObject.instance.intOut(i,r.target),this.hoverObject.instance.dragData[this.scope]=null,this.hoverObject=null},t.prototype.getDragPosition=function(i){var r=y({},i);return this.axis&&(this.axis==="x"?delete r.top:this.axis==="y"&&delete r.left),r},t.prototype.getDocumentWidthHeight=function(i){var r=document.body,o=document.documentElement,a=Math.max(r["scroll"+i],o["scroll"+i],r["offset"+i],o["offset"+i],o["client"+i]);return a},t.prototype.intDragStop=function(i){if(this.dragProcessStarted=!1,!(!ue(i.changedTouches)&&i.changedTouches.length!==1)){var r=["touchend","pointerup","mouseup"];if(r.indexOf(i.type)!==-1){if(this.dragStop){var o=this.getProperTargetElement(i);this.trigger("dragStop",{event:i,element:this.element,target:o,helper:this.helperElement})}this.intDestroy(i)}else this.element.setAttribute("aria-grabbed","false");var a=this.checkTargetElement(i);a.target&&a.instance&&(a.instance.dragStopCalled=!0,a.instance.dragData[this.scope]=this.droppables[this.scope],a.instance.intDrop(i,a.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select")}},t.prototype.intDestroy=function(i){this.dragProcessStarted=!1,this.toggleEvents(),document.body.classList.remove("e-prevent-select"),this.element.setAttribute("aria-grabbed","false"),b.remove(document,S.isSafari()?"touchmove":S.touchMoveEvent,this.intDragStart),b.remove(document,S.isSafari()?"touchend":S.touchEndEvent,this.intDragStop),b.remove(document,S.isSafari()?"touchend":S.touchEndEvent,this.intDestroy),b.remove(document,S.isSafari()?"touchmove":S.touchMoveEvent,this.intDrag),this.isDragStarted()&&this.isDragStarted(!0)},t.prototype.onPropertyChanged=function(i,r){},t.prototype.getModuleName=function(){return"draggable"},t.prototype.isDragStarted=function(i){return i&&(Bo.isDragged=!Bo.isDragged),Bo.isDragged},t.prototype.setDragArea=function(){var i,r,o=0,a=0,n,s=typeof this.dragArea;if(s==="string"?n=te(this.dragArea):n=this.dragArea,n){var h=n.getBoundingClientRect();i=n.scrollWidth?n.scrollWidth:h.right-h.left,r=n.scrollHeight?this.dragArea&&!d(this.helperElement)&&this.helperElement.classList.contains("e-treeview")?n.clientHeight:n.scrollHeight:h.bottom-h.top;for(var p=["Top","Left","Bottom","Right"],u=getComputedStyle(n),c=0;c<p.length;c++){var f=p[parseInt(c.toString(),10)],g=u["border"+f+"Width"],v=u["padding"+f],m=f.toLowerCase();this.borderWidth[""+m]=isNaN(parseFloat(g))?0:parseFloat(g),this.padding[""+m]=isNaN(parseFloat(v))?0:parseFloat(v)}this.dragArea&&!d(this.helperElement)&&this.helperElement.classList.contains("e-treeview")?o=h.top+document.scrollingElement.scrollTop:o=h.top,a=h.left,this.dragLimit.left=a+this.borderWidth.left+this.padding.left,this.dragLimit.top=n.offsetTop+this.borderWidth.top+this.padding.top,this.dragLimit.right=a+i-(this.borderWidth.right+this.padding.right),this.dragLimit.bottom=o+r-(this.borderWidth.bottom+this.padding.bottom)}},t.prototype.getProperTargetElement=function(i){var r=this.getCoordinates(i),o,a=this.helperElement.style.pointerEvents||"",n=i.type.indexOf("pointer")!==-1&&S.info.name==="safari"&&parseInt(S.info.version,10)>12;return nn(i.target,this.helperElement)||i.type.indexOf("touch")!==-1||n?(this.helperElement.style.pointerEvents="none",o=document.elementFromPoint(r.clientX,r.clientY),this.helperElement.style.pointerEvents=a):o=i.target,o},t.prototype.currentStateCheck=function(i,r){var o;return!d(this.currentStateTarget)&&this.currentStateTarget!==i?o=this.currentStateTarget:o=d(r)?i:r,o},t.prototype.getMousePosition=function(i,r){var o=i.srcElement!==void 0?i.srcElement:i.target,a=this.getCoordinates(i),n,s,h=d(o.offsetParent);if(r?(n=this.clone?a.pageX:a.pageX+(h?0:o.offsetParent.scrollLeft)-this.relativeXPosition,s=this.clone?a.pageY:a.pageY+(h?0:o.offsetParent.scrollTop)-this.relativeYPosition):(n=this.clone?a.pageX:a.pageX+window.pageXOffset-this.relativeXPosition,s=this.clone?a.pageY:a.pageY+window.pageYOffset-this.relativeYPosition),document.scrollingElement&&!r&&!this.clone){var p=document.scrollingElement,u=p.scrollHeight>0&&p.scrollHeight>p.clientHeight&&p.scrollTop>0,c=p.scrollWidth>0&&p.scrollWidth>p.clientWidth&&p.scrollLeft>0;n=c?n-p.scrollLeft:n,s=u?s-p.scrollTop:s}return{left:n-(this.margin.left+this.cursorAt.left),top:s-(this.margin.top+this.cursorAt.top)}},t.prototype.getCoordinates=function(i){return i.type.indexOf("touch")>-1?i.changedTouches[0]:i},t.prototype.getHelperElement=function(i){var r;return this.clone?this.helper?r=this.helper({sender:i,element:this.target,currentTargetElement:this.currentStateTarget}):(r=Ie("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(r)):r=this.element,r},t.prototype.setGlobalDroppables=function(i,r,o){this.droppables[this.scope]=i?null:{draggable:r,helper:o,draggedElement:this.element}},t.prototype.checkTargetElement=function(i){var r=this.getProperTargetElement(i),o=this.getDropInstance(r);if(!o&&r&&!d(r.parentNode)){var a=ce(r.parentNode,".e-droppable")||r.parentElement;a&&(o=this.getDropInstance(a))}return{target:r,instance:o}},t.prototype.getDropInstance=function(i){var r="getModuleName",o,a=i&&i.ej2_instances;if(a)for(var n=0,s=a;n<s.length;n++){var h=s[n];if(h[""+r]()==="droppable"){o=h;break}}return o},t.prototype.destroy=function(){this.toggleEvents(!0),l.prototype.destroy.call(this)};var e;return Ne([Ke({},lf)],t.prototype,"cursorAt",void 0),Ne([T(!0)],t.prototype,"clone",void 0),Ne([T()],t.prototype,"dragArea",void 0),Ne([T()],t.prototype,"isDragScroll",void 0),Ne([T()],t.prototype,"isReplaceDragEle",void 0),Ne([T(!0)],t.prototype,"isPreventSelect",void 0),Ne([T(!1)],t.prototype,"isPreventScroll",void 0),Ne([Y()],t.prototype,"drag",void 0),Ne([Y()],t.prototype,"dragStart",void 0),Ne([Y()],t.prototype,"dragStop",void 0),Ne([T(1)],t.prototype,"distance",void 0),Ne([T()],t.prototype,"handle",void 0),Ne([T()],t.prototype,"abort",void 0),Ne([T()],t.prototype,"helper",void 0),Ne([T("default")],t.prototype,"scope",void 0),Ne([T("")],t.prototype,"dragTarget",void 0),Ne([T()],t.prototype,"axis",void 0),Ne([T()],t.prototype,"queryPositionInfo",void 0),Ne([T(!1)],t.prototype,"enableTailMode",void 0),Ne([T(!1)],t.prototype,"skipDistanceCheck",void 0),Ne([T(!0)],t.prototype,"preventDefault",void 0),Ne([T(!1)],t.prototype,"enableAutoScroll",void 0),Ne([T(!1)],t.prototype,"enableTapHold",void 0),Ne([T(750)],t.prototype,"tapHoldThreshold",void 0),Ne([T(!1)],t.prototype,"enableScrollHandler",void 0),t=e=Ne([Qe],t),t}(Ci),pf=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ii=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},em=function(l){pf(t,l);function t(e,i){var r=l.call(this,i,e)||this;return r.mouseOver=!1,r.dragData={},r.dragStopCalled=!1,r.bind(),r}return t.prototype.bind=function(){this.wireEvents()},t.prototype.wireEvents=function(){b.add(this.element,S.isSafari()?"touchend":S.touchEndEvent,this.intDrop,this)},t.prototype.onPropertyChanged=function(e,i){},t.prototype.getModuleName=function(){return"droppable"},t.prototype.intOver=function(e,i){if(!this.mouseOver){var r=this.dragData[this.scope];this.trigger("over",{event:e,target:i,dragData:r}),this.mouseOver=!0}},t.prototype.intOut=function(e,i){this.mouseOver&&(this.trigger("out",{evt:e,target:i}),this.mouseOver=!1)},t.prototype.intDrop=function(e,i){if(this.dragStopCalled)this.dragStopCalled=!1;else return;var r=!0,o=this.dragData[this.scope],a=o?o.helper&&st(o.helper):!1,n;a&&(n=this.isDropArea(e,o.helper,i),this.accept&&(r=$l(o.helper,this.accept))),a&&this.drop&&n.canDrop&&r&&this.trigger("drop",{event:e,target:n.target,droppedElement:o.helper,dragData:o}),this.mouseOver=!1},t.prototype.isDropArea=function(e,i,r){var o={canDrop:!0,target:r||e.target},a=e.type==="touchend";if(a||o.target===i){i.style.display="none";var n=a?e.changedTouches[0]:e,s=document.elementFromPoint(n.clientX,n.clientY);o.canDrop=!1,o.canDrop=nn(s,this.element),o.canDrop&&(o.target=s),i.style.display=""}return o},t.prototype.destroy=function(){b.remove(this.element,S.isSafari()?"touchend":S.touchEndEvent,this.intDrop),l.prototype.destroy.call(this)},Ii([T()],t.prototype,"accept",void 0),Ii([T("default")],t.prototype,"scope",void 0),Ii([Y()],t.prototype,"drop",void 0),Ii([Y()],t.prototype,"over",void 0),Ii([Y()],t.prototype,"out",void 0),t=Ii([Qe],t),t}(Ci),uf=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ur=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},cf={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},bo=function(l){uf(t,l);function t(i,r){var o=l.call(this,r,i)||this;return o.keyPressHandler=function(a){for(var n=a.altKey,s=a.ctrlKey,h=a.shiftKey,p=a.which,u=Object.keys(o.keyConfigs),c=0,f=u;c<f.length;c++)for(var g=f[c],v=o.keyConfigs[""+g].split(","),m=0,C=v;m<C.length;m++){var M=C[m],I=e.getKeyConfigData(M.trim());n===I.altKey&&s===I.ctrlKey&&h===I.shiftKey&&p===I.keyCode&&(a.action=g,o.keyAction&&o.keyAction(a))}},o.bind(),o}e=t,t.prototype.destroy=function(){this.unwireEvents(),l.prototype.destroy.call(this)},t.prototype.onPropertyChanged=function(i,r){},t.prototype.bind=function(){this.wireEvents()},t.prototype.getModuleName=function(){return"keyboard"},t.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},t.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},t.getKeyConfigData=function(i){if(i in this.configCache)return this.configCache[""+i];var r=i.toLowerCase().split("+"),o={altKey:r.indexOf("alt")!==-1,ctrlKey:r.indexOf("ctrl")!==-1,shiftKey:r.indexOf("shift")!==-1,keyCode:null};return r[r.length-1].length>1&&Number(r[r.length-1])?o.keyCode=Number(r[r.length-1]):o.keyCode=e.getKeyCode(r[r.length-1]),e.configCache[""+i]=o,o},t.getKeyCode=function(i){return cf[""+i]||i.toUpperCase().charCodeAt(0)};var e;return t.configCache={},Ur([T({})],t.prototype,"keyConfigs",void 0),Ur([T("keyup")],t.prototype,"eventName",void 0),Ur([Y()],t.prototype,"keyAction",void 0),t=e=Ur([Qe],t),t}(Ci),Mi=function(){function l(t,e,i){this.controlName=t,this.localeStrings=e,this.setLocale(i||ln)}return l.prototype.setLocale=function(t){var e=this.intGetControlConstant(l.locale,t);this.currentLocale=e||this.localeStrings},l.load=function(t){this.locale=y(this.locale,t,{},!0)},l.prototype.getConstant=function(t){return d(this.currentLocale[""+t])?this.localeStrings[""+t]||"":this.currentLocale[""+t]},l.prototype.intGetControlConstant=function(t,e){return t[""+e]?t[""+e][this.controlName]:null},l.locale={},l}(),hh=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Vt=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},df=function(l){hh(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return Vt([T(50)],t.prototype,"swipeThresholdDistance",void 0),t}(Be),ff=/(Up|Down)/,Tr=function(l){hh(t,l);function t(e,i){var r=l.call(this,i,e)||this;return r.touchAction=!0,r.tapCount=0,r.startEvent=function(o){if(r.touchAction===!0){var a=r.updateChangeTouches(o);o.changedTouches!==void 0&&(r.touchAction=!1),r.isTouchMoved=!1,r.movedDirection="",r.startPoint=r.lastMovedPoint={clientX:a.clientX,clientY:a.clientY},r.startEventData=a,r.hScrollLocked=r.vScrollLocked=!1,r.tStampStart=Date.now(),r.timeOutTapHold=setTimeout(function(){r.tapHoldEvent(o)},r.tapHoldThreshold),b.add(r.element,S.touchMoveEvent,r.moveEvent,r),b.add(r.element,S.touchEndEvent,r.endEvent,r),b.add(r.element,S.touchCancelEvent,r.cancelEvent,r)}},r.moveEvent=function(o){var a=r.updateChangeTouches(o);r.movedPoint=a,r.isTouchMoved=!(a.clientX===r.startPoint.clientX&&a.clientY===r.startPoint.clientY);var n={};if(r.isTouchMoved){clearTimeout(r.timeOutTapHold),r.calcScrollPoints(o);var s={startEvents:r.startEventData,originalEvent:o,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,scrollDirection:r.scrollDirection,velocity:r.getVelocity(a)};n=y(n,{},s),r.trigger("scroll",n),r.lastMovedPoint={clientX:a.clientX,clientY:a.clientY}}},r.cancelEvent=function(o){clearTimeout(r.timeOutTapHold),clearTimeout(r.timeOutTap),r.tapCount=0,r.swipeFn(o),b.remove(r.element,S.touchCancelEvent,r.cancelEvent)},r.endEvent=function(o){r.swipeFn(o),r.isTouchMoved||typeof r.tap=="function"&&(r.trigger("tap",{originalEvent:o,tapCount:++r.tapCount}),r.timeOutTap=setTimeout(function(){r.tapCount=0},r.tapThreshold)),r.modeclear()},r.swipeFn=function(o){clearTimeout(r.timeOutTapHold),clearTimeout(r.timeOutTap);var a=r.updateChangeTouches(o),n=a.clientX-r.startPoint.clientX,s=a.clientY-r.startPoint.clientY;n=Math.floor(n<0?-1*n:n),s=Math.floor(s<0?-1*s:n),r.isTouchMoved=n>1||s>1;var h=/Firefox/.test(S.userAgent);h&&a.clientX===0&&a.clientY===0&&o.type==="mouseup"&&(r.isTouchMoved=!1),r.endPoint=a,r.calcPoints(o);var p={originalEvent:o,startEvents:r.startEventData,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,swipeDirection:r.movedDirection,velocity:r.getVelocity(a)};if(r.isTouchMoved){var u=r.swipeSettings.swipeThresholdDistance,c=y(void 0,r.defaultArgs,p),f=!1,g=r.element,v=r.isScrollable(g),m=ff.test(r.movedDirection);(u<r.distanceX&&!m||u<r.distanceY&&m)&&(v?f=r.checkSwipe(g,m):f=!0),f&&r.trigger("swipe",c)}r.modeclear()},r.modeclear=function(){r.modeClear=setTimeout(function(){r.touchAction=!0},typeof r.tap!="function"?0:20),r.lastTapTime=new Date().getTime(),b.remove(r.element,S.touchMoveEvent,r.moveEvent),b.remove(r.element,S.touchEndEvent,r.endEvent),b.remove(r.element,S.touchCancelEvent,r.cancelEvent)},r.bind(),r}return t.prototype.onPropertyChanged=function(e,i){},t.prototype.bind=function(){this.wireEvents(),S.isIE&&this.element.classList.add("e-block-touch")},t.prototype.destroy=function(){this.unwireEvents(),l.prototype.destroy.call(this)},t.prototype.wireEvents=function(){b.add(this.element,S.touchStartEvent,this.startEvent,this)},t.prototype.unwireEvents=function(){b.remove(this.element,S.touchStartEvent,this.startEvent)},t.prototype.getModuleName=function(){return"touch"},t.prototype.isScrollable=function(e){var i=getComputedStyle(e),r=i.overflow+i.overflowX+i.overflowY;return!!/(auto|scroll)/.test(r)},t.prototype.tapHoldEvent=function(e){this.tapCount=0,this.touchAction=!0,b.remove(this.element,S.touchMoveEvent,this.moveEvent),b.remove(this.element,S.touchEndEvent,this.endEvent);var i={originalEvent:e};this.trigger("tapHold",i),b.remove(this.element,S.touchCancelEvent,this.cancelEvent)},t.prototype.calcPoints=function(e){var i=this.updateChangeTouches(e);this.defaultArgs={originalEvent:e},this.distanceX=Math.abs(Math.abs(i.clientX)-Math.abs(this.startPoint.clientX)),this.distanceY=Math.abs(Math.abs(i.clientY)-Math.abs(this.startPoint.clientY)),this.distanceX>this.distanceY?this.movedDirection=i.clientX>this.startPoint.clientX?"Right":"Left":this.movedDirection=i.clientY<this.startPoint.clientY?"Up":"Down"},t.prototype.calcScrollPoints=function(e){var i=this.updateChangeTouches(e);this.defaultArgs={originalEvent:e},this.distanceX=Math.abs(Math.abs(i.clientX)-Math.abs(this.lastMovedPoint.clientX)),this.distanceY=Math.abs(Math.abs(i.clientY)-Math.abs(this.lastMovedPoint.clientY)),(this.distanceX>this.distanceY||this.hScrollLocked===!0)&&this.vScrollLocked===!1?(this.scrollDirection=i.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=i.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)},t.prototype.getVelocity=function(e){var i=e.clientX,r=e.clientY,o=Date.now(),a=i-this.startPoint.clientX,n=r-this.startPoint.clientX,s=o-this.tStampStart;return Math.sqrt(a*a+n*n)/s},t.prototype.checkSwipe=function(e,i){var r=["scroll","offset"],o=i?["Height","Top"]:["Width","Left"];return e[r[0]+o[0]]<=e[r[1]+o[0]]?!0:e[r[0]+o[1]]===0||e[r[1]+o[0]]+e[r[0]+o[1]]>=e[r[0]+o[0]]},t.prototype.updateChangeTouches=function(e){var i=e.changedTouches&&e.changedTouches.length!==0?e.changedTouches[0]:e;return i},Vt([Y()],t.prototype,"tap",void 0),Vt([Y()],t.prototype,"tapHold",void 0),Vt([Y()],t.prototype,"swipe",void 0),Vt([Y()],t.prototype,"scroll",void 0),Vt([T(350)],t.prototype,"tapThreshold",void 0),Vt([T(750)],t.prototype,"tapHoldThreshold",void 0),Vt([Ke({},df)],t.prototype,"swipeSettings",void 0),t=Vt([Qe],t),t}(Ci),gf=new RegExp("\\n|\\r|\\s\\s+","g"),vf=new RegExp(/'|"/g),yf=new RegExp("if ?\\("),mf=new RegExp("else if ?\\("),is=new RegExp("else"),Cf=new RegExp("for ?\\("),rs=new RegExp("(/if|/for)"),Mf=new RegExp("\\((.*)\\)",""),hn=new RegExp("^[0-9]+$","g"),bf=new RegExp(`[\\w"'.\\s+]+`,"g"),jf=new RegExp('"(.*?)"',"g"),If=new RegExp(`[\\w"'@#$.\\s-+]+`,"g"),os=new RegExp("\\${([^}]*)}","g"),Tf=/^\..*/gm,Wa=/\\/gi,Sf=/\\\\/gi,Nf=new RegExp(`[\\w"'@#$.\\s+]+`,"g"),Df=/\window\./gm;function wf(l,t,e){if(typeof l=="function")return l;var i="data",r=Of(l,i,t,e),o=`var valueRegEx = (/value=\\'([A-Za-z0-9 _]*)((.)([\\w)(!-;?-■\\s]+)['])/g);
        var hrefRegex = (/(?:href)([\\s='"./]+)([\\w-./?=&\\\\#"]+)((.)([\\w)(!-;/?-■\\s]+)['])/g);
        if(str.match(valueRegEx)){
            var check = str.match(valueRegEx);
            var str1 = str;
            for (var i=0; i < check.length; i++) {
                var check1 = str.match(valueRegEx)[i].split('value=')[1];
                var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '"') : check1;
                change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'"') : change;
                str1 = str1.replace(check1, change);
            }
            str = str.replace(str, str1);
        }
        else if (str.match(/(?:href='')/) === null) {
            if(str.match(hrefRegex)) {
                var check = str.match(hrefRegex);
                var str1 = str;
                for (var i=0; i < check.length; i++) {
                    var check1 = str.match(hrefRegex)[i].split('href=')[1];
                    if (check1) {
                        var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '"') : check1;
                        change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'"') : change;
                        str1 = str1.replace(check1, change);
                    }
                }
                str = str.replace(str, str1);
            }
        }
        `,a='var str="'+r+'";'+o+" return str;",n=new Function(i,a);return n.bind(t)}function Of(l,t,e,i){var r=0,o=[],a=l.match(/class="([^"]+|)\s{2}/g),n="";if(a&&a.forEach(function(u){n=u.replace(/\s\s+/g," "),l=l.replace(u,n)}),os.test(l)){for(var s=!1,h="",p=0;p<l.length;p++)l[p+""]==="$"&&l[p+1]==="{"?s=!0:l[p+""]==="}"&&(s=!1),h+=l[p+""]==='"'&&!s?'\\"':l[p+""];l=h}else l=l.replace(/\\?"/g,'\\"');return l.replace(gf,"").replace(jf,"'$1'").replace(os,function(u,c,f,g){var v=/@|#|\$/gm,m=c.match(Mf);if(m){var C=m[1];if(mf.test(c))c='";} '+c.replace(m[1],C.replace(bf,function(P){return P=P.trim(),Ei(P,!vf.test(P)&&o.indexOf(P)===-1,t,o,i)}))+`{ 
 str = str + "`;else if(yf.test(c))c='"; '+c.replace(m[1],C.replace(If,function(P){return ns(P,t,o,i)}))+`{ 
 str = str + "`;else if(Cf.test(c)){var M=m[1].split(" of ");c='"; '+c.replace(m[1],function(P){return o.push(M[0]),o.push(M[0]+"Index"),r=r+1,"var i"+r+"=0; i"+r+" < "+Ei(M[1],!0,t,o,i)+".length; i"+r+"++"})+`{ 
 `+M[0]+"= "+Ei(M[1],!0,t,o,i)+"[i"+r+`]; 
 var `+M[0]+"Index=i"+r+`; 
 str = str + "`}else{var I=c.split("("),N=e&&Object.prototype.hasOwnProperty.call(e,I[0])?"this.":"global";N=/\./.test(I[0])?"":N;var O=m[1].split(",");m[1].length!==0&&!/data/.test(O[0])&&!/window./.test(O[0])&&(m[1]=N==="global"?t+"."+m[1]:m[1]);var x=/@|\$|#/gm,D=/\]\./gm;if(Df.test(c)&&D.test(c)||x.test(c)){var A=/@|\$|#|\]\./gm;A.test(c)&&(c='"+ '+(N==="global"?"":N)+c.replace(m[1],C.replace(Nf,function(P){return ns(P,t,o,i)}))+'+ "')}else c='" + '+(N==="global"?"":N)+c.replace(C,Ei(m[1].replace(/,( |)data.|,/gi,","+t+".").replace(/,( |)data.window/gi,",window"),N!=="global",t,o,i))+'+"'}}else is.test(c)?c='"; '+c.replace(is,`} else { 
 str = str + "`):c.match(rs)?c=c.replace(rs,`"; 
 } 
 str = str + "`):v.test(c)?(c.match(Wa)&&(c=as(c)),c='"+'+Va(c,o.indexOf(c)===-1,t,o)+'"]+"'):c.match(Wa)?(c=as(c),c='"+'+Va(c,o.indexOf(c)===-1,t,o)+'"]+"'):c=c!==""?'"+'+Ei(c.replace(/,/gi,"+"+t+"."),o.indexOf(c)===-1,t,o,i)+'+"':"${}";return c})}function Ei(l,t,e,i,r){return t&&!hn.test(l)&&i.indexOf(l.split(".")[0])===-1&&!r&&l!=="true"&&l!=="false"?e+"."+l:l}function xf(l,t,e,i){var r=/^\..*/gm;return t&&!hn.test(l)&&i.indexOf(l.split(".")[0])===-1&&!r.test(l)?e+"."+l:l}function Va(l,t,e,i){return t&&!hn.test(l)&&i.indexOf(l.split(".")[0])===-1?e+'["'+l:l}function as(l){var t="\\\\";return l.match(Sf)?l:l.replace(Wa,t)}function ns(l,t,e,i){l=l.trim();var r=/\window\./gm;if(r.test(l))return l;var o=/'|"/gm,a=/@|\$|#/gm;return a.test(l)&&(l=Va(l,e.indexOf(l)===-1,t,e)+'"]'),Tf.test(l)?xf(l,!o.test(l)&&e.indexOf(l)===-1,t,e):Ei(l,!o.test(l)&&e.indexOf(l)===-1,t,e,i)}var Af=/^[\n\r.]+<tr|^<tr/,zf=/^[\n\r.]+<svg|^<path|^<g/;function tm(){return"-"+Math.random().toString(36).substr(2,5)}function ht(l,t,e){var i=pn.compile(l,t,e);return function(r,o,a,n,s,h,p,u){var c=i(r,o,a,p,u);if(typeof c=="string")if(zf.test(c)){var f=Ie("svg",{innerHTML:c});return f.childNodes}else{var f=Ie(Af.test(c)?"table":"div",{innerHTML:c});return f.childNodes}else return c}}function im(l,t,e,i,r){}function rm(l,t,e){var i=document.getElementById(l);if(i)for(var r=i.getElementsByClassName("blazor-inner-template"),o=0;o<r.length;o++){var a=" ";d(e)?a=r[parseInt(o.toString(),10)].getAttribute("data-templateId"):a=r[parseInt(e.toString(),10)].getAttribute("data-templateId");var n=document.getElementById(a);if(n)for(var s=n.childNodes.length,h=0;h<s;h++)d(e)?r[parseInt(o.toString(),10)].appendChild(n.childNodes[0]):(r[parseInt(e.toString(),10)].appendChild(n.childNodes[0]),o=r.length)}}function Pf(l){pn.compile=l.compile}function Ef(){return pn.compile}function ss(l,t){var e;return l.prototype.CSPTemplate=!0,d(t)?e=l:(e=l.bind(t),e.prototype=Object.create(l.prototype)),e}var Lf=function(){function l(){}return l.prototype.compile=function(t,e,i){return e===void 0&&(e={}),wf(t,e)},l}(),pn={compile:new Lf().compile},kf=["script","style","iframe[src]",'link[href*="javascript:"]','object[type="text/x-scriptlet"]','object[data^="data:text/html;base64"]','img[src^="data:text/html;base64"]','[src^="javascript:"]','[dynsrc^="javascript:"]','[lowsrc^="javascript:"]','[type^="application/x-shockwave-flash"]'],Yf=[{attribute:"href",selector:'[href*="javascript:"]'},{attribute:"href",selector:"a[href]"},{attribute:"background",selector:'[background^="javascript:"]'},{attribute:"style",selector:'[style*="javascript:"]'},{attribute:"style",selector:'[style*="expression("]'},{attribute:"href",selector:'a[href^="data:text/html;base64"]'}],ls=["onchange","onclick","onmouseover","onmouseout","onkeydown","onload","onerror","onblur","onfocus","onbeforeload","onbeforeunload","onkeyup","onsubmit","onafterprint","onbeforeonload","onbeforeprint","oncanplay","oncanplaythrough","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onformchange","onforminput","onhaschange","oninput","oninvalid","onkeypress","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmousedown","onmousemove","onmouseup","onmousewheel","onoffline","onoine","ononline","onpagehide","onpageshow","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreadystatechange","onredo","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onstorage","onsuspend","ontimeupdate","onundo","onunload","onvolumechange","onwaiting","onmouseenter","onmouseleave","onstart","onpropertychange","oncopy","ontoggle","onpointerout","onpointermove","onpointerleave","onpointerenter","onpointerrawupdate","onpointerover","onbeforecopy","onbeforecut","onbeforeinput"],pt=function(){function l(){}return l.beforeSanitize=function(){return{selectors:{tags:kf,attributes:Yf}}},l.sanitize=function(t){if(d(t))return t;var e=this.beforeSanitize(),i=this.serializeValue(e,t);return i},l.serializeValue=function(t,e){this.removeAttrs=t.selectors.attributes,this.removeTags=t.selectors.tags,this.wrapElement=document.createElement("div"),this.wrapElement.innerHTML=e,this.removeXssTags(),this.removeJsEvents(),this.removeXssAttrs();var i=this.wrapElement.innerHTML;return this.removeElement(),this.wrapElement=null,i.replace(/&amp;/g,"&")},l.removeElement=function(){for(var t=this.wrapElement.children,e=0;e<t.length;e++)for(var i=t[parseInt(e.toString(),10)].attributes,r=0;r<i.length;r++)this.wrapElement.children[parseInt(e.toString(),10)].removeAttribute(i[parseInt(r.toString(),10)].localName)},l.removeXssTags=function(){var t=this.wrapElement.querySelectorAll(this.removeTags.join(","));if(t.length>0)t.forEach(function(e){X(e)});else return},l.removeJsEvents=function(){var t=this.wrapElement.querySelectorAll("["+ls.join("],[")+"]");if(t.length>0)t.forEach(function(e){ls.forEach(function(i){e.hasAttribute(i)&&e.removeAttribute(i)})});else return},l.removeXssAttrs=function(){var t=this;this.removeAttrs.forEach(function(e,i){var r=t.wrapElement.querySelectorAll(e.selector);r.length>0&&(e.selector==="a[href]"?r.forEach(function(o){o.getAttribute(e.attribute).replace(/\t|\s|&/,"").indexOf("javascript:alert")!==-1&&o.removeAttribute(e.attribute)}):r.forEach(function(o){o.removeAttribute(e.attribute)}))})},l}(),Ff=function(){function l(t){this.croppedDegree=0,this.cropDestPoints={startX:0,startY:0,width:0,height:0},this.tempFlipPanPoint={x:0,y:0},this.isPreventScaling=!1,this.isInitCrop=!1,this.isTransformCrop=!1,this.parent=t,this.addEventListener()}return l.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},l.prototype.addEventListener=function(){this.parent.on("crop",this.cropping,this),this.parent.on("destroyed",this.destroy,this)},l.prototype.removeEventListener=function(){this.parent.off("crop",this.cropping),this.parent.off("destroyed",this.destroy)},l.prototype.cropping=function(t){switch(this.updateCropPvtVar(),t.prop){case"cropCircle":this.cropCircle(t.value.context,t.value.isSave,t.value.isFlip);break;case"setCurrSelPoints":this.setCurrSelPoints(t.value.isSetDimension);break;case"updateRotatePan":this.updateRotatePan();break;case"crop":this.crop(t.value.obj);break;case"calcRatio":this.calcRatio(t.value.obj,t.value.dimension);break;case"getCurrFlipState":this.getCurrFlipState(t.value.panObj);break;case"getPreviousCropCurrentObj":t.value.obj.prevObj=this.prevCropCurrObj;break;case"setPreviousCropCurrentObj":this.prevCropCurrObj=t.value.obj;break;case"setCropDestPoints":this.cropDestPoints=t.value.point;break;case"getTempFlipPanPoint":t.value.obj.point=this.tempFlipPanPoint;break;case"setTempFlipPanPoint":d(t.value.isAdd)?this.tempFlipPanPoint=t.value.point:(this.tempFlipPanPoint.x+=t.value.point.x,this.tempFlipPanPoint.y+=t.value.point.y);break;case"getPreventScaling":t.value.obj.bool=this.isPreventScaling;break;case"adjustStraightenForShapes":this.adjustStraightenForShapes(t.value.type,t.value.isInitialRotated);break;case"resizeWrapper":this.resizeWrapper();break;case"setTransformCrop":this.isTransformCrop=t.value.bool;break;case"setInitCrop":this.isInitCrop=t.value.bool;break;case"resetZoom":this.resetZoom();break;case"revertTransform":this.revertTransform(t.value.type,t.value.coll);break;case"reset":this.reset();break}},l.prototype.getModuleName=function(){return"crop"},l.prototype.updateCropPvtVar=function(){var t=this.parent;t.lowerCanvas&&(this.lowerContext=t.lowerCanvas.getContext("2d")),t.upperCanvas&&(this.upperContext=t.upperCanvas.getContext("2d"))},l.prototype.reset=function(){this.prevCropCurrObj=null,this.croppedDegree=0,this.cropDestPoints={startX:0,startY:0,width:0,height:0},this.tempFlipPanPoint={x:0,y:0},this.isPreventScaling=!1,this.isInitCrop=!1,this.isTransformCrop=!1},l.prototype.cropImg=function(t){for(var e=this.parent,i=d(t),r=e.element.querySelector("#"+e.element.id+"_nonaspectratio"),o=e.activeObj.activePoint,a=e.img,n=!1,s=0,h=e.rotateFlipColl.length;s<h;s++){var p=e.rotateFlipColl[s];(p===90||p===-90)&&(n=!0)}if(e.notify("draw",{prop:"setImageEdited",onPropertyChange:!1}),(i||r)&&(this.croppedDegree=e.transform.degree),i&&e.transform.degree!==0||n){this.updateCropObj();var u={startX:a.destLeft,startY:a.destTop,width:a.destWidth,height:a.destHeight};e.notify("transform",{prop:"setCurrDestinationPoint",onPropertyChange:!1,value:{point:u}}),this.rotateCrop()}else if(i&&e.transform.currFlipState!==""){this.updateCropObj();var u={startX:a.destLeft,startY:a.destTop,width:a.destWidth,height:a.destHeight};e.notify("transform",{prop:"setCurrDestinationPoint",onPropertyChange:!1,value:{point:u}}),this.flipCrop()}else{this.adjustStraightenForShapes("initial",!1),e.notify("draw",{prop:"setTempZoomFactor",onPropertyChange:!1,value:{tempZoomFactor:e.transform.zoomFactor}});var c=this.calcRatio();if(i||!t){this.updateCropObj(),e.notify("draw",{prop:"resetPanPoints",onPropertyChange:!1}),e.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1});var u={startX:a.destLeft,startY:a.destTop,width:a.destWidth,height:a.destHeight};e.notify("transform",{prop:"setCurrDestinationPoint",onPropertyChange:!1,value:{point:u}}),e.currSelectionPoint=y({},e.activeObj,{},!0),this.cropDestPoints={startX:a.destLeft,startY:a.destTop,width:a.destWidth,height:a.destHeight}}var f={width:0,height:0};e.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:o.width*c.width,height:o.height*c.height,obj:f,isImgShape:null}});var g=f;this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),this.lowerContext.clearRect(0,0,e.lowerCanvas.width,e.lowerCanvas.height),e.img={srcLeft:o.startX*c.width-a.destLeft*c.width,srcTop:o.startY*c.height-a.destTop*c.height,srcWidth:o.width*c.width,srcHeight:o.height*c.height,destLeft:(e.lowerCanvas.clientWidth-g.width)/2,destTop:(e.lowerCanvas.clientHeight-g.height+1)/2,destWidth:g.width,destHeight:g.height};var v=this.lowerContext.filter;e.notify("draw",{prop:"drawImage",onPropertyChange:!1}),this.lowerContext.filter="none";var m=y({},e.activeObj,{},!0);this.cropObjColl(),e.transform.straighten=0,e.activeObj=m,this.cropFreehandDrawColl(),e.shapeColl=[],e.notify("shape",{prop:"updateShapeColl",onPropertyChange:!1}),e.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),e.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),e.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}}),e.currSelectionPoint&&e.currSelectionPoint.shape==="crop-circle"?this.cropCircle(this.lowerContext):e.isCircleCrop=!1,this.lowerContext.filter=v,e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),e.currObjType.isCustomCrop=!1,e.pan(!1),e.transform.defaultZoomFactor=0}},l.prototype.adjustStraightenForShapes=function(t,e){for(var i=this.parent,r={x:i.img.destLeft+i.img.destWidth/2,y:i.img.destTop+i.img.destHeight/2},o=0,a=i.objColl;o<a.length;o++){var n=a[o];if(["rectangle","ellipse","text","image","redact"].indexOf(n.shape)!==-1&&(e||n.rotatedAngle!==0)){var s=n.activePoint,h=s.startX,p=s.startY,u=s.width,c=s.height,f=t==="initial"?n.rotatedAngle:-n.rotatedAngle,g=h+u/2-r.x,v=p+c/2-r.y,m=Math.cos(f),C=Math.sin(f),M=m*g-C*v+r.x,I=C*g+m*v+r.y,N=M-h-u/2,O=I-p-c/2;n.activePoint.startX+=N,n.activePoint.startY+=O,n.activePoint.endX+=N,n.activePoint.endY+=O}}},l.prototype.updateCropObj=function(){this.parent.afterCropActions=[];var t={currObj:{}};this.parent.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:t}});var e=t.currObj;e.straighten=this.parent.transform.straighten,this.parent.cropObj=y({},e,{},!0)},l.prototype.rotateCrop=function(){var t=this.parent,e=this.getCurrFlipState(),i=t.activeObj.shape||"";t.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),t.currSelectionPoint=y({},t.activeObj,{},!0),t.objColl.push(t.activeObj),t.activeObj=y({},t.objColl[t.objColl.length-1],{},!0);var r=y({},t.objColl[t.objColl.length-1],{},!0),o=y({},t.currSelectionPoint,{},!0),a={bool:null};t.notify("transform",{prop:"getPreventSelect",onPropertyChange:!1,value:{obj:a}}),t.notify("transform",{prop:"setPreventSelect",onPropertyChange:!1,value:{bool:!0}});var n=y([],t.rotateFlipColl,[],!0);this.panToSelRangle(!0),r=y({},t.objColl[t.objColl.length-1],{},!0),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:r}}),t.objColl.pop(),t.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),t.objColl.push(t.activeObj);var s=t.transform.straighten;s!==0&&(t.transform.straighten=0,t.straightenBaseImageCanvas(),t.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),t.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}})),this.resetZoom();var h=y([],t.afterCropActions,[],!0);this.revertTransform("initial",n),s!==0&&(t.transform.straighten=e==="horizontal"||e==="vertical"?-s:s,t.straightenBaseImageCanvas(),t.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),t.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),t.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}})),r=y({},t.objColl[t.objColl.length-1],{},!0),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:r}}),t.objColl.pop(),t.transform.degree=0;var p={isIntersect:null};t.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),t.notify("draw",{prop:"isLinesIntersect",onPropertyChange:!1,value:{obj:p}});for(var u=0;s!==0&&p.isIntersect&&(u++,u!==50);)t.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:.025,zoomPoint:null},isResize:null}),t.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),t.notify("draw",{prop:"isLinesIntersect",onPropertyChange:!1,value:{obj:p}});this.cropImg(!0),this.revertTransform("reverse",n),t.afterCropActions=h,t.currSelectionPoint=o,t.notify("transform",{prop:"setPreventSelect",onPropertyChange:!1,value:{bool:a.bool}}),t.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),t.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}}),i==="crop-circle"&&this.cropCircle(this.lowerContext),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.notify("draw",{prop:"resetPanPoints",onPropertyChange:!1})},l.prototype.revertTransform=function(t,e){var i=this.parent,r={isRotate:!1};if(t==="initial")for(var o=e.length-1;o>=0;o--){var a=e[o];switch(a){case 90:i.notify("transform",{prop:"rotate",value:{degree:-90,obj:r}});break;case-90:i.notify("transform",{prop:"rotate",value:{degree:90,obj:r}});break;default:i.notify("transform",{prop:"flipImage",value:{direction:i.toPascalCase(a.toString())}});break}}else{this.updateFlipState();for(var o=0,n=e.length;o<n;o++){var a=e[o];switch(a){case 90:i.notify("transform",{prop:"rotate",value:{degree:90,obj:r}});break;case-90:i.notify("transform",{prop:"rotate",value:{degree:-90,obj:r}});break;default:i.notify("transform",{prop:"flipImage",value:{direction:i.toPascalCase(a.toString())}});break}}}},l.prototype.updateFlipState=function(){for(var t=this.parent,e=t.objColl,i=0,r=e.length;i<r;i++)e[i].shapeFlip="";for(var o=t.pointColl,i=0;i<t.freehandCounter;i++)o[i].shapeFlip=""},l.prototype.resetZoom=function(){var t=this.parent;if(t.transform.zoomFactor>0){var e=t.transform.zoomFactor,i=t.isUndoRedo;t.setProperties({zoomSettings:{zoomFactor:e*10}},!0),t.notify("transform",{prop:"setPreviousZoomValue",onPropertyChange:!1,value:{previousZoomValue:t.zoomSettings.zoomFactor}});for(var r=0;r<e*10;r++)t.isUndoRedo=!0,t.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-.1,zoomPoint:null},isResize:null});t.isUndoRedo=i,t.notify("draw",{prop:"resetPanPoints",onPropertyChange:!1})}},l.prototype.flipCrop=function(){var t=this.parent;t.notify("transform",{prop:"setReverseFlip",onPropertyChange:!1,value:{isReverseFlip:!0}}),t.panPoint.totalPannedPoint.x+=this.tempFlipPanPoint.x,t.panPoint.totalPannedPoint.y+=this.tempFlipPanPoint.y;var e=t.transform.currFlipState,i={flipColl:null};t.notify("transform",{prop:"getFlipColl",onPropertyChange:!1,value:{obj:i}});var r=i.flipColl;if(t.notify("transform",{prop:"setFlipColl",onPropertyChange:!1,value:{flipColl:[]}}),t.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),t.objColl.push(t.activeObj),t.transform.degree===0){var o=-t.cropObj.totalPannedPoint.x,a=-t.cropObj.totalPannedPoint.y;t.img.destLeft+=o,t.img.destTop+=a,t.notify("transform",{prop:"drawPannImage",value:{point:{x:o,y:a}}}),t.activeObj=y({},t.objColl[t.objColl.length-1],{},!0),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:t.activeObj}}),t.objColl.pop(),t.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),t.objColl.push(t.activeObj)}this.resetZoom(),t.currSelectionPoint=y({},t.objColl[t.objColl.length-1],{},!0),this.lowerContext.clearRect(0,0,t.lowerCanvas.width,t.lowerCanvas.height),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height);var n=this.lowerContext.filter;t.notify("draw",{prop:"drawImage",onPropertyChange:!1}),this.updateFlipState(),t.notify("shape",{prop:"redrawObj",onPropertyChange:!1,value:{degree:this.getCurrFlipState()}}),t.notify("freehand-draw",{prop:"flipFHDColl",onPropertyChange:!1,value:{value:this.getCurrFlipState()}}),t.activeObj=y({},t.objColl[t.objColl.length-1],{},!0),t.objColl.pop(),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),this.cropImg(!0),t.notify("transform",{prop:"setReverseRotate",onPropertyChange:!1,value:{bool:!0}}),this.lowerContext.setTransform(1,0,0,1,0,0),t.notify("draw",{prop:"setDestPoints",onPropertyChange:!1}),t.notify("draw",{prop:"currTransState",onPropertyChange:!1,value:{type:"initial",isPreventDestination:null,context:null,isPreventCircleCrop:null}}),t.notify("draw",{prop:"drawImage",onPropertyChange:!1}),this.lowerContext.filter=n,t.notify("draw",{prop:"setRotateZoom",onPropertyChange:!1,value:{isRotateZoom:!1}}),t.notify("draw",{prop:"currTransState",onPropertyChange:!1,value:{type:"reverse",isPreventDestination:null,context:null,isPreventCircleCrop:null}}),t.transform.currFlipState=e,t.notify("transform",{prop:"setFlipColl",onPropertyChange:!1,value:{flipColl:r}}),this.lowerContext.filter="none",this.updateFlipState(),t.notify("shape",{prop:"redrawObj",onPropertyChange:!1,value:{degree:this.getCurrFlipState()}}),t.notify("freehand-draw",{prop:"flipFHDColl",onPropertyChange:!1,value:{value:this.getCurrFlipState()}}),t.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),this.lowerContext.filter=n,(t.currSelectionPoint&&t.currSelectionPoint.shape==="crop-circle"||t.isCircleCrop)&&this.cropCircle(this.lowerContext),t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),t.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),t.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.notify("transform",{prop:"setReverseFlip",onPropertyChange:!1,value:{isReverseFlip:!1}}),t.notify("draw",{prop:"resetPanPoints",onPropertyChange:!1}),this.tempFlipPanPoint={x:0,y:0}},l.prototype.cropObjColl=function(){var t=this.parent,e,i,r;if(t.objColl.length>0)for(var o=0,a=t.objColl.length;o<a;o++){r=t.objColl[o],e=r.activePoint;var n=t.activeObj.activePoint,s=n.startX,h=n.startY,p=n.width,u=n.height;i=r.shape,r.imageRatio={startX:(e.startX-s)/p,startY:(e.startY-h)/u,endX:(e.endX-s)/p,endY:(e.endY-h)/u,width:p/e.width,height:u/e.height};var c=void 0,f=void 0;switch(i){case"text":c=r.shapeDegree===0?t.transform.degree:t.transform.degree-r.shapeDegree,f=c===0||Math.abs(c)===180?e.width:e.height,r.textSettings.fontRatio=f/r.textSettings.fontSize;break;case"line":case"arrow":this.cropPointCollection(o),i==="arrow"&&t.notify("shape",{prop:"updateArrowRatio",onPropertyChange:!1,value:{obj:r}});break;case"path":this.cropPointCollection(o);break}}},l.prototype.cropPointCollection=function(t){var e=this.parent,i=e.objColl[t].shape,r,o,a,n,s=e.activeObj.activePoint,h=e.img,p=h.destLeft,u=h.destTop,c=h.destWidth,f=h.destHeight;i==="path"?(r=s.startX,o=s.startY,a=s.width,n=s.height):(r=p,o=u,a=c,n=f);for(var g=e.objColl[t].pointColl,v=0,m=g.length;v<m;v++)g[v].ratioX=(g[v].x-r)/a,g[v].ratioY=(g[v].y-o)/n},l.prototype.cropFreehandDrawColl=function(){for(var t=this.parent,e=t.activeObj.activePoint,i=e.startX,r=e.startY,o=e.width,a=e.height,n=0;n<t.freehandCounter;n++){t.points=y([],t.pointColl[n].points,[]),t.notify("freehand-draw",{prop:"setPointCounter",onPropertyChange:!1,value:{value:0}});for(var s=t.points.length,h=0;h<s;h++)t.points[h].ratioX=(t.points[h].x-i)/o,t.points[h].ratioY=(t.points[h].y-r)/a}t.notify("freehand-draw",{prop:"updateCropPtsForSel",onPropertyChange:!1})},l.prototype.resetAnnotations=function(){var t=this.parent;t.objColl=[],t.pointColl=[],t.freehandCounter=0,t.notify("freehand-draw",{prop:"resetStraightenPoint"})},l.prototype.setCurrSelPoints=function(t){var e=this.parent;e.allowDownScale=!1;var i=this.cropDestPoints,r=this.lowerContext.filter,o=e.isCropTab;e.img={srcLeft:0,srcTop:0,srcWidth:e.baseImgCanvas.width,srcHeight:e.baseImgCanvas.height,destLeft:i.startX,destTop:i.startY,destWidth:i.width,destHeight:i.height};var a=e.img,n=e.currSelectionPoint;this.lowerContext.clearRect(0,0,e.lowerCanvas.width,e.lowerCanvas.height),t&&e.notify("draw",{prop:"setDestPoints",onPropertyChange:!1}),e.notify("draw",{prop:"currTransState",onPropertyChange:!1,value:{type:"initial",isPreventDestination:null,context:null,isPreventCircleCrop:null}}),this.croppedDegree===0&&e.transform.degree===0&&n&&n.shape!=="crop-circle"&&n.shape!=="crop-square"&&(a.destLeft=i.startX,a.destTop=i.startY,a.destWidth=i.width,a.destHeight=i.height),e.transform.degree===0&&(a.destLeft+=e.panPoint.totalPannedInternalPoint.x,a.destTop+=e.panPoint.totalPannedInternalPoint.y),e.notify("draw",{prop:"drawImage",onPropertyChange:!1}),this.lowerContext.filter=r,e.notify("draw",{prop:"currTransState",onPropertyChange:!1,value:{type:"reverse",isPreventDestination:null,context:null,isPreventCircleCrop:!0}});var s=y([],e.objColl,null,!0),h=y([],e.pointColl,null,!0),p={straightenPoint:null};if(e.notify("freehand-draw",{prop:"getStraightenPoint",onPropertyChange:!1,value:{obj:p}}),this.resetAnnotations(),d(e.activeObj.shape)&&e.cropObj.activeObj.shape&&(e.activeObj=y({},e.cropObj.activeObj,null,!0)),this.panToSelRangle(),e.isCropTab=o,e.objColl=s,e.pointColl=h,e.freehandCounter=e.pointColl.length,p.straightenPoint.x&&p.straightenPoint.y&&e.notify("freehand-draw",{prop:"setStraightenPoint",onPropertyChange:!1,value:{x:p.straightenPoint.x,y:p.straightenPoint.y,ratioX:p.straightenPoint.ratioX,ratioY:p.straightenPoint.ratioY}}),e.cropObj.activeObj.shape){var u={startX:a.destLeft,startY:a.destTop,width:a.destWidth,height:a.destHeight};if(n&&n.activePoint){var c=n.activePoint,f=c.startX,g=c.startY,v=c.width,m=c.height;a.destLeft=f,a.destTop=g,a.destWidth=v,a.destHeight=m}e.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),a.destLeft=u.startX,a.destTop=u.startY,a.destWidth=u.width,a.destHeight=u.height,e.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1}),s=y([],e.objColl,null,!0),h=y([],e.pointColl,null,!0),e.notify("freehand-draw",{prop:"getStraightenPoint",onPropertyChange:!1,value:{obj:p}}),this.resetAnnotations();var C={selPointColl:null};e.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:C}});var M=C.selPointColl;e.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:[]}}}),e.cropObj.filter=this.lowerContext.filter;var I=y({},e.currSelectionPoint,null,!0);e.notify("draw",{prop:"setCurrentObj",onPropertyChange:!1,value:{obj:null}}),e.activeObj=y({},I,null,!0);var N=y({},e.activeObj,null,!0);if(e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),e.currSelectionPoint=null,e.isCircleCrop=!1,e.transform.degree!==0&&(d(e.activeObj.shape)&&e.cropObj.activeObj.shape&&(e.activeObj=y({},e.cropObj.activeObj,null,!0)),e.notify("transform",{prop:"drawPannedImage",value:{xDiff:0,yDiff:0}}),e.panPoint.currentPannedPoint={x:0,y:0}),e.objColl=s,e.pointColl=h,e.freehandCounter=e.pointColl.length,p.straightenPoint.x&&p.straightenPoint.y&&e.notify("freehand-draw",{prop:"setStraightenPoint",onPropertyChange:!1,value:{x:p.straightenPoint.x,y:p.straightenPoint.y,ratioX:p.straightenPoint.ratioX,ratioY:p.straightenPoint.ratioY}}),e.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:M}}}),e.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"iterate",pen:"iterate",isPreventApply:null}}),this.adjustStraightenForShapes("reverse",!1),e.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1,value:{isPreventApply:!0}}),e.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),e.transform.degree===0?e.notify("transform",{prop:"drawPannImage",onPropertyChange:!1,value:{point:{x:0,y:0}}}):(d(e.activeObj.shape)&&e.cropObj.activeObj.shape&&(e.activeObj=y({},e.cropObj.activeObj,null,!0)),e.notify("transform",{prop:"drawPannedImage",value:{xDiff:0,yDiff:0}}),e.panPoint.currentPannedPoint={x:0,y:0}),e.activeObj=N,e.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),e.notify("transform",{prop:"setTempPanMove",onPropertyChange:!1,value:{point:null}}),!this.isInitCrop&&e.transform.degree===0&&e.cropObj.currFlipState!==""&&e.cropObj.cropZoom!==0){this.isInitCrop=!0;var O={activeObj:null};e.notify("draw",{prop:"getStraightenActObj",onPropertyChange:!1,value:{obj:O}}),e.notify("draw",{prop:"performCancel",value:{isContextualToolbar:null}}),e.notify("draw",{prop:"setStraightenActObj",onPropertyChange:!1,value:{activeObj:O.activeObj}}),e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"croptransform",isApplyBtn:!1,isCropping:null,isZooming:null,cType:null}})}else this.isInitCrop=!1}else{this.adjustStraightenForShapes("reverse",!0),e.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1,value:{isPreventApply:!0}});var x=this.lowerContext.filter;this.lowerContext.filter="none",e.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"iterate",pen:"iterate",isPreventApply:null}}),this.lowerContext.filter=x,e.currSelectionPoint=null}document.querySelector(".e-ie-straighten-value-span")&&(document.querySelector(".e-ie-straighten-value-span").innerHTML=e.transform.straighten.toString()+"&#176")},l.prototype.panToSelRangle=function(t){var e=this.parent,i=e.cropObj.totalPannedClientPoint,r=e.transform.degree!==0?t?-i.x:i.x:0,o=e.transform.degree!==0?t?-i.y:i.y:0;e.transform.degree!==0&&(e.panPoint.currentPannedPoint={x:r,y:o},e.notify("transform",{prop:"drawPannedImage",value:{xDiff:r,yDiff:o}}),e.panPoint.currentPannedPoint={x:0,y:0})},l.prototype.cropCircle=function(t,e,i){var r=this.parent,o=r.img,a=o.destLeft,n=o.destTop,s=o.destWidth,h=o.destHeight;i&&r.transform.currFlipState!==""&&r.notify("draw",{prop:"setTransform",onPropertyChange:!1,value:{context:t,value:r.transform.currFlipState,isReverse:null}});var p=t.filter;t.filter="none",t.globalCompositeOperation="destination-in",t.beginPath();var u=d(e)?a+s/2:t.canvas.width/2,c=d(e)?n+h/2:t.canvas.height/2,f=e?t.canvas.width/2:s/2;t.arc(u,c,f,0,Math.PI*2),t.closePath(),t.fill(),t.restore(),t.globalCompositeOperation="source-over",r.currObjType.isActiveObj=r.isCircleCrop=!0,t.filter=p,i&&r.transform.currFlipState!==""&&r.notify("draw",{prop:"setTransform",onPropertyChange:!1,value:{context:t,value:r.transform.currFlipState,isReverse:null}})},l.prototype.getCurrCropState=function(){var t=this.parent,e="",i={flipColl:null};return t.notify("transform",{prop:"getFlipColl",onPropertyChange:!1,value:{obj:i}}),e=this.getCurrFlipState(),(t.transform.degree===-90||t.transform.degree===-270)&&(e==="horizontal"?e="vertical":e==="vertical"&&(e="horizontal")),e===""&&(e=i.flipColl.length>1?this.getCurrFlipState():t.transform.currFlipState),e},l.prototype.updateRotatePan=function(){var t=this.parent;if(!d(t.panPoint.currentPannedPoint)){var e="",i=t.transform.degree,r=t.panPoint.currentPannedPoint,o=r.x,a=r.y;t.rotateFlipColl.length>0&&typeof t.rotateFlipColl[0]=="number"&&i<0?e=this.getCurrCropState():e=this.getCurrFlipState(),i%90===0&&i%180!==0?i===90||i===-90&&(e==="horizontal"||e==="vertical")||i===-270&&(e===""||e==="verticalHorizontal"||e==="horizontalVertical")?(e==="horizontal"||e===""?t.img.destLeft+=a:t.img.destLeft-=a,e===""||e==="vertical"?t.img.destTop-=o:t.img.destTop+=o):(i===270||i===-270&&(e==="horizontal"||e==="vertical")||i===-90&&(e===""||e==="verticalHorizontal"||e==="horizontalVertical"))&&(e===""||e==="horizontal"?t.img.destLeft-=a:t.img.destLeft+=a,e===""||e==="vertical"?t.img.destTop+=o:t.img.destTop-=o):(i===180||i===-180)&&(e===""||e==="vertical"?t.img.destLeft-=o:t.img.destLeft+=o,e===""||e==="horizontal"?t.img.destTop-=a:t.img.destTop+=a)}},l.prototype.crop=function(t){var e=this.parent,i=e.activeObj.activePoint,r=i.startX,o=i.startY,a=i.endX,n=i.endY;if(!e.disabled&&e.isImageLoaded){var s={isCropToolbar:e.isCropToolbar};e.currObjType.isUndoAction&&!s.isCropToolbar&&e.notify("undo-redo",{prop:"refreshUrc",value:{bool:null}});var h={cancel:!1,startPoint:{x:r,y:o},endPoint:{x:a,y:n},preventScaling:!1};s.isCropToolbar||(e.trigger("cropping",h),e.editCompleteArgs=h),this.cropEvent(h,t,s)}},l.prototype.cropEvent=function(t,e,i){var r=this.parent,o;if(!t.cancel&&(o=r.activeObj.shape?r.activeObj.shape.split("-"):[],!r.disabled&&r.activeObj.horTopLine&&(r.currObjType.isCustomCrop||o.length>0&&o[0]==="crop"))){e.isCrop=!0;var a=y({},r.cropObj,{},!0),n=y({},this.prevCropCurrObj,{},!0);t.preventScaling?this.isPreventScaling=!0:this.isPreventScaling=!1,this.cropImg(),this.isPreventScaling&&(r.aspectWidth=r.img.destWidth,r.aspectHeight=r.img.destHeight),r.notify("freehand-draw",{prop:"resetStraightenPoint"}),r.isCropTab=!1,r.transform.zoomFactor=0,r.setProperties({zoomSettings:{zoomFactor:1}},!0),r.notify("transform",{prop:"setPreviousZoomValue",onPropertyChange:!1,value:{previousZoomValue:r.zoomSettings.zoomFactor}}),S.isDevice||this.updateUndoRedoColl(n,a,i),r.notify("transform",{prop:"setCropDimension",onPropertyChange:!1,value:{width:r.cropObj.destPoints.width,height:r.cropObj.destPoints.height}});var s=r.element.querySelector("#"+r.element.id+"_aspectratio"),h=r.element.querySelector("#"+r.element.id+"_nonaspectratio");r.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),!i.isCropToolbar&&d(s)&&d(h)&&r.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:!1,isCropping:!1,isZooming:null,cType:null}}),this.resizeWrapper(),S.isDevice&&this.updateUndoRedoColl(n,a,i)}},l.prototype.updateUndoRedoColl=function(t,e,i){var r=this.parent,o={prevCurrSelectionPoint:r.prevCurrSelectionPoint};t.currSelectionPoint=y({},o.prevCurrSelectionPoint,{},!0),r.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"crop",previousObj:t,previousObjColl:t.objColl,previousPointColl:t.pointColl,previousSelPointColl:t.selPointColl,previousCropObj:e,previousText:null,currentText:null,previousFilter:null,isCircleCrop:r.isCircleCrop}}),i.isCropToolbar||r.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}})},l.prototype.resizeWrapper=function(){var t=this.parent;if(S.isDevice){var e=t.element,i=e.querySelector("#"+e.id+"_contextualToolbarArea");i&&i.style.position===""&&!this.isTransformCrop&&(i.style.position="absolute",t.isStraightening=!1,t.update(),t.notify("filter",{prop:"setAdjustmentValue",value:{adjustmentValue:t.canvasFilter}}))}},l.prototype.calcRatio=function(t,e){var i=this.parent,r=i.transform.degree,o=i.img,a=o.destWidth,n=o.destHeight,s=e||i.baseImgCanvas,h=s.width,p=s.height,u=r===0||r%180===0?h/a:p/a,c=r===0||r%180===0?p/n:h/n;return t&&(t.width=u,t.height=c),{width:u,height:c}},l.prototype.getCurrFlipState=function(t){var e=this.parent,i={panRegion:""},r={collection:e.rotateFlipColl};e.notify("shape",{prop:"alignRotateFlipColl",onPropertyChange:!1,value:{collection:e.rotateFlipColl,isRotateFlipCollection:!0,obj:r}}),e.rotateFlipColl=r.collection;for(var o=0,a=e.rotateFlipColl.length;o<a;o++)e.notify("transform",{prop:"setCurrPanRegion",onPropertyChange:!1,value:{region:i.panRegion,type:e.rotateFlipColl[o],obj:i}});return t&&(t.panRegion=i.panRegion),i.panRegion},l}(),Ht,oi,ft,Sr,un=!1;function Uf(l,t){var e=!1,i={left:0,top:0},r=l;if(!l||!t)return i;for(d(t.offsetParent)&&t.style.position==="fixed"&&(e=!0);(t.offsetParent||e)&&l&&t.offsetParent!==l;)i.left+=l.offsetLeft,i.top+=l.offsetTop,l=l.offsetParent;for(l=r;(t.offsetParent||e)&&l&&t.offsetParent!==l;)i.left-=l.scrollLeft,i.top-=l.scrollTop,l=l.parentElement;return i}function at(l,t,e,i,r){if(oi=void 0,oi=r,un=!!i,!l)return{left:0,top:0};t||(t="left"),e||(e="top"),Sr=l.ownerDocument,ft=l;var o={left:0,top:0};return Rf(t.toLowerCase(),e.toLowerCase(),o)}function Xt(l,t){t.left=l}function Wt(l,t){t.top=l}function Rf(l,t,e){switch(Ht=ft.getBoundingClientRect(),t+l){case"topcenter":Xt(Wo(),e),Wt(fo(),e);break;case"topright":Xt(Xo(),e),Wt(fo(),e);break;case"centercenter":Xt(Wo(),e),Wt(Qo(),e);break;case"centerright":Xt(Xo(),e),Wt(Qo(),e);break;case"centerleft":Xt(go(),e),Wt(Qo(),e);break;case"bottomcenter":Xt(Wo(),e),Wt(Ho(),e);break;case"bottomright":Xt(Xo(),e),Wt(Ho(),e);break;case"bottomleft":Xt(go(),e),Wt(Ho(),e);break;default:case"topleft":Xt(go(),e),Wt(fo(),e);break}return ft=null,e}function ph(){return Sr.documentElement.scrollTop||Sr.body.scrollTop}function uh(){return Sr.documentElement.scrollLeft||Sr.body.scrollLeft}function Ho(){return un?Ht.bottom:Ht.bottom+ph()}function Qo(){return fo()+Ht.height/2}function fo(){return un?Ht.top:Ht.top+ph()}function go(){return Ht.left+uh()}function Xo(){var l=ft&&((ft.classList.contains("e-date-wrapper")||ft.classList.contains("e-datetime-wrapper"))&&ft.classList.contains("e-rtl")||ft.classList.contains("e-ddl")&&ft.classList.contains("e-rtl")||ft.classList.contains("e-date-range-wrapper"))?oi?oi.width:0:oi&&Ht.width>=oi.width?oi.width:0;return ft&&ft.classList.contains("e-rtl")&&ft.classList.contains("e-multiselect")&&(l=oi.width),Ht.right+uh()-l}function Wo(){return go()+Ht.width/2}var li,ut;function ch(l,t,e,i){if(t===void 0&&(t=null),e===void 0&&(e={X:!1,Y:!1}),!e.Y&&!e.X)return{left:0,top:0};var r=l.getBoundingClientRect();if(ut=t,li=l.ownerDocument,i||(i=at(l,"left","top")),e.X){var o=ut?mh():Ih(),a=vn(),n=yn(),s=a-i.left,h=i.left+r.width-n;r.width>o?s>0&&h<=0?i.left=n-r.width:h>0&&s<=0?i.left=a:i.left=s>h?n-r.width:a:s>0?i.left+=s:h>0&&(i.left-=h)}if(e.Y){var p=ut?Ch():jh(),u=gn(),c=mn(),f=u-i.top,g=i.top+r.height-c;r.height>p?f>0&&g<=0?i.top=c-r.height:g>0&&f<=0?i.top=u:i.top=f>g?c-r.height:u:f>0?i.top+=f:g>0&&(i.top-=g)}return i}function cn(l,t,e,i){t===void 0&&(t=null);var r=at(l,"left","top");e&&(r.left=e),i&&(r.top=i);var o=[];ut=t,li=l.ownerDocument;var a=l.getBoundingClientRect(),n=r.top,s=r.left,h=r.left+a.width,p=r.top+a.height,u=yh(n,p),c=fh(s,h);return u.topSide&&o.push("top"),c.rightSide&&o.push("right"),c.leftSide&&o.push("left"),u.bottomSide&&o.push("bottom"),o}function Bf(l,t,e,i,r,o,a,n,s){if(a===void 0&&(a=null),n===void 0&&(n={X:!0,Y:!0}),!(!t||!l||!r||!o||!n.X&&!n.Y)){var h={TL:null,TR:null,BL:null,BR:null},p={TL:null,TR:null,BL:null,BR:null},u;if(window.getComputedStyle(l).display==="none"){var c=l.style.visibility;l.style.visibility="hidden",l.style.display="block",u=l.getBoundingClientRect(),l.style.removeProperty("display"),l.style.visibility=c}else u=l.getBoundingClientRect();var f={posX:r,posY:o,offsetX:e,offsetY:i,position:{left:0,top:0}};ut=a,li=t.ownerDocument,Qf(t,h,f,s,u),fn(p,f,u),n.X&&gh(t,p,h,f,u,!0),n.Y&&h.TL.top>-1&&vh(t,p,h,f,u,!0),Hf(l,f,u)}}function Hf(l,t,e){var i=0,r=0;if(l.offsetParent!=null&&(getComputedStyle(l.offsetParent).position==="absolute"||getComputedStyle(l.offsetParent).position==="relative")){var o=at(l.offsetParent,"left","top",!1,e);i=o.left,r=o.top}var a=1,n=1,s=dh(l);if(s){var h=getComputedStyle(s).transform;if(h!=="none"){var p=new DOMMatrix(h);a=p.a,n=p.d}var u=getComputedStyle(s).zoom;if(u!=="none"){var c=dn(document.body);a=c*a,n=c*n}}l.style.top=t.position.top/n+t.offsetY-r/n+"px",l.style.left=t.position.left/a+t.offsetX-i/a+"px"}function dn(l){var t=getComputedStyle(l).zoom;return parseFloat(t)||1}function dh(l){for(;l;){var t=window.getComputedStyle(l).transform,e=dn(document.body);if(t&&t!=="none"||e&&e!==1)return l;if(l===document.body)return null;l=l.offsetParent||l.parentElement}return null}function Qf(l,t,e,i,r){e.position=at(l,e.posX,e.posY,i,r),t.TL=at(l,"left","top",i,r),t.TR=at(l,"right","top",i,r),t.BR=at(l,"left","bottom",i,r),t.BL=at(l,"right","bottom",i,r)}function fn(l,t,e){l.TL={top:t.position.top+t.offsetY,left:t.position.left+t.offsetX},l.TR={top:l.TL.top,left:l.TL.left+e.width},l.BL={top:l.TL.top+e.height,left:l.TL.left},l.BR={top:l.TL.top+e.height,left:l.TL.left+e.width}}function fh(l,t){var e=!1,i=!1;return l-Io()<vn()&&(e=!0),t>yn()&&(i=!0),{leftSide:e,rightSide:i}}function gh(l,t,e,i,r,o){var a=fh(t.TL.left,t.TR.left);e.TL.left-Io()<=vn()&&(a.leftSide=!1),e.TR.left>yn()&&(a.rightSide=!1),(a.leftSide&&!a.rightSide||!a.leftSide&&a.rightSide)&&(i.posX==="right"?i.posX="left":i.posX="right",i.offsetX=i.offsetX+r.width,i.offsetX=-1*i.offsetX,i.position=at(l,i.posX,i.posY,!1),fn(t,i,r),o&&gh(l,t,e,i,r,!1))}function vh(l,t,e,i,r,o){var a=yh(t.TL.top,t.BL.top);e.TL.top-jo()<=gn()&&(a.topSide=!1),e.BL.top>=mn()&&l.getBoundingClientRect().bottom<window.innerHeight&&(a.bottomSide=!1),(a.topSide&&!a.bottomSide||!a.topSide&&a.bottomSide)&&(i.posY==="top"?i.posY="bottom":i.posY="top",i.offsetY=i.offsetY+r.height,i.offsetY=-1*i.offsetY,i.position=at(l,i.posX,i.posY,!1,r),fn(t,i,r),o&&vh(l,t,e,i,r,!1))}function yh(l,t){var e=!1,i=!1;return l-jo()<gn()&&(e=!0),t>mn()&&(i=!0),{topSide:e,bottomSide:i}}function mh(){return ut.getBoundingClientRect().width}function Ch(){return ut.getBoundingClientRect().height}function Mh(){return ut.getBoundingClientRect().left}function bh(){return ut.getBoundingClientRect().top}function gn(){return ut?bh():0}function vn(){return ut?Mh():0}function yn(){return ut?Io()+Mh()+mh():Io()+Ih()}function mn(){return ut?jo()+bh()+Ch():jo()+jh()}function jo(){return li.documentElement.scrollTop||li.body.scrollTop}function Io(){return li.documentElement.scrollLeft||li.body.scrollLeft}function jh(){return window.innerHeight}function Ih(){var l=window.innerWidth,t=document.documentElement.getBoundingClientRect(),e=d(document.documentElement)?0:t.width;return l-(l-e)}function Th(){ut=null,li=null}var Sh=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),He=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},Nh=function(l){Sh(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return He([T("left")],t.prototype,"X",void 0),He([T("top")],t.prototype,"Y",void 0),t}(Be),_e={ROOT:"e-popup",RTL:"e-rtl",OPEN:"e-popup-open",CLOSE:"e-popup-close"},Or=function(l){Sh(t,l);function t(e,i){return l.call(this,i,e)||this}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,o=Object.keys(e);r<o.length;r++){var a=o[r];switch(a){case"width":de(this.element,{width:ee(e.width)});break;case"height":de(this.element,{height:ee(e.height)});break;case"zIndex":de(this.element,{zIndex:e.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":{var n=e.offsetX-i.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+n).toString()+"px";break}case"offsetY":{var s=e.offsetY-i.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+s).toString()+"px";break}case"content":this.setContent();break;case"actionOnScroll":e.actionOnScroll!=="none"?this.wireScrollEvents():this.unwireScrollEvents();break}}},t.prototype.getModuleName=function(){return"popup"},t.prototype.resolveCollision=function(){this.checkCollision()},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.destroy=function(){this.element.classList.contains("e-popup-open")&&this.unwireEvents(),this.element.classList.remove(_e.ROOT,_e.RTL,_e.OPEN,_e.CLOSE),this.content=null,this.relateTo=null,Th(),l.prototype.destroy.call(this)},t.prototype.render=function(){this.element.classList.add(_e.ROOT);var e={};this.zIndex!==1e3&&(e.zIndex=this.zIndex),this.width!=="auto"&&(e.width=ee(this.width)),this.height!=="auto"&&(e.height=ee(this.height)),de(this.element,e),this.fixedParent=!1,this.setEnableRtl(),this.setContent()},t.prototype.wireEvents=function(){S.isDevice&&b.add(window,"orientationchange",this.orientationOnChange,this),this.actionOnScroll!=="none"&&this.wireScrollEvents()},t.prototype.wireScrollEvents=function(){if(this.getRelateToElement())for(var e=0,i=this.getScrollableParent(this.getRelateToElement());e<i.length;e++){var r=i[e];b.add(r,"scroll",this.scrollRefresh,this)}},t.prototype.unwireEvents=function(){S.isDevice&&b.remove(window,"orientationchange",this.orientationOnChange),this.actionOnScroll!=="none"&&this.unwireScrollEvents()},t.prototype.unwireScrollEvents=function(){if(this.getRelateToElement())for(var e=0,i=this.getScrollableParent(this.getRelateToElement());e<i.length;e++){var r=i[e];b.remove(r,"scroll",this.scrollRefresh)}},t.prototype.getRelateToElement=function(){var e=this.relateTo===""||d(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:e},!0),typeof this.relateTo=="string"?document.querySelector(this.relateTo):this.relateTo},t.prototype.scrollRefresh=function(e){if(this.actionOnScroll==="reposition"?!d(this.element)&&!(this.element.offsetParent===e.target||this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&e.target.parentElement==null)&&this.refreshPosition():this.actionOnScroll==="hide"&&this.hide(),this.actionOnScroll!=="none"&&this.getRelateToElement()){var i=this.isElementOnViewport(this.getRelateToElement(),e.target);!i&&!this.targetInvisibleStatus?(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0):i&&(this.targetInvisibleStatus=!1)}},t.prototype.isElementOnViewport=function(e,i){for(var r=this.getScrollableParent(e),o=0;o<r.length;o++)if(!this.isElementVisible(e,r[o]))return!1;return!0},t.prototype.isElementVisible=function(e,i){var r=this.checkGetBoundingClientRect(e);if(!r.height||!r.width)return!1;if(d(this.checkGetBoundingClientRect(i))){var a=window,n={top:a.scrollY,left:a.scrollX,right:a.scrollX+a.outerWidth,bottom:a.scrollY+a.outerHeight},s=at(e),h={top:s.top,left:s.left,right:s.left+r.width,bottom:s.top+r.height},p={top:n.bottom-h.top,left:n.right-h.left,bottom:h.bottom-n.top,right:h.right-n.left};return p.top>0&&p.left>0&&p.right>0&&p.bottom>0}else{var o=i.getBoundingClientRect();return!(r.bottom<o.top)&&!(r.bottom>o.bottom)&&!(r.right>o.right)&&!(r.left<o.left)}},t.prototype.preRender=function(){},t.prototype.setEnableRtl=function(){this.reposition(),this.enableRtl?this.element.classList.add(_e.RTL):this.element.classList.remove(_e.RTL)},t.prototype.setContent=function(){if(!d(this.content))if(this.element.innerHTML="",typeof this.content=="string")this.element.textContent=this.content;else{var e=this.getRelateToElement(),i=this.content.props;(!e.classList.contains("e-dropdown-btn")||d(i))&&this.element.appendChild(this.content)}},t.prototype.orientationOnChange=function(){var e=this;setTimeout(function(){e.refreshPosition()},200)},t.prototype.refreshPosition=function(e,i){d(e)||this.checkFixedParent(e),this.reposition(),i||this.checkCollision()},t.prototype.reposition=function(){var e,i,r=this.getRelateToElement();if(typeof this.position.X=="number"&&typeof this.position.Y=="number")e={left:this.position.X,top:this.position.Y};else if(typeof this.position.X=="string"&&typeof this.position.Y=="number"||typeof this.position.X=="number"&&typeof this.position.Y=="string"){var o=void 0,a=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(o=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),i=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY),typeof this.position.X=="string"?e={left:i.left,top:this.position.Y}:e={left:this.position.X,top:i.top},this.element.style.display=a,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=o)}else if(r){var n=this.element.clientHeight,a=this.element.style.display;this.element.style.display="block",e=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY,n),this.element.style.display=a}else e={left:0,top:0};d(e)||(this.element.style.left=e.left+"px",this.element.style.top=e.top+"px")},t.prototype.checkGetBoundingClientRect=function(e){var i;try{return i=e.getBoundingClientRect(),i}catch{return null}},t.prototype.getAnchorPosition=function(e,i,r,o,a,n){n===void 0&&(n=0);var s=this.checkGetBoundingClientRect(i),h=this.checkGetBoundingClientRect(e);if(d(s)||d(h))return null;var p=e,u={left:0,top:0};switch(i.offsetParent&&i.offsetParent.tagName==="BODY"&&e.tagName==="BODY"?u=at(e):(i.classList.contains("e-dlg-modal")&&p.tagName!=="BODY"&&(i=i.parentElement),u=Uf(p,i)),r.X){default:case"left":break;case"center":i.classList.contains("e-dlg-modal")&&p.tagName==="BODY"&&this.targetType==="container"?u.left+=window.innerWidth/2-s.width/2:this.targetType==="container"?u.left+=h.width/2-s.width/2:u.left+=h.width/2;break;case"right":if(i.classList.contains("e-dlg-modal")&&p.tagName==="BODY"&&this.targetType==="container")u.left+=window.innerWidth-s.width;else if(this.targetType==="container"){var c=1,f=dh(i);if(f){var g=getComputedStyle(f).transform;if(g!=="none"){var v=new DOMMatrix(g);c=v.a}var m=getComputedStyle(f).zoom;if(m!=="none"){var C=dn(document.body);c=C*c}}u.left+=(h.width-s.width)/c}else u.left+=h.width;break}switch(r.Y){default:case"top":break;case"center":i.classList.contains("e-dlg-modal")&&p.tagName==="BODY"&&this.targetType==="container"?u.top+=window.innerHeight/2-s.height/2:this.targetType==="container"?u.top+=h.height/2-s.height/2:u.top+=h.height/2;break;case"bottom":i.classList.contains("e-dlg-modal")&&p.tagName==="BODY"&&this.targetType==="container"?u.top+=window.innerHeight-s.height:this.targetType==="container"&&!i.classList.contains("e-dialog")?u.top+=h.height-s.height:this.targetType==="container"&&i.classList.contains("e-dialog")?u.top+=h.height-n:u.top+=h.height;break}return u.left+=o,u.top+=a,u},t.prototype.callFlip=function(e){var i=this.getRelateToElement();Bf(this.element,i,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,e,this.fixedParent)},t.prototype.callFit=function(e){if(cn(this.element,this.viewPortElement).length!==0)if(d(this.viewPortElement)){var i=ch(this.element,this.viewPortElement,e);e.X&&(this.element.style.left=i.left+"px"),e.Y&&(this.element.style.top=i.top+"px")}else{var r=this.checkGetBoundingClientRect(this.element),o=this.checkGetBoundingClientRect(this.viewPortElement);if(d(r)||d(o))return null;e&&e.Y===!0&&(o.top>r.top?this.element.style.top="0px":o.bottom<r.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(r.bottom-o.bottom)+"px")),e&&e.X===!0&&(o.right<r.right?this.element.style.left=parseInt(this.element.style.left,10)-(r.right-o.right)+"px":o.left>r.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(o.left-r.left)+"px"))}},t.prototype.checkCollision=function(){var e=this.collision.X,i=this.collision.Y;e==="none"&&i==="none"||(e==="flip"&&i==="flip"?this.callFlip({X:!0,Y:!0}):e==="fit"&&i==="fit"?this.callFit({X:!0,Y:!0}):(e==="flip"?this.callFlip({X:!0,Y:!1}):i==="flip"&&this.callFlip({Y:!0,X:!1}),e==="fit"?this.callFit({X:!0,Y:!1}):i==="fit"&&this.callFit({X:!1,Y:!0})))},t.prototype.show=function(e,i){var r=this;if(this.wireEvents(),this.zIndex===1e3||!d(i)){var o=d(i)?this.element:i;this.zIndex=Ri(o),de(this.element,{zIndex:this.zIndex})}e=!d(e)&&typeof e=="object"?e:this.showAnimation,(this.collision.X!=="none"||this.collision.Y!=="none")&&(G([this.element],_e.CLOSE),W([this.element],_e.OPEN),this.checkCollision(),G([this.element],_e.OPEN),W([this.element],_e.CLOSE)),d(e)?(G([this.element],_e.CLOSE),W([this.element],_e.OPEN),this.trigger("open")):(e.begin=function(){r.isDestroyed||(G([r.element],_e.CLOSE),W([r.element],_e.OPEN))},e.end=function(){r.isDestroyed||r.trigger("open")},new ai(e).animate(this.element))},t.prototype.hide=function(e){var i=this;e=!d(e)&&typeof e=="object"?e:this.hideAnimation,d(e)?(G([this.element],_e.OPEN),W([this.element],_e.CLOSE),this.trigger("close")):(e.end=function(){i.isDestroyed||(G([i.element],_e.OPEN),W([i.element],_e.CLOSE),i.trigger("close"))},new ai(e).animate(this.element)),this.unwireEvents()},t.prototype.getScrollableParent=function(e){return this.checkFixedParent(e),Xf(e,this.fixedParent)},t.prototype.checkFixedParent=function(e){for(var i=e.parentElement;i&&i.tagName!=="HTML";){var r=getComputedStyle(i);(r.position==="fixed"||r.position==="sticky")&&!d(this.element)&&this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&getComputedStyle(this.element.offsetParent).overflow!=="hidden"&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top,10)?ee(window.scrollY-parseInt(this.element.style.top,10)):ee(parseInt(this.element.style.top,10)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),i=i.parentElement,!d(this.element)&&d(this.element.offsetParent)&&r.position==="fixed"&&this.element.style.position==="fixed"&&(this.fixedParent=!0)}},He([T("auto")],t.prototype,"height",void 0),He([T("auto")],t.prototype,"width",void 0),He([T(null)],t.prototype,"content",void 0),He([T("container")],t.prototype,"targetType",void 0),He([T(null)],t.prototype,"viewPortElement",void 0),He([T({X:"none",Y:"none"})],t.prototype,"collision",void 0),He([T("")],t.prototype,"relateTo",void 0),He([Ke({},Nh)],t.prototype,"position",void 0),He([T(0)],t.prototype,"offsetX",void 0),He([T(0)],t.prototype,"offsetY",void 0),He([T(1e3)],t.prototype,"zIndex",void 0),He([T(!1)],t.prototype,"enableRtl",void 0),He([T("reposition")],t.prototype,"actionOnScroll",void 0),He([T(null)],t.prototype,"showAnimation",void 0),He([T(null)],t.prototype,"hideAnimation",void 0),He([Y()],t.prototype,"open",void 0),He([Y()],t.prototype,"close",void 0),He([Y()],t.prototype,"targetExitViewport",void 0),t=He([Qe],t),t}(ct);function Xf(l,t){for(var e=getComputedStyle(l),i=[],r=/(auto|scroll)/,o=l.parentElement;o&&o.tagName!=="HTML";){var a=getComputedStyle(o);!(e.position==="absolute"&&a.position==="static")&&r.test(a.overflow+a.overflowY+a.overflowX)&&i.push(o),o=o.parentElement}return t||i.push(document),i}function Ri(l){for(var t=l.parentElement,e=[];t&&t.tagName!=="BODY";){var i=document.defaultView.getComputedStyle(t,null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(t,null).getPropertyValue("position");i!=="auto"&&r!=="static"&&e.push(i),t=t.parentElement}for(var o=[],a=0;a<document.body.children.length;a++)if(!l.isEqualNode(document.body.children[a])){var i=document.defaultView.getComputedStyle(document.body.children[a],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(document.body.children[a],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&o.push(i)}o.push("999");var n=[];if(!d(l.parentElement)&&l.parentElement.tagName!=="BODY"){for(var s=[].slice.call(l.parentElement.children),a=0;a<s.length;a++)if(!l.isEqualNode(s[a])){var i=document.defaultView.getComputedStyle(s[a],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(s[a],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&n.push(i)}}var h=e.concat(o,n),p=Math.max.apply(Math,h)+1;return p>2147483647?2147483647:p}function om(l,t,e,i,r,o){var a=i;if(i.tagName===t){var n=Z("ej2_instances",i);a=l("input",{attrs:{type:e}});for(var s=["change","cssClass","label","labelPosition","id"],h=0,p=i.attributes.length;h<p;h++)s.indexOf(i.attributes[h].nodeName)===-1&&a.setAttribute(i.attributes[h].nodeName,i.attributes[h].nodeValue);ge(i,{class:r}),i.appendChild(a),i.classList.add(o),i.classList.remove(o),Ae("ej2_instances",n,a),an(i,"ej2_instances")}return a}function Wf(l){for(var t,e=l.childNodes,i=0;i<e.length;i++)if(t=e[i],t.nodeType===3)return t;return null}function am(l,t,e){t===void 0&&(t=!1),e===void 0&&(e={});var i=l("div",{className:"e-checkbox-wrapper e-css"});if(e.cssClass&&W([i],e.cssClass.split(" ")),e.enableRtl&&i.classList.add("e-rtl"),t){var r=l("span",{className:"e-ripple-container"});jr(r,{isCenterRipple:!0,duration:400}),i.appendChild(r)}var o=l("span",{className:"e-frame e-icons"});if(e.checked&&o.classList.add("e-check"),i.appendChild(o),e.label){var a=l("span",{className:"e-label"});e.disableHtmlEncode?a.textContent=e.label:a.innerHTML=e.label,i.appendChild(a)}return i}function nm(l,t){if(t){var e=document.createEvent("MouseEvents");e.initEvent(l.type,!1,!0),t.dispatchEvent(e)}}function sm(l,t){l.element.getAttribute("ejs-for")&&t.appendChild(l.createElement("input",{attrs:{name:l.name||l.element.name,value:"false",type:"hidden"}}))}var Vf=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),It=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},hs;(function(l){l.Left="Left",l.Right="Right",l.Top="Top",l.Bottom="Bottom"})(hs||(hs={}));var vt={RTL:"e-rtl",BUTTON:"e-btn",PRIMARY:"e-primary",ICONBTN:"e-icon-btn"},Xi=function(l){Vf(t,l);function t(e,i){return l.call(this,e,i)||this}return t.prototype.preRender=function(){},t.prototype.render=function(){this.initialize(),this.removeRippleEffect=jr(this.element,{selector:"."+vt.BUTTON}),this.renderComplete()},t.prototype.initialize=function(){this.cssClass&&W([this.element],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPrimary&&this.element.classList.add(vt.PRIMARY);{if(this.content){var e=this.enableHtmlSanitizer?pt.sanitize(this.content):this.content;this.element.innerHTML=e}this.setIconCss()}this.enableRtl&&this.element.classList.add(vt.RTL),this.disabled?this.controlStatus(this.disabled):this.wireEvents()},t.prototype.controlStatus=function(e){this.element.disabled=e},t.prototype.setIconCss=function(){if(this.iconCss){var e=this.createElement("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?(e.classList.add("e-icon-"+this.iconPosition.toLowerCase()),(this.iconPosition==="Top"||this.iconPosition==="Bottom")&&this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add(vt.ICONBTN);var i=this.element.childNodes[0];i&&(this.iconPosition==="Left"||this.iconPosition==="Top")?this.element.insertBefore(e,i):this.element.appendChild(e)}},t.prototype.wireEvents=function(){this.isToggle&&b.add(this.element,"click",this.btnClickHandler,this)},t.prototype.unWireEvents=function(){this.isToggle&&b.remove(this.element,"click",this.btnClickHandler)},t.prototype.btnClickHandler=function(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")},t.prototype.destroy=function(){var e=[vt.PRIMARY,vt.RTL,vt.ICONBTN,"e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round","e-top-icon-btn","e-bottom-icon-btn"];this.cssClass&&(e=e.concat(this.cssClass.split(/\s+/).filter(function(r){return r.length>0}))),l.prototype.destroy.call(this),G([this.element],e),this.element.getAttribute("class")||this.element.removeAttribute("class"),this.disabled&&this.element.removeAttribute("disabled"),this.content&&(this.element.innerHTML=this.element.innerHTML.replace(this.content,""));var i=this.element.querySelector("span.e-btn-icon");i&&X(i),this.unWireEvents()},t.prototype.getModuleName=function(){return"btn"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.Inject=function(){},t.prototype.onPropertyChanged=function(e,i){for(var r=this.element.querySelector("span.e-btn-icon"),o=0,a=Object.keys(e);o<a.length;o++){var n=a[o];switch(n){case"isPrimary":e.isPrimary?this.element.classList.add(vt.PRIMARY):this.element.classList.remove(vt.PRIMARY);break;case"disabled":this.controlStatus(e.disabled);break;case"iconCss":{r=this.element.querySelector("span.e-btn-icon"),r?e.iconCss?(r.className="e-btn-icon "+e.iconCss,this.element.textContent.trim()&&(this.iconPosition==="Left"?r.classList.add("e-icon-left"):r.classList.add("e-icon-right"))):X(r):this.setIconCss();break}case"iconPosition":G([this.element],["e-top-icon-btn","e-bottom-icon-btn"]),r=this.element.querySelector("span.e-btn-icon"),r&&X(r),this.setIconCss();break;case"cssClass":i.cssClass&&G([this.element],i.cssClass.split(/\s+/).filter(function(h){return h.length>0})),e.cssClass&&W([this.element],e.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":e.enableRtl?this.element.classList.add(vt.RTL):this.element.classList.remove(vt.RTL);break;case"content":{var s=Wf(this.element);s||this.element.classList.remove(vt.ICONBTN),this.enableHtmlSanitizer&&(e.content=pt.sanitize(e.content)),this.element.innerHTML=e.content,this.setIconCss();break}case"isToggle":e.isToggle?b.add(this.element,"click",this.btnClickHandler,this):(b.remove(this.element,"click",this.btnClickHandler),G([this.element],["e-active"]));break}}},t.prototype.click=function(){this.element.click()},t.prototype.focusIn=function(){this.element.focus()},It([T("Left")],t.prototype,"iconPosition",void 0),It([T("")],t.prototype,"iconCss",void 0),It([T(!1)],t.prototype,"disabled",void 0),It([T(!1)],t.prototype,"isPrimary",void 0),It([T("")],t.prototype,"cssClass",void 0),It([T("")],t.prototype,"content",void 0),It([T(!1)],t.prototype,"isToggle",void 0),It([T()],t.prototype,"locale",void 0),It([T(!0)],t.prototype,"enableHtmlSanitizer",void 0),It([Y()],t.prototype,"created",void 0),t=It([Qe],t),t}(ct),Vo=["north-west","north","north-east","west","east","south-west","south","south-east"],xr="e-resize-handle",si="e-focused-handle",qf="e-dlg-resizable",ps=["e-restrict-left"],Dh="e-resize-viewport",_f=["north","west","east","south"],Me,Ot,Cn=0,Mn=0,wh=0,Oh=0,Nr=0,Dr=0,Bi,Zt,bn,Gt,ye,Wi=null,To=null,So=null,qt,No=!0,us=0,qo=!0;function Zf(l){Wi=l.resizeBegin,To=l.resizing,So=l.resizeComplete,Me=cs(l.element),ye=cs(l.boundary);for(var t=l.direction.split(" "),e=0;e<t.length;e++)if(_f.indexOf(t[e])>=0&&t[e])Gf(t[e]);else if(t[e].trim()!==""){var i=Ie("div",{className:"e-icons "+xr+" e-"+t[e]});Me.appendChild(i)}Bi=l.minHeight,bn=l.minWidth,Gt=l.maxWidth,Zt=l.maxHeight,l.proxy&&l.proxy.element&&l.proxy.element.classList.contains("e-dialog")?ds(l.proxy):ds()}function Gf(l){jn();var t=Ie("span",{attrs:{unselectable:"on",contenteditable:"false"}});t.setAttribute("class","e-dialog-border-resize e-"+l),l==="south"&&(t.style.height="2px",t.style.width="100%",t.style.bottom="0px",t.style.left="0px"),l==="north"&&(t.style.height="2px",t.style.width="100%",t.style.top="0px",t.style.left="0px"),l==="east"&&(t.style.height="100%",t.style.width="2px",t.style.right="0px",t.style.top="0px"),l==="west"&&(t.style.height="100%",t.style.width="2px",t.style.left="0px",t.style.top="0px"),Me.appendChild(t)}function cs(l){var t;return d(l)||(typeof l=="string"?t=document.querySelector(l):t=l),t}function ds(l){for(var t=l||this,e=Me.querySelectorAll("."+xr),i=0;i<e.length;i++){Ot=e[i],b.add(Ot,"mousedown",fs,t);var r=S.info.name==="msie"?"pointerdown":"touchstart";b.add(Ot,r,gs,t)}var o=Me.querySelectorAll(".e-dialog-border-resize");if(!d(o))for(var i=0;i<o.length;i++){Ot=o[i],b.add(Ot,"mousedown",fs,t);var r=S.info.name==="msie"?"pointerdown":"touchstart";b.add(Ot,r,gs,t)}}function xh(l){return l.indexOf("mouse")>-1?"mouse":"touch"}function fs(l){if(l.preventDefault(),Me=l.target.parentElement,jn(),Nr=l.pageX,Dr=l.pageY,l.target.classList.add(si),!d(Wi)){var t=this;if(Wi(l,t)===!0)return}this.targetEle&&Me&&Me.querySelector("."+qf)&&(ye=this.target==="body"?null:this.targetEle,Gt=this.targetEle.clientWidth,Zt=this.targetEle.clientHeight);var e=d(ye)?document:ye;b.add(e,"mousemove",Cr,this),b.add(document,"mouseup",Do,this);for(var i=0;i<ps.length;i++)Me.classList.contains(ps[i])?No=!1:No=!0}function Do(l){var t=S.info.name==="msie"?"pointermove":"touchmove",e=S.info.name==="msie"?"pointerup":"touchend",i=d(ye)?document:ye,r=S.info.name==="msie"?"pointerdown":"touchstart";if(b.remove(i,"mousemove",Cr),b.remove(i,t,Cr),b.remove(i,r,Cr),d(document.body.querySelector("."+si))||document.body.querySelector("."+si).classList.remove(si),!d(So)){var o=this;So(l,o)}b.remove(document,"mouseup",Do),b.remove(document,e,Do)}function jn(){Cn=parseFloat(getComputedStyle(Me,null).getPropertyValue("width").replace("px","")),Mn=parseFloat(getComputedStyle(Me,null).getPropertyValue("height").replace("px","")),wh=Me.getBoundingClientRect().left,Oh=Me.getBoundingClientRect().top}function gs(l){Me=l.target.parentElement,jn();var t=Me.classList.contains("e-dialog");(l.target.classList.contains(xr)||l.target.classList.contains("e-dialog-border-resize"))&&t&&l.target.classList.add(si);var e=l.touches?l.changedTouches[0]:l;if(Nr=e.pageX,Dr=e.pageY,!d(Wi)){var i=this;if(Wi(l,i)===!0)return}var r=S.info.name==="msie"?"pointermove":"touchmove",o=S.info.name==="msie"?"pointerup":"touchend",a=d(ye)?document:ye;b.add(a,r,Cr,this),b.add(document,o,Do,this)}function Cr(l){if(l.target.classList.contains(xr)&&l.target.classList.contains(si)?Ot=l.target:d(document.body.querySelector("."+si))||(Ot=document.body.querySelector("."+si)),!d(Ot)){for(var t="",e=0;e<Vo.length;e++)Ot.classList.contains("e-"+Vo[e])&&(t=Vo[e]);if(!d(To)){var i=this;To(l,i)}switch(t){case"south":_o(l);break;case"north":Zo(l);break;case"west":Go(l);break;case"east":Jo(l);break;case"south-east":_o(l),Jo(l);break;case"south-west":_o(l),Go(l);break;case"north-east":Zo(l),Jo(l);break;case"north-west":Zo(l),Go(l);break}}}function hi(l){return l.getBoundingClientRect()}function _o(l){var t=document.documentElement.clientHeight,e=!1,i=l.touches?l.changedTouches[0]:l,r=i.pageY,o=hi(Me),a;d(ye)||(a=hi(ye)),d(ye)?d(ye)&&(t-r>=0||o.top<0)&&(e=!0):e=!0;var n=Mn+(r-Dr);n=n>Bi?n:Bi;var s=0;d(ye)||(s=a.top);var h=d(ye)?0:ye.offsetHeight-ye.clientHeight,p=o.top-s-h/2;if(p=p<0?0:p,o.top>0&&p+n>Zt){if(e=!1,Me.classList.contains(Dh))return;Me.style.height=Zt-parseInt(p.toString(),10)+"px";return}var u=0;if(e){o.top<0&&t+(o.height+o.top)>0&&(u=o.top,n+u<=30&&(n=o.height-(o.height+o.top)+30)),n+o.top>=Zt&&(Me.style.height=o.height+(t-(o.height+o.top))+"px");var c=d(ye)?u:p;n>=Bi&&n+c<=Zt&&(Me.style.height=n+"px")}}function Zo(l){var t=!1,e,i=xh(l.type)==="mouse"?l.pageY:l.touches[0].pageY,r=hi(Me),o=d(ye)?0:ye.offsetHeight-ye.clientHeight;d(ye)||(e=hi(ye)),(!d(ye)&&r.top-e.top>0||d(ye)&&i>0||!d(ye)&&Math.floor(r.top-e.top+r.height+(e.bottom-r.bottom))-o<=Zt)&&(t=!0);var a=Mn-(i-Dr);if(t&&a>=Bi&&a<=Zt){var n=0;d(ye)||(n=e.top);var s=Oh-n+(i-Dr);s=s>0?s:1,Me.style.height=a+"px",Me.style.top=s+"px"}}function Go(l){var t=document.documentElement.clientWidth,e=!1,i;d(ye)||(i=hi(ye));var r=xh(l.type)==="mouse"?l.pageX:l.touches[0].pageX,o=hi(Me),a=d(ye)?0:ye.offsetWidth-ye.clientWidth,n=d(ye)?0:i.left,s=d(ye)?0:i.width;d(qt)&&(d(ye)?qt=t:(qt=o.left-n-a/2+o.width,qt=qt+(s-a-qt))),(!d(ye)&&Math.floor(o.left-i.left+o.width+(i.right-o.right))-a<=Gt||d(ye)&&r>=0)&&(e=!0);var h=Cn-(r-Nr);if(No&&(h=h>qt?qt:h),e&&h>=bn&&h<=Gt){var p=0;d(ye)||(p=i.left);var u=wh-p+(r-Nr);u=u>0?u:1,h!==us&&qo&&(Me.style.width=h+"px"),No&&(Me.style.left=u+"px",u===1?qo=!1:qo=!0)}us=h}function Jo(l){var t=document.documentElement.clientWidth,e=!1,i;d(ye)||(i=hi(ye));var r=l.touches?l.changedTouches[0]:l,o=r.pageX,a=hi(Me);(!d(ye)&&(a.left-i.left+a.width<=Gt||a.right-i.left>=a.width)||d(ye)&&t-o>0)&&(e=!0);var n=Cn+(o-Nr),s=0;if(d(ye)||(s=i.left),a.left-s+n>Gt){if(e=!1,Me.classList.contains(Dh))return;Me.style.width=Gt-(a.left-s)+"px"}e&&n>=bn&&n<=Gt&&(Me.style.width=n+"px")}function Jf(l){Bi=l}function Kf(l){Gt=l}function $f(l){Zt=l}function vs(){for(var l=Me.querySelectorAll("."+xr),t=0;t<l.length;t++)X(l[t]);var e=Me.querySelectorAll(".e-dialog-border-resize");if(!d(e))for(var t=0;t<e.length;t++)X(e[t])}function eg(){Me=null,Ot=null,ye=null,qt=null,Wi=null,To=null,So=null}var In=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ve=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},tg=function(l){In(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return ve([T(!0)],t.prototype,"isFlat",void 0),ve([T()],t.prototype,"buttonModel",void 0),ve([T("Button")],t.prototype,"type",void 0),ve([Y()],t.prototype,"click",void 0),t}(Be),ig=function(l){In(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return ve([T("Fade")],t.prototype,"effect",void 0),ve([T(400)],t.prototype,"duration",void 0),ve([T(0)],t.prototype,"delay",void 0),t}(Be),Rr="e-dialog",Ko="e-rtl",$o="e-dlg-header-content",ys="e-dlg-header",Br="e-footer-content",Hr="e-dlg-modal",rg="e-dlg-content",ms="e-icon-dlg-close",og="e-dlg-overlay",Tt="e-dlg-target",ag="e-dlg-container",yt="e-scroll-disabled",ng="e-primary",sg="e-icons",lg="e-popup",Cs="e-device",Qr="e-dlg-fullscreen",Ms="e-dlg-closeicon-btn",hg="e-popup-close",bs="e-popup-open",js="Information",Is="e-scroll-disabled",Ah="e-alert-dialog",zh="e-confirm-dialog",ea="e-dlg-resizable",Ti="e-restrict-left",Ts="e-resize-viewport",pg="e-dlg-ref-element",ta="user action",ug="close icon",cg="escape",dg="overlayClick",fg="e-draggable",Ao=function(l){In(t,l);function t(e,i){var r=l.call(this,e,i)||this;return r.needsID=!0,r}return t.prototype.render=function(){this.initialize(),this.initRender(),this.wireEvents(),this.width==="100%"&&(this.element.style.width=""),this.minHeight!==""&&(this.element.style.minHeight=ee(this.minHeight)),this.enableResize&&(this.setResize(),this.isModal&&(this.isModelResize=!0),this.animationSettings.effect==="None"&&this.getMinHeight()),this.renderComplete()},t.prototype.initializeValue=function(){this.dlgClosedBy=ta},t.prototype.preRender=function(){var e=this;this.initializeValue(),this.headerContent=null,this.allowMaxHeight=!0,this.preventVisibility=!0,this.clonedEle=this.element.cloneNode(!0),this.closeIconClickEventHandler=function(o){e.dlgClosedBy=ug,e.hide(o)},this.dlgOverlayClickEventHandler=function(o){e.dlgClosedBy=dg,o.preventFocus=!1,e.trigger("overlayClick",o,function(a){a.preventFocus||e.focusContent(),e.dlgClosedBy=ta})};var i={close:"Close"};if(this.l10n=new Mi("dialog",i,this.locale),this.checkPositionData(),d(this.target)){var r=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.target=document.body,this.isProtectedOnChange=r}},t.prototype.updatePersistData=function(){this.enablePersistence&&this.setProperties({width:parseFloat(this.element.style.width),height:parseFloat(this.element.style.height),position:{X:parseFloat(this.dragObj.element.style.left),Y:parseFloat(this.dragObj.element.style.top)}},!0)},t.prototype.isNumberValue=function(e){var i=/^[-+]?\d*\.?\d+$/.test(e);return i},t.prototype.checkPositionData=function(){if(!d(this.position)){if(!d(this.position.X)&&typeof this.position.X!="number"){var e=this.isNumberValue(this.position.X);if(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.X=parseFloat(this.position.X),this.isProtectedOnChange=i}}if(!d(this.position.Y)&&typeof this.position.Y!="number"){var e=this.isNumberValue(this.position.Y);if(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.Y=parseFloat(this.position.Y),this.isProtectedOnChange=i}}}},t.prototype.getEle=function(e,i){for(var r=void 0,o=0;o<e.length;o++)if(e[o].classList.contains(i)){r=e[o];break}return r},t.prototype.getMinHeight=function(){var e="0px",i="0px";d(this.element.querySelector("."+$o))||(e=getComputedStyle(this.headerContent).height);var r=this.getEle(this.element.children,Br);d(r)||(i=getComputedStyle(r).height);var o=parseInt(e.slice(0,e.indexOf("p")),10),a=parseInt(i.slice(0,i.indexOf("p")),10);return Jf(o+30+(isNaN(a)?0:a)),o+30+a},t.prototype.onResizeStart=function(e,i){if(i.trigger("resizeStart",e),!e.cancel&&this.isModelResize&&!d(this.dlgContainer)&&this.dlgContainer.classList.contains("e-dlg-"+this.position.X+"-"+this.position.Y)){this.setPopupPosition(),this.dlgContainer.classList.remove("e-dlg-"+this.position.X+"-"+this.position.Y);var r=this.getTargetContainer(this.target);if(r instanceof Element){var o=window.getComputedStyle(r);o.getPropertyValue("direction")==="rtl"?this.element.style.position="absolute":this.element.style.position="relative"}else this.element.style.position="relative";this.element.classList.contains(Ti)&&this.element.classList.remove(Ti),this.isModelResize=!1}return e.cancel},t.prototype.onResizing=function(e,i){i.trigger("resizing",e)},t.prototype.onResizeComplete=function(e,i){i.trigger("resizeStop",e),this.updatePersistData()},t.prototype.setResize=function(){if(this.enableResize){this.element.classList.add(ea);for(var e=getComputedStyle(this.element).minHeight,i=getComputedStyle(this.element).minWidth,r="",o=0;o<this.resizeHandles.length;o++)if(this.resizeHandles[o]==="All"){r="south north east west north-east north-west south-east south-west";break}else{var a="";switch(this.resizeHandles[o].toString()){case"SouthEast":a="south-east";break;case"SouthWest":a="south-west";break;case"NorthEast":a="north-east";break;case"NorthWest":a="north-west";break;default:a=this.resizeHandles[o].toString();break}r+=a.toLocaleLowerCase()+" "}this.enableRtl&&r.trim()==="south-east"?r="south-west":this.enableRtl&&r.trim()==="south-west"&&(r="south-east"),this.isModal&&this.enableRtl?this.element.classList.add(Ti):this.isModal&&this.target===document.body&&this.element.classList.add(Ts),Zf({element:this.element,direction:r,minHeight:parseInt(e.slice(0,i.indexOf("p")),10),maxHeight:this.targetEle.clientHeight,minWidth:parseInt(i.slice(0,i.indexOf("p")),10),maxWidth:this.targetEle.clientWidth,boundary:this.target===document.body?null:this.targetEle,resizeBegin:this.onResizeStart.bind(this),resizeComplete:this.onResizeComplete.bind(this),resizing:this.onResizing.bind(this),proxy:this}),this.wireWindowResizeEvent()}else vs(),this.unWireWindowResizeEvent(),this.isModal?this.element.classList.remove(Ti):this.element.classList.remove(Ts),this.element.classList.remove(ea)},t.prototype.getFocusElement=function(e){var i='input,select,textarea,button:enabled,a,[contenteditable="true"],[tabindex]',r=e.querySelectorAll(i);return{element:r[r.length-1]}},t.prototype.keyDown=function(e){var i=this;if(e.keyCode===9&&this.isModal){var r=void 0;d(this.btnObj)||(r=this.btnObj[this.btnObj.length-1]),d(this.btnObj)&&!d(this.ftrTemplateContent)&&(r=this.getFocusElement(this.ftrTemplateContent)),d(this.btnObj)&&d(this.ftrTemplateContent)&&!d(this.contentEle)&&(r=this.getFocusElement(this.contentEle)),!d(r)&&document.activeElement===r.element&&!e.shiftKey&&(e.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&e.shiftKey&&(e.preventDefault(),d(r)||r.element.focus())}var o=document.activeElement,a=["input","textarea"].indexOf(o.tagName.toLowerCase())>-1,n=!1;if(a||(n=o.hasAttribute("contenteditable")&&o.getAttribute("contenteditable")==="true"),e.keyCode===27&&this.closeOnEscape){this.dlgClosedBy=cg;var s=document.querySelector(".e-popup-open:not(.e-dialog)");!d(s)&&!s.classList.contains("e-toolbar-pop")&&!s.classList.contains("e-slider-tooltip")||this.hide(e)}if(e.keyCode===13&&!e.ctrlKey&&o.tagName.toLowerCase()!=="textarea"&&a&&!d(this.primaryButtonEle)||e.keyCode===13&&e.ctrlKey&&(o.tagName.toLowerCase()==="textarea"||n)&&!d(this.primaryButtonEle)){var h,p=this.buttons.some(function(u,c){h=c;var f=u.buttonModel;return!d(f)&&f.isPrimary===!0});p&&typeof this.buttons[h].click=="function"&&!this.primaryButtonEle.disabled&&setTimeout(function(){i.buttons[h].click.call(i,e)})}},t.prototype.initialize=function(){d(this.target)||(this.targetEle=typeof this.target=="string"?document.querySelector(this.target):this.target),this.isBlazorServerRender()||W([this.element],Rr),S.isDevice&&W([this.element],Cs),this.isBlazorServerRender()||this.setCSSClass(),this.setMaxHeight()},t.prototype.initRender=function(){var e=this;if(this.initialRender=!0,this.isBlazorServerRender()||ge(this.element,{role:"dialog"}),this.zIndex===1e3?(this.setzIndex(this.element,!1),this.calculatezIndex=!0):this.calculatezIndex=!1,this.setTargetContent(),this.header!==""&&!d(this.header)&&this.setHeader(),this.renderCloseIcon(),this.setContent(),this.footerTemplate!==""&&!d(this.footerTemplate)?this.setFooterTemplate():!d(this.buttons[0])&&!d(this.buttons[0].buttonModel)&&this.setButton(),this.allowDragging&&!d(this.headerContent)&&this.setAllowDragging(),ge(this.element,{"aria-modal":this.isModal?"true":"false"}),this.isModal&&this.setIsModal(),this.element.classList.contains(Ah)!==!0&&this.element.classList.contains(zh)!==!0&&!d(this.element.parentElement)){var i=this.isModal?this.dlgContainer.parentElement:this.element.parentElement;this.refElement=this.createElement("div",{className:pg}),i.insertBefore(this.refElement,this.isModal?this.dlgContainer:this.element)}if(d(this.targetEle)||(this.isModal?this.targetEle.appendChild(this.dlgContainer):this.targetEle.appendChild(this.element)),this.popupObj=new Or(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.target,actionOnScroll:"none",enableRtl:this.enableRtl,open:function(a){var n={container:e.isModal?e.dlgContainer:e.element,element:e.element,target:e.target,preventFocus:!1};e.enableResize&&e.resetResizeIcon(),e.trigger("open",n,function(s){s.preventFocus||e.focusContent()})},close:function(a){e.isModal&&W([e.dlgOverlay],"e-fade"),e.unBindEvent(e.element),e.isModal&&(e.dlgContainer.style.display="none"),e.trigger("close",e.closeArgs);var n=document.activeElement;!d(n)&&!d(n.blur)&&n.blur(),!d(e.storeActiveElement)&&!d(e.storeActiveElement.focus)&&e.storeActiveElement.focus()}}),this.positionChange(),this.setEnableRTL(),this.isBlazorServerRender()||(W([this.element],hg),this.isModal&&this.setOverlayZindex()),this.visible){if(this.show(),this.isModal){var r=this.getTargetContainer(this.target);if(r instanceof Element){var o=window.getComputedStyle(r);o.getPropertyValue("direction")==="rtl"&&this.setPopupPosition()}}}else this.isModal&&(this.dlgOverlay.style.display="none");this.initialRender=!1},t.prototype.getTargetContainer=function(e){var i=null;if(typeof e=="string")if(e.startsWith("#"))i=document.getElementById(e.substring(1));else if(e.startsWith(".")){var r=document.getElementsByClassName(e.substring(1));i=r.length>0?r[0]:null}else!(e instanceof HTMLElement)&&e!==document.body&&(i=document.querySelector(e));else e instanceof HTMLElement&&(i=e);return i},t.prototype.resetResizeIcon=function(){var e=this.getMinHeight();if(this.targetEle.offsetHeight<e){var i=this.enableRtl?"e-south-west":"e-south-east",r=this.element.querySelector("."+i);d(r)||(r.style.bottom="-"+e.toString()+"px")}},t.prototype.setOverlayZindex=function(e){var i;d(e)?i=parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:i=e,this.dlgOverlay.style.zIndex=(i-1).toString(),this.dlgContainer.style.zIndex=i.toString()},t.prototype.positionChange=function(){this.isModal?!isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():!isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))||isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()},t.prototype.setPopupPosition=function(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})},t.prototype.setAllowDragging=function(){var e=this,i="."+$o;this.element.classList.contains(fg)||(this.dragObj=new hf(this.element,{clone:!1,isDragScroll:!0,abort:".e-dlg-closeicon-btn",handle:i,dragStart:function(r){e.trigger("dragStart",r,function(o){})},dragStop:function(r){if(e.isModal){e.IsDragStop=!0,d(e.position)||e.dlgContainer.classList.remove("e-dlg-"+e.position.X+"-"+e.position.Y);var o=e.getTargetContainer(e.target);if(o instanceof Element){var a=window.getComputedStyle(o);a.getPropertyValue("direction")==="rtl"?e.element.style.position="absolute":e.element.style.position="relative"}else e.element.style.position="relative"}e.trigger("dragStop",r),e.isModelResize=!1,e.element.classList.remove(Ti),e.updatePersistData()},drag:function(r){e.trigger("drag",r)}}),d(this.targetEle)||(this.dragObj.dragArea=this.targetEle))},t.prototype.setButton=function(){if(!this.isBlazorServerRender()){this.buttonContent=[],this.btnObj=[];for(var e=0;e<this.buttons.length;e++)if(!d(this.buttons[e].buttonModel)){var i=d(this.buttons[e].type)?"button":this.buttons[e].type.toLowerCase(),r=this.createElement("button",{className:this.cssClass,attrs:{type:i,tabindex:"0"}});this.buttonContent.push(r.outerHTML)}this.setFooterTemplate()}for(var o,e=0,a=this.element.children;e<a.length;e++)a[e].classList.contains(Br)&&(o=a[e].querySelectorAll("button"));for(var e=0;e<this.buttons.length;e++)d(this.buttons[e].buttonModel)||(this.isBlazorServerRender()||(this.btnObj[e]=new Xi(this.buttons[e].buttonModel)),!d(this.ftrTemplateContent)&&o.length>0&&(typeof this.buttons[e].click=="function"&&b.add(o[e],"click",this.buttons[e].click,this),typeof this.buttons[e].click=="object"&&b.add(o[e],"click",this.buttonClickHandler.bind(this,e),this)),!this.isBlazorServerRender()&&!d(this.ftrTemplateContent)&&(this.btnObj[e].appendTo(this.ftrTemplateContent.children[e]),this.buttons[e].isFlat&&this.btnObj[e].element.classList.add("e-flat"),this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0]))},t.prototype.buttonClickHandler=function(e){this.trigger("buttons["+e+"].click",{})},t.prototype.setContent=function(){this.contentEle=this.createElement("div",{className:rg,id:this.element.id+"_dialog-content"}),this.headerEle?ge(this.element,{"aria-describedby":this.element.id+"_title "+this.element.id+"_dialog-content"}):ge(this.element,{"aria-describedby":this.element.id+"_dialog-content"}),this.innerContentElement?this.contentEle.appendChild(this.innerContentElement):(!d(this.content)&&this.content!==""||!this.initialRender)&&(typeof this.content=="string"?this.setTemplate(this.content,this.contentEle,"content"):this.content instanceof HTMLElement?this.contentEle.appendChild(this.content):this.setTemplate(this.content,this.contentEle,"content")),d(this.headerContent)?this.element.insertBefore(this.contentEle,this.element.children[0]):this.element.insertBefore(this.contentEle,this.element.children[1]),this.height==="auto"&&(!this.isBlazorServerRender()&&S.isIE&&this.element.style.width===""&&!d(this.width)&&(this.element.style.width=ee(this.width)),this.setMaxHeight())},t.prototype.setTemplate=function(e,i,r){var o,a;i.classList.contains(ys)?a=this.element.id+"header":i.classList.contains(Br)?a=this.element.id+"footerTemplate":a=this.element.id+"content",d(e.outerHTML)?(typeof e=="string"||typeof e!="string"||Hi())&&(typeof e=="string"&&(e=this.sanitizeHelper(e)),this.isVue||typeof e!="string"?o=ht(e):i.innerHTML=e):i.appendChild(e);var n=[];if(!d(o)){for(var s=!0,h=0,p=o({},this,r,a,s);h<p.length;h++){var u=p[h];n.push(u)}Qi([].slice.call(n),i)}},t.prototype.sanitizeHelper=function(e){if(this.enableHtmlSanitizer){var i=pt.beforeSanitize(),r={cancel:!1,helper:null};y(i,i,r),this.trigger("beforeSanitizeHtml",i),i.cancel&&!d(i.helper)?e=i.helper(e):i.cancel||(e=pt.serializeValue(i,e))}return e},t.prototype.setMaxHeight=function(){if(this.allowMaxHeight){var e=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=!d(this.target)&&this.targetEle.offsetHeight<window.innerHeight?this.targetEle.offsetHeight-20+"px":window.innerHeight-20+"px",this.element.style.display=e,S.isIE&&this.height==="auto"&&!d(this.contentEle)&&this.element.offsetHeight<this.contentEle.offsetHeight&&(this.element.style.height="inherit")}},t.prototype.setEnableRTL=function(){this.isBlazorServerRender()||(this.enableRtl?W([this.element],Ko):G([this.element],Ko)),d(this.element.querySelector(".e-resize-handle"))||(vs(),this.setResize())},t.prototype.setTargetContent=function(){var e=this;if(d(this.content)||this.content===""){var i=this.element.innerHTML.replace(/\s|<(\/?|\/?)(!--!--)>/g,"")!=="";(this.element.children.length>0||i)&&(this.innerContentElement=document.createDocumentFragment(),[].slice.call(this.element.childNodes).forEach(function(r){r.nodeType!==8&&e.innerContentElement.appendChild(r)}))}},t.prototype.setHeader=function(){this.headerEle?this.headerEle.innerHTML="":this.headerEle=this.createElement("div",{id:this.element.id+"_title",className:ys}),this.createHeaderContent(),this.headerContent.appendChild(this.headerEle),this.setTemplate(this.header,this.headerEle,"header"),ge(this.element,{"aria-describedby":this.element.id+"_title"}),ge(this.element,{"aria-labelledby":this.element.id+"_dialog-header"}),this.element.insertBefore(this.headerContent,this.element.children[0]),this.allowDragging&&!d(this.headerContent)&&this.setAllowDragging()},t.prototype.setFooterTemplate=function(){this.ftrTemplateContent?this.ftrTemplateContent.innerHTML="":this.ftrTemplateContent=this.createElement("div",{className:Br}),this.footerTemplate!==""&&!d(this.footerTemplate)?this.setTemplate(this.footerTemplate,this.ftrTemplateContent,"footerTemplate"):this.ftrTemplateContent.innerHTML=this.buttonContent.join(""),this.element.appendChild(this.ftrTemplateContent)},t.prototype.createHeaderContent=function(){d(this.headerContent)&&(this.headerContent=this.createElement("div",{id:this.element.id+"_dialog-header",className:$o}))},t.prototype.renderCloseIcon=function(){this.showCloseIcon&&(this.closeIcon=this.createElement("button",{className:Ms,attrs:{type:"button"}}),this.closeIconBtnObj=new Xi({cssClass:"e-flat",iconCss:ms+" "+sg}),this.closeIconTitle(),d(this.headerContent)?(this.createHeaderContent(),Hn([this.closeIcon],this.headerContent),this.element.insertBefore(this.headerContent,this.element.children[0])):Hn([this.closeIcon],this.headerContent),this.closeIconBtnObj.appendTo(this.closeIcon))},t.prototype.closeIconTitle=function(){this.l10n.setLocale(this.locale);var e=this.l10n.getConstant("close");this.closeIcon.setAttribute("title",e),this.closeIcon.setAttribute("aria-label",e)},t.prototype.setCSSClass=function(e){e&&(G([this.element],e.split(" ")),this.isModal&&!d(this.dlgContainer)&&G([this.dlgContainer],e.split(" "))),this.cssClass&&(W([this.element],this.cssClass.split(" ")),this.isModal&&!d(this.dlgContainer)&&W([this.dlgContainer],this.cssClass.split(" ")))},t.prototype.setIsModal=function(){this.dlgContainer=this.createElement("div",{className:ag}),this.setCSSClass(),this.element.classList.remove(bs),this.element.parentNode.insertBefore(this.dlgContainer,this.element),this.dlgContainer.appendChild(this.element),W([this.element],Hr),this.dlgOverlay=this.createElement("div",{className:og}),this.dlgOverlay.style.zIndex=(this.zIndex-1).toString(),this.dlgContainer.appendChild(this.dlgOverlay)},t.prototype.getValidFocusNode=function(e){for(var i,r=0;r<e.length;r++){if(i=e[r],(i.clientHeight>0||i.tagName.toLowerCase()==="a"&&i.hasAttribute("href"))&&i.tabIndex>-1&&!i.disabled&&!this.disableElement(i,'[disabled],[aria-disabled="true"],[type="hidden"]'))return i;i=null}return i},t.prototype.focusableElements=function(e){if(!d(e)){var i='input,select,textarea,button,a,[contenteditable="true"],[tabindex]',r=e.querySelectorAll(i);return this.getValidFocusNode(r)}return null},t.prototype.getAutoFocusNode=function(e){var i=e.querySelector("."+Ms),r="[autofocus]",o=e.querySelectorAll(r),a=this.getValidFocusNode(o);if(!d(a))i=a;else if(a=this.focusableElements(this.contentEle),d(a)){if(!d(this.primaryButtonEle))return this.element.querySelector("."+ng)}else return i=a;return i},t.prototype.disableElement=function(e,i){var r=e?e.matches||e.webkitMatchesSelector||e.msGetRegionContent:null;if(r){for(;e;e=e.parentNode)if(e instanceof Element&&r.call(e,i))return e}return null},t.prototype.focusContent=function(){var e=this.getAutoFocusNode(this.element),i=d(e)?this.element:e,r=S.userAgent;(r.indexOf("MSIE ")>0||r.indexOf("Trident/")>0)&&this.element.focus(),i.focus(),this.unBindEvent(this.element),this.bindEvent(this.element)},t.prototype.bindEvent=function(e){b.add(e,"keydown",this.keyDown,this)},t.prototype.unBindEvent=function(e){b.remove(e,"keydown",this.keyDown)},t.prototype.updateSanitizeContent=function(){this.isBlazorServerRender()||(this.contentEle.innerHTML=this.sanitizeHelper(this.content))},t.prototype.isBlazorServerRender=function(){return Hi()},t.prototype.getModuleName=function(){return"dialog"},t.prototype.onPropertyChanged=function(e,i){if(this.element.classList.contains(Rr))for(var r=0,o=Object.keys(e);r<o.length;r++){var a=o[r];switch(a){case"content":!d(this.content)&&this.content!==""?(this.isBlazorServerRender()&&(this.contentEle=this.element.querySelector(".e-dlg-content")),!d(this.contentEle)&&this.contentEle.getAttribute("role")!=="dialog"?(this.isBlazorServerRender()||(this.contentEle.innerHTML=""),typeof this.content=="function"?(this.clearTemplate(["content"]),X(this.contentEle),this.contentEle=null,this.setContent()):typeof this.content=="string"?this.updateSanitizeContent():this.contentEle.appendChild(this.content),this.setMaxHeight()):this.setContent()):d(this.contentEle)||(X(this.contentEle),this.contentEle=null);break;case"header":this.header===""||d(this.header)?this.headerEle&&(X(this.headerEle),this.headerEle=null):this.setHeader();break;case"footerTemplate":if(this.footerTemplate===""||d(this.footerTemplate)){if(!this.ftrTemplateContent)return;X(this.ftrTemplateContent),this.ftrTemplateContent=null,this.buttons=[{}]}else this.setFooterTemplate(),this.buttons=[{}];break;case"showCloseIcon":this.element.getElementsByClassName(ms).length>0?!this.showCloseIcon&&(this.header===""||d(this.header))?(X(this.headerContent),this.headerContent=null):this.showCloseIcon||X(this.closeIcon):(this.renderCloseIcon(),this.wireEvents());break;case"locale":this.showCloseIcon&&this.closeIconTitle();break;case"visible":this.visible?this.show():this.hide();break;case"isModal":this.updateIsModal();break;case"height":de(this.element,{height:ee(e.height)}),this.updatePersistData();break;case"width":de(this.element,{width:ee(e.width)}),this.updatePersistData();break;case"zIndex":this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex),this.element.style.zIndex!==this.zIndex.toString()&&(this.calculatezIndex=!1);break;case"cssClass":this.setCSSClass(i.cssClass);break;case"buttons":{this.unWireButtonEvents(),this.destroyButtons(),d(this.ftrTemplateContent)||(X(this.ftrTemplateContent),this.ftrTemplateContent=null),this.footerTemplate="",this.setButton();break}case"allowDragging":this.allowDragging&&!d(this.headerContent)?this.setAllowDragging():this.dragObj.destroy();break;case"target":this.setTarget(e.target);break;case"position":if(this.checkPositionData(),this.isModal){var n=this.position.X,s=this.position.Y;d(i.position)||(d(i.position.X)||(n=i.position.X),d(i.position.Y)||(s=i.position.Y)),this.dlgContainer.classList.contains("e-dlg-"+n+"-"+s)&&this.dlgContainer.classList.remove("e-dlg-"+n+"-"+s)}this.positionChange(),this.updatePersistData();break;case"enableRtl":this.setEnableRTL();break;case"enableResize":this.setResize(),this.isModelResize=this.enableResize&&this.isModal,this.enableResize&&this.dialogOpen&&this.resetResizeIcon();break;case"minHeight":this.minHeight!==""&&(this.element.style.minHeight=ee(this.minHeight));break}}},t.prototype.setTarget=function(e){this.popupObj.relateTo=e,this.target=e,this.targetEle=typeof this.target=="string"?document.querySelector(this.target):this.target,this.dragObj&&(this.dragObj.dragArea=this.targetEle),this.setMaxHeight(),this.isModal&&this.updateIsModal(),this.enableResize&&this.setResize(),d(this.targetEle)||(this.isModal&&!d(this.dlgContainer)?this.targetEle.appendChild(this.dlgContainer):d(this.element)||this.targetEle.appendChild(this.element))},t.prototype.updateIsModal=function(){if(this.element.setAttribute("aria-modal",this.isModal?"true":"false"),this.isModal)d(this.dlgOverlay)&&(this.setIsModal(),this.element.style.top="0px",this.element.style.left="0px",d(this.targetEle)||this.targetEle.appendChild(this.dlgContainer));else{for(G([this.element],Hr),G([document.body],[Tt,yt]),X(this.dlgOverlay);this.dlgContainer.firstChild;)this.dlgContainer.parentElement.insertBefore(this.dlgContainer.firstChild,this.dlgContainer);this.dlgContainer.parentElement.removeChild(this.dlgContainer)}this.visible&&this.show(),this.positionChange(),this.isModal&&this.dlgOverlay&&b.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},t.prototype.setzIndex=function(e,i){var r=this.isProtectedOnChange;this.isProtectedOnChange=!0;var o=Ri(e);this.zIndex=o>this.zIndex?o:this.zIndex,this.isProtectedOnChange=r,i&&(this.popupObj.zIndex=this.zIndex)},t.prototype.windowResizeHandler=function(){Kf(this.targetEle.clientWidth),$f(this.targetEle.clientHeight),this.setMaxHeight()},t.prototype.getPersistData=function(){return this.addOnPersist(["width","height","position"])},t.prototype.removeAllChildren=function(e){for(;e.children[0];)this.removeAllChildren(e.children[0]),e.removeChild(e.children[0])},t.prototype.destroy=function(){if(!this.isDestroyed){var e=[Ko,Hr,ea,Ti,Qr,Cs],i=["role","aria-modal","aria-labelledby","aria-describedby","aria-grabbed","tabindex","style"];G([this.targetEle],[Tt,yt]),!d(this.element)&&this.element.classList.contains(Qr)&&G([document.body],[Tt,yt]),this.isModal&&G([d(this.targetEle)?document.body:this.targetEle],yt),this.unWireEvents(),this.unWireButtonEvents(),this.destroyButtons(),d(this.closeIconBtnObj)||this.closeIconBtnObj.destroy(),d(this.dragObj)||this.dragObj.destroy(),!d(this.popupObj.element)&&this.popupObj.element.classList.contains(lg)&&this.popupObj.destroy(),G([this.element],e),!d(this.cssClass)&&this.cssClass!==""&&G([this.element],this.cssClass.split(" ")),!d(this.refElement)&&!d(this.refElement.parentElement)&&(this.refElement.parentElement.insertBefore(this.isModal?this.dlgContainer:this.element,this.refElement),X(this.refElement),this.refElement=void 0),this.isModal&&(X(this.dlgOverlay),this.dlgContainer.parentNode.insertBefore(this.element,this.dlgContainer),X(this.dlgContainer)),this.element.innerHTML=this.clonedEle.innerHTML;for(var r=0;r<i.length;r++)this.element.removeAttribute(i[r]);this.ftrTemplateContent=null,this.headerContent=null,!this.isReact&&!this.isVue&&!d(this.contentEle)&&this.removeAllChildren(this.contentEle),this.contentEle=null,eg(),l.prototype.destroy.call(this),this.isReact&&this.clearTemplate()}},t.prototype.wireWindowResizeEvent=function(){this.boundWindowResizeHandler=this.windowResizeHandler.bind(this),window.addEventListener("resize",this.boundWindowResizeHandler)},t.prototype.unWireWindowResizeEvent=function(){window.removeEventListener("resize",this.boundWindowResizeHandler),this.boundWindowResizeHandler=null},t.prototype.wireEvents=function(){this.showCloseIcon&&b.add(this.closeIcon,"click",this.closeIconClickEventHandler,this),this.isModal&&this.dlgOverlay&&b.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},t.prototype.unWireEvents=function(){this.showCloseIcon&&b.remove(this.closeIcon,"click",this.closeIconClickEventHandler),this.isModal&&b.remove(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler)},t.prototype.refreshPosition=function(){this.popupObj.refreshPosition(),this.element.classList.contains(Hr)&&this.positionChange()},t.prototype.getDimension=function(){var e=this.element.offsetWidth,i=this.element.offsetHeight;return{width:e,height:i}},t.prototype.show=function(e){var i=this;if(this.element.classList.contains(Rr)){if(!this.element.classList.contains(bs)||!d(e)){d(e)||this.fullScreen(e);var r={cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,target:this.target,maxHeight:this.element.style.maxHeight};this.trigger("beforeOpen",r,function(o){if(!o.cancel){if(i.element.style.maxHeight!==r.maxHeight&&(i.allowMaxHeight=!1,i.element.style.maxHeight=r.maxHeight),i.enableResize&&i.boundWindowResizeHandler==null&&!i.initialRender&&i.wireWindowResizeEvent(),i.storeActiveElement=document.activeElement,i.element.tabIndex=-1,i.isModal&&!d(i.dlgOverlay))if(i.dlgOverlay.style.display="block",i.dlgContainer.style.display="flex",G([i.dlgOverlay],"e-fade"),d(i.targetEle))W([document.body],[Tt,yt]);else{i.targetEle===document.body?i.dlgContainer.style.position="fixed":i.dlgContainer.style.position="absolute",i.dlgOverlay.style.position="absolute";var a=i.getTargetContainer(i.target);if(a instanceof Element){var n=window.getComputedStyle(a);n.getPropertyValue("direction")==="rtl"?i.element.style.position="absolute":i.element.style.position="relative"}else i.element.style.position="relative";W([i.targetEle],[Tt,yt])}var s={name:i.animationSettings.effect==="None"&&ni==="Enable"?"ZoomIn":i.animationSettings.effect+"In",duration:i.animationSettings.duration,delay:i.animationSettings.delay},h=i.isModal?i.element.parentElement:i.element;if(i.calculatezIndex&&(i.setzIndex(h,!0),de(i.element,{zIndex:i.zIndex}),i.isModal&&i.setOverlayZindex(i.zIndex)),i.animationSettings.effect==="None"&&ni==="Enable"?i.popupObj.show(s):i.animationSettings.effect==="None"?i.popupObj.show():i.popupObj.show(s),i.isModal){var a=i.getTargetContainer(i.target);if(a instanceof Element){var n=window.getComputedStyle(a);n.getPropertyValue("direction")==="rtl"&&!i.IsDragStop&&i.setPopupPosition()}}i.dialogOpen=!0;var p=i.isProtectedOnChange;i.isProtectedOnChange=!0,i.visible=!0,i.preventVisibility=!0,i.isProtectedOnChange=p}})}this.isReact&&this.renderReactTemplates()}},t.prototype.hide=function(e){var i=this;if(this.element.classList.contains(Rr)&&this.preventVisibility){var r={cancel:!1,isInteracted:!!e,element:this.element,target:this.target,container:this.isModal?this.dlgContainer:this.element,event:e,closedBy:this.dlgClosedBy};this.closeArgs=r,this.trigger("beforeClose",r,function(o){if(!o.cancel){i.enableResize&&i.unWireWindowResizeEvent();var a={name:i.animationSettings.effect==="None"&&ni==="Enable"?"ZoomOut":i.animationSettings.effect+"Out",duration:i.animationSettings.duration,delay:i.animationSettings.delay};i.animationSettings.effect==="None"&&ni==="Enable"||(i.animationSettings.effect==="None"?i.popupObj.hide():i.popupObj.hide(a)),setTimeout(function(){i.isModal&&!d(i.targetEle)&&i.targetEle.classList.contains(Tt)&&i.targetEle.classList.contains(yt)&&G([i.targetEle],[Tt,yt]),document.body.classList.contains(Tt)&&document.body.classList.contains(yt)&&G([document.body],[Tt,yt])},i.animationSettings.duration+i.animationSettings.delay),i.dialogOpen=!1;var n=i.isProtectedOnChange;i.isProtectedOnChange=!0,i.visible=!1,i.preventVisibility=!1,i.isProtectedOnChange=n}i.dlgClosedBy=ta})}},t.prototype.fullScreen=function(e){if(this.element.offsetTop,this.element.offsetLeft,e){this.isModal||(this.element.style.top=document.scrollingElement.scrollTop+"px"),W([this.element],Qr);var i=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=d(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=i,W([document.body],[Tt,yt]),this.allowDragging&&!d(this.dragObj)&&this.dragObj.destroy()}else G([this.element],Qr),G([document.body],[Tt,yt]),this.allowDragging&&!d(this.headerContent)&&this.setAllowDragging();return e},t.prototype.getButtons=function(e){return d(e)?this.btnObj:this.btnObj[e]},t.prototype.unWireButtonEvents=function(){if(this.buttons.length>0&&this.footerTemplate===""&&this.ftrTemplateContent)for(var e=0;e<this.buttons.length;e++)this.buttons[e].click&&typeof this.buttons[e].click=="function"&&this.ftrTemplateContent.children[e]&&b.remove(this.ftrTemplateContent.children[e],"click",this.buttons[e].click)},t.prototype.destroyButtons=function(){if(!d(this.btnObj))for(var e=0;e<this.btnObj.length;e++)this.btnObj[e]&&!this.btnObj[e].isDestroyed&&this.btnObj[e].destroy()},ve([T("")],t.prototype,"content",void 0),ve([T(!0)],t.prototype,"enableHtmlSanitizer",void 0),ve([T(!1)],t.prototype,"enablePersistence",void 0),ve([T(!1)],t.prototype,"showCloseIcon",void 0),ve([T(!1)],t.prototype,"isModal",void 0),ve([T("")],t.prototype,"header",void 0),ve([T(!0)],t.prototype,"visible",void 0),ve([T(!1)],t.prototype,"enableResize",void 0),ve([T(["South-East"])],t.prototype,"resizeHandles",void 0),ve([T("auto")],t.prototype,"height",void 0),ve([T("")],t.prototype,"minHeight",void 0),ve([T("100%")],t.prototype,"width",void 0),ve([T("")],t.prototype,"cssClass",void 0),ve([T(1e3)],t.prototype,"zIndex",void 0),ve([T(null)],t.prototype,"target",void 0),ve([T("")],t.prototype,"footerTemplate",void 0),ve([T(!1)],t.prototype,"allowDragging",void 0),ve([qi([{}],tg)],t.prototype,"buttons",void 0),ve([T(!0)],t.prototype,"closeOnEscape",void 0),ve([Ke({},ig)],t.prototype,"animationSettings",void 0),ve([Ke({X:"center",Y:"center"},Nh)],t.prototype,"position",void 0),ve([Y()],t.prototype,"created",void 0),ve([Y()],t.prototype,"open",void 0),ve([Y()],t.prototype,"beforeSanitizeHtml",void 0),ve([Y()],t.prototype,"beforeOpen",void 0),ve([Y()],t.prototype,"close",void 0),ve([Y()],t.prototype,"beforeClose",void 0),ve([Y()],t.prototype,"dragStart",void 0),ve([Y()],t.prototype,"dragStop",void 0),ve([Y()],t.prototype,"drag",void 0),ve([Y()],t.prototype,"overlayClick",void 0),ve([Y()],t.prototype,"resizeStart",void 0),ve([Y()],t.prototype,"resizing",void 0),ve([Y()],t.prototype,"resizeStop",void 0),ve([Y()],t.prototype,"destroyed",void 0),t=ve([Qe],t),t}(ct),Ss;(function(l){function t(p){var u=Ie("div",{className:Ah});document.body.appendChild(u);var c,f=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return typeof p=="string"?c=i({content:p,position:{X:"center",Y:"top"},isModal:!0,header:js,buttons:f},u):c=i(r(p),u),c.close=function(){p&&p.close&&p.close.apply(c),c.destroy(),c.element.classList.contains("e-dlg-modal")?(c.element.parentElement.remove(),c.target.classList.remove(Is)):c.element.remove()},c}l.alert=t;function e(p){var u=Ie("div",{className:zh});document.body.appendChild(u);var c,f=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},{buttonModel:{content:"Cancel"},click:function(){this.hide()}}];return typeof p=="string"?c=i({position:{X:"center",Y:"top"},content:p,isModal:!0,header:js,buttons:f},u):c=i(o(p),u),c.close=function(){p&&p.close&&p.close.apply(c),c.destroy(),c.element.classList.contains("e-dlg-modal")?(c.element.parentElement.remove(),c.target.classList.remove(Is)):c.element.remove()},c}l.confirm=e;function i(p,u){var c=new Ao(p);return c.appendTo(u),c}function r(p){var u={};return u.buttons=[],u=a(u,p),u=n(u,p),u}function o(p){var u={};return u.buttons=[],u=a(u,p),u=s(u,p),u}function a(p,u){return p.header=d(u.title)?null:u.title,p.content=d(u.content)?"":u.content,p.isModal=d(u.isModal)?!0:u.isModal,p.showCloseIcon=d(u.showCloseIcon)?!1:u.showCloseIcon,p.allowDragging=d(u.isDraggable)?!1:u.isDraggable,p.closeOnEscape=d(u.closeOnEscape)?!1:u.closeOnEscape,p.position=d(u.position)?{X:"center",Y:"top"}:u.position,p.animationSettings=d(u.animationSettings)?{effect:"Fade",duration:400,delay:0}:u.animationSettings,p.cssClass=d(u.cssClass)?"":u.cssClass,p.zIndex=d(u.zIndex)?1e3:u.zIndex,p.open=d(u.open)?null:u.open,p.width=d(u.width)?"auto":u.width,p.height=d(u.height)?"auto":u.height,p}function n(p,u){var c=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return d(u.okButton)?p.buttons=c:p.buttons[0]=h(p.buttons[0],u.okButton,c[0]),p}function s(p,u){var c={buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},f={buttonModel:{content:"Cancel"},click:function(){this.hide()}};return d(u.okButton)?p.buttons[0]=c:p.buttons[0]=h(p.buttons[0],u.okButton,c),d(u.cancelButton)?p.buttons[1]=f:p.buttons[1]=h(p.buttons[1],u.cancelButton,f),p}function h(p,u,c){var f=c;return d(u.text)||(f.buttonModel.content=u.text),d(u.icon)||(f.buttonModel.iconCss=u.icon),d(u.cssClass)||(f.buttonModel.cssClass=u.cssClass),d(u.click)||(f.click=u.click),d(u.isFlat)||(f.isFlat=u.isFlat),f}})(Ss||(Ss={}));var Ph=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),be=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},gg=1500,vg=500,Ns=0,Ds=8,yg=2,kt=2,ia="e-tooltip",ws="e-rtl",mg="e-bigger",Os="e-icons",xs="e-tooltip-close",ra="e-tooltip-wrap",As="e-tip-content",Si="e-arrow-tip",zs="e-arrow-tip-outer",Xr="e-arrow-tip-inner",Ji="e-tip-bottom",oa="e-tip-top",Ps="e-tip-left",aa="e-tip-right",na="e-popup",Ki="e-popup-open",sa="e-popup-close",Wr="e-lib",Cg="e-hidden",Es="e-tooltip-popup-container",Mg=function(l){Ph(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return be([T({effect:"FadeIn",duration:150,delay:0})],t.prototype,"open",void 0),be([T({effect:"FadeOut",duration:150,delay:0})],t.prototype,"close",void 0),t}(Be),qa=function(l){Ph(t,l);function t(e,i){var r=l.call(this,e,i)||this;return r.mouseMoveEvent=null,r.mouseMoveTarget=null,r.containerElement=null,r.isBodyContainer=!0,r}return t.prototype.initialize=function(){this.formatPosition(),W([this.element],ia)},t.prototype.formatPosition=function(){var e,i;this.position&&(this.position.indexOf("Top")===0||this.position.indexOf("Bottom")===0?(e=this.position.split(/(?=[A-Z])/),this.tooltipPositionY=e[0],this.tooltipPositionX=e[1]):(i=this.position.split(/(?=[A-Z])/),this.tooltipPositionX=i[0],this.tooltipPositionY=i[1]))},t.prototype.renderArrow=function(){this.setTipClass(this.position);var e=this.createElement("div",{className:Si+" "+this.tipClass});e.appendChild(this.createElement("div",{className:zs+" "+this.tipClass})),e.appendChild(this.createElement("div",{className:Xr+" "+this.tipClass})),this.tooltipEle.appendChild(e)},t.prototype.setTipClass=function(e){e.indexOf("Right")===0?this.tipClass=Ps:e.indexOf("Bottom")===0?this.tipClass=oa:e.indexOf("Left")===0?this.tipClass=aa:this.tipClass=Ji},t.prototype.renderPopup=function(e){var i=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(e);this.tooltipEle.classList.remove(Wr),this.popupObj=new Or(this.tooltipEle,{height:this.height,width:this.width,position:{X:i.left,Y:i.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})},t.prototype.getScalingFactor=function(e){if(!e)return{x:1,y:1};var i={x:1,y:1},r=e.closest('[style*="transform: scale"]');if(r&&r!==this.tooltipEle&&r.contains(this.tooltipEle)){var o=window.getComputedStyle(r),a=o.getPropertyValue("transform"),n=a.match(/matrix\(([^)]+)\)/)[1].split(",").map(parseFloat);i.x=n[0],i.y=n[3]}return i},t.prototype.getTooltipPosition=function(e){this.tooltipEle.style.display="block";var i=this.element.closest('[style*="zoom"]');i&&(i.contains(this.tooltipEle)||(this.tooltipEle.style.zoom=getComputedStyle(i).zoom));var r=at(e,this.tooltipPositionX,this.tooltipPositionY,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect()),o=this.getScalingFactor(e),a=this.calculateTooltipOffset(this.position,o.x,o.y),n=this.calculateElementPosition(r,a),s=n[0],h=n[1],p=this.collisionFlipFit(e,s,h);return p.left=p.left/o.x,p.top=p.top/o.y,this.tooltipEle.style.display="",p},t.prototype.windowResize=function(){this.reposition(this.findTarget())},t.prototype.reposition=function(e){if(this.popupObj&&e){var i=this.getTooltipPosition(e);this.popupObj.position={X:i.left,Y:i.top},this.popupObj.dataBind()}},t.prototype.openPopupHandler=function(){!this.mouseTrail&&this.needTemplateReposition()&&this.reposition(this.findTarget()),this.trigger("afterOpen",this.tooltipEventArgs),this.tooltipEventArgs=null},t.prototype.closePopupHandler=function(){this.isReact&&!(this.opensOn==="Click"||typeof this.content=="function")&&this.clearTemplate(["content"]),this.clear();var e={type:this.tooltipEventArgs.event?this.tooltipEventArgs.event.type:null,cancel:!1,target:this.tooltipEventArgs.target,event:this.tooltipEventArgs.event?this.tooltipEventArgs.event:null,element:this.tooltipEle,isInteracted:!d(this.tooltipEventArgs.event)};this.trigger("afterClose",e),e=null},t.prototype.calculateTooltipOffset=function(e,i,r){i===void 0&&(i=1),r===void 0&&(r=1);var o={top:0,left:0},a,n,s,h,p,u,c,f;if(i!==1||r!==1){var g=this.tooltipEle.getBoundingClientRect(),v=void 0;s=Math.round(g.width),h=Math.round(g.height),p=te("."+Si,this.tooltipEle),p&&(v=p.getBoundingClientRect()),a=p?Math.round(v.width):0,n=p?Math.round(v.height):0,u=this.showTipPointer?Ns:Ds,c=n/2+kt+(h-this.tooltipEle.clientHeight*r),f=a/2+kt+(s-this.tooltipEle.clientWidth*i)}else s=this.tooltipEle.offsetWidth,h=this.tooltipEle.offsetHeight,p=te("."+Si,this.tooltipEle),a=p?p.offsetWidth:0,n=p?p.offsetHeight:0,u=this.showTipPointer?Ns:Ds,c=n/2+kt+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),f=a/2+kt+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(u+=yg),e){case"RightTop":o.left+=a+u,o.top-=h-c;break;case"RightCenter":o.left+=a+u,o.top-=h/2;break;case"RightBottom":o.left+=a+u,o.top-=c;break;case"BottomRight":o.top+=n+u,o.left-=f;break;case"BottomCenter":o.top+=n+u,o.left-=s/2;break;case"BottomLeft":o.top+=n+u,o.left-=s-f;break;case"LeftBottom":o.left-=a+s+u,o.top-=c;break;case"LeftCenter":o.left-=a+s+u,o.top-=h/2;break;case"LeftTop":o.left-=a+s+u,o.top-=h-c;break;case"TopLeft":o.top-=h+n+u,o.left-=s-f;break;case"TopRight":o.top-=h+n+u,o.left-=f;break;default:o.top-=h+n+u,o.left-=s/2;break}return o.left+=this.offsetX,o.top+=this.offsetY,o},t.prototype.updateTipPosition=function(e){var i=me("."+Si+",."+zs+",."+Xr,this.tooltipEle),r=[Ji,oa,Ps,aa];G(i,r),this.setTipClass(e),W(i,this.tipClass)},t.prototype.adjustArrow=function(e,i,r,o){var a=te("."+Si,this.tooltipEle);if(!(this.showTipPointer===!1||a===null)){this.updateTipPosition(i);var n,s;this.tooltipEle.style.display="block";var h=this.tooltipEle.clientWidth,p=this.tooltipEle.clientHeight,u=te("."+Xr,this.tooltipEle),c=a.offsetWidth,f=a.offsetHeight;if(this.tooltipEle.style.display="",this.tipClass===Ji||this.tipClass===oa){if(this.tipClass===Ji?(s="99.9%",u.style.top="-"+(f-2)+"px"):(s=-(f-1)+"px",u.style.top="-"+(f-6)+"px"),e){var g=r!=="Center"||h>e.offsetWidth||this.mouseTrail;g&&r==="Left"||!g&&this.tipPointerPosition==="End"?n=h-c-kt+"px":g&&r==="Right"||!g&&this.tipPointerPosition==="Start"?n=kt+"px":g&&(this.tipPointerPosition==="End"||this.tipPointerPosition==="Start")?n=this.tipPointerPosition==="End"?e.offsetWidth+(this.tooltipEle.offsetWidth-e.offsetWidth)/2-c/2-kt+"px":(this.tooltipEle.offsetWidth-e.offsetWidth)/2-c/2+kt+"px":n=h/2-c/2+"px"}}else{this.tipClass===aa?(n="99.9%",u.style.left="-"+(c-2)+"px"):(n=-(c-1)+"px",u.style.left=-c+(c-2)+"px");var g=o!=="Center"||p>e.offsetHeight||this.mouseTrail;g&&o==="Top"||!g&&this.tipPointerPosition==="End"?s=p-f-kt+"px":g&&o==="Bottom"||!g&&this.tipPointerPosition==="Start"?s=kt+"px":s=p/2-f/2+"px"}a.style.top=s,a.style.left=n}},t.prototype.renderContent=function(e){var i=this,r=te("."+As,this.tooltipEle);if(this.cssClass&&W([this.tooltipEle],this.cssClass.split(" ")),e&&!d(e.getAttribute("title"))&&(e.setAttribute("data-content",e.getAttribute("title")),e.removeAttribute("title")),d(this.content))e&&!d(e.getAttribute("data-content"))&&(r.innerHTML=e.getAttribute("data-content"));else if(r.innerHTML="",this.content instanceof HTMLElement)r.appendChild(this.content);else if(typeof this.content=="string")if(this.isAngular?this.setProperties({content:pt.sanitize(this.content)},!0):this.content=this.enableHtmlSanitizer?pt.sanitize(this.content):this.content,this.enableHtmlParse){var o=ht(this.content),a=o({},this,"content",this.element.id+"content",void 0,void 0,r,this.root);a&&Qi(a,r)}else r.textContent=this.content;else{var n=ht(this.content),a=n({},this,"content",this.element.id+"content",void 0,void 0,r);a&&(this.isAngular&&setTimeout(function(){i.reposition(e)},1),Qi(a,r)),this.renderReactTemplates()}},t.prototype.renderCloseIcon=function(){if(!this.isSticky){var e=this.tooltipEle.querySelector("."+Os+"."+xs);e&&it(e);return}var i=this.createElement("div",{className:Os+" "+xs,attrs:{role:"button","aria-label":"Press escape to close the Tooltip"}});this.tooltipEle.appendChild(i),b.add(i,S.touchStartEvent,this.onStickyClose,this)},t.prototype.addDescribedBy=function(e,i){var r=(e.getAttribute("aria-describedby")||"").split(/\s+/);r.indexOf(i)<0&&r.push(i),ge(e,{"aria-describedby":r.join(" ").trim(),"data-tooltip-id":i})},t.prototype.removeDescribedBy=function(e){var i=e.getAttribute("data-tooltip-id"),r=(e.getAttribute("aria-describedby")||"").split(/\s+/),o=r.indexOf(i);o!==-1&&r.splice(o,1),e.removeAttribute("data-tooltip-id");var a=r.join(" ").trim();a?e.setAttribute("aria-describedby",a):e.removeAttribute("aria-describedby")},t.prototype.tapHoldHandler=function(e){clearTimeout(this.autoCloseTimer),this.targetHover(e.originalEvent)},t.prototype.touchEndHandler=function(){var e=this;if(!this.isSticky){var i=function(){e.close()};this.autoCloseTimer=setTimeout(i,gg)}},t.prototype.targetClick=function(e){var i;if(this.target?i=ce(e.target,this.target):i=this.element,!d(i)){var r=e;i.getAttribute("data-tooltip-id")===null?r.type==="mousedown"&&r.button===2||this.targetHover(e):this.isSticky||this.hideTooltip(this.animation.close,e,i)}},t.prototype.targetHover=function(e){var i;if(this.target?i=ce(e.target,this.target):i=this.element,!(d(i)||i.getAttribute("data-tooltip-id")!==null&&this.closeDelay===0)){!d(this.tooltipEle)&&this.tooltipEle.getAttribute("e-animation-id")&&(ai.stop(this.tooltipEle),this.clear());for(var r=[].slice.call(me('[data-tooltip-id= "'+this.ctrlId+'_content"]',document)),o=0,a=r;o<a.length;o++){var n=a[o];this.restoreElement(n)}this.showTooltip(i,this.animation.open,e)}},t.prototype.mouseMoveBeforeOpen=function(e){this.mouseMoveEvent=e},t.prototype.mouseMoveBeforeRemove=function(){this.mouseMoveTarget&&b.remove(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen)},t.prototype.showTooltip=function(e,i,r){var o=this;clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.openDelay&&this.mouseTrail&&(this.mouseMoveBeforeRemove(),this.mouseMoveTarget=e,b.add(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen,this)),this.tooltipEventArgs={type:r?r.type:null,cancel:!1,target:e,event:r||null,element:this.tooltipEle,isInteracted:!d(r)};var a=function(n){o.beforeRenderCallback(n,e,r,i)};this.trigger("beforeRender",this.tooltipEventArgs,a.bind(this))},t.prototype.beforeRenderCallback=function(e,i,r,o){e.cancel?(this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove()):(this.isHidden=!1,d(this.tooltipEle)?(this.ctrlId=this.element.getAttribute("id")?Ve(this.element.getAttribute("id")):Ve("tooltip"),this.tooltipEle=this.createElement("div",{className:ra+" "+na+" "+Wr,attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"}}),this.tooltipEle.style.width=ee(this.width),this.tooltipEle.style.height=ee(this.height),this.tooltipEle.style.position="absolute",this.tooltipBeforeRender(i,this),this.tooltipAfterRender(i,r,o,this)):i&&(this.adjustArrow(i,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(i,this.ctrlId+"_content"),this.renderContent(i),ai.stop(this.tooltipEle),this.reposition(i),this.tooltipAfterRender(i,r,o,this)))},t.prototype.appendContainer=function(e){typeof this.container=="string"?this.container==="body"?this.containerElement=document.body:(this.isBodyContainer=!1,this.containerElement=te(this.container,document)):this.container instanceof HTMLElement&&(this.containerElement=this.container,this.isBodyContainer=this.containerElement.tagName==="BODY"),this.isBodyContainer||W([this.containerElement],Es),this.containerElement.appendChild(e.tooltipEle)},t.prototype.tooltipBeforeRender=function(e,i){e&&(S.isDevice&&W([i.tooltipEle],mg),i.width!=="auto"&&(i.tooltipEle.style.maxWidth=ee(i.width)),i.tooltipEle.appendChild(i.createElement("div",{className:As})),this.appendContainer(i),G([i.tooltipEle],Cg),i.addDescribedBy(e,i.ctrlId+"_content"),i.renderContent(e),W([i.tooltipEle],Ki),i.showTipPointer&&i.renderArrow(),i.renderCloseIcon(),i.renderPopup(e),i.adjustArrow(e,i.position,i.tooltipPositionX,i.tooltipPositionY),ai.stop(i.tooltipEle),i.reposition(e))},t.prototype.tooltipAfterRender=function(e,i,r,o){if(e){G([o.tooltipEle],Ki),W([o.tooltipEle],sa),o.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:e,event:i||null,element:o.tooltipEle,isInteracted:!d(i)},o.needTemplateReposition()&&!o.mouseTrail&&(r.effect==="None"||r.effect==="FadeIn"||this.isReact&&typeof o.content!="string")&&(o.tooltipEle.style.display="none");var a=function(n){o.beforeOpenCallback(n,e,r,i)};o.trigger("beforeOpen",o.tooltipEventArgs,a.bind(o))}},t.prototype.beforeOpenCallback=function(e,i,r,o){var a=this;if(e.cancel)this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove(),this.restoreElement(i);else{var n={name:r.effect==="None"&&ni==="Enable"?"FadeIn":this.animation.open.effect,duration:r.duration,delay:r.delay,timingFunction:"easeOut"};if(r.effect==="None"&&(n=void 0),this.openDelay>0){var s=function(){a.mouseTrail&&b.add(i,"mousemove touchstart mouseenter",a.onMouseMove,a),a.popupObj&&(a.popupObj.show(n,i),a.mouseMoveEvent&&a.mouseTrail&&a.onMouseMove(a.mouseMoveEvent))};this.showTimer=setTimeout(s,this.openDelay)}else this.popupObj&&this.popupObj.show(n,i)}o&&this.wireMouseEvents(o,i)},t.prototype.needTemplateReposition=function(){var e=this;return!d(e.viewContainerRef)&&typeof e.viewContainerRef!="string"||this.isReact},t.prototype.checkCollision=function(e,i,r){var o={left:i,top:r,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},a=cn(this.tooltipEle,this.checkCollideTarget(),i,r);return a.length>0&&(o.horizontal=a.indexOf("left")>=0?"Right":a.indexOf("right")>=0?"Left":this.tooltipPositionX,o.vertical=a.indexOf("top")>=0?"Bottom":a.indexOf("bottom")>=0?"Top":this.tooltipPositionY),o},t.prototype.calculateElementPosition=function(e,i){return[this.isBodyContainer?e.left+i.left:e.left-this.containerElement.getBoundingClientRect().left+i.left+window.pageXOffset+this.containerElement.scrollLeft,this.isBodyContainer?e.top+i.top:e.top-this.containerElement.getBoundingClientRect().top+i.top+window.pageYOffset+this.containerElement.scrollTop]},t.prototype.collisionFlipFit=function(e,i,r){var o=this.checkCollision(e,i,r),a=o.position;if(this.tooltipPositionY!==o.vertical&&(a=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?o.vertical+this.tooltipPositionX:this.tooltipPositionX+o.vertical),this.tooltipPositionX!==o.horizontal&&(a.indexOf("Left")===0&&(o.vertical=a==="LeftTop"||a==="LeftCenter"?"Top":"Bottom",a=o.vertical+"Left"),a.indexOf("Right")===0&&(o.vertical=a==="RightTop"||a==="RightCenter"?"Top":"Bottom",a=o.vertical+"Right"),o.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:e,event:null,element:this.tooltipEle,collidedPosition:a},this.trigger("beforeCollision",this.tooltipEventArgs),this.tooltipEventArgs.cancel)a=this.position;else{var n=o.vertical,s=o.horizontal;if(o.position!==a){var h=at(e,s,n,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect());this.adjustArrow(e,a,s,n);var p=this.getScalingFactor(e),u=this.calculateTooltipOffset(a,p.x,p.y);u.top-=this.getOffSetPosition("TopBottom",a,this.offsetY),u.left-=this.getOffSetPosition("RightLeft",a,this.offsetX),o.position=a;var c=this.calculateElementPosition(h,u);o.left=c[0],o.top=c[1]}else this.adjustArrow(e,a,s,n)}var f={left:o.left,top:o.top},g=this.isBodyContainer?ch(this.tooltipEle,this.checkCollideTarget(),{X:!0,Y:this.windowCollision},f):f;this.tooltipEle.style.display="block";var v=te("."+Si,this.tooltipEle);if(this.showTipPointer&&v!=null&&(a.indexOf("Bottom")===0||a.indexOf("Top")===0)){var m=parseInt(v.style.left,10)-(g.left-o.left);m<0?m=0:m+v.offsetWidth>this.tooltipEle.clientWidth&&(m=this.tooltipEle.clientWidth-v.offsetWidth),v.style.left=m.toString()+"px"}return this.tooltipEle.style.display="",f.left=g.left,f.top=g.top,f},t.prototype.getOffSetPosition=function(e,i,r){return e.indexOf(this.position.split(/(?=[A-Z])/)[0])!==-1&&e.indexOf(i.split(/(?=[A-Z])/)[0])!==-1?2*r:0},t.prototype.checkCollideTarget=function(){return!this.windowCollision&&this.target?this.element:null},t.prototype.hideTooltip=function(e,i,r){var o=this;if(this.closeDelay>0){clearTimeout(this.hideTimer),clearTimeout(this.showTimer);var a=function(){o.closeDelay&&o.tooltipEle&&o.isTooltipOpen||o.tooltipHide(e,i,r)};this.hideTimer=setTimeout(a,this.closeDelay)}else this.tooltipHide(e,i,r)},t.prototype.tooltipHide=function(e,i,r){var o=this,a;i?a=this.target?r||i.target:this.element:a=te('[data-tooltip-id= "'+this.ctrlId+'_content"]',document),this.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:a,event:i||null,element:this.tooltipEle,isInteracted:!d(i)},this.trigger("beforeClose",this.tooltipEventArgs,function(n){n.cancel?o.isHidden=!1:(o.mouseMoveBeforeRemove(),o.popupHide(e,a,i))})},t.prototype.popupHide=function(e,i,r){i&&r&&this.restoreElement(i),this.isHidden=!0;var o={name:e.effect==="None"&&ni==="Enable"?"FadeOut":this.animation.close.effect,duration:e.duration,delay:e.delay,timingFunction:"easeIn"};e.effect==="None"&&(o=void 0),this.popupObj&&this.popupObj.hide(o)},t.prototype.restoreElement=function(e){this.unwireMouseEvents(e),d(e.getAttribute("data-content"))||(e.setAttribute("title",e.getAttribute("data-content")),e.removeAttribute("data-content")),this.removeDescribedBy(e)},t.prototype.clear=function(){var e=this.findTarget();e&&this.restoreElement(e),this.tooltipEle&&(G([this.tooltipEle],sa),W([this.tooltipEle],Ki)),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&it(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)},t.prototype.tooltipHover=function(){this.tooltipEle&&(this.isTooltipOpen=!0)},t.prototype.tooltipMouseOut=function(e){this.isTooltipOpen=!1,this.hideTooltip(this.animation.close,e,this.findTarget())},t.prototype.onMouseOut=function(e){var i=e.relatedTarget;if(i&&!this.mouseTrail){var r=ce(i,"."+ra+"."+Wr+"."+na);r?b.add(r,"mouseleave",this.tooltipElementMouseOut,this):(this.hideTooltip(this.animation.close,e,this.findTarget()),this.closeDelay===0&&(this.animation.close.effect==="None"||this.isReact&&typeof this.content!="string")&&this.clear())}else this.hideTooltip(this.animation.close,e,this.findTarget()),this.clear();this.popupObj&&!this.popupObj.element.classList.contains(Ki)&&this.clear()},t.prototype.tooltipElementMouseOut=function(e){this.hideTooltip(this.animation.close,e,this.findTarget()),b.remove(this.element,"mouseleave",this.tooltipElementMouseOut),this.clear()},t.prototype.onStickyClose=function(){this.close()},t.prototype.onMouseMove=function(e){var i=0,r=0;if(e.type.indexOf("touch")>-1?(e.preventDefault(),i=e.touches[0].pageX,r=e.touches[0].pageY):(i=e.pageX,r=e.pageY),!d(this.tooltipEle)){ai.stop(this.tooltipEle),G([this.tooltipEle],sa),W([this.tooltipEle],Ki),this.adjustArrow(e.target,this.position,this.tooltipPositionX,this.tooltipPositionY);var o=this.getScalingFactor(e.target),a=this.calculateTooltipOffset(this.position,o.x,o.y),n=i+a.left+this.offsetX,s=r+a.top+this.offsetY,h=this.checkCollision(e.target,n,s);if(this.tooltipPositionX!==h.horizontal||this.tooltipPositionY!==h.vertical){var p=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?h.vertical+h.horizontal:h.horizontal+h.vertical;h.position=p,this.adjustArrow(e.target,h.position,h.horizontal,h.vertical);var u=this.calculateTooltipOffset(h.position,o.x,o.y);h.left=i+u.left-this.offsetX,h.top=r+u.top-this.offsetY}this.tooltipEle.style.left=h.left+"px",this.tooltipEle.style.top=h.top+"px"}},t.prototype.keyDown=function(e){this.tooltipEle&&e.keyCode===27&&this.close()},t.prototype.touchEnd=function(e){this.tooltipEle&&ce(e.target,"."+ia)===null&&!this.isSticky&&this.close()},t.prototype.scrollHandler=function(e){this.tooltipEle&&!this.isSticky&&!ce(e.target,"."+ra+"."+Wr+"."+na)&&!this.isSticky&&this.close()},t.prototype.render=function(){this.initialize(),this.wireEvents(this.opensOn),this.renderComplete()},t.prototype.preRender=function(){this.tipClass=Ji,this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0},t.prototype.wireEvents=function(e){for(var i=this.getTriggerList(e),r=0,o=i;r<o.length;r++){var a=o[r];if(a==="Custom")return;a==="Focus"&&this.wireFocusEvents(),a==="Click"&&b.add(this.element,S.touchStartEvent,this.targetClick,this),a==="Hover"&&(S.isDevice?(this.touchModule=new Tr(this.element,{tapHoldThreshold:vg,tapHold:this.tapHoldHandler.bind(this)}),b.add(this.element,S.touchEndEvent,this.touchEndHandler,this)):b.add(this.element,"mouseover",this.targetHover,this))}this.windowResizeBound=this.windowResize.bind(this),this.keyDownBound=this.keyDown.bind(this),this.touchEndBound=this.touchEnd.bind(this),this.scrollWheelBound=this.scrollHandler.bind(this),document.addEventListener("wheel",this.scrollWheelBound),document.addEventListener("scroll",this.scrollWheelBound),document.addEventListener("touchend",this.touchEndBound),document.addEventListener("keydown",this.keyDownBound),window.addEventListener("resize",this.windowResizeBound)},t.prototype.getTriggerList=function(e){return e?(e==="Auto"&&(e=S.isDevice?"Hover":"Hover Focus"),e.split(" ")):[]},t.prototype.wireFocusEvents=function(){if(d(this.target))b.add(this.element,"focusin",this.targetHover,this);else{var e=[].slice.call(me(this.target,this.element));if(this.targetsList=e,!d(this.targetsList)&&this.targetsList.length>0)for(var i=0,r=e;i<r.length;i++){var o=r[i];b.add(o,"focus",this.targetHover,this)}else b.add(this.element,"focusin",this.targetHover,this)}},t.prototype.wireMouseEvents=function(e,i){this.tooltipEle&&(this.isSticky||(e.type==="focus"&&b.add(i,"blur",this.onMouseOut,this),e.type==="focusin"&&b.add(i,"focusout",this.onMouseOut,this),e.type==="mouseover"&&b.add(i,"mouseleave",this.onMouseOut,this),this.closeDelay&&(b.add(this.tooltipEle,"mouseenter",this.tooltipHover,this),b.add(this.tooltipEle,"mouseleave",this.tooltipMouseOut,this))),this.mouseTrail&&this.openDelay===0&&b.add(i,"mousemove touchstart mouseenter",this.onMouseMove,this))},t.prototype.unwireEvents=function(e){for(var i=this.getTriggerList(e),r=0,o=i;r<o.length;r++){var a=o[r];if(a==="Custom")return;a==="Focus"&&this.unwireFocusEvents(),a==="Click"&&b.remove(this.element,S.touchStartEvent,this.targetClick),a==="Hover"&&(S.isDevice?(this.touchModule&&this.touchModule.destroy(),b.remove(this.element,S.touchEndEvent,this.touchEndHandler)):b.remove(this.element,"mouseover",this.targetHover))}document.removeEventListener("touchend",this.touchEndBound),this.touchEndBound=null,document.removeEventListener("wheel",this.scrollWheelBound),document.removeEventListener("scroll",this.scrollWheelBound),this.scrollWheelBound=null,window.removeEventListener("resize",this.windowResizeBound),this.windowResizeBound=null,document.removeEventListener("keydown",this.keyDownBound),this.keyDownBound=null},t.prototype.unwireFocusEvents=function(){if(d(this.target))b.remove(this.element,"focusin",this.targetHover);else{var e=[].slice.call(me(this.target,this.element));if(!d(this.targetsList)&&this.targetsList.length>0)for(var i=0,r=e;i<r.length;i++){var o=r[i];b.remove(o,"focus",this.targetHover)}else b.remove(this.element,"focusin",this.targetHover)}},t.prototype.unwireMouseEvents=function(e){if(!this.isSticky){for(var i=this.getTriggerList(this.opensOn),r=0,o=i;r<o.length;r++){var a=o[r];a==="Focus"&&(b.remove(e,"blur",this.onMouseOut),b.remove(e,"focusout",this.onMouseOut)),a==="Hover"&&!S.isDevice&&b.remove(e,"mouseleave",this.onMouseOut)}this.closeDelay&&(b.remove(e,"mouseenter",this.tooltipHover),b.remove(e,"mouseleave",this.tooltipMouseOut))}this.mouseTrail&&b.remove(e,"mousemove touchstart mouseenter",this.onMouseMove)},t.prototype.findTarget=function(){var e=te('[data-tooltip-id= "'+this.ctrlId+'_content"]',document);return e},t.prototype.getModuleName=function(){return"tooltip"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.onPropertyChanged=function(e,i){for(var r=this.findTarget(),o=0,a=Object.keys(e);o<a.length;o++){var n=a[o];switch(n){case"width":this.tooltipEle&&r&&(this.tooltipEle.style.width=this.tooltipEle.style.maxWidth=ee(e.width),this.reposition(r));break;case"height":this.tooltipEle&&r&&(this.tooltipEle.style.height=ee(e.height),this.reposition(r));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(i.opensOn),this.wireEvents(e.opensOn);break;case"position":if(this.formatPosition(),this.tooltipEle&&r){var s=te("."+Xr,this.tooltipEle);s&&(s.style.top=s.style.left=null),this.reposition(r)}break;case"tipPointerPosition":this.tooltipEle&&r&&this.reposition(r);break;case"offsetX":if(this.tooltipEle){var h=e.offsetX-i.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+h).toString()+"px"}break;case"offsetY":if(this.tooltipEle){var p=e.offsetY-i.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+p).toString()+"px"}break;case"cssClass":this.tooltipEle&&(i.cssClass&&G([this.tooltipEle],i.cssClass.split(" ")),e.cssClass&&W([this.tooltipEle],e.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?W([this.tooltipEle],ws):G([this.tooltipEle],ws));break;case"isSticky":this.tooltipEle&&r&&(this.renderCloseIcon(),this.reposition(r));break;case"container":d(this.containerElement)||G([this.containerElement],Es),this.container=e.container,this.tooltipEle&&r&&(this.appendContainer(this),this.reposition(r))}}},t.prototype.open=function(e,i){d(i)&&(i=this.animation.open),d(e)&&(e=this.element),e.style.display!=="none"&&this.showTooltip(e,i)},t.prototype.close=function(e){e||(e=this.animation.close),this.hideTooltip(e)},t.prototype.refresh=function(e){if(this.tooltipEle&&this.renderContent(e),this.popupObj&&e&&this.reposition(e),!d(this.targetsList)&&!d(this.target)){var i=me(this.target,this.element);i.length!==this.targetsList.length&&(this.unwireEvents(this.opensOn),this.wireEvents(this.opensOn))}},t.prototype.destroy=function(){l.prototype.destroy.call(this),this.tooltipEle&&it(this.tooltipEle),this.popupObj&&this.popupObj.destroy(),Th(),G([this.element],ia),this.unwireEvents(this.opensOn),this.unwireMouseEvents(this.element),this.tooltipEle=null,this.popupObj=null;for(var e=me('[data-tooltip-id= "'+this.ctrlId+'_content"]',this.element),i=0,r=e;i<r.length;i++){var o=r[i];this.restoreElement(o)}this.containerElement=null,this.tipClass=null,this.tooltipPositionX=null,this.tooltipPositionY=null,this.ctrlId=null,this.tooltipEventArgs=null,this.touchModule=null,this.mouseMoveEvent=null,this.mouseMoveTarget=null,this.containerElement=null,this.targetsList=null},be([T("auto")],t.prototype,"width",void 0),be([T("auto")],t.prototype,"height",void 0),be([T()],t.prototype,"content",void 0),be([T("body")],t.prototype,"container",void 0),be([T()],t.prototype,"target",void 0),be([T("TopCenter")],t.prototype,"position",void 0),be([T(0)],t.prototype,"offsetX",void 0),be([T(0)],t.prototype,"offsetY",void 0),be([T(!0)],t.prototype,"showTipPointer",void 0),be([T(!0)],t.prototype,"enableHtmlParse",void 0),be([T(!1)],t.prototype,"windowCollision",void 0),be([T("Auto")],t.prototype,"tipPointerPosition",void 0),be([T("Auto")],t.prototype,"opensOn",void 0),be([T(!1)],t.prototype,"mouseTrail",void 0),be([T(!1)],t.prototype,"isSticky",void 0),be([Ke({},Mg)],t.prototype,"animation",void 0),be([T(0)],t.prototype,"openDelay",void 0),be([T(0)],t.prototype,"closeDelay",void 0),be([T()],t.prototype,"cssClass",void 0),be([T(!0)],t.prototype,"enableHtmlSanitizer",void 0),be([T("")],t.prototype,"htmlAttributes",void 0),be([Y()],t.prototype,"beforeRender",void 0),be([Y()],t.prototype,"beforeOpen",void 0),be([Y()],t.prototype,"afterOpen",void 0),be([Y()],t.prototype,"beforeClose",void 0),be([Y()],t.prototype,"afterClose",void 0),be([Y()],t.prototype,"beforeCollision",void 0),be([Y()],t.prototype,"created",void 0),be([Y()],t.prototype,"destroyed",void 0),t=be([Qe],t),t}(ct),We={},bg=30,jg=30,Ls=30,Ig=30,Tg=30,Sg=30,Ng=36,Dg=36,la="e-spin-show",vo="e-spin-hide",ks="e-spin-material",Ys="e-spin-material3",Fs="e-spin-tailwind3",Us="e-spin-fabric",Rs="e-spin-fluent",Bs="e-spin-fluent2",Hs="e-spin-tailwind",wg="e-spin-bootstrap",Qs="e-spin-bootstrap4",Xs="e-spin-bootstrap5",Ws="e-spin-high-contrast",_a="e-spinner-pane",Tn="e-spinner-inner",zo="e-path-circle",Og="e-path-arc",xg="e-spin-label",Za="e-spin-template",Vs=null,Ag=null;function yo(l,t){var e;if(l.target){var i,r=d(t)?Ie:t,o=ev(l.target,r);if(!d(l.cssClass)){var a=l.cssClass.split(" ").filter(function(p){return p.trim()!==""});(e=o.wrap.classList).add.apply(e,a)}if(!d(l.template)||!d(Vs)){var n=d(l.template)?Vs:l.template;o.wrap.classList.add(Za),Jg(o.wrap,n,Ag)}else{var s=d(l.type)?Xg(o.wrap):l.type,h=d(l.width)?void 0:l.width;i=Kg(h,s),Wg(s,o.wrap,i,r),d(l.label)||zg(o.inner_wrap,l.label,r)}o.wrap.classList.add(vo),o=null}}function zg(l,t,e){var i=e("div",{});return i.classList.add(xg),i.innerHTML=t,l.appendChild(i),i}function Pg(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"Material",radius:t},zr(l,i,e,ks),Pr(t,l,"Material",ks)}function Eg(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"Tailwind3",radius:t},zr(l,i,e,Fs),Pr(t,l,"Tailwind3",Fs)}function Lg(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"Material3",radius:t},zr(l,i,e,Ys),Pr(t,l,"Material3",Ys)}function kg(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"Bootstrap4",radius:t},zr(l,i,e,Qs),Pr(t,l,"Bootstrap4",Qs)}function Yg(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"Bootstrap5",radius:t},zr(l,i,e,Xs),Pr(t,l,"Bootstrap5",Xs)}function Fg(l,t,e){var i={},r=0;We[""+t].timeOut=0,i[""+t]=$g(t,e,0,0);var o={uniqueID:t,container:l,globalInfo:i,timeOutVar:r};Eh(o)}function Ug(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"Fabric",radius:t},Ar(l,i,Us),Er(t,l,Us)}function Rg(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"Fluent",radius:t},Ar(l,i,Rs),Er(t,l,Rs)}function Bg(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"Fluent2",radius:t},Ar(l,i,Bs),Er(t,l,Bs)}function Hg(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"Tailwind",radius:t},Ar(l,i,Hs),Er(t,l,Hs)}function Qg(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"HighContrast",radius:t},Ar(l,i,Ws),Er(t,l,Ws)}function Xg(l){var t=window.getComputedStyle(l,":after").getPropertyValue("content");return t.replace(/['"]+/g,"")}function Wg(l,t,e,i){var r=t.querySelector("."+Tn),o=r.querySelector("svg");switch(d(o)||r.removeChild(o),l){case"Material":Pg(r,e,i);break;case"Material3":Lg(r,e,i);break;case"Fabric":Ug(r,e);break;case"Fluent":Rg(r,e);break;case"Fluent2":Bg(r,e);break;case"Bootstrap":Vg(r,e);break;case"HighContrast":Qg(r,e);break;case"Bootstrap4":kg(r,e,i);break;case"Bootstrap5":Yg(r,e,i);break;case"Tailwind":case"Tailwind-dark":Hg(r,e);break;case"Tailwind3":Eg(r,e,i);break}}function Vg(l,t,e){var i=zt();We[""+i]={timeOut:0,type:"Bootstrap",radius:t},qg(l,i),_g(l,t)}function qg(l,t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=64,o=32,a=2;i.setAttribute("id",t),i.setAttribute("class",wg),i.setAttribute("viewBox","0 0 "+r+" "+r),l.insertBefore(i,l.firstChild);for(var n=0;n<=7;n++){var s=document.createElementNS("http://www.w3.org/2000/svg","circle");s.setAttribute("class",zo+"_"+n),s.setAttribute("r",a+""),s.setAttribute("transform","translate("+o+","+o+")"),i.appendChild(s)}}function _g(l,t){var e=l.querySelector("svg.e-spin-bootstrap"),i=0,r=0,o=24;e.style.width=e.style.height=t+"px";for(var a=90,n=0;n<=7;n++){var s=Ga(i,r,o,a),h=e.querySelector("."+zo+"_"+n);h.setAttribute("cx",s.x+""),h.setAttribute("cy",s.y+""),a=a>=360?0:a,a=a+45}}function Zg(l,t){var e=[],i=l,r=t,o=!1,a=1;n(i);function n(s){e.push(s),(s!==r||a===1)&&(s<=i&&s>1&&!o?s=parseFloat((s-.2).toFixed(2)):s===1?(s=7,s=parseFloat((s+.2).toFixed(2)),o=!0):s<8&&o?(s=parseFloat((s+.2).toFixed(2)),s===8&&(o=!1)):s<=8&&!o&&(s=parseFloat((s-.2).toFixed(2))),++a,n(s))}return e}function Gg(l){for(var t=l.querySelector("svg.e-spin-bootstrap"),e=t.getAttribute("id"),i=1;i<=8;i++){var r=l.getElementsByClassName("e-path-circle_"+(i===8?0:i))[0];o(r,i,i,Zg(i,i),e)}function o(a,n,s,h,p){var u=0;c(n);function c(f){We[""+p].isAnimate&&(++u,a.setAttribute("r",f+""),u>=h.length&&(u=0),We[p].timeOut=setTimeout(c.bind(null,h[u]),18))}}}function Jg(l,t,e){d(e)||l.classList.add(e);var i=l.querySelector(".e-spinner-inner");i.innerHTML=t}function Kg(l,t){var e;switch(t){case"Material":e=bg;break;case"Material3":e=jg;break;case"Fabric":e=Ls;break;case"Tailwind":case"Tailwind-dark":case"Tailwind3":e=Ls;break;case"Fluent":e=Ig;break;case"Fluent2":e=Tg;break;case"Bootstrap4":e=Ng;break;case"Bootstrap5":e=Dg;break;default:e=Sg}return l=l?parseFloat(l+""):e,t==="Bootstrap"?l:l/2}function $g(l,t,e,i){return{radius:t,count:e,previousId:i}}function zt(){for(var l="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=0;e<5;e++)l+=t.charAt(Math.floor(Math.random()*t.length));return l}function Ar(l,t,e,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("id",t),r.setAttribute("class",e);var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("class",zo);var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("class",Og),l.insertBefore(r,l.firstChild),r.appendChild(o),r.appendChild(a)}function zr(l,t,e,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("class",i),r.setAttribute("id",t),o.setAttribute("class",zo),l.insertBefore(r,l.firstChild),r.appendChild(o)}function ev(l,t){var e=t("div",{}),i=t("div",{});return e.classList.add(_a),i.classList.add(Tn),i.setAttribute("aria-disabled","true"),l.appendChild(e),e.appendChild(i),{wrap:e,inner_wrap:i}}function Eh(l){var t=1,e=149,i=1333,r=75;tv(t,e,ov,i,l.globalInfo[l.uniqueID].count,r,l),l.globalInfo[l.uniqueID].count=++l.globalInfo[l.uniqueID].count%4}function tv(l,t,e,i,r,o,a){var n=++a.globalInfo[a.uniqueID].previousId,s=new Date().getTime(),h=t-l,p=iv(a.globalInfo[a.uniqueID].radius*2+""),u=Lh(p),c=-90*(a.globalInfo[a.uniqueID].count||0);f(a);function f(v){var m=Math.max(0,Math.min(new Date().getTime()-s,i));g(e(m,l,h,i),v.container),n===v.globalInfo[v.uniqueID].previousId&&m<i?We[v.uniqueID].timeOut=setTimeout(f.bind(null,v),1):Eh(v)}function g(v,m){if(!d(m.querySelector("svg.e-spin-material"))||!d(m.querySelector("svg.e-spin-material3"))||!d(m.querySelector("svg.e-spin-tailwind3"))){var C=void 0;if(!d(m.querySelector("svg.e-spin-material"))&&!d(m.querySelector("svg.e-spin-material").querySelector("path.e-path-circle"))?C=m.querySelector("svg.e-spin-material"):!d(m.querySelector("svg.e-spin-material3"))&&!d(m.querySelector("svg.e-spin-material3").querySelector("path.e-path-circle"))?C=m.querySelector("svg.e-spin-material3"):!d(m.querySelector("svg.e-spin-tailwind3"))&&!d(m.querySelector("svg.e-spin-tailwind3").querySelector("path.e-path-circle"))&&(C=m.querySelector("svg.e-spin-tailwind3")),!d(C)){var M=C.querySelector("path.e-path-circle");M.setAttribute("stroke-dashoffset",kh(p,u,v,o)+""),M.setAttribute("transform","rotate("+c+" "+p/2+" "+p/2+")")}}}}function Pr(l,t,e,i){var r=l*2,o=t.querySelector("svg."+i),a=o.querySelector("path.e-path-circle"),n=Lh(r),s=r/2+"px";o.setAttribute("viewBox","0 0 "+r+" "+r),o.style.width=o.style.height=r+"px",o.style.transformOrigin=s+" "+s+" "+s,a.setAttribute("d",rv(r,n)),(e==="Material"||e==="Material3"||e==="Fluent2"||e==="Tailwind3")&&(a.setAttribute("stroke-width",n+""),a.setAttribute("stroke-dasharray",(r-n)*Math.PI*.75+""),a.setAttribute("stroke-dashoffset",kh(r,n,1,75)+""))}function iv(l){var t=parseFloat(l);return t}function rv(l,t){var e=l/2,i=t/2;return"M"+e+","+i+"A"+(e-i)+","+(e-i)+" 0 1 1 "+i+","+e}function Lh(l){return 10/100*l}function kh(l,t,e,i){return(l-t)*Math.PI*(3*i/100-e/100)}function ov(l,t,e,i){var r=(l/=i)*l,o=r*l;return t+e*(6*o*r+-15*r*r+10*o)}function Er(l,t,e){var i=l,r=l,o=l*2,a=315,n=45,s=t.querySelector("."+e),h=s.querySelector(".e-path-circle"),p=s.querySelector(".e-path-arc"),u=o/2+"px";h.setAttribute("d",nv(i,r,l)),p.setAttribute("d",av(i,r,l,a,n)),s.setAttribute("viewBox","0 0 "+o+" "+o),s.style.transformOrigin=u+" "+u+" "+u,s.style.width=s.style.height=o+"px"}function Ga(l,t,e,i){var r=(i-90)*Math.PI/180;return{x:l+e*Math.cos(r),y:t+e*Math.sin(r)}}function av(l,t,e,i,r){var o=Ga(l,t,e,r),a=Ga(l,t,e,i),n=["M",o.x,o.y,"A",e,e,0,0,0,a.x,a.y].join(" ");return n}function nv(l,t,e){var i=["M",l,t,"m",-e,0,"a",e,e,0,1,0,e*2,0,"a",e,e,0,1,0,-e*2,0].join(" ");return i}function Bt(l){Yh(l,!1),l=null}function Yh(l,t){var e;if(l)if(l.classList.contains(_a))e=l;else{var i=l.querySelectorAll("."+_a);if(S.isIE){for(var r=0;r<i.length;r++)if(i[r].parentElement&&i[r].parentElement===l){e=i[r];break}}else e=Array.from(i).find(function(h){return h.parentElement===l})||null}if(l&&e){var o=e.querySelector("."+Tn),a=t?!e.classList.contains(Za)&&!e.classList.contains(vo):!e.classList.contains(Za)&&!e.classList.contains(la);if(a){var n=e.querySelector("svg");if(d(n))return;var s=n.getAttribute("id");switch(We[""+s].isAnimate=!t,We[""+s].type){case"Material":case"Material3":case"Tailwind3":t?clearTimeout(We[s].timeOut):Fg(o,s,We[s].radius);break;case"Bootstrap":t?clearTimeout(We[s].timeOut):Gg(o);break}}t?lt(e,[vo],[la]):lt(e,[la],[vo]),l=null}}function gt(l){Yh(l,!0),l=null}var sv=function(l,t,e,i){return new(e||(e=Promise))(function(r,o){function a(h){try{s(i.next(h))}catch(p){o(p)}}function n(h){try{s(i.throw(h))}catch(p){o(p)}}function s(h){h.done?r(h.value):new e(function(p){p(h.value)}).then(a,n)}s((i=i.apply(l,t||[])).next())})},lv=function(l,t){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,a;return a={next:n(0),throw:n(1),return:n(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function n(h){return function(p){return s([h,p])}}function s(h){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,r&&(o=h[0]&2?r.return:h[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,h[1])).done)return o;switch(r=0,o&&(h=[h[0]&2,o.value]),h[0]){case 0:case 1:o=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,r=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!o||h[1]>o[0]&&h[1]<o[3])){e.label=h[1];break}if(h[0]===6&&e.label<o[1]){e.label=o[1],o=h;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(h);break}o[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(l,e)}catch(p){h=[6,p],r=0}finally{i=o=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},hv=function(){function l(t){this.isInitialLoading=!1,this.fileName="",this.isErrorImage=!1,this.isShapeTextInserted=!1,this.isRotateZoom=!1,this.tempStrokeSettings={strokeColor:"#fff",fillColor:"",strokeWidth:null,outlineColor:"",radius:null,outlineWidth:null},this.tempTextSettings={text:"Enter Text",fontFamily:"",fontSize:null,fontRatio:null,bold:!1,italic:!1,underline:!1},this.tempAdjValue="",this.tempFilter="",this.tempUndoRedoStep=0,this.tempFreehandCounter=0,this.tempCurrFhdIndex=0,this.tempZoomFactor=null,this.isCancelAction=!1,this.rotatedFlipCropSel=!1,this.zoomCrop={width:0,height:0},this.isImageEdited=!1,this.isFileChanged=!1,this.isNewPath=!1,this.isResizeSelect=!1,this.arrowDimension={bar:{width:10,height:32,ratioX:null,ratioY:null},arrow:{width:24,height:24,ratioX:null,ratioY:null},arrowSolid:{width:32,height:32,ratioX:null,ratioY:null},circle:{width:10,height:10,ratioX:null,ratioY:null},square:{width:20,height:20,ratioX:null,ratioY:null}},this.origDim={width:0,height:0},this.isImageApply=!1,this.imgCanvasPoints=[],this.isCropSelect=!1,this.isDownScale=!1,this.preventStraightening=!1,this.tempObjColl=[],this.tempPointColl={},this.imageBackgroundColor="",this.allowRedactStraighten=!0,this.isNullExtension=!0,this.isRedactStraighten=!1,this.parent=t,this.addEventListener()}return l.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},l.prototype.addEventListener=function(){this.parent.on("draw",this.draw,this),this.parent.on("destroyed",this.destroy,this)},l.prototype.removeEventListener=function(){this.parent.off("draw",this.draw),this.parent.off("destroyed",this.destroy)},l.prototype.draw=function(t){switch(this.updatePrivateVariables(),t.prop){case"drawObject":this.drawObject(t.value.canvas,t.value.obj,t.value.isCropRatio,t.value.points,t.value.isPreventDrag,t.value.saveContext,t.value.isPreventSelection);break;case"updateActiveObject":this.updateActiveObject(t.value.actPoint,t.value.obj,t.value.isMouseMove,t.value.x,t.value.y);break;case"clearOuterCanvas":this.clearOuterCanvas(t.value.context);break;case"setDestPoints":this.setDestPoints();break;case"updateCurrTransState":this.updateCurrTransState(t.value.type,t.value.isPreventDestination,t.value.isRotatePan);break;case"currTransState":this.currTransState(t.value.type,t.value.isPreventDestination,t.value.context,t.value.isPreventCircleCrop);break;case"setTransform":this.setTransform(t.value.context,t.value.value,t.value.isReverse);break;case"render-image":this.renderImage(t.value.isMouseWheel,t.value.isPreventClearRect,t.value.isFrame,t.value.isStraighten);break;case"draw-image-to-canvas":this.drawImgToCanvas(t.value.dimension);break;case"update-canvas":this.updateCanvas();break;case"performCancel":this.performCancel(t.value.isContextualToolbar,t.value.isUndoRedo,t.value.isFinalCancel);break;case"updateFlipPan":this.updateFlipPan(t.value.tempSelectionObj);break;case"select":this.select(t.value.type,t.value.startX,t.value.startY,t.value.width,t.value.height);break;case"callUpdateCurrTransState":this.callUpdateCurrTransState();break;case"resetPanPoints":this.resetPanPoints();break;case"setClientTransDim":this.setClientTransDim(t.value.isPreventDimension);break;case"redrawImgWithObj":this.redrawImgWithObj();break;case"setCurrentObj":this.setCurrentObj(t.value.obj,t.value.isUndoRedo,t.value.isCircleCrop);break;case"performPointZoom":this.performPointZoom(t.value.x,t.value.y,t.value.type,t.value.isResize);break;case"open":this.open(t.value.data);break;case"isInitialLoading":this.isInitialLoading=t.value.isInitialLoading;break;case"isInitialLoaded":this.getInitialLoaded(t.value.object);break;case"fileSelect":this.fileSelect(t.value.inputElement,t.value.args);break;case"getFileName":t.value.obj.fileName=this.fileName,t.value.obj.fileType=this.fileType;break;case"getErrorImage":t.value.obj.isErrorImage=this.isErrorImage;break;case"getInitialZoomValue":t.value.obj.initialZoomValue=this.initZoomValue;break;case"setShapeTextInsert":this.isShapeTextInserted=t.value.bool;break;case"resetCurrentSelectionPoint":this.currSelPoint=null;break;case"setRotateZoom":this.isRotateZoom=t.value.isRotateZoom;break;case"setTempStrokeSettings":this.tempStrokeSettings=t.value.tempStrokeSettings;break;case"setTempTextSettings":this.tempTextSettings=t.value.tempTextSettings;break;case"setTempAdjustmentValue":this.tempAdjValue=t.value.tempAdjustmentValue;break;case"getTempAdjustmentValue":t.value.obj.value=this.tempAdjValue;break;case"setTempFilter":this.tempFilter=t.value.tempFilter;break;case"setTempUndoRedoStep":this.tempUndoRedoStep=t.value.tempUndoRedoStep;break;case"setTempFreehandCounter":this.tempFreehandCounter=t.value.tempFreehandCounter;break;case"setTempCurrentFreehandDrawIndex":this.tempCurrFhdIndex=t.value.tempCurrentFreehandDrawIndex;break;case"setTempZoomFactor":this.tempZoomFactor=t.value.tempZoomFactor;break;case"setCancelAction":this.isCancelAction=t.value.bool;break;case"getRotatedFlipCropSelection":t.value.bool.isSelected=this.rotatedFlipCropSel;break;case"getPrevActObj":t.value.obj.prevActObj=this.prevActObj;break;case"setPrevActObj":this.prevActObj=t.value.prevActObj;break;case"setZoomCropWidth":this.zoomCrop.width=t.value.width,this.zoomCrop.height=t.value.height;break;case"setImageEdited":this.isImageEdited=!0;break;case"reset":this.reset();break;case"setNewPath":this.isNewPath=t.value.bool;break;case"getNewPath":t.value.obj.isNewPath=this.isNewPath;break;case"getArrowDimension":t.value.obj.arrowDimension=y({},this.arrowDimension,{},!0);break;case"setArrowDimension":this.arrowDimension=t.value.arrowDimension;break;case"moveToSelectionRange":this.moveToSelectionRange(t.value.type,t.value.activeObj);break;case"setResizeSelect":this.isResizeSelect=t.value.bool;break;case"applyFrame":this.applyFrame(t.value.ctx,t.value.frame,t.value.preventImg);break;case"drawImage":this.drawImage();break;case"downScaleImgCanvas":this.downScaleImgCanvas(t.value.ctx,t.value.isImgAnnotation,t.value.isHFlip,t.value.isVFlip);break;case"downScale":this.downScale(t.value.canvas,t.value.width,t.value.height);break;case"resetFrameZoom":this.resetFrameZoom(t.value.isOk);break;case"triggerFrameChange":t.value.obj.frameChangeEventArgs=this.triggerFrameChange(t.value.prevFrameSettings);break;case"setImageApply":this.isImageApply=t.value.bool;break;case"zoomToSel":this.zoomToSel(t.value.activeObj,t.value.isToolbar);break;case"getStraightenActObj":t.value.obj.activeObj=this.straightenActObj;break;case"setStraightenActObj":this.straightenActObj=t.value.activeObj;break;case"updateImgCanvasPoints":this.updateImgCanvasPoints();break;case"isLinesIntersect":t.value.obj.isIntersect=this.isLinesIntersect(t.value.obj);break;case"getImageCanvasPoints":t.value.obj.points=this.imgCanvasPoints;break;case"setDestForStraighten":this.setDestForStraighten();break;case"setTempDestForStraighten":this.tempStraightenDestPoints=y({},this.straightenDestPoints,{},!0);break;case"getStraightenInitZoom":t.value.obj.zoomFactor=this.straightenInitZoom;break;case"setStraightenInitZoom":this.straightenInitZoom=t.value.zoomFactor;break;case"isPointsInsideImg":t.value.obj.bool=this.checkPointPosition(t.value.x,t.value.y,this.imgCanvasPoints[0].x,this.imgCanvasPoints[0].y,this.imgCanvasPoints[1].x,this.imgCanvasPoints[1].y,this.imgCanvasPoints[2].x,this.imgCanvasPoints[2].y,this.imgCanvasPoints[3].x,this.imgCanvasPoints[3].y)!=="inside";break;case"setIsCropSelect":this.isCropSelect=t.value.bool;break;case"updateCropSelection":this.updateCropSelection();break;case"updateCropSelObj":this.updateCropSelObj();break;case"redrawDownScale":this.redrawDownScale();break;case"updateFinetune":this.updateFinetune();break;case"isSelOutsideImg":t.value.obj.bool=this.isSelOutsideImg();break;case"resetStraightenDestPoints":this.straightenDestPoints=null;break;case"checkPointPosition":t.value.obj.position=this.checkPointPosition(t.value.obj.x,t.value.obj.y,t.value.obj.x1,t.value.obj.y1,t.value.obj.x2,t.value.obj.y2,t.value.obj.x3,t.value.obj.y3,t.value.obj.x4,t.value.obj.y4);break;case"updateTempObjColl":this.tempObjColl=y([],this.parent.objColl,[],!0);break;case"resetTempObjColl":this.tempObjColl=null;break;case"updateTempPointColl":this.tempPointColl=y({},this.parent.pointColl,{},!0);break;case"resetTempPointColl":this.tempPointColl={};break;case"showDialogPopup":this.showDialogPopup();break;case"imageBackgroundColor":this.imageBackgroundColor=t.value.color;break;case"getImageBackgroundColor":t.value.obj.color=this.imageBackgroundColor;break;case"setTempStrokeWidth":this.tempStrokeWidth=t.value.strokeWidth;break;case"setNullExtension":this.isNullExtension=t.value.extension;break;case"setRedactStraighten":this.isRedactStraighten=t.value.bool;break}},l.prototype.getModuleName=function(){return"draw"},l.prototype.updatePrivateVariables=function(){var t=this.parent;t.lowerCanvas&&(this.lowerContext=t.lowerCanvas.getContext("2d")),t.upperCanvas&&(this.upperContext=t.upperCanvas.getContext("2d")),d(this.tempZoomFactor)&&(this.tempZoomFactor=t.transform.zoomFactor),this.tempTextSettings.fontFamily===""&&(this.tempTextSettings.fontFamily=t.fontFamily.default)},l.prototype.reset=function(){this.isInitialLoading=this.isErrorImage=this.isNewPath=this.isResizeSelect=!1,this.isShapeTextInserted=!1,this.isImageApply=!1,this.isNullExtension=!0,this.initZoomValue=null,this.tempFilter="",this.origDim={width:0,height:0},this.currSelPoint=null,this.isRotateZoom=!1,this.tempAdjValue="",this.tempStrokeSettings={strokeColor:"#fff",fillColor:"",strokeWidth:null,radius:null,outlineColor:"",outlineWidth:null},this.tempTextSettings={text:"Enter Text",fontFamily:this.parent.fontFamily.default,fontSize:null,fontRatio:null,bold:!1,italic:!1,underline:!1},this.tempUndoRedoStep=this.tempFreehandCounter=this.tempCurrFhdIndex=0,this.tempZoomFactor=null,this.isCancelAction=!1,this.rotatedFlipCropSel=!1,this.prevActObj=null,this.tempStraightenDestPoints=null,this.arrowDimension={bar:{width:10,height:32,ratioX:null,ratioY:null},arrow:{width:24,height:24,ratioX:null,ratioY:null},arrowSolid:{width:32,height:32,ratioX:null,ratioY:null},circle:{width:10,height:10,ratioX:null,ratioY:null},square:{width:20,height:20,ratioX:null,ratioY:null}},this.straightenActObj=null,this.imgCanvasPoints=[],this.straightenInitZoom=null,this.allowRedactStraighten=!0,this.tempObjColl=[],this.tempPointColl={},this.imageBackgroundColor="",this.tempStrokeWidth=null,this.straightenDestPoints=null,this.isCropSelect=this.isDownScale=this.preventStraightening=!1,this.isRedactStraighten=!1},l.prototype.redrawDownScale=function(){var t=this.parent;if(t.transform.zoomFactor&&t.transform.zoomFactor<0){var e=y({},t.activeObj,{},!0);t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.isDownScale=!0,this.renderImage(),this.isDownScale=!1,e.shape&&this.drawObject("duplicate",e)}},l.prototype.updateFinetune=function(){var t=this.parent;if(t.transform.zoomFactor&&t.transform.zoomFactor<0){var e=this.lowerContext.filter;this.lowerContext.filter="none",t.notify("draw",{prop:"redrawDownScale"});var i=t.inMemoryCanvas.getContext("2d"),r=this.lowerContext,o=r.getImageData(0,0,r.canvas.width,r.canvas.height);t.inMemoryCanvas.width=o.width,t.inMemoryCanvas.height=o.height,i.putImageData(o,0,0),this.lowerContext.filter=e,t.notify("draw",{prop:"redrawDownScale"})}},l.prototype.drawImage=function(){this.applyFrame(this.lowerContext,this.parent.frameObj.type)},l.prototype.drawObject=function(t,e,i,r,o,a,n){var s=this.parent,h=s.activeObj,p=s.activeObj.activePoint;this.upperContext.clearRect(0,0,s.upperCanvas.width,s.upperCanvas.height);var u;if(t=t.toLowerCase(),t==="original"?u=this.lowerContext:t==="duplicate"?u=this.upperContext:a&&(u=a),!o&&h.shape&&this.setDragLimit(),s.currObjType.shape){var c=s.currObjType.shape.split("-");c[0].toLowerCase()==="crop"&&i&&this.drawCropRatio()}if(h=s.activeObj,p=s.activeObj.activePoint,d(h.strokeSettings)){var f={strokeSettings:{}};s.notify("shape",{prop:"getStrokeSettings",onPropertyChange:!1,value:{obj:f}}),h.strokeSettings=f.strokeSettings}if(d(h.strokeSettings.strokeWidth)&&(h.strokeSettings.strokeWidth=2),e&&(s.activeObj=y({},e,{},!0)),r&&r.startX&&r.startY&&r.endX&&r.endY&&r.width&&r.height&&(p.startX=r.startX,p.startY=r.startY,p.endX=r.endX,p.endY=r.endY,p.width=r.width,p.height=r.height),this.updateActiveObject(),h=s.activeObj,p=s.activeObj.activePoint,!(d(p.startX)&&d(p.startY))){if(s.currObjType.isText){var g={keyHistory:""};s.notify("shape",{prop:"getKeyHistory",onPropertyChange:!1,value:{obj:g}}),h.keyHistory=g.keyHistory}var v=!1;if(t!=="original"){var c=void 0;h.shape&&(c=h.shape.split("-"),c[0]==="crop"&&(v=!0)),v&&(r&&r.startX&&r.startY&&r.endX&&r.endY&&r.width&&r.height?(p.startX=r.startX,p.startY=r.startY,p.endX=r.endX,p.endY=r.endY,p.width=r.width,p.height=r.height):p=h.activePoint,this.upperContext.fillStyle="rgb(0, 0, 0, 0.25)",this.upperContext.fillRect(0,0,s.lowerCanvas.width,s.lowerCanvas.height),this.upperContext.clearRect(p.startX,p.startY,p.width,p.height)),d(n)&&(u===this.lowerContext||u===this.upperContext)&&(this.rotateContext("initial",u),this.drawOuterSelection(u),this.rotateContext("reverse",u))}s.currObjType.isActiveObj=!0;var m={keyHistory:""};s.notify("shape",{prop:"getKeyHistory",onPropertyChange:!1,value:{obj:m}}),e?this.drawShapeObj(t,e.shape,a,n):m.keyHistory!==""&&s.currObjType.isText?this.drawShapeObj(t,"text",a,n):h.shape?this.drawShapeObj(t,h.shape,a,n):this.drawShapeObj(t,void 0,a,n),t==="duplicate"&&v&&h.shape!=="crop-circle"&&s.frameObj.type!=="none"&&(this.applyFrame(this.upperContext,s.frameObj.type),this.drawCornerCircles(this.upperContext))}},l.prototype.rotateContext=function(t,e){var i=this.parent,r=i.activeObj,o=r.shape,a=r.rotatedAngle,n=i.img,s=n.destLeft,h=n.destTop,p=n.destWidth,u=n.destHeight,c=i.activeObj.activePoint,f=c.startX,g=c.startY,v=c.width,m=c.height;if(!(o==="line"||o==="arrow")){var C=t==="initial"?a:-a,M,I;i.transform.straighten===0&&!i.isCropTab?(M=f+v/2,I=g+m/2):(M=s+p/2,I=h+u/2),e.translate(M,I),e.rotate(C),e.translate(-M,-I)}},l.prototype.setDragLimit=function(){var t=this.parent,e=t.activeObj.activePoint,i=t.activeObj,r=i.shape,o=i.rotatedAngle;if(e&&r!=="image"&&r!=="line"&&o===0&&t.activeObj.preventShapeDragOut){var a=t.img,n=a.destLeft,s=a.destTop,h=a.destWidth,p=a.destHeight;e.startX<n?(e.startX=n,e.endX=Math.min(e.startX+e.width,n+h)):e.endX>n+h&&(e.endX=n+h,e.startX=Math.max(e.endX-e.width,n)),e.startY<s?e.startY=s:e.endY>s+p&&(e.endY=s+p,e.startY=Math.max(e.endY-e.height,s)),t.activeObj=this.updateWidthHeight(t.activeObj)}},l.prototype.drawCropRatio=function(){var t=this.parent,e=t.activeObj.activePoint,i,r,o,a,n=t.img,s=n.destLeft,h=n.destTop,p=n.destWidth,u=n.destHeight;if(t.transform.zoomFactor>0&&this.currSelPoint){var c=y({},t.activeObj,{},!0);this.drawCustomSelection("crop-custom",null,null,null,null),t.transform.straighten!==0&&(e=t.activeObj.activePoint),t.transform.degree%90===0&&t.transform.degree%180!==0?(o=e.width<e.height?e.width:e.height,a=o):(o=e.width,a=e.height),t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),t.activeObj=c,t.currObjType.shape=c.shape,this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.currObjType.isCustomCrop=!1}else o=p,a=u,s<0&&(o+=s),h<0&&(a+=h),s+p>t.lowerCanvas.width&&(o-=s+p-t.lowerCanvas.width),h+u>t.lowerCanvas.height&&(a-=h+u-t.lowerCanvas.height);switch(t.currObjType.shape.toLowerCase()){case"crop-square":case"crop-circle":t.notify("selection",{prop:"setDragDirection",onPropertyChange:!1,value:{width:o,height:a}}),e=t.activeObj.activePoint,t.lowerCanvas.width<e.endX-e.startX&&(e.startX=7.5,e.endX=t.lowerCanvas.width-7.5),t.lowerCanvas.height<e.endY-e.startY&&(e.startY=7.5,e.endY=t.lowerCanvas.height-7.5),o===p&&a===u&&(e.startX+=s,e.startY+=h,e.endX+=s,e.endY+=h),t.lowerCanvas.width>t.lowerCanvas.height?(e.height=e.endY-e.startY,e.width=e.height,e.endX=e.startX+e.width):(e.width=e.endX-e.startX,e.height=e.width,e.endY=e.startY+e.height);break;case"crop-3:2":i=3,r=2;break;case"crop-4:3":i=4,r=3;break;case"crop-5:4":i=5,r=4;break;case"crop-7:5":i=7,r=5;break;case"crop-16:9":i=16,r=9;break;case"crop-2:3":i=2,r=3;break;case"crop-3:4":i=3,r=4;break;case"crop-4:5":i=4,r=5;break;case"crop-5:7":i=5,r=7;break;case"crop-9:16":i=9,r=16;break;default:i=parseInt(t.currObjType.shape.toLowerCase().split("crop-")[1].split(":")[0]),r=parseInt(t.currObjType.shape.toLowerCase().split("crop-")[1].split(":")[1]);break}if(i!==void 0&&r!==void 0&&(t.notify("selection",{prop:"calcShapeRatio",onPropertyChange:!1,value:{x:i,y:r,imgWidth:o,imgHeight:a}}),o===p&&a===u&&this.updatePoints(),e=t.activeObj.activePoint),e.startX<s){var f=s-e.startX+7.5;e.startX+=f,e.endX+=f}if(e.startY<h){var f=h-e.startY+7.5;e.startY+=f,e.endY+=f}t.activeObj=this.updateWidthHeight(t.activeObj),this.adjToCenter(),this.enlargeToImg(),t.transform.straighten!==0&&(this.adjToStraighten(),this.updateActiveObject(t.activeObj.activePoint,t.activeObj));var g={isIntersect:null,arr:null},v=0;if(e=t.activeObj.activePoint,t.transform.straighten!==0)for(;this.isLinesIntersect(g)&&v<100;){v++;var f=e.width*1/100;e.startX+=f,e.endX-=f,f=e.height*1/100,e.startY+=f,e.endY-=f,e.width=e.endX-e.startX,e.height=e.endY-e.startY,this.updateActiveObject(e,t.activeObj)}this.straightenInitZoom=t.transform.zoomFactor,this.straightenActObj=y({},t.activeObj,{},!0),t.notify("draw",{prop:"resetStraightenDestPoints"}),t.notify("draw",{prop:"setDestForStraighten"})},l.prototype.adjToCenter=function(){var t=this.parent,e=t.activeObj.activePoint,i=t.img,r=i.destLeft,o=i.destTop,a=i.destWidth,n=i.destHeight,s=t.lowerCanvas.width/2-(e.endX-e.width/2),h=t.lowerCanvas.height/2-(e.endY-e.height/2);if(e.startX+=s,e.endX+=s,e.startY+=h,e.endY+=h,e.startX<(r>=7.5?r:7.5)){var p=(r>=7.5?r:0)-e.startX;e.startX+=p,e.endX+=p}else if(e.endX>r+a){var p=e.endX-(r+a);e.startX-=p,e.endX-=p}if(e.startY<(o>=7.5?o:7.5)){var p=(o>=7.5?o:0)-e.startY;e.startY+=p,e.endY+=p}else if(e.endY>o+n){var p=e.endY-(o+n);e.startY-=p,e.endY-=p}},l.prototype.enlargeToImg=function(){var t=this.parent;if(t.transform.straighten!==0&&t.transform.degree%90===0&&t.transform.degree%180!==0)for(var e=t.activeObj.activePoint,i=y({},e,{},!0),r=0;;){r++;var o=e.width*5/100;e.startX-=o,e.endX+=o,o=e.height*5/100,e.startY-=o,e.endY+=o,e.width=e.endX-e.startX,e.height=e.endY-e.startY,this.updateActiveObject(e,t.activeObj);var a={isIntersect:null,arr:null};if(this.updateImgCanvasPoints(),this.isLinesIntersect(a),a.arr[0]||a.arr[1]||a.arr[2]||a.arr[3]||e.startX<7.5||e.startY<7.5||r===100){e=y({},i,{},!0),o=e.width*1/100,e.startX+=o,e.endX-=o,o=e.height*1/100,e.startY+=o,e.endY-=o,e.width=e.endX-e.startX,e.height=e.endY-e.startY,this.updateActiveObject(e,t.activeObj);break}i=y({},e,{},!0)}},l.prototype.updateActiveObject=function(t,e,i,r,o){var a=this.parent;t=t||y({},a.activeObj.activePoint,{},!0),e=e||y({},a.activeObj,{},!0),t.width=t.endX-t.startX,t.height=t.endY-t.startY;var n=t.startX,s=t.startY,h=t.endX,p=t.endY,u=t.width,c=t.height;r=r||0,o=o||0;var f=u/2,g=c/2,v=7.5;e.horTopLine={startX:n+r,startY:s-o,endX:h+r,endY:p+o},e.horBottomLine={startX:n-r,startY:p-o,endX:h-r,endY:p+o},e.verLeftLine={startX:n+r,startY:s-o,endX:n-o,endY:p-o},e.verRightLine={startX:h+r,startY:s+o,endX:h-r,endY:p+o},e.topLeftCircle={startX:n,startY:s,radius:e.horTopLine.endX?v:0},e.topCenterCircle={startX:n+f,startY:s,radius:e.horTopLine.endX?v:0},e.topRightCircle={startX:h,startY:s,radius:e.horTopLine.endX?v:0},e.centerLeftCircle={startX:n,startY:s+g,radius:e.horTopLine.endX?v:0},e.centerRightCircle={startX:h,startY:s+g,radius:e.horTopLine.endX?v:0},e.bottomLeftCircle={startX:n,startY:p,radius:e.horTopLine.endX?v:0},e.bottomCenterCircle={startX:n+f,startY:p,radius:e.horTopLine.endX?v:0},e.bottomRightCircle={startX:h,startY:p,radius:e.horTopLine.endX?v:0},e.rotatedAngle===0&&(e.rotationCirclePoint={x:e.bottomCenterCircle.startX,y:e.bottomCenterCircle.startY+25},e.rotationCirclePoint.ratioX=(e.rotationCirclePoint.x-a.img.destLeft)/a.img.destWidth,e.rotationCirclePoint.ratioY=(e.rotationCirclePoint.y-a.img.destTop)/a.img.destHeight),e.activePoint=t,d(i)&&(a.activeObj=y({},e,{},!0))},l.prototype.drawOuterSelection=function(t,e){var i,r=this.parent,o=r.activeObj.activePoint,a=r.activeObj;t.lineWidth=.5;var n=y({},a,{},!0);if(a.shape&&(i=a.shape.split("-")),(i&&i[0]==="crop"||a.shape===void 0)&&!e&&(this.upperContext.fillStyle="rgb(0, 0, 0, 0.25)",this.upperContext.fillRect(0,0,r.lowerCanvas.width,r.lowerCanvas.height),this.upperContext.clearRect(o.startX,o.startY,o.width,o.height)),t.strokeStyle=r.themeColl[r.theme].primaryColor,t.fillStyle=r.themeColl[r.theme].secondaryColor,n.shapeDegree===0?r.transform.degree:r.transform.degree-n.shapeDegree,a.shape==="arrow"||a.shape==="line")t.beginPath(),t.moveTo(o.startX,o.startY),t.lineTo(o.endX,o.endY),t.stroke();else if(a.shape==="path"){t.beginPath();var s=y({},r.activeObj,{},!0);if(s.pointColl[0]&&(t.moveTo(s.pointColl[0].x,s.pointColl[0].y),s.pointColl.length>1))for(var h=1,p=s.pointColl.length;h<p;h++)o.endX=s.pointColl[h].x,o.endY=s.pointColl[h].y,t.lineTo(o.endX,o.endY);var u={shape:null};r.notify("selection",{prop:"getCurrentDrawingShape",value:{obj:u}}),u.shape==="path"&&(r.activeObj=a=s),t.lineTo(o.endX,o.endY),t.stroke()}else this.drawCornerCircles(t);if(r.selectionSettings.showCircle&&(i===void 0||i[0]!=="crop")){var c=t.strokeStyle,f=t.fillStyle;t.strokeStyle=r.selectionSettings.strokeColor,t.fillStyle=r.selectionSettings.fillColor,a.shape==="text"?(t.lineWidth*=2,t.beginPath(),this.drawRotationArcLine(t),t.lineTo(a.rotationCirclePoint.x,a.rotationCirclePoint.y),t.stroke(),t.fill(),t.closePath(),t.beginPath(),t.moveTo(a.rotationCirclePoint.x,a.rotationCirclePoint.y),t.arc(a.rotationCirclePoint.x,a.rotationCirclePoint.y,a.bottomCenterCircle.radius,0,2*Math.PI),t.stroke(),t.fill(),t.closePath(),t.lineWidth/=2):r.activeObj.shape!=="redact"&&this.drawCenterCircles(t),t.strokeStyle=c,t.fillStyle=f}n.rotationCircleLine=a.rotationCircleLine,r.activeObj=y({},n,{},!0)},l.prototype.drawArrowHead=function(t,e){var i=e?this.parent.activeObj.start:this.parent.activeObj.end;switch(i){case"arrowSolid":e?this.arrowSolid(t,!0):this.arrowSolid(t,!1);break;case"arrow":e?this.arrow(t,!0):this.arrow(t,!1);break;case"circleSolid":e?this.arrowCircleSolid(t,!0):this.arrowCircleSolid(t,!1);break;case"circle":e?this.arrowCircle(t,!0):this.arrowCircle(t,!1);break;case"bar":e?this.arrowBar(t,!0):this.arrowBar(t,!1);break;case"square":case"squareSolid":e?this.arrowSquareStart(t):this.arrowSquareEnd(t);break}},l.prototype.drawShapeObj=function(t,e,i,r){var o=this.parent,a=o.activeObj.activePoint,n=o.activeObj,s=n.strokeSettings,h=s.strokeColor,p=s.fillColor,u=s.strokeWidth,c=e!==void 0?e:o.currObjType.shape;o.currObjType.shape=c;var f;t.toLowerCase()==="original"?f=this.lowerContext:t.toLowerCase()==="duplicate"?f=this.upperContext:i&&(f=i);var g=o.currObjType.shape.toLowerCase(),v=["rectangle","ellipse","line","arrow","path","image","redact"];v.indexOf(g)!==-1&&(n.shape=o.currObjType.shape),f.strokeStyle=h,e==="text"||e==="freehanddraw"?f.fillStyle=h:f.fillStyle=p;var m=a.width/3,C=a.height/3,M=a.endX-a.startX,I=a.endY-a.startY;this.rotateContext("initial",f);var N=f.fillStyle,O;switch(o.currObjType.shape.toLowerCase()){case"rectangle":this.drawSquareLines(f),d(r)&&f===this.upperContext&&this.drawOuterSelection(f);break;case"redact":this.drawRedact(f,n),d(r)&&f===this.upperContext&&this.drawOuterSelection(f),o.currObjType.isRedact=!0;break;case"ellipse":M=Math.abs(M),I=Math.abs(I),f.beginPath(),f.ellipse(a.startX+M/2,a.startY+I/2,M/2,I/2,0,0,2*Math.PI,!1),p!==""&&(f.fillStyle=p,f.fill()),f.ellipse(a.startX+M/2,a.startY+I/2,Math.abs(M/2-u),Math.abs(I/2-u),0,0,2*Math.PI,!1),f.fillStyle=h,f.fill("evenodd"),f.closePath(),d(r)&&f===this.upperContext&&this.drawOuterSelection(f);break;case"crop-circle":this.shapeCircle(f,M,I);break;case"line":this.shapeLine(f,a.startX,a.startY,a.endX,a.endY),d(r)&&f===this.upperContext&&this.drawOuterSelection(f);break;case"arrow":n.shapeDegree===0?o.transform.degree:o.transform.degree-n.shapeDegree,f.fillStyle=f.strokeStyle,d(n.triangleDirection)&&(n.triangleDirection="right"),d(n.start)&&(n.start="none"),d(n.end)&&(n.end="arrowSolid"),this.drawArrowHead(f,!0),this.drawArrowHead(f,!1),n.end==="none"&&n.start!=="circle"&&n.start!=="square"&&this.shapeLine(f,a.startX,a.startY,a.endX,a.endY),f.fillStyle=N,d(r)&&f===this.upperContext&&this.drawOuterSelection(f);break;case"path":if(O=y({},o.activeObj,{},!0),O.pointColl.length>1){var x={shape:null};if(o.notify("selection",{prop:"getCurrentDrawingShape",value:{obj:x}}),x.shape==="path"&&o.isShapeDrawing)for(var D={x:0,y:0},A=0,P=O.pointColl.length;A<P;A++)d(O.pointColl[A+1])?(D.x=O.activePoint.endX,D.y=O.activePoint.endY):(D.x=O.pointColl[A+1].x,D.y=O.pointColl[A+1].y),a.startX=O.pointColl[A].x,a.startY=O.pointColl[A].y,a.endX=D.x,a.endY=D.y,o.activeObj=this.updateWidthHeight(o.activeObj),this.shapeLine(f,a.startX,a.startY,a.endX,a.endY),S.isDevice&&(O.activePoint.endX=D.x,O.activePoint.endY=D.y);else for(var A=1,P=O.pointColl.length;A<P;A++)a.startX=O.pointColl[A-1].x,a.startY=O.pointColl[A-1].y,a.endX=O.pointColl[A].x,a.endY=O.pointColl[A].y,o.activeObj=this.updateWidthHeight(o.activeObj),this.shapeLine(f,a.startX,a.startY,a.endX,a.endY);o.activeObj=n=O}else this.shapeLine(f,a.startX,a.startY,a.endX,a.endY);f===this.upperContext&&this.drawOuterSelection(f);break;case"text":this.shapeText(f);break;case"image":this.shapeImage(f),d(r)&&f===this.upperContext&&this.drawOuterSelection(f);break;case"crop-square":case"crop-3:4":case"crop-4:3":case"crop-6:9":case"crop-9:6":case"crop-9:16":case"crop-16:9":f===this.lowerContext&&(f=this.upperContext),this.drawSelection(m,C),o.currObjType.shape="";break;default:this.drawSelection(m,C);break}this.rotateContext("reverse",f)},l.prototype.updatePoints=function(){var t=this.parent,e=t.activeObj.activePoint,i=t.img,r=i.destLeft,o=i.destTop;e.startX+=r,e.startY+=o,e.endX+=r,e.endY+=o,t.activeObj=this.updateWidthHeight(t.activeObj)},l.prototype.updateWidthHeight=function(t){var e=t.activePoint,i=e.startX,r=e.startY,o=e.endX,a=e.endY;return t.activePoint.width=o-i,t.activePoint.height=a-r,t},l.prototype.drawCornerCircles=function(t){var e=this.parent,i=e.activeObj;if(t.beginPath(),t.rect(i.activePoint.startX,i.activePoint.startY,i.activePoint.width,i.activePoint.height),t.stroke(),t.closePath(),e.selectionSettings.showCircle){var r=t.strokeStyle,o=t.fillStyle;t.strokeStyle=e.selectionSettings.strokeColor,t.fillStyle=e.selectionSettings.fillColor,t.lineWidth*=2,t.beginPath(),t.moveTo(i.topLeftCircle.startX,i.topLeftCircle.startY),t.arc(i.topLeftCircle.startX,i.topLeftCircle.startY,i.topLeftCircle.radius,0,2*Math.PI),t.moveTo(i.topRightCircle.startX,i.topRightCircle.startY),t.arc(i.topRightCircle.startX,i.topRightCircle.startY,i.topRightCircle.radius,0,2*Math.PI),t.moveTo(i.bottomLeftCircle.startX,i.bottomLeftCircle.startY),t.arc(i.bottomLeftCircle.startX,i.bottomLeftCircle.startY,i.bottomLeftCircle.radius,0,2*Math.PI),t.moveTo(i.bottomRightCircle.startX,i.bottomRightCircle.startY),t.arc(i.bottomRightCircle.startX,i.bottomRightCircle.startY,i.bottomRightCircle.radius,0,2*Math.PI),t.stroke(),t.fill(),t.closePath(),t.lineWidth/=2,t.strokeStyle=r,t.fillStyle=o}},l.prototype.drawCenterCircles=function(t){var e=this.parent,i=e.activeObj.activePoint,r=e.activeObj;if(t.lineWidth*=2,t.beginPath(),r.shape==="arrow"||r.shape==="line")t.moveTo(i.startX,i.startY),t.arc(i.startX,i.startY,r.topCenterCircle.radius,0,2*Math.PI),t.moveTo(i.endX,i.endY),t.arc(i.endX,i.endY,r.bottomCenterCircle.radius,0,2*Math.PI);else if(r.shape==="path"){var o=y({},e.activeObj,{},!0);if(o.pointColl.length>1)for(var a=1,n=o.pointColl.length;a<n;a++)i.startX=o.pointColl[a-1].x,i.startY=o.pointColl[a-1].y,i.endX=o.pointColl[a].x,i.endY=o.pointColl[a].y,t.moveTo(i.startX,i.startY),t.arc(i.startX,i.startY,r.topCenterCircle.radius,0,2*Math.PI),t.moveTo(i.endX,i.endY),t.arc(i.endX,i.endY,r.bottomCenterCircle.radius,0,2*Math.PI);var s={shape:null};e.notify("selection",{prop:"getCurrentDrawingShape",value:{obj:s}}),s.shape==="path"&&(e.activeObj=r=o),t.moveTo(i.startX,i.startY),t.arc(i.startX,i.startY,r.topCenterCircle.radius,0,2*Math.PI),t.moveTo(i.endX,i.endY),t.arc(i.endX,i.endY,r.bottomCenterCircle.radius,0,2*Math.PI)}else this.drawRotationArcLine(t),t.lineTo(r.rotationCirclePoint.x,r.rotationCirclePoint.y);t.stroke(),t.fill(),t.closePath(),r.shape!=="arrow"&&r.shape!=="line"&&r.shape!=="path"&&(t.beginPath(),t.moveTo(r.rotationCirclePoint.x,r.rotationCirclePoint.y),t.arc(r.rotationCirclePoint.x,r.rotationCirclePoint.y,r.bottomCenterCircle.radius,0,2*Math.PI),t.stroke(),t.fill(),t.closePath()),t.lineWidth/=2},l.prototype.drawRotationArcLine=function(t){var e=this.parent,i=e.activeObj;d(i.rotationCircleLine)&&(i.rotationCircleLine=22.5);var r,o=!1,a=!1;if(i.shapeDegree===0?r=e.transform.degree:r=e.transform.degree-i.shapeDegree,r<0&&(r=360+r),i.flipObjColl)for(var n=0,s=i.flipObjColl.length;n<s;n++){var h=i.flipObjColl[n].toLowerCase();h==="horizontal"?o=!0:h==="vertical"&&(a=!0)}switch(r){case 0:case 360:a?(i.rotationCirclePoint={x:i.topCenterCircle.startX,y:i.topCenterCircle.startY-i.rotationCircleLine},t.moveTo(i.rotationCirclePoint.x,i.rotationCirclePoint.y+i.rotationCircleLine)):(i.rotationCirclePoint={x:i.bottomCenterCircle.startX,y:i.bottomCenterCircle.startY+i.rotationCircleLine},t.moveTo(i.rotationCirclePoint.x,i.rotationCirclePoint.y-i.rotationCircleLine));break;case 90:case-270:o?(i.rotationCirclePoint={x:i.centerRightCircle.startX+i.rotationCircleLine,y:i.centerLeftCircle.startY},t.moveTo(i.rotationCirclePoint.x-i.rotationCircleLine,i.rotationCirclePoint.y)):(i.rotationCirclePoint={x:i.centerLeftCircle.startX-i.rotationCircleLine,y:i.centerLeftCircle.startY},t.moveTo(i.rotationCirclePoint.x+i.rotationCircleLine,i.rotationCirclePoint.y));break;case 180:case-180:a?(i.rotationCirclePoint={x:i.bottomCenterCircle.startX,y:i.bottomCenterCircle.startY+i.rotationCircleLine},t.moveTo(i.rotationCirclePoint.x,i.rotationCirclePoint.y-i.rotationCircleLine)):(i.rotationCirclePoint={x:i.topCenterCircle.startX,y:i.topCenterCircle.startY-i.rotationCircleLine},t.moveTo(i.rotationCirclePoint.x,i.rotationCirclePoint.y+i.rotationCircleLine));break;case 270:case-90:o?(i.rotationCirclePoint={x:i.centerLeftCircle.startX-i.rotationCircleLine,y:i.centerLeftCircle.startY},t.moveTo(i.rotationCirclePoint.x+i.rotationCircleLine,i.rotationCirclePoint.y)):(i.rotationCirclePoint={x:i.centerRightCircle.startX+i.rotationCircleLine,y:i.centerLeftCircle.startY},t.moveTo(i.rotationCirclePoint.x-i.rotationCircleLine,i.rotationCirclePoint.y));break}},l.prototype.drawSquareLines=function(t){var e,i=this.parent,r=i.activeObj,o=r.activePoint,a=o.startX,n=o.startY,s=o.width,h=o.height,p=r.strokeSettings,u=p.fillColor,c=p.strokeColor,f=p.strokeWidth,g=p.radius;r.shape&&(e=r.shape.split("-")),e[0]==="crop"?t.strokeStyle="#fff":t.strokeStyle=c,t.beginPath();var v={width:0,height:0},m={width:1,height:1};i.notify("crop",{prop:"calcRatio",onPropertyChange:!1,value:{obj:v,dimension:{width:t.canvas.width,height:t.canvas.height}}}),m=v;var C=t.canvas.id===i.element.id+"_tempCanvas",M=i.transform.zoomFactor,I=C?g*10*((m.width+m.height)/2):g*10,N=I+I*M;g!==null?i.isSafari?this.drawRoundedRect(t,a,n,s,h,N):t.roundRect(a,n,s,h,N):t.rect(a,n,s,h),u!==""&&(t.fillStyle=u,t.fill()),g!==null?i.isSafari?this.drawRoundedRect(t,a+f,n+f,s-2*f,h-2*f,N):t.roundRect(a+f,n+f,s-2*f,h-2*f,N):t.rect(a+f,n+f,s-2*f,h-2*f),t.fillStyle=c,t.fill("evenodd"),t.closePath()},l.prototype.drawRoundedRect=function(t,e,i,r,o,a){var n=Math.max(0,Math.min(a,r/2,o/2));t.moveTo(e+n,i),t.arcTo(e+r,i,e+r,i+o,n),t.arcTo(e+r,i+o,i,i+o,n),t.arcTo(e,i+o,e,i,n),t.arcTo(e,i,e+r,i,n),t.closePath()},l.prototype.drawSelection=function(t,e){var i=this.parent,r=i.activeObj,o=r.activePoint,a=o.startX,n=o.startY,s=o.endX,h=o.endY;this.upperContext.strokeStyle=i.themeColl[i.theme].primaryColor,this.upperContext.beginPath(),r.horTopInnerLine={startX:a,startY:n+e,endX:s,endY:h+e},r.horBottomInnerLine={startX:a,startY:n+2*e,endX:s,endY:h+2*e},r.verLeftInnerLine={startX:a+t,startY:n,endX:a+t,endY:h},r.verRightInnerLine={startX:a+2*t,startY:n,endX:a+2*t,endY:h},this.upperContext.moveTo(r.horTopInnerLine.startX,r.horTopInnerLine.startY),this.upperContext.lineTo(r.horTopInnerLine.endX,r.horTopInnerLine.startY),this.upperContext.moveTo(r.horBottomInnerLine.startX,r.horBottomInnerLine.startY),this.upperContext.lineTo(r.horBottomInnerLine.endX,r.horBottomInnerLine.startY),this.upperContext.moveTo(r.verLeftInnerLine.startX,r.verLeftInnerLine.startY),this.upperContext.lineTo(r.verLeftInnerLine.endX,r.verLeftInnerLine.endY),this.upperContext.moveTo(r.verRightInnerLine.startX,r.verRightInnerLine.startY),this.upperContext.lineTo(r.verRightInnerLine.endX,r.verRightInnerLine.endY),this.upperContext.stroke(),this.upperContext.closePath()},l.prototype.shapeCircle=function(t,e,i){var r=this.parent,o=r.activeObj.activePoint,a=o.startX,n=o.startY,s=o.endX,h=o.endY,p=o.width;t.strokeStyle=r.themeColl[r.theme].primaryColor,t.clearRect(0,0,r.lowerCanvas.width,r.lowerCanvas.height),t.fillStyle="rgb(0, 0, 0, 0.25)",t.fillRect(0,0,r.lowerCanvas.width,r.lowerCanvas.height);var u=t.lineWidth;t.lineWidth=2,t.beginPath(),t.ellipse(r.activeObj.horTopLine.startX+e/2,r.activeObj.horTopLine.startY+i/2,e/2,i/2,0,0,2*Math.PI,!1),t.stroke(),t.closePath(),t.save(),t.beginPath(),t.arc((s-a)/2+a,(h-n)/2+n,p/2,0,Math.PI*2),t.closePath(),t.clip(),t.clearRect(0,0,r.lowerCanvas.width,r.lowerCanvas.height),t.restore(),t.lineWidth=u,this.drawOuterSelection(t,!0),r.currObjType.shape=""},l.prototype.shapeLine=function(t,e,i,r,o){var a=t.lineWidth;t.lineWidth=this.parent.activeObj.strokeSettings.strokeWidth,t.beginPath(),t.moveTo(e,i),t.lineTo(r,o),t.stroke(),t.lineWidth=a},l.prototype.manipulateSaveCtx=function(t,e,i){if(t!==this.lowerContext&&t!==this.upperContext){var r={width:0,height:0};this.parent.notify("crop",{prop:"calcRatio",onPropertyChange:!1,value:{obj:r,dimension:{width:t.canvas.width,height:t.canvas.height}}});var o=r;e&&(e*=o.width),i&&(i*=o.height)}return{x:e,y:i}},l.prototype.arrow=function(t,e){var i=this.parent,r=i.activeObj,o=r.activePoint,a=o.startX,n=o.startY,s=o.endX,h=o.endY,p=r.strokeSettings.strokeWidth;t.lineWidth=p;var u=this.arrowDimension.arrow.width,c=this.arrowDimension.arrow.height,f=this.manipulateSaveCtx(t,u,c);u=f.x+p,c=f.y+p,this.dx=s-a,this.dy=h-n,t.fillStyle=r.strokeSettings.strokeColor;var g=Math.atan2(this.dy,this.dx),v=r.start==="arrow",m=r.end==="arrow",C=r.end==="circle"||r.end==="square",M=r.start==="circle"||r.start==="square";((e&&r.triangleDirection==="left"||r.triangleDirection==="right")&&(v&&r.end==="none"||v&&!C&&!M)||!e&&(m&&r.start==="none"||!v&&!C&&!M))&&this.shapeLine(t,a,n,s,h),e&&r.triangleDirection==="left"||!e&&r.triangleDirection==="right"?(t.translate(s,h),t.rotate(g),this.shapeLine(t,0,0,-u,c/2),this.shapeLine(t,0,0,-u,-c/2),t.rotate(-g),t.translate(-s,-h)):(e&&r.triangleDirection==="right"||!e&&r.triangleDirection==="left")&&(t.translate(a,n),t.rotate(g),this.shapeLine(t,0,0,u,c/2),this.shapeLine(t,0,0,u,-c/2),t.rotate(-g),t.translate(-a,-n))},l.prototype.arrowSolid=function(t,e){var i=this.parent,r=i.activeObj,o=r.strokeSettings.strokeWidth,a=r.activePoint,n=a.startX,s=a.startY,h=a.endX,p=a.endY,u=this.arrowDimension.arrowSolid.width,c=this.arrowDimension.arrowSolid.height,f=this.manipulateSaveCtx(t,u,c);u=f.x+o,c=f.y+o,this.dx=h-n,this.dy=p-s;var g=Math.atan2(this.dy,this.dx),v=r.start==="arrowSolid",m=r.end==="arrowSolid",C=r.end==="circle"||r.end==="square",M=r.start==="circle"||r.start==="square";(e&&v&&r.end==="none"||v&&!C&&!M||!e&&(m&&r.start==="none"||!v&&!C&&!M))&&this.shapeLine(t,n,s,h,p),e&&r.triangleDirection==="left"||!e&&r.triangleDirection==="right"?(t.translate(h,p),t.rotate(g),t.beginPath(),t.moveTo(o,0),t.lineTo(-u+c/2,c/2),t.lineTo(-u+c/2,-c/2),t.closePath(),t.fill(),t.rotate(-g),t.translate(-h,-p),r.rotatedAngle=g):(e&&r.triangleDirection==="right"||!e&&r.triangleDirection==="left")&&(t.translate(n,s),t.rotate(g),t.beginPath(),t.moveTo(0-o,0),t.lineTo(u-c/2,c/2),t.lineTo(u-c/2,-c/2),t.closePath(),t.fill(),t.rotate(-g),t.translate(-n,-s),r.rotatedAngle=g)},l.prototype.arrowSquareStart=function(t){var e=this.parent,i=e.activeObj,r=i.strokeSettings.strokeWidth,o=i.activePoint,a=o.startX,n=o.startY,s=o.endX,h=o.endY,p=i.start==="square",u=i.end==="circle",c=i.start==="squareSolid",f=i.end==="circleSolid";(p&&i.end==="none"||p&&!u&&i.start!=="square"||c&&f)&&this.shapeLine(t,a,n,s,h),t.lineWidth=r,t.beginPath(),t.fillStyle=i.strokeSettings.strokeColor;var g=this.arrowDimension.square.width,v=this.arrowDimension.square.height,m=this.manipulateSaveCtx(t,g,v);g=m.x+r,v=m.y+r,this.dx=s-a,this.dy=h-n;var C=Math.atan2(this.dy,this.dx);i.triangleDirection==="left"?(t.translate(s,h),t.rotate(C),i.start==="squareSolid"&&t.fillRect(-g+v/2,-v/2,g,v),t.strokeRect(-g+v/2,-v/2,g,v),t.rotate(-C),t.translate(-s,-h),this.squareStartIntersectX1=s-v/2*Math.cos(C),this.squareStartIntersectY1=h-v/2*Math.sin(C),i.start==="square"&&i.end!=="square"&&i.end!=="circle"?this.shapeLine(t,a,n,this.squareStartIntersectX1,this.squareStartIntersectY1):i.start==="square"&&i.end==="circle"?this.shapeLine(t,this.endCircleIntersectX1,this.endCircleIntersectY1,this.squareStartIntersectX1,this.squareStartIntersectY1):i.start==="squareSolid"&&i.end==="squareSolid"&&this.shapeLine(t,a,n,s,h)):i.triangleDirection==="right"&&(t.lineWidth=r,t.fillStyle=i.strokeSettings.strokeColor,i.start==="squareSolid"&&i.end==="squareSolid"&&this.shapeLine(t,a,n,s,h),t.translate(a,n),t.rotate(C),i.start==="squareSolid"&&t.fillRect(v/2-g,-v/2,g,v),t.strokeRect(v/2-g,-v/2,g,v),t.rotate(-C),t.translate(-a,-n),i.rotatedAngle=C,this.squareStartIntersectX1=a+v/2*Math.cos(C),this.squareStartIntersectY1=n+v/2*Math.sin(C),i.start==="square"&&i.end!=="square"&&i.end!=="circle"&&this.shapeLine(t,s,h,this.squareStartIntersectX1,this.squareStartIntersectY1),i.start==="square"&&i.end==="circle"&&this.shapeLine(t,this.endCircleIntersectX1,this.endCircleIntersectY1,this.squareStartIntersectX1,this.squareStartIntersectY1))},l.prototype.arrowSquareEnd=function(t){var e=this.parent,i=e.activeObj,r=i.activePoint,o=r.startX,a=r.startY,n=r.endX,s=r.endY,h=i.strokeSettings.strokeWidth,p=this.arrowDimension.square.width,u=this.arrowDimension.square.height,c=this.manipulateSaveCtx(t,p,u);p=c.x+h,u=c.y+h,this.dx=n-o,this.dy=s-a;var f=Math.atan2(this.dy,this.dx);t.lineWidth=h,i.triangleDirection==="right"?(t.fillStyle=i.strokeSettings.strokeColor,i.end==="squareSolid"&&i.start==="none"&&this.shapeLine(t,o,a,n,s),t.translate(n,s),t.rotate(f),i.end==="squareSolid"&&t.fillRect(-p+u/2,-u/2,p,u),t.strokeRect(-p+u/2,-u/2,p,u),t.rotate(-f),t.translate(-n,-s),i.rotatedAngle=f,this.squareEndIntersectX1=n-u/2*Math.cos(f),this.squareEndIntersectY1=s-u/2*Math.sin(f),i.end==="square"&&i.start!=="square"&&i.start!=="circle"?this.shapeLine(t,o,a,this.squareEndIntersectX1,this.squareEndIntersectY1):i.start==="circle"&&i.end==="square"?this.shapeLine(t,this.squareEndIntersectX1,this.squareEndIntersectY1,this.startCircleIntersectX1,this.startCircleIntersectY1):i.start==="square"&&i.end==="square"&&this.shapeLine(t,this.squareEndIntersectX1,this.squareEndIntersectY1,this.squareStartIntersectX1,this.squareStartIntersectY1)):i.triangleDirection==="left"&&(t.translate(o,a),t.rotate(f),i.end==="squareSolid"&&t.fillRect(u/2-p,-u/2,p,u),t.strokeRect(u/2-p,-u/2,p,u),t.rotate(-f),t.translate(-o,-a),i.rotatedAngle=f,this.squareEndIntersectX1=o+u/2*Math.cos(f),this.squareEndIntersectY1=a+u/2*Math.sin(f),i.end==="square"&&i.start!=="square"&&i.start!=="circle"?this.shapeLine(t,n,s,this.squareEndIntersectX1,this.squareEndIntersectY1):i.start==="circle"&&i.end==="square"?this.shapeLine(t,this.squareEndIntersectX1,this.squareEndIntersectY1,this.startCircleIntersectX1,this.startCircleIntersectY1):i.start==="square"&&i.end==="square"?this.shapeLine(t,this.squareEndIntersectX1,this.squareEndIntersectY1,this.squareStartIntersectX1,this.squareStartIntersectY1):i.end==="squareSolid"&&i.start==="none"&&this.shapeLine(t,o,a,n,s))},l.prototype.arrowCircle=function(t,e){var i=this.parent,r=i.activeObj,o=r.activePoint,a=o.startX,n=o.startY,s=o.endX,h=o.endY,p=r.strokeSettings.strokeWidth;if(e&&r.triangleDirection==="left"||!e&&r.triangleDirection==="right"){t.lineWidth=p;var u=this.arrowDimension.circle.width,c=this.manipulateSaveCtx(t,u,null);u=c.x+p,t.beginPath(),t.arc(s,h,u,0,2*Math.PI),t.stroke(),t.closePath(),this.dx=s-a,this.dy=h-n;var f=this.dx*this.dx+this.dy*this.dy,g=2*(this.dx*(a-s)+this.dy*(n-h)),v=(a-s)*(a-s)+(n-h)*(n-h)-u*u,m=g*g-4*f*v;if(m>=0){t.fillStyle=r.strokeSettings.strokeColor;var C=(-g-Math.sqrt(m))/(2*f),M=a+this.dx*C,I=n+this.dy*C;e?(this.startCircleIntersectX1=M,this.startCircleIntersectY1=I,this.endCircleIntersectX1=s-this.dx*C,this.endCircleIntersectY1=h-this.dy*C,t.beginPath(),t.fill(),t.beginPath(),r.start==="circle"&&r.end==="circle"?this.shapeLine(t,this.startCircleIntersectX1,this.startCircleIntersectY1,this.endCircleIntersectX1,this.endCircleIntersectY1):r.start==="circle"&&r.end!=="circle"&&r.end!=="square"&&this.shapeLine(t,a,n,this.startCircleIntersectX1,this.startCircleIntersectY1),t.stroke(),t.closePath()):(this.endCircleIntersectX1=M,this.endCircleIntersectY1=I,r.end==="circle"&&r.start!=="circle"&&r.start!=="square"&&this.shapeLine(t,a,n,this.endCircleIntersectX1,this.endCircleIntersectY1))}var N=Math.atan2(this.dy,this.dx);i.activeObj.rotatedAngle=N}else if(e&&r.triangleDirection==="right"||!e&&r.triangleDirection==="left"){t.lineWidth=p;var u=this.arrowDimension.circle.width,c=this.manipulateSaveCtx(t,u,null);u=c.x+p,t.beginPath(),t.arc(a,n,u,0,2*Math.PI),t.stroke(),t.closePath(),this.dx=a-s,this.dy=n-h;var f=this.dx*this.dx+this.dy*this.dy,g=2*(this.dx*(s-a)+this.dy*(h-n)),v=(s-a)*(s-a)+(h-n)*(h-n)-u*u,m=g*g-4*f*v;if(m>=0){t.fillStyle=r.strokeSettings.strokeColor;var C=(-g-Math.sqrt(m))/(2*f),M=s+this.dx*C,I=h+this.dy*C;e?(this.startCircleIntersectX1=M,this.startCircleIntersectY1=I,this.endCircleIntersectX1=a-this.dx*C,this.endCircleIntersectY1=n-this.dy*C,r.start==="circle"&&r.end==="circle"?this.shapeLine(t,this.endCircleIntersectX1,this.endCircleIntersectY1,this.startCircleIntersectX1,this.startCircleIntersectY1):r.start==="circle"&&r.end!=="circle"&&r.end!=="square"&&this.shapeLine(t,s,h,this.startCircleIntersectX1,this.startCircleIntersectY1)):(this.endCircleIntersectX1=M,this.endCircleIntersectY1=I,t.beginPath(),t.fill(),t.beginPath(),r.end==="circle"&&r.start!=="circle"&&r.start!=="square"&&this.shapeLine(t,s,h,this.endCircleIntersectX1,this.endCircleIntersectY1))}var N=Math.atan2(this.dy,this.dx);i.activeObj.rotatedAngle=N}},l.prototype.arrowCircleSolid=function(t,e){var i=this.parent,r=i.activeObj,o=r.activePoint,a=o.startX,n=o.startY,s=o.endX,h=o.endY,p=r.start==="circleSolid",u=r.strokeSettings.strokeWidth;if(e&&r.triangleDirection==="left"||!e&&r.triangleDirection==="right"){t.lineWidth=u,t.beginPath(),t.fillStyle=r.strokeSettings.strokeColor,(e&&p&&r.end==="none"||p&&r.end!=="circle"&&r.end!=="square"||!e&&r.end==="circleSolid"&&r.start==="none")&&this.shapeLine(t,a,n,s,h);var c=this.arrowDimension.circle.width,f=this.manipulateSaveCtx(t,c,null);c=f.x+u,this.dx=s-a,this.dy=h-n,t.save(),t.beginPath(),t.arc(s,h,c,0,2*Math.PI),t.stroke(),t.fill(),t.closePath(),r.rotatedAngle=Math.atan2(this.dy,this.dx)}else if(e&&r.triangleDirection==="right"||!e&&r.triangleDirection==="left"){t.lineWidth=u,t.beginPath(),t.fillStyle=r.strokeSettings.strokeColor,(e&&p&&r.end==="none"||p&&r.end!=="circle"&&r.end!=="square"||!e&&r.end==="circleSolid"&&r.start==="none")&&this.shapeLine(t,a,n,s,h);var c=this.arrowDimension.circle.width,f=this.manipulateSaveCtx(t,c,null);c=f.x+u,this.dx=s-a,this.dy=h-n,t.save(),t.beginPath(),t.arc(a,n,c,0,2*Math.PI),t.stroke(),t.fill(),t.closePath(),r.rotatedAngle=Math.atan2(this.dy,this.dx)}},l.prototype.arrowBar=function(t,e){var i=this.parent,r=i.activeObj,o=r.activePoint,a=o.startX,n=o.startY,s=o.endX,h=o.endY,p=r.strokeSettings.strokeWidth;if(e&&r.triangleDirection==="left"||!e&&r.triangleDirection==="right"){t.lineWidth=p,t.beginPath(),t.fillStyle=r.strokeSettings.strokeColor,(e&&r.start==="bar"&&r.end==="none"||r.start==="bar"&&r.end!=="circle"&&r.end!=="square"||!e&&(r.end==="bar"&&r.start==="none"||r.end==="bar"&&r.start!=="circle"&&r.start!=="square"))&&this.shapeLine(t,a,n,s,h);var u=this.arrowDimension.bar.width,c=this.arrowDimension.bar.height,f=this.manipulateSaveCtx(t,u,c);u=f.x+p,c=f.y+p,this.dx=s-a,this.dy=h-n;var g=Math.atan2(this.dy,this.dx);t.translate(s,h),t.rotate(g),t.fillRect(-u+c/4,-c/2,u,c),t.rotate(-g),t.translate(-s,-h),r.rotatedAngle=g}else if(e&&r.triangleDirection==="right"||!e&&r.triangleDirection==="left"){t.lineWidth=p,t.beginPath(),t.fillStyle=r.strokeSettings.strokeColor,(e&&r.start==="bar"&&r.end==="none"||r.start==="bar"&&r.end!=="circle"&&r.end!=="square"||!e&&r.end==="bar"&&r.start==="none")&&this.shapeLine(t,a,n,s,h);var u=this.arrowDimension.bar.width,c=this.arrowDimension.bar.height,f=this.manipulateSaveCtx(t,u,c);u=f.x+p,c=f.y+p,this.dx=s-a,this.dy=h-n;var g=Math.atan2(this.dy,this.dx);t.translate(a,n),t.rotate(g),t.fillRect(c/4-u,-c/2,u,c),t.rotate(-g),t.translate(-a,-n),i.activeObj.rotatedAngle=g}},l.prototype.shapeImage=function(t){var e=this.parent,i=e.activeObj,r=i.activePoint,o=r.startX,a=r.startY,n=r.width,s=r.height,h=i.imageCanvas.getContext("2d");if(t===this.lowerContext&&this.isImageApply){var p={width:0,height:0};e.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:i.imageElement.width,height:i.imageElement.height,obj:p,isImgShape:null}}),(n<p.width/5||s<p.height/5)&&(h.clearRect(0,0,i.imageCanvas.width,i.imageCanvas.height),e.notify("selection",{prop:"applyTransformToImg",onPropertyChange:!1,value:{ctx:h}}),e.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),e.notify("selection",{prop:"setImageClarity",onPropertyChange:!1,value:{bool:!1}}),this.isImageApply=!1)}var u={startX:0,startY:0,width:0,height:0};u.width=n,u.height=s,i.flipObjColl.length===4&&(i.flipObjColl=[],i.shapeFlip=""),u.startX=(n-u.width)/2+o,u.startY=(s-u.height)/2+a;var c=t.globalAlpha;t.globalAlpha=i.opacity,i.rotateFlipColl&&i.rotateFlipColl.length>0?this.rotateImage(t):t.drawImage(i.imageCanvas,u.startX,u.startY,u.width,u.height),t.globalAlpha=c,e.currObjType.isText=!1},l.prototype.shapeText=function(t){var e=this.parent,i=t.filter,r=e.activeObj,o=r.activePoint,a=o.startX,n=o.startY,s=o.width,h=o.height,p=r.keyHistory.split(`
`),u=r.textSettings,c=u.fontFamily,f=u.bold,g=u.italic,v=r.textSettings.fontSize,m=v+v*.25,C=(m*p.length-v*p.length)/p.length;t.filter="none";var M=t.fillStyle;r.strokeSettings.fillColor!==""&&(t.fillStyle=r.strokeSettings.fillColor,t.fillRect(r.activePoint.startX,r.activePoint.startY,r.activePoint.width,r.activePoint.height)),t.fillStyle=M;for(var I=0;I<p.length;I++){var N=p[I],O=(I+1)*v*.85+I*C;e.transform.degree===-360&&(e.transform.degree=0),e.transform.degree===0||e.transform.degree===180?v>h&&(v=r.textSettings.fontSize=h-h*.1):v>s&&(v=r.textSettings.fontSize=s-s*.1),t.strokeStyle=r.strokeSettings.outlineColor,t.fillStyle=r.strokeSettings.strokeColor;var x=t.lineWidth,D={width:0,height:0},A={width:1,height:1};e.notify("crop",{prop:"calcRatio",onPropertyChange:!1,value:{obj:D,dimension:{width:t.canvas.width,height:t.canvas.height}}}),A=D;var P=t.canvas.id===e.element.id+"_tempCanvas",V=Math.max(1,r.strokeSettings.outlineWidth/2);/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$|^[a-zA-Z]+$/.test(r.strokeSettings.outlineColor)?(t.lineWidth=V*(Math.floor(P?(v-1)/60:(v-1)/16)*.5+.5),P&&(t.lineWidth*=(A.width+A.height)/2,e.transform.degree!==0&&(t.lineWidth/=1.8))):t.lineWidth=1;var q="";f&&(q="bold "),g&&(q="italic "),f&&g&&(q="italic bold "),t.font=q+v+"px "+c,r.flipObjColl.length===4&&(r.flipObjColl=[],r.shapeFlip=""),r.rotateFlipColl&&r.rotateFlipColl.length>0?this.rotateText(t):(t.strokeText(N,a+v*.1,n+O),t.fillText(N,a+v*.1,n+O)),t.lineWidth=x}t.filter=i,e.currObjType.isText=!1,this.upperContext===t&&this.drawOuterSelection(t)},l.prototype.updateActPoint=function(t,e){var i=this.parent,r=i.activeObj,o=r.activePoint;return t.toLowerCase()==="horizontal"?o.startX<=e.canvas.width/2?(o.startX=e.canvas.width/2+(e.canvas.width/2-o.endX),o.endX=o.startX+o.width,this.updateActiveObject(o,r),i.activeObj=r):o.startX>=e.canvas.width/2&&(o.startX=e.canvas.width-o.endX,o.endX=o.startX+o.width,this.updateActiveObject(o,r),i.activeObj=r):t.toLowerCase()==="vertical"&&(o.startY<=e.canvas.height/2?(o.startY=e.canvas.height/2+(e.canvas.height/2-o.endY),o.endY=o.startY+o.height,this.updateActiveObject(o,r),i.activeObj=r):o.startY>=e.canvas.height/2&&(o.startY=e.canvas.height-o.endY,o.endY=o.startY+o.height,this.updateActiveObject(o,r),i.activeObj=r)),o},l.prototype.rotateImage=function(t){var e=this.parent,i,r=e.activeObj,o=y({},e.activeObj,null,!0);r.shapeDegree===0?i=e.transform.degree:i=e.transform.degree-r.shapeDegree,i===-450&&(i=-90),i<0&&(i=360+i);var a={startX:0,startY:0,width:0,height:0};a.width=i%90===0&&i%180!==0?r.activePoint.height:r.activePoint.width,a.height=i%90===0&&i%180!==0?r.activePoint.width:r.activePoint.height,a.startX=r.activePoint.startX,a.startY=r.activePoint.startY;var n=a.startX,s=a.startY,h;t.save();for(var p=0,u=r.rotateFlipColl.length;p<u;p++){var c=r.rotateFlipColl[p];typeof c=="number"?(h=c,h===-450&&(h=-90),h<0&&(h=360+h),a.width=h%90===0&&h%180!==0?r.activePoint.height:r.activePoint.width,a.height=h%90===0&&h%180!==0?r.activePoint.width:r.activePoint.height,t.translate(t.canvas.width/2,t.canvas.height/2),t.rotate(Math.PI/180*c),t.translate(-t.canvas.height/2,-t.canvas.width/2),h%90===0&&h%270!==0||h===0?(s=t.canvas.width-(r.activePoint.startX+r.activePoint.width),s+=(r.activePoint.width-a.height)/2,n=a.startY):h%270===0&&(n=t.canvas.height-(r.activePoint.startY+r.activePoint.height),n+=(r.activePoint.height-a.width)/2,s=a.startX),a.startX=n,a.startY=s,r.activePoint.startX=n,r.activePoint.startY=s,r.activePoint.endX=r.activePoint.startX+a.width,r.activePoint.endY=r.activePoint.startY+a.height,r=this.updateWidthHeight(r)):(c==="horizontal"&&i%90===0&&i%180!==0?c="vertical":c==="vertical"&&i%90===0&&i%180!==0&&(c="horizontal"),c==="horizontal"?(t.translate(t.canvas.width,0),t.scale(-1,1),r.activePoint=this.updateActPoint("horizontal",t)):c==="vertical"&&(t.translate(0,t.canvas.height),t.scale(1,-1),r.activePoint=this.updateActPoint("vertical",t)),a.startX=r.activePoint.startX,a.startY=r.activePoint.startY),a.startX=r.activePoint.startX,a.startY=r.activePoint.startY,n=a.startX,s=a.startY}r.rotatedAngle!==0&&e.notify("shape",{prop:"setPointCollForShapeRotation",onPropertyChange:!1,value:{obj:r}}),t.drawImage(r.imageCanvas,a.startX,a.startY,a.width,a.height),t.restore(),e.activeObj=o,(e.transform.degree===360||e.transform.degree===-360)&&(e.transform.degree=0)},l.prototype.rotateText=function(t){var e=this.parent,i,r=e.activeObj,o=y({},e.activeObj,null,!0),a=e.activeObj.activePoint;r.shapeDegree===0?i=e.transform.degree:i=e.transform.degree-r.shapeDegree,i===-450&&(i=-90),i<0&&(i=360+i);var n={startX:0,startY:0,width:0,height:0};n.width=i%90===0&&i%180!==0?a.height:a.width,n.height=i%90===0&&i%180!==0?a.width:a.height,n.startX=a.startX,n.startY=a.startY;var s=n.startX,h=n.startY,p;t.save();for(var u=0,c=r.rotateFlipColl.length;u<c;u++){var f=r.rotateFlipColl[u];typeof f=="number"?(p=f,p===-450&&(p=-90),p<0&&(p=360+p),n.width=p%90===0&&p%180!==0?a.height:a.width,n.height=p%90===0&&p%180!==0?a.width:a.height,t.translate(t.canvas.width/2,t.canvas.height/2),t.rotate(Math.PI/180*f),t.translate(-t.canvas.height/2,-t.canvas.width/2),p%90===0&&p%270!==0||p===0?(h=t.canvas.width-a.endX,s=a.startY):p%270===0&&(s=t.canvas.height-a.endY,h=a.startX),n.startX=s,n.startY=h,a.startX=s,a.startY=h,a.endX=a.startX+n.width,a.endY=a.startY+n.height,r=this.updateWidthHeight(r)):(f==="horizontal"&&i%90===0&&i%180!==0?f="vertical":f==="vertical"&&i%90===0&&i%180!==0&&(f="horizontal"),f==="horizontal"?(t.translate(t.canvas.width,0),t.scale(-1,1)):f==="vertical"&&(t.translate(0,t.canvas.height),t.scale(1,-1)),r.activePoint=a=this.updateActPoint(f,t),n.startX=a.startX,n.startY=a.startY),n.startX=a.startX,n.startY=a.startY,s=n.startX,h=n.startY}r.rotatedAngle!==0&&e.notify("shape",{prop:"setPointCollForShapeRotation",onPropertyChange:!1,value:{obj:r}}),h+=r.textSettings.fontSize*.4,this.textFlipDegree(t,s,h),t.restore(),e.activeObj=o,(e.transform.degree===360||e.transform.degree===-360)&&(e.transform.degree=0)},l.prototype.textFlipDegree=function(t,e,i){for(var r=this.parent,o=r.activeObj,a=o.keyHistory.split(`
`),n=o.textSettings.fontSize,s=(n*a.length-n*a.length)/a.length,h=n*.85+s,p=0,u=a.length;p<u;p++){var c=a[p];p>0&&(p===1&&(h-=n*.85),h+=n+n*.15),t.strokeText(c,e+n*.15,i+h+(p>0?n*.25:-n*.35)),t.fillText(c,e+n*.15,i+h+(p>0?n*.25:-n*.35))}},l.prototype.clearOuterCanvas=function(t){var e=this.parent,i=e.img,r=i.destLeft,o=i.destTop,a=i.destWidth,n=i.destHeight,s=r>0?r:0,h=o>0?o:0;t.clearRect(0,0,s,e.lowerCanvas.height),t.clearRect(r+a,0,e.lowerCanvas.width-(r+a),e.lowerCanvas.height),t.clearRect(0,0,e.lowerCanvas.width,h),t.clearRect(0,o+n,e.lowerCanvas.width,e.lowerCanvas.height-(o+n)),e.transform.currFlipState!==""&&(e.img.destLeft=r,e.img.destTop=o)},l.prototype.setDestPoints=function(){var t,e=this.parent,i=e.transform,r=i.degree,o=i.zoomFactor;if(r%90===0&&r%180!==0){var a={width:0,height:0};e.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:e.img.srcHeight,height:e.img.srcWidth,obj:a,isImgShape:null}}),t=a,this.isRotateZoom&&(t.width+=t.width*o,t.height+=t.height*o,e.img.destWidth=t.height,e.img.destHeight=t.width),e.img.destLeft=(e.lowerCanvas.clientWidth-t.height)/2,e.img.destTop=(e.lowerCanvas.clientHeight-t.width)/2,e.img.destWidth=t.height,e.img.destHeight=t.width}else{var a={width:0,height:0};e.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:e.img.srcWidth,height:e.img.srcHeight,obj:a,isImgShape:null}}),t=a,this.isRotateZoom&&(t.width+=t.width*o,t.height+=t.height*o,e.img.destWidth=t.width,e.img.destHeight=t.height),e.img.destLeft=(e.lowerCanvas.clientWidth-t.width)/2,r===0?e.img.destTop=(e.lowerCanvas.clientHeight-t.height+1)/2:e.img.destTop=(e.lowerCanvas.clientHeight-t.height)/2,e.img.destWidth=t.width,e.img.destHeight=t.height}},l.prototype.updateCurrTransState=function(t,e,i,r){var o=this.parent,a=o.img.destLeft,n=o.img.destTop;t==="initial"&&(this.lowerContext.setTransform(1,0,0,1,0,0),d(e)&&this.setDestPoints()),o.isCircleCrop||o.currSelectionPoint&&o.currSelectionPoint.shape==="crop-circle"?(this.currTransState(t,!0,null,i),o.transform.degree===0&&o.transform.currFlipState===""&&o.transform.straighten===0&&d(r)&&(o.img.destLeft=a,o.img.destTop=n),i&&(o.img.destLeft+=o.panPoint.totalPannedClientPoint.x,o.img.destTop+=o.panPoint.totalPannedClientPoint.y),o.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),i&&(o.img.destLeft-=o.panPoint.totalPannedClientPoint.x,o.img.destTop-=o.panPoint.totalPannedClientPoint.y)):(this.currTransState(t,null,null,i),o.transform.degree===0&&o.transform.currFlipState===""&&o.transform.straighten===0&&d(r)&&(o.img.destLeft=a,o.img.destTop=n))},l.prototype.currTransState=function(t,e,i,r){var o=this.parent;i=i||this.lowerContext,t==="initial"?this.setTransformColl(i,t):t==="reverse"&&(this.setTransformColl(i,t),this.setClientTransDim(e),(o.isCircleCrop||o.currSelectionPoint&&o.currSelectionPoint.shape==="crop-circle"&&d(r))&&(r&&(o.img.destLeft+=o.panPoint.totalPannedClientPoint.x,o.img.destTop+=o.panPoint.totalPannedClientPoint.y),o.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),r&&(o.img.destLeft-=o.panPoint.totalPannedClientPoint.x,o.img.destTop-=o.panPoint.totalPannedClientPoint.y)))},l.prototype.setTransformColl=function(t,e){var i=this.parent;if(e==="initial")for(var r=0,o=i.rotateFlipColl.length;r<o;r++)this.setTransform(t,i.rotateFlipColl[r]);else if(e==="reverse")for(var r=i.rotateFlipColl.length-1;r>=0;r--)this.setTransform(t,i.rotateFlipColl[r],!0)},l.prototype.setTransform=function(t,e,i){var r=this.parent;switch(i&&e===90?e=-90:i&&e===-90&&(e=90),e==="horizontal"&&r.transform.degree%90===0&&r.transform.degree%180!==0?e="vertical":e==="vertical"&&r.transform.degree%90===0&&r.transform.degree%180!==0&&(e="horizontal"),r.notify("transform",{prop:"setReverseRotate",onPropertyChange:!1,value:{bool:!0}}),r.notify("transform",{prop:"setReverseFlip",onPropertyChange:!1,value:{isReverseFlip:!0}}),d(i)&&t.clearRect(0,0,t.canvas.width,t.canvas.height),e){case 90:case-90:t.translate(t.canvas.width/2,t.canvas.height/2),t.rotate(Math.PI/180*e),t.translate(-t.canvas.width/2,-t.canvas.height/2);break;case"horizontal":t.translate(t.canvas.width,0),t.scale(-1,1);break;case"vertical":t.translate(0,t.canvas.height),t.scale(1,-1);break}r.notify("transform",{prop:"setReverseRotate",onPropertyChange:!1,value:{bool:!1}}),r.notify("transform",{prop:"setReverseFlip",onPropertyChange:!1,value:{isReverseFlip:!1}})},l.prototype.drawImgToCanvas=function(t){var e=this.parent;this.lowerContext.clearRect(0,0,e.lowerCanvas.width,e.lowerCanvas.height),e.img.destWidth=t.width,e.img.destHeight=t.height,this.isInitialLoading&&(e.notify("filter",{prop:"initFilter",onPropertyChange:!1}),this.isInitialLoading=!1);var i=this.lowerContext.filter;this.lowerContext.clearRect(0,0,e.lowerCanvas.width,e.lowerCanvas.height),this.drawImage(),(e.currSelectionPoint&&e.currSelectionPoint.shape==="crop-circle"||e.isCircleCrop)&&e.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),this.lowerContext.filter=i},l.prototype.renderImage=function(t,e,i,r){var o=this.parent;o.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:null}}),d(e)&&(this.upperContext.clearRect(0,0,o.lowerCanvas.width,o.lowerCanvas.height),this.lowerContext.clearRect(0,0,o.lowerCanvas.width,o.lowerCanvas.height)),t?this.setTransformColl(this.lowerContext,"initial"):(o.transform.zoomFactor!==0&&(this.isRotateZoom=!0),this.updateCurrTransState("initial",null,null,r)),o.notify("transform",{prop:"setDestPointsForFlipState",onPropertyChange:!1}),this.drawImage(),o.notify("transform",{prop:"setDestPointsForFlipState",onPropertyChange:!1}),t?this.setTransformColl(this.lowerContext,"reverse"):(this.updateCurrTransState("reverse",null,null,r),this.isRotateZoom=!1),i?o.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}):o.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"iterate",pen:"iterate",isPreventApply:null}}),this.clearOuterCanvas(this.lowerContext),(o.isCircleCrop||o.currSelectionPoint&&o.currSelectionPoint.shape==="crop-circle")&&o.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}})},l.prototype.imageOnLoad=function(t){var e=this,i=this.parent,r=this;i.baseImg.src=t,i.baseImg.onload=function(){i.imgSrc=t,i.isUndoRedo||i.notify("filter",{prop:"update-finetunes",onPropertyChange:!1}),r.lowerContext.drawImage(i.baseImg,0,0,r.parent.lowerCanvas.width,r.parent.lowerCanvas.height);var o=!1,a=!1;if(i.isImageUpdated){var n=i.img,s=n.srcWidth,h=n.srcHeight,p=i.baseImgCanvas,u=p.width,c=p.height;o=s!==u||h!==c,a=i.baseImg.width===u&&i.baseImg.height===c}gt(i.element),i.element.style.opacity="1",r.updateBaseImgCanvas();var f={fileName:e.fileName,fileType:e.fileType,isValidImage:!0};if(r.updateCanvas(o,a),i.currObjType.isUndoZoom&&(i.currObjType.isUndoZoom=!1,r.parent.lowerCanvas.style.display="block"),i.isUndoRedo=e.isErrorImage=!1,S.isDevice){i.notify("toolbar",{prop:"destroy-top-toolbar",onPropertyChange:!1}),i.notify("toolbar",{prop:"destroy-bottom-toolbar",onPropertyChange:!1});var g={isApplyBtn:!1,isDevice:S.isDevice,isOkBtn:null,isResize:null,isFrame:null,isMainToolbar:!0};i.notify("toolbar",{prop:"init-main-toolbar",onPropertyChange:!1,value:g}),i.notify("toolbar",{prop:"create-bottom-toolbar",onPropertyChange:!1})}else{i.notify("toolbar",{prop:"destroy-top-toolbar",onPropertyChange:!1});var g={isApplyBtn:!1,isDevice:!1,isOkBtn:null};i.notify("toolbar",{prop:"init-main-toolbar",onPropertyChange:!1,value:g})}if(i.isImageLoaded&&i.element.style.opacity!=="0.5"){i.trigger("fileOpened",f);var v={action:"file-open",actionEventArgs:f};i.triggerEditCompleteEvent(v)}},i.baseImg.onerror=function(){gt(i.element),r.isErrorImage=!0,r.errorLoading()}},l.prototype.errorLoading=function(){var t=this.parent,e={fileName:null,fileType:null,isValidImage:!1};t.trigger("fileOpened",e)},l.prototype.updateBaseImgCanvas=function(){var t=this.parent;t.baseImgCanvas.width=t.baseImg.width,t.baseImgCanvas.height=t.baseImg.height,t.baseImgCanvas.getContext("2d").drawImage(t.baseImg,0,0)},l.prototype.updateCanvas=function(t,e){var i=this.parent;!i.isImageUpdated||!t?(i.img.srcWidth=i.baseImgCanvas.width,i.img.srcHeight=i.baseImgCanvas.height):!e&&t&&(i.img.srcLeft=0,i.img.srcTop=0,i.img.srcWidth=i.baseImgCanvas.width,i.img.srcHeight=i.baseImgCanvas.height,i.currSelectionPoint=null,i.cropObj={cropZoom:0,defaultZoom:0,totalPannedPoint:{x:0,y:0},totalPannedClientPoint:{x:0,y:0},totalPannedInternalPoint:{x:0,y:0},tempFlipPanPoint:{x:0,y:0},activeObj:{},rotateFlipColl:[],degree:0,currFlipState:"",straighten:0,destPoints:{startX:0,startY:0,width:0,height:0},srcPoints:{startX:0,startY:0,width:0,height:0},filter:"",isBrightAdjust:!1,zoomFactor:0,previousZoomValue:0,aspectWidth:null,aspectHeight:null,frame:"none",straightenZoom:0,adjustmentLevel:{brightness:0,contrast:0,hue:0,opacity:100,saturation:0,blur:0,exposure:0,transparency:100,sharpen:!1,bw:!1},currentFilter:""});var r={width:0,height:0};i.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:i.img.srcWidth,height:i.img.srcHeight,obj:r,isImgShape:null}});var o=r;i.img.destLeft=(i.lowerCanvas.clientWidth-o.width)/2,i.img.destTop=(i.lowerCanvas.clientHeight-o.height+1)/2,this.drawImgToCanvas(o),this.origDim.width=i.img.destWidth,this.origDim.height=i.img.destHeight,this.zoomCrop.width=i.img.destWidth,this.zoomCrop.height=i.img.destHeight,i.notify("transform",{prop:"setCropDimension",onPropertyChange:!1,value:{width:i.img.destWidth,height:i.img.destHeight}});var a={startX:i.img.destLeft,startY:i.img.destTop,width:i.img.destWidth,height:i.img.destHeight};i.notify("crop",{prop:"setCropDestPoints",onPropertyChange:!1,value:{point:a}});var n=this.lowerContext.filter;this.lowerContext.filter="none",i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"iterate",pen:"zoom",isPreventApply:null}}),this.lowerContext.filter=n,i.img.destWidth>0&&i.img.destHeight>0&&(i.isImageLoaded=!0),i.isUndoRedo&&i.transform.currFlipState!==""&&i.notify("transform",{prop:"flipImage",onPropertyChange:!1,value:{direction:i.toPascalCase(i.transform.currFlipState)}}),i.disabled&&i.element.setAttribute("class","e-disabled"),(i.zoomSettings.zoomFactor!==1||i.zoomSettings.zoomPoint)&&i.zoom(i.zoomSettings.zoomFactor,i.zoomSettings.zoomPoint),d(this.initZoomValue)&&(this.initZoomValue=i.zoomSettings.zoomFactor),this.isImageEdited=!1},l.prototype.resetFrameZoom=function(t){var e=this.parent;if(!d(e.tempFrameZoomLevel)){var i=e.tempFrameZoomLevel;e.tempFrameZoomLevel=null,e.notify("transform",{prop:"resetZoom",onPropertyChange:!1}),e.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:i,zoomPoint:null,isResize:!0}});var r=e.cancelCropSelection;t&&r&&(r.previousObj.frameObj=y({},e.frameObj,null,!0),r.currentObj.frameObj=y({},e.frameObj,null,!0),r.previousObj.frame=r.currentObj.frame=e.frameObj.type),this.updateCropSelObj(),e.cancelCropSelection=null}},l.prototype.performCancel=function(t,e,i){var r=this.parent;i&&(r.noPushUndo=!1);var o={bool:r.isStraightening};t=t||!1;var a={bool:!1};r.allowDownScale=!0,r.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:a}}),d(e)&&JSON.stringify(r.frameObj)!==JSON.stringify(r.tempFrameObj)&&(y(r.frameObj,r.tempFrameObj),this.renderImage(null,null,!0)),this.resetFrameZoom(!1);var n={action:""};if(a.bool)n.action="freehand-draw",r.notify("freehand-draw",{prop:"cancelFhd",onPropertyChange:!1}),r.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1}),r.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}});else if(r.textArea.style.display==="block"||r.textArea.style.display==="inline-block")n.action="text-editing",r.textArea.style.display="none",r.textArea.value="",r.textArea.style.transform="",this.prevActObj?(r.activeObj=this.prevActObj,this.prevActObj=null):(r.activeObj.strokeSettings=this.tempStrokeSettings,r.activeObj.textSettings=this.tempTextSettings),r.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"cancel"}}),this.isShapeTextInserted&&r.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),r.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:!0}}),r.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1}),r.notify("selection",{prop:"setTempActObj",onPropertyChange:!1,value:{obj:r.activeObj}}),r.drawingShape&&r.enableShapeDrawing(r.toPascalCase(r.drawingShape),!0);else if((!r.activeObj.shape||r.activeObj.shape!=="redact")&&((!S.isDevice||S.isDevice&&!o.bool)&&document.querySelector("#"+r.element.id+"_sliderWrapper")||r.currObjType.isFiltered)){n.action=r.isFinetuneBtnClick?"fine-tune":"filter",this.lowerContext.filter=this.tempAdjValue,r.canvasFilter=this.tempAdjValue,r.notify("filter",{prop:"setAdjustmentValue",onPropertyChange:!1,value:{adjustmentValue:this.tempAdjValue}}),r.initialAdjustmentValue=this.tempAdjValue,this.lowerContext.filter.split(" ").length>1&&this.lowerContext.filter.split(" ")[0].split("(")[1].split(")")[0]==="1"&&r.notify("filter",{prop:"setBrightnessAdjusted",onPropertyChange:!1,value:{isBrightnessAdjusted:!1}}),r.currentFilter=this.tempFilter,r.notify("filter",{prop:"setBevelFilter",onPropertyChange:!1,value:{bevelFilter:this.lowerContext.filter}}),this.lowerContext.clearRect(0,0,r.lowerCanvas.width,r.lowerCanvas.height),this.redrawImgWithObj(),r.currObjType.isFiltered=!1;var s={tempAdjustmentLevel:null};r.notify("filter",{prop:"getTempAdjustmentLevel",onPropertyChange:!1,value:{obj:s}}),r.notify("filter",{prop:"setAdjustmentLevel",onPropertyChange:!1,value:{adjustmentLevel:y({},s.tempAdjustmentLevel,{},!0)}}),r.notify("undo-redo",{prop:"setUndoRedoStep",onPropertyChange:!1,value:{step:this.tempUndoRedoStep}}),r.upperCanvas.style.cursor=r.cursor="default",r.currObjType.isCustomCrop=!1,this.tempStrokeSettings={strokeColor:"#fff",fillColor:"",strokeWidth:null,radius:null,outlineColor:"",outlineWidth:null},this.clearOuterCanvas(this.lowerContext),(r.currSelectionPoint&&r.currSelectionPoint.shape==="crop-circle"||r.isCircleCrop)&&r.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}});var h={type:"main",isApplyBtn:null,isCropping:null,isZooming:null};r.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide"),r.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:h}),r.activeObj.shape&&r.activeObj.shape==="image"&&r.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1}),r.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"cancel"}}),r.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,r.upperCanvas.width,r.upperCanvas.height),r.drawingShape&&(r.drawingShape=null,r.notify("selection",{prop:"setCurrentDrawingShape",onPropertyChange:!1,value:{value:""}}))}else if((!r.activeObj.shape||r.activeObj.shape!=="redact")&&t&&(!S.isDevice||S.isDevice&&!o.bool)){var h={type:"main",isApplyBtn:null,isCropping:null,isZooming:null};r.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:h})}else this.cancelItems(n),r.transform.zoomFactor>0?(r.togglePan=!0,r.notify("selection",{prop:"setDragCanvas",value:{bool:!0}})):(r.togglePan=!1,r.notify("selection",{prop:"setDragCanvas",value:{bool:!1}}));this.isShapeTextInserted=!1,this.isNewPath=!1,r.notify("toolbar",{prop:"refresh-dropdown-btn",value:{isDisabled:!1}}),r.notify("toolbar",{prop:"setCurrentToolbar",value:{type:"main"}}),i&&(r.noPushUndo=!1),r.drawingShape=null,r.notify("draw",{prop:"resetTempObjColl"}),r.notify("draw",{prop:"resetTempPointColl"}),r.isMaskImage=r.isFinetuneBtnClick=!1;var p={action:"cancel",actionEventArgs:n};r.triggerEditCompleteEvent(p)},l.prototype.cancelItems=function(t){var e=this.parent,i=!1,r=e.element.id,o=e.element.querySelector("#"+r+"_aspectratio"),a=e.element.querySelector("#"+r+"_nonaspectratio"),n,s=["rectangle","ellipse","line","arrow","path","image","redact"];if(e.activeObj.shape!==void 0&&(n=e.activeObj.shape.split("-")),(n===void 0&&e.currObjType.isCustomCrop||n!==void 0&&n[0]==="crop")&&(i=!0),i&&e.isCropTab&&(e.isCropTab=!1,e.transform.zoomFactor=e.transform.defaultZoomFactor),e.isResize&&(o||a||e.currentToolbar==="resize-toolbar")){t.action="resize";var h={width:null,height:null};e.notify("selection",{prop:"getNumTextValue",onPropertyChange:!1,value:{obj:h}});var p={x:h.width,y:h.height},u=e.element.querySelector("#"+e.element.id+"_aspectratio"),c=e.element.querySelector(".e-ie-toolbar-aspect-ratio-btn");if(p&&p.x&&p.y&&!d(e.aspectWidth))if(u||c&&!c.classList.contains("e-hidden"))e.notify("transform",{prop:"resizeImage",value:{width:e.aspectWidth,height:e.aspectHeight}});else{var f=e.currObjType.isUndoAction;e.currObjType.isUndoAction=!1,e.notify("transform",{prop:"resizeCrop",value:{width:e.aspectWidth,height:e.aspectHeight}}),e.currObjType.isUndoAction=f}var g={prevCropObj:e.prevCropObj},v={prevObj:e.prevObj};if(e.notify("toolbar",{prop:"getPrevCropObj",onPropertyChange:!1,value:{obj:g}}),e.notify("toolbar",{prop:"getPrevObj",onPropertyChange:!1,value:{obj:v}}),g.prevCropObj&&v.prevObj){e.objColl=[],e.pointColl=[],e.freehandCounter=0,e.cropObj=y({},g.prevCropObj,{},!0),this.setCurrentObj(v.prevObj),e.objColl=v.prevObj.objColl,e.pointColl=v.prevObj.pointColl,e.freehandCounter=e.pointColl.length,e.transform.straighten=0,e.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}});var m=e.currSelectionPoint?y({},e.currSelectionPoint,{},!0):null;e.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-e.transform.zoomFactor,zoomPoint:null,isResize:!0}}),e.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:v.prevObj.defaultZoom,zoomPoint:null,isResize:!0}}),e.currSelectionPoint=m,v.prevObj.zoomFactor&&e.setProperties({zoomSettings:{zoomFactor:v.prevObj.zoomFactor}},!0),e.notify("transform",{prop:"setPreviousZoomValue",onPropertyChange:!1,value:{previousZoomValue:e.zoomSettings.zoomFactor}})}e.isResize=!1,e.notify("transform",{prop:"setResizedImgAngle",onPropertyChange:!1,value:{angle:null}});var C=e.isCropTab;e.isCropTab=!1,this.updateCropSelObj(),e.cancelCropSelection=null,e.isCropTab=C}switch(!0){case e.togglePen:t.action="freehand-draw",this.cancelPen();break;case e.activeObj.shape==="text":t.action="text",this.cancelText();break;case s.indexOf(e.activeObj.shape)!==-1:t.action=e.activeObj.shape,this.cancelShape(),e.currObjType.isRedact=!1;break;case i:t.action="crop-selection",this.cancelSelection();break;default:e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),e.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"cancel"}});break}e.notify("selection",{prop:"setCurrentDrawingShape",onPropertyChange:!1,value:{value:""}}),e.upperCanvas.style.cursor=e.cursor="default",e.currObjType.isCustomCrop=!1,this.tempStrokeSettings={strokeColor:"#fff",fillColor:"",strokeWidth:null,radius:null,outlineColor:"",outlineWidth:null};var M={type:"main",isApplyBtn:null,isCropping:!1,isZooming:null};e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:M})},l.prototype.cancelPen=function(){var t=this.parent;this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.togglePen=!1,t.upperCanvas.style.cursor=t.cursor="default";var e=y([],t.pointColl,[],!0);t.pointColl={};for(var i=0;i<this.tempFreehandCounter;i++)t.pointColl[i]=e[i];t.freehandCounter=this.tempFreehandCounter,t.notify("freehand-draw",{prop:"setCurrentFreehandDrawIndex",value:{value:this.tempCurrFhdIndex}}),t.activeObj.strokeSettings=this.tempStrokeSettings,t.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:t.activeObj.strokeSettings,strokeColor:null,fillColor:null,strokeWidth:null,radius:null}}),t.notify("freehand-draw",{prop:"setPenStrokeWidth",onPropertyChange:!1,value:{value:this.tempStrokeWidth}}),t.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"cancel"}}),t.notify("selection",{prop:"setFreehandDrawCustomized",value:{isFreehandDrawCustomized:!1}}),t.objColl=y([],this.tempObjColl,[],!0),t.pointColl=y([],this.tempPointColl,[],!0),t.freehandCounter=t.pointColl.length,this.tempPointColl={},this.renderImage(),t.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok",isCancel:!0}})},l.prototype.cancelText=function(){var t=this.parent;if(t.notify("shape",{prop:"setTextSettings",onPropertyChange:!1,value:{textSettings:this.tempTextSettings,fontFamily:null,fontSize:null}}),t.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:this.tempStrokeSettings,strokeColor:null,fillColor:null,strokeWidth:null,radius:null}}),d(t.activeObj.currIndex))t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height);else{var e={appliedUndoRedoColl:[]};t.notify("undo-redo",{prop:"getAppliedUndoRedoColl",value:{obj:e}});var i=e.appliedUndoRedoColl.length,r=e.appliedUndoRedoColl[i-1];this.prevActObj&&r&&r.currentObjColl.length&&r.currentObjColl[r.currentObjColl.length-1].currIndex===this.prevActObj.currIndex?(t.activeObj=this.prevActObj,this.prevActObj=null):(t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height))}t.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1}),this.tempTextSettings={text:"Enter Text",fontFamily:t.fontFamily.default,fontSize:null,fontRatio:null,bold:!1,italic:!1,underline:!1},t.objColl=y([],this.tempObjColl,[],!0),t.pointColl=y([],this.tempPointColl,[],!0),this.renderImage(),this.tempObjColl=[],t.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok",isCancel:!0}})},l.prototype.cancelShape=function(){var t=this.parent;if(t.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:this.tempStrokeSettings,strokeColor:null,fillColor:null,strokeWidth:null,radius:null}}),d(t.activeObj.currIndex))t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height);else if(this.isNewPath)t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),this.renderImage();else{var e={appliedUndoRedoColl:[]};t.notify("undo-redo",{prop:"getAppliedUndoRedoColl",value:{obj:e}});for(var i=void 0,r=0,o=e.appliedUndoRedoColl.length;r<o;r++)for(var a=e.appliedUndoRedoColl[r].currentObjColl,n=0,s=a.length;n<s;n++)if(this.prevActObj&&this.prevActObj.currIndex&&a[n].currIndex===this.prevActObj.currIndex){i=a[0];break}this.prevActObj&&i?(t.activeObj=this.prevActObj,this.prevActObj=null,t.notify("selection",{prop:"redrawShape",onPropertyChange:!1,value:{obj:t.activeObj}}),t.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"cancel"}}),t.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:!0}})):(t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height));var h={undoRedoStep:null};t.notify("undo-redo",{prop:"getUndoRedoStep",value:{obj:h}}),e.appliedUndoRedoColl[h.undoRedoStep-1]?t.objColl=y([],e.appliedUndoRedoColl[h.undoRedoStep-1].currentObjColl,[],!0):t.objColl=[],this.renderImage()}t.currObjType.isDragging=!1,t.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1}),t.objColl=y([],this.tempObjColl,[],!0),t.pointColl=y([],this.tempPointColl,[],!0),this.renderImage(),this.tempObjColl=[],t.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok",isCancel:!0}})},l.prototype.cancelSelection=function(){var t=this.parent;if(t.cancelCropSelection){var e={value:t.tempStraighten};t.transform.straighten=e.value,t.straightenBaseImageCanvas(),t.notify("freehand-draw",{prop:"resetStraightenPoint"}),t.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),t.notify("draw",{prop:"setStraightenActObj",value:{activeObj:t.activeObj}}),t.notify("crop",{prop:"resizeWrapper"}),this.updateCropSelObj(),this.tempStraightenDestPoints&&JSON.stringify(this.tempStraightenDestPoints)!==JSON.stringify(this.straightenDestPoints)&&(this.straightenDestPoints=y({},this.tempStraightenDestPoints,{},!0))}},l.prototype.updateCropSelObj=function(){var t=this.parent;t.cancelCropSelection&&(t.cropObj=y({},t.cancelCropSelection.previousCropObj,{},!0),t.afterCropActions=t.cancelCropSelection.previousObj.afterCropActions,t.notify("undo-redo",{prop:"undoDefault",onPropertyChange:!1,value:{obj:t.cancelCropSelection}}),t.currSelectionPoint=y({},t.cancelCropSelection.previousCropObj.activeObj,!0),t.currSelectionPoint&&d(t.currSelectionPoint.shape)&&(t.currSelectionPoint=null),this.clearOuterCanvas(this.lowerContext),(t.isCircleCrop||t.currSelectionPoint&&t.currSelectionPoint.shape==="crop-circle")&&t.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}))},l.prototype.updateCropSelection=function(){var t=this.parent,e={currObj:{}};t.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:e}});var i=e.currObj;i.objColl=y([],t.objColl,[],!0),i.pointColl=y([],t.pointColl,[],!0),i.afterCropActions=y([],t.afterCropActions,[],!0);var r={selPointColl:null};t.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:r}}),i.selPointColl=y([],r.selPointColl,[],!0),t.cancelCropSelection={operation:"cropTransform",previousObj:i,currentObj:i,previousObjColl:i.objColl,currentObjColl:i.objColl,previousPointColl:i.pointColl,currentPointColl:i.pointColl,previousSelPointColl:i.selPointColl,currentSelPointColl:i.selPointColl,previousCropObj:y({},t.cropObj,{},!0),currentCropObj:y({},t.cropObj,{},!0),previousText:null,currentText:null,filter:null,isCircleCrop:t.isCircleCrop}},l.prototype.updateFlipPan=function(t){var e=this.parent;if(e.transform.currFlipState!==""){var i=this.lowerContext.filter;e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),e.notify("transform",{prop:"rotatedFlip",onPropertyChange:!1}),this.lowerContext.filter="none",e.notify("freehand-draw",{prop:"freehandRedraw",onPropertyChange:!1,value:{context:this.lowerContext,points:null}}),this.lowerContext.filter=i,this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),t&&this.drawObject("duplicate",t)}},l.prototype.select=function(t,e,i,r,o){var a=this.parent;if(t=t.toLowerCase(),!a.disabled&&a.isImageLoaded){a.allowDownScale=!1;var n={currObj:{}};a.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:n}});var s=n.currObj;s.objColl=y([],a.objColl,[],!0),s.pointColl=y([],a.pointColl,[],!0),s.afterCropActions=a.afterCropActions;var h={selPointColl:null};a.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:h}}),s.selPointColl=y([],h.selPointColl,[],!0),a.notify("crop",{prop:"setPreviousCropCurrentObj",onPropertyChange:!1,value:{obj:s}}),a.transform.zoomFactor>0&&a.activeObj.shape&&a.activeObj.shape.split("-")[0]==="crop"&&d(this.currSelPoint)&&(this.currSelPoint=y({},a.activeObj,{},!0));var p=!1,u=void 0;a.activeObj.shape!==void 0&&(u=a.activeObj.shape.split("-")),(u===void 0&&a.currObjType.isCustomCrop||u!==void 0&&u[0]==="crop")&&(p=!0);var c={currObj:{}};a.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:c}});var f=c.currObj;if(f.objColl=y([],a.objColl,[],!0),f.pointColl=y([],a.pointColl,[],!0),f.afterCropActions=y([],a.afterCropActions,[],!0),a.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:null}}),a.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),a.notify("shape",{prop:"setKeyHistory",onPropertyChange:!1,value:{keyHistory:""}}),this.upperContext.clearRect(0,0,a.upperCanvas.width,a.upperCanvas.height),a.upperCanvas.style.display="block",a.currSelectionPoint||a.transform.defaultZoomFactor!==0||a.transform.degree!==0&&a.panPoint.totalPannedInternalPoint.x!==0&&a.panPoint.totalPannedInternalPoint.y!==0&&!p){if(a.isCircleCrop=!1,a.transform.defaultZoomFactor!==0&&!this.isResizeSelect){var g=a.isCropTab;a.isCropTab=!1,a.notify("transform",{prop:"resetZoom",onPropertyChange:!1}),a.isCropTab=g,this.resetPanPoints()}a.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1}),a.isCropTab=!0,a.isCircleCrop=!1,this.isResizeSelect||a.notify("crop",{prop:"setCurrSelPoints",onPropertyChange:!1,value:{isSetDimension:!0}}),a.transform.zoomFactor=a.transform.cropZoomFactor,d(a.cropObj.activeObj.shape)&&(a.currObjType.shape="crop-"+t,this.drawNewSelection(t,e,i,r,o))}else this.isCropSelect?this.isCropSelect=!1:(a.notify("crop",{prop:"adjustStraightenForShapes",onPropertyChange:!1,value:{type:"reverse",isInitialRotated:!0}}),a.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1}),this.renderImage()),t==="custom"&&(a.currObjType.shape=""),this.drawNewSelection(t,e,i,r,o)}},l.prototype.drawNewSelection=function(t,e,i,r,o){var a=this.parent,n,s="crop-"+t.toLowerCase();s==="crop-custom"?(a.currObjType.shape===""||a.currObjType.shape==="crop-custom")&&(this.drawCustomSelection("crop-custom",e,i,r,o),this.adjToStraighten(),this.updateSelectionInsert(),a.isStraightening&&(this.straightenActObj=y({},a.activeObj,{},!0),this.straightenInitZoom=a.transform.zoomFactor)):s==="crop-canvas"?(a.upperCanvas.style.display="block",a.notify("selection",{prop:"setDragCanvas",value:{bool:!0}})):(a.currObjType.isCustomCrop=!1,a.currObjType.shape=s,r&&o?n={startX:e,startY:i,endX:e+r,endY:i+o,width:r,height:o}:r&&s==="crop-circle"&&(n={startX:e,startY:i,endX:e+r,endY:i+r,width:r,height:r}),a.activeObj.shape=s,this.updateSelectionInsert(n))},l.prototype.updateSelectionInsert=function(t){var e=this.parent,i=e.activeObj.activePoint,r={shapeSettingsObj:{}};e.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:r}});var o={type:e.getSelectionType(r.shapeSettingsObj.type),startX:r.shapeSettingsObj.startX,startY:r.shapeSettingsObj.startY,width:r.shapeSettingsObj.width,height:r.shapeSettingsObj.height},a={action:"insert",previousSelectionSettings:o,currentSelectionSettings:o};e.trigger("selectionChanging",a),e.editCompleteArgs=a,e.notify("shape",{prop:"updSelChangeEventArgs",onPropertyChange:!1,value:{selectionSettings:a.currentSelectionSettings}}),a.currentSelectionSettings.type==="Custom"?this.drawObject("duplicate",e.activeObj,null,null,!0):((i.startX!==0||i.startY!==0||i.width!==0||i.height!==0)&&(t={startX:i.startX,startY:i.startY,endX:i.endX,endY:i.endY,width:i.width,height:i.height}),this.drawObject("duplicate",null,!0,t))},l.prototype.drawCustomSelection=function(t,e,i,r,o){var a=this.parent,n=a.activeObj.activePoint;if(a.currObjType.isCustomCrop=!0,this.upperContext.clearRect(0,0,a.upperCanvas.width,a.upperCanvas.height),a.currObjType.shape=a.activeObj.shape=t.toLowerCase(),!d(e)&&!d(i)&&!d(r)&&!d(o))n.startX=e,n.startY=i,n.endX=e+r,n.endY=i+o,n.width=r,n.height=o;else if(r&&o){var s=a.img,h=s.destLeft,p=s.destTop,u=s.destWidth,c=s.destHeight;n.width=r,n.height=o,n.startX=h+(u/2-r/2),n.startY=p+(c/2-o/2)}else{if(d(a.transform.zoomFactor)||a.transform.zoomFactor===0){var f=a.img,g=f.destLeft,v=f.destTop,m=f.destWidth,C=f.destHeight,M=a.lowerCanvas.width,I=a.lowerCanvas.height,N=n;g>=0&&v>=0?(N.startX=g,N.startY=v,N.endX=g+m,N.endY=v+C):g>=0?(N.startX=g,N.startY=7.5,N.endX=g+m,N.endY=I-15):v>=0?(N.startX=7.5,N.startY=v,N.endX=M-15,N.endY=v+C):(N.startX=7.5,N.startY=7.5,N.endX=M-15,N.endY=I-15)}else{var O=a.img,x=O.destLeft,D=O.destTop,A=O.destWidth,P=O.destHeight,V=a.lowerCanvas.width,q=a.lowerCanvas.height,re=n;re.startX=Math.max(x>0?x:7.5,x),re.startY=Math.max(D>0?D:7.5,D),re.endX=Math.min(x+A+15<V?x+A-15:V-15,x+A),re.endY=Math.min(D+P+15<q?D+P-15:q-15,D+P)}var ae=a.img,h=ae.destLeft,p=ae.destTop,u=ae.destWidth,c=ae.destHeight,E=a.lowerCanvas.clientWidth,L=a.lowerCanvas.clientHeight,k=n;if(k.startX=Math.max(k.startX,h),k.startY=Math.max(k.startY,p),k.endX=Math.min(k.endX,h+u),k.endY=Math.min(k.endY,p+c),a.transform.straighten>0?(this.imgCanvasPoints[0].x>k.startX&&(k.startX=this.imgCanvasPoints[0].x),this.imgCanvasPoints[0].y>k.startY&&(k.startY=this.imgCanvasPoints[0].y),this.imgCanvasPoints[2].x<k.endX&&(k.endX=this.imgCanvasPoints[2].x),this.imgCanvasPoints[2].y<k.endY&&(k.endY=this.imgCanvasPoints[2].x)):a.transform.straighten<0&&(this.imgCanvasPoints[3].x>k.startX&&(k.startX=this.imgCanvasPoints[3].x),this.imgCanvasPoints[3].y<k.startY&&(k.startY=this.imgCanvasPoints[3].y),this.imgCanvasPoints[1].x<k.endX&&(k.endX=this.imgCanvasPoints[1].x),this.imgCanvasPoints[1].y>k.endY&&(k.endY=this.imgCanvasPoints[1].x)),k.startX===h&&h+u>E&&(k.endX=E-15),k.startY===p&&p+c>L&&(k.endY=L-15),a.activeObj.activePoint.startX>a.activeObj.activePoint.endX){var U=a.activeObj.activePoint.startX;a.activeObj.activePoint.startX=a.activeObj.activePoint.endX,a.activeObj.activePoint.endX=U}if(a.activeObj.activePoint.startY>a.activeObj.activePoint.endY){var U=a.activeObj.activePoint.startY;a.activeObj.activePoint.startY=a.activeObj.activePoint.endY,a.activeObj.activePoint.endY=U}a.activeObj=this.updateWidthHeight(a.activeObj),this.updateActiveObject(n,a.activeObj),this.adjActObj()}this.updateSelectionInsert()},l.prototype.adjToStraighten=function(){var t=this.parent;if(t.transform.straighten!==0&&t.isStraightening){var e=t.activeObj.activePoint;e.startX+=7.5,e.startY+=7.5,e.endX-=7.5,e.endY-=7.5,t.activeObj=this.updateWidthHeight(t.activeObj)}},l.prototype.adjActObj=function(){var t=this.parent;if(t.transform.straighten!==0)for(var e=t.activeObj.activePoint,i=y({},e,{},!0),r=0;;){r++;var o={isIntersect:null,arr:null};if(t.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),t.notify("draw",{prop:"isLinesIntersect",onPropertyChange:!1,value:{obj:o}}),o.arr[0]||o.arr[1]||o.arr[2]||o.arr[3]||r===100){e=y({},i,{},!0);break}i=y({},e,{},!0),e.startX-=5,e.endX+=5,e.width=e.endX-e.startX,this.updateActiveObject(e,t.activeObj)}},l.prototype.callUpdateCurrTransState=function(){var t=this.parent,e=y([],t.objColl,[],!0),i=y({},t.activeObj,{},!0);t.objColl=[],t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.isRotateZoom=!0,this.updateCurrTransState("initial"),this.lowerContext.clearRect(0,0,t.lowerCanvas.width,t.lowerCanvas.height),t.transform.degree===0&&t.rotateFlipColl.length>0&&(t.img.destLeft+=t.panPoint.totalPannedPoint.x,t.img.destTop+=t.panPoint.totalPannedPoint.y),t.img.destLeft+=t.panPoint.totalPannedInternalPoint.x,t.img.destTop+=t.panPoint.totalPannedInternalPoint.y;var r=this.lowerContext.filter;t.transform.degree===0&&t.notify("transform",{prop:"setDestPointsForFlipState",onPropertyChange:!1}),this.drawImage(),this.updateCurrTransState("reverse"),t.transform.degree===0&&t.rotateFlipColl.length>0&&(t.img.destLeft+=t.panPoint.totalPannedPoint.x,t.img.destTop+=t.panPoint.totalPannedPoint.y),this.isRotateZoom=!1,t.objColl=e;var o=t.togglePen;t.togglePen=!1,this.lowerContext.filter="none";var a={penStrokeWidth:null};t.notify("freehand-draw",{prop:"getPenStrokeWidth",onPropertyChange:!1,value:{obj:a}}),t.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"iterate",pen:"iterate",isPreventApply:null}}),t.notify("freehand-draw",{prop:"setPenStrokeWidth",onPropertyChange:!1,value:{value:a.penStrokeWidth}}),t.img.destLeft+=t.panPoint.totalPannedInternalPoint.x,t.img.destTop+=t.panPoint.totalPannedInternalPoint.y,t.img.destLeft-=t.panPoint.totalPannedInternalPoint.x,t.img.destTop-=t.panPoint.totalPannedInternalPoint.y,t.togglePen=o,this.lowerContext.filter=r,t.activeObj=i},l.prototype.resetPanPoints=function(){this.parent.panPoint.totalPannedPoint={x:0,y:0},this.parent.panPoint.totalPannedClientPoint={x:0,y:0},this.parent.panPoint.totalPannedInternalPoint={x:0,y:0}},l.prototype.setClientTransDim=function(t){var e=this.parent;if(e.transform.degree%90===0&&e.transform.degree%180!==0){e.img.destLeft=(e.lowerCanvas.clientWidth-e.img.destHeight)/2,e.img.destTop=(e.lowerCanvas.clientHeight-e.img.destWidth+1)/2;var i=e.img.destWidth;e.img.destWidth=e.img.destHeight,e.img.destHeight=i}else d(t)&&(e.img.destLeft=(e.lowerCanvas.clientWidth-e.img.destWidth)/2,e.img.destTop=(e.lowerCanvas.clientHeight-e.img.destHeight+1)/2)},l.prototype.redrawImgWithObj=function(){var t=this.parent,e={canvasFilter:t.canvasFilter};if(this.lowerContext.filter=e.canvasFilter,t.rotateFlipColl.length!==0){var i=y({},t.panPoint.totalPannedInternalPoint,{},!0),r={startX:t.img.destLeft,startY:t.img.destTop,width:t.img.destWidth,height:t.img.destHeight};this.callUpdateCurrTransState(),t.panPoint.totalPannedInternalPoint=i,t.img.destLeft=r.startX,t.img.destTop=r.startY,t.img.destWidth=r.width,t.img.destHeight=r.height}else this.callUpdateCurrTransState();t.isCircleCrop&&t.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}})},l.prototype.setCurrentObj=function(t,e,i){var r=this.parent,o=!!t;o||(r.cropObj.aspectWidth=r.aspectWidth,r.cropObj.aspectHeight=r.aspectHeight,r.cropObj.frame=r.frameObj.type),t=t||r.cropObj,r.transform.cropZoomFactor=t.cropZoom,r.transform.defaultZoomFactor=t.defaultZoom,this.straightenInitZoom=t.straightenZoom,o?t.activeObj.shape&&t.activeObj.shape.split("-")[0]==="crop"?r.transform.zoomFactor=t.cropZoom:r.transform.zoomFactor=t.defaultZoom:r.transform.zoomFactor=t.cropZoom,r.setProperties({zoomSettings:{zoomFactor:t.zoomFactor}},!0),r.notify("transform",{prop:"setPreviousZoomValue",onPropertyChange:!1,value:{previousZoomValue:t.previousZoomValue}}),r.panPoint.totalPannedPoint=y({},t.totalPannedPoint,{},!0),r.panPoint.totalPannedClientPoint=y({},t.totalPannedClientPoint,{},!0),r.panPoint.totalPannedInternalPoint=y({},t.totalPannedInternalPoint,{},!0);var a=y({},t.tempFlipPanPoint,{},!0);r.notify("crop",{prop:"setTempFlipPanPoint",onPropertyChange:!1,value:{point:a}}),r.rotateFlipColl=y([],t.rotateFlipColl,[],!0),r.transform.degree=t.degree,r.frameObj.type=t.frame,r.transform.currFlipState=t.currFlipState,r.notify("filter",{prop:"setAdjustmentLevel",onPropertyChange:!1,value:{adjustmentLevel:t.adjustmentLevel}}),r.notify("filter",{prop:"setTempAdjVal"}),r.currentFilter=t.currentFilter,r.notify("filter",{prop:"setTempFilVal"}),(r.transform.straighten!==t.straighten||e)&&(r.transform.straighten=t.straighten,r.straightenBaseImageCanvas()),r.img={destLeft:t.destPoints.startX,destTop:t.destPoints.startY,destWidth:t.destPoints.width,destHeight:t.destPoints.height,srcLeft:t.srcPoints.startX,srcTop:t.srcPoints.startY,srcWidth:t.srcPoints.width,srcHeight:t.srcPoints.height},r.aspectWidth=t.aspectWidth,r.aspectHeight=t.aspectHeight,t.afterCropActions&&(r.afterCropActions=t.afterCropActions),this.lowerContext.filter=t.filter,r.notify("filter",{prop:"setBrightnessAdjusted",onPropertyChange:!1,value:{isBrightnessAdjusted:t.isBrightAdjust}}),r.notify("draw",{prop:"imageBackgroundColor",onPropertyChange:!1,value:{color:t.bgColor}});var n=r.isCircleCrop,s;d(r.currSelectionPoint)?s=null:(s=y({},r.currSelectionPoint,{},!0),r.currSelectionPoint=null),r.isCircleCrop=!1,i&&(r.frameObj.type="none"),this.drawCropSelectionImage(t,!1),r.transform.degree!==0&&(r.transform.currFlipState===""?r.notify("transform",{prop:"rotatePan",onPropertyChange:!1,value:{isCropSelection:null,isDefaultZoom:null}}):r.notify("transform",{prop:"drawPannedImage",value:{xDiff:0,yDiff:0}}),r.img.destLeft=t.destPoints.startX,r.img.destTop=t.destPoints.startY,r.panPoint.totalPannedClientPoint=y({},t.totalPannedClientPoint,{},!0),r.panPoint.totalPannedInternalPoint=y({},t.totalPannedInternalPoint,{},!0)),r.activeObj=y({},t.activeObj,{},!0),this.upperContext.clearRect(0,0,r.upperCanvas.width,r.upperCanvas.height),r.activeObj.activePoint.width!==0&&r.activeObj.activePoint.height!==0&&this.drawObject("duplicate",null,null,null,!0);var h=y({},t.activeObj,{},!0),p=!1;if(r.afterCropActions.length>0){var u={collection:r.afterCropActions};r.notify("shape",{prop:"alignRotateFlipColl",onPropertyChange:!1,value:{collection:r.afterCropActions,isRotateFlipCollection:null,obj:u}}),r.afterCropActions=u.collection}var c=y([],r.afterCropActions,[],!0);if(!o&&c.length>0){p=!0;for(var f=0,g=c.length;f<g;f++)(c[f]==="horizontalflip"||c[f]==="verticalflip")&&(r.activeObj=y({},s,{},!0),this.rotatedFlipCropSel=!0),r.notify("transform",{prop:"updateTransform",onPropertyChange:!1,value:{text:c[f]}});h=y({},r.activeObj,{},!0),this.resetPanPoints(),r.activeObj=h,this.upperContext.clearRect(0,0,r.upperCanvas.width,r.upperCanvas.height),r.activeObj.activePoint.width!==0&&r.activeObj.activePoint.height!==0&&this.drawObject("duplicate",null,null,null,!0),t.degree!==r.transform.degree&&(r.transform.cropZoomFactor=null,r.transform.zoomFactor=0),r.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1}),this.rotatedFlipCropSel&&(this.rotatedFlipCropSel=!1)}r.afterCropActions=c,!this.isCancelAction&&!p&&(r.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1}),r.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),r.img.destLeft=t.destPoints.startX,r.img.destTop=t.destPoints.startY),r.activeObj=h,r.isCircleCrop=n,d(s)?r.currSelectionPoint=null:(r.currSelectionPoint=y({},s,{},!0),r.currSelectionPoint&&d(r.currSelectionPoint.shape)&&(r.currSelectionPoint=null))},l.prototype.drawCropSelectionImage=function(t,e){var i=this.parent,r=this.lowerContext.filter;i.clearContext(this.lowerContext),i.clearContext(this.upperContext),this.lowerContext.setTransform(1,0,0,1,0,0),e?this.updateCurrTransState("initial"):this.setTransformColl(this.lowerContext,"initial"),i.notify("transform",{prop:"setDestPointsForFlipState",onPropertyChange:!1}),this.drawImage(),e?this.updateCurrTransState("reverse"):this.setTransformColl(this.lowerContext,"reverse"),i.img.destLeft=i.cropObj.destPoints.startX,i.img.destTop=i.cropObj.destPoints.startY;var o=y({},t.activeObj,{},!0);if(this.lowerContext.filter="none",i.img={destLeft:t.destPoints.startX,destTop:t.destPoints.startY,destWidth:t.destPoints.width,destHeight:t.destPoints.height,srcLeft:t.srcPoints.startX,srcTop:t.srcPoints.startY,srcWidth:t.srcPoints.width,srcHeight:t.srcPoints.height},t.activeObj.activePoint.width!==0&&t.activeObj.activePoint.height!==0){var a={startX:i.img.destLeft,startY:i.img.destTop,width:i.img.destWidth,height:i.img.destHeight};i.img.destLeft=t.activeObj.activePoint.startX,i.img.destTop=t.activeObj.activePoint.startY,i.img.destWidth=t.activeObj.activePoint.width,i.img.destHeight=t.activeObj.activePoint.height,i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),i.img.destLeft=a.startX,i.img.destTop=a.startY,i.img.destWidth=a.width,i.img.destHeight=a.height}i.activeObj=o,this.lowerContext.filter=r},l.prototype.performPointZoom=function(t,e,i,r,o){var a=this.parent,n=a.img,s=n.destLeft,h=n.destTop,p=n.destWidth,u=n.destHeight,c=!1;a.activeObj.shape&&a.activeObj.shape.indexOf("crop-")>-1&&(c=!0),a.element.querySelector(".e-contextual-toolbar-wrapper")&&!c&&(a.element.querySelector(".e-contextual-toolbar-wrapper").classList.contains("e-hide")||(a.okBtn(),a.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide")));var f=(t-s)/p,g=(e-h)/u,v=a.isUndoRedo;a.isUndoRedo=!0,a.setProperties({zoomSettings:{zoomPoint:{x:t,y:e}}},!0);var m=o||(i==="zoomIn"?.1:-.1);a.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:m,zoomPoint:null,isResize:r}}),a.isUndoRedo=v,this.panToPoint(t,e,f,g)},l.prototype.panToPoint=function(t,e,i,r){var o=this.parent;if(o.transform.zoomFactor>0){var a=o.img.destLeft,n=o.img.destTop,s=y({},o.activeObj,{},!0);if(o.transform.degree===0)o.img.destLeft=t-i*o.img.destWidth,o.img.destTop=e-r*o.img.destHeight,this.drawZoomPanImage(o.img.destLeft-a,o.img.destTop-n);else{var h=o.isCropTab;o.isCropTab=!0;var p=y([],o.objColl,[],!0),u=y([],o.pointColl,[],!0),c={straightenPoint:null};o.notify("freehand-draw",{prop:"getStraightenPoint",onPropertyChange:!1,value:{obj:c}}),o.objColl=[],o.pointColl=[],o.freehandCounter=0,o.notify("freehand-draw",{prop:"setStraightenPoint",onPropertyChange:!1,value:{x:null,y:null,ratioX:null,ratioY:null}});var f={selPointColl:null};o.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:f}});var g=f.selPointColl;o.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:[]}}}),o.panPoint.currentPannedPoint={x:t-i*o.img.destWidth-a,y:e-r*o.img.destHeight-n},o.notify("transform",{prop:"rotatePan",onPropertyChange:!1,value:{isCropSelection:null,isDefaultZoom:null}}),o.isCropTab=h,o.objColl=p,o.pointColl=u,o.freehandCounter=o.pointColl.length,c.straightenPoint.x&&c.straightenPoint.y&&o.notify("freehand-draw",{prop:"setStraightenPoint",onPropertyChange:!1,value:{x:c.straightenPoint.x,y:c.straightenPoint.y,ratioX:c.straightenPoint.ratioX,ratioY:c.straightenPoint.ratioY}}),o.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:g}}}),o.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"pan",pen:"pan",x:o.panPoint.currentPannedPoint.x,y:o.panPoint.currentPannedPoint.y,panRegion:""}})}this.adjustPanning(s);for(var v=!1,m=0;m<o.objColl.length;m++)if(JSON.stringify(s.activePoint)===JSON.stringify(o.objColl[m].activePoint)){v=!0;break}v||(o.activeObj=s),o.activeObj.activePoint.width!==0&&o.activeObj.activePoint.height!==0&&this.drawObject("duplicate",null,null,null,!0)}},l.prototype.adjustPanning=function(t){var e=this.parent,i=t.activePoint,r=i.startX,o=i.startY,a=i.width,n=i.height;if(a!==0&&n!==0){var s=e.img,h=s.destLeft,p=s.destTop,u=s.destWidth,c=s.destHeight,f={x:0,y:0};if(h>r?f.x=h-r:h+u<r+a&&(f.x=h+u-(r+a)),p>o?f.y=p-o:p+c<o+n&&(f.y=p+c-(o+n)),e.transform.degree===0)e.img.destLeft-=f.x,e.img.destTop-=f.y,this.drawZoomPanImage(e.img.destLeft-h,e.img.destTop-p);else{var g=e.isCropTab;e.isCropTab=!0;var v=y([],e.objColl,[],!0),m=y([],e.pointColl,[],!0);e.objColl=[],e.pointColl=[],e.freehandCounter=0;var C={selPointColl:null};e.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:C}});var M=C.selPointColl;e.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:[]}}}),e.img.destLeft-=f.x,e.img.destTop-=f.y,e.panPoint.currentPannedPoint={x:e.img.destLeft-h,y:e.img.destTop-p},e.notify("transform",{prop:"rotatePan",onPropertyChange:!1,value:{isCropSelection:null,isDefaultZoom:null}}),e.isCropTab=g,e.objColl=v,e.pointColl=m,e.freehandCounter=e.pointColl.length,e.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:M}}}),e.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"pan",pen:"pan",x:e.panPoint.currentPannedPoint.x,y:e.panPoint.currentPannedPoint.y,panRegion:""}})}}},l.prototype.panToSel=function(){var t=this.parent,e=y({},t.activeObj,{},!0),i=e.activePoint,r=i.startX,o=i.startY,a=i.width,n=i.height;this.allowRedactStraighten=!0;var s={straightenPoint:null};if(t.notify("freehand-draw",{prop:"getStraightenPoint",onPropertyChange:!1,value:{obj:s}}),s.straightenPoint.x&&s.straightenPoint.y){var h=r+a/2-s.straightenPoint.x,p=o+n/2-s.straightenPoint.y;t.transform.degree===0?(t.img.destLeft+=h,t.img.destTop+=p,t.notify("transform",{prop:"drawPannImage",value:{point:{x:h,y:p}}})):(t.panPoint.currentPannedPoint={x:h,y:p},t.notify("transform",{prop:"drawPannedImage",value:{xDiff:h,yDiff:p}}),t.panPoint.currentPannedPoint={x:0,y:0},t.notify("transform",{prop:"setTempPanMove",value:{point:null}})),t.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:e}});var u=t.img,c=u.destLeft,f=u.destTop,g=u.destWidth,v=u.destHeight,m=this.imgCanvasPoints;m.forEach(function(I){I.x=I.ratioX*g+c,I.y=I.ratioY*v+f}),this.imgCanvasPoints=m;var C=0;if(t.transform.straighten===3&&!this.preventStraightening){this.preventStraightening=!0;var M=t.prevStraightenedDegree;t.prevStraightenedDegree=t.transform.straighten,t.setStraighten(0),t.setStraighten(3),t.prevStraightenedDegree=M,this.preventStraightening=!1}for(;this.isLinesIntersect()&&t.transform.straighten!==0&&t.transform.straighten!==360&&C<100;)C++,this.performPointZoom(t.activeObj.activePoint.startX+t.activeObj.activePoint.width/2,t.activeObj.activePoint.startY+t.activeObj.activePoint.height/2,"zoomIn",!1,.025),this.updateImgCanvasPoints()}},l.prototype.drawZoomPanImage=function(t,e){var i=this.parent;i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"pan",pen:"pan",x:t,y:e,panRegion:""}}),this.renderImage(!0);var r={width:0,height:0};i.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:i.img.srcWidth,height:i.img.srcHeight,obj:r,isImgShape:null}});var o=r;o.width+=o.width*i.transform.zoomFactor,o.height+=o.height*i.transform.zoomFactor,i.panPoint.totalPannedPoint.x+=t,i.panPoint.totalPannedPoint.y+=e,i.notify("crop",{prop:"setTempFlipPanPoint",onPropertyChange:!1,value:{point:{x:0,y:0}}})},l.prototype.openNewImage=function(){var t=this,e=this.parent,i=e.element.id,r=e.inMemoryCanvas.getContext("2d");Bt(e.element),e.element.style.opacity="0.5";var o=document.querySelector("#"+i+"_currPos");o&&(o.style.display="none");var a={defToolbarItems:null};if(e.notify("toolbar",{prop:"getDefToolbarItems",value:{obj:a}}),a.defToolbarItems&&a.defToolbarItems.length===0&&d(document.getElementById(i+"_toolbar"))&&e.element.querySelector("#"+i+"_toolbarArea")){var n=e.element.querySelector("#"+i+"_toolbarArea").clientHeight;e.notify("toolbar",{prop:"setToolbarHeight",value:{height:n}})}e.reset(),e.update(),e.transform.degree=0,e.transform.zoomFactor=0,e.isImageLoaded=!1,e.currSelectionPoint=null;var s=typeof this.openURL;if(s==="string"){var h=this.openURL.split(".");if(h.length>1?(h=h[h.length-2].split("/"),this.fileName=h[h.length-1]):this.fileName="ImageEditor",this.fileType=this.getFileExtensionFromURL(this.openURL),this.fileType){this.fileType=e.toPascalCase(this.fileType);var p=this.fileType.toLowerCase();(p==="jpg"||p==="jpeg")&&(this.fileType="Jpeg",p="jpeg"),p!=="jpeg"&&p!=="png"&&p!=="svg"&&p!=="webp"&&(this.fileType=null)}this.imageOnLoad(this.openURL),(typeof this.openURL!="string"||this.openURL.indexOf("localhost")===-1)&&this.getImageSizeFromURL(this.openURL.toString(),function(u){u!==null&&t.parent.notify("toolbar",{prop:"setInitialSize",value:{value:+u}})})}else this.fileName="ImageEditor",this.fileType=null,e.lowerCanvas=document.querySelector("#"+i+"_lowerCanvas"),e.upperCanvas=document.querySelector("#"+i+"_upperCanvas"),this.lowerContext=e.lowerCanvas.getContext("2d"),this.upperContext=e.upperCanvas.getContext("2d"),e.clearContext(this.lowerContext),e.clearContext(this.upperContext),e.clearContext(r),e.inMemoryCanvas.width=this.openURL.width,e.inMemoryCanvas.height=this.openURL.height,r.putImageData(this.openURL,0,0),e.baseImg.src=e.inMemoryCanvas.toDataURL()},l.prototype.getImageSizeFromURL=function(t,e){return sv(this,void 0,void 0,function(){var i,r,o,a;return lv(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,fetch(t,{method:"HEAD"})];case 1:return i=n.sent(),r=parseInt(i.headers.get("content-length")||"0",10),o=r,e(o),[3,3];case 2:return a=n.sent(),console.log(a.message),[3,3];case 3:return[2]}})})},l.prototype.dlgBtnClick=function(){this.parent.export(),this.applyDialogOption()},l.prototype.dlgCloseBtnClick=function(){this.applyDialogOption()},l.prototype.applyDialogOption=function(){var t=this.parent;this.isFileChanged?(t.isImageLoaded=this.isFileChanged=!1,t.reset(),this.checkToolbarTemplate(this.inputElem,this.openURL)):(this.reset(),this.openNewImage()),Q(document.getElementById(t.element.id+"_dialog"),"dialog").destroy(),this.isImageEdited=!1},l.prototype.showDialogPopup=function(){var t=this.parent,e={key:"ConfirmDialogHeader"};t.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:e}});var i={key:"ConfirmDialogContent"};t.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:i}});var r={key:"Yes"};t.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:r}});var o={key:"No"};t.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:o}}),t.element.querySelector("#"+t.element.id+"_dialog").style.display="block";var a=new Ao({header:e.value,closeOnEscape:!0,content:"<span>"+i.value+"</span>",target:document.getElementById("target"),width:"285px",isModal:!0,animationSettings:{effect:"Zoom"},close:this.dlgCloseBtnClick.bind(this),buttons:[{click:this.dlgCloseBtnClick.bind(this),buttonModel:{content:o.value,iconCss:"e-icons e-close"}},{click:this.dlgBtnClick.bind(this),buttonModel:{content:r.value,isPrimary:!0,iconCss:"e-icons e-check"}}]});a.appendTo("#"+t.element.id+"_dialog")},l.prototype.restoreOldImage=function(){var t=this,e=this.parent,i=document.getElementById(this.parent.element.id+"_dropArea"),r=e.getExtensionArray(),o=typeof this.openURL;if(o!=="string"){this.openImageData(i);return}var a=this.getFileExtensionFromURL(this.openURL);a&&(a=a.toLowerCase(),a=a==="jpg"||a==="jpeg"?"jpeg":a);var n=(a?r.indexOf(a)>-1||a==="jpeg"&&(e.uploadSettings.allowedExtensions.indexOf("jpg")>-1||e.uploadSettings.allowedExtensions.indexOf("jpeg")>-1):!1)||this.isNullExtension;this.openURL.indexOf("data:image/")>-1&&this.openURL.indexOf("base64")>-1||this.openURL.indexOf("blob")>-1?this.openImageData(i,!0):e.uploadSettings.minFileSize||e.uploadSettings.maxFileSize?this.getImageSizeFromURL(this.openURL.toString(),function(s){var h=e.uploadSettings.minFileSize&&s<e.uploadSettings.minFileSize||e.uploadSettings.maxFileSize&&s>e.uploadSettings.maxFileSize;t.handleFileSize(!n||h,i,!n)}):this.handleFileSize(!n,i,!n)},l.prototype.handleFileSize=function(t,e,i){var r=this.parent;t?(this.errorLoading(),r.showDialogPopup("unsupported",i),e&&!r.isImageLoaded&&(e.style.display="block")):(e&&(e.style.display="none"),this.parent.isImageLoaded&&this.reset(),this.openNewImage())},l.prototype.openImageData=function(t,e){var i=this.parent,r=this,o=i.createElement("canvas"),a=o.getContext("2d");if(!i.uploadSettings.minFileSize&&!i.uploadSettings.maxFileSize){this.handleFileSize(!1,t,!1);return}if(e){var n=new Image;n.src=this.openURL,n.onload=function(){a.canvas.width=n.width,a.canvas.height=n.height,a.drawImage(n,0,0),r.getImageSize(o,t)}}else o.width=this.openURL.width,o.height=this.openURL.height,a.putImageData(this.openURL,0,0),this.getImageSize(o,t)},l.prototype.getImageSize=function(t,e){var i=this.parent;t.toBlob((function(r){i.uploadSettings.minFileSize&&r.size<i.uploadSettings.minFileSize||i.uploadSettings.maxFileSize&&r.size>i.uploadSettings.maxFileSize?this.handleFileSize(!0,e,!1):this.handleFileSize(!1,e,!1)}).bind(this),"image/jpeg",1)},l.prototype.open=function(t){this.parent.disabled||(this.openURL=t,this.restoreOldImage())},l.prototype.getInitialLoaded=function(t){t.isInitialLoaded=this.isInitialLoading},l.prototype.getFileExtensionFromURL=function(t){var e=t.lastIndexOf(".");return e!==-1?t.slice(e+1).toLowerCase():t.indexOf("base64")!==-1?t.slice(t.indexOf("/")+1,t.indexOf(";")).toLowerCase():null},l.prototype.fileSelect=function(t,e){var i=this.parent,r=document.getElementById(i.element.id+"_dropArea");if(r&&(r.style.display="none"),!i.disabled){var o=void 0,a=void 0;e.target?(o=e.target.files[0],a=o):o=a=e.filesData[0].rawFile;var n=void 0;if(a.name){var s=a.name.split(".");n=s[s.length-1].toLowerCase()}var h=i.getExtensionArray(),p=(n==="jpg"||n==="jpeg")&&(i.uploadSettings.allowedExtensions.indexOf("jpg")>-1||i.uploadSettings.allowedExtensions.indexOf("jpeg")>-1);if(n&&h.indexOf(n)===-1&&!p||i.uploadSettings.minFileSize&&a.size<i.uploadSettings.minFileSize||i.uploadSettings.maxFileSize&&a.size>i.uploadSettings.maxFileSize){this.errorLoading();return}if(Bt(i.element),i.element.style.opacity="0.5",this.inputElem=t,n=a.name&&a.name.split(".")[1],n){var u=i.toPascalCase(n);u==="JPG"||u==="Jpg"?this.fileType="Jpeg":this.fileType=u}else this.fileType=null;var c=window.URL,f=c.createObjectURL(o);this.openURL=f,i.isImageLoaded&&!i.isChangesSaved&&(this.isImageEdited||i.pointColl.length>0||i.objColl.length>0)?(this.isFileChanged=!0,this.showDialogPopup()):this.checkToolbarTemplate(t,f)}},l.prototype.checkToolbarTemplate=function(t,e){var i=this.parent;d(i.toolbarTemplate)&&(i.reset(),i.update()),this.fileName=t.value.split("\\")[t.value.split("\\").length-1],this.fileName=this.fileName.split(".")[0],this.imageOnLoad(e.toString()),t.value=""},l.prototype.moveToSelectionRange=function(t,e){var i=this.parent;if(i.activeObj.shape){for(var r=!1,o=0,a=i.rotateFlipColl.length;o<a;o++){var n=i.rotateFlipColl[o];if(n===90||n===-90){r=!0;break}}if(r){if(i.transform.degree===0)return;var s=i.transform.zoomFactor;i.objColl.push(i.activeObj),i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1});var h=i.objColl[i.objColl.length-1];if(t==="rotateleft"||t==="rotateright")if(i.transform.degree%90===0&&i.transform.degree%180!==0)if(h.activePoint.width<e.activePoint.height)for(var o=2;o<i.zoomSettings.maxZoomFactor;o++){if(h.activePoint.width>=e.activePoint.height||this.isSelectionBiggerThanCanvas(h)||this.isSelectionOutsideCanvas(h)){d(s)||i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-.1,zoomPoint:null},isResize:null});break}s+=.1,i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:s,zoomPoint:null},isResize:null})}else for(var o=2;o<i.zoomSettings.maxZoomFactor;o++){if(h.activePoint.width>=e.activePoint.height||this.isSelectionBiggerThanCanvas(h)||this.isSelectionOutsideCanvas(h)){d(s)||i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:.1,zoomPoint:null,isResize:null}});break}s-=.1,i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:s,zoomPoint:null},isResize:null})}else if(h.activePoint.height<e.activePoint.width)for(var o=2;o<i.zoomSettings.maxZoomFactor;o++){if(h.activePoint.height>=e.activePoint.width||this.isSelectionBiggerThanCanvas(h)||this.isSelectionOutsideCanvas(h)){d(s)||i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-.1,zoomPoint:null},isResize:null});break}s+=.1,i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:s,zoomPoint:null},isResize:null})}else for(var o=2;o<i.zoomSettings.maxZoomFactor;o++){if(h.activePoint.height>=e.activePoint.width||this.isSelectionBiggerThanCanvas(h)||this.isSelectionOutsideCanvas(h)){d(s)||i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:.1,zoomPoint:null},isResize:null});break}s-=.1,i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:s,zoomPoint:null},isResize:null})}var p=i.lowerCanvas.clientWidth/2-(h.activePoint.startX+h.activePoint.width/2),u=(i.lowerCanvas.clientHeight+1)/2-(h.activePoint.startY+h.activePoint.height/2);d(i.activeObj.shape)&&(i.activeObj=y({},e,{},!0)),i.transform.degree===0?(i.img.destLeft+=p,i.img.destTop+=u,i.notify("transform",{prop:"drawPannImage",value:{point:{x:p,y:u}}})):(i.panPoint.currentPannedPoint={x:p,y:u},i.notify("transform",{prop:"drawPannedImage",value:{xDiff:p,yDiff:u}}),i.panPoint.currentPannedPoint={x:0,y:0}),i.notify("transform",{prop:"setTempPanMove",onPropertyChange:!1,value:{point:null}}),i.activeObj=y({},i.objColl[i.objColl.length-1]),i.objColl.pop(),i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:i.activeObj}})}}},l.prototype.isSelectionBiggerThanCanvas=function(t){var e=!1,i=this.parent,r=t.activePoint,o=r.startX,a=r.startY,n=r.endX,s=r.endY,h=i.img,p=h.destLeft,u=h.destTop,c=h.destWidth,f=h.destHeight;return(o<=p||a<=u||n>=p+c||s>=u+f)&&(e=!0),e},l.prototype.isSelectionOutsideCanvas=function(t){var e=!1,i=this.parent;return(t.activePoint.height<i.lowerCanvas.height-i.toolbarHeight||t.activePoint.width<i.lowerCanvas.width)&&(e=!0),e},l.prototype.downScaleImgCanvas=function(t,e,i,r){var o=this.parent,a=e?o.activeObj.imageCanvas:o.baseImgCanvas,n=e?o.activeObj.imageElement:o.baseImg,s=e?o.activeObj.activePoint.width:o.img.destWidth,h=e?o.activeObj.activePoint.height:o.img.destHeight,p={width:0,height:0};if(o.transform.degree%90===0&&o.transform.degree%180!==0?o.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:n.height,height:n.width,obj:p,isImgShape:e}}):o.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:n.width,height:n.height,obj:p,isImgShape:e}}),e||o.allowDownScale&&!o.isCropTab&&!o.isCropToolbar&&n.width!==0&&n.height!==0&&p.width*.75>s&&p.height*.75>h){var u=o.createElement("canvas",{id:o.element.id+"_downScaleCanvas",attrs:{name:"canvasImage"}});u.width=e?n.width:o.img.srcWidth,u.height=e?n.height:o.img.srcHeight,e?u.getContext("2d").drawImage(n,0,0,u.width,u.height):(this.imageBackgroundColor!==""&&(t.fillStyle=this.imageBackgroundColor,t.fillRect(o.img.destLeft,o.img.destTop,o.img.destWidth,o.img.destHeight)),u.getContext("2d").drawImage(a,o.img.srcLeft,o.img.srcTop,o.img.srcWidth,o.img.srcHeight,0,0,u.width,u.height)),(e||this.isDownScale)&&this.downScale(u,s,h,e),e?(t.canvas.width=u.width,t.canvas.height=u.height,i&&r?(t.translate(o.activeObj.imageCanvas.width,0),t.scale(-1,1),t.translate(0,o.activeObj.imageCanvas.height),t.scale(1,-1)):i?(d(o.activeObj.isHorImageFlip)||!o.activeObj.isHorImageFlip?(o.activeObj.isHorImageFlip=!0,t.translate(o.activeObj.imageCanvas.width,0),t.scale(-1,1)):o.activeObj.isHorImageFlip&&(o.activeObj.isHorImageFlip=!1),o.activeObj.isVerImageFlip&&(t.translate(0,o.activeObj.imageCanvas.height),t.scale(1,-1))):r&&(d(o.activeObj.isVerImageFlip)||!o.activeObj.isVerImageFlip?(o.activeObj.isVerImageFlip=!0,t.translate(0,o.activeObj.imageCanvas.height),t.scale(1,-1)):o.activeObj.isVerImageFlip&&(o.activeObj.isVerImageFlip=!1),o.activeObj.isHorImageFlip&&(t.translate(o.activeObj.imageCanvas.width,0),t.scale(-1,1))),t.drawImage(u,0,0),t.setTransform(1,0,0,1,0,0)):o.isFinetuning?(t.save(),t.setTransform(1,0,0,1,0,0),t.drawImage(o.inMemoryCanvas,0,0),t.restore()):t.drawImage(u,0,0,u.width,u.height,o.img.destLeft,o.img.destTop,u.width,u.height)}else(d(e)||!e)&&o.baseImgCanvas.width!==0&&o.baseImgCanvas.height!==0&&(this.imageBackgroundColor!==""&&(t.fillStyle=this.imageBackgroundColor,t.fillRect(o.img.destLeft,o.img.destTop,o.img.destWidth,o.img.destHeight)),t.drawImage(o.baseImgCanvas,o.img.srcLeft,o.img.srcTop,o.img.srcWidth,o.img.srcHeight,o.img.destLeft,o.img.destTop,o.img.destWidth,o.img.destHeight));o.isSafari&&o.notify("filter",{prop:"apply-filter",onPropertyChange:!1,value:{context:t}})},l.prototype.downScale=function(t,e,i,r){var o=this.parent;if(!(r&&o.isStraightening)){var a=t.width,n=t.height;e=Math.round(e),i=Math.round(i);for(var s=a/e,h=n/i,p=Math.ceil(s/2),u=Math.ceil(h/2),c=t.getContext("2d"),f=c.getImageData(0,0,a,n),g=c.createImageData(e,i),v=f.data,m=g.data,C=0;C<i;C++)for(var M=0;M<e;M++){for(var I=(M+C*e)*4,N=0,O=0,x=0,D=0,A=0,P=0,V=0,q=(C+.5)*h,re=Math.floor(C*h),ae=Math.ceil((C+1)*h),E=re;E<ae;E++)for(var L=Math.abs(q-(E+.5))/u,k=(M+.5)*s,U=L*L,B=Math.floor(M*s),R=Math.ceil((M+1)*s),$=B;$<R;$++){var oe=Math.abs(k-($+.5))/p,he=Math.sqrt(U+oe*oe);if(!(he>=1)){N=2*he*he*he-3*he*he+1;var pe=4*($+E*a);V+=N*v[pe+3],x+=N,N=N*v[pe+3]/250,D+=N*v[pe],A+=N*v[pe+1],P+=N*v[pe+2],O+=N}}m[I]=D/O,m[I+1]=A/O,m[I+2]=P/O,m[I+3]=V/x}t.width=r?o.activeObj.activePoint.width:o.lowerCanvas.width,t.height=r?o.activeObj.activePoint.height:o.lowerCanvas.height,c.putImageData(g,0,0)}},l.prototype.drawImgToCtx=function(t,e){var i=this.parent;t.canvas.id!==i.element.id+"_tempCanvas"&&t!==this.upperContext&&d(e)&&this.downScaleImgCanvas(t,null,null,null)},l.prototype.getFrameColor=function(t,e,i){var r=this.parent,o=r.frameObj.color;if(t.gradientColor){var a=e.createLinearGradient(i.startX,i.startY,i.startX+i.width,i.startY+i.height);a.addColorStop(0,t.color),a.addColorStop(1,t.gradientColor),o=a}else o=t.color;return o},l.prototype.applyFrame=function(t,e,i){var r=this.parent;r.frameObj.type=e;var o,a={width:1,height:1},n={startX:r.img.destLeft-t.lineWidth,startY:r.img.destTop-t.lineWidth,width:r.img.destWidth+2*t.lineWidth,height:r.img.destHeight+2*t.lineWidth},s={type:r.frameObj.type,color:r.frameObj.color,size:r.frameObj.size,inset:r.frameObj.inset,offset:r.frameObj.offset/2,radius:r.frameObj.radius,amount:r.frameObj.amount,border:r.frameObj.border,gradientColor:r.frameObj.gradientColor},h=r.transform.zoomFactor;if(t.canvas.id===r.element.id+"_tempCanvas"){var p=t.canvas.width,u=t.canvas.height,c={width:0,height:0};r.notify("crop",{prop:"calcRatio",onPropertyChange:!1,value:{obj:c,dimension:{width:p,height:u}}}),a=c,s.size*=(a.width+a.height)/2,s.inset*=(a.width+a.height)/2,s.offset*=(a.width+a.height)/2,s.radius*=(a.width+a.height)/2,n={startX:0,startY:0,width:t.canvas.width,height:t.canvas.height},r.notify("export",{prop:"updateSaveContext",onPropertyChange:!1,value:{context:t}})}else t===this.upperContext&&r.activeObj.shape?n={startX:r.activeObj.activePoint.startX-t.lineWidth,startY:r.activeObj.activePoint.startY-t.lineWidth,width:r.activeObj.activePoint.width+2*t.lineWidth,height:r.activeObj.activePoint.height+2*t.lineWidth}:d(i)&&t.clearRect(0,0,t.canvas.width,t.canvas.height);var f=40*((a.width+a.height)/2),g=50*((a.width+a.height)/2);if(t!==this.upperContext&&(s.size+=s.size*h,s.inset+=s.inset*h,s.offset+=s.offset*h,s.radius+=s.radius*h,f+=f*h,g+=g*h),!(t===this.upperContext&&r.activeObj.shape&&(e==="mat"&&(n.width-2*s.size<0||n.height-2*s.size<0)||e==="bevel"&&(n.width-2*s.size<40||n.height-2*s.size<40)||e==="inset"&&(n.startX+n.width-s.offset-(n.startX+s.offset)<0||n.startY+n.height-s.offset-(n.startY+s.offset)<0)||e==="hook"&&(n.width-2*s.size<50||n.height-2*s.size<50)))){var v={bevelFilter:t.filter},m=t.filter;if(r.currSelectionPoint&&r.currSelectionPoint.shape==="crop-circle"||r.isCircleCrop||t===this.lowerContext&&r.isCropTab)this.drawImgToCtx(t,i);else{switch(e){case"none":this.drawImgToCtx(t,i);break;case"mat":for(this.drawImgToCtx(t,i);(n.width-2*s.size<0||n.height-2*s.size<0)&&s.size>0;)s.size-=20;t.filter="none",t.fillStyle=this.getFrameColor(s,t,n),t.beginPath(),t.rect(n.startX,n.startY,n.width,n.height),t.rect(n.startX+s.size,n.startY+s.size,n.width-2*s.size,n.height-2*s.size),t.fill("evenodd"),t.closePath();break;case"bevel":for(t.filter="none",t.fillStyle=this.getFrameColor(s,t,n),t.beginPath(),t.fillRect(n.startX,n.startY,n.width,n.height),t.closePath(),n.startX+=s.size,n.startY+=s.size,n.width-=2*s.size,n.height-=2*s.size;(n.width-2*s.size<40||n.height-2*s.size<40)&&s.size>0;)n.startX-=s.size,n.startY-=s.size,n.width+=2*s.size,n.height+=2*s.size,s.size-=20,n.startX+=s.size,n.startY+=s.size,n.width-=2*s.size,n.height-=2*s.size;t.fillStyle=this.getFrameColor(s,t,n),t.save(),t.beginPath(),t.moveTo(n.startX+f,n.startY),t.lineTo(n.startX+n.width-f,n.startY),t.quadraticCurveTo(n.startX+n.width,n.startY,n.startX+n.width,n.startY+f),t.lineTo(n.startX+n.width,n.startY+n.height-f),t.quadraticCurveTo(n.startX+n.width,n.startY+n.height,n.startX+n.width-f,n.startY+n.height),t.lineTo(n.startX+f,n.startY+n.height),t.quadraticCurveTo(n.startX,n.startY+n.height,n.startX,n.startY+n.height-f),t.lineTo(n.startX,n.startY+f),t.quadraticCurveTo(n.startX,n.startY,n.startX+f,n.startY),t.closePath(),t.clip(),t.filter=m==="none"?r.canvasFilter:m,t.canvas.id===r.element.id+"_tempCanvas"?(i=null,t.filter="none",t.drawImage(r.inMemoryCanvas,0,0),t.filter=m==="none"?r.canvasFilter:m):(t.clearRect(0,0,t.canvas.width,t.canvas.height),i?(i=null,r.transform.zoomFactor!==0&&(this.isRotateZoom=!0),r.notify("filter",{prop:"getBevelFilter",onPropertyChange:!1,value:{obj:v}}),t.filter=v.bevelFilter,this.updateCurrTransState("initial"),this.drawImgToCtx(t,i),this.updateCurrTransState("reverse"),this.isRotateZoom=!1,r.frameObj.type="none",t.filter="none",r.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:t,shape:"iterate",pen:"iterate",isPreventApply:null}}),r.frameObj.type="bevel",t.filter=m==="none"?r.canvasFilter:m):(r.notify("filter",{prop:"getBevelFilter",onPropertyChange:!1,value:{obj:v}}),t.filter=v.bevelFilter,this.drawImgToCtx(t,i))),t.restore();break;case"line":this.drawImgToCtx(t,i),o=t.lineWidth,t.lineWidth=s.size/10;for(var C=0;C<r.frameObj.amount;C++){C>0&&(n.startX+=s.offset,n.startY+=s.offset,n.width-=2*s.offset,n.height-=2*s.offset);var M=n.startY+n.height-s.inset-s.radius,I=n.startY+s.inset+s.radius,N=n.startX+n.width-s.inset-s.radius,O=n.startX+s.inset+s.radius,x=n.startX+s.inset+s.radius,D=n.startX+n.width-s.inset-s.radius,A=n.startY+s.inset+s.radius,P=n.startY+n.height-s.inset-s.radius;M>=I&&N>=O&&x<=D&&A<=P&&(t.filter="none",t.strokeStyle=this.getFrameColor(s,t,n),s.border==="dashed"?t.setLineDash([t.lineWidth*2.5,t.lineWidth*1.5]):s.border==="dotted"&&t.setLineDash([t.lineWidth,t.lineWidth]),t.beginPath(),t.moveTo(n.startX+s.inset+s.radius,n.startY+s.inset),t.lineTo(n.startX+n.width-s.inset-s.radius,n.startY+s.inset),t.arcTo(n.startX+n.width-s.inset,n.startY+s.inset,n.startX+n.width-s.inset,n.startY+s.inset+s.radius,s.radius),t.lineTo(n.startX+n.width-s.inset,n.startY+n.height-s.inset-s.radius),t.arcTo(n.startX+n.width-s.inset,n.startY+n.height-s.inset,n.startX+n.width-s.inset-s.radius,n.startY+n.height-s.inset,s.radius),t.lineTo(n.startX+s.inset+s.radius,n.startY+n.height-s.inset),t.arcTo(n.startX+s.inset,n.startY+n.height-s.inset,n.startX+s.inset,n.startY+n.height-s.inset-s.radius,s.radius),t.lineTo(n.startX+s.inset,n.startY+s.inset+s.radius),t.arcTo(n.startX+s.inset,n.startY+s.inset,n.startX+s.inset+s.radius,n.startY+s.inset,s.radius),t.closePath(),t.stroke(),t.setLineDash([]))}t.lineWidth=o;break;case"inset":this.drawImgToCtx(t,i),t.filter="none",t.strokeStyle=this.getFrameColor(s,t,n),o=t.lineWidth,t.lineWidth=s.size/10,t.beginPath(),t.moveTo(n.startX+s.offset,n.startY+s.inset),t.lineTo(n.startX+n.width-s.offset,n.startY+s.inset),t.moveTo(n.startX+n.width-s.inset,n.startY+s.offset),t.lineTo(n.startX+n.width-s.inset,n.startY+n.height-s.offset),t.moveTo(n.startX+n.width-s.offset,n.startY+n.height-s.inset),t.lineTo(n.startX+s.offset,n.startY+n.height-s.inset),t.moveTo(n.startX+s.inset,n.startY+n.height-s.offset),t.lineTo(n.startX+s.inset,n.startY+s.offset),t.stroke(),t.closePath(),t.lineWidth=o;break;case"hook":this.drawImgToCtx(t,i),t.filter="none",t.strokeStyle=this.getFrameColor(s,t,n),o=t.lineWidth,t.lineWidth=s.size/10,t.beginPath(),t.moveTo(n.startX+s.inset+g,n.startY+s.inset),t.lineTo(n.startX+s.inset,n.startY+s.inset),t.lineTo(n.startX+s.inset,n.startY+s.inset+g),t.moveTo(n.startX+n.width-s.inset-g,n.startY+s.inset),t.lineTo(n.startX+n.width-s.inset,n.startY+s.inset),t.lineTo(n.startX+n.width-s.inset,n.startY+s.inset+g),t.moveTo(n.startX+n.width-s.inset-g,n.startY+n.height-s.inset),t.lineTo(n.startX+n.width-s.inset,n.startY+n.height-s.inset),t.lineTo(n.startX+n.width-s.inset,n.startY+n.height-s.inset-g),t.moveTo(n.startX+s.inset+g,n.startY+n.height-s.inset),t.lineTo(n.startX+s.inset,n.startY+n.height-s.inset),t.lineTo(n.startX+s.inset,n.startY+n.height-s.inset-g),t.stroke(),t.lineWidth=o;break}(r.isCircleCrop||r.currSelectionPoint&&r.currSelectionPoint.shape==="crop-circle")&&r.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:t,isSave:t.canvas.id===r.element.id+"_tempCanvas"?!0:null,isFlip:null}}),t.filter=m}}},l.prototype.triggerFrameChange=function(t){var e=this.parent,i={type:e.toPascalCase(e.frameObj.type),color:e.frameObj.color,gradientColor:e.frameObj.gradientColor,size:e.frameObj.size,inset:e.frameObj.inset,offset:e.frameObj.offset,borderRadius:e.frameObj.radius,frameLineStyle:e.toPascalCase(e.frameObj.border),lineCount:e.frameObj.amount},r={cancel:!1,previousFrameSetting:t,currentFrameSetting:i};return e.trigger("frameChange",r),e.editCompleteArgs=r,r.cancel||this.setFrameObj(r.currentFrameSetting),r},l.prototype.setFrameObj=function(t){var e=this.parent;e.frameObj.type=t.type.toLowerCase(),e.frameObj.color=t.color,e.frameObj.gradientColor=t.gradientColor,e.frameObj.size=t.size,e.frameObj.inset=t.inset,e.frameObj.offset=t.offset,e.frameObj.radius=t.borderRadius,e.frameObj.border=t.frameLineStyle.toLowerCase(),e.frameObj.amount=t.lineCount},l.prototype.zoomToSel=function(t,e){var i=this.parent;if(this.straightenActObj&&JSON.stringify(this.straightenActObj.activePoint)===JSON.stringify(t.activePoint))if(i.activeObj=y({},this.straightenActObj,null,!0),this.allowRedactStraighten=!1,i.transform.straighten===0){var r=i.img.destWidth,o=i.img.destHeight;for(i.transform.straighten=360;;)if(!d(this.straightenInitZoom)&&Math.round(i.transform.zoomFactor*Math.pow(10,3))/Math.pow(10,3)>Math.round(this.straightenInitZoom*Math.pow(10,3))/Math.pow(10,3)){if(this.setZoomPan("out"),r===i.img.destWidth&&o===i.img.destHeight){this.performDummyZoom();break}i.transform.degree===0&&(i.transform.zoomFactor-=.025,i.transform.cropZoomFactor-=.025)}else{this.performDummyZoom();break}i.transform.straighten=0,i.img={destLeft:i.img.destLeft,destTop:i.img.destTop,destWidth:i.img.destWidth,destHeight:i.img.destHeight,srcLeft:i.img.srcLeft,srcTop:i.img.srcTop,srcWidth:i.img.srcWidth,srcHeight:i.img.srcHeight}}else d(this.straightenInitZoom)&&(this.straightenInitZoom=i.transform.zoomFactor),this.straightenInitZoom-i.transform.zoomFactor>0?i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-(this.straightenInitZoom-i.transform.zoomFactor),zoomPoint:null,isResize:!0}}):this.straightenInitZoom-i.transform.zoomFactor<0&&i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:this.straightenInitZoom-i.transform.zoomFactor,zoomPoint:null,isResize:!0}}),i.activeObj=y({},t,null,!0),i.transform.zoomFactor+=.001,this.calcStraightenedPoints(e);else this.straightenActObj=y({},t,null,!0),i.activeObj=y({},this.straightenActObj,null,!0),this.straightenInitZoom=i.transform.zoomFactor,this.calcStraightenedPoints(e)},l.prototype.isDestPointSmall=function(){var t=this.parent,e=t.img,i={startX:e.destLeft,startY:e.destTop,width:e.destWidth,height:e.destHeight};t.notify("shape",{prop:"straightenShapes",onPropertyChange:!1});var r=!1;return this.straightenDestPoints.destWidth&&this.straightenDestPoints.destHeight&&(e.destWidth<this.straightenDestPoints.destWidth||e.destHeight<this.straightenDestPoints.destHeight)&&(r=!0),e.destLeft=i.startX,e.destTop=i.startY,e.destWidth=i.width,e.destHeight=i.height,t.img=e,r},l.prototype.calcStraightenedPoints=function(t){var e=this.parent,i=e.img.destWidth,r=e.img.destHeight;d(e.transform.zoomFactor)&&(e.transform.zoomFactor+=.025),this.updateImgCanvasPoints();for(var o=function(){if(a.isLinesIntersect()||a.isSelOutsideImg()||t&&a.isDestPointSmall()){if(e.activeObj=y({},a.straightenActObj,null,!0),a.setZoomPan("in"),i===e.img.destWidth&&r===e.img.destHeight)return a.performDummyZoom(),"break";e.transform.degree===0&&(e.transform.zoomFactor+=.025,e.transform.cropZoomFactor+=.025);var s=a.imgCanvasPoints,h=e.img.destLeft,p=e.img.destTop,u=e.img.destWidth,c=e.img.destHeight;s.forEach(function(f){f.x=f.ratioX*u+h,f.y=f.ratioY*c+p}),a.imgCanvasPoints=s}else return a.performDummyZoom(),"break"},a=this;;){var n=o();if(n==="break")break}},l.prototype.performDummyZoom=function(){var t=this.parent;t.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:.025,zoomPoint:null,isResize:!0}}),t.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-.025,zoomPoint:null,isResize:!0}});var e=t.transform.zoomFactor*10;e<1&&(e=1+e/10),t.setProperties({zoomSettings:{zoomFactor:e}},!0),t.notify("transform",{prop:"setPreviousZoomValue",onPropertyChange:!1,value:{previousZoomValue:e}}),this.panToSel()},l.prototype.setZoomPan=function(t){var e=this.parent,i={maxDimension:null};e.transform.degree===0?(e.notify("transform",{prop:"cropZoom",onPropertyChange:!1,value:{value:t==="in"?.025:-.025,selectionObj:e.activeObj,obj:i}}),e.img.destWidth=i.maxDimension.width,e.img.destHeight=i.maxDimension.height):(e.transform.zoomFactor+=t==="in"?.025:-.025,e.transform.cropZoomFactor+=t==="in"?.025:-.025,this.updateCurrTransState("initial"),this.isRotateZoom=!0,this.setDestPoints(),this.isRotateZoom=!1,this.updateCurrTransState("reverse"))},l.prototype.updateImgCanvasPoints=function(){var t=this.parent,e=this.getImagePoints(),i={width:0,height:0},r=t.baseImgCanvas.width,o=t.baseImgCanvas.height;t.notify("crop",{prop:"calcRatio",onPropertyChange:!1,value:{obj:i,dimension:{width:r,height:o}}});var a=i;r=t.transform.degree%90===0&&t.transform.degree%180!==0?a.height:a.width,o=t.transform.degree%90===0&&t.transform.degree%180!==0?a.width:a.height;var n,s,h,p,u=t.img,c=u.destLeft,f=u.destTop,g=u.destWidth,v=u.destHeight;t.transform.straighten>0?(n={x:c+e[0].x/r,y:f},s={x:c+g,y:f+e[1].y/o},h={x:c+g-e[0].x/r,y:f+v},p={x:c,y:f+v-e[1].y/o}):t.transform.straighten<0?(n={x:c,y:f+e[0].y/o},s={x:c+e[1].x/r,y:f},h={x:c+g,y:f+v-e[0].y/o},p={x:c+g-e[1].x/r,y:f+v}):t.transform.straighten===0&&(n={x:c,y:f},s={x:c+g,y:f},h={x:c+g,y:f+v},p={x:c,y:f+v}),n.ratioX=(n.x-c)/g,n.ratioY=(n.y-f)/v,s.ratioX=(s.x-c)/g,s.ratioY=(s.y-f)/v,h.ratioX=(h.x-c)/g,h.ratioY=(h.y-f)/v,p.ratioX=(p.x-c)/g,p.ratioY=(p.y-f)/v,this.imgCanvasPoints=[n,s,h,p]},l.prototype.isLinesIntersect=function(t){var e=this.parent,i=e.activeObj.activePoint;if(e.activeObj.rotatedAngle!==0){var r=e.activeObj.activePoint,o=r.startX,a=r.startY,n=r.endX,s=r.endY,h=r.width,p=r.height,u={x:o+h/2,y:a+p/2},c=Math.cos(e.activeObj.rotatedAngle),f=Math.sin(e.activeObj.rotatedAngle),g={x:c*(o-u.x)-f*(a-u.y)+u.x,y:f*(o-u.x)+c*(a-u.y)+u.y},v={x:c*(n-u.x)-f*(a-u.y)+u.x,y:f*(n-u.x)+c*(a-u.y)+u.y},m={x:c*(o-u.x)-f*(s-u.y)+u.x,y:f*(o-u.x)+c*(s-u.y)+u.y},C={x:c*(n-u.x)-f*(s-u.y)+u.x,y:f*(n-u.x)+c*(s-u.y)+u.y},M=this.imgCanvasPoints,I=this.doIntersect(g,v,M[0],M[1]),N=this.doIntersect(v,C,M[1],M[2]),O=this.doIntersect(m,C,M[2],M[3]),x=this.doIntersect(g,m,M[3],M[0]);return t&&(t.arr=[I,N,O,x]),I||N||O||x}var D=this.imgCanvasPoints,A=this.doIntersect({x:i.startX,y:i.startY},{x:i.endX,y:i.startY},D[0],D[1]),P=this.doIntersect({x:i.endX,y:i.startY},{x:i.endX,y:i.endY},D[1],D[2]),V=this.doIntersect({x:i.startX,y:i.endY},{x:i.endX,y:i.endY},D[2],D[3]),q=this.doIntersect({x:i.startX,y:i.startY},{x:i.startX,y:i.endY},D[3],D[0]),re=this.isInsideRect(D[0]),ae=this.isInsideRect(D[1]),E=this.isInsideRect(D[2]),L=this.isInsideRect(D[3]);return t&&(t.arr=[A,P,V,q]),A||P||V||q||re||ae||E||L||D[0].x>i.startX&&D[1].x<i.endX&&D[2].x<i.endX&&D[3].x>i.startX&&D[0].y<i.startY&&D[1].y<i.startY&&D[2].y>i.endY&&D[3].y>i.endY||D[0].x<i.startX&&D[1].x>i.endX&&D[2].x>i.endX&&D[3].x<i.startX&&D[0].y>i.startY&&D[1].y>i.startY&&D[2].y<i.endY&&D[3].y<i.endY},l.prototype.isSelOutsideImg=function(){var t=this.parent,e=this.imgCanvasPoints,i=t.activeObj.activePoint;return this.checkPointPosition(i.startX,i.startY,e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y)!=="inside"||this.checkPointPosition(i.endX,i.startY,e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y)!=="inside"||this.checkPointPosition(i.startX,i.endY,e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y)!=="inside"||this.checkPointPosition(i.endX,i.endY,e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y)!=="inside"},l.prototype.calcTriangleArea=function(t,e,i,r,o,a){return Math.abs((t*(r-a)+i*(a-e)+o*(e-r))/2)},l.prototype.checkPointPosition=function(t,e,i,r,o,a,n,s,h,p){var u=this.calcTriangleArea(t,e,i,r,h,p),c=this.calcTriangleArea(t,e,h,p,n,s),f=this.calcTriangleArea(t,e,n,s,o,a),g=this.calcTriangleArea(t,e,o,a,i,r),v=this.calcTriangleArea(i,r,o,a,n,s)+this.calcTriangleArea(n,s,h,p,i,r);return u+c+f+g>v?"outside":u+c+f+g===v&&(u===0||c===0||f===0||g===0)?"on":"inside"},l.prototype.getImagePoints=function(){var t=[],e=this.parent,i=e.transform.degree,r=e.baseImg.width,o=e.baseImg.height,a={dim:null,width:o,height:r,angle:e.transform.straighten};a.dim=e.getRotatedCanvasDim(a.width,a.height,a.angle);var n=i%90===0&&i%180!==0?a.dim.width:e.baseImgCanvas.width,s=i%90===0&&i%180!==0?a.dim.height:e.baseImgCanvas.height,h=i%90===0&&i%180!==0?o:r,p=i%90===0&&i%180!==0?r:o,u=n/2,c=s/2,f=u-h/2,g=c-p/2,v=u+h/2,m=c+p/2,C={x:u,y:c},M=e.transform.straighten*(Math.PI/180),I={x:Math.cos(M)*(f-C.x)-Math.sin(M)*(g-C.y)+C.x,y:Math.sin(M)*(f-C.x)+Math.cos(M)*(g-C.y)+C.y},N={x:Math.cos(M)*(v-C.x)-Math.sin(M)*(g-C.y)+C.x,y:Math.sin(M)*(v-C.x)+Math.cos(M)*(g-C.y)+C.y},O={x:Math.cos(M)*(v-C.x)-Math.sin(M)*(m-C.y)+C.x,y:Math.sin(M)*(v-C.x)+Math.cos(M)*(m-C.y)+C.y},x={x:Math.cos(M)*(f-C.x)-Math.sin(M)*(m-C.y)+C.x,y:Math.sin(M)*(f-C.x)+Math.cos(M)*(m-C.y)+C.y};return t.push(I),t.push(N),t.push(O),t.push(x),t},l.prototype.doIntersect=function(t,e,i,r){var o=this.initiation(t,e,i),a=this.initiation(t,e,r),n=this.initiation(i,r,t),s=this.initiation(i,r,e);return!!(o!==a&&n!==s||o===0&&this.onSegment(t,i,e)||a===0&&this.onSegment(t,r,e)||n===0&&this.onSegment(i,t,r)||s===0&&this.onSegment(i,e,r))},l.prototype.initiation=function(t,e,i){var r=(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y);return r===0?0:r>0?1:2},l.prototype.onSegment=function(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)},l.prototype.isInsideRect=function(t){var e=this.parent,i=e.activeObj.activePoint,r=!1;return t.x>=i.startX&&t.x<=i.endX&&t.y>=i.startY&&t.y<=i.endY&&(r=!0),r},l.prototype.setDestForStraighten=function(){var t=this.parent;if(d(this.straightenDestPoints)){var e=t.img,i=e.destLeft,r=e.destTop,o=e.destWidth,a=e.destHeight;t.notify("shape",{prop:"straightenShapes",onPropertyChange:!1}),this.straightenDestPoints=y({},t.img,{},!0),t.img.destLeft=i,t.img.destTop=r,t.img.destWidth=o,t.img.destHeight=a}},l.prototype.drawRedact=function(t,e){var i=e.activePoint,r=i.startX,o=i.startY,a=i.endX,n=i.endY,s=e.activePoint,h=s.width,p=s.height,u=!1,c=t.canvas;c.id.indexOf("_tempCanvas")!==-1&&(u=!0);var f=this.parent.img;if(!(h<=0||p<=0))if(this.parent.isCropTab)t.drawImage(e.redactImage,0,0,e.redactImage.width,e.redactImage.height,r,o,h,p);else{var g=document.createElement("canvas"),v=g.getContext("2d"),m=c.width,C=c.height,M=Math.min(m,C)/1e3,I=Math.round(this.parent.activeObj.rotatedAngle*(180/Math.PI));if(this.allowRedactStraighten&&I!==0){var N=document.createElement("canvas"),O=N.getContext("2d");u?(N.width=c.width,N.height=c.height,O.drawImage(c,0,0)):(N.width=f.destWidth>c.width?c.width:f.destWidth,N.height=f.destHeight>c.height?c.height:f.destHeight,O.drawImage(this.lowerContext.canvas,f.destLeft>0?f.destLeft:0,f.destTop>0?f.destTop:0,N.width,N.height,0,0,N.width,N.height));var x=-I*Math.PI/180,D=document.createElement("canvas"),A=D.getContext("2d");D.width=N.width,D.height=N.height,f.destWidth>c.width&&!u&&(D.width=c.width),f.destHeight>c.height&&!u&&(D.height=c.height),A.save(),A.translate(N.width/2,N.height/2),A.rotate(x),A.drawImage(N,-N.width/2,-N.height/2),A.restore(),f.destLeft>0&&!u&&(r-=f.destLeft,a-=f.destLeft),f.destTop>0&&!u&&(o-=f.destTop,n-=f.destTop);var P={x:r+h/2,y:o+p/2},V=Math.cos(I*Math.PI/180),q=Math.sin(I*Math.PI/180),re={x:V*(r-P.x)-q*(o-P.y)+P.x,y:q*(r-P.x)+V*(o-P.y)+P.y},ae={x:V*(a-P.x)-q*(o-P.y)+P.x,y:q*(a-P.x)+V*(o-P.y)+P.y},E={x:V*(r-P.x)-q*(n-P.y)+P.x,y:q*(r-P.x)+V*(n-P.y)+P.y};u?P={x:c.width/2,y:c.height/2}:(P={x:f.destWidth/2,y:f.destHeight/2},f.destWidth>c.width&&(P.x=c.width/2),f.destHeight>c.height&&(P.y=c.height/2)),V=Math.cos(x),q=Math.sin(x);var L={x:V*(re.x-P.x)-q*(re.y-P.y)+P.x,y:q*(re.x-P.x)+V*(re.y-P.y)+P.y},k={x:V*(ae.x-P.x)-q*(ae.y-P.y)+P.x,y:q*(ae.x-P.x)+V*(ae.y-P.y)+P.y},U={x:V*(E.x-P.x)-q*(E.y-P.y)+P.x,y:q*(E.x-P.x)+V*(E.y-P.y)+P.y},B=u?t.canvas.width:f.destWidth>c.width?c.width:f.destWidth,R=u?t.canvas.height:f.destHeight>c.height?c.height:f.destHeight,$=Math.abs(B*Math.cos(x))+Math.abs(R*Math.sin(x)),oe=Math.abs(B*Math.sin(x))+Math.abs(R*Math.cos(x)),he=D.width,pe=D.height;if(D.width=$,D.height=oe,A.save(),A.translate($/2,oe/2),A.rotate(x),A.drawImage(N,-N.width/2,-N.height/2),A.restore(),this.parent.activeObj.redactType==="blur"){g.width=h,g.height=p;var Te=L.x+($-he)/2,Pe=L.y+(oe-pe)/2;this.isRedactStraighten&&(Te=r+($-he)/2,Pe=o+(oe-pe)/2),v.drawImage(D,Te,Pe,k.x-L.x,U.y-k.y,0,0,h,p)}else{var Ue=e.redactPixelate/100*20;u&&(Ue=M*(e.redactPixelate/100)*35),g.width=Math.ceil(h/Ue),g.height=Math.ceil(p/Ue);var Te=L.x+($-he)/2,Pe=L.y+(oe-pe)/2;this.isRedactStraighten&&(Te=r+($-he)/2,Pe=o+(oe-pe)/2),v.drawImage(D,Te,Pe,k.x-L.x,U.y-k.y,0,0,g.width,g.height)}}if(this.parent.activeObj.redactType==="blur"){if(I===0&&(g.width=h,g.height=p,v.drawImage(u?c:this.lowerContext.canvas,r,o,h,p,0,0,h,p)),u){var Se=M*(e.redactBlur/100*34);v.filter="blur("+Se+"px)"}else v.filter="blur("+e.redactBlur/100*17+"px)";v.drawImage(g,0,0),I===0?v.drawImage(u?c:this.lowerContext.canvas,r,o,h,p,0,0,h,p):(f.destLeft>0&&!u&&(r+=f.destLeft,a+=f.destLeft),f.destTop>0&&!u&&(o+=f.destTop,n+=f.destTop)),this.parent.isSafari&&this.parent.notify("filter",{prop:"apply-filter",onPropertyChange:!1,value:{context:v}}),t.drawImage(g,0,0,h,p,r,o,h,p)}else{var Ue=e.redactPixelate/100*20;u&&(Ue=M*(e.redactPixelate/100)*35),I===0?(g.width=Math.ceil(h/Ue),g.height=Math.ceil(p/Ue),v.drawImage(u?c:this.lowerContext.canvas,r,o,h,p,0,0,g.width,g.height)):(f.destLeft>0&&!u&&(r+=f.destLeft,a+=f.destLeft),f.destTop>0&&!u&&(o+=f.destTop,n+=f.destTop)),t.imageSmoothingEnabled=!1,t.drawImage(g,0,0,g.width,g.height,r,o,h,p)}e.redactImage=this.parent.createElement("canvas"),e.redactImage.width=g.width,e.redactImage.height=g.height,e.redactImage.getContext("2d").drawImage(g,0,0),t.beginPath(),t.rect(r,o,h,p),t.rect(r,o,h,p),t.fill("evenodd"),t.closePath()}},l}(),pv=function(){function l(t){this.parent=t,this.addEventListener()}return l.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},l.prototype.addEventListener=function(){this.parent.on("export",this.export,this),this.parent.on("destroyed",this.destroy,this)},l.prototype.removeEventListener=function(){this.parent.off("export",this.export),this.parent.off("destroyed",this.destroy)},l.prototype.export=function(t){switch(this.parent.notify("toolbar",{prop:"refreshShapeDrawing",onPropertyChange:!1}),this.updatePvtVar(),t.prop){case"export":this.exportImg(t.value.type,t.value.fileName,t.value.imgQuality);break;case"exportToCanvas":this.exportToCanvas(t.value.object);break;case"updateSaveContext":this.updateSaveContext(t.value.context);break;case"setImageQuality":this.imageQuality=t.value.value;break;case"drawAnnotation":this.drawAnnotation(t.value.context,t.value.ratio);break}},l.prototype.getModuleName=function(){return"export"},l.prototype.updatePvtVar=function(){var t=this.parent;t.lowerCanvas&&(this.lowerContext=t.lowerCanvas.getContext("2d"))},l.prototype.exportImg=function(t,e,i){var r=this.parent,o={fileName:""};r.notify("draw",{prop:"getFileName",onPropertyChange:!1,value:{obj:o}});var a=o.fileName;if(!r.disabled&&r.isImageLoaded){r.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:null}});var n={canvasFilter:this.parent.canvasFilter};this.lowerContext.filter=n.canvasFilter,t=t||"Png",r.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:null}});var s={cancel:!1,fileName:e||a,fileType:t,imageQuality:i};r.trigger("beforeSave",s),this.beforeSaveEvent(s,t,e,a,i)}},l.prototype.beforeSaveEvent=function(t,e,i,r,o){var a=this.parent;if(!t.cancel){a.currObjType.isSave=!0,i=t.fileName?t.fileName:i;var n=e.toLowerCase();i=i||r,n==="svg"?this.toSVGImg(i):this.toBlobFn(i,n,o);var s={fileName:i||r,fileType:e};a.trigger("saved",s);var h={action:"save",actionEventArgs:s};a.triggerEditCompleteEvent(h),a.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1}),a.lowerCanvas.style.left=a.upperCanvas.style.left="",a.lowerCanvas.style.top=a.upperCanvas.style.top="",a.lowerCanvas.style.maxWidth=a.upperCanvas.style.maxWidth="",a.lowerCanvas.style.maxHeight=a.upperCanvas.style.maxHeight=""}},l.prototype.toSVGImg=function(t){var e=this.parent;Bt(e.element),e.element.style.opacity="0.5";var i=this.exportToCanvas(),r=i.toDataURL();gt(e.element),e.element.style.opacity="1";var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("width",i.style.maxWidth),o.setAttribute("height",i.style.maxHeight);var a="http://www.w3.org/1999/xlink",n=document.createElementNS("http://www.w3.org/2000/svg","image");n.setAttributeNS(null,"height",i.height.toString()),n.setAttributeNS(null,"width",i.width.toString()),n.setAttributeNS(a,"xlink:href",r),o.appendChild(n);var s="data:image/svg+xml;base64,",h='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' width="'+i.width+'"')+(' height="'+i.height+'"')+">",p="</svg>",u=o.innerHTML,c=h+u+p,f=s+btoa(c);return t===null?f:(this.downloadImg(f,t+".svg"),null)},l.prototype.toBlobFn=function(t,e,i){var r=this,o=this.parent;Bt(o.element),o.element.style.opacity="0.5",d(i)||(i=i>1?1:i<=0?.01:i,this.imageQuality=i||null);var a=this.exportToCanvas(),n=e==="jpeg"?"image/jpeg":e==="webp"?"image/webp":"image/png";a.toBlob(function(s){var h=URL.createObjectURL(s);r.downloadImg(h,t+"."+e),gt(o.element),o.element.style.opacity="1"},n,this.imageQuality?this.imageQuality:null)},l.prototype.exportToCanvas=function(t){var e=this.parent,i,r,o=y({},e.cropObj,{},!0),a={currObj:{}};e.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:a}});var n=a.currObj;n.objColl=y([],e.objColl,[],!0),n.pointColl=y([],e.pointColl,[],!0),n.afterCropActions=y([],e.afterCropActions,[],!0);var s={selPointColl:null};e.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:s}}),this.parent.aspectWidth?(e.notify("undo-redo",{prop:"setPreventUR",value:{bool:!0}}),e.notify("toolbar",{prop:"resizeClick",value:{bool:!1}}),e.okBtn(),e.transform.degree%90===0&&e.transform.degree%180!==0?(i=this.parent.aspectHeight,r=this.parent.aspectWidth):(i=this.parent.aspectWidth,r=this.parent.aspectHeight),e.notify("undo-redo",{prop:"setPreventUR",value:{bool:!1}})):e.currSelectionPoint?(i=e.img.srcWidth,r=e.img.srcHeight):(i=e.baseImgCanvas.width,r=e.baseImgCanvas.height);var h={width:0,height:0};e.notify("crop",{prop:"calcRatio",onPropertyChange:!1,value:{obj:h,dimension:{width:i,height:r}}});var p=h,u=this.lowerContext.filter;if(this.lowerContext.filter!=="none"){var c=this.lowerContext.filter.split(" "),f=parseFloat(c[5].split("(")[1]);f*=(p.width+p.height)/2,c[5]="blur("+f+"px)",this.lowerContext.filter=c.join(" ")}var g=e.createElement("canvas",{id:e.element.id+"_tempCanvas",attrs:{name:"canvasImage"}}),v=g.getContext("2d");g.width=i,g.height=r;var m={width:0,height:0};e.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:i,height:r,obj:m}});var C=m;g.style.maxWidth=C.width+"px",g.style.maxHeight=C.height+"px";var M=this.lowerContext.filter;return v.filter=this.lowerContext.filter,this.downScaleImgCanvas(v,i,r),this.lowerContext.filter=M,(e.transform.degree!==0||e.transform.currFlipState!==""||e.transform.straighten!==0)&&(this.updateSaveContext(v),this.exportTransformedImage(v)),e.isSafari&&e.notify("filter",{prop:"apply-filter",onPropertyChange:!1,value:{context:v}}),this.drawAnnotation(v,p),e.isCircleCrop&&e.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:v,isSave:!0,isFlip:null}}),this.updateFrame(v,!0),this.lowerContext.filter=u,e.canvasFilter=u,t&&(t.canvas=g),e.aspectWidth&&(e.objColl=[],e.pointColl=[],e.freehandCounter=0,e.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:[]}}}),e.notify("draw",{prop:"setCurrentObj",onPropertyChange:!1,value:{obj:n}}),n.selPointColl=y([],s.selPointColl,[],!0),e.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:n.selPointColl}}}),e.cropObj=o,e.objColl=y([],n.objColl,[],!0),e.pointColl=y([],n.pointColl,[],!0),e.freehandCounter=e.pointColl.length,e.transform.straighten=0,this.lowerContext.filter="none",e.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),this.lowerContext.filter=n.filter,e.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),(e.isCircleCrop||e.currSelectionPoint&&e.currSelectionPoint.shape==="crop-circle")&&e.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}})),g},l.prototype.drawAnnotation=function(t,e){var i=this.parent,r=y([],i.objColl,[],!0),o=y([],i.pointColl,[],!0),a=i.shapeColl.filter(function(h){return h.shape!=="redact"}),n=i.shapeColl.filter(function(h){return h.shape==="redact"});i.shapeColl=n.concat(a);for(var s=0;s<i.shapeColl.length;s++)i.shapeColl[s].order&&(i.shapeColl[s].currIndex&&i.shapeColl[s].currIndex.indexOf("shape")>-1?(i.objColl=[],i.objColl.push(y({},i.shapeColl[s],{},!0)),this.drawShape(t,e)):i.shapeColl[s].id&&i.shapeColl[s].id.indexOf("pen")>-1&&(i.pointColl=[],i.freehandCounter=0,i.pointColl.push(y({},i.shapeColl[s],{},!0)),i.freehandCounter=i.pointColl.length,this.drawPen(t,e)));i.objColl=r,i.pointColl=o,i.freehandCounter=i.pointColl.length},l.prototype.drawShape=function(t,e){var i=this.parent;if(i.objColl.length>0){var r=t.filter;t.filter="none";var o={index:null};i.notify("shape",{prop:"getSmallestIndex",onPropertyChange:!1,value:{obj:o}});for(var a=o.index,n=y([],i.objColl,[],!0),s=y([],i.objColl,[],!0);n.length>0;){for(var h=!1,p=0;p<n.length;p++){var u=n[p];if(d(u.order)){n.splice(p,1),p--;continue}if(u.order===a){var c=t.filter;t.filter="none";var f=n[p],g=f.activePoint;if(g.startX-=i.img.destLeft,g.startY-=i.img.destTop,g.endX-=i.img.destLeft,g.endY-=i.img.destTop,g.width=g.endX-g.startX,g.height=g.endY-g.startY,g.startX*=e.width,g.startY*=e.height,g.endX*=e.width,g.endY*=e.height,g.width=g.endX-g.startX,g.height=g.endY-g.startY,f.strokeSettings.strokeWidth*=(e.width+e.height)/2,f.shape==="text")f.textSettings.fontSize*=(e.width+e.height)/2;else if(f.shape==="path")for(var v=0;v<f.pointColl.length;v++)f.pointColl[v].x=(f.pointColl[v].x-i.img.destLeft)*e.width,f.pointColl[v].y=(f.pointColl[v].y-i.img.destTop)*e.height;else f.shape==="image"&&(i.activeObj=y({},n[p],{},!0),i.notify("selection",{prop:"upgradeImageQuality",onPropertyChange:!1}),n[p]=y({},i.activeObj,{},!0));i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"saveContext",obj:n[p],isCropRatio:null,points:null,isPreventDrag:!0,saveContext:t,isPreventSelection:null}}),t.filter=c,i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),a++;var m={bool:!1};i.notify("shape",{prop:"isIndexInObjColl",onPropertyChange:!1,value:{obj:m,index:a}}),m.bool||a++,n.splice(p,1),h=!0;break}}if(!h)break}t.filter=r,i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),i.objColl=s}},l.prototype.drawPen=function(t,e){var i=this.parent;if(i.freehandCounter>0){var r={penStrokeWidth:null};i.notify("freehand-draw",{prop:"getPenStrokeWidth",onPropertyChange:!1,value:{obj:r}});for(var o=y({},i.pointColl,{},!0),a=0;a<i.freehandCounter;a++){i.points=y([],i.pointColl[a].points,[]),i.notify("freehand-draw",{prop:"setPointCounter",onPropertyChange:!1,value:{value:0}});var n=i.points.length;i.pointColl[a].strokeWidth*=(e.width+e.height)/2;for(var s=0;s<n;s++)i.points[s].x=(i.points[s].x-i.img.destLeft)*e.width,i.points[s].y=(i.points[s].y-i.img.destTop)*e.height}i.notify("freehand-draw",{prop:"freehandRedraw",onPropertyChange:!1,value:{context:t,points:null}}),i.pointColl=o,i.notify("freehand-draw",{prop:"setPenStrokeWidth",onPropertyChange:!1,value:{value:r.penStrokeWidth}})}},l.prototype.downScaleImgCanvas=function(t,e,i){var r=this.parent,o=r.baseImgCanvas,a=r.baseImg,n={width:0,height:0};r.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:a.width,height:a.height,obj:n,isImgShape:null}});var s={color:null};if(r.notify("draw",{prop:"getImageBackgroundColor",value:{obj:s}}),s.color!==""&&(t.fillStyle=s.color,t.fillRect(0,0,t.canvas.width,t.canvas.height)),n.width>e&&n.height>i){var h=r.createElement("canvas",{id:r.element.id+"_downScaleCanvas",attrs:{name:"canvasImage"}});h.width=this.parent.img.srcWidth,h.height=this.parent.img.srcHeight,h.getContext("2d").drawImage(o,r.img.srcLeft,r.img.srcTop,r.img.srcWidth,r.img.srcHeight,0,0,h.width,h.height),r.notify("draw",{prop:"downScale",value:{canvas:h,width:e,height:i}}),t.drawImage(h,0,0)}else t.drawImage(r.baseImgCanvas,r.img.srcLeft,r.img.srcTop,r.img.srcWidth,r.img.srcHeight,0,0,e,i)},l.prototype.updateFrame=function(t,e){if(this.parent.frameObj.type!=="none"){var i=t.filter;t.filter="none",this.parent.notify("draw",{prop:"applyFrame",value:{ctx:t,frame:this.parent.frameObj.type,preventImg:e}}),t.filter=i}},l.prototype.downloadImg=function(t,e){var i=document.createElement("a");i.href=t,i.target="_parent",i.download=e,(document.body||document.documentElement).appendChild(i),i.click(),i.parentNode.removeChild(i)},l.prototype.exportTransformedImage=function(t){var e=this.parent,i=e.transform.degree;if(e.rotateFlipColl.length>0)for(var r=0,o=e.rotateFlipColl.length;r<o;r++){var a=e.rotateFlipColl[r];typeof a=="number"?this.exportRotate(t,a):a==="horizontal"?this.exportFlip(t,!0,!1):a==="vertical"&&this.exportFlip(t,!1,!0)}e.transform.degree=i},l.prototype.exportRotate=function(t,e){var i=this.parent;t.clearRect(0,0,t.canvas.width,t.canvas.height),this.setMaxDim(i.transform.degree,t.canvas),t.translate(t.canvas.width/2,t.canvas.height/2),t.rotate(Math.PI/180*e),t.drawImage(i.inMemoryCanvas,-t.canvas.height/2,-t.canvas.width/2,t.canvas.height,t.canvas.width),this.updateSaveContext(t)},l.prototype.exportFlip=function(t,e,i){t.clearRect(0,0,t.canvas.width,t.canvas.height),e&&(t.translate(t.canvas.width,0),t.scale(-1,1)),i&&(t.translate(0,t.canvas.height),t.scale(1,-1)),t.drawImage(this.parent.inMemoryCanvas,0,0),this.updateSaveContext(t)},l.prototype.updateSaveContext=function(t){var e=this.parent.inMemoryCanvas.getContext("2d");t.setTransform(1,0,0,1,0,0);var i=t.getImageData(0,0,t.canvas.width,t.canvas.height);this.parent.inMemoryCanvas.width=i.width,this.parent.inMemoryCanvas.height=i.height,e.putImageData(i,0,0)},l.prototype.setMaxDim=function(t,e){var i,r;t%90===0&&t%180!==0?d(this.parent.currSelectionPoint)?(i=this.parent.baseImgCanvas.height,r=this.parent.baseImgCanvas.width):(i=this.parent.img.srcHeight,r=this.parent.img.srcWidth):(t%180===0||t===0)&&(d(this.parent.currSelectionPoint)?(i=this.parent.baseImgCanvas.width,r=this.parent.baseImgCanvas.height):(i=this.parent.img.srcWidth,r=this.parent.img.srcHeight)),d(this.parent.aspectWidth)||(i=this.parent.aspectWidth,r=this.parent.aspectHeight),e.width=i,e.height=r;var o={width:0,height:0};this.parent.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:i,height:r,obj:o,isImgShape:null}});var a=o;e.style.maxWidth=a.width+"px",e.style.maxHeight=a.height+"px"},l}(),uv=function(){function l(t){this.adjustmentLevel={brightness:0,contrast:0,hue:0,opacity:100,saturation:0,blur:0,exposure:0,transparency:100,sharpen:!1,bw:!1},this.tempAdjustmentLevel={brightness:0,contrast:0,hue:0,opacity:100,saturation:0,blur:0,exposure:0,transparency:100,sharpen:!1,bw:!1},this.adjustmentValue="",this.isBrightnessAdjusted=!1,this.bevelFilter="none",this.tempAdjVal={brightness:0,contrast:0,hue:0,opacity:100,saturation:0,blur:0,exposure:0,transparency:100,sharpen:!1,bw:!1},this.tempFilVal="",this.parent=t,this.addEventListener()}return l.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},l.prototype.addEventListener=function(){this.parent.on("filter",this.filter,this),this.parent.on("destroyed",this.destroy,this)},l.prototype.removeEventListener=function(){this.parent.off("filter",this.filter),this.parent.off("destroyed",this.destroy)},l.prototype.filter=function(t){switch(this.updatePrivateVariables(),t.prop){case"finetuneImage":this.finetuneImage(t.value.option,t.value.value);break;case"applyImageFilter":this.setFilter(t.value.option);break;case"update-finetunes":this.updateFinetunes();break;case"set-adjustment":this.setAdjustment(t.value.operation);break;case"initFilter":this.initFilter();break;case"setCurrAdjValue":this.setCurrAdjValue(t.value.type,t.value.value);break;case"updateAdj":this.updateAdj(t.value.type,t.value.value,t.value.isPreview,t.value.ctx);break;case"getCurrentObj":this.getCurrentObj(t.value.object);break;case"getAdjustmentLevel":d(this.parent.activeObj.opacity)?this.adjustmentLevel.transparency=100:this.adjustmentLevel.transparency=this.parent.activeObj.opacity*100,t.value.obj.adjustmentLevel=this.adjustmentLevel;break;case"setAdjustmentLevel":this.adjustmentLevel=t.value.adjustmentLevel;break;case"getTempAdjustmentLevel":t.value.obj.tempAdjustmentLevel=this.tempAdjustmentLevel;break;case"setTempAdjustmentLevel":this.tempAdjustmentLevel=t.value.tempAdjustmentLevel;break;case"setAdjustmentValue":this.adjustmentValue=t.value.adjustmentValue;break;case"setBrightnessAdjusted":this.isBrightnessAdjusted=t.value.isBrightnessAdjusted,this.parent.currentFilter.split("_")&&this.parent.currentFilter.split("_")[1]==="cold"&&(this.isBrightnessAdjusted=!1);break;case"getBevelFilter":t.value.obj.bevelFilter=this.bevelFilter;break;case"setBevelFilter":this.bevelFilter=t.value.bevelFilter;break;case"setTempAdjVal":this.tempAdjVal=y({},this.adjustmentLevel,{},!0);break;case"setTempFilVal":this.tempFilVal=this.parent.currentFilter;break;case"reset":this.reset();break;case"apply-filter":this.applyFilter(t.value.context);break}},l.prototype.updatePrivateVariables=function(){var t=this.parent;t.lowerCanvas&&(this.lowerContext=t.lowerCanvas.getContext("2d"))},l.prototype.getModuleName=function(){return"filter"},l.prototype.reset=function(){this.adjustmentLevel={brightness:0,contrast:0,hue:0,opacity:100,saturation:0,blur:0,exposure:0,transparency:100,sharpen:!1,bw:!1},this.tempAdjustmentLevel={brightness:0,contrast:0,hue:0,opacity:100,saturation:0,blur:0,exposure:0,transparency:100,sharpen:!1,bw:!1},this.adjustmentValue=this.parent.getDefaultFilter(),this.isBrightnessAdjusted=!1,this.bevelFilter="none",this.tempFilVal="",this.tempAdjVal={brightness:0,contrast:0,hue:0,opacity:100,saturation:0,blur:0,exposure:0,transparency:100,sharpen:!1,bw:!1}},l.prototype.updateFinetunes=function(){var t=this,e=this.parent,i=e.finetuneSettings;if(i){var r=["brightness","contrast","hue","saturation","exposure","opacity","blur"];r.forEach(function(o){i[o]&&(t.adjustmentLevel[o]=i[o].defaultValue,t.tempAdjustmentLevel[o]=i[o].defaultValue)}),e.notify("draw",{prop:"isInitialLoading",onPropertyChange:!1,value:{isInitialLoading:!0}})}},l.prototype.initFilter=function(){this.setFilterAdj("brightness",this.adjustmentLevel.brightness),this.setFilterAdj("contrast",this.adjustmentLevel.contrast),this.setFilterAdj("hue",this.adjustmentLevel.hue),this.setFilterAdj("saturation",this.adjustmentLevel.saturation),this.setFilterAdj("exposure",this.adjustmentLevel.exposure),this.setFilterAdj("opacity",this.adjustmentLevel.opacity),this.setFilterAdj("blur",this.adjustmentLevel.blur)},l.prototype.updateAdj=function(t,e,i,r){var o=this.parent;this.lowerContext.clearRect(0,0,o.lowerCanvas.width,o.lowerCanvas.height);var a=this.lowerContext.filter.split(" "),n=[],s=this.getFilterValue(this.adjustmentLevel.brightness),h,p,u,c,f;switch(t){case"brightness":e=this.getFilterValue(this.adjustmentLevel.exposure)+e*.005,a[0]="brightness("+e+")",this.adjustmentLevel.brightness!==0?(e=this.adjustmentLevel.opacity/100-this.adjustmentLevel.opacity*.3/100,a[4]="opacity("+e+")"):(e=this.adjustmentLevel.opacity/100,a[4]="opacity("+e+")"),this.adjustmentValue=a.join(" ");break;case"contrast":a[1]="contrast("+e+"%)",this.adjustmentValue=a.join(" ");break;case"hue":a[2]="hue-rotate("+e+"deg)",this.adjustmentValue=a.join(" ");break;case"saturation":a[3]="saturate("+e+"%)",this.adjustmentValue=a.join(" ");break;case"opacity":parseFloat(a[0].split("(")[1])!==1&&(e-=.2),e<0&&(e=0),a[4]="opacity("+e+")",this.adjustmentValue=a.join(" ");break;case"blur":a[5]="blur("+e+"px)",this.adjustmentValue=a.join(" ");break;case"exposure":e>1?(e-=1,e+=s):e<1&&(e=1-e,e=s-e),a[0]="brightness("+e+")",this.adjustmentValue=a.join(" ");break;case"chrome":h=this.getSaturationFilterValue(this.adjustmentLevel.saturation),h*=100,e=h+h*.4,a[3]="saturate("+e+"%)",n=this.adjustmentValue.split(" "),a[0]=n[0],a[1]=n[1],a[2]=n[2],a[4]=n[4],a[5]=n[5],a[6]="sepia(0%)",a[7]="grayscale(0%)",a[8]="invert(0%)";break;case"cold":p=this.getFilterValue(this.adjustmentLevel.brightness),p*=100,e=p*.9,e*=.01,a[0]="brightness("+e+")",c=this.getFilterValue(this.adjustmentLevel.contrast),c*=100,e=c+c*.5,a[1]="contrast("+e+"%)",f=this.getSaturationFilterValue(this.adjustmentLevel.saturation),f*=100,e=f,a[3]="saturate("+e+"%)",n=this.adjustmentValue.split(" "),a[2]=n[2],a[4]=n[4],a[5]=n[5],a[6]="sepia(0%)",a[7]="grayscale(0%)",a[8]="invert(0%)";break;case"warm":u=this.getSaturationFilterValue(this.adjustmentLevel.saturation),u*=100,e=u+u*.4,a[3]="saturate("+e+"%)",a[6]="sepia(25%)",n=this.adjustmentValue.split(" "),a[0]=n[0],a[1]=n[1],a[2]=n[2],a[4]=n[4],a[5]=n[5],a[7]="grayscale(0%)",a[8]="invert(0%)";break;case"grayscale":a[7]="grayscale(100%)",n=this.adjustmentValue.split(" "),a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]="sepia(0%)",a[8]="invert(0%)";break;case"sepia":a[6]="sepia(100%)",n=this.adjustmentValue.split(" "),a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[7]="grayscale(0%)",a[8]="invert(0%)";break;case"invert":a[8]="invert(100%)",n=this.adjustmentValue.split(" "),a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]="sepia(0%)",a[7]="grayscale(0%)";break}if(t!=="sharpen"&&t!=="blackandwhite"){d(i)&&(t==="default"&&(a=this.getDefaultCurrentFilter(a)),this.lowerContext.filter=a.join(" ")),a=this.setTempFilterValue(s,i,a,t),o.notify("draw",{prop:"setRotateZoom",onPropertyChange:!1,value:{isRotateZoom:!0}}),o.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"initial",isPreventDestination:null,isRotatePan:null}});var g=void 0;o.frameObj.type==="bevel"&&(g=this.lowerContext.filter,this.bevelFilter=g),o.transform.degree===0&&o.rotateFlipColl.length>0&&(o.img.destLeft+=o.panPoint.totalPannedPoint.x,o.img.destTop+=o.panPoint.totalPannedPoint.y),o.img.destLeft+=o.panPoint.totalPannedInternalPoint.x,o.img.destTop+=o.panPoint.totalPannedInternalPoint.y,o.transform.degree===0&&o.notify("transform",{prop:"setDestPointsForFlipState",onPropertyChange:!1}),o.notify("draw",{prop:"drawImage",onPropertyChange:!1}),o.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"reverse",isPreventDestination:null,isRotatePan:null}}),o.notify("draw",{prop:"setRotateZoom",onPropertyChange:!1,value:{isRotateZoom:!1}}),o.transform.degree===0&&o.rotateFlipColl.length>0&&(o.img.destLeft+=o.panPoint.totalPannedPoint.x,o.img.destTop+=o.panPoint.totalPannedPoint.y),a=this.setTempFilterValue(s,i,a,t),d(i)&&(this.lowerContext.filter=a.join(" ")),o.initialAdjustmentValue=a.join(" "),g=this.lowerContext.filter,this.lowerContext.filter="brightness(1) contrast(100%) hue-rotate(0deg) saturate(100%) opacity(1) blur(0px) sepia(0%) grayscale(0%) invert(0%)",this.bevelFilter=g,o.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"iterate",pen:"iterate",isPreventApply:null}}),this.lowerContext.filter=g,o.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),(o.currSelectionPoint&&o.currSelectionPoint.shape==="crop-circle"||o.isCircleCrop)&&o.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),this.isBrightnessAdjusted=s!==1}var v=a.join(" ");r&&(r.filter=v)},l.prototype.setTempFilterValue=function(t,e,i,r){if(e){if(r==="default")i=this.getDefaultCurrentFilter(i);else if(t!==1){var o=this.lowerContext.filter.split(" ");o[4]=i[4],this.lowerContext.filter=o.join(" ")}}return i},l.prototype.getDefaultCurrentFilter=function(t){var e=this.adjustmentValue.split(" ");return t=[e[0],e[1],e[2],e[3],e[4],e[5],"sepia(0%)","grayscale(0%)","invert(0%)"],t},l.prototype.getFilterValue=function(t){return t===0?1:1+t*.5/100},l.prototype.getSaturationFilterValue=function(t){return t===0?1:1+t/100},l.prototype.setFilterAdj=function(t,e){var i=this.parent;switch(i.notify("freehand-draw",{prop:"apply-pen-draw",onPropertyChange:!1}),this.adjustmentLevel[""+t]=e,t){case"contrast":case"exposure":e=this.getFilterValue(e),t==="contrast"&&(e*=100);break;case"hue":e*=3;break;case"saturation":e=this.getSaturationFilterValue(e)*100;break;case"opacity":e<10&&(e+=1),e/=100;break;case"blur":e!==0&&(e/=20,e+=.5);break}var r=y({},i.cropObj,{},!0),o=this.getCurrentObj();o.objColl=y([],i.objColl,[],!0),o.pointColl=y([],i.pointColl,[],!0),o.afterCropActions=y([],i.afterCropActions,[],!0);var a={selPointColl:null};i.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:a}}),o.selPointColl=y([],a.selPointColl,[],!0),this.updateAdj(t,e),i.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:t,previousObj:o,previousObjColl:o.objColl,previousPointColl:o.pointColl,previousSelPointColl:o.selPointColl,previousCropObj:r,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}})},l.prototype.setFilter=function(t){var e=this.parent;t=t.toLowerCase(),e.notify("freehand-draw",{prop:"apply-pen-draw",onPropertyChange:!1});var i={currentFilter:this.parent.currentFilter},r=i.currentFilter,o=y({},e.cropObj,{},!0),a=this.getCurrentObj();a.objColl=y([],e.objColl,[],!0),a.pointColl=y([],e.pointColl,[],!0),a.afterCropActions=y([],e.afterCropActions,[],!0);var n={selPointColl:null};e.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:n}}),a.selPointColl=y([],n.selPointColl,[],!0),this.updateAdj(t,null),e.notify("draw",{prop:"setImageEdited",onPropertyChange:!1}),e.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:t,previousObj:a,previousObjColl:a.objColl,previousPointColl:a.pointColl,previousSelPointColl:a.selPointColl,previousCropObj:o,previousText:null,currentText:null,previousFilter:r,isCircleCrop:null}})},l.prototype.setAdjustment=function(t){var e=this.lowerContext.filter.split(" "),i,r;switch(t){case"brightness":r=e[0].split("("),i=parseFloat(r[1].split(")")[0]),this.adjustmentLevel.brightness=this.setFilterValue(i);break;case"contrast":r=e[1].split("("),i=parseFloat(r[1].split(")")[0]),i/=100,this.adjustmentLevel.contrast=this.setFilterValue(i);break;case"hue":r=e[2].split("("),i=parseFloat(r[1].split(")")[0]),i/=3,this.adjustmentLevel.hue=i;break;case"saturation":r=e[3].split("("),i=parseFloat(r[1].split(")")[0]),i/=100,this.adjustmentLevel.saturation=this.setSaturationFilterValue(i);break;case"opacity":r=e[4].split("("),i=parseFloat(r[1].split(")")[0]),i===.45?i=40:i===.4?i=30:i===.35?i=20:i===.3?i=10:i===.25?i=0:i*=100,this.adjustmentLevel.opacity=i;break;case"blur":r=e[5].split("("),i=parseFloat(r[1].split(")")[0]),i*=20,this.adjustmentLevel.blur=i;break;case"exposure":r=e[0].split("("),i=parseFloat(r[1].split(")")[0]),this.adjustmentLevel.exposure=this.setFilterValue(i);break}},l.prototype.setFilterValue=function(t){return Math.round(t===1?0:(t-1)*100/.5)},l.prototype.setSaturationFilterValue=function(t){return Math.round(t===1?0:(t-1)*100)},l.prototype.finetuneImage=function(t,e){var i=this.parent;if(!i.disabled&&i.isImageLoaded){switch(t.toLowerCase()){case"brightness":this.setFilterAdj("brightness",e);break;case"contrast":this.setFilterAdj("contrast",e);break;case"hue":this.setFilterAdj("hue",e);break;case"saturation":this.setFilterAdj("saturation",e);break;case"opacity":this.setFilterAdj("opacity",e);break;case"blur":this.setFilterAdj("blur",e);break;case"exposure":this.setFilterAdj("exposure",e);break}this.parent.canvasFilter=this.lowerContext.filter,i.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}})}},l.prototype.setCurrAdjValue=function(t,e){var i=this.parent;switch(this.parent.notify("draw",{prop:"setImageEdited",onPropertyChange:!1}),t){case"brightness":this.setFilterAdj("brightness",e);break;case"contrast":this.setFilterAdj("contrast",e);break;case"hue":this.setFilterAdj("hue",e);break;case"saturation":this.setFilterAdj("saturation",e);break;case"opacity":this.setFilterAdj("opacity",e);break;case"blur":this.setFilterAdj("blur",e);break;case"exposure":this.setFilterAdj("exposure",e);break}i.isFinetuneBtnClick=!0,i.curFinetuneObjEvent={finetune:i.toPascalCase(t),value:e}},l.prototype.getCurrentObj=function(t){var e=this.parent,i={point:null};e.notify("crop",{prop:"getTempFlipPanPoint",value:{obj:i}});var r={previousZoomValue:null};e.notify("transform",{prop:"getPreviousZoomValue",value:{obj:r}});var o={zoomFactor:null};e.notify("draw",{prop:"getStraightenInitZoom",value:{obj:o}});var a={color:null};e.notify("draw",{prop:"getImageBackgroundColor",value:{obj:a}});var n={cropZoom:0,defaultZoom:0,totalPannedPoint:{x:0,y:0},totalPannedClientPoint:{x:0,y:0},totalPannedInternalPoint:{x:0,y:0},tempFlipPanPoint:{x:0,y:0},activeObj:{},rotateFlipColl:[],degree:0,currFlipState:"",zoomFactor:0,previousZoomValue:0,straighten:0,destPoints:{startX:0,startY:0,width:0,height:0},frame:"none",srcPoints:{startX:0,startY:0,width:0,height:0},filter:"",isBrightAdjust:this.isBrightnessAdjusted,aspectWidth:null,aspectHeight:null,straightenZoom:0,adjustmentLevel:y({},this.tempAdjVal,{},!0),currentFilter:this.tempFilVal,imageSource:"",bgColor:""};return n.cropZoom=e.transform.cropZoomFactor,n.defaultZoom=e.transform.defaultZoomFactor,n.zoomFactor=e.zoomSettings.zoomFactor,n.previousZoomValue=r.previousZoomValue,n.straightenZoom=o.zoomFactor,n.totalPannedPoint=y({},e.panPoint.totalPannedPoint,{},!0),n.totalPannedClientPoint=y({},e.panPoint.totalPannedClientPoint,{},!0),n.totalPannedInternalPoint=y({},e.panPoint.totalPannedInternalPoint,{},!0),n.tempFlipPanPoint=y({},i.point,{},!0),n.activeObj=y({},e.activeObj,{},!0),n.rotateFlipColl=y([],e.rotateFlipColl,[],!0),n.degree=e.transform.degree,n.straighten=e.cropObj.straighten,n.currFlipState=e.transform.currFlipState,n.destPoints={startX:e.img.destLeft,startY:e.img.destTop,endX:0,endY:0,width:e.img.destWidth,height:e.img.destHeight},n.srcPoints={startX:e.img.srcLeft,startY:e.img.srcTop,endX:0,endY:0,width:e.img.srcWidth,height:e.img.srcHeight},n.filter=this.lowerContext.filter,n.aspectWidth=e.aspectWidth,n.aspectHeight=e.aspectHeight,n.frame=e.frameObj.type,n.frameObj=y({},e.frameObj),n.imageSource=e.baseImg.src,n.bgColor=a.color,t&&(t.currObj=n),n},l.prototype.getValFromPercentage=function(t){var e=parseFloat(t);return/%\s*?$/i.test(t)&&(e/=100),e},l.prototype.getValFromLength=function(t){return parseFloat(t)},l.prototype.parseFilterString=function(t){var e=[];return t&&t!=="none"&&(e=t.split(" ").map(function(i){var r=i.match(/([a-z-]+)\(([^)]+)\)/).slice(1,3),o=r[0],a=r[1];return{filter:o,value:a}})),e},l.prototype.applyFilter=function(t){for(var e=t.canvas,i=e.height,r=e.width,o=t.getImageData(0,0,r,i),a=this.parseFilterString(t.filter),n=0,s=a.length;n<s;n++)switch(a[n].filter){case"blur":o=this.blur(t,o,a[n].value);break;case"brightness":o=this.brightness(o,a[n].value);break;case"contrast":o=this.contrast(o,a[n].value);break;case"grayscale":o=this.grayscale(o,a[n].value);break;case"hue-rotate":o=this.hueRotate(o,a[n].value);break;case"invert":o=this.invert(o,a[n].value);break;case"opacity":o=this.opacity(o,a[n].value);break;case"saturate":o=this.saturate(t,o,a[n].value);break;case"sepia":o=this.sepia(o,a[n].value);break}t.putImageData(o,0,0)},l.prototype.blur=function(t,e,i){i===void 0&&(i="0");var r=this.getValFromLength(i);if(r=Math.floor(r),r<=0)return e;for(var o=t.canvas,a=o.height,n=o.width,s=e.data,h=new Uint8ClampedArray(s.length),p=0;p<a;p++)for(var u=0;u<n;u++){for(var c=0,f=0,g=0,v=0,m=0,C=-r;C<=r;C++)for(var M=-r;M<=r;M++){var I=u+M,N=p+C;if(I>=0&&I<n&&N>=0&&N<a){var O=(N*n+I)*4;c+=s[O],f+=s[O+1],g+=s[O+2],v+=s[O+3],m++}}var x=(p*n+u)*4;h[x]=c/m,h[x+1]=f/m,h[x+2]=g/m,h[x+3]=v/m}for(var x=0;x<s.length;x++)s[x]=h[x];return e},l.prototype.brightness=function(t,e){e===void 0&&(e="1");var i=this.getValFromPercentage(e);if(i!==1)for(var r=t.data,o=r.length,a=0;a<o;a+=4)r[a+0]*=i,r[a+1]*=i,r[a+2]*=i;return t},l.prototype.contrast=function(t,e){e===void 0&&(e="1");var i=this.getValFromPercentage(e);if(i!==1)for(var r=t.data,o=r.length,a=0;a<o;a+=4)r[a+0]=((r[a+0]/255-.5)*i+.5)*255,r[a+1]=((r[a+1]/255-.5)*i+.5)*255,r[a+2]=((r[a+2]/255-.5)*i+.5)*255;return t},l.prototype.grayscale=function(t,e){e===void 0&&(e="0");var i=this.getValFromPercentage(e);if(i>0)for(var r=t.data,o=r.length,a=0;a<o;a+=4){var n=r[a],s=r[a+1],h=r[a+2],p=.299*n+.587*s+.114*h;r[a]=n*(1-i)+p*i,r[a+1]=s*(1-i)+p*i,r[a+2]=h*(1-i)+p*i}return t},l.prototype.hueRotate=function(t,e){e===void 0&&(e="0deg");var i=t.data,r=parseFloat(e)*(Math.PI/180);if(r>0)for(var o=Math.cos(r),a=Math.sin(r),n=[.213+o*.787-a*.213,.715-o*.715-a*.715,.072-o*.072+a*.928,.213-o*.213+a*.143,.715+o*.285+a*.14,.072-o*.072-a*.283,.213-o*.213-a*.787,.715-o*.715+a*.715,.072+o*.928+a*.072],s=0;s<i.length;s+=4){var h=i[s],p=i[s+1],u=i[s+2];i[s]=n[0]*h+n[1]*p+n[2]*u,i[s+1]=n[3]*h+n[4]*p+n[5]*u,i[s+2]=n[6]*h+n[7]*p+n[8]*u}return t},l.prototype.invert=function(t,e){e===void 0&&(e="0");var i=this.getValFromPercentage(e);if(i>0)for(var r=t.data,o=r.length,a=0;a<o;a+=4)r[a+0]=Math.abs(r[a+0]-255*i),r[a+1]=Math.abs(r[a+1]-255*i),r[a+2]=Math.abs(r[a+2]-255*i);return t},l.prototype.opacity=function(t,e){e===void 0&&(e="0");var i=this.getValFromPercentage(e);if(i>=0)for(var r=t.data,o=r.length,a=3;a<o;a+=4)r[a]*=i;return t},l.prototype.saturate=function(t,e,i){i===void 0&&(i="0");var r=this.getValFromPercentage(i);if(r!==1)for(var o=t.canvas,a=o.width,n=o.height,s=e.data,h=(1-r)*.3086,p=(1-r)*.6094,u=(1-r)*.082,c=a<<2,f=0;f<n;f++)for(var g=f*c,v=0;v<a;v++){var m=g+(v<<2),C=s[m+0],M=s[m+1],I=s[m+2];s[m+0]=(h+r)*C+p*M+u*I,s[m+1]=h*C+(p+r)*M+u*I,s[m+2]=h*C+p*M+(u+r)*I}return e},l.prototype.sepia=function(t,e){e===void 0&&(e="0");var i=this.getValFromPercentage(e);if(i>1&&(i=1),i>0)for(var r=t.data,o=r.length,a=0;a<o;a+=4){var n=r[a+0],s=r[a+1],h=r[a+2];r[a+0]=(.393*n+.769*s+.189*h)*i+n*(1-i),r[a+1]=(.349*n+.686*s+.168*h)*i+s*(1-i),r[a+2]=(.272*n+.534*s+.131*h)*i+h*(1-i)}return t},l}(),cv=function(){function l(t){this.fhdObj={lastWidth:0,lastVelocity:0,time:0,pointX:0,pointY:0},this.isFreehandDrawing=!1,this.freehandDownPoint={x:0,y:0},this.isFreehandPointMoved=!1,this.pointCounter=0,this.selPointColl={},this.currFHDIdx=0,this.selPoints=[],this.dummyPoints=[],this.tempFHDStyles={strokeColor:null,fillColor:null,strokeWidth:null},this.straightenPoint={x:null,y:null,ratioX:null,ratioY:null},this.straightenPointAngle=0,this.isMasking=!1,this.parent=t,this.addEventListener()}return l.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},l.prototype.addEventListener=function(){this.parent.on("freehand-draw",this.draw,this),this.parent.on("destroyed",this.destroy,this)},l.prototype.removeEventListener=function(){this.parent.off("freehand-draw",this.draw),this.parent.off("destroyed",this.destroy)},l.prototype.draw=function(t){switch(this.updateFhdPvtVar(),t.prop){case"hoverFhd":{this.hoverFhd(t.value.strokeColor,t.value.strokeWidth);break}case"freehandDownHandler":this.freehandDownHandler(t.value.e,t.value.canvas);break;case"freehandUpHandler":this.freehandUpHandler(t.value.e,t.value.canvas,t.value.context);break;case"handle-freehand-draw":{var e=parseInt(t.value.id.split("_")[1],10)-1;this.isFHDIdx(e)&&this.deleteFhd(e,!0);break}case"freehandRedraw":this.freehandRedraw(t.value.context,t.value.points);break;case"deleteFhd":{var e=parseInt(t.value.id.split("_")[1],10)-1;this.deleteFhd(e,!0);break}case"selectFhd":{var e=null;t.value.id&&(e=parseInt(t.value.id.split("_")[1],10)-1),this.selectFhd(e);break}case"applyFhd":this.applyFhd();break;case"cancelFhd":this.cancelFhd();break;case"updateFHDCurPts":this.updateFHDCurPts();break;case"rotateFhdColl":this.rotateFhdColl();break;case"flipFHDColl":this.flipFHDColl(t.value.value);break;case"panFHDColl":this.panFHDColl(t.value.xDiff,t.value.yDiff,t.value.panRegion);break;case"updateFHDColl":t.value&&t.value.isPreventApply?this.updateFHDColl(t.value.isPreventApply):this.updateFHDColl();break;case"zoomFHDColl":this.zoomFHDColl(t.value.isPreventApply);break;case"apply-pen-draw":this.applyPenDraw();break;case"freeHandDraw":this.freeHandDraw(t.value.value);break;case"isFHDIdx":this.isFHDIdx(t.value.index,t.value.obj);break;case"getSqPtFD":this.getSqPtFD(t.value.idx,t.value.obj);break;case"getSelPointColl":t.value.obj.selPointColl=y([],this.selPointColl);break;case"setSelPointColl":this.selPointColl=y([],t.value.obj.selPointColl);break;case"pushSelPointColl":this.selPointColl.push(y([],t.value.obj.selPointColl));break;case"setFreehandDrawHoveredIndex":this.fhdHovIdx=t.value.index;break;case"getFreehandDrawHoveredIndex":t.value.obj.index=this.fhdHovIdx;break;case"setPointCounter":this.pointCounter=t.value.value;break;case"getPenStrokeWidth":t.value.obj.penStrokeWidth=this.penStrokeWidth;break;case"setPenStrokeWidth":this.penStrokeWidth=t.value.value;break;case"getCurrentFreehandDrawIndex":t.value.obj.currentFreehandDrawIndex=this.currFHDIdx;break;case"setCurrentFreehandDrawIndex":this.currFHDIdx=t.value.value;break;case"updateCropPtsForSel":this.updateCropPtsForSel();break;case"getFreehandDrawSelectedId":t.value.obj.freehandDrawSelectedId=this.fhdSelID;break;case"resetFreehandDrawSelectedId":this.fhdSelID=null;break;case"getTempFreeHandDrawEditingStyles":t.value.obj.tempFreeHandDrawEditingStyles=this.tempFHDStyles;break;case"setFreehandSelectedIndex":this.fhdSelIdx=t.value.index;break;case"getFreehandSelectedIndex":t.value.obj.freehandSelectedIndex=this.fhdSelIdx;break;case"setCenterSelPoints":this.setCenterSelPoints();break;case"getStraightenPoint":t.value.obj.straightenPoint=y({},this.straightenPoint,{},!0);break;case"setStraightenPoint":this.straightenPoint.x=t.value.x,this.straightenPoint.y=t.value.y,t.value.ratioX&&t.value.ratioY&&(this.straightenPoint.ratioX=t.value.ratioX,this.straightenPoint.ratioY=t.value.ratioY);break;case"resetStraightenPoint":this.straightenPoint={x:null,y:null,ratioX:null,ratioY:null},this.prevStraightenObj=null,this.straightenPointAngle=0;break;case"getStraightenPointAngle":t.value.obj.angle=this.straightenPointAngle;break;case"reset":this.reset();break;case"triggerShapeChanging":this.triggerShapeChanging(t.value.shapeChangingArgs);break;case"setMasking":this.isMasking=t.value.value;break;case"resetSelPoints":this.selPoints=[];break}},l.prototype.updateFhdPvtVar=function(){var t=this.parent;t.lowerCanvas&&(this.lowerContext=t.lowerCanvas.getContext("2d")),t.upperCanvas&&(this.upperContext=t.upperCanvas.getContext("2d"))},l.prototype.reset=function(){this.fhdObj={lastWidth:0,lastVelocity:0,time:0,pointX:0,pointY:0},this.isFreehandDrawing=this.isFreehandPointMoved=!1,this.selPoints=[],this.dummyPoints=[],this.freehandDownPoint={x:0,y:0},this.selPointColl={},this.straightenPointAngle=0,this.fhdHovIdx=null,this.pointCounter=0,this.fhdSelID=null,this.isMasking=!1,this.penStrokeWidth=void 0,this.currFHDIdx=0,this.fhdSelIdx=null,this.tempFHDStyles={strokeColor:null,fillColor:null,strokeWidth:null},this.straightenPoint={x:null,y:null,ratioX:null,ratioY:null},this.prevStraightenObj=null},l.prototype.getModuleName=function(){return"freehand-draw"},l.prototype.hoverFhd=function(t,e){var i=this.parent,r=this.upperContext,o=-1;this.fhdHovIdx>-1?o=this.fhdHovIdx:o=this.fhdSelIdx,i.points=y([],i.pointColl[o].points),this.pointCounter=0;var a=i.points.length,n,s,h,p,u=0,c=0;r.fillStyle=t||i.pointColl[o].strokeColor,r.strokeStyle=r.fillStyle,u=c=this.penStrokeWidth=e||i.pointColl[o].strokeWidth,a===1&&(n=s=h=p=i.points[0],this.startDraw(r,n,s,h,p,u,c));for(var f=0;f<a-3;f++)i.points[f+1]&&i.points[f+2]&&i.points[f+2]&&(n=this.calcCurveCP(i.points[f+0],i.points[f+1],i.points[f+2]).controlPoint2,s=this.calcCurveCP(i.points[f+1],i.points[f+2],i.points[f+3]).controlPoint1,f===0?h=i.points[f]:h=i.points[f+1],p=i.points[f+2],this.startDraw(r,n,s,h,p,u,c));r.closePath();var g=this.getSqPtFD(o),v=r.lineWidth;r.lineWidth=2,r.strokeStyle=i.themeColl[i.theme].primaryColor,r.beginPath(),r.rect(g.startX,g.startY,g.width,g.height),r.stroke(),r.closePath(),r.lineWidth=v},l.prototype.freehandDownHandler=function(t,e){var i=this.parent;i.lowerCanvas=document.querySelector("#"+i.element.id+"_lowerCanvas"),this.lowerContext=i.lowerCanvas.getContext("2d"),i.upperCanvas=document.querySelector("#"+i.element.id+"_upperCanvas"),this.upperContext=i.upperCanvas.getContext("2d"),this.fhdObj.time=new Date().getTime(),this.isFreehandDrawing=!0,t.type==="mousedown"?this.freehandDownPoint={x:t.clientX,y:t.clientY}:this.freehandDownPoint={x:t.touches[0].clientX,y:t.touches[0].clientY},this.isFreehandPointMoved=!1,b.add(e,"mousemove touchmove",this.freehandMoveHandler,this);var r={id:"pen_"+(this.currFHDIdx+1),type:bt.FreehandDraw,startX:this.freehandDownPoint.x,startY:this.freehandDownPoint.y,strokeColor:i.activeObj.strokeSettings.strokeColor,strokeWidth:this.penStrokeWidth,points:null,index:i.objColl.length+i.freehandCounter+1},o={cancel:!1,action:"draw-start",previousShapeSettings:r,currentShapeSettings:r};this.triggerShapeChanging(o)},l.prototype.freehandUpHandler=function(t,e,i){var r=e.getBoundingClientRect(),o=this.parent;b.remove(e,"mousemove touchmove",this.freehandMoveHandler),o.points.length===0&&(t.type==="mouseup"?this.processPoint(t.clientX-r.left,t.clientY-r.top,!0,i):t.type==="touchend"&&t.changedTouches?this.processPoint(t.changedTouches[0].clientX-r.left,t.changedTouches[0].clientY-r.top,!0,i):this.isFreehandPointMoved||this.processPoint(this.freehandDownPoint.x-r.left,this.freehandDownPoint.y-r.top,!0,i)),i.closePath();var a=y({},o.cropObj,{},!0),n={currObj:{}};o.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:n}});var s=n.currObj;s.objColl=y([],o.objColl,[],!0),s.pointColl=y([],o.pointColl,[],!0),s.afterCropActions=y([],o.afterCropActions,[],!0);var h={selPointColl:null};o.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:h}}),s.selPointColl=y([],h.selPointColl,[],!0);var p=o.freehandCounter,u=o.objColl.length+o.freehandCounter+1;o.pointColl[p]={points:y([],o.points),strokeColor:o.activeObj.strokeSettings.strokeColor,strokeWidth:this.penStrokeWidth,flipState:o.transform.currFlipState,id:"pen_"+(this.currFHDIdx+1),order:u},o.points=[],this.dummyPoints=[],this.selPointColl[p]={points:y([],this.selPoints)},this.selPoints=[],this.pointCounter=0,o.freehandCounter++,this.isFreehandDrawing=!1,o.isMaskImage||o.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"freehand-draw",previousObj:s,previousObjColl:s.objColl,previousPointColl:s.pointColl,previousSelPointColl:s.selPointColl,previousCropObj:a,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}});var c={id:"pen_"+(this.currFHDIdx+1),type:bt.FreehandDraw,startX:this.freehandDownPoint.x,startY:this.freehandDownPoint.y,strokeColor:o.activeObj.strokeSettings.strokeColor,strokeWidth:this.penStrokeWidth,points:o.pointColl[this.currFHDIdx].points,index:u},f={cancel:!1,action:"draw-end",previousShapeSettings:c,currentShapeSettings:c};this.triggerShapeChanging(f),this.currFHDIdx++},l.prototype.freehandMoveHandler=function(t){this.isFreehandPointMoved=!0;var e=this.parent.upperCanvas.getBoundingClientRect(),i,r;t.type==="mousemove"?(i=t.clientX-e.left,r=t.clientY-e.top):(i=t.touches[0].clientX-e.left,r=t.touches[0].clientY-e.top),this.isFreehandDrawing&&(this.upperContext.fillStyle=this.parent.activeObj.strokeSettings.strokeColor,this.parent.isMaskImage&&(this.upperContext.globalCompositeOperation="xor"),this.processPoint(i,r,!1,this.upperContext))},l.prototype.processPoint=function(t,e,i,r){var o=this.parent,a=this.point(t,e,new Date().getTime());a=o.points.length>0&&o.points[o.points.length-1];var n=a?this.distanceTo(a)<=5:!1,s,h,p,u;if(this.selPoints.push({x:t,y:e,ratioX:(t-o.img.destLeft)/o.img.destWidth,ratioY:(e-o.img.destTop)/o.img.destHeight,time:this.fhdObj.time}),!a||!(a&&n)||i){if(this.fhdObj.time=new Date().getTime(),o.points.push({x:t,y:e,ratioX:(t-o.img.destLeft)/o.img.destWidth,ratioY:(e-o.img.destTop)/o.img.destHeight,time:this.fhdObj.time}),this.dummyPoints.push({x:t,y:e,ratioX:(t-o.img.destLeft)/o.img.destWidth,ratioY:(e-o.img.destTop)/o.img.destHeight,time:this.fhdObj.time}),this.dummyPoints.length>2){this.dummyPoints.length===3&&this.dummyPoints.unshift(this.dummyPoints[0]);var c=this.dummyPoints[0],f=this.dummyPoints[1],g=this.dummyPoints[2],v=this.dummyPoints[3];s=this.calcCurveCP(c,f,g).controlPoint2,h=this.calcCurveCP(f,g,v).controlPoint1,p=this.dummyPoints[1],u=this.dummyPoints[2];var m=.5,C=5;d(this.penStrokeWidth)||(m=C=this.penStrokeWidth),this.startDraw(r,s,h,p,u,m,C),this.pointCounter++,this.dummyPoints.shift()}if(i){s=h=p=u={x:t,y:e,time:new Date().getTime()};var m=.5,C=5;d(this.penStrokeWidth)||(m=C=this.penStrokeWidth),this.startDraw(r,s,h,p,u,m,C)}}},l.prototype.calcCurveCP=function(t,e,i){e||(e=t),i||(i=e);var r=t.x-e.x,o=t.y-e.y,a=e.x-i.x,n=e.y-i.y,s={x:(t.x+e.x)/2,y:(t.y+e.y)/2},h={x:(e.x+i.x)/2,y:(e.y+i.y)/2},p=Math.sqrt(r*r+o*o),u=Math.sqrt(a*a+n*n),c=s.x-h.x,f=s.y-h.y,g=u/(p+u),v={x:h.x+c*g,y:h.y+f*g},m=e.x-v.x,C=e.y-v.y;return{controlPoint1:this.point(s.x+m,s.y+C,0),controlPoint2:this.point(h.x+m,h.y+C,0)}},l.prototype.point=function(t,e,i){return this.fhdObj.pointX=t,this.fhdObj.pointY=e,{x:this.fhdObj.pointX,y:this.fhdObj.pointY,time:i}},l.prototype.startDraw=function(t,e,i,r,o,a,n){var s;s=this.pointVelocity(r),s=.7*s+(1-.7)*this.fhdObj.lastVelocity;var h=Math.max(n/(.7+1),a);this.drawCurve(this.fhdObj.time,h,t,e,i,r,o,n),this.fhdObj.lastVelocity=s,this.fhdObj.time=h},l.prototype.pointVelocity=function(t){return this.fhdObj.time!==t.time?this.distanceTo(t)/(this.fhdObj.time-t.time):0},l.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.fhdObj.pointX-t.x,2)+Math.pow(this.fhdObj.pointY-t.y,2))},l.prototype.drawCurve=function(t,e,i,r,o,a,n,s){var h,p,u,c,f,g,v,m,C,M,I=e-t,N=this.bezierLength(r,o,a,n),O=Math.ceil(N)*2;for(i.beginPath(),p=0;p<O;p++)u=p/O,c=u*u,f=c*u,g=1-u,v=g*g,m=v*g,C=m*a.x,C+=3*v*u*r.x,C+=3*g*c*o.x,C+=f*n.x,M=m*a.y,M+=3*v*u*r.y,M+=3*g*c*o.y,M+=f*n.y,h=Math.min(t+f*I,s),this.drawArc(C,M,h,i);i.closePath(),i.fill()},l.prototype.bezierLength=function(t,e,i,r){var o=10,a=0,n,s,h,p,u,c,f,g;for(n=0;n<=o;n++)s=n/o,h=this.bezierPoint(s,i.x,t.x,e.x,r.x),p=this.bezierPoint(s,i.y,t.y,e.y,r.y),n>0&&(f=h-u,g=p-c,a+=Math.sqrt(f*f+g*g)),u=h,c=p;return a},l.prototype.bezierPoint=function(t,e,i,r,o){return e*(1-t)*(1-t)*(1-t)+3*i*(1-t)*(1-t)*t+3*r*(1-t)*t*t+o*t*t*t},l.prototype.drawArc=function(t,e,i,r){var o=this.parent.img;(t>o.destLeft&&e>o.destTop&&t<o.destLeft+o.destWidth&&e<o.destTop+o.destHeight||r!==this.lowerContext&&r!==this.upperContext)&&(r.moveTo(t,e),r.arc(t,e,i,0,2*Math.PI,!1))},l.prototype.freehandRedraw=function(t,e){var i=this.parent,r=t.filter;if(t.filter="none",e&&(i.pointColl[i.freehandCounter]={points:e,strokeColor:i.activeObj.strokeSettings.strokeColor,strokeWidth:this.penStrokeWidth,flipState:i.transform.currFlipState,id:"pen_"+(i.freehandCounter+1),order:i.objColl.length+i.freehandCounter+1},this.selPointColl[i.freehandCounter]=y({},i.pointColl[i.freehandCounter],{},!0),i.freehandCounter++),i.freehandCounter>0){for(var o=0;o<i.freehandCounter;o++){i.points=y([],i.pointColl[o].points),this.pointCounter=0;var a=i.points.length,n=void 0,s=void 0,h=void 0,p=void 0,u=void 0,c=void 0;a>0&&(t.fillStyle=i.pointColl[o].strokeColor,u=c=this.penStrokeWidth=i.pointColl[o].strokeWidth),a===1&&(n=s=h=p=i.points[0],this.startDraw(t,n,s,h,p,u,c));for(var f=0;f<a-3;f++)i.points[f+1]&&i.points[f+2]&&i.points[f+2]&&(n=this.calcCurveCP(i.points[f+0],i.points[f+1],i.points[f+2]).controlPoint2,s=this.calcCurveCP(i.points[f+1],i.points[f+2],i.points[f+3]).controlPoint1,f===0?h=i.points[f]:h=i.points[f+1],p=i.points[f+2],this.startDraw(t,n,s,h,p,u,c));t.closePath()}t===this.lowerContext&&(i.notify("draw",{prop:"applyFrame",value:{ctx:this.lowerContext,frame:i.frameObj.type,preventImg:!0}}),this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height))}t.filter=r},l.prototype.getSqPtFD=function(t,e){var i={startX:0,startY:0,endX:0,endY:0,width:0,height:0},r=y([],this.selPointColl[t].points,[]);this.parent.points=y([],this.parent.pointColl[t].points),this.pointCounter=0;for(var o=r.length,a=0;a<o;a++)i.startX===0&&i.startY===0&&i.endX===0&&i.endY===0?(i.startX=r[a].x,i.startY=r[a].y,i.endX=r[a].x,i.endY=r[a].y):(i.startX=Math.min(i.startX,r[a].x),i.startY=Math.min(i.startY,r[a].y),i.endX=Math.max(i.endX,r[a].x),i.endY=Math.max(i.endY,r[a].y));return i.startX-=this.penStrokeWidth,i.startY-=this.penStrokeWidth,i.endX+=this.penStrokeWidth,i.endY+=this.penStrokeWidth,i.width=i.endX-i.startX,i.height=i.endY-i.startY,e&&(e.activePoint=i),i},l.prototype.applyPenDraw=function(){var t=this.parent;t.currObjType.shape==="freehanddraw"&&(t.notify("shape",{prop:"apply",onPropertyChange:!1,value:{shape:null,obj:null,canvas:null}}),t.upperCanvas.style.cursor=t.cursor="default",t.currObjType.shape=""),t.notify("shape",{prop:"clearActObj"})},l.prototype.applyFhd=function(){var t=this.parent,e=t.pointColl[this.fhdSelIdx];e.strokeColor==="#42a5f5"&&(e.strokeColor=this.tempFHDStyles.strokeColor),t.notify("toolbar",{prop:"setSelectedFreehandColor",value:{color:"#42a5f5"}}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),this.lowerContext.clearRect(0,0,t.lowerCanvas.width,t.lowerCanvas.height),t.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),t.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1}),e&&(e.isSelected=!1),t.notify("selection",{prop:"resetFreehandDrawVariables"}),this.fhdHovIdx=this.fhdSelIdx=null},l.prototype.cancelFhd=function(){var t=this.parent,e=t.pointColl[this.fhdSelIdx];t.notify("toolbar",{prop:"setSelectedFreehandColor",value:{color:"#42a5f5"}}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),this.lowerContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),this.pointCounter=0,e&&(e.strokeColor=this.tempFHDStyles.strokeColor,e.strokeWidth=this.tempFHDStyles.strokeWidth,e.isSelected=!1),this.fhdHovIdx=this.fhdSelIdx=this.fhdSelID=null,t.notify("selection",{prop:"resetFreehandDrawVariables"}),t.activeObj.strokeSettings.strokeColor=this.tempFHDStyles.strokeColor,t.activeObj.strokeSettings.strokeWidth=this.penStrokeWidth=this.tempFHDStyles.strokeWidth,this.tempFHDStyles={strokeColor:null,strokeWidth:null,fillColor:null},t.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),t.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1})},l.prototype.selectFhd=function(t){var e=this.parent,i=y({},this.tempFHDStyles,{},!0);if(e.notify("selection",{prop:"setFreehandDrawEditing",onPropertyChange:!1,value:{bool:!0}}),t||t===0)if(this.isFHDIdx(t))this.fhdSelIdx=this.fhdHovIdx=t,this.hoverFhd(),e.upperCanvas.style.cursor=e.cursor="pointer";else return;this.fhdSelIdx=this.fhdHovIdx;var r=e.pointColl[this.fhdSelIdx];r.isSelected=!0,this.fhdSelID=r.id,r.strokeColor!=="#42a5f5"&&(e.activeObj.strokeSettings.strokeColor=this.tempFHDStyles.strokeColor=r.strokeColor),e.activeObj.strokeSettings.strokeWidth=this.tempFHDStyles.strokeWidth=e.pointColl[this.fhdHovIdx].strokeWidth;var o={bool:!1};if(e.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:o}}),o.bool){var a={id:"pen_"+(this.fhdSelIdx+1),type:bt.FreehandDraw,startX:r.points[0].x,startY:r.points[0].y,strokeColor:r.strokeColor,strokeWidth:r.strokeWidth,points:r.points,opacity:r.opacity,index:r.order},n={cancel:!1,action:"select",previousShapeSettings:a,currentShapeSettings:a};this.triggerShapeChanging(n)}else e.okBtn(null,!0);e.isUndoRedoStack&&(this.tempFHDStyles=i)},l.prototype.deleteFhd=function(t,e){var i=this.parent;if(this.isFHDIdx(t)){this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height);var r=y({},i.pointColl,{},!0),o=y({},this.selPointColl,{},!0);i.pointColl={},this.selPointColl={};for(var a=0,n=0;n<i.freehandCounter;n++)parseInt(r[n].id.split("_")[1],10)-1!==t&&(i.pointColl[a]=r[n],this.selPointColl[a]=o[n],a++);i.freehandCounter-=1,this.fhdHovIdx=this.fhdSelIdx=null,i.notify("selection",{prop:"resetFreehandDrawVariables"}),i.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),i.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1})}},l.prototype.zoomX=function(t){return t*this.parent.img.destWidth+this.parent.img.destLeft},l.prototype.zoomY=function(t){return t*this.parent.img.destHeight+this.parent.img.destTop},l.prototype.zoomFHDColl=function(t){var e=this.parent,i={startX:e.img.destLeft,startY:e.img.destTop,width:e.img.destWidth,height:e.img.destHeight};e.notify("shape",{prop:"straightenShapes",onPropertyChange:!1});for(var r=0;r<e.freehandCounter;r++){e.points=y([],e.pointColl[r].points,[]),this.pointCounter=0;for(var o=e.points.length,a=0;a<o;a++){var n=e.points[a];n.x=this.zoomX(n.ratioX),n.y=this.zoomY(n.ratioY)}}this.updateFHDCurPts(),this.straightenPoint.x&&this.straightenPoint.y&&(this.straightenPoint.x=this.zoomX(this.straightenPoint.ratioX),this.straightenPoint.y=this.zoomY(this.straightenPoint.ratioY)),e.transform.straighten!==0&&e.notify("shape",{prop:"straightenFHD",onPropertyChange:!1}),e.img.destLeft=i.startX,e.img.destTop=i.startY,e.img.destWidth=i.width,e.img.destHeight=i.height,d(t)&&this.freehandRedraw(this.lowerContext,null)},l.prototype.updateFHDCurPts=function(){for(var t=this.parent,e=0;e<t.freehandCounter;e++)if(this.selPointColl[e]){this.selPoints=y([],this.selPointColl[e].points,[]),this.pointCounter=0;for(var i=this.selPoints.length,r=0;r<i;r++){var o=this.selPoints[r];o.x=this.zoomX(o.ratioX),o.y=this.zoomY(o.ratioY)}}},l.prototype.rotateFhdColl=function(){for(var t=this.parent,e=t.img,i=e.destLeft,r=e.destTop,o=e.destWidth,a=e.destHeight,n=0;n<t.freehandCounter;n++){t.points=y([],t.pointColl[n].points,[]),this.pointCounter=0;for(var s=t.points.length,h=0;h<s;h++){var p=t.points[h];p.y=r+a*p.ratioX,p.x=i+o-o*p.ratioY,p.ratioX=(p.x-i)/o,p.ratioY=(p.y-r)/a}}for(var n=0;n<t.freehandCounter;n++)if(this.selPointColl[n]){this.selPoints=y([],this.selPointColl[n].points,[]),this.pointCounter=0;for(var s=this.selPoints.length,h=0;h<s;h++){var p=this.selPoints[h];p.y=r+a*p.ratioX,p.x=i+o-o*p.ratioY,p.ratioX=(p.x-i)/o,p.ratioY=(p.y-r)/a}}this.updateFHDCurPts()},l.prototype.flipFHDColl=function(t){var e=t.toLowerCase();if(e==="horizontal")this.pointsHorizontalFlip();else if(e==="vertical")this.pointsVerticalFlip();else{this.pointsHorizontalFlip();for(var i=0;i<this.parent.freehandCounter;i++)this.parent.pointColl[i].shapeFlip="";this.pointsVerticalFlip()}},l.prototype.pointsHorizontalFlip=function(){for(var t=this.parent,e=t.img,i=e.destLeft,r=e.destTop,o=e.destWidth,a=e.destHeight,n=0;n<t.freehandCounter;n++)if(t.pointColl[n].shapeFlip!==t.transform.currFlipState){t.points=y([],t.pointColl[n].points,[]),this.pointCounter=0;for(var s=t.points.length,h=0;h<s;h++){var p=t.points[h];p.x<=i+o/2?p.x=i+o-(p.x-i):p.x>=i+o/2&&(p.x=i+(i+o-p.x)),p.ratioX=(p.x-i)/o,p.ratioY=(p.y-r)/a}t.pointColl[n].shapeFlip=t.transform.currFlipState}for(var n=0;n<t.freehandCounter;n++)if(this.selPointColl[n]&&this.selPointColl[n].shapeFlip!==t.transform.currFlipState){this.selPoints=y([],this.selPointColl[n].points,[]),this.pointCounter=0;for(var s=this.selPoints.length,h=0;h<s;h++){var p=this.selPoints[h];p.x<=i+o/2?p.x=i+o-(p.x-i):p.x>=i+o/2&&(p.x=i+(i+o-p.x)),p.ratioX=(p.x-i)/o,p.ratioY=(p.y-r)/a}}this.updateFHDCurPts()},l.prototype.pointsVerticalFlip=function(){for(var t=this.parent,e=t.img,i=e.destLeft,r=e.destTop,o=e.destWidth,a=e.destHeight,n=0;n<t.freehandCounter;n++)if(t.pointColl[n].shapeFlip!==t.transform.currFlipState){t.points=y([],t.pointColl[n].points,[]),this.pointCounter=0;for(var s=t.points.length,h=0;h<s;h++){var p=t.points[h];p.y<=r+a/2?p.y=r+a-(p.y-r):p.y>=r+a/2&&(p.y=r+(r+a-p.y)),p.ratioX=(p.x-i)/o,p.ratioY=(p.y-r)/a}t.pointColl[n].shapeFlip=t.transform.currFlipState}for(var n=0;n<t.freehandCounter;n++)if(this.selPointColl[n]&&this.selPointColl[n].shapeFlip!==t.transform.currFlipState){this.selPoints=y([],this.selPointColl[n].points,[]),this.pointCounter=0;for(var s=this.selPoints.length,h=0;h<s;h++){var p=this.selPoints[h];p.y<=r+a/2?p.y=r+a-(p.y-r):p.y>=r+a/2&&(p.y=r+(r+a-p.y)),p.ratioX=(p.x-i)/o,p.ratioY=(p.y-r)/a}}this.updateFHDCurPts()},l.prototype.updateFHDColl=function(t){var e=this.parent,i={startX:e.img.destLeft,startY:e.img.destTop,width:e.img.destWidth,height:e.img.destHeight};e.notify("shape",{prop:"straightenShapes",onPropertyChange:!1});for(var r=e.img,o=r.destLeft,a=r.destTop,n=r.destWidth,s=r.destHeight,h=0,p=e.objColl.length;h<p;h++){var u=e.objColl[h];if(u.shape==="line"||u.shape==="arrow")e.notify("shape",{prop:"straightenShapePoints",value:{obj:u,isReverse:!0}});else if(u.shape==="path"){var c=e.transform.straighten;e.transform.straighten=-e.transform.straighten,e.notify("shape",{prop:"straightenPath",onPropertyChange:!1,value:{obj:u}}),e.transform.straighten=c}if(u.imageRatio={startX:(u.activePoint.startX-o)/n,startY:(u.activePoint.startY-a)/s,endX:(u.activePoint.endX-o)/n,endY:(u.activePoint.endY-a)/s,width:n/u.activePoint.width,height:s/u.activePoint.height},u.shape==="path")for(var f=0,g=u.pointColl.length;f<g;f++)u.pointColl[f].ratioX=(u.pointColl[f].x-o)/n,u.pointColl[f].ratioY=(u.pointColl[f].y-a)/s;e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1})}if(e.freehandCounter>0&&e.transform.straighten!==0){var c=e.transform.straighten;e.transform.straighten=-e.transform.straighten,e.notify("shape",{prop:"straightenFHD",onPropertyChange:!1}),e.transform.straighten=c}for(var v=0;v<e.freehandCounter;v++){e.points=y([],e.pointColl[v].points,[]),this.pointCounter=0;for(var m=e.points.length,C=0;C<m;C++){var M=e.points[C];M.ratioX=(M.x-o)/n,M.ratioY=(M.y-a)/s}}for(var v=0;v<e.freehandCounter;v++)if(this.selPointColl[v]){this.selPoints=y([],this.selPointColl[v].points,[]),this.pointCounter=0;for(var m=this.selPoints.length,C=0;C<m;C++){var M=this.selPoints[C];M.ratioX=(M.x-o)/n,M.ratioY=(M.y-a)/s}}this.straightenPoint.x&&this.straightenPoint.y&&(this.straightenPoint.ratioX=(this.straightenPoint.x-o)/n,this.straightenPoint.ratioY=(this.straightenPoint.y-a)/s),e.img.destLeft=i.startX,e.img.destTop=i.startY,e.img.destWidth=i.width,e.img.destHeight=i.height,e.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:t}})},l.prototype.panFHDColl=function(t,e,i){for(var r=this.parent,o=0;o<r.freehandCounter;o++){r.points=y([],r.pointColl[o].points,[]),this.pointCounter=0;for(var a=r.points.length,n=0;n<a;n++){var s=r.points[n];i===""||i==="vertical"?s.x+=t:s.x-=t,i===""||i==="horizontal"?s.y+=e:s.y-=e}}for(var o=0;o<r.freehandCounter;o++)if(this.selPointColl[o]){this.selPoints=y([],this.selPointColl[o].points,[]),this.pointCounter=0;for(var a=this.selPoints.length,n=0;n<a;n++){var s=this.selPoints[n];i===""||i==="vertical"?s.x+=t:s.x-=t,i===""||i==="horizontal"?s.y+=e:s.y-=e}}this.straightenPoint.x&&this.straightenPoint.y&&(i===""||i==="vertical"?this.straightenPoint.x+=t:this.straightenPoint.x-=t,i===""||i==="horizontal"?this.straightenPoint.y+=e:this.straightenPoint.y-=e),this.freehandRedraw(this.lowerContext,null)},l.prototype.freeHandDraw=function(t){var e=this.parent;if(t){if(e.points=[],this.dummyPoints=[],e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),e.togglePen=!0,e.upperCanvas.style.cursor=e.cursor="crosshair",e.upperCanvas.style.display="block",d(e.activeObj.strokeSettings)){var i={strokeSettings:{}};e.notify("shape",{prop:"getStrokeSettings",onPropertyChange:!1,value:{obj:i}}),e.activeObj.strokeSettings=i.strokeSettings}d(e.activeObj.strokeSettings.strokeWidth)&&(e.activeObj.strokeSettings.strokeWidth=2),e.isMaskImage?e.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1}):e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"pen",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}})}else{e.upperCanvas.style.cursor=e.cursor="default";var r=this.penStrokeWidth;e.notify("shape",{prop:"apply",onPropertyChange:!1,value:{shape:null,obj:null,canvas:null}}),e.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1}),e.notify("toolbar",{prop:"setCurrentToolbar",value:{type:"main"}}),e.notify("selection",{prop:"setFreehandDrawCustomized",value:{isFreehandDrawCustomized:!1}}),this.penStrokeWidth=r}},l.prototype.isFHDIdx=function(t,e){for(var i=!1,r=0;r<this.parent.freehandCounter;r++)if(this.parent.pointColl[r].id&&parseInt(this.parent.pointColl[r].id.split("_")[1],10)-1===t){i=!0;break}return e&&(e.isIndex=i),i},l.prototype.updateCropPtsForSel=function(){for(var t=this.parent,e=t.activeObj.activePoint,i=0;i<t.freehandCounter;i++){var r={selPointColl:y([],this.selPointColl)};if(r.selPointColl[i]){this.selPoints=y([],r.selPointColl[i].points,[]),this.pointCounter=0;for(var o=this.selPoints.length,a=0;a<o;a++){var n=this.selPoints[a];n.ratioX=(n.x-e.startX)/e.width,n.ratioY=(n.y-e.startY)/e.height}}}},l.prototype.triggerShapeChanging=function(t){var e=this.parent,i=e.pointColl[this.fhdSelIdx];if(e.trigger("shapeChanging",t),e.element.getAttribute("data-value")==="mask-drawing"&&!this.isMasking){this.isMasking=!0,e.upperCanvas.style.cursor="crosshair",e.notify("draw",{prop:"updateTempObjColl"}),e.notify("draw",{prop:"updateTempPointColl"}),e.discard(),e.selectMaskImage();return}if(e.editCompleteArgs=t,t.currentShapeSettings.id.indexOf("pen_")===-1&&(t.action==="draw-end"||t.action==="select")){var r="pen_"+t.currentShapeSettings.id;this.fhdSelIdx?e.pointColl[this.fhdSelIdx].id=r:e.pointColl[e.freehandCounter-1].id=r}this.penStrokeWidth=t.currentShapeSettings.strokeWidth,e.activeObj.strokeSettings.strokeColor!==t.currentShapeSettings.strokeColor&&(e.activeObj.strokeSettings.strokeColor=t.currentShapeSettings.strokeColor,e.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1})),this.fhdSelID&&i&&t.currentShapeSettings&&(i.strokeColor=t.currentShapeSettings.strokeColor,i.strokeWidth=t.currentShapeSettings.strokeWidth,i.points=t.currentShapeSettings.points,i.opacity=t.currentShapeSettings.opacity),t.action==="select"&&(this.freehandRedraw(this.upperContext),e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"pen",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}))},l.prototype.setCenterSelPoints=function(){var t=this.parent,e={startX:t.img.destLeft,startY:t.img.destTop,width:t.img.destWidth,height:t.img.destHeight};t.notify("shape",{prop:"straightenShapes",onPropertyChange:!1});var i=t.img,r=i.destLeft,o=i.destTop,a=i.destWidth,n=i.destHeight,s=t.activeObj.activePoint;(d(this.prevStraightenObj)||JSON.stringify(this.prevStraightenObj.activePoint)!==JSON.stringify(s))&&(this.straightenPoint={x:s.startX+s.width/2,y:s.startY+s.height/2,ratioX:(s.startX+s.width/2-r)/a,ratioY:(s.startY+s.height/2-o)/n},this.prevStraightenObj=y({},t.activeObj,{},!0),this.straightenPointAngle=t.transform.straighten),t.img.destLeft=e.startX,t.img.destTop=e.startY,t.img.destWidth=e.width,t.img.destHeight=e.height},l}(),dv=function(){function l(t){this.diffPoint={x:0,y:0},this.oldPoint={},this.isTouch=!1,this.isObjSelected=!1,this.isFhdPoint=!1,this.dragPoint={startX:0,startY:0,endX:0,endY:0},this.isShapeInserted=!1,this.tempActiveObj={activePoint:{startX:0,startY:0,endX:0,endY:0,width:0,height:0},flipObjColl:[],triangle:[],triangleRatio:[],order:null},this.isFirstMove=!1,this.startTouches=[],this.tempTouches=[],this.currMousePoint={x:0,y:0},this.cursorTargetId="",this.isPreventDragging=!1,this.dragElement="",this.textRow=1,this.mouseDownPoint={x:0,y:0},this.previousPoint={x:0,y:0},this.zoomType="Toolbar",this.isInitialTextEdited=!1,this.dragCanvas=!1,this.isFhdCustomized=!1,this.touchEndPoint={},this.isFhdEditing=!1,this.currentDrawingShape="",this.initialPrevObj={},this.touchTime=0,this.resizedElement="",this.isImageClarity=!0,this.isPinching=!1,this.isSliding=!1,this.mouseDown="",this.isSliderActive=!1,this.arrowShape=[Fi.None,Fi.SolidArrow],this.isTouchDblClick=!1,this.isMouseDown=!1,this.isMouseUp=!1,this.mouseWheel=0,this.isTransformedShape=!1,this.parent=t,this.addEventListener()}return l.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},l.prototype.addEventListener=function(){this.parent.on("selection",this.selection,this),this.parent.on("destroyed",this.destroy,this)},l.prototype.removeEventListener=function(){this.parent.off("selection",this.selection),this.parent.off("destroyed",this.destroy)},l.prototype.selection=function(t){var e=this.parent;switch(this.updatePrivateVariables(),t.prop){case"setCursor":this.setCursor(t.value.x,t.value.y);break;case"updateActivePoint":this.updateActivePoint(t.value.x,t.value.y,t.value.isCropSelection);break;case"updateCursorStyles":this.updateCursorStyles(t.value.x,t.value.y,t.value.type);break;case"setTextSelection":this.setTextSelection(t.value.width,t.value.height);break;case"setActivePoint":this.setActivePoint(t.value.startX,t.value.startY);break;case"clearSelection":this.clearSelection(t.value.resetCrop);break;case"calcShapeRatio":this.calcShapeRatio(t.value.x,t.value.y,t.value.imgWidth,t.value.imgHeight);break;case"tab":this.performTabAction();break;case"setDragDirection":this.setDragDirection(t.value.width,t.value.height);break;case"clearUpperCanvas":this.isTouch&&setTimeout(function(){e.upperCanvas.getContext("2d").clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height)},550);break;case"resetFreehandDrawVariables":this.isFhdEditing=this.isFhdPoint=!1;break;case"isShapeInserted":this.isShapeInserted=t.value.bool;break;case"redrawShape":this.redrawShape(t.value.obj);break;case"setTextBoxStylesToActObj":this.setTextBoxStylesToActObj();break;case"mouseDownEventHandler":this.mouseDownEventHandler(t.value.e);break;case"mouseMoveEventHandler":this.mouseMoveEventHandler(t.value.e);break;case"mouseUpEventHandler":this.mouseUpEventHandler(t.value.e);break;case"canvasMouseDownHandler":this.canvasMouseDownHandler(t.value.e);break;case"canvasMouseMoveHandler":this.canvasMouseMoveHandler(t.value.e);break;case"canvasMouseUpHandler":this.canvasMouseUpHandler(t.value.e);break;case"touchStartHandler":this.touchStartHandler(t.value.e);break;case"keyDownEventHandler":this.keyDownEventHandler(t.value.e);break;case"handleScroll":this.handleScroll(t.value.e);break;case"textKeyDown":setTimeout(this.textKeyDown.bind(this),1,t.value.e);break;case"deleteItem":this.deleteItem();break;case"updatePrevShapeSettings":this.updatePrevShapeSettings(t.value.obj);break;case"getZoomType":t.value.obj.zoomType=this.zoomType;break;case"setZoomType":this.zoomType=t.value.zoomType;break;case"setInitialTextEdit":this.isInitialTextEdited=t.value.bool;break;case"setDragCanvas":this.dragCanvas=t.value.bool;break;case"setFreehandDrawCustomized":this.isFhdCustomized=t.value.isFreehandDrawCustomized;break;case"setTouchEndPoint":this.touchEndPoint.x=t.value.x,this.touchEndPoint.y=t.value.y;break;case"getPanDown":t.value.obj.panDown=this.panDown;break;case"setPanDown":this.panDown=t.value.panDown;break;case"getFreehandDrawEditing":t.value.obj.bool=this.isFhdEditing;break;case"setFreehandDrawEditing":this.isFhdEditing=t.value.bool;break;case"getTempActObj":t.value.obj.tempObj=this.tempActiveObj;break;case"setTempActObj":this.tempActiveObj=t.value.obj;break;case"isInside":this.isInside(t.value.x,t.value.y,t.value.z1,t.value.z2,t.value.z3,t.value.z4);break;case"setDragElement":this.dragElement=t.value.value;break;case"setObjSelected":this.isObjSelected=t.value.bool;break;case"adjustActObjForLineArrow":this.adjustActObjForLineArrow(t.value.obj);break;case"findTarget":this.findTarget(t.value.x,t.value.y,t.value.type);break;case"getCurrentFlipState":this.getCurrentFlipState();break;case"setDragWidth":this.setDragWidth(t.value.width);break;case"setDragHeight":this.setDragHeight(t.value.setDragHeight);break;case"annotate":this.currentDrawingShape=t.value.shape,t.value.shape==="text"?(e.activeObj.textSettings.fontSize=11,e.activeObj.keyHistory="Enter Text",e.notify("shape",{prop:"initializeTextShape",onPropertyChange:!1,value:{text:null,fontFamily:null,fontSize:null,bold:null,italic:null,strokeColor:null}})):t.value.shape==="path"&&(e.activeObj.pointColl=[]);break;case"getCurrentDrawingShape":t.value.obj.shape=this.currentDrawingShape;break;case"setCurrentDrawingShape":this.currentDrawingShape=t.value.value;break;case"getTransRotationPoint":this.getTransRotationPoint(t.value.obj,t.value.object);break;case"adjustNEPoints":this.adjustNEPoints(t.value.rectangle,t.value.x,t.value.y,t.value.angle);break;case"adjustRotationPoints":this.adjustRotationPoints(t.value.rectangle,t.value.x,t.value.y,t.value.angle,t.value.type,t.value.elem);break;case"getResizeDirection":this.getResizeDirection(t.value.rectangle,t.value.x,t.value.y,t.value.angle);break;case"setResizedElement":this.resizedElement=t.value.value;break;case"reset":this.reset();break;case"unWireEvent":this.unwireEvent();break;case"updPtCollForShpRot":this.updPtCollForShpRot(t.value.obj);break;case"findImageRatio":this.findImageRatio(t.value.width,t.value.height,t.value.obj);break;case"getNumTextValue":this.getNumTextValue(t.value.obj);break;case"setImageClarity":this.isImageClarity=t.value.bool;break;case"upgradeImageQuality":this.upgradeImageQuality();break;case"triggerShapeChange":this.triggerShapeChange(t.value.shapeResizingArgs,t.value.shapeMovingArgs,t.value.type);break;case"applyTransformToImg":this.applyTransformToImg(t.value.ctx);break;case"findTargetObj":t.value.obj.bool=this.findTargetObj(t.value.x,t.value.y,t.value.isCrop);break;case"setSliding":this.isSliding=t.value.bool;break;case"setSliderActive":this.isSliderActive=t.value.bool;break;case"getArrowType":t.value.obj.type=this.getArrowType(t.value.type);break;case"setArrowShape":t.value.type==="initial"?this.arrowShape[0]=t.value.shape:this.arrowShape[1]=t.value.shape;break;case"updateNWPoints":this.updateNWPoints(t.value.x,t.value.y);break;case"updateNPoints":this.updateNPoints(t.value.x,t.value.y);break;case"updateNEPoints":this.updateNEPoints(t.value.x,t.value.y);break;case"updateWPoints":this.updateWPoints(t.value.x,t.value.y);break;case"updateEPoints":this.updateEPoints(t.value.x,t.value.y);break;case"updateSWPoints":this.updateSWPoints(t.value.x,t.value.y);break;case"updateSPoints":this.updateSPoints(t.value.x,t.value.y);break;case"updateSEPoints":this.updateSEPoints(t.value.x,t.value.y);break;case"drawMaskCircle":this.drawMaskCircle(t.value.x,t.value.y);break;case"isValueUpdated":this.isValueUpdated();break;case"getDistance":this.getDistance(t.value.x,t.value.y);break;case"redact":this.currentDrawingShape=t.value.shape;break;case"updateTransColl":t.value.obj.coll=this.updateTransColl(t.value.object);break;case"getTransformedShape":t.value.obj.bool=this.isTransformedShape;break;case"setTransformedShape":this.isTransformedShape=t.value.bool;break;case"rgbToHex":this.rgbToHex(t.value.r,t.value.g,t.value.b,t.value.a);break;case"padLeft":this.padLeft(t.value.value,t.value.length,t.value.padChar);break;case"setTimer":this.setTimer(t.value.e);break;case"targetTouches":t.value.output=this.targetTouches(t.value.touches);break;case"calculateScale":t.value.output=this.calculateScale(t.value.startTouches,t.value.endTouches);break;case"beforeSaveEvent":this.beforeSaveEvent(t.value.args,t.value.e);break;case"isKeyBoardCrop":t.value.output=this.isKeyBoardCrop(t.value.e);break;case"focusRatioBtn":this.focusRatioBtn();break;case"performEnterAction":this.performEnterAction(t.value.e);break;case"getImagePoints":t.value.output=this.getImagePoints(t.value.x,t.value.y);break;case"revertPoints":this.revertPoints(t.value.actPoint,t.value.tempActiveObj);break;case"performNWResize":this.performNWResize(t.value.x,t.value.y,t.value.tempActiveObj,t.value.actPoint);break;case"performSEResize":this.performSEResize(t.value.x,t.value.y,t.value.tempActiveObj,t.value.actPoint);break;case"isMouseOutsideImg":t.value.output=this.isMouseOutsideImg(t.value.x,t.value.y);break}},l.prototype.getModuleName=function(){return"selection"},l.prototype.updatePrivateVariables=function(){var t=this.parent;t.lowerCanvas&&(this.lowerContext=t.lowerCanvas.getContext("2d")),t.upperCanvas&&(this.upperContext=t.upperCanvas.getContext("2d"))},l.prototype.reset=function(){this.diffPoint={x:0,y:0},this.oldPoint={},this.isTouch=this.isObjSelected=this.isFhdPoint=this.isShapeInserted=!1,this.dragPoint={startX:0,startY:0,endX:0,endY:0},this.tempActiveObj={activePoint:{startX:0,startY:0,endX:0,endY:0,width:0,height:0},flipObjColl:[],triangle:[],triangleRatio:[],order:null},this.isFirstMove=!1,this.cursorTargetId=this.dragElement="",this.isTouchDblClick=!1,this.startTouches=[],this.tempTouches=[],this.currMousePoint={x:0,y:0},this.isPreventDragging=!1,this.timer=void 0,this.tempObjColl=void 0,this.mouseWheel=0,this.textRow=1,this.mouseDownPoint={x:0,y:0},this.previousPoint={x:0,y:0},this.zoomType="Toolbar",this.isInitialTextEdited=!1,this.dragCanvas=this.isPinching=!1,this.isFhdCustomized=!1,this.touchEndPoint={},this.panDown=null,this.isSliding=!1,this.isFhdEditing=!1,this.pathAdjustedIndex=null,this.touchTime=0,this.isImageClarity=!0,this.currentDrawingShape="",this.initialPrevObj={},this.resizedElement="",this.mouseDown="",this.isSliderActive=!1,this.arrowShape=[Fi.None,Fi.SolidArrow],this.isMouseDown=this.isMouseUp=this.isTransformedShape=!1},l.prototype.performTabAction=function(){var t=this.parent;if(t.textArea.style.display==="block"||t.textArea.style.display==="inline-block"){var e=this.applyCurrShape(!1);t.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:null}}),e&&t.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}})}t.isKBDNavigation=!0},l.prototype.selMouseUpEvent=function(){this.oldPoint.x=void 0,this.oldPoint.y=void 0},l.prototype.getMouseCursor=function(t,e,i,r,o){var a=this.getTransRotationPoint(t),n=t.bottomCenterCircle.radius,s="default",h=o?0:t.topLeftCircle.radius*2;return e>=t.topLeftCircle.startX-h&&e<=t.topLeftCircle.startX+h&&i>=t.topLeftCircle.startY-h&&i<=t.topLeftCircle.startY+h?s="nw-resize":e>=t.topLeftCircle.startX-h&&e<=t.topRightCircle.startX-h&&i>=t.topCenterCircle.startY-h&&i<=t.topCenterCircle.startY+h?s="n-resize":e>=t.topRightCircle.startX-h&&e<=t.topRightCircle.startX+h&&i>=t.topRightCircle.startY-h&&i<=t.topRightCircle.startY+h?s="ne-resize":e>=t.centerLeftCircle.startX-h&&e<=t.centerLeftCircle.startX+h&&i>=t.topLeftCircle.startY-h&&i<=t.bottomLeftCircle.startY-h?s="w-resize":e>=t.centerRightCircle.startX-h&&e<=t.centerRightCircle.startX+h&&i>=t.topRightCircle.startY-h&&i<=t.bottomRightCircle.startY-h?s="e-resize":e>=t.bottomLeftCircle.startX-h&&e<=t.bottomLeftCircle.startX+h&&i>=t.bottomLeftCircle.startY-h&&i<=t.bottomLeftCircle.startY+h?s="sw-resize":e>=t.bottomLeftCircle.startX-h&&e<=t.bottomRightCircle.startX-h&&i>=t.bottomCenterCircle.startY-h&&i<=t.bottomCenterCircle.startY+h?s="s-resize":e>=t.bottomRightCircle.startX-h&&e<=t.bottomRightCircle.startX+h&&i>=t.bottomRightCircle.startY-h&&i<=t.bottomRightCircle.startY+h?s="se-resize":e>=t.activePoint.startX&&e<=t.activePoint.endX&&i>=t.activePoint.startY&&i<=t.activePoint.endY?r?s="grab":s="move":a&&!o&&e>=a.x-(n+2)&&e<=a.x+(n+2)&&i>=a.y-(n+2)&&i<=a.y+(n+2)?s="grabbing":s="default",s},l.prototype.setCursor=function(t,e){var i=this.parent;i.upperCanvas.style.cursor=i.cursor="default";var r={bool:null};if(i.notify("toolbar",{prop:"getFrameToolbar",onPropertyChange:!1,value:{obj:r}}),i.isResize||this.isSliding||r.bool){i.upperCanvas.style.cursor="default";return}var o=!1,a;if(i.activeObj.shape&&(a=i.activeObj.shape.split("-")),(!a&&i.currObjType.isCustomCrop||a&&a[0]==="crop")&&(o=!0),i.currObjType.isDragging){this.dragElement===""?i.upperCanvas.style.cursor=i.cursor="move":i.upperCanvas.style.cursor=i.cursor=this.dragElement;return}if(i.togglePen){i.upperCanvas.style.cursor=i.cursor="crosshair",i.isMaskImage&&(this.drawMaskCircle(t,e),i.upperCanvas.style.cursor="none");return}if(i.activeObj.shape&&this.setCursorForActObj(a,o,t,e),i.cursor==="default"||i.cursor==="grab"){for(var n=this.getHighestOrder(),s=y([],i.shapeColl,[],!0),h=y([],i.objColl,[],!0),p=!1;n>0;){p=!1;for(var u=s.length-1;u>=0;u--)if(s[u].order===n)if(p=!0,s[u].id&&s[u].id.indexOf("pen")>-1){if(i.pointColl[0]&&(i.cursor!=="grab"||!o)&&!i.currObjType.isDragging&&!i.currObjType.isResize){var c=y([],i.points,[],!0);o||this.setCursorForFreehandDrawing(t,e,i.upperCanvas,s[u].id),i.points=c}}else{i.objColl=[],i.objColl.push(y({},s[u],null,!0));var f=i.upperCanvas.style.cursor;i.objColl.length>0&&(i.cursor!=="grab"||!o)&&this.setCursorFromObj(t,e,i.objColl,i.upperCanvas,o),f==="grab"&&i.cursor==="default"&&(i.upperCanvas.style.cursor=i.cursor="grab")}else d(s[u].order)&&(p=!0);if(i.cursor!=="default"&&i.cursor!=="grab")break;if(p)for(var g=!1;!g&&n>0;){for(var v=0;v<s.length;v++)if(s[v].order===n-1){g=!0;break}n--,g||n--}}i.objColl=h,(i.cursor==="default"||i.cursor==="grab")&&i.togglePan&&(i.lowerCanvas.style.cursor=i.upperCanvas.style.cursor=i.cursor="grab")}this.currentDrawingShape!==""&&(i.cursor==="default"||i.cursor==="grab")&&(i.upperCanvas.style.cursor=i.cursor="crosshair")},l.prototype.getHighestOrder=function(){for(var t=0,e=0;e<this.parent.shapeColl.length;e++)this.parent.shapeColl[e].order>t&&(t=this.parent.shapeColl[e].order);return t},l.prototype.drawMaskCircle=function(t,e){var i=this.parent;if(i.isMaskImage){var r=i.activeObj.strokeSettings.strokeWidth*2,o=i.maskCanvas.getContext("2d");o.clearRect(0,0,i.maskCanvas.width,i.maskCanvas.height),o.fillStyle=i.activeObj.strokeSettings.strokeColor,o.strokeStyle="#fff",o.beginPath(),o.ellipse(t,e,r/2,r/2,0,0,2*Math.PI,!1),o.fill(),o.stroke(),o.closePath(),i.maskCanvas.style.cursor="none"}},l.prototype.setCursorForActObj=function(t,e,i,r){var o=this.parent;if(o.activeObj.horTopLine!==void 0){o.activeObj.shape!==void 0&&(t=o.activeObj.shape.split("-")),(t===void 0&&o.currObjType.isCustomCrop||t!==void 0&&t[0]==="crop")&&(e=!0),!e&&o.togglePan&&(o.lowerCanvas.style.cursor=o.upperCanvas.style.cursor=o.cursor="grab");var a=o.upperCanvas.style.cursor,n=y({},o.activeObj,{},!0);if(this.cursorTargetId=n.currIndex,n.shapeDegree===0?o.transform.degree:o.transform.degree-n.shapeDegree,n.shape==="line"||n.shape==="arrow")this.setCursorForLineArrow(n,i,r,o.upperCanvas);else if(n.shape==="path")this.setCursorForPath(n,i,r,o.upperCanvas);else if(!d(n.rotatedAngle)&&n.rotatedAngle!==0)this.setCursorForRotatedObject(n,i,r,o.upperCanvas);else{o.upperCanvas.style.cursor=o.cursor=this.getMouseCursor(n,i,r,e,!1);var s=["n-resize","s-resize","e-resize","w-resize"];n.shape==="text"&&s.indexOf(o.cursor)>-1&&(o.upperCanvas.style.cursor=o.cursor="move")}a==="default"&&o.cursor==="default"&&e&&(o.upperCanvas.style.cursor=o.cursor="grab"),a==="grab"&&o.cursor==="default"&&(o.upperCanvas.style.cursor=o.cursor="grab")}else o.togglePan&&!o.togglePen?o.lowerCanvas.style.cursor=o.upperCanvas.style.cursor=o.cursor="grab":o.currObjType.isCustomCrop||o.togglePen?o.upperCanvas.style.cursor=o.cursor="crosshair":o.upperCanvas.style.cursor=o.cursor="default"},l.prototype.setCursorForPath=function(t,e,i,r){this.setCursorForLineArrow(t,e,i,r);var o=this.parent;if(o.cursor==="default")for(var a=y({},t,null,!0),n=!1,s=1,h=t.pointColl.length;s<h&&!n;s++){a.activePoint.startX=t.pointColl[s-1].x,a.activePoint.startY=t.pointColl[s-1].y,a.activePoint.endX=t.pointColl[s].x,a.activePoint.endY=t.pointColl[s].y,o.notify("shape",{prop:"setPointCollForLineArrow",onPropertyChange:!1,value:{obj:a}});for(var p=t.topLeftCircle.radius,u=0,c=a.pointColl.length;u<c;u++){var f=a.pointColl[u];if(!d(f.x-p*2)&&!d(f.x+p*2)&&!d(f.y-p*2)&&!d(f.y+p*2)&&e>=f.x-p*2&&e<=f.x+p*2&&i>=f.y-p*2&&i<=f.y+p*2){r.style.cursor=o.cursor="move",n=!0;break}else r.style.cursor=o.cursor="default"}}return o.cursor},l.prototype.setCursorForLineArrow=function(t,e,i,r){var o,a=t.topLeftCircle.radius;if(d(t.pointColl))return o;for(var n=0,s=t.pointColl.length;n<s;n++){var h=t.pointColl[n];if(e>=h.x-a*2&&e<=h.x+a*2&&i>=h.y-a*2&&i<=h.y+a*2){r.style.cursor=this.parent.cursor="move",o=n;break}else r.style.cursor=this.parent.cursor="default"}return o},l.prototype.setCursorForRotatedObject=function(t,e,i,r){this.resizedElement="";var o=this.parent,a=t.bottomCenterCircle.radius,n=t.horTopLinePointColl[Math.round(t.horTopLinePointColl.length/2)],s=t.horTopLinePointColl[Math.round(t.horTopLinePointColl.length-1)],h=t.verLeftLinePointColl[Math.round(t.verLeftLinePointColl.length/2)],p=t.verRightLinePointColl[Math.round(t.verRightLinePointColl.length/2)],u=t.horBottomLinePointColl[Math.round(t.horBottomLinePointColl.length/2)],c=t.horBottomLinePointColl[Math.round(t.horBottomLinePointColl.length-1)],f=t.rotationCirclePointColl,g=t.horTopLinePointColl[0],v=t.horBottomLinePointColl[0];if(e>=g.x-(a+2)&&e<=g.x+(a+2)&&i>=g.y-(a+2)&&i<=g.y+(a+2))r.style.cursor=o.cursor="nw-resize";else if(e>=n.x-5&&e<=n.x+5&&i>=n.y-5&&i<=n.y+5)r.style.cursor=o.cursor=this.resizedElement="n-resize";else if(e>=s.x-(a+2)&&e<=s.x+(a+2)&&i>=s.y-(a+2)&&i<=s.y+(a+2))r.style.cursor=o.cursor="ne-resize";else if(e>=h.x-5&&e<=h.x+5&&i>=h.y-5&&i<=h.y+5)r.style.cursor=o.cursor=this.resizedElement="w-resize";else if(e>=p.x-5&&e<=p.x+5&&i>=p.y-5&&i<=p.y+5)r.style.cursor=o.cursor=this.resizedElement="e-resize";else if(e>=v.x-(a+2)&&e<=v.x+(a+2)&&i>=v.y-(a+2)&&i<=v.y+(a+2))r.style.cursor=o.cursor="sw-resize";else if(e>=u.x-5&&e<=u.x+5&&i>=u.y-5&&i<=u.y+5)r.style.cursor=o.cursor=this.resizedElement="s-resize";else if(e>=c.x-(a+2)&&e<=c.x+(a+2)&&i>=c.y-(a+2)&&i<=c.y+(a+2))r.style.cursor=o.cursor="se-resize";else if(f&&e>=f.x-(a+2)&&e<=f.x+(a+2)&&i>=f.y-(a+2)&&i<=f.y+(a+2))r.style.cursor=o.cursor="grabbing";else{r.style.cursor=o.cursor="default";var m=this.getRectanglePoints(t.activePoint.startX,t.activePoint.startY,t.activePoint.width,t.activePoint.height,t.rotatedAngle*(180/Math.PI),e,i);m&&(r.style.cursor=o.cursor="move")}if(o.cursor==="default")for(var C=0,M=t.horTopLinePointColl.length;C<M;C++){var I=t.horTopLinePointColl[C];if(e>=I.x-5&&e<=I.x+5&&i>=I.y-5&&i<=I.y+5){r.style.cursor=o.cursor=this.resizedElement="n-resize";break}}if(o.cursor==="default")for(var C=0,M=t.horBottomLinePointColl.length;C<M;C++){var N=t.horBottomLinePointColl[C];if(e>=N.x-5&&e<=N.x+5&&i>=N.y-5&&i<=N.y+5){r.style.cursor=o.cursor=this.resizedElement="s-resize";break}}if(o.cursor==="default")for(var C=0,M=t.verLeftLinePointColl.length;C<M;C++){var O=t.verLeftLinePointColl[C];if(e>=O.x-5&&e<=O.x+5&&i>=O.y-5&&i<=O.y+5){r.style.cursor=o.cursor=this.resizedElement="w-resize";break}}if(o.cursor==="default")for(var C=0,M=t.verRightLinePointColl.length;C<M;C++){var x=t.verRightLinePointColl[C];if(e>=x.x-5&&e<=x.x+5&&i>=x.y-5&&i<=x.y+5){r.style.cursor=o.cursor=this.resizedElement="e-resize";break}}return this.adjustCursorStylesForRotatedState(t),o.cursor},l.prototype.adjustCursorStylesForRotatedState=function(t){var e=this.parent,i=t.rotatedAngle*(180/Math.PI);if(i=i>0?Math.floor(i):Math.ceil(i),i>=92&&i<=182||i>=-178&&i<=-88){var r={"nw-resize":"ne-resize","n-resize":"s-resize","ne-resize":"nw-resize","w-resize":"e-resize","e-resize":"w-resize","sw-resize":"se-resize","s-resize":"n-resize","se-resize":"sw-resize"};e.cursor in r&&(e.cursor=r[e.cursor])}return e.upperCanvas.style.cursor=this.getResizeElement(t.rotatedAngle*(180/Math.PI),e.cursor),e.cursor},l.prototype.getResizeElement=function(t,e){var i=[];switch(e){case"nw-resize":i=[[337.5,22.5,"nw-resize"],[22.5,67.5,"n-resize"],[67.5,112.5,"ne-resize"],[112.5,157.5,"e-resize"],[157.5,202.5,"se-resize"],[202.5,247.5,"s-resize"],[247.5,292.5,"sw-resize"],[292.5,337.5,"w-resize"]];break;case"n-resize":i=[[337.5,22.5,"n-resize"],[22.5,67.5,"ne-resize"],[67.5,112.5,"e-resize"],[112.5,157.5,"se-resize"],[157.5,202.5,"s-resize"],[202.5,247.5,"sw-resize"],[247.5,292.5,"w-resize"],[292.5,337.5,"nw-resize"]];break;case"ne-resize":i=[[337.5,22.5,"ne-resize"],[22.5,67.5,"e-resize"],[67.5,112.5,"se-resize"],[112.5,157.5,"s-resize"],[157.5,202.5,"sw-resize"],[202.5,247.5,"w-resize"],[247.5,292.5,"nw-resize"],[292.5,337.5,"n-resize"]];break;case"e-resize":i=[[337.5,22.5,"e-resize"],[22.5,67.5,"se-resize"],[67.5,112.5,"s-resize"],[112.5,157.5,"sw-resize"],[157.5,202.5,"w-resize"],[202.5,247.5,"nw-resize"],[247.5,292.5,"n-resize"],[292.5,337.5,"ne-resize"]];break;case"se-resize":i=[[337.5,22.5,"se-resize"],[22.5,67.5,"s-resize"],[67.5,112.5,"sw-resize"],[112.5,157.5,"w-resize"],[157.5,202.5,"nw-resize"],[202.5,247.5,"n-resize"],[247.5,292.5,"ne-resize"],[292.5,337.5,"e-resize"]];break;case"s-resize":i=[[337.5,22.5,"s-resize"],[22.5,67.5,"sw-resize"],[67.5,112.5,"w-resize"],[112.5,157.5,"nw-resize"],[157.5,202.5,"n-resize"],[202.5,247.5,"ne-resize"],[247.5,292.5,"e-resize"],[292.5,337.5,"se-resize"]];break;case"sw-resize":i=[[337.5,22.5,"sw-resize"],[22.5,67.5,"w-resize"],[67.5,112.5,"nw-resize"],[112.5,157.5,"n-resize"],[157.5,202.5,"ne-resize"],[202.5,247.5,"e-resize"],[247.5,292.5,"se-resize"],[292.5,337.5,"s-resize"]];break;case"w-resize":i=[[337.5,22.5,"w-resize"],[22.5,67.5,"nw-resize"],[67.5,112.5,"n-resize"],[112.5,157.5,"ne-resize"],[157.5,202.5,"e-resize"],[202.5,247.5,"se-resize"],[247.5,292.5,"s-resize"],[292.5,337.5,"sw-resize"]];break}for(var r=t<0?360-Math.abs(t):t,o=0,a=i;o<a.length;o++){var n=a[o],s=n[0],h=n[1],p=n[2];if(r>s&&r<=h||r+360>s&&r+360<=h)return p}return e},l.prototype.setCursorForFreehandDrawing=function(t,e,i,r){var o=i.getContext("2d"),a=this.parent,n=document.querySelector("#"+a.element.id+"_textArea"),s=!1;a.notify("freehand-draw",{prop:"setFreehandDrawHoveredIndex",onPropertyChange:!1,value:{index:-1}});for(var h,p=0;p<a.freehandCounter;p++)if(!(r&&r!==a.pointColl[p].id)){var u={selPointColl:{}};a.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:u}}),h=y([],u.selPointColl[p].points,[]),a.points=y([],a.pointColl[p].points,[]);var c=a.pointColl[p];a.notify("freehand-draw",{prop:"setPointCounter",onPropertyChange:!1,value:{value:0}});for(var f=h.length,g=0;g<f;g++)if(g!==0){var v=!1;if(h[g-1]&&h[g]&&(v=this.isInside(t,e,h[g-1].x,h[g-1].y,h[g].x,h[g].y)),v){this.isFhdPoint=!0,a.notify("freehand-draw",{prop:"setFreehandDrawHoveredIndex",onPropertyChange:!1,value:{index:p}}),a.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:null,strokeWidth:null}}),i.style.cursor=a.cursor="pointer",s=!0;break}else if(!this.isFhdEditing||c.isSelected){if((this.isFhdPoint||this.isFhdEditing)&&(o.clearRect(0,0,i.width,i.height),a.activeObj.shape&&n.style.display==="none"&&a.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:a.activeObj}})),this.isFhdEditing){var m={freehandSelectedIndex:-1};a.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:m}});var C=a.pointColl[m.freehandSelectedIndex].strokeColor,M=a.pointColl[m.freehandSelectedIndex].strokeWidth;a.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:C,strokeWidth:M}})}else a.notify("freehand-draw",{prop:"setFreehandDrawHoveredIndex",onPropertyChange:!1,value:{index:null}});this.isFhdPoint=!1}}else{var I=a.points[g];if(t>I.x-c.strokeWidth&&t<I.x+c.strokeWidth&&e>I.y-c.strokeWidth&&e<I.y+c.strokeWidth){this.isFhdPoint=!0,a.notify("freehand-draw",{prop:"setFreehandDrawHoveredIndex",onPropertyChange:!1,value:{index:p}}),a.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:null,strokeWidth:null}}),i.style.cursor=a.cursor="pointer",s=!0;break}else if(!this.isFhdEditing||c.isSelected){if((this.isFhdPoint||this.isFhdEditing)&&(o.clearRect(0,0,i.width,i.height),a.activeObj.shape&&n.style.display==="none"&&a.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:a.activeObj}})),this.isFhdEditing){var m={freehandSelectedIndex:-1};a.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:m}});var C=a.pointColl[m.freehandSelectedIndex].strokeColor,M=a.pointColl[m.freehandSelectedIndex].strokeWidth;a.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:C,strokeWidth:M}})}this.isFhdPoint=!1}}if(s)break}},l.prototype.setCursorFromObj=function(t,e,i,r,o){for(var a=this.parent,n=0,s=i.length;n<s;n++){if(a.cursor==="move")return;var h=y({},i[n],{},!0);if(h.activePoint.width===0&&h.activePoint.height===0){i.splice(n,1);return}this.cursorTargetId=h.currIndex,h.shape==="line"||h.shape==="arrow"?this.setCursorForLineArrow(h,t,e,r):h.shape==="path"?this.setCursorForPath(h,t,e,r):!d(h.rotatedAngle)&&h.rotatedAngle!==0?this.setCursorForRotatedObject(h,t,e,r):r.style.cursor=a.cursor=this.getMouseCursor(h,t,e,o,!0)}},l.prototype.isInside=function(t,e,i,r,o,a){var n=Math.min(i,o),s=Math.max(i,o),h=Math.min(r,a),p=Math.max(r,a);return n<=t&&t<=s&&h<=e&&e<=p},l.prototype.preventResizing=function(t){var e=this.parent;if(e.activeObj.preventShapeDragOut&&this.isShapeDragOut()){var i=e.activeObj.activePoint;i.startX=t.activePoint.startX,i.startY=t.activePoint.startY,i.endX=t.activePoint.endX,i.endY=t.activePoint.endY,i.width=t.activePoint.width,i.height=t.activePoint.height,e.activeObj.rotatedAngle=t.rotatedAngle,e.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:i,obj:e.activeObj,isMouseMove:null,x:null,y:null}})}},l.prototype.updateActivePoint=function(t,e,i){var r=this.parent,o={width:0,height:0},a=r.activeObj.activePoint,n=a.startX,s=a.startY,h=r.activeObj.activePoint,p=h.width,u=h.height;r.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:p,height:u,obj:o,isImgShape:null}});var c=this.updatePrevShapeSettings(),f={cancel:!1,action:"resize",previousShapeSettings:c,allowShapeOverflow:this.allowOutofBound()},g={cancel:!1,action:"move",previousShapeSettings:c,allowShapeOverflow:this.allowOutofBound()};if(this.shapeResizingArgs=f,this.shapeMovingArgs=g,r.activeObj.shape==="text"&&this.dragElement!==""&&r.notify("shape",{prop:"updateFontRatio",onPropertyChange:!1,value:{obj:r.activeObj,isTextArea:null}}),this.currentDrawingShape!==""&&(this.dragElement===""||this.dragElement==="move")&&r.isShapeDrawing){var v=["line","arrow","path"];v.indexOf(r.activeObj.shape)>-1?this.dragElement="e-resize":t>n&&e>s?this.dragElement="se-resize":t<n&&e>s?this.dragElement="sw-resize":t>n&&e<s?this.dragElement="ne-resize":t<n&&e<s&&(this.dragElement="nw-resize")}r.activeObj.shape==="arrow"&&(Math.atan2(t-r.lowerCanvas.width/2,e-r.lowerCanvas.height/2)>0?r.activeObj.rotatedAngle=-Math.atan2(t-r.lowerCanvas.width/2,e-r.lowerCanvas.height/2):r.activeObj.rotatedAngle=Math.abs(Math.atan2(t-r.lowerCanvas.width/2,e-r.lowerCanvas.height/2)));var m,C=!1,M=!1;if(!(i&&r.transform.straighten!==0&&this.isMouseOutsideImg(t,e))){var I=y({},r.activeObj,{},!0),N,O;switch(r.activeObj.shape!==void 0&&(N=r.activeObj.shape.split("-")),N!==void 0&&N[0]==="crop"&&(O=!0),this.dragElement.toLowerCase()){case"nw-resize":this.updateNWPoints(t,e),this.preventResizing(I),r.notify("shape",{prop:"updateArrowDirection",onPropertyChange:!1,value:{obj:r.activeObj,flip:null,rotatedDegree:null}}),this.triggerShapeChange(f,g,"resize");break;case"n-resize":this.updateNPoints(t,e),this.preventResizing(I),r.notify("shape",{prop:"updateArrowDirection",onPropertyChange:!1,value:{obj:r.activeObj,flip:null,rotatedDegree:null}}),this.triggerShapeChange(f,g,"resize");break;case"ne-resize":this.updateNEPoints(t,e),this.preventResizing(I),r.notify("shape",{prop:"updateArrowDirection",onPropertyChange:!1,value:{obj:r.activeObj,flip:null,rotatedDegree:null}}),this.triggerShapeChange(f,g,"resize");break;case"w-resize":this.updateWPoints(t,e),this.preventResizing(I),r.notify("shape",{prop:"updateArrowDirection",onPropertyChange:!1,value:{obj:r.activeObj,flip:null,rotatedDegree:null}}),this.triggerShapeChange(f,g,"resize");break;case"e-resize":this.updateEPoints(t,e),this.preventResizing(I),r.notify("shape",{prop:"updateArrowDirection",onPropertyChange:!1,value:{obj:r.activeObj,flip:null,rotatedDegree:null}}),this.triggerShapeChange(f,g,"resize");break;case"sw-resize":this.updateSWPoints(t,e),this.preventResizing(I),r.notify("shape",{prop:"updateArrowDirection",onPropertyChange:!1,value:{obj:r.activeObj,flip:null,rotatedDegree:null}}),this.triggerShapeChange(f,g,"resize");break;case"s-resize":this.updateSPoints(t,e),this.preventResizing(I),r.notify("shape",{prop:"updateArrowDirection",onPropertyChange:!1,value:{obj:r.activeObj,flip:null,rotatedDegree:null}}),this.triggerShapeChange(f,g,"resize");break;case"se-resize":this.updateSEPoints(t,e),this.preventResizing(I),r.notify("shape",{prop:"updateArrowDirection",onPropertyChange:!1,value:{obj:r.activeObj,flip:null,rotatedDegree:null}}),this.triggerShapeChange(f,g,"resize");break;case"grabbing":Math.atan2(t-(n+p/2),e-(s+u/2))>0?r.activeObj.rotatedAngle=-Math.atan2(t-(n+p/2),e-(s+u/2)):r.activeObj.rotatedAngle=Math.abs(Math.atan2(t-(n+p/2),e-(s+u/2))),r.activeObj.shapeDegree===0?m=r.transform.degree:m=r.transform.degree-r.activeObj.shapeDegree,m<0&&(m=360+m);for(var x=0,D=r.activeObj.flipObjColl.length;x<D;x++)r.activeObj.flipObjColl[x].toLowerCase()==="horizontal"?C=!0:r.activeObj.flipObjColl[x].toLowerCase()==="vertical"&&(M=!0);r.activeObj.rotatedAngle-=m*(Math.PI/180),m===0||m===360?M&&(r.activeObj.rotatedAngle-=180*(Math.PI/180)):m===90||m===-270?C&&(r.activeObj.rotatedAngle-=180*(Math.PI/180)):m===180||m===-180?M&&(r.activeObj.rotatedAngle-=180*(Math.PI/180)):(m===270||m===-90)&&C&&(r.activeObj.rotatedAngle-=180*(Math.PI/180)),this.preventResizing(I);break;case"pathdrag":d(this.pathAdjustedIndex)||(r.activeObj.pointColl[this.pathAdjustedIndex].x=t,r.activeObj.pointColl[this.pathAdjustedIndex].y=e);break;default:if(!i&&!r.currObjType.isCustomCrop){var A=r.activeObj.activePoint;if(this.dragPoint.startX){var P=this.dragPoint.endX-this.previousPoint.x,V=this.dragPoint.endY-this.previousPoint.y;if(A.startX+=P,A.endX+=P,A.startY+=V,A.endY+=V,n=A.startX,s=A.startY,r.activeObj.shape!=="line"&&r.activeObj.shape!=="arrow"&&r.activeObj.rotationCirclePointColl&&(r.activeObj.rotationCirclePointColl.x+=P,r.activeObj.rotationCirclePointColl.y+=V,r.activeObj.rotationCirclePoint.x+=P,r.activeObj.rotationCirclePoint.y+=V),r.activeObj.shape==="path")for(var x=0,D=r.activeObj.pointColl.length;x<D;x++)r.activeObj.pointColl[x].x+=P,r.activeObj.pointColl[x].y+=V;if(!this.isPreventDragging&&this.isShapeDragOut()&&(r.activeObj.preventShapeDragOut||r.activeObj.shape==="redact"||O)){if(A.startX-=P,A.endX-=P,A.startY-=V,A.endY-=V,r.activeObj.shape!=="line"&&r.activeObj.shape!=="arrow"&&r.activeObj.rotationCirclePointColl)r.activeObj.rotationCirclePointColl.x-=P,r.activeObj.rotationCirclePointColl.y-=V,r.activeObj.rotationCirclePoint.x-=P,r.activeObj.rotationCirclePoint.y-=V;else if(r.activeObj.shape==="path")for(var q=0,D=r.activeObj.pointColl.length;q<D;q++)r.activeObj.pointColl[q].x-=P,r.activeObj.pointColl[q].y-=V;if(r.activeObj.rotatedAngle===0){var re=r.activeObj.activePoint.endX,ae=r.activeObj.activePoint.endY;r.activeObj.shape==="path"&&(r.activeObj.activePoint=r.getSquarePointForPath(r.activeObj)),this.setDragWidth(P),this.setDragHeight(V);var E=r.activeObj,L=E.activePoint.endX-re,k=E.activePoint.endY-ae;if(E.shape==="path")for(var q=0,D=E.pointColl.length;q<D;q++)E.pointColl[q].x+=L,E.pointColl[q].y+=k}else r.notify("selection",{prop:"updPtCollForShpRot",onPropertyChange:!1,value:{obj:r.activeObj}})}}else A.startX=t<this.mouseDownPoint.x?t:this.mouseDownPoint.x,A.startY=e<this.mouseDownPoint.y?e:this.mouseDownPoint.y,t=t<this.mouseDownPoint.x?this.mouseDownPoint.x:t,e=e<this.mouseDownPoint.y?this.mouseDownPoint.y:e,A.endX=t,A.endY=e;this.triggerShapeChange(f,g,"move")}break}}},l.prototype.isShapeDragOut=function(){var t=this.parent,e=!1,i=!1,r=t.activeObj.shape;if((t.activeObj.preventShapeDragOut||t.activeObj.rotatedAngle===0&&r!=="line"&&r!=="arrow"&&r!=="path")&&(i=!0),i){var o=t.activeObj.activePoint,a=o.startX,n=o.startY,s=o.endX,h=o.endY;if(r==="path"){var p=t.getSquarePointForPath(t.activeObj);a=p.startX,n=p.startY,s=p.endX,h=p.endY}if(t.activeObj.rotatedAngle===0||r==="arrow")e=this.isObjOutsideImg(a,n,s,h,r);else{var u={isIntersect:null,arr:null};t.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),t.notify("draw",{prop:"isLinesIntersect",onPropertyChange:!1,value:{obj:u}}),u.arr[0]||u.arr[1]||u.arr[2]||u.arr[3]?e=!0:e=this.isObjOutsideImg(a,n,s,h,r)}}return e},l.prototype.isObjOutsideImg=function(t,e,i,r,o){var a=this.parent,n=a.img,s=n.destLeft,h=n.destTop,p=n.destWidth,u=n.destHeight;return t<s||e<h||i>s+p||r>h+u||(o==="line"||o==="arrow")&&(t>s+p||e>h+u||i<s||r<h)},l.prototype.triggerShapeChange=function(t,e,i){var r=this.parent,o=r.activeObj.activePoint;o.width=o.endX-o.startX,o.height=o.endY-o.startY;var a=this.updatePrevShapeSettings();if(!d(this.shapeResizingArgs)&&!d(this.shapeMovingArgs)?(t.currentShapeSettings=this.shapeResizingArgs.currentShapeSettings=a,e.currentShapeSettings=this.shapeMovingArgs.currentShapeSettings=a):(t.currentShapeSettings=a,e.currentShapeSettings=a),i==="resize"){this.isCropSelection=!1;var n=void 0;if(r.activeObj.shape!==void 0&&(n=r.activeObj.shape.split("-")),n!==void 0&&n[0]==="crop"&&(this.isCropSelection=!0),!this.isCropSelection)this.currentDrawingShape!==""&&r.upperCanvas.style.cursor==="crosshair"&&(t.action="drawing"),(!r.currObjType.isRedact||r.activeObj.shape!=="redact")&&r.trigger("shapeChanging",t),r.editCompleteArgs=t,this.isPreventShaping=t.cancel,r.notify("shape",{prop:"updateShapeChangeEventArgs",onPropertyChange:!1,value:{shapeSettings:t.currentShapeSettings,allowShapeOverflow:t.allowShapeOverflow}});else{this.isMouseDown?t.action="resize-start":this.isMouseUp&&(t.action="resize-end");var s={action:t.action,previousSelectionSettings:{type:r.getSelectionType(r.activeObj.shape),startX:t.previousShapeSettings.startX,startY:t.previousShapeSettings.startY,width:t.previousShapeSettings.width,height:t.previousShapeSettings.height},currentSelectionSettings:{type:r.getSelectionType(r.activeObj.shape),startX:t.currentShapeSettings.startX,startY:t.currentShapeSettings.startY,width:t.currentShapeSettings.width,height:t.currentShapeSettings.height}};this.selectionResizingArgs=s,r.trigger("selectionChanging",s),r.editCompleteArgs=s,r.notify("shape",{prop:"updSelChangeEventArgs",onPropertyChange:!1,value:{selectionSettings:s.currentSelectionSettings}})}}else i==="mouse-down"||i==="mouse-up"?(r.activeObj.shape!=="redact"&&r.trigger("shapeChanging",t),r.editCompleteArgs=t,this.isPreventShaping=t.cancel,r.notify("shape",{prop:"updateShapeChangeEventArgs",onPropertyChange:!1,value:{shapeSettings:t.currentShapeSettings,allowShapeOverflow:t.allowShapeOverflow}})):(r.activeObj.shape!=="redact"&&r.trigger("shapeChanging",e),r.editCompleteArgs=e,this.isPreventShaping=e.cancel,r.notify("shape",{prop:"updateShapeChangeEventArgs",onPropertyChange:!1,value:{shapeSettings:e.currentShapeSettings,allowShapeOverflow:e.allowShapeOverflow}}));r.eventType=i},l.prototype.setDragWidth=function(t){var e=this.parent,i=e.activeObj.activePoint,r=e.img,o=r.destLeft,a=r.destWidth,n=t,s=e.activeObj.shape,h=!1;if(e.activeObj.preventShapeDragOut&&(s==="line"||s==="arrow")&&(h=!0),n>=0)for(var p=0;p<n&&(t=n-p,i.startX+=t,i.endX+=t,!(i.startX>=o&&i.endX<=o+a&&!h||i.startX>=o&&i.endX<=o+a&&i.endX>=o&&i.startX<=o+a&&h));p++)i.startX-=t,i.endX-=t;else for(var p=1;p<Math.abs(n)&&(t=n+p,i.startX+=t,i.endX+=t,!(i.startX>=o&&i.endX<=o+a&&!h||i.startX>=o&&i.endX<=o+a&&i.endX>=o&&i.startX<=o+a&&h));p++)i.startX-=t,i.endX-=t},l.prototype.setDragHeight=function(t){var e=this.parent,i=e.activeObj.activePoint,r=e.img,o=r.destTop,a=r.destHeight,n=t,s=e.activeObj.shape,h=!1;if(e.activeObj.preventShapeDragOut&&(s==="line"||s==="arrow")&&(h=!0),n>=0)for(var p=1;p<n&&(t=n-p,i.startY+=t,i.endY+=t,!(i.startY>=o&&i.endY<=o+a&&!h||i.startY>=o&&i.endY<=o+a&&i.endY>=o&&i.startY<=o+a&&h));p++)i.startY-=t,i.endY-=t;else for(var p=0;p<Math.abs(n)&&(t=n+p,i.startY+=t,i.endY+=t,!(i.startY>=o&&i.endY<=o+a&&!h||i.startY>=o&&i.endY<=o+a&&i.endY>=o&&i.startY<=o+a&&h));p++)i.startY-=t,i.endY-=t},l.prototype.limitDrag=function(t){var e=!1,i=this.parent,r=i.img,o=r.destLeft,a=r.destTop,n=r.destWidth,s=r.destHeight,h=i.activeObj.activePoint,p=t?h.startX:h.endX,u=t?h.startY:h.endY,c=t?h.endX:h.startX,f=t?h.endY:h.startY,g=i.upperCanvas.width,v=i.upperCanvas.height,m=o<0?0:o,C=a<0?0:a,M=o+n>g?g:o+n,I=a+s>v?v:a+s;if(S.isDevice?(p<m&&(p=m),u<C&&(u=C),c>M&&(c=M),f>I&&(f=I)):(p<o&&(p=o),u<a&&(u=a),c>o+n&&(c=o+n),f>a+s&&(f=a+s)),i.transform.straighten!==0){var N={isIntersect:null,arr:null};i.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),i.notify("draw",{prop:"isLinesIntersect",onPropertyChange:!1,value:{obj:N}}),(N.arr[0]||N.arr[1]||N.arr[2]||N.arr[3])&&(e=!0)}return t?(h.startX=p,h.startY=u,h.endX=c,h.endY=f):(h.startX=c,h.startY=f,h.endX=p,h.endY=u),e},l.prototype.isMouseOutsideImg=function(t,e){var i={bool:!1};return this.parent.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),this.parent.notify("draw",{prop:"isPointsInsideImg",value:{obj:i,x:t,y:e}}),i.bool},l.prototype.preventDraggingInvertly=function(){var t=!1,e=this.parent;if(e.activeObj.shape==="image")return t;var i,r;if(e.activeObj.shape!==void 0&&(i=e.activeObj.shape.split("-")),i!==void 0&&i[0]==="crop"&&(r=!0),!this.isPreventDragging&&e.activeObj.rotatedAngle===0&&(e.activeObj.preventShapeDragOut||e.activeObj.shape==="redact"||r)){t=this.limitDrag(!0);var o=["line","arrow","path"];o.indexOf(e.activeObj.shape)>-1&&(t=this.limitDrag(!1))}return t},l.prototype.preventTextDraggingInvertly=function(){var t=this.parent,e=!1,i=t.activeObj.activePoint,r=t.img,o=r.destLeft,a=r.destTop,n=r.destWidth,s=r.destHeight;return this.isPreventDragging||(i.startX<o||i.startY<a||i.endX>o+n||i.endY>a+s)&&(e=!0),e},l.prototype.preventInverseResize=function(t){var e=this.parent,i=e.activeObj.activePoint;i.width<0&&(i.width=0,i.startX=t.activePoint.startX,i.endX=t.activePoint.endX),i.height<0&&(i.height=0,i.startY=t.activePoint.startY,i.endY=t.activePoint.endY)},l.prototype.getScaleRatio=function(t){var e=this.parent,i={x:t,y:t};if(e.activeObj.shape&&e.activeObj.shape!=="crop-custom"&&e.activeObj.shape!=="crop-circle"&&e.activeObj.shape!=="crop-square"){var r=e.activeObj.shape==="image"||e.activeObj.shape==="text"?this.findImageRatio(e.activeObj.activePoint.width,e.activeObj.activePoint.height).split("-"):e.activeObj.shape.split("-");if(r.length>1||e.activeObj.shape==="image"||e.activeObj.shape==="text"){r=e.activeObj.shape==="image"||e.activeObj.shape==="text"?r[0].split(":"):r[1].split(":");var o=t/parseInt(r[1],10);i.x=o*parseInt(r[0],10),i.y=o*parseInt(r[1],10)}}return i},l.prototype.findImageRatio=function(t,e,i){var r=function(n,s){return s===0?n:r(s,n%s)},o=r(t,e),a=t/o+":"+e/o;return i&&(i.ratio=a),a},l.prototype.revertResizing=function(t){var e=this.parent,i=e.activeObj.activePoint;this.preventDraggingInvertly()&&(i.startX=t.activePoint.startX,i.startY=t.activePoint.startY,i.endX=t.activePoint.endX,i.endY=t.activePoint.endY)},l.prototype.performSEResize=function(t,e,i,r){var o=this.parent;if(this.resizeImg(t,e,"se-resize",i),r.endX<r.startX){var a=r.endX;r.endX=r.startX,r.startX=a,this.dragElement=o.upperCanvas.style.cursor=o.cursor="sw-resize"}if(r.endY<r.startY){var a=r.endY;r.endY=r.startY,r.startY=a,this.dragElement=o.upperCanvas.style.cursor=o.cursor="ne-resize"}this.revertCustomSelection(r,i,"se-resize"),this.revertResizing(i)},l.prototype.performNWResize=function(t,e,i,r){var o=this.parent;if(this.resizeImg(t,e,"nw-resize",i),r.startX>r.endX){var a=r.startX;r.startX=r.endX,r.endX=a,this.dragElement=o.upperCanvas.style.cursor=o.cursor="ne-resize"}if(r.startY>r.endY){var a=r.startY;r.startY=r.endY,r.endY=a,this.dragElement=o.upperCanvas.style.cursor=o.cursor="sw-resize"}this.revertCustomSelection(r,i,"nw-resize"),this.revertResizing(i)},l.prototype.isCustomSelection=function(){if(this.parent.activeObj.shape){var t=["custom","circle","square","2:3","3:2","3:4","4:3","4:5","5:4","5:7","7:5","9:16","16:9"];return this.parent.activeObj.shape.indexOf("crop-")>-1&&t.indexOf(this.parent.activeObj.shape.split("-")[1])===-1}return!1},l.prototype.revertCustomSelection=function(t,e,i){var r=this.parent;if(this.isCustomSelection()){var o=r.img,a=o.destLeft,n=o.destTop,s=o.destWidth,h=o.destHeight,p=a+s<r.lowerCanvas.width?a+s:r.lowerCanvas.width,u=n+h<r.lowerCanvas.height?n+h:r.lowerCanvas.height,c=a>0?a:0,f=n>0?n:0,g=n>0?n:0,v=a>0?a:0;(i==="se-resize"&&(t.endX>p||t.endY>u)||i==="nw-resize"&&(t.startX<c||t.startY<f)||i==="ne-resize"&&(t.endX>p||t.startY<g)||i==="sw-resize"&&(t.startX<v||t.endY>u))&&this.revertPoints(t,e)}},l.prototype.revertPoints=function(t,e){t.startX=e.activePoint.startX,t.startY=e.activePoint.startY,t.endX=e.activePoint.endX,t.endY=e.activePoint.endY,t.width=e.activePoint.width,t.height=e.activePoint.height},l.prototype.updateNWPoints=function(t,e){var i=this.parent,r=i.activeObj.activePoint,o,a,n,s=y({},i.activeObj,null,!0);if(i.activeObj.shape==="text")this.resizeImg(t,e,"nw-resize",s),i.notify("shape",{prop:"updateFontSize",onPropertyChange:!1,value:{obj:i.activeObj}});else{var h=void 0;if(i.activeObj.shape!==void 0&&(h=i.activeObj.shape.split("-")),i.activeObj.shape==="crop-custom"||i.activeObj.shape!==void 0&&h[0]!=="crop"||this.isCustomSelection()){if(i.activeObj.shape==="image"||this.isCustomSelection()?this.resizeImg(t,e,"nw-resize",s):this.adjustNWPoints(r,t,e,i.activeObj.rotatedAngle),r.startX>r.endX){var p=r.startX;r.startX=r.endX,r.endX=p,this.dragElement=i.upperCanvas.style.cursor=i.cursor="ne-resize"}if(r.startY>r.endY){var p=r.startY;r.startY=r.endY,r.endY=p,this.dragElement=i.upperCanvas.style.cursor=i.cursor="sw-resize"}this.revertCustomSelection(r,s,"nw-resize"),this.revertResizing(s)}else{var u=i.img,c=u.destLeft,f=u.destTop;if(r.startX<t&&r.startY<e){o=t-r.startX,a=e-r.startY,n=Math.min(o,a);var g=this.getScaleRatio(n);r.startX+=g.x,r.startY+=g.y;var v=c>0?c:0,m=f>0?f:0;(r.startX<v||r.startY<m)&&(r.startX-=g.x,r.startY-=g.y)}else{o=r.startX-t,a=e-r.endY,n=Math.max(o,a);var g=this.getScaleRatio(n);r.startX-=g.x,r.startY-=g.y;var v=c>0?c:0,C=f>0?f:0;(r.startX<v||r.startY<C)&&(r.startX+=g.x,r.startY+=g.y)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.revertResizing(s)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.preventInverseResize(s)}},l.prototype.updateNPoints=function(t,e){var i=this.parent,r=i.activeObj.activePoint,o,a,n,s=y({},i.activeObj,null,!0);if(i.activeObj.shape!=="text"){var h=void 0;if(i.activeObj.shape&&(h=i.activeObj.shape.split("-")),i.activeObj.shape==="crop-custom"||i.activeObj.shape&&h[0]!=="crop"){if(i.activeObj.shape!=="line"&&i.activeObj.shape!=="arrow"&&i.activeObj.shape!=="path"&&i.activeObj.rotatedAngle!==0&&this.dragPoint.startX?(this.dragPoint.startX&&this.dragPoint.startY&&(this.previousPoint.x=this.dragPoint.endX,this.previousPoint.y=this.dragPoint.endY,this.dragPoint.endX=t,this.dragPoint.endY=e),o=this.dragPoint.endX-this.previousPoint.x,a=this.dragPoint.endY-this.previousPoint.y,this.adjustRotationPoints(r,o,a,i.activeObj.rotatedAngle)):(r.startY=e,r.height=r.endY-r.startY),r.startY>r.endY){var p=r.startY;r.startY=r.endY,r.endY=p,this.dragElement=this.resizedElement="s-resize"}this.revertResizing(s)}else{var u=i.img,c=u.destLeft,f=u.destTop,g=u.destWidth;if(this.isCustomSelection())this.performNWResize(t,e,s,r);else if(r.endX>t&&r.startY<e){o=r.endX-t,a=e-r.startY,n=Math.min(o,a);var v=this.getScaleRatio(n);r.endX-=v.x,r.startY+=v.y,(r.endX>c+g||r.startY<f)&&(r.endX+=v.x,r.startY-=v.y)}else{o=t-r.endX,a=r.startY-e,n=Math.max(o,a);var v=this.getScaleRatio(n);r.endX+=v.x,r.startY-=v.y,(r.endX>c+g||r.startY<f)&&(r.endX-=v.x,r.startY+=v.y)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.revertResizing(s)}}},l.prototype.updateNEPoints=function(t,e){var i=this.parent,r=i.activeObj.activePoint,o,a,n,s=y({},i.activeObj,null,!0);if(i.activeObj.shape==="text")this.resizeImg(t,e,"ne-resize",s),i.notify("shape",{prop:"updateFontSize",onPropertyChange:!1,value:{obj:i.activeObj}});else{var h=void 0;if(i.activeObj.shape&&(h=i.activeObj.shape.split("-")),i.activeObj.shape==="crop-custom"||i.activeObj.shape!==void 0&&h[0]!=="crop"||this.isCustomSelection()){if(i.activeObj.shape==="image"||this.isCustomSelection()?this.resizeImg(t,e,"ne-resize",s):this.adjustNEPoints(r,t,e,i.activeObj.rotatedAngle),r.endX<r.startX){var p=r.endX;r.endX=r.startX,r.startX=p,this.dragElement=i.upperCanvas.style.cursor=i.cursor="nw-resize"}if(r.startY>r.endY){var p=r.startY;r.startY=r.endY,r.endY=p,this.dragElement=i.upperCanvas.style.cursor=i.cursor="se-resize"}this.revertCustomSelection(r,s,"ne-resize"),this.revertResizing(s)}else{var u=i.img,c=u.destLeft,f=u.destTop,g=u.destWidth;if(r.endX>t&&r.startY<e){o=r.endX-t,a=e-r.startY,n=Math.min(o,a);var v=this.getScaleRatio(n);r.endX-=v.x,r.startY+=v.y;var m=c+g<i.lowerCanvas.width?c+g:i.lowerCanvas.width,C=f>0?f:0;(r.endX>m||r.startY<C)&&(r.endX+=v.x,r.startY-=v.y)}else{o=t-r.endX,a=r.startY-e,n=Math.max(o,a);var v=this.getScaleRatio(n);r.endX+=v.x,r.startY-=v.y;var m=c+g<i.lowerCanvas.width?c+g:i.lowerCanvas.width,C=f>0?f:0;(r.endX>m||r.startY<C)&&(r.endX-=v.x,r.startY+=v.y)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.revertResizing(s)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.preventInverseResize(s)}},l.prototype.updateWPoints=function(t,e){var i=this.parent,r=i.activeObj.activePoint,o,a,n,s=y({},i.activeObj,null,!0);if(i.activeObj.shape!=="text"){var h=void 0;if(i.activeObj.shape&&(h=i.activeObj.shape.split("-")),i.activeObj.shape==="crop-custom"||i.activeObj.shape&&h[0]!=="crop"){if(i.activeObj.shape!=="line"&&i.activeObj.shape!=="arrow"&&i.activeObj.shape!=="path"&&i.activeObj.rotatedAngle!==0&&this.dragPoint.startX?(this.dragPoint.startX&&this.dragPoint.startY&&(this.previousPoint.x=this.dragPoint.endX,this.previousPoint.y=this.dragPoint.endY,this.dragPoint.endX=t,this.dragPoint.endY=e),o=this.dragPoint.endX-this.previousPoint.x,a=this.dragPoint.endY-this.previousPoint.y,this.adjustRotationPoints(r,o,a,i.activeObj.rotatedAngle)):(r.startX=t,r.width=r.endX-r.startX),i.activeObj.shape==="line"||i.activeObj.shape==="arrow"||i.activeObj.shape==="path")r.startY=e,r.height=r.endY-r.startY,this.adjustActObjForLineArrow()&&(this.dragElement="e-resize",i.activeObj.triangleDirection==="right"?i.activeObj.triangleDirection="left":i.activeObj.triangleDirection==="left"&&(i.activeObj.triangleDirection="right"));else if(r.startX>r.endX){var p=r.startX;r.startX=r.endX,r.endX=p,this.dragElement=this.resizedElement="e-resize"}this.revertResizing(s)}else{var u=i.img,c=u.destLeft,f=u.destTop,g=u.destHeight;if(this.isCustomSelection())this.performNWResize(t,e,s,r);else if(r.startX<t&&r.endY>e){o=t-r.startX,a=r.endY-e,n=Math.min(o,a);var v=this.getScaleRatio(n);r.startX+=v.x,r.endY-=v.y,(r.startX<c||r.endY>f+g)&&(r.startX-=v.x,r.endY+=v.y)}else{o=r.startX-t,a=e-r.endY,n=Math.max(o,a);var v=this.getScaleRatio(n);r.startX-=v.x,r.endY+=v.y,(r.startX<c||r.endY>f+g)&&(r.startX+=v.x,r.endY-=v.y)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.revertResizing(s)}}},l.prototype.updateEPoints=function(t,e){var i=this.parent,r=i.activeObj.activePoint,o,a,n,s=y({},i.activeObj,null,!0);if(i.activeObj.shape!=="text"){var h=void 0;if(i.activeObj.shape&&(h=i.activeObj.shape.split("-")),i.activeObj.shape==="crop-custom"||i.activeObj.shape&&h[0]!=="crop"){if(i.activeObj.shape!=="line"&&i.activeObj.shape!=="arrow"&&i.activeObj.shape!=="path"&&i.activeObj.rotatedAngle!==0&&this.dragPoint.startX?(this.dragPoint.startX&&this.dragPoint.startY&&(this.previousPoint.x=this.dragPoint.endX,this.previousPoint.y=this.dragPoint.endY,this.dragPoint.endX=t,this.dragPoint.endY=e),o=this.dragPoint.endX-this.previousPoint.x,a=this.dragPoint.endY-this.previousPoint.y,this.adjustRotationPoints(r,o,a,i.activeObj.rotatedAngle)):(r.endX=t,r.width=r.endX-r.startX),i.activeObj.shape==="line"||i.activeObj.shape==="arrow"||i.activeObj.shape==="path")r.endY=e,r.height=r.endY-r.startY,this.adjustActObjForLineArrow()&&(this.dragElement="w-resize",i.activeObj.triangleDirection==="right"?i.activeObj.triangleDirection="left":i.activeObj.triangleDirection==="left"&&(i.activeObj.triangleDirection="right"));else if(r.endX<r.startX){var p=r.endX;r.endX=r.startX,r.startX=p,this.dragElement=this.resizedElement="w-resize"}this.revertResizing(s)}else{var u=i.img,c=u.destLeft,f=u.destTop,g=u.destWidth,v=u.destHeight;if(this.isCustomSelection())this.performSEResize(t,e,s,r);else if(r.endX>t&&r.endY>e){o=r.endX-t,a=r.endY-e,n=Math.min(o,a);var m=this.getScaleRatio(n);r.endX-=m.x,r.endY-=m.y,(r.endX>c+g||r.endY>f+v)&&(r.endX+=m.x,r.endY+=m.y)}else{o=t-r.endX,a=e-r.endY,n=Math.max(o,a);var m=this.getScaleRatio(n);r.endX+=m.x,r.endY+=m.y,(r.endX>c+g||r.endY>f+v)&&(r.endX-=m.x,r.endY-=m.y)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.revertResizing(s)}}},l.prototype.updateSWPoints=function(t,e){var i=this.parent,r=i.activeObj.activePoint,o,a,n,s=y({},i.activeObj,null,!0);if(i.activeObj.shape==="text")this.resizeImg(t,e,"sw-resize",s),i.notify("shape",{prop:"updateFontSize",onPropertyChange:!1,value:{obj:i.activeObj}});else{var h=void 0;if(i.activeObj.shape!==void 0&&(h=i.activeObj.shape.split("-")),i.activeObj.shape==="crop-custom"||i.activeObj.shape!==void 0&&h[0]!=="crop"||this.isCustomSelection()){if(i.activeObj.shape==="image"||this.isCustomSelection()?this.resizeImg(t,e,"sw-resize",s):this.adjustSWPoints(r,t,e,i.activeObj.rotatedAngle),r.startX>r.endX){var p=r.startX;r.startX=r.endX,r.endX=p,this.dragElement=i.upperCanvas.style.cursor=i.cursor="se-resize"}if(r.endY<r.startY){var p=r.endY;r.endY=r.startY,r.startY=p,this.dragElement=i.upperCanvas.style.cursor=i.cursor="nw-resize"}this.revertCustomSelection(r,s,"sw-resize"),this.revertResizing(s)}else{var u=i.img,c=u.destLeft,f=u.destTop,g=u.destHeight;if(r.startX<t&&r.endY>e){o=t-r.startX,a=r.endY-e,n=Math.min(o,a);var v=this.getScaleRatio(n);r.startX+=v.x,r.endY-=v.y;var m=c>0?c:0,C=f+g<i.lowerCanvas.height?f+g:i.lowerCanvas.height;(r.startX<m||r.endY>C)&&(r.startX-=v.x,r.endY+=v.y)}else{o=r.startX-t,a=e-r.endY,n=Math.max(o,a);var v=this.getScaleRatio(n);r.startX-=v.x,r.endY+=v.y;var m=c>0?c:0,C=f+g<i.lowerCanvas.height?f+g:i.lowerCanvas.height;(r.startX<m||r.endY>C)&&(r.startX+=v.x,r.endY-=v.y)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.revertResizing(s)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.preventInverseResize(s)}},l.prototype.updateSPoints=function(t,e){var i=this.parent,r=i.activeObj.activePoint,o,a,n,s=y({},i.activeObj,null,!0);if(i.activeObj.shape!=="text"){var h=void 0;if(i.activeObj.shape&&(h=i.activeObj.shape.split("-")),i.activeObj.shape==="crop-custom"||i.activeObj.shape&&h[0]!=="crop"){if(i.activeObj.shape!=="line"&&i.activeObj.shape!=="arrow"&&i.activeObj.shape!=="path"&&i.activeObj.rotatedAngle!==0&&this.dragPoint.startX?(this.dragPoint.startX&&this.dragPoint.startY&&(this.previousPoint.x=this.dragPoint.endX,this.previousPoint.y=this.dragPoint.endY,this.dragPoint.endX=t,this.dragPoint.endY=e),o=this.dragPoint.endX-this.previousPoint.x,a=this.dragPoint.endY-this.previousPoint.y,this.adjustRotationPoints(r,o,a,i.activeObj.rotatedAngle)):(r.endY=e,r.height=r.endY-r.startY),r.endY<r.startY){var p=r.endY;r.endY=r.startY,r.startY=p,this.dragElement=this.resizedElement="n-resize"}this.revertResizing(s)}else{var u=i.img,c=u.destLeft,f=u.destTop,g=u.destWidth,v=u.destHeight;if(this.isCustomSelection())this.performSEResize(t,e,s,r);else if(r.endX>t&&r.endY>e){o=r.endX-t,a=r.endY-e,n=Math.min(o,a);var m=this.getScaleRatio(n);r.endX-=m.x,r.endY-=m.y,(r.endX>c+g||r.endY>f+v)&&(r.endX+=m.x,r.endY+=m.y)}else{o=t-r.endX,a=e-r.endY,n=Math.max(o,a);var m=this.getScaleRatio(n);r.endX+=m.x,r.endY+=m.x,(r.endX>c+g||r.endY>f+v)&&(r.endX-=m.x,r.endY-=m.y)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.revertResizing(s)}}},l.prototype.updateSEPoints=function(t,e){var i=this.parent,r=i.activeObj.activePoint,o,a,n,s=y({},i.activeObj,null,!0);if(i.activeObj.shape==="text")this.resizeImg(t,e,"se-resize",s),i.notify("shape",{prop:"updateFontSize",onPropertyChange:!1,value:{obj:i.activeObj}});else{var h=void 0,p=void 0;if(i.activeObj.shape!==void 0&&(h=i.activeObj.shape.split("-")),i.activeObj.shape==="crop-custom"||i.activeObj.shape!==void 0&&h[0]!=="crop"||this.isCustomSelection()){if(i.activeObj.shape==="image"||this.isCustomSelection()?this.resizeImg(t,e,"se-resize",s):this.adjustSEPoints(r,t,e,i.activeObj.rotatedAngle),r.endX<r.startX){var u=r.endX;r.endX=r.startX,r.startX=u,this.dragElement=i.upperCanvas.style.cursor=i.cursor="sw-resize"}if(r.endY<r.startY){var u=r.endY;r.endY=r.startY,r.startY=u,this.dragElement=i.upperCanvas.style.cursor=i.cursor="ne-resize"}this.revertCustomSelection(r,s,"se-resize"),this.revertResizing(s)}else{var c=i.img,f=c.destLeft,g=c.destTop,v=c.destWidth,m=c.destHeight;if(r.endX>t&&r.endY>e){o=r.endX-t,a=r.endY-e,n=Math.min(o,a),p=this.getScaleRatio(n),r.endX-=p.x,r.endY-=p.y;var C=f+v<i.lowerCanvas.width?f+v:i.lowerCanvas.width,M=g+m<i.lowerCanvas.height?g+m:i.lowerCanvas.height;(r.endX>C||r.endY>M)&&(r.endX+=p.x,r.endY+=p.y)}else{o=t-r.endX,a=e-r.endY,n=Math.max(o,a),p=this.getScaleRatio(n),r.endX+=p.x,r.endY+=p.y;var C=f+v<i.lowerCanvas.width?f+v:i.lowerCanvas.width,M=g+m<i.lowerCanvas.height?g+m:i.lowerCanvas.height;(r.endX>C||r.endY>M)&&(r.endX-=p.x,r.endY-=p.y)}r.width=r.endX-r.startX,r.height=r.endY-r.startY,this.revertResizing(s)}this.preventInverseResize(s)}},l.prototype.resizeImg=function(t,e,i,r){var o=this.parent,a=o.activeObj.activePoint,n,s,h,p;if(this.previousPoint.x!==0&&this.previousPoint.y!==0){if(this.currentDrawingShape==="text"&&(this.setCursor(t,e),o.activeObj.textSettings.fontSize===0)){o.activeObj.textSettings.fontSize=11,o.notify("shape",{prop:"updateFontRatio",onPropertyChange:!1,value:{obj:o.activeObj,isTextArea:null}}),o.activeObj.textSettings.text=o.activeObj.keyHistory="Enter Text",o.notify("shape",{prop:"updateFontStyles",onPropertyChange:!1,value:{isTextBox:null}});var u=this.upperContext.measureText(o.activeObj.textSettings.text).width+o.activeObj.textSettings.fontSize*.5;a.endX=a.startX+u,a.endY=a.startY+o.activeObj.textSettings.fontSize,a.width=a.endX-a.startX,a.height=a.endY-a.startY,r=y({},o.activeObj,null,!0),o.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:o.activeObj.activePoint,obj:o.activeObj,isMouseMove:null,x:null,y:null}})}switch(o.upperCanvas.style.cursor){case"se-resize":case"s-resize":this.previousPoint.x>t||this.previousPoint.y>e?(n=this.previousPoint.x-t,s=this.previousPoint.y-e,h=(n+s)/2,p=this.getScaleRatio(h),this.adjustRotationPoints(a,-Math.abs(p.x),-Math.abs(p.y),o.activeObj.rotatedAngle,"img-resize",i)):this.previousPoint.x!==0&&this.previousPoint.y!==0&&(n=t-this.previousPoint.x,s=e-this.previousPoint.y,h=(n+s)/2,p=this.getScaleRatio(h),this.adjustRotationPoints(a,Math.abs(p.x),Math.abs(p.y),o.activeObj.rotatedAngle,"img-resize",i));break;case"sw-resize":this.previousPoint.x<t||this.previousPoint.y>e?(n=t-this.previousPoint.x,s=this.previousPoint.y-e,h=(n+s)/2,p=this.getScaleRatio(h),this.adjustRotationPoints(a,-Math.abs(p.x),-Math.abs(p.y),o.activeObj.rotatedAngle,"img-resize",i)):this.previousPoint.x!==0&&this.previousPoint.y!==0&&(n=this.previousPoint.x-t,s=e-this.previousPoint.y,h=(n+s)/2,p=this.getScaleRatio(h),this.adjustRotationPoints(a,Math.abs(p.x),Math.abs(p.y),o.activeObj.rotatedAngle,"img-resize",i));break;case"w-resize":case"nw-resize":this.previousPoint.x<t||this.previousPoint.y<e?(n=t-this.previousPoint.x,s=e-this.previousPoint.y,h=(n+s)/2,p=this.getScaleRatio(h),this.adjustRotationPoints(a,-Math.abs(p.x),-Math.abs(p.y),o.activeObj.rotatedAngle,"img-resize",i)):this.previousPoint.x!==0&&this.previousPoint.y!==0&&(n=this.previousPoint.x-t,s=this.previousPoint.y-e,h=(n+s)/2,p=this.getScaleRatio(h),this.adjustRotationPoints(a,Math.abs(p.x),Math.abs(p.y),o.activeObj.rotatedAngle,"img-resize",i));break;case"n-resize":case"ne-resize":this.previousPoint.x>t||this.previousPoint.y<e?(n=this.previousPoint.x-t,s=e-this.previousPoint.y,h=(n+s)/2,p=this.getScaleRatio(h),this.adjustRotationPoints(a,-Math.abs(p.x),-Math.abs(p.y),o.activeObj.rotatedAngle,"img-resize",i)):this.previousPoint.x!==0&&this.previousPoint.y!==0&&(n=t-this.previousPoint.x,s=this.previousPoint.y-e,h=(n+s)/2,p=this.getScaleRatio(h),this.adjustRotationPoints(a,Math.abs(p.x),Math.abs(p.y),o.activeObj.rotatedAngle,"img-resize",i));break;case"e-resize":this.previousPoint.x>t||this.previousPoint.y>e?(n=this.previousPoint.x-t,s=this.previousPoint.y-e,h=(n+s)/2,p=this.getScaleRatio(h),this.adjustRotationPoints(a,-Math.abs(p.x),-Math.abs(p.y),o.activeObj.rotatedAngle,"img-resize",i)):this.previousPoint.x!==0&&this.previousPoint.y!==0&&(n=t-this.previousPoint.x,s=e-this.previousPoint.y,h=(n+s)/2,p=this.getScaleRatio(h),this.adjustRotationPoints(a,Math.abs(p.x),Math.abs(p.y),o.activeObj.rotatedAngle,"img-resize",i));break}a.width=a.endX-a.startX,a.height=a.endY-a.startY,(a.width<10||a.height<10||o.activeObj.shape==="text"&&o.activeObj.rotatedAngle===0&&this.preventTextDraggingInvertly())&&(o.activeObj=y({},r,null,!0))}this.previousPoint={x:t,y:e}},l.prototype.adjustNWPoints=function(t,e,i,r){var o=t.startX+t.width/2,a=t.startY+t.height/2,n=this.rotatePoints(t.endX,t.endY,o,a,r),s=[(n[0]+e)/2,(n[1]+i)/2],h=this.rotatePoints(n[0],n[1],s[0],s[1],-r),p=this.rotatePoints(e,i,s[0],s[1],-r);return t.endX=h[0],t.endY=h[1],t.startY=p[1],t.startX=p[0],t.width=t.endX-t.startX,t.height=t.endY-t.startY,t},l.prototype.adjustNEPoints=function(t,e,i,r){var o=t.startX+t.width/2,a=t.startY+t.height/2,n=this.rotatePoints(t.startX,t.endY,o,a,r),s=[(n[0]+e)/2,(n[1]+i)/2],h=this.rotatePoints(n[0],n[1],s[0],s[1],-r),p=this.rotatePoints(e,i,s[0],s[1],-r);return t.startX=h[0],t.endY=h[1],t.width=p[0]-h[0],t.height=h[1]-p[1],t.endX=t.startX+t.width,t.startY=t.endY-t.height,t},l.prototype.adjustSWPoints=function(t,e,i,r){var o=t.startX+t.width/2,a=t.startY+t.height/2,n=this.rotatePoints(t.endX,t.startY,o,a,r),s=[(n[0]+e)/2,(n[1]+i)/2],h=this.rotatePoints(n[0],n[1],s[0],s[1],-r),p=this.rotatePoints(e,i,s[0],s[1],-r);return t.endX=h[0],t.startY=h[1],t.startX=p[0],t.endY=p[1],t.width=t.endX-t.startX,t.height=t.endY-t.startY,t},l.prototype.adjustSEPoints=function(t,e,i,r){var o=t.startX+t.width/2,a=t.startY+t.height/2,n=this.rotatePoints(t.startX,t.startY,o,a,r),s=[(n[0]+e)/2,(n[1]+i)/2],h=this.rotatePoints(n[0],n[1],s[0],s[1],-r),p=this.rotatePoints(e,i,s[0],s[1],-r);return t.startX=h[0],t.startY=h[1],t.width=p[0]-h[0],t.height=p[1]-h[1],t.endX=t.startX+t.width,t.endY=t.startY+t.height,t},l.prototype.adjustRotationPoints=function(t,e,i,r,o,a){var n=t.startX+t.width/2,s=t.startY+t.height/2;this.getResizeDirection(t,e,i,r,o,a);var h=this.rotatePoints(t.startX,t.startY,n,s,r),p=this.rotatePoints(t.endX,t.startY,n,s,r),u=this.rotatePoints(t.endX,t.endY,n,s,r),c=this.rotatePoints(t.startX,t.endY,n,s,r),f=[(h[0]+u[0])/2,(h[1]+u[1])/2],g=this.rotatePoints(h[0],h[1],f[0],f[1],-r),v=this.rotatePoints(c[0],c[1],f[0],f[1],-r),m=this.rotatePoints(p[0],p[1],f[0],f[1],-r);return t.startX=g[0],t.startY=g[1],t.endX=m[0],t.endY=v[1],t.width=t.endX-t.startX,t.height=t.endY-t.startY,t},l.prototype.rotatePoints=function(t,e,i,r,o){return[(t-i)*Math.cos(o)-(e-r)*Math.sin(o)+i,(t-i)*Math.sin(o)+(e-r)*Math.cos(o)+r]},l.prototype.setResizedValue=function(t,e,i,r){switch(t){case"x":e+=i;break;case"y":e+=r;break;case"abs-x":e+=i>0?-i:Math.abs(i);break;case"abs-y":e+=r>0?-r:Math.abs(r);break;case"y-abs-x":e+=r+(i>0?-i:Math.abs(i))/2;break;case"abs-x-abs-y":e+=(i>0?-i:Math.abs(i))+(r>0?-r:Math.abs(r))/2;break;case"abs-y-x":e+=(r>0?-r:Math.abs(r))+i/2;break;case"x-y":e+=i+r/2;break;case"y-x":e+=r+i/2;break;case"img-resize-x":e+=i;break;case"img-resize-y":e+=r;break}return e},l.prototype.getResizeDirection=function(t,e,i,r,o,a){var n=r*(180/Math.PI),s=this.getResizedElement(n,this.resizedElement);this.resizedElement==="e-resize"?(t.width=this.setResizedValue(s,t.width,e,i),t.endX=t.width+t.startX):this.resizedElement==="n-resize"?(t.startY=this.setResizedValue(s,t.startY,e,i),t.height=t.endY-t.startY):this.resizedElement==="w-resize"?(t.startX=this.setResizedValue(s,t.startX,e,i),t.width=t.startX+t.endX):this.resizedElement==="s-resize"?(t.height=this.setResizedValue(s,t.height,e,i),t.endY=t.height+t.startY):o&&o==="img-resize"?(t.width=this.setResizedValue("img-resize-x",t.width,e,i),t.height=this.setResizedValue("img-resize-y",t.height,e,i),a==="se-resize"?(t.endX=t.width+t.startX,t.endY=t.height+t.startY):a==="sw-resize"?(t.startX=t.endX-t.width,t.endY=t.height+t.startY):a==="ne-resize"?(t.endX=t.width+t.startX,t.startY=t.endY-t.height):a==="nw-resize"&&(t.startX=t.endX-t.width,t.startY=t.endY-t.height)):o&&o==="text"&&(a==="widthHeight"?(t.width=this.setResizedValue("x-y",t.width,e,i),t.endX=t.width+t.startX,t.height=this.setResizedValue("y-x",t.height,e,i),t.endY=t.height+t.startY):a==="width"?(t.width=this.setResizedValue("x-y",t.width,e,i),t.endX=t.width+t.startX):a==="height"&&(t.height=this.setResizedValue("y-abs-x",t.height,e,i),t.endY=t.height+t.startY))},l.prototype.getResizedElement=function(t,e){var i=[];e==="n-resize"?i=[[337.5,360,"y"],[0,22.5,"y"],[22.5,67.5,"y-abs-x"],[67.5,112.5,"abs-x"],[112.5,157.5,"abs-x-abs-y"],[157.5,202.5,"abs-y"],[202.5,247.5,"abs-y-x"],[247.5,292.5,"x"],[292.5,337.5,"x-y"]]:e==="e-resize"?i=[[337.5,360,"x"],[0,22.5,"x"],[22.5,67.5,"x-y"],[67.5,112.5,"y"],[112.5,157.5,"y-abs-x"],[157.5,202.5,"abs-x"],[202.5,247.5,"abs-x-abs-y"],[247.5,292.5,"abs-y"],[292.5,337.5,"abs-y-x"]]:e==="s-resize"?i=[[337.5,360,"y"],[0,22.5,"y"],[22.5,67.5,"y-abs-x"],[67.5,112.5,"abs-x"],[112.5,157.5,"abs-x-abs-y"],[157.5,202.5,"abs-y"],[202.5,247.5,"abs-y-x"],[247.5,292.5,"x"],[292.5,337.5,"x-y"]]:e==="w-resize"&&(i=[[337.5,360,"x"],[0,22.5,"x"],[22.5,67.5,"x-y"],[67.5,112.5,"y"],[112.5,157.5,"y-abs-x"],[157.5,202.5,"abs-x"],[202.5,247.5,"abs-x-abs-y"],[247.5,292.5,"abs-y"],[292.5,337.5,"abs-y-x"]]);for(var r=t<0?360-Math.abs(t):t,o=0,a=i;o<a.length;o++){var n=a[o],s=n[0],h=n[1],p=n[2];if(r>s&&r<=h||r+360>s&&r+360<=h)return p}return e},l.prototype.updateCursorStyles=function(t,e,i){var r=this.parent,o=!1;r.activeObj.keyHistory!==""&&r.activeObj.shape===void 0&&!r.currObjType.isCustomCrop&&!r.currObjType.isLine&&r.currObjType.isText&&(r.activeObj.shape="text");var a=y({},r.activeObj,{},!0);if(!d(a.topLeftCircle)){if(a.shapeDegree===0?r.transform.degree:r.transform.degree-a.shapeDegree,this.isObjSelected)if(a.shape==="line"||a.shape==="arrow")o=this.updateCursorStylesForLineArrow(t,e,a);else if(a.shape==="path")o=this.updateCursorStylesForPath(t,e,a);else if(a.rotatedAngle)this.setCursorForRotatedObject(a,t,e,r.upperCanvas),r.cursor==="grabbing"?(r.upperCanvas.style.cursor=r.cursor="grabbing",this.dragElement=r.cursor):r.cursor==="move"?(this.dragPoint.startX=this.previousPoint.x=this.dragPoint.endX=t,this.dragPoint.startY=this.previousPoint.y=this.dragPoint.endY=e):r.cursor!=="default"&&(o=!0,this.dragElement=r.cursor,r.currObjType.isResize=!0);else{var n=this.getTransRotationPoint(a),s=a.topLeftCircle.radius;n&&t>=n.x-s*2&&t<=n.x+s*2&&e>=n.y-s*2&&e<=n.y+s*2&&this.dragElement!=="grabbing"?(r.upperCanvas.style.cursor=r.cursor="grabbing",this.dragElement=r.upperCanvas.style.cursor):t>=a.topLeftCircle.startX-s*2&&t<=a.topLeftCircle.startX+s*2&&e>=a.topLeftCircle.startY-s*2&&e<=a.topLeftCircle.startY+s*2&&this.dragElement!=="nw-resize"?(a.topLeftCircle.startX=a.topLeftCircle.startY=0,r.upperCanvas.style.cursor=r.cursor="nw-resize",o=!0,this.dragElement=r.upperCanvas.style.cursor):t>=a.topLeftCircle.startX-s*2&&t<=a.topRightCircle.startX-s*2&&e>=a.topCenterCircle.startY-s*2&&e<=a.topCenterCircle.startY+s*2&&this.dragElement!=="n-resize"?(a.topCenterCircle.startX=a.topCenterCircle.startY=0,r.upperCanvas.style.cursor=r.cursor="n-resize",o=!0,this.dragElement=r.upperCanvas.style.cursor):t>=a.topRightCircle.startX-s*2&&t<=a.topRightCircle.startX+s*2&&e>=a.topRightCircle.startY-s*2&&e<=a.topRightCircle.startY+s*2&&this.dragElement!=="ne-resize"?(a.topRightCircle.startX=a.topRightCircle.startY=0,r.upperCanvas.style.cursor=r.cursor="ne-resize",o=!0,this.dragElement=r.upperCanvas.style.cursor):t>=a.centerLeftCircle.startX-s*2&&t<=a.centerLeftCircle.startX+s*2&&e>=a.topLeftCircle.startY-s*2&&e<=a.bottomLeftCircle.startY-s*2&&this.dragElement!=="w-resize"?(a.centerLeftCircle.startX=a.centerLeftCircle.startY=0,r.upperCanvas.style.cursor=r.cursor="w-resize",o=!0,this.dragElement=r.upperCanvas.style.cursor):t>=a.centerRightCircle.startX-s*2&&t<=a.centerRightCircle.startX+s*2&&e>=a.topRightCircle.startY-s*2&&e<=a.bottomRightCircle.startY-s*2&&this.dragElement!=="e-resize"?(a.centerRightCircle.startX=a.centerRightCircle.startY=0,r.upperCanvas.style.cursor=r.cursor="e-resize",o=!0,this.dragElement=r.upperCanvas.style.cursor):t>=a.bottomLeftCircle.startX-s*2&&t<=a.bottomLeftCircle.startX+s*2&&e>=a.bottomLeftCircle.startY-s*2&&e<=a.bottomLeftCircle.startY+s*2&&this.dragElement!=="sw-resize"?(a.bottomLeftCircle.startX=a.bottomLeftCircle.startY=0,r.upperCanvas.style.cursor=r.cursor="sw-resize",o=!0,this.dragElement=r.upperCanvas.style.cursor):t>=a.bottomLeftCircle.startX-s*2&&t<=a.bottomRightCircle.startX-s*2&&e>=a.bottomCenterCircle.startY-s*2&&e<=a.bottomCenterCircle.startY+s*2&&this.dragElement!=="s-resize"?(a.bottomCenterCircle.startX=a.bottomCenterCircle.startY=0,r.upperCanvas.style.cursor=r.cursor="s-resize",o=!0,this.dragElement=r.upperCanvas.style.cursor):t>=a.bottomRightCircle.startX-s*2&&t<=a.bottomRightCircle.startX+s*2&&e>=a.bottomRightCircle.startY-s*2&&e<=a.bottomRightCircle.startY+s*2&&this.dragElement!=="se-resize"?(a.bottomRightCircle.startX=a.bottomRightCircle.startY=0,r.upperCanvas.style.cursor=r.cursor="se-resize",o=!0,this.dragElement=r.upperCanvas.style.cursor):(this.dragPoint.startX=this.previousPoint.x=this.dragPoint.endX=t,this.dragPoint.startY=this.previousPoint.y=this.dragPoint.endY=e),a.shape==="text"&&(r.cursor==="n-resize"||r.cursor==="s-resize"||r.cursor==="e-resize"||r.cursor==="w-resize")&&(r.upperCanvas.style.cursor=r.cursor="move",this.dragElement="",this.dragPoint.startX=this.previousPoint.x=this.dragPoint.endX=t,this.dragPoint.startY=this.previousPoint.y=this.dragPoint.endY=e)}else this.dragPoint.startX=this.previousPoint.x=this.dragPoint.endX=t,this.dragPoint.startY=this.previousPoint.y=this.dragPoint.endY=e;this.previousPoint.x=this.previousPoint.y=this.diffPoint.x=this.diffPoint.y=0,i==="touchstart"?o||t>=a.activePoint.startX&&t<=a.activePoint.endX&&e>=a.activePoint.startY&&e<=a.activePoint.endY||this.dragElement==="grabbing"?r.currObjType.isDragging=!0:a.shape==="line"||a.shape==="arrow"?(this.setCursorForLineArrow(a,t,e,r.upperCanvas),r.cursor==="move"&&(r.currObjType.isDragging=!0)):a.shape==="path"&&(this.setCursorForPath(a,t,e,r.upperCanvas),r.cursor==="move"&&(r.currObjType.isDragging=!0)):r.currObjType.isDragging=!0,a.rotatedAngle!==0&&(this.dragElement==="e-resize"||this.dragElement==="w-resize"||this.dragElement==="n-resize"||this.dragElement==="s-resize")&&(this.dragPoint.startX=this.previousPoint.x=this.dragPoint.endX=t,this.dragPoint.startY=this.previousPoint.y=this.dragPoint.endY=e)}},l.prototype.updateCursorStylesForLineArrow=function(t,e,i){for(var r=!1,o=this.parent,a,n=i.topLeftCircle.radius,s=0;s<5;s++)if(a=i.pointColl[s],t>=a.x-n*2&&t<=a.x+n*2&&e>=a.y-n*2&&e<=a.y+n*2){i.centerLeftCircle.startX=i.centerLeftCircle.startY=0,this.dragElement="w-resize",r=!0;break}if(!r){for(var s=1;s<6;s++)if(a=i.pointColl[i.pointColl.length-s],t>=a.x-n*2&&t<=a.x+n*2&&e>=a.y-n*2&&e<=a.y+n*2){i.centerRightCircle.startX=i.centerRightCircle.startY=0,this.dragElement="e-resize",r=!0;break}}if(!r)for(var s=0;s<i.pointColl.length;s++)if(a=i.pointColl[s],t>=a.x-n*2&&t<=a.x+n*2&&e>=a.y-n*2&&e<=a.y+n*2){o.upperCanvas.style.cursor=o.cursor="move",this.dragPoint.startX=this.previousPoint.x=this.dragPoint.endX=t,this.dragPoint.startY=this.previousPoint.y=this.dragPoint.endY=e;break}else o.upperCanvas.style.cursor=o.cursor="default";return r},l.prototype.updateCursorStylesForPath=function(t,e,i){var r=!1,o=this.parent;return this.pathAdjustedIndex=this.setCursorForLineArrow(i,t,e,o.upperCanvas),o.cursor==="move"&&(r=!0,this.dragElement="pathDrag"),r||(o.upperCanvas.style.cursor=o.cursor="move",this.dragPoint.startX=this.previousPoint.x=this.dragPoint.endX=t,this.dragPoint.startY=this.previousPoint.y=this.dragPoint.endY=e),r},l.prototype.setTextSelection=function(t,e){var i=this.parent,r=i.activeObj.activePoint,o=i.transform.degree;i.activeObj.shapeDegree===0?o=i.transform.degree:o=i.transform.degree-i.activeObj.shapeDegree;var a=i.activeObj.rotateFlipColl;if(this.isTransformedShape&&a){o=0;for(var n=0;n<a.length;n++)typeof a[n]=="number"&&(o+=a[n])}o<0&&(o=360+o);for(var n=0,s=i.activeObj.flipObjColl.length;n<s;n++){var h=i.activeObj.flipObjColl[n].toLowerCase();switch(o){case 0:switch(h){case"horizontal":r={startX:r.endX-t,startY:r.startY,endX:r.endX,endY:r.startY+(e||0)};break;case"vertical":r.startY=r.endY-e,r={startX:r.startX,startY:r.startY,endX:r.startX+(t||0),endY:r.endY};break;default:r={startX:r.startX,startY:r.startY,endX:r.startX+(t||0),endY:r.startY+(e||0)};break}break;case 90:switch(h){case"horizontal":r.endX=r.startX+e,r={startX:r.startX,startY:r.startY,endX:r.endX,endY:r.startY+(t||0)};break;case"vertical":r.startX=r.endX-e,r={startX:r.startX,startY:r.endY-t,endX:r.endX,endY:r.endY};break;default:r.startX=r.endX-e,r={startX:r.startX,startY:r.startY,endX:r.endX,endY:r.startY+(t||0)};break}break;case 180:switch(h){case"horizontal":r.startY=r.endY-e,r={startX:r.startX,startY:r.startY,endX:r.startX+t,endY:r.endY};break;case"vertical":r.endY=r.startY+e,r={endX:r.endX,endY:r.endY,startX:r.endX-(t||0),startY:r.startY};break;default:r={endX:r.endX,endY:r.endY,startX:r.endX-(t||0),startY:r.endY-(e||0)};break}break;case 270:switch(h){case"horizontal":r.startX=r.endX-e,r={startX:r.startX,startY:r.endY-(t||0),endX:r.endX,endY:r.endY};break;case"vertical":r={startX:r.startX,startY:r.startY,endX:r.startX+e,endY:r.startY+(t||0)};break;default:r.endX=r.startX+e,r={startX:r.startX,startY:r.endY-(t||0),endX:r.endX,endY:r.endY};break}break}}if(i.activeObj.flipObjColl.length===0)switch(o){case 0:r={startX:r.startX,startY:r.startY,endX:r.startX+(t||0),endY:r.startY+(e||0)};break;case 90:r.startX=r.endX-e,r={startX:r.startX,startY:r.startY,endX:r.endX,endY:r.startY+(t||0)};break;case 180:r={endX:r.endX,endY:r.endY,startX:r.endX-(t||0),startY:r.endY-(e||0)};break;case 270:r.endX=r.startX+e,r={startX:r.startX,startY:r.endY-(t||0),endX:r.endX,endY:r.endY};break}r.width=r.endX-r.startX,r.height=r.endY-r.startY,i.activeObj.activePoint=r,(i.transform.degree===360||i.transform.degree===-360)&&(i.transform.degree=0)},l.prototype.setActivePoint=function(t,e){var i=this.parent,r=i.activeObj.activePoint;if(!d(r))if(i.currObjType.isText){var o=t||0,a=e||i.activeObj.textSettings.fontSize;i.activeObj.textSettings.fontSize===void 0&&(i.activeObj.textSettings.fontSize=Math.abs(i.baseImgCanvas.width-i.baseImgCanvas.height)*.1),this.setTextSelection(o,a),this.mouseDownPoint.x=r.endX,this.mouseDownPoint.y=r.endY,i.activeObj.horTopLine!==void 0&&(i.activeObj.activePoint=y({},r,{},!0)),i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}})}else if(t&&e)r.startX=this.mouseDownPoint.x=t,r.startY=this.mouseDownPoint.y=e,i.currObjType.isDragging=!0;else{var n=i.activeObj;r={startX:n.horTopLine.startX,startY:n.horTopLine.startY,endX:n.horTopLine.endX,endY:n.horTopLine.endY},r.width=r.endX-r.startX,r.height=r.endY-r.startY}},l.prototype.mouseDownEventHandler=function(t){var e=this.parent;if(e.isKBDNavigation=!1,this.mouseDown=t.currentTarget===e.lowerCanvas||t.currentTarget===e.upperCanvas?"canvas":"",t.type==="touchstart"?this.isTouch=!0:this.isTouch=!1,!(t.type==="touchstart"&&t.currentTarget===e.lowerCanvas&&!e.isImageLoaded)){this.isCropSelection=!1,this.isPan=!0;var i;if(e.activeObj.shape!==void 0&&(i=e.activeObj.shape.split("-")),i!==void 0&&i[0]==="crop"&&(this.isCropSelection=!0),this.isCropSelection&&(this.dragCanvas=e.togglePan=!0),e.cursor==="grabbing"){var r={shapeSettingsObj:{}};this.isGrabbing=!0,e.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:r}});var o=r.shapeSettingsObj,a={cancel:!1,action:"rotate-start",previousShapeSettings:o,allowShapeOverflow:this.allowOutofBound()},n={cancel:!1,action:"rotate-start",previousShapeSettings:o,allowShapeOverflow:this.allowOutofBound()};this.triggerShapeChange(a,n,"mouse-down")}var s={point:this.setXYPoints(t)};e.trigger("click",s),this.isMouseDown=!0,this.isMouseUp=!1,this.clickEvent(s,t)}},l.prototype.getImagePoints=function(t,e){var i=this.parent,r=i.img,o=r.destLeft,a=r.destTop,n=r.destWidth,s=r.destHeight;return t<o?t=o:t>o+n&&(t=o+n),e<a?e=a:e>a+s&&(e=a+s),{x:t,y:e}},l.prototype.clickEvent=function(t,e){var i=this.parent,r=i.activeObj.activePoint,o=t.point.x,a=t.point.y,n=i.activeObj.shape&&i.activeObj.shape==="text"?i.cursor:"default",s=i.upperCanvas.style.cursor;if(i.isResize){this.performEnterAction(e),i.upperCanvas.style.cursor="default";return}else if(JSON.stringify(i.frameObj)!==JSON.stringify(i.tempFrameObj))i.okBtn();else if(this.currentDrawingShape!==""&&!this.isShapeTouch(e,this.isCropSelection)&&(this.isTouch||s==="crosshair"||i.isShapeDrawing)){i.drawingShape&&!i.isShapeDrawing&&(i.okBtn(),i.enableShapeDrawing(i.toPascalCase(i.drawingShape),!0)),r=i.activeObj.activePoint;var h={currObj:{}};i.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:h}}),this.initialPrevObj=h.currObj,this.initialPrevObj.objColl=y([],i.objColl,[],!0),this.initialPrevObj.pointColl=y([],i.pointColl,[],!0),this.initialPrevObj.afterCropActions=y([],i.afterCropActions,[],!0);var p={selPointColl:null};if(i.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:p}}),this.initialPrevObj.selPointColl=y([],p.selPointColl,[],!0),this.setActivePoint(o,a),r=i.activeObj.activePoint,this.currentDrawingShape==="path"){var u=this.getImagePoints(o,a);i.activeObj.pointColl.push({x:u.x,y:u.y}),r.width!==0&&r.height!==0&&(r.width=0,r.height=0,r.startX=i.activeObj.pointColl[i.activeObj.pointColl.length-1].x,r.startY=i.activeObj.pointColl[i.activeObj.pointColl.length-1].y)}if(r.endX=r.startX,r.endY=r.startY,this.currentDrawingShape==="text"){i.activeObj.textSettings.fontSize=11,this.previousPoint.x=r.startX,this.previousPoint.y=r.startY,i.notify("shape",{prop:"updateFontStyles",onPropertyChange:!1,value:{isTextBox:null}});var c=this.upperContext.measureText(i.activeObj.textSettings.text).width+i.activeObj.textSettings.fontSize*.5;r.endX=r.startX+c,r.endY=r.startY+i.activeObj.textSettings.fontSize,r.width=r.endX-r.startX,r.height=r.endY-r.startY}else this.currentDrawingShape==="arrow"&&(i.activeObj.start=this.arrowShape[0],i.activeObj.end=this.arrowShape[1]);i.currObjType.isDragging=!0;var f=this.updatePrevShapeSettings(),g={cancel:!1,action:"draw-start",previousShapeSettings:f,allowShapeOverflow:this.allowOutofBound()},v={cancel:!1,action:"move",previousShapeSettings:f,allowShapeOverflow:this.allowOutofBound()};this.shapeResizingArgs=g,this.shapeMovingArgs=v,this.triggerShapeChange(g,v,"mouse-down"),i.activeObj.activePoint=r,i.isShapeDrawing=!0,this.tempActiveObj=y({},i.activeObj,{},!0);return}i.notify("draw",{prop:"resetFrameZoom",onPropertyChange:!1,value:{isOk:!0}}),this.isCropSelection&&this.dragCanvas&&(this.setCursor(o,a),i.cursor!=="move"&&i.cursor!=="crosshair"&&i.cursor!=="default"&&i.cursor!=="grab"&&(this.isPan=!1)),i.activeObj.shape?this.isObjSelected=!0:this.isObjSelected=!1;var m={currObj:{}};i.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:m}});var C=m.currObj,M=y({},i.activeObj,null,!0),I=this.isShapeTouch(e,this.isCropSelection),N=this.isFreehandDrawTouch(e,this.isCropSelection),O=I||this.isShapeClick(e,this.isCropSelection),x=this.applyCurrShape(O),D=i.textArea.style.display!=="none";if(this.isTouch&&!I&&M.shape&&!this.isCropSelection){this.applyObj(o,a)&&(i.okBtn(!0),i.notify("draw",{prop:"setPrevActObj",onPropertyChange:!1,value:{prevActObj:null}}));var A=y({},i.cropObj,{},!0);i.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:C,previousObjColl:C.objColl,previousPointColl:C.pointColl,previousSelPointColl:C.selPointColl,previousCropObj:A,previousText:null,currentText:null,previousFilter:null,isCircleCrop:i.isCircleCrop}}),x&&i.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}})}if(!I&&!i.togglePen&&!this.isCropSelection&&i.activeObj.redactType!=="blur"&&i.activeObj.redactType!=="pixelate"&&(i.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1}),i.notify("toolbar",{prop:"close-contextual-toolbar",onPropertyChange:!1})),this.dragCanvas&&this.isPan&&(i.cursor==="grab"||this.isTouch)&&!I&&!N&&!i.togglePen){if(this.applyObj(o,a)){if(i.okBtn(!0),x){var P=i.cursor;i.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),i.cursor=P}i.notify("draw",{prop:"setPrevActObj",onPropertyChange:!1,value:{prevActObj:null}})}this.isFhdEditing&&(i.notify("freehand-draw",{prop:"applyFhd",onPropertyChange:!1}),this.isFhdCustomized=!1,i.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1}));var V=i.activeObj.shape,q=["rectangle","ellipse","line","arrow","path","text","image","redact"];V&&q.indexOf(V)>-1&&(i.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:null}}),i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),i.notify("toolbar",{prop:"setCurrentToolbar",value:{type:"main"}}),i.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1}));var re=!1;i.activeObj.shape&&i.activeObj.shape.indexOf("crop-")>-1&&(re=!0),i.element.querySelector(".e-contextual-toolbar-wrapper")&&!re&&(i.element.querySelector(".e-contextual-toolbar-wrapper").classList.contains("e-hide")||(i.okBtn(),i.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide"))),this.canvasMouseDownHandler(e)}else{var ae=!1;i.activeObj.shape&&(i.activeObj.shape==="line"||i.activeObj.shape==="arrow")&&(ae=!0);var E=this.setXYPoints(e),L=E.x,k=E.y;if(this.applyObj(L,k)){if(i.okBtn(!0),x){var U=i.cursor;i.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),i.cursor=U}i.notify("draw",{prop:"setPrevActObj",onPropertyChange:!1,value:{prevActObj:null}})}i.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:L,y:k,isMouseDown:!0}});var B={index:null};i.notify("freehand-draw",{prop:"getFreehandDrawHoveredIndex",onPropertyChange:!1,value:{obj:B}});var R={freehandSelectedIndex:null};if(i.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:R}}),this.isFhdPoint||this.isFhdCustomized&&!i.togglePen){if(!d(R.freehandSelectedIndex)&&R.freehandSelectedIndex!==B.index){var $=B.index;if(i.okBtn(),this.isFhdCustomized=!1,i.notify("freehand-draw",{prop:"setFreehandDrawHoveredIndex",onPropertyChange:!1,value:{index:$}}),B.index>-1){var oe=i.pointColl[B.index].strokeColor;i.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:oe,strokeWidth:i.pointColl[B.index].strokeWidth}})}}R.freehandSelectedIndex=null,i.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:R}});var he=y([],i.objColl,[],!0);if(!d(B.index)&&B.index>-1)i.notify("freehand-draw",{prop:"selectFhd",value:{type:"ok"}}),i.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:null,strokeWidth:null}}),i.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:!0}});else if(R.freehandSelectedIndex){i.okBtn();var oe=i.pointColl[R.freehandSelectedIndex].strokeColor;i.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:oe,strokeWidth:i.pointColl[R.freehandSelectedIndex].strokeWidth}})}else this.findTargetObj(L,k,!1)&&(i.objColl=he,this.findTarget(L,k,e.type),i.notify("draw",{prop:"redrawDownScale"}))}else{if(this.isFhdEditing){i.apply();var pe=document.getElementById(i.element.id+"_quickAccessToolbarArea");pe&&(pe.style.display="none");var u=i.pointColl[R.freehandSelectedIndex],Te={id:"pen_"+(R.freehandSelectedIndex+1),type:bt.FreehandDraw,startX:u.points[0].x,startY:u.points[0].y,strokeColor:u.strokeColor,strokeWidth:u.strokeWidth,points:u.points,opacity:u.opacity,index:u.order},Pe={action:"apply",currentShapeSettings:y({},Te,{},!0)};i.trigger("shapeChange",Pe),i.editCompleteArgs=Pe}var Ue=i.togglePen,Se=i.cursor;if(i.notify("toolbar",{prop:"close-contextual-toolbar",onPropertyChange:!1}),M.shape==="redact"&&Se!=="default"&&(i.cursor=Se),Ue&&i.freeHandDraw(!0),this.isFhdEditing=!1,ae?this.setCursor(L,k):n!=="default"&&(i.upperCanvas.style.cursor=i.cursor=n),i.cursor==="crosshair"||S.isDevice&&i.togglePen){if(i.togglePen){if(d(i.activeObj.strokeSettings)){var Pt={strokeSettings:{}};i.notify("shape",{prop:"getStrokeSettings",onPropertyChange:!1,value:{obj:Pt}}),i.activeObj.strokeSettings=Pt.strokeSettings}var jt={penStrokeWidth:null};i.notify("freehand-draw",{prop:"getPenStrokeWidth",onPropertyChange:!1,value:{obj:jt}}),d(jt.penStrokeWidth)&&i.notify("freehand-draw",{prop:"setPenStrokeWidth",onPropertyChange:!1,value:{value:2}}),this.upperContext.strokeStyle=i.activeObj.strokeSettings.strokeColor,this.upperContext.fillStyle=i.activeObj.strokeSettings.strokeColor,i.notify("freehand-draw",{prop:"resetSelPoints",onPropertyChange:!1}),i.notify("freehand-draw",{prop:"freehandDownHandler",onPropertyChange:!1,value:{e,canvas:i.upperCanvas}})}else i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height);i.currObjType.isActiveObj=!1,this.dragElement="",this.dragPoint.startX=this.dragPoint.startY=this.dragPoint.endX=this.dragPoint.endY=0}(this.isTouch&&Se!=="crosshair"||i.cursor!=="crosshair")&&e.type.toLowerCase()==="touchstart"||i.currObjType.isActiveObj&&i.cursor!=="default"&&!i.togglePen?(i.notify("draw",{prop:"updateTempObjColl"}),i.notify("draw",{prop:"updateTempPointColl"}),this.findTarget(L,k,e.type),i.notify("draw",{prop:"redrawDownScale"})):(i.currObjType.shape===""||i.currObjType.isCustomCrop)&&!i.togglePen&&i.cursor!=="default"&&this.setActivePoint(L,k),D&&i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}})}}this.isShapeInserted=!1,this.tempActiveObj=y({},i.activeObj,{},!0)},l.prototype.mouseMoveEventHandler=function(t){var e=this.parent,i=e.cursor,r=e.upperCanvas.style.cursor;if(t.preventDefault(),!(this.isPreventShaping||e.isShapeDrawing&&e.currObjType.isDragging&&this.isTouch&&e.activeObj.shape&&e.activeObj.shape==="path")){if(e.cursor==="grabbing"&&this.isGrabbing){var o={shapeSettingsObj:{}};e.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:o}});var a=o.shapeSettingsObj,n={cancel:!1,action:"rotating",previousShapeSettings:a,allowShapeOverflow:this.allowOutofBound()},s={cancel:!1,action:"rotating",previousShapeSettings:a,allowShapeOverflow:this.allowOutofBound()};this.triggerShapeChange(n,s,"mouse-down")}if(this.timer&&this.timer>0&&this.dragPoint.startX&&this.dragPoint.startY){var h=Math.abs(this.dragPoint.startX-t.touches[0].clientX),p=Math.abs(this.dragPoint.startY-t.touches[0].clientY);(h>10||p>10)&&(this.timer=0)}var u=e.lowerCanvas.getBoundingClientRect();if(t.type==="touchmove"&&t.touches.length===2){if(this.isFirstMove)this.startTouches=this.targetTouches(t.touches),this.tempTouches=[],this.tempTouches.push({x:t.touches[0].clientX||t.touches[0].pageX-e.lowerCanvas.offsetLeft-u.left,y:(t.touches[0].clientY||t.touches[0].pageY-e.lowerCanvas.offsetTop)-u.top}),this.tempTouches.push({x:(t.touches[1].clientX||t.touches[1].pageX-e.lowerCanvas.offsetLeft)-u.left,y:(t.touches[1].clientY||t.touches[1].pageY-e.lowerCanvas.offsetTop)-u.top});else{var c=(t.touches[0].clientX||t.touches[0].pageX-e.lowerCanvas.offsetLeft)-u.left,f=(t.touches[0].clientY||t.touches[0].pageY-e.lowerCanvas.offsetTop)-u.top,g=(t.touches[1].clientX||t.touches[1].pageX-e.lowerCanvas.offsetLeft)-u.left,v=(t.touches[1].clientY||t.touches[1].pageY-e.lowerCanvas.offsetTop)-u.top,m={x:c<g?g-(g-c)/2:c-(c-g)/2,y:f<v?v-(v-f)/2:f-(f-v)/2};if(this.currMousePoint.x!==m.x&&this.currMousePoint.y!==m.y){var C="";if(t.type==="touchmove"&&(e.zoomSettings.zoomTrigger&ze.Pinch)===ze.Pinch){this.zoomType="Pinch";var M=this.calculateScale(this.startTouches,this.targetTouches(t.touches));this.startTouches=this.targetTouches(t.touches),M>1?C="zoomIn":M<1&&(C="zoomOut")}C!==""&&(e.isZoomBtnClick=!0,e.notify("draw",{prop:"performPointZoom",onPropertyChange:!1,value:{x:m.x,y:m.y,type:C,isResize:null}})),this.tempTouches=[],this.tempTouches.push({x:t.touches[0].clientX||t.touches[0].pageX-e.lowerCanvas.offsetLeft,y:t.touches[0].clientY||t.touches[0].pageY-e.lowerCanvas.offsetTop}),this.tempTouches.push({x:t.touches[1].clientX||t.touches[1].pageX-e.lowerCanvas.offsetLeft,y:t.touches[1].clientY||t.touches[1].pageY-e.lowerCanvas.offsetTop}),this.currMousePoint.x=m.x,this.currMousePoint.y=m.y,this.isPinching=!0}}this.isFirstMove=!1;return}var I,N;t.type==="mousemove"?(I=t.clientX,N=t.clientY):(this.touchEndPoint.x=I=t.touches[0].clientX,this.touchEndPoint.y=N=t.touches[0].clientY),I-=u.left,N-=u.top,this.canvasMouseMoveHandler(t);var O=!1,x;e.activeObj.shape!==void 0&&(x=e.activeObj.shape.split("-")),x!==void 0&&x[0]==="crop"&&(O=!0),O&&e.notify("transform",{prop:"disableZoomOutBtn",value:{isZoomOut:!0}}),e.upperCanvas.style.cursor=r,e.cursor=i,(e.currObjType.isActiveObj&&(e.activeObj.activePoint!==void 0||e.objColl.length>0)&&!this.dragCanvas||e.activeObj.activePoint!==void 0)&&this.dragElement===""&&(this.setCursor(I,N),e.activeObj.activePoint&&(e.activeObj.activePoint.width===0||!d(e.activeObj.currIndex)&&this.cursorTargetId!==e.activeObj.currIndex)&&e.cursor!=="default"&&e.cursor!=="move"&&e.cursor!=="crosshair"&&e.cursor!=="grab"&&e.cursor!=="pointer"&&(e.upperCanvas.style.cursor=e.cursor="move"),this.findTarget(I,N,t.type));var D=e.img,A=D.destLeft,P=D.destTop,V=D.destWidth,q=D.destHeight;if(e.currObjType.isDragging){if(e.activeObj.shape&&e.activeObj.preventShapeDragOut&&(I<A||I>A+V||N<P||N>P+q))return;this.upperContext.clearRect(0,0,e.lowerCanvas.width,e.lowerCanvas.height),this.updateActivePoint(I,N,O),e.notify("shape",{prop:"updateTrianglePoints",onPropertyChange:!1,value:{obj:e.activeObj}}),this.isPreventDragging?(this.isShapeDragOut()||(this.isPreventDragging=!1),e.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:null,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:null}})):e.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:null,isCropRatio:null,points:null,isPreventDrag:null,saveContext:null,isPreventSelection:null}}),O&&(this.dragCanvas=e.togglePan=!0)}this.isMouseDown=!1,this.isMouseUp=!1}},l.prototype.mouseUpEventHandler=function(t){var e=this.parent,i=e.element.id;if(e.isKBDNavigation=this.isMouseDown=!1,this.isMouseUp=!0,!(!S.isDevice&&(e.element.querySelector("#"+i+"_contextualToolbar")&&!e.element.querySelector("#"+i+"_contextualToolbar").parentElement.classList.contains("e-hide")||e.element.querySelector("#"+i+"_headWrapper")&&!e.element.querySelector("#"+i+"_headWrapper").parentElement.classList.contains("e-hide"))&&!(e.activeObj.shape&&e.activeObj.shape==="redact"&&e.isShapeDrawing))){if(e.cursor==="grabbing"&&this.isGrabbing){var r={shapeSettingsObj:{}};e.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:r}});var o=r.shapeSettingsObj,a={cancel:!1,action:"rotate-end",previousShapeSettings:o,allowShapeOverflow:this.allowOutofBound()},n={cancel:!1,action:"rotate-end",previousShapeSettings:o,allowShapeOverflow:this.allowOutofBound()};this.triggerShapeChange(a,n,"mouse-up")}if(this.isGrabbing=!1,this.isPreventShaping&&(this.isPreventShaping=!1),this.mouseDown==="canvas"||this.isSliderActive||t.target.closest(".e-image-editor")||t.target.closest(".e-ie-ddb-popup")){t.type==="touchstart"?this.isTouch=!1:t.type==="touchend"&&t.stopImmediatePropagation(),t.preventDefault(),e.togglePan&&this.canvasMouseUpHandler(t);var s=void 0,h=void 0;t.type==="mouseup"?(s=t.clientX,h=t.clientY):this.isTouchDblClick||(s=this.touchEndPoint.x,h=this.touchEndPoint.y);var p=e.lowerCanvas.getBoundingClientRect();s-=p.left,h-=p.top;var u=void 0,c=this.currentDrawingShape,f=!1;if(t.type==="touchend"&&(this.startTouches=this.tempTouches=[],this.isFirstMove=!1,e.textArea.style.display==="none"&&(this.timer=0),this.isPinching)){this.isPinching=!1,e.notify("draw",{prop:"redrawDownScale"}),(e.isCropTab||e.activeObj.shape)&&(e.notify("draw",{prop:"setStraightenActObj",value:{activeObj:null}}),e.notify("freehand-draw",{prop:"resetStraightenPoint"})),e.isStraightening&&(e.notify("draw",{prop:"resetStraightenDestPoints"}),e.notify("draw",{prop:"setDestForStraighten"}));return}var g=!1,v=void 0;if(e.activeObj.shape!==void 0&&(v=e.activeObj.shape.split("-")),v!==void 0&&v[0]==="crop"&&(g=!0),this.currentDrawingShape==="path"&&e.isShapeDrawing){var m=t.srcElement,C=m.parentElement.id,M=e.element.id;t.currentTarget!==e.upperCanvas&&t.currentTarget!==e.lowerCanvas&&e.activeObj.pointColl.length>0&&(m.classList.contains("e-upload-icon")||C===M+"_zoomIn"||C===M+"_zoomOut"||C===M+"_annotationBtn"||C===M+"_borderColorBtn"||C===M+"_borderWidthBtn")&&(e.notify("shape",{prop:"stopPathDrawing",onPropertyChange:!1,value:{e:t,isApply:!0}}),this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),e.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:e.activeObj,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:!0}})),e.currObjType.isDragging&&this.isTouch&&e.activeObj.shape&&e.activeObj.shape==="path"&&(this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),e.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:e.activeObj,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:!0}}));return}if(t.currentTarget===e.upperCanvas&&!e.isResize){if(this.pathAdjustedIndex=null,this.currentDrawingShape!==""){if(this.currentDrawingShape==="text"){var I=y({},e.cropObj,{},!0);e.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeInsert",previousObj:this.initialPrevObj,previousObjColl:this.initialPrevObj.objColl,previousPointColl:this.initialPrevObj.pointColl,previousSelPointColl:this.initialPrevObj.selPointColl,previousCropObj:I,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}})}else e.notify("undo-redo",{prop:"updateUrObj",onPropertyChange:!1,value:{objColl:this.initialPrevObj.objColl,operation:"shapeInsert"}});this.isShapeInserted=!0,this.currentDrawingShape="",(e.activeObj.shape&&e.activeObj.shape==="path"&&e.activeObj.pointColl.length===0||(!e.activeObj.shape||e.activeObj.shape!=="path")&&e.activeObj.activePoint.width===0&&e.activeObj.activePoint.height===0)&&(f=!0,e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height));var N=this.updatePrevShapeSettings(),a={cancel:!1,action:"draw-end",previousShapeSettings:N},n={cancel:!1,action:"move",previousShapeSettings:N};this.shapeResizingArgs=a,this.shapeMovingArgs=n,this.triggerShapeChange(a,n,"mouse-up")}e.activeObj.shape&&e.activeObj.shape==="path"&&e.activeObj.pointColl.length>0&&(e.activeObj.activePoint=e.getSquarePointForPath(e.activeObj)),this.adjustActObjForLineArrow(),this.updPtCollForShpRot(),e.currObjType.shape=e.currObjType.shape.toLowerCase();var O=y({},e.cropObj,{},!0),x={currObj:{}};e.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:x}});var D=x.currObj;D.objColl=y([],e.objColl,[],!0),D.pointColl=y([],e.pointColl,[],!0),D.afterCropActions=y([],e.afterCropActions,[],!0);var A={selPointColl:null};if(e.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:A}}),D.selPointColl=y([],A.selPointColl,[],!0),!e.togglePen&&!g){if(this.tempObjColl&&e.activeObj.activePoint.width!==0){e.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),e.objColl.push(e.activeObj),JSON.stringify(e.activeObj.activePoint)!==JSON.stringify(this.tempActiveObj.activePoint)&&e.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:D,previousObjColl:this.tempObjColl,previousPointColl:D.pointColl,previousSelPointColl:D.selPointColl,previousCropObj:O,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}});var P=y({},e.objColl[e.objColl.length-1],{},!0);e.objColl.pop(),this.redrawShape(P),this.tempObjColl=void 0}this.isFhdEditing||(this.applyCurrActObj(s,h),e.currObjType.isResize=!1,e.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1}))}else if(g&&this.isMouseUp&&e.cursor.indexOf("resize")>-1){var N=this.updatePrevShapeSettings(),a={cancel:!1,action:"resize-end",previousShapeSettings:N};this.triggerShapeChange(a,a,"resize")}if(e.activeObj){var V=!1,q;e.activeObj.shape!==void 0&&(q=e.activeObj.shape.split("-")),(q===void 0&&(e.currObjType.isCustomCrop||e.togglePen)||q!==void 0&&q[0]==="crop")&&(V=!0);var re=e.activeObj.shape;u=re;var ae=["rectangle","ellipse","line","arrow","path"];if(ae.indexOf(re)>-1)e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"shapes",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}});else if(re==="text")e.textArea.style.display==="none"&&e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"text",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}});else if(re==="redact")e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"redact",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}});else if(this.isFhdEditing)e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"pen",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}});else if(!V){var E={type:"main",isApplyBtn:null,isCropping:!1,isZooming:null};e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:E})}if(e.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1}),!this.isFhdEditing){var L=Math.floor(e.activeObj.activePoint.width);if(e.activeObj.shape&&e.activeObj.shape==="text"&&e.activeObj.textSettings.fontSize===11&&Math.floor(e.activeObj.activePoint.height)===11&&(L===55||e.activeObj.textSettings.bold&&L===58)&&(e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),e.drawingShape==="text"&&!e.activeObj.keyHistory&&(e.activeObj.keyHistory="Enter Text")),!V)if(this.adjustActObjForLineArrow(),e.isShapeDrawing){var k=this.currentDrawingShape;e.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1}),this.currentDrawingShape=k}else e.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})}}}if(e.activeObj.shape!==void 0&&(v=e.activeObj.shape.split("-")),v!==void 0&&v[0]==="crop"&&(g=!0),e.activeObj.shape&&!g&&t.currentTarget===e.upperCanvas&&e.textArea.style.display==="none"){if(e.activeObj.shape==="text")e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"text",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}});else if(e.activeObj.shape==="redact")e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"redact",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}});else{var k=this.currentDrawingShape;this.currentDrawingShape="",e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"shapes",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),this.currentDrawingShape=k}e.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1}),e.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}})}var r={freehandDrawSelectedId:null};e.notify("freehand-draw",{prop:"getFreehandDrawSelectedId",onPropertyChange:!1,value:{obj:r}}),e.togglePen&&t.currentTarget===e.upperCanvas&&!r.freehandDrawSelectedId?(e.notify("freehand-draw",{prop:"freehandUpHandler",onPropertyChange:!1,value:{e:t,canvas:e.upperCanvas,context:this.upperContext}}),e.togglePen&&!e.isMaskImage&&(d(e.toolbar)||e.toolbar&&e.toolbar.length>0||!d(e.toolbarTemplate))&&(e.okBtn(),e.freeHandDraw(!0))):e.currObjType.shape="",this.dragElement="",this.mouseDown="",this.isSliderActive=!1,e.currObjType.isInitialLine=e.currObjType.isDragging=!1,this.selMouseUpEvent(),d(e.drawingShape)&&u&&c!==""&&(e.drawingShape=u),e.drawingShape&&(this.currentDrawingShape=e.drawingShape.toLowerCase(),f&&(e.enableShapeDrawing(e.toPascalCase(e.drawingShape),!0),e.upperCanvas.style.cursor="crosshair")),e.isShapeDrawing=!1,e.notify("freehand-draw",{prop:"resetSelPoints",onPropertyChange:!1})}this.isMouseUp=!1}},l.prototype.adjustActObjForLineArrow=function(t){var e=!1,i=this.parent;if(t=t||i.activeObj,t.shape&&(t.shape==="line"||i.activeObj.shape==="arrow")){var r=void 0;if((this.dragElement==="e-resize"&&t.activePoint.endX<t.activePoint.startX||this.dragElement==="w-resize"&&t.activePoint.startX>t.activePoint.endX)&&(e=!0,r=t.activePoint.startX,t.activePoint.startX=t.activePoint.endX,t.activePoint.endX=r,r=t.activePoint.startY,t.activePoint.startY=t.activePoint.endY,t.activePoint.endY=r),t.activePoint.width=Math.abs(t.activePoint.endX-t.activePoint.startX),t.activePoint.height=Math.abs(t.activePoint.endY-t.activePoint.startY),i.activeObj.shape!=="path"){i.notify("shape",{prop:"setPointCollForLineArrow",onPropertyChange:!1,value:{obj:t}});for(var o=0;o<t.pointColl.length;o++)t.pointColl[o].ratioX=(t.pointColl[o].x-i.img.destLeft)/i.img.destWidth,t.pointColl[o].ratioY=(t.pointColl[o].y-i.img.destTop)/i.img.destHeight}}return e},l.prototype.updPtCollForShpRot=function(t){var e=this.parent;if(t=t||e.activeObj,t.shape&&t.rotatedAngle!==0){e.notify("shape",{prop:"setPointCollForShapeRotation",onPropertyChange:!1,value:{obj:t}});var i=e.img,r=i.destLeft,o=i.destTop,a=i.destWidth,n=i.destHeight,s=t.horTopLinePointColl,h=t.horBottomLinePointColl,p=t.verLeftLinePointColl,u=t.verRightLinePointColl,c=function(f){f.ratioX=(f.x-r)/a,f.ratioY=(f.y-o)/n};s.forEach(c),h.forEach(c),p.forEach(c),u.forEach(c)}},l.prototype.setXYPoints=function(t){t.preventDefault();var e,i;t.type==="mousedown"?(e=t.clientX,i=t.clientY):(this.touchEndPoint.x=e=t.touches[0].clientX,this.touchEndPoint.y=i=t.touches[0].clientY);var r=this.parent.lowerCanvas.getBoundingClientRect();return e-=r.left,i-=r.top,{x:e,y:i}},l.prototype.getCurrentIndex=function(){for(var t,e=this.parent,i=0,r=e.objColl.length;i<r;i++)if(e.activeObj.currIndex===e.objColl[i].currIndex){t=i;break}return t},l.prototype.isShapeClick=function(t,e){var i=this.parent,r=!1;if(i.togglePen)return r;if(i.activeObj.shape&&i.activeObj.shape==="text"&&this.isShapeInserted){var o=i.textArea.style.display==="block"||i.textArea.style.display==="inline-block",a=y({},i.activeObj,null,!0);i.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:!0}});var n=this.setXYPoints(t),s=n.x,h=n.y;if(r=this.findTargetObj(s,h,e),e||(this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),r&&i.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:!0}})),o){i.textArea.value=i.objColl[i.objColl.length-1].keyHistory,i.textArea.style.display="block",i.activeObj=a;var p=this.getCurrentIndex();d(p)?i.objColl.pop():i.objColl.splice(p,1)}else if(!r&&a.shape){i.activeObj=a;var p=this.getCurrentIndex();!d(p)&&JSON.stringify(i.activeObj.activePoint)===JSON.stringify(i.objColl[p].activePoint)?i.objColl.splice(p,1):d(i.activeObj.currIndex)&&i.objColl.pop()}}return r},l.prototype.isShapeTouch=function(t,e){var i=this.parent,r=!1;if(t.type==="touchstart"&&!i.togglePen){i.activeObj&&i.activeObj.shape==="text"&&(this.timer=setTimeout(this.setTimer.bind(this),1e3,t));var o=i.textArea.style.display==="block"||i.textArea.style.display==="inline-block",a=y({},i.activeObj,null,!0);i.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:!0}});var n=this.setXYPoints(t),s=n.x,h=n.y;if(r=this.findTargetObj(s,h,e),e||this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),o){i.textArea.value=i.objColl[i.objColl.length-1].keyHistory,i.textArea.style.display="block",i.activeObj=a;var p=this.getCurrentIndex();d(p)?i.objColl.pop():i.objColl.splice(p,1)}else if(!r&&a.shape&&(a.activePoint.width!==0||a.activePoint.height!==0||a.shape==="path"&&a.pointColl.length>0)){i.activeObj=a;var p=this.getCurrentIndex();e||(!d(p)&&JSON.stringify(i.activeObj.activePoint)===JSON.stringify(i.objColl[p].activePoint)?i.objColl.splice(p,1):d(i.activeObj.currIndex)&&i.objColl.pop())}}return r},l.prototype.isFreehandDrawTouch=function(t,e){var i=this.parent,r=!1;if(t.type==="touchstart"&&!e&&!i.togglePen){var o=i.textArea.style.display==="block"||i.textArea.style.display==="inline-block",a=y({},i.activeObj,null,!0);i.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:!0}});var n=this.setXYPoints(t),s=n.x,h=n.y;if(this.setCursor(s,h),this.isFhdPoint&&(r=!0),o){i.textArea.value=i.objColl[i.objColl.length-1].keyHistory,i.textArea.style.display="block",i.activeObj=a;var p=this.getCurrentIndex();d(p)?i.objColl.pop():i.objColl.splice(p,1)}else if(a.shape){i.activeObj=a;var p=this.getCurrentIndex();e||(!d(p)&&JSON.stringify(i.activeObj.activePoint)===JSON.stringify(i.objColl[p].activePoint)?i.objColl.splice(p,1):d(i.activeObj.currIndex)&&i.objColl.pop())}}return r},l.prototype.applyObj=function(t,e){var i=this.parent,r=!1;if(i.activeObj.activePoint.width===0&&i.activeObj.activePoint.height===0)return!1;var o=["rectangle","ellipse","line","arrow","path","image","text"],a=i.activeObj.activePoint,n=a.startX,s=a.startY,h=a.endX,p=a.endY;if(i.activeObj.shape&&o.indexOf(i.activeObj.shape)>-1){var u=i.activeObj.topLeftCircle.radius;t>=n-u*2&&t<=h+u*2&&e>=s-u*2&&e<=p+u*2||i.upperCanvas.style.cursor!=="default"&&i.upperCanvas.style.cursor!=="grab"&&i.upperCanvas.style.cursor!=="crosshair"&&i.upperCanvas.style.cursor!=="pointer"&&i.upperCanvas.style.cursor!=="move"?r=!1:r=!0}return r},l.prototype.applyCurrShape=function(t){var e=this.parent,i=!1;if(e.togglePen)return i;var r=y({},e.activeObj,null,!0);if(this.isShapeInserted&&e.activeObj.shape==="text"&&t&&(this.isInitialTextEdited=!0,e.notify("draw",{prop:"setShapeTextInsert",onPropertyChange:!1,value:{bool:!0}})),e.textArea.style.display==="block"||e.textArea.style.display==="inline-block"){var o=y({},e.activeObj,null,!0);e.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:null}}),r=y({},e.objColl[e.objColl.length-1],null,!0),e.objColl.pop(),e.activeObj=y({},o,null,!0),e.textArea.value=r.keyHistory,e.textArea.style.display="block";var a=r.strokeSettings&&r.strokeSettings.strokeColor?r.strokeSettings.strokeColor.split("(")[0]==="rgb"?this.rgbToHex(parseFloat(r.strokeSettings.strokeColor.split("(")[1].split(",")[0]),parseFloat(r.strokeSettings.strokeColor.split("(")[1].split(",")[1]),parseFloat(r.strokeSettings.strokeColor.split("(")[1].split(",")[2]),parseFloat(r.strokeSettings.strokeColor.split("(")[1].split(",")[3])):r.strokeSettings.strokeColor:null;a&&a==="#ffffff"&&(a="#fff"),this.tempActiveObj.strokeSettings&&this.tempActiveObj.strokeSettings.strokeColor&&this.tempActiveObj.strokeSettings.strokeColor==="#ffffff"&&(this.tempActiveObj.strokeSettings.strokeColor="#fff"),(r.keyHistory!==this.tempActiveObj.keyHistory||a&&a!==this.tempActiveObj.strokeSettings.strokeColor||r.textSettings&&r.textSettings.fontFamily!==this.tempActiveObj.textSettings.fontFamily||r.textSettings&&Math.round(r.textSettings.fontSize)!==Math.round(this.tempActiveObj.textSettings.fontSize)||r.textSettings&&Math.round(r.textSettings.fontRatio)!==Math.round(this.tempActiveObj.textSettings.fontRatio)||r.textSettings&&r.textSettings.bold!==this.tempActiveObj.textSettings.bold||r.textSettings&&r.textSettings.italic!==this.tempActiveObj.textSettings.italic||r.textSettings&&r.textSettings.underline!==this.tempActiveObj.textSettings.underline)&&(i=!0),this.isInitialTextEdited&&!i&&(i=!0,this.isInitialTextEdited=!1)}else this.tempActiveObj.activePoint.height=Math.abs(this.tempActiveObj.activePoint.height),i=JSON.stringify(r)!==JSON.stringify(this.tempActiveObj);return i},l.prototype.canvasMouseDownHandler=function(t){var e=this.parent;t.preventDefault();var i,r;t.type==="mousedown"?(i=t.offsetX||t.pageX-e.lowerCanvas.offsetLeft,r=t.offsetY||t.pageY-e.lowerCanvas.offsetTop):(i=t.touches[0].clientX||t.touches[0].pageX-e.lowerCanvas.offsetLeft,r=t.touches[0].clientY||t.touches[0].pageY-e.lowerCanvas.offsetTop);var o=e.lowerCanvas.getBoundingClientRect();i-=o.left,r-=o.top,this.panDown={x:i,y:r};var a={tempPanMove:null};e.notify("transform",{prop:"getTempPanMove",onPropertyChange:!1,value:{obj:a}}),d(a.tempPanMove)&&e.notify("transform",{prop:"setTempPanMove",onPropertyChange:!1,value:{point:{x:i,y:r}}})},l.prototype.canvasMouseMoveHandler=function(t){var e=this.parent,i={bool:null};if(e.notify("toolbar",{prop:"getFrameToolbar",onPropertyChange:!1,value:{obj:i}}),e.isResize||i.bool){e.upperCanvas.style.cursor="default";return}this.dragCanvas?e.lowerCanvas.style.cursor="grab":(this.dragCanvas=e.togglePan=!1,e.lowerCanvas.style.cursor=e.upperCanvas.style.cursor=e.cursor="default");var r,o;t.type==="mousemove"?(r=t.offsetX,o=t.offsetY):(r=t.touches[0].clientX||t.touches[0].pageX-e.lowerCanvas.offsetLeft,o=t.touches[0].clientY||t.touches[0].pageY-e.lowerCanvas.offsetTop);var a=e.lowerCanvas.getBoundingClientRect();r-=a.left,o-=a.top;var n={x:r,y:o};e.notify("transform",{prop:"setPanMove",onPropertyChange:!1,value:{point:{x:r,y:o}}}),this.panDown&&n&&e.togglePan&&this.dragCanvas&&((e.isCropTab||e.activeObj.shape)&&(e.notify("draw",{prop:"setStraightenActObj",value:{activeObj:null}}),e.notify("freehand-draw",{prop:"resetStraightenPoint"})),e.notify("transform",{prop:"drawPannedImage",onPropertyChange:!1,value:{xDiff:null,yDiff:null}}))},l.prototype.canvasMouseUpHandler=function(t){var e=this.parent;t.preventDefault();var i={panMove:null};e.notify("transform",{prop:"getPanMove",onPropertyChange:!1,value:{obj:i}}),e.togglePan&&this.panDown&&i.panMove&&e.togglePan&&this.dragCanvas&&(this.panDown=null,e.notify("transform",{prop:"setPanMove",onPropertyChange:!1,value:{point:null}})),e.notify("transform",{prop:"setTempPanMove",onPropertyChange:!1,value:{point:null}}),this.currentDrawingShape!=="path"&&(e.currObjType.isDragging=!1)},l.prototype.touchStartHandler=function(t){t.preventDefault();var e=this.parent;if(this.touchTime===0)this.touchTime=new Date().getTime();else if(new Date().getTime()-this.touchTime<400){this.isTouchDblClick=!0;var i=e.isShapeDrawing;if(e.notify("shape",{prop:"stopPathDrawing",onPropertyChange:!1,value:{e:t,isApply:null}}),this.isTouchDblClick=!1,this.touchTime=0,i!==e.isShapeDrawing&&e.activeObj.shape&&e.activeObj.shape==="path")return}else this.touchTime=new Date().getTime();t.touches.length===2?this.isFirstMove=!0:this.mouseDownEventHandler(t),b.add(e.lowerCanvas,"touchend",this.mouseUpEventHandler,this),b.add(e.lowerCanvas,"touchmove",this.mouseMoveEventHandler,this),b.add(e.upperCanvas,"touchend",this.mouseUpEventHandler,this),b.add(e.upperCanvas,"touchmove",this.mouseMoveEventHandler,this)},l.prototype.unwireEvent=function(){var t=this.parent;b.remove(t.lowerCanvas,"touchend",this.mouseUpEventHandler),b.remove(t.lowerCanvas,"touchmove",this.mouseMoveEventHandler),b.remove(t.upperCanvas,"touchend",this.mouseUpEventHandler),b.remove(t.upperCanvas,"touchmove",this.mouseMoveEventHandler)},l.prototype.keyDownEventHandler=function(t){var e=this.parent;t.ctrlKey&&(t.key==="+"||t.key==="-")&&t.preventDefault();var i={fileName:"",fileType:null};e.notify("draw",{prop:"getFileName",onPropertyChange:!1,value:{obj:i}});var r={fileName:i.fileName,fileType:i.fileType,cancel:!1};switch(t.key){case(t.ctrlKey&&"s"):e.trigger("beforeSave",r),this.beforeSaveEvent(r,t);break;case(t.ctrlKey&&"z"):e.allowUndoRedo&&(e.noPushUndo=!1,(e.togglePen||e.drawingShape)&&(e.okBtn(),e.drawingShape=null),e.notify("undo-redo",{prop:"call-undo"}));break;case(t.ctrlKey&&"y"):e.allowUndoRedo&&(e.noPushUndo=!1,(e.togglePen||e.drawingShape)&&(e.okBtn(),e.drawingShape=null),e.notify("undo-redo",{prop:"call-redo"}));break;case(t.ctrlKey&&"+"):(e.zoomSettings.zoomTrigger&ze.Commands)===ze.Commands&&(this.zoomType="Commands",e.isZoomBtnClick=!0,e.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:.1,zoomPoint:null},isResize:null}),e.notify("draw",{prop:"redrawDownScale"}),(e.isCropTab||e.activeObj.shape)&&(e.notify("draw",{prop:"setStraightenActObj",value:{activeObj:null}}),e.notify("freehand-draw",{prop:"resetStraightenPoint"})),e.isStraightening&&(e.notify("draw",{prop:"resetStraightenDestPoints"}),e.notify("draw",{prop:"setDestForStraighten"})));break;case(t.ctrlKey&&"-"):(e.zoomSettings.zoomTrigger&ze.Commands)===ze.Commands&&(this.zoomType="Commands",e.isZoomBtnClick=!0,e.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-.1,zoomPoint:null},isResize:null}),e.notify("draw",{prop:"redrawDownScale"}),(e.isCropTab||e.activeObj.shape)&&(e.notify("draw",{prop:"setStraightenActObj",value:{activeObj:null}}),e.notify("freehand-draw",{prop:"resetStraightenPoint"})),e.isStraightening&&(e.notify("draw",{prop:"resetStraightenDestPoints"}),e.notify("draw",{prop:"setDestForStraighten"})));break;case"Delete":this.deleteItem();break;case"Escape":e.notify("draw",{prop:"performCancel",value:{isContextualToolbar:null,isFinalCancel:!0}});break;case"Enter":this.performEnterAction(t);break;case"Tab":this.performTabAction();break;default:S.isDevice&&(e.textArea.style.display==="block"||e.textArea.style.display==="inline-block")&&setTimeout(this.textKeyDown.bind(this),1,t);break}},l.prototype.performEnterAction=function(t){var e=this.parent;if(e.isResize){var i=t.target,r=!!(i.id.indexOf("aspectratio")||i.id.indexOf("non-aspectratio")>-1),o=this.isValueUpdated();if(!o){r&&this.focusRatioBtn();return}var a=this.getNumTextValue(),n=e.element.querySelector("#"+e.element.id+"_aspectratio"),s=e.element.querySelector(".e-ie-toolbar-aspect-ratio-btn");a&&a.x&&a.y&&(n||s&&!s.classList.contains("e-hidden")?e.notify("transform",{prop:"resize",value:{width:a.x,height:null,isAspectRatio:!0}}):e.notify("transform",{prop:"resize",value:{width:a.x,height:a.y,isAspectRatio:!1}}));var h=e.element.querySelector("#"+e.element.id+"_resizeHeight"),p=e.element.querySelector("#"+e.element.id+"_resizeWidth");if(d(n)){if(h){var u=Q(h,"numerictextbox");h&&h.value===""&&(u.value=parseFloat(u.placeholder),h.value=u.placeholder+"px")}if(p){var u=Q(p,"numerictextbox");p&&p.value===""&&(u.value=parseFloat(u.placeholder),p.value=u.placeholder+"px")}}e.notify("draw",{prop:"redrawDownScale"}),r&&this.focusRatioBtn()}else if(t.target.classList.contains("e-upload")){var c=e.element.querySelector(".e-image-upload");c&&c.querySelector(".e-tbar-btn")&&c.querySelector(".e-tbar-btn").click()}else if(t.target.classList.contains("filter-wrapper"))t.target.parentElement.click();else{var f=void 0;e.activeObj.shape&&(f=e.activeObj.shape.split("-")),t&&this.isKeyBoardCrop(t)&&e.activeObj.horTopLine&&e.activeObj.shape&&f[0]==="crop"&&e.crop()}},l.prototype.focusRatioBtn=function(){var t=this.parent.element.id;this.parent.isKBDNavigation&&setTimeout(function(){document.getElementById(t+"_aspectratio")?document.getElementById(t+"_aspectratio").focus():document.getElementById(t+"_nonaspectratio")&&document.getElementById(t+"_nonaspectratio").focus()},50)},l.prototype.isKeyBoardCrop=function(t){var e=!1,i=t.target;return(i.id===this.parent.element.id+"_ok"||i.id==="")&&(e=!0),e},l.prototype.beforeSaveEvent=function(t,e){var i=this.parent;t.cancel||i.notify("export",{prop:"export",onPropertyChange:!1,value:{type:t.fileType,fileName:t.fileName}}),e.preventDefault(),e.stopImmediatePropagation()},l.prototype.handleScroll=function(t){this.mouseWheel++;var e=this.parent,i,r,o=!1;t.type==="mousewheel"&&(i=t.clientX,r=t.clientY);var a=e.lowerCanvas.getBoundingClientRect();if(i-=a.left,r-=a.top,i>e.img.destLeft&&i<e.img.destLeft+e.img.destWidth&&r>e.img.destTop&&r<e.img.destTop+e.img.destHeight&&(o=!0),this.mouseWheel===2){this.mouseWheel=0,t.ctrlKey===!0&&o&&t.preventDefault();return}if(t.stopPropagation(),t.ctrlKey===!0&&o){t.preventDefault(),!e.isCropTab&&e.activeObj.shape&&e.activeObj.shape.split("-")[0]!=="crop"&&(e.okBtn(null,!0),e.notify("toolbar",{prop:"close-contextual-toolbar",onPropertyChange:!1}));var n="";t.type==="mousewheel"&&(e.zoomSettings.zoomTrigger&ze.MouseWheel)===ze.MouseWheel&&(this.zoomType="MouseWheel",t.wheelDelta>0?n="zoomIn":n="zoomOut"),n!==""&&(e.isZoomBtnClick=!0,e.notify("draw",{prop:"performPointZoom",onPropertyChange:!1,value:{x:i,y:r,type:n,isResize:null}}),e.notify("draw",{prop:"redrawDownScale"}),(e.isCropTab||e.activeObj.shape)&&(e.notify("draw",{prop:"setStraightenActObj",value:{activeObj:null}}),e.notify("freehand-draw",{prop:"resetStraightenPoint"})),e.isStraightening&&(e.notify("draw",{prop:"resetStraightenDestPoints"}),e.notify("draw",{prop:"setDestForStraighten"})))}},l.prototype.textKeyDown=function(t){var e=this.parent;if(e.activeObj.rotatedAngle===0){String.fromCharCode(t.which)==="\r"&&(this.textRow+=1),e.textArea.setAttribute("rows",this.textRow.toString()),e.textArea.style.height="auto",e.textArea.style.height=e.textArea.scrollHeight+"px",e.notify("shape",{prop:"setTextBoxWidth",onPropertyChange:!1,value:{e:t}}),S.isDevice&&(e.textArea.style.width=parseFloat(e.textArea.style.width)+e.textArea.style.fontSize+"px");var i=e.textArea.value.split(`
`);this.textRow=i.length,e.textArea.setAttribute("rows",this.textRow.toString()),this.isInitialTextEdited=!1}},l.prototype.clearSelection=function(t){var e=this.parent;!e.disabled&&e.isImageLoaded&&(t?e.notify("draw",{prop:"performCancel",value:{isContextualToolbar:null}}):(e.togglePen=!1,e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.dragElement="",this.dragPoint.startX=this.dragPoint.startY=this.dragPoint.endX=this.dragPoint.endY=0,e.currObjType.shape="",this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),e.currObjType.isActiveObj=!0,e.currObjType.isCustomCrop=!1,e.upperCanvas.style.cursor=e.cursor="default"))},l.prototype.setDragDirection=function(t,e){var i=7.5,r=this.parent,o=r.activeObj.activePoint;r.img.destWidth>r.img.destHeight?(o.startX=this.dragPoint.startX=t/2-e/2+i,o.startY=this.dragPoint.startY=e/2-e/2+i,o.endX=t/2+e/2-i,o.endY=e/2+e/2-i):(o.startY=this.dragPoint.startX=e/2-t/2+i,o.endY=e/2+t/2-i,o.startX=this.dragPoint.startX=i,o.endX=t-i)},l.prototype.calcShapeRatio=function(t,e,i,r){for(var o=this.parent,a=o.activeObj.activePoint,n=7.5,s=t/e,h=i,p=r,u=h>=p?h:p,c=u*s,f=u,g=this.getScale(c,h),v=[],m=o.img,C=m.destLeft,M=m.destTop,I=m.destWidth,N=m.destHeight,O=0;O<2;O++)O===0?v.push(c*g):v.push(f*g);c=v[0],f=v[1];for(var x=this.getScale(f,p),D=[],O=0;O<2;O++)O===0?D.push(c*x):D.push(f*x);c=D[0],f=D[1],a.width=c,a.height=f,a.startX=(this.dragPoint.startX=(h-c)/2)+n,a.startY=(this.dragPoint.startY=(p-f)/2)+n,a.endX=a.startX+a.width,a.endY=a.startY+a.height,a.startX<C&&C+I>o.lowerCanvas.clientWidth&&(a.startX=C,a.endX=a.startX+c-n),a.startY<M&&M+N>o.lowerCanvas.clientHeight&&(a.startY=M,a.endY=a.startY+f-n),a.width=a.endX-a.startX,a.height=a.endY-a.startY},l.prototype.getScale=function(t,e){return t>e?e/t:1},l.prototype.findTarget=function(t,e,i){var r=this.parent;if(i.toLowerCase()==="mousedown"||i.toLowerCase()==="touchstart"){var o=void 0,a=!1;r.activeObj.shape&&(o=r.activeObj.shape.split("-"),o[0]==="crop"&&(a=!0)),this.findTargetObj(t,e,a),this.updateCursorStyles(t,e,i)}else{var n=r.activeObj,s=n.topLeftCircle,h=n.topCenterCircle,p=n.topRightCircle,u=n.centerLeftCircle,c=n.centerRightCircle,f=n.bottomLeftCircle,g=n.bottomCenterCircle,v=n.bottomRightCircle;switch(this.dragElement.toLowerCase()){case"nw-resize":s.startX=t,s.startY=e;break;case"n-resize":h.startX=t,h.startY=e;break;case"ne-resize":p.startX=t,p.startY=e;break;case"w-resize":u.startX=t,u.startY=e;break;case"e-resize":c.startX=t,c.startY=e;break;case"sw-resize":f.startX=t,f.startY=e;break;case"s-resize":g.startX=t,g.startY=e;break;case"se-resize":v.startX=t,v.startY=e;break;default:this.dragPoint.startX&&this.dragPoint.startY&&(this.previousPoint.x=this.dragPoint.endX,this.previousPoint.y=this.dragPoint.endY,this.dragPoint.endX=t,this.dragPoint.endY=e);break}}},l.prototype.findTargetObj=function(t,e,i){var r=this.parent,o=!1;if(r.objColl.length!==0&&!r.currObjType.isCustomCrop&&!i){for(var a=0,n=void 0,s=0;s<r.objColl.length;s++){var h=r.upperCanvas.style.cursor;this.setCursor(t,e);var p=y({},r.objColl[s],{},!0),u=p.topLeftCircle.radius;if(p.shape==="line"||p.shape==="arrow"){for(var c=0;c<p.pointColl.length;c++)if(t>=p.pointColl[c].x-u*2&&t<=p.pointColl[c].x+u*2&&e>=p.pointColl[c].y-u*2&&e<=p.pointColl[c].y+u*2){if(this.tempActiveObj&&this.tempActiveObj.activePoint&&JSON.stringify(this.tempActiveObj.activePoint)===JSON.stringify(p.activePoint)){n=s;break}else this.isTouch||r.cursor==="move"||r.cursor==="grab"||this.isShapeInserted?(a===0||a<p.order)&&(a=p.order,n=s):r.objColl[s].currIndex===this.tempActiveObj.currIndex&&(n=s);break}}else if(p.shape==="path"){var f=this.setCursorForPath(p,t,e,r.upperCanvas);if(f!=="default"&&f!=="grab")if(this.tempActiveObj&&this.tempActiveObj.activePoint&&JSON.stringify(this.tempActiveObj.activePoint)===JSON.stringify(p.activePoint)){n=s;break}else this.isTouch||r.cursor==="move"||r.cursor==="grab"||this.isShapeInserted?(a===0||a<p.order)&&(a=p.order,n=s):r.objColl[s].currIndex===this.tempActiveObj.currIndex&&(n=s)}else if(p.rotatedAngle!==0){var g=this.setCursorForRotatedObject(p,t,e,r.upperCanvas);if(g!=="default"&&g!=="grab")if(this.tempActiveObj&&this.tempActiveObj.activePoint&&JSON.stringify(this.tempActiveObj.activePoint)===JSON.stringify(p.activePoint)){n=s;break}else this.isTouch||r.cursor==="move"||r.cursor==="grab"||this.isShapeInserted?(a===0||a<p.order&&(p.shape!=="redact"||r.drawingShape==="redact"))&&(a=p.order,n=s):r.objColl[s].currIndex===this.tempActiveObj.currIndex&&(n=s)}else{var v=this.getTransRotationPoint(p);if(t>=p.activePoint.startX-u*2&&t<=p.activePoint.endX+u*2&&e>=p.activePoint.startY-u*2&&e<=p.activePoint.endY+u*2||v&&t>=v.x-u*2&&t<=v.x+u*2&&e>=v.y-u*2&&e<=v.y+u*2)if(this.tempActiveObj&&this.tempActiveObj.activePoint&&JSON.stringify(this.tempActiveObj.activePoint)===JSON.stringify(p.activePoint)){n=s;break}else this.isTouch||h==="move"||h==="grabbing"||this.isShapeInserted||r.cursor==="move"||r.cursor==="grabbing"?(a===0||a<p.order&&(p.shape!=="redact"||r.drawingShape==="redact"))&&(a=p.order,n=s):r.objColl[s].currIndex===this.tempActiveObj.currIndex&&(n=s)}}if(d(n))r.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),o=!1;else{this.tempObjColl=y([],r.objColl,[],!0),r.currObjType.isCustomCrop=!1,r.activeObj=y({},r.objColl[n],{},!0);var m=y({},r.objColl[n],{},!0);if(r.objColl.splice(n,1),r.transform.degree===0){var C=this.lowerContext.filter;this.lowerContext.clearRect(0,0,r.lowerCanvas.width,r.lowerCanvas.height),r.notify("draw",{prop:"drawImage",onPropertyChange:!1}),this.lowerContext.filter="none",r.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"iterate",pen:"iterate",isPreventApply:null}}),r.activeObj=y({},C,{},!0),this.lowerContext.filter=C,this.getCurrentFlipState()}else{var M=y({},r.panPoint.totalPannedInternalPoint,{},!0),I={startX:r.img.destLeft,startY:r.img.destTop,width:r.img.destWidth,height:r.img.destHeight};r.notify("draw",{prop:"callUpdateCurrTransState",onPropertyChange:!1}),r.panPoint.totalPannedInternalPoint=M,r.img.destLeft=I.startX,r.img.destTop=I.startY,r.img.destWidth=I.width,r.img.destHeight=I.height,r.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"iterate",pen:"iterate",isPreventApply:null}})}r.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),(r.currSelectionPoint&&r.currSelectionPoint.shape==="crop-circle"||r.isCircleCrop)&&r.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),r.activeObj=y({},m,{},!0),this.setActivePoint(),r.activeObj=y({},m,{},!0);var N=y({},r.activeObj.strokeSettings,{},!0);r.notify("draw",{prop:"setTempStrokeSettings",onPropertyChange:!1,value:{tempStrokeSettings:N}});var O=y({},r.activeObj.textSettings,{},!0);r.notify("draw",{prop:"setTempTextSettings",onPropertyChange:!1,value:{tempTextSettings:O}});var x=this.updatePrevShapeSettings(),D={cancel:!1,action:"select",previousShapeSettings:x,currentShapeSettings:x,allowShapeOverflow:this.allowOutofBound()};(r.activeObj.shape==="line"||r.activeObj.shape==="arrow")&&(D.currentShapeSettings.width=r.activeObj.activePoint.endX-r.activeObj.activePoint.startX,D.currentShapeSettings.height=r.activeObj.activePoint.endY-r.activeObj.activePoint.startY),this.isCropSelection=!1;var A=void 0;if(r.activeObj.shape!==void 0&&(A=r.activeObj.shape.split("-")),A!==void 0&&A[0]==="crop"&&(this.isCropSelection=!0),!this.isCropSelection&&r.activeObj.shape!=="redact")r.trigger("shapeChanging",D),this.shapeEvent(D),r.editCompleteArgs=D;else{this.isMouseDown?D.action="resize-start":this.isMouseUp&&(D.action="resize-end");var P={action:D.action,previousSelectionSettings:{type:r.getSelectionType(r.activeObj.shape),startX:D.previousShapeSettings.startX,startY:D.previousShapeSettings.startY,width:D.previousShapeSettings.width,height:D.previousShapeSettings.height},currentSelectionSettings:{type:r.getSelectionType(r.activeObj.shape),startX:D.currentShapeSettings.startX,startY:D.currentShapeSettings.startY,width:D.currentShapeSettings.width,height:D.currentShapeSettings.height}};r.trigger("selectionChanging",P),r.editCompleteArgs=P,D.currentShapeSettings.startX=P.currentSelectionSettings.startX,D.currentShapeSettings.startY=P.currentSelectionSettings.startY,D.currentShapeSettings.width=P.currentSelectionSettings.width,D.currentShapeSettings.height=P.currentSelectionSettings.height,this.shapeEvent(D)}o=!0}}return o},l.prototype.shapeEvent=function(t){var e=this.parent;if(e.notify("shape",{prop:"updateShapeChangeEventArgs",onPropertyChange:!1,value:{shapeSettings:t.currentShapeSettings,allowShapeOverflow:t.allowShapeOverflow}}),e.activeObj.activePoint){var i={prevActObj:null};e.notify("draw",{prop:"getPrevActObj",onPropertyChange:!1,value:{obj:i}}),d(i.prevActObj)&&e.notify("draw",{prop:"setPrevActObj",onPropertyChange:!1,value:{prevActObj:y({},e.activeObj,{},!0)}}),e.activeObj.shape==="image"&&!this.isImageClarity&&(this.upgradeImageQuality(),this.isImageClarity=!0),e.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:e.activeObj,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:!0}}),this.isShapeInserted||(this.isPreventDragging=this.isShapeDragOut())}},l.prototype.upgradeImageQuality=function(){var t=this.parent;if(t.activeObj.imageCanvas){var e=y({},t.activeObj,null,!0),i=t.activeObj.imageCanvas.getContext("2d"),r={width:0,height:0};t.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:t.activeObj.imageElement.width,height:t.activeObj.imageElement.height,obj:r,isImgShape:null}}),t.notify("shape",{prop:"updateObj",onPropertyChange:!1,value:{dimObj:r,x:null,y:null}}),i.clearRect(0,0,t.activeObj.imageCanvas.width,t.activeObj.imageCanvas.height),this.applyTransformToImg(i),t.activeObj=e}},l.prototype.applyTransformToImg=function(t){var e=this.parent;e.activeObj.isHorImageFlip&&e.activeObj.isVerImageFlip?(e.activeObj.isHorImageFlip=e.activeObj.isVerImageFlip=!1,e.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:t,isImgAnnotation:!0,isHFlip:!0,isVFlip:!0}})):e.activeObj.isHorImageFlip?(e.activeObj.isHorImageFlip=!1,e.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:t,isImgAnnotation:!0,isHFlip:!0,isVFlip:!1}})):e.activeObj.isVerImageFlip?(e.activeObj.isVerImageFlip=!1,e.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:t,isImgAnnotation:!0,isHFlip:!1,isVFlip:!0}})):e.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:t,isImgAnnotation:!0,isHFlip:!1,isVFlip:!1}})},l.prototype.targetTouches=function(t){var e=this.parent.lowerCanvas.getBoundingClientRect(),i={x:t[0].pageX-e.left,y:t[0].pageY-e.top},r={x:t[1].pageX-e.left,y:t[1].pageY-e.top},o=[i,r];return o},l.prototype.calculateScale=function(t,e){var i=this.getDistance(t[0],t[1]),r=this.getDistance(e[0],e[1]);return r/i},l.prototype.getDistance=function(t,e){var i=0,r=0;return t&&e&&(i=t.x-e.x,r=t.y-e.y),Math.sqrt(i*i+r*r)},l.prototype.redrawShape=function(t,e){for(var i=this.parent,r=0,o=i.objColl.length;r<o;r++)if(JSON.stringify(t)===JSON.stringify(i.objColl[r])){if(i.objColl.splice(r,1),t.shape&&i.textArea.style.display==="none"){var a=y({},t,{},!0);i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.lowerContext.clearRect(0,0,i.lowerCanvas.width,i.lowerCanvas.height),i.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),i.rotateFlipColl.length>0&&(i.panPoint.totalPannedClientPoint.x!==0||i.panPoint.totalPannedClientPoint.y!==0)&&i.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),t=i.activeObj=a}break}t.shape==="path"&&t.pointColl.length===0||t.shape!=="path"&&t.activePoint.width===0&&t.activePoint.height===0||(this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),this.isPreventDragging?(i.activeObj.activePoint.startX>i.img.destLeft&&(this.isPreventDragging=!1),e&&i.activeObj.rotatedAngle!==0?i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:null,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:null}}):i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:null,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:null}})):e&&i.activeObj.rotatedAngle!==0?i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:null,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:null}}):(i.activeObj.shape==="redact"&&(this.lowerContext.clearRect(0,0,i.lowerCanvas.width,i.lowerCanvas.height),i.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}})),i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:null,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:null}})))},l.prototype.setTimer=function(t){var e=this.parent;this.timer>10&&(clearTimeout(this.timer),this.timer=0,e.notify("shape",{prop:"findTextTarget",onPropertyChange:!1,value:{e:t}}),S.isDevice&&this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height))},l.prototype.applyCurrActObj=function(t,e){var i=this.parent,r=!1,o=y({},i.activeObj,{},!0);if(!d(o.activePoint)){var a=o.activePoint,n=a.startX,s=a.startY,h=a.endX,p=a.endY,u=o.topLeftCircle?o.topLeftCircle.radius:0;if(t>=Math.floor(n)&&t<=Math.ceil(h)&&e>=Math.floor(s)&&e<=Math.ceil(p))r=!0;else if(u!==0&&t>=Math.floor(n)-u&&t<=Math.ceil(h)+u&&e>=Math.floor(s)-u&&e<=Math.ceil(p)+u)r=!0,this.tempActiveObj={activePoint:{startX:0,startY:0,endX:0,endY:0,width:0,height:0},flipObjColl:[],triangle:[],triangleRatio:[]};else if((o.shape==="text"||o.shape==="image")&&this.dragElement!=="")r=!0;else if(o.shape==="line"||o.shape==="arrow"){var c={x:n<h?n:h,y:s<p?s:p},f={x:n>h?n:h,y:s>p?s:p};(t>=Math.floor(c.x)-5&&t<=Math.ceil(f.x)+5&&e>=Math.floor(c.y)-5&&e<=Math.ceil(f.y)+5||i.activeObj.preventShapeDragOut)&&(r=!0)}else if(o.shape==="path"){var g=this.setCursorForPath(o,t,e,i.upperCanvas);g==="move"&&(r=!0)}else if(this.dragElement==="grabbing")r=!0;else if(o.rotatedAngle!==0){var g=this.setCursorForRotatedObject(o,t,e,i.upperCanvas);(g!=="default"&&g!=="grab"||this.dragElement==="n-resize"||this.dragElement==="e-resize"||this.dragElement==="s-resize"||this.dragElement==="w-resize")&&(r=!0)}else(i.textArea.style.display==="block"||i.textArea.style.display==="inline-block")&&(r=!0);if(!r){if(d(i.activeObj.currIndex)){var v={id:"shape_"+(i.objColl.length+1)};i.notify("shape",{prop:"getNewShapeId",onPropertyChange:!1,value:{obj:v}}),i.activeObj.currIndex=v.id}i.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),i.activeObj.horTopLine!==void 0&&i.activeObj.horTopLine.startX!==0&&i.activeObj.horTopLine.endX!==0&&!i.currObjType.isCustomCrop&&i.currObjType.shape!==""&&i.objColl.length>0&&JSON.stringify(i.objColl[i.objColl.length-1].activePoint)!==JSON.stringify(i.activeObj.activePoint)&&i.objColl.push(y({},i.activeObj,{},!0));var m=["rectangle","ellipse","line","arrow","path","text","image"];if(m.indexOf(i.activeObj.shape)>-1){var C=this.lowerContext.filter;this.lowerContext.filter="brightness(1) contrast(100%) hue-rotate(0deg) saturate(100%) opacity(1) blur(0px) sepia(0%) grayscale(0%) invert(0%)",i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),this.lowerContext.filter=C,i.activeObj.shape&&i.notify("shape",{prop:"apply",onPropertyChange:!1,value:{shape:null,obj:null,canvas:null}}),i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}}),i.isCircleCrop&&i.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}})}i.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1})}}},l.prototype.getCurrentFlipState=function(){var t=this.parent;if(t.rotateFlipColl.length!==0){var e=y({},t.panPoint.totalPannedInternalPoint,{},!0);t.notify("draw",{prop:"callUpdateCurrTransState",onPropertyChange:!1}),t.panPoint.totalPannedInternalPoint=e}else t.notify("draw",{prop:"callUpdateCurrTransState",onPropertyChange:!1})},l.prototype.setTextBoxStylesToActObj=function(){var t=this.parent;t.activeObj.textSettings.fontFamily=t.textArea.style.fontFamily,t.activeObj.strokeSettings.strokeColor=t.textArea.style.color!==""&&t.textArea.style.color.split("(")[1]&&t.textArea.style.color.split("(")[1].split(",")[0]&&t.textArea.style.color.split("(")[1].split(",")[1]&&t.textArea.style.color.split("(")[1].split(",")[2]&&t.textArea.style.color.split("(")[1].split(",")[3]?this.rgbToHex(parseFloat(t.textArea.style.color.split("(")[1].split(",")[0]),parseFloat(t.textArea.style.color.split("(")[1].split(",")[1]),parseFloat(t.textArea.style.color.split("(")[1].split(",")[2]),parseFloat(t.textArea.style.color.split("(")[1].split(",")[3])):t.textArea.style.color,t.activeObj.strokeSettings.fillColor=t.textArea.style.backgroundColor!==""&&t.textArea.style.backgroundColor.split("(")[1]&&t.textArea.style.backgroundColor.split("(")[1].split(",")[0]&&t.textArea.style.backgroundColor.split("(")[1].split(",")[1]&&t.textArea.style.backgroundColor.split("(")[1].split(",")[2]&&t.textArea.style.backgroundColor.split("(")[1].split(",")[3]?this.rgbToHex(parseFloat(t.textArea.style.backgroundColor.split("(")[1].split(",")[0]),parseFloat(t.textArea.style.backgroundColor.split("(")[1].split(",")[1]),parseFloat(t.textArea.style.backgroundColor.split("(")[1].split(",")[2]),parseFloat(t.textArea.style.backgroundColor.split("(")[1].split(",")[3])):t.textArea.style.backgroundColor,t.activeObj.strokeSettings.outlineColor=t.textArea.style.textShadow!==""&&t.textArea.style.textShadow.split("(")[1]&&t.textArea.style.textShadow.split("(")[1].split(",")[0]&&t.textArea.style.textShadow.split("(")[1].split(",")[1]&&t.textArea.style.textShadow.split("(")[1].split(",")[2]&&t.textArea.style.textShadow.split("(")[1].split(",")[3]?this.rgbToHex(parseFloat(t.textArea.style.textShadow.split("(")[1].split(",")[0]),parseFloat(t.textArea.style.textShadow.split("(")[1].split(",")[1]),parseFloat(t.textArea.style.textShadow.split("(")[1].split(",")[2]),parseFloat(t.textArea.style.textShadow.split("(")[1].split(",")[3])):t.textArea.style.textShadow.match(/^(\s*[\w#]+)\s/)?t.textArea.style.textShadow.match(/^(\s*[\w#]+)\s/)[1].trim():t.textArea.style.textShadow,t.textArea.style.fontWeight==="bold"?t.activeObj.textSettings.bold=!0:t.activeObj.textSettings.bold=!1,t.textArea.style.fontStyle==="italic"?t.activeObj.textSettings.italic=!0:t.activeObj.textSettings.italic=!1,t.activeObj.textSettings.fontSize=parseFloat(t.textArea.style.fontSize)},l.prototype.rgbToHex=function(t,e,i,r){t=Math.max(0,Math.min(255,Math.round(t))),e=Math.max(0,Math.min(255,Math.round(e))),i=Math.max(0,Math.min(255,Math.round(i))),r=Math.max(0,Math.min(1,r));var o=this.padLeft(t.toString(16),2,"0"),a=this.padLeft(e.toString(16),2,"0"),n=this.padLeft(i.toString(16),2,"0"),s=this.padLeft(Math.round(r*255).toString(16),2,"0"),h;return isNaN(Number(s))?h="#"+o+a+n:h="#"+o+a+n+s,h},l.prototype.padLeft=function(t,e,i){for(;t.length<e;)t=i+t;return t},l.prototype.deleteItem=function(){var t=this.parent,e={cancel:!1},i={};if(this.isFhdEditing){this.updateFreehandDrawColorChange();var r=y({},t.cropObj,{},!0),o={currObj:{}};t.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:o}});var a=o.currObj;a.objColl=y([],t.objColl,[],!0),a.pointColl=y([],t.pointColl,[],!0),a.afterCropActions=y([],t.afterCropActions,[],!0);var n={selPointColl:null};t.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:n}}),a.selPointColl=y([],n.selPointColl,[],!0);var s={freehandDrawSelectedId:null};t.notify("freehand-draw",{prop:"getFreehandDrawSelectedId",onPropertyChange:!1,value:{obj:s}}),t.notify("freehand-draw",{prop:"deleteFhd",value:{id:s.freehandDrawSelectedId}}),t.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"deleteFreehandDrawing",previousObj:a,previousObjColl:this.tempObjColl,previousPointColl:a.pointColl,previousSelPointColl:a.selPointColl,previousCropObj:r,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),t.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),t.notify("freehand-draw",{prop:"resetFreehandDrawSelectedId"})}else if(t.textArea.style.display==="none"){var s={prevActObj:null};if(t.notify("draw",{prop:"getPrevActObj",onPropertyChange:!1,value:{obj:s}}),s.prevActObj&&(s.prevActObj.activePoint.width=Math.abs(s.prevActObj.activePoint.width),s.prevActObj.activePoint.height=Math.abs(s.prevActObj.activePoint.height)),s.prevActObj&&JSON.stringify(s.prevActObj)!==JSON.stringify(t.activeObj)){var h=t.activeObj.currIndex;t.notify("draw",{prop:"performCancel",value:{isContextualToolbar:null,isFinalCancel:!0}});for(var p=0,u=t.objColl.length;p<u;p++)if(t.objColl[p].currIndex===h){t.objColl.splice(p,1),t.notify("draw",{prop:"render-image",value:{isMouseWheel:null}});break}}var o={isNewPath:null};if(t.notify("draw",{prop:"getNewPath",value:{obj:o}}),o.isNewPath)t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),t.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1});else if(t.activeObj.shape){t.objColl.push(t.activeObj);var r=y({},t.cropObj,{},!0),c={currObj:{}};t.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:c}});var a=c.currObj;a.objColl=y([],t.objColl,[],!0),a.pointColl=y([],t.pointColl,[],!0),a.afterCropActions=y([],t.afterCropActions,[],!0);var n={selPointColl:null};t.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:n}}),a.selPointColl=y([],n.selPointColl,[],!0),t.objColl.pop(),i=this.updatePrevShapeSettings(),e={cancel:!1,action:"delete",previousShapeSettings:i,currentShapeSettings:null},t.notify("shape",{prop:"setKeyHistory",onPropertyChange:!1,value:{keyHistory:""}}),t.clearSelection(),t.trigger("shapeChanging",e),t.editCompleteArgs=e,t.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1}),t.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),d(a.objColl[a.objColl.length-1].currIndex)||(t.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"deleteObj",previousObj:a,previousObjColl:this.tempObjColl,previousPointColl:a.pointColl,previousSelPointColl:a.selPointColl,previousCropObj:r,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),t.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}))}t.notify("draw",{prop:"setPrevActObj",onPropertyChange:!1,value:{prevActObj:null}}),t.drawingShape&&(this.currentDrawingShape=t.drawingShape.toLowerCase(),t.enableShapeDrawing(t.toPascalCase(t.drawingShape),!0),t.upperCanvas.style.cursor="crosshair")}document.getElementById(t.element.id+"_quickAccessToolbarArea")&&(document.getElementById(t.element.id+"_quickAccessToolbarArea").style.display="none")},l.prototype.updateFreehandDrawColorChange=function(){var t=this.parent,e={freehandSelectedIndex:null};if(t.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:e}}),!d(e.freehandSelectedIndex)&&!d(t.pointColl[e.freehandSelectedIndex])&&t.pointColl[e.freehandSelectedIndex].strokeColor==="#42a5f5"){var i={tempFreeHandDrawEditingStyles:null};t.notify("freehand-draw",{prop:"getTempFreeHandDrawEditingStyles",value:{obj:i}}),t.pointColl[e.freehandSelectedIndex].strokeColor=i.tempFreeHandDrawEditingStyles.strokeColor}},l.prototype.updatePrevShapeSettings=function(t){var e=this.parent,i=[];if(d(e.activeObj.currIndex)){var r={id:"shape_"+(e.objColl.length+1)};e.notify("shape",{prop:"getNewShapeId",onPropertyChange:!1,value:{obj:r}}),e.activeObj.currIndex=r.id}e.activeObj.shape==="text"&&e.activeObj.textSettings&&(e.activeObj.textSettings.bold&&i.push("bold"),e.activeObj.textSettings.italic&&i.push("italic"),e.activeObj.textSettings.underline&&i.push("underline"));var o=e.activeObj.activePoint,a=o.startX,n=o.startY,s=o.endX,h=o.endY,p=o.width,u=o.height,c=e.activeObj,f=c.keyHistory,g=c.currIndex,v=c.shape,m=c.textSettings,C=c.strokeSettings,M=c.rotatedAngle,I=c.imageElement,N=c.opacity,O={id:d(g)?null:g,type:e.toPascalCase(v),startX:a,startY:n,width:p,height:u,strokeColor:C?v==="text"?C.outlineColor:C.strokeColor:null,strokeWidth:C?v==="text"?C.outlineWidth:C.strokeWidth:null,fillColor:C?C.fillColor:null,radius:v==="ellipse"?p/2:null,length:v==="line"||v==="arrow"?p:null,text:v==="text"?f||(m.text?m.text:null):null,fontSize:v==="text"&&m?m.fontSize:null,fontFamily:v==="text"&&m?m.fontFamily:null,fontStyle:v==="text"?i:null,color:v==="text"&&C?C.strokeColor:null,degree:v==="ellipse"||v==="rectangle"||v==="image"||v==="text"?M*(180/Math.PI):null,imageData:v==="image"?I.src:null,opacity:v==="image"?N:null,radiusX:v==="ellipse"?p/2:null,radiusY:v==="ellipse"?u/2:null,endX:v==="line"||v==="arrow"?s:null,endY:v==="line"||v==="arrow"?h:null,arrowHead:v==="arrow"?this.getArrowType(e.activeObj.start):null,arrowTail:v==="arrow"?this.getArrowType(e.activeObj.end):null,points:v==="path"?e.activeObj.pointColl:null,index:e.activeObj.order,transformCollection:v==="text"?this.updateTransColl(e.activeObj):null};return t&&(t.shapeSettingsObj=O),O},l.prototype.updateTransColl=function(t){var e=this.parent,i,r=t.rotateFlipColl;if(r&&r.length>0){var o=void 0;i=[];for(var a=0;a<r.length;a++)o=r[a],typeof o=="number"?i.push({degree:o}):i.push({flip:e.toPascalCase(o)})}return i},l.prototype.getArrowType=function(t){var e={none:"None",arrow:"Arrow",arrowSolid:"SolidArrow",circle:"Circle",circleSolid:"SolidCircle",square:"Square",squareSolid:"SolidSquare",bar:"Bar"};return e[""+t]},l.prototype.getRectanglePoints=function(t,e,i,r,o,a,n){var s=t+i/2,h=e+r/2,p=o*(Math.PI/180),u=Math.cos(p),c=Math.sin(p),f=a-s,g=n-h,v=f*u+g*c,m=-f*c+g*u,C=i/2,M=r/2;return v>=-C&&v<=C&&m>=-M&&m<=M},l.prototype.getTransRotationPoint=function(t,e){var i,r,o=!1,a=!1;if(r=t.shapeDegree===0?this.parent.transform.degree:this.parent.transform.degree-t.shapeDegree,r<0&&(r=360+r),t.flipObjColl)for(var n=0,s=t.flipObjColl.length;n<s;n++)t.flipObjColl[n].toLowerCase()==="horizontal"?o=!0:t.flipObjColl[n].toLowerCase()==="vertical"&&(a=!0);return r===0||r===360?a?i={x:t.topCenterCircle.startX,y:t.topCenterCircle.startY-t.rotationCircleLine}:i={x:t.bottomCenterCircle.startX,y:t.bottomCenterCircle.startY+t.rotationCircleLine}:r===90||r===-270?o?i={x:t.centerRightCircle.startX+t.rotationCircleLine,y:t.centerLeftCircle.startY}:i={x:t.centerLeftCircle.startX-t.rotationCircleLine,y:t.centerLeftCircle.startY}:r===180||r===-180?a?i={x:t.bottomCenterCircle.startX,y:t.bottomCenterCircle.startY+t.rotationCircleLine}:i={x:t.topCenterCircle.startX,y:t.topCenterCircle.startY-t.rotationCircleLine}:(r===270||r===-90)&&(o?i={x:t.centerLeftCircle.startX-t.rotationCircleLine,y:t.centerLeftCircle.startY}:i={x:t.centerRightCircle.startX+t.rotationCircleLine,y:t.centerLeftCircle.startY}),e&&(e.rotationCirclePoint=i),i},l.prototype.getNumTextValue=function(t){var e=this.parent,i=e.element,r,o,a,n;if(a=i.querySelector("#"+i.id+"_resizeWidth"),n=i.querySelector("#"+i.id+"_resizeHeight"),a&&n){var s=n.value.replace(/,/g,""),h=a.value.replace(/,/g,"");s===""&&(s=n.placeholder.replace(/,/g,"")),h===""&&(h=a.placeholder.replace(/,/g,"")),r=parseFloat(s),o=parseFloat(h)}return t&&(t.width=o,t.height=r),{x:o,y:r}},l.prototype.isValueUpdated=function(){var t=!0,e,i;return e=this.parent.element.querySelector("#"+this.parent.element.id+"_resizeWidth"),i=this.parent.element.querySelector("#"+this.parent.element.id+"_resizeHeight"),e&&i&&i.value.replace(/,/g,"")===""&&e.value.replace(/,/g,"")===""&&(t=!1),t},l.prototype.allowOutofBound=function(){var t=["ellipse","rectangle","text","image","redact"],e=!(t.indexOf(this.parent.activeObj.shape)!==-1&&this.parent.activeObj.rotatedAngle===0);return e},l}(),fv=function(){function l(t){this.textSettings={text:"Enter Text",fontFamily:"",fontSize:null,fontRatio:null,bold:!1,italic:!1,underline:!1},this.strokeSettings={strokeColor:"#fff",fillColor:"",strokeWidth:null,radius:null,outlineColor:"",outlineWidth:null},this.keyHistory="",this.preventFrameAnnotation=!1,this.redactType="blur",this.parent=t,this.addEventListener()}return l.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},l.prototype.addEventListener=function(){this.parent.on("shape",this.shape,this),this.parent.on("destroyed",this.destroy,this)},l.prototype.removeEventListener=function(){this.parent.off("shape",this.shape),this.parent.off("destroyed",this.destroy)},l.prototype.shape=function(t){var e=this.parent;this.initShapePvtProps();var i;switch(t.prop){case"drawEllipse":this.drawEllipse(t.value.x,t.value.y,t.value.radiusX,t.value.radiusY,t.value.strokeWidth,t.value.strokeColor,t.value.fillColor,t.value.degree,t.value.isSelected);break;case"drawLine":this.drawLine(t.value.startX,t.value.startY,t.value.endX,t.value.endY,t.value.strokeWidth,t.value.strokeColor,t.value.isSelected);break;case"drawArrow":this.drawArrow(t.value.startX,t.value.startY,t.value.endX,t.value.endY,t.value.strokeWidth,t.value.strokeColor,t.value.arrowStart,t.value.arrowEnd,t.value.isSelected);break;case"drawPath":this.drawPath(t.value.pointColl,t.value.strokeWidth,t.value.strokeColor,t.value.isSelected);break;case"drawRectangle":this.drawRectangle(t.value.x,t.value.y,t.value.width,t.value.height,t.value.strokeWidth,t.value.strokeColor,t.value.fillColor,t.value.degree,t.value.isSelected,t.value.radius);break;case"drawText":this.drawText(t.value.x,t.value.y,t.value.text,t.value.fontFamily,t.value.fontSize,t.value.bold,t.value.italic,t.value.color,t.value.isSelected,t.value.degree,t.value.fillColor,t.value.outlineColor,t.value.outlineWidth,t.value.transformCollection);break;case"redrawActObj":this.redrawActObj(t.value.x,t.value.y,t.value.isMouseDown);break;case"apply":this.apply(t.value.shape,t.value.obj,t.value.canvas);break;case"updateShapeChangeEventArgs":this.updateShapeChangeEventArgs(t.value.shapeSettings,t.value.allowShapeOverflow);break;case"updSelChangeEventArgs":this.updSelChangeEventArgs(t.value.selectionSettings);break;case"iterateObjColl":this.iterateObjColl();break;case"updImgRatioForActObj":this.updImgRatioForActObj();break;case"redrawObj":this.redrawObj(t.value.degree);break;case"redraw-text":this.redrawText();break;case"draw-shape":this.drawShape(t.value.obj,t.value.strokeWidth,t.value.strokeColor,t.value.fillColor,t.value.start,t.value.width,t.value.height);break;case"renderTextArea":this.renderTextArea(t.value.x,t.value.y,t.value.actObj);break;case"setTextBoxWidth":this.setTextBoxWidth(t.value.e);break;case"findTextTarget":this.findTextTarget(t.value.e);break;case"updateFontStyles":this.updateFontStyles(t.value.isTextBox);break;case"applyFontStyle":this.applyFontStyle(t.value.item);break;case"updateFontRatio":this.updateFontRatio(t.value.obj,t.value.isTextArea);break;case"updateFontSize":this.updateFontSize(t.value.obj);break;case"pushActItemIntoObj":this.pushActItemIntoObj();break;case"clearActObj":this.clearActObj();break;case"refreshActiveObj":this.refreshActiveObj();break;case"applyActObj":this.applyActObj(t.value.isMouseDown);break;case"wireEvent":b.add(e.upperCanvas,"dblclick",this.findTextTarget,this),b.add(e.textArea,"mousedown",this.findTextTarget,this),i=document.getElementById(e.element.id+"_fileUpload"),i&&b.add(i,"change",this.fileChanged,this);break;case"unWireEvent":b.remove(e.upperCanvas,"dblclick",this.findTextTarget),b.remove(e.textArea,"mousedown",this.findTextTarget),i=document.getElementById(e.element.id+"_fileUpload"),i&&b.remove(i,"change",this.fileChanged);break;case"getShapeSetting":this.getShapeSetting(t.value.id,t.value.obj);break;case"getShapeSettings":this.getShapeSettings(t.value.obj);break;case"getRedactSettings":this.getRedactSettings(t.value.obj);break;case"isPointsInRange":this.isPointsInRange(t.value.x,t.value.y,t.value.obj);break;case"alignRotateFlipColl":this.alignRotateFlipColl(t.value.collection,t.value.isRotateFlipCollection,t.value.obj);break;case"selectShape":this.selectShape(t.value.id,t.value.obj);break;case"deleteShape":this.deleteShape(t.value.id);break;case"getMaxText":this.getMaxText(t.value.isTextBox,t.value.text,t.value.obj);break;case"setPointCollForLineArrow":t.value.obj.pointColl=this.getLinePoints(t.value.obj.activePoint.startX,t.value.obj.activePoint.startY,t.value.obj.activePoint.endX,t.value.obj.activePoint.endY);break;case"setPointCollForShapeRotation":this.setPointCollForShapeRotation(t.value.obj);break;case"setTextSettings":t.value.textSettings?this.textSettings=t.value.textSettings:t.value.fontFamily?this.textSettings.fontFamily=t.value.fontFamily:t.value.fontSize?this.textSettings.fontSize=t.value.fontSize:t.value.radius&&(this.strokeSettings.radius=t.value.radius);break;case"setStrokeSettings":t.value.strokeSettings?this.strokeSettings=t.value.strokeSettings:t.value.strokeColor?this.strokeSettings.strokeColor=t.value.strokeColor:t.value.fillColor?this.strokeSettings.fillColor=t.value.fillColor:t.value.strokeWidth?this.strokeSettings.strokeWidth=t.value.strokeWidth:t.value.outlineColor?this.strokeSettings.outlineColor=t.value.outlineColor:t.value.radius?this.strokeSettings.radius=t.value.radius:t.value.outlineWidth&&(this.strokeSettings.outlineWidth=t.value.outlineWidth);break;case"getStrokeSettings":t.value.obj.strokeSettings=this.strokeSettings;break;case"setKeyHistory":this.keyHistory=t.value.keyHistory;break;case"getKeyHistory":t.value.obj.keyHistory=this.keyHistory;break;case"setTextBoxPos":this.setTextBoxPos(t.value.actObj,t.value.degree,t.value.flip,t.value.x,t.value.y);break;case"setTextBoxPoints":this.setTextBoxPoints(t.value.actObj,t.value.degree,t.value.flip,t.value.x,t.value.y);break;case"alignTextAreaIntoCanvas":this.alignTextAreaIntoCanvas();break;case"initializeTextShape":this.initializeTextShape(t.value.text,t.value.fontFamily,t.value.fontSize,t.value.bold,t.value.italic,t.value.strokeColor,t.value.fillColor,t.value.outlineColor,t.value.outlineWidth);break;case"stopPathDrawing":this.stopPathDrawing(t.value.e,t.value.isApply);break;case"updateArrowRatio":this.updateArrowRatio(t.value.obj);break;case"getSquarePointForRotatedShape":this.getSquarePointForRotatedShape(t.value.obj,t.value.object);break;case"drawImage":this.drawImage(t.value.x,t.value.y,t.value.width,t.value.height,t.value.src,t.value.degree,t.value.isAspectRatio,t.value.opacity,t.value.isSelected);break;case"reset":this.reset();break;case"updateObj":this.updateObj(t.value.dimObj,t.value.x,t.value.y);break;case"straightenShapes":this.straightenShapes();break;case"straightenShapePoints":this.straightenShapePoints(t.value.obj,t.value.isReverse);break;case"straightenPath":this.straightenPath(t.value.obj);break;case"straightenFHD":this.straightenFHD();break;case"getTextBoxPosition":this.getTextBoxPosition(t.value.obj,t.value.object);break;case"setFlipState":this.setFlipState(t.value.x,t.value.y,t.value.obj,t.value.object);break;case"getNewShapeId":t.value.obj.id=this.getNewShapeId();break;case"z-order":this.updateZOrder(t.value.obj,t.value.value);break;case"getSmallestIndex":t.value.obj.index=this.getSmallestIndex();break;case"isIndexInObjColl":t.value.obj.bool=this.isIndexInObjColl(t.value.index);break;case"drawAnnotations":this.drawAnnotations(t.value.ctx,t.value.shape,t.value.pen,t.value.isPreventApply,t.value.x,t.value.y,t.value.panRegion);break;case"updateShapeColl":this.updateShapeColl();break;case"getNewOrder":t.value.obj.order=this.getNewOrder();break;case"getHighestOrder":t.value.obj.order=this.getHighestOrder();break;case"getLowestOrder":t.value.obj.order=this.getLowestOrder();break;case"drawRedact":this.drawRedact(t.value.x,t.value.y,t.value.width,t.value.height,t.value.type,t.value.value);break;case"setRedactType":this.redactType=t.value.redactType;break}},l.prototype.getModuleName=function(){return"shape"},l.prototype.initShapePvtProps=function(){var t=this.parent;t.lowerCanvas&&(this.lowerContext=t.lowerCanvas.getContext("2d")),t.upperCanvas&&(this.upperContext=t.upperCanvas.getContext("2d")),d(this.shapeImg)&&(this.shapeImg=t.createElement("img",{id:t.element.id+"_shapeImg",attrs:{name:"Image",crossorigin:"anonymous"}})),this.textSettings.fontFamily===""&&(this.textSettings.fontFamily=t.fontFamily.default)},l.prototype.reset=function(){this.textSettings={text:"Enter Text",fontFamily:this.parent.fontFamily.default,fontSize:null,fontRatio:null,bold:!1,italic:!1,underline:!1},this.strokeSettings={strokeColor:"#fff",fillColor:"",strokeWidth:null,radius:null,outlineColor:"",outlineWidth:null},this.preventFrameAnnotation=!1},l.prototype.drawEllipse=function(t,e,i,r,o,a,n,s,h){this.initializeShape("ellipse");var p=t&&e?{x:t,y:e}:null;this.drawShape("ellipse",o,a,n,p,i,r,null,null,null,s,null,h)},l.prototype.drawLine=function(t,e,i,r,o,a,n){this.initializeShape("line");var s=t&&e?{x:t,y:e}:null,h=i-t,p=r-e;this.drawShape("line",o,a,null,s,h,p,null,null,null,null,null,n)},l.prototype.drawPath=function(t,e,i,r){this.initializeShape("path"),t&&this.drawShape("path",e,i,null,null,null,null,t,null,null,null,null,r)},l.prototype.drawArrow=function(t,e,i,r,o,a,n,s,h){this.initializeShape("arrow");var p=t&&e?{x:t,y:e}:null,u=i-t,c=r-e;this.drawShape("arrow",o,a,null,p,u,c,null,n,s,null,null,h)},l.prototype.drawRectangle=function(t,e,i,r,o,a,n,s,h,p){this.initializeShape("rectangle");var u=t&&e?{x:t,y:e}:null;this.drawShape("rectangle",o,a,n,u,i,r,null,null,null,s,null,h,p)},l.prototype.drawRedact=function(t,e,i,r,o,a){this.initializeShape("redact");var n=t&&e?{x:t,y:e}:null;this.drawShape("redact",null,null,null,n,i,r,null,null,null,null,null,null,null,o,a)},l.prototype.drawText=function(t,e,i,r,o,a,n,s,h,p,u,c,f,g){this.drawShapeText(i,r,o,a,n,s,t,e,h,p,u,c,f,g)},l.prototype.initializeShape=function(t){var e=this.parent;this.redrawActObj(),e.activeObj.shape=t,e.currObjType.isCustomCrop=!1},l.prototype.updateWidthHeight=function(t){return t.activePoint.width=t.activePoint.endX-t.activePoint.startX,t.activePoint.height=t.activePoint.endY-t.activePoint.startY,t},l.prototype.setDimension=function(t,e){var i=this.parent,r=i.activeObj.shape;(t&&e||(r==="line"||r==="arrow")&&(t||e))&&(i.activeObj.activePoint.width=t,i.activeObj.activePoint.height=e,i.currObjType.shape.toLowerCase()==="ellipse"&&(i.activeObj.activePoint.width=2*t,i.activeObj.activePoint.height=2*e))},l.prototype.getArrowType=function(t){var e=t;if(t){var i={None:"none",Arrow:"arrow",SolidArrow:"arrowSolid",Circle:"circle",SolidCircle:"circleSolid",Square:"square",SolidSquare:"squareSolid",Bar:"bar"};e=i[""+t]}return e},l.prototype.drawShape=function(t,e,i,r,o,a,n,s,h,p,u,c,f,g,v,m){var C=this.parent;if(!C.disabled&&C.isImageLoaded){C.notify("draw",{prop:"setImageEdited",onPropertyChange:!1}),this.redrawActObj();var M=y([],C.objColl,[],!0);if(C.togglePen=!1,this.keyHistory="",C.upperCanvas.style.display="block",this.refreshActiveObj(),C.currObjType.shape=t=t.toLowerCase(),t!=="freehanddraw"&&t!==""){C.activeObj.shape=t;var I=C.activeObj.strokeSettings;this.upperContext.clearRect(0,0,C.upperCanvas.width,C.upperCanvas.height),d(I)&&(I=this.strokeSettings),t==="path"&&s&&(C.activeObj.pointColl=s),c!=null&&(C.activeObj.opacity=c),I.strokeWidth=e||I.strokeWidth;var N=C.activeObj.shape;(N==="rectangle"||N==="ellipse")&&e===0&&(I.strokeWidth=0),I.strokeColor=i||I.strokeColor,I.fillColor=r||r===""?r:I.fillColor,I.radius=g||I.radius;var O=C.img.destWidth>100?100:C.img.destWidth/2,x=C.img.destHeight>100?100:C.img.destHeight/2;C.activeObj.activePoint.width=O,C.activeObj.activePoint.height=x,t==="line"||t==="arrow"?(C.activeObj.lineDraw="horizontal",C.activeObj.activePoint.height=0,t==="arrow"&&(C.activeObj.activePoint.width+=50,C.activeObj.start=this.getArrowType(h),C.activeObj.end=this.getArrowType(p))):t==="rectangle"?C.activeObj.activePoint.width+=C.activeObj.activePoint.width/2:t==="redact"&&v&&(C.activeObj.redactType=v.toLowerCase(),v===en.Blur?m&&(C.activeObj.redactBlur=m):m&&(C.activeObj.redactPixelate=m),C.activeObj.redactImage=C.createElement("canvas")),this.setDimension(a,n),o?(C.activeObj.activePoint.startX=o.x,C.activeObj.activePoint.startY=o.y,C.activeObj.activePoint.endX=C.activeObj.activePoint.startX+C.activeObj.activePoint.width,C.activeObj.activePoint.endY=C.activeObj.activePoint.startY+C.activeObj.activePoint.height):this.setCenterPoints(),this.setPointCollForLineAndArrow(),t==="arrow"&&(C.activeObj.triangleDirection="right"),C.currObjType.isDragging=C.currObjType.isCustomCrop=!1,this.initShapeProps();var D={shapeSettingsObj:{}};C.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:D}});var A=D.shapeSettingsObj,P={cancel:!1,action:"insert",previousShapeSettings:A,currentShapeSettings:A};C.trigger("shapeChanging",P),C.editCompleteArgs=P,this.updateShapeChangeEventArgs(P.currentShapeSettings,P.allowShapeOverflow),this.setDimension(a,n),C.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),u&&(C.activeObj.rotatedAngle=u*(Math.PI/180),C.notify("selection",{prop:"updPtCollForShpRot",onPropertyChange:!1,value:{obj:C.activeObj}})),C.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}}),C.notify("selection",{prop:"isShapeInserted",onPropertyChange:!1,value:{bool:!0}}),C.notify("undo-redo",{prop:"updateUrObj",onPropertyChange:!1,value:{objColl:M}}),t==="redact"?C.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"redact",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}):C.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"shapes",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),C.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1}),C.isPublicMethod&&!f&&C.notify("undo-redo",{prop:"updateUndoRedo",value:{operation:"shapeInsert"},onPropertyChange:!1}),C.isPublicMethod=!1}}},l.prototype.initShapeProps=function(){var t=this.parent;t.activeObj.shapeDegree=t.transform.degree,t.activeObj.shapeFlip=t.transform.currFlipState,t.activeObj.textFlip=t.transform.currFlipState,t.activeObj.flipObjColl=[],t.activeObj.order=this.getNewOrder()},l.prototype.setPointCollForLineAndArrow=function(){var t=this.parent,e=t.activeObj.shape,i=t.activeObj.activePoint,r=i.startX,o=i.startY,a=i.endX,n=i.endY;if((e==="line"||e==="arrow")&&(t.activeObj.pointColl=this.getLinePoints(r,o,a,n),t.activeObj.pointColl))for(var s=0,h=t.activeObj.pointColl.length;s<h;s++)t.activeObj.pointColl[s].ratioX=(t.activeObj.pointColl[s].x-t.img.destLeft)/t.img.destWidth,t.activeObj.pointColl[s].ratioY=(t.activeObj.pointColl[s].y-t.img.destTop)/t.img.destHeight},l.prototype.prevObjColl=function(){var t=this.parent,e={currObj:{}};t.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:e}}),this.prevObj=e.currObj,this.prevObj.objColl=y([],t.objColl,[],!0),this.prevObj.pointColl=y([],t.pointColl,[],!0),this.prevObj.afterCropActions=y([],t.afterCropActions,[],!0);var i={selPointColl:null};t.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:i}}),this.prevObj.selPointColl=y([],i.selPointColl,[],!0)},l.prototype.drawShapeText=function(t,e,i,r,o,a,n,s,h,p,u,c,f,g){var v=this.parent;if(!v.disabled&&v.isImageLoaded){v.currObjType.shape==="freehanddraw"&&(this.apply(),v.upperCanvas.style.cursor=v.cursor="default",v.currObjType.shape=""),v.notify("draw",{prop:"setImageEdited",onPropertyChange:!1}),v.togglePen=!1,this.redrawActObj(),this.prevObjColl(),this.refreshActiveObj(),v.activeObj.shape=v.currObjType.shape="text",v.currObjType.isCustomCrop=!1,this.initializeTextShape(t,e,i,r,o,a,u,c,f),v.currObjType.isText=v.currObjType.isInitialText=!0,d(v.activeObj.textSettings.fontSize)&&(v.getFontSizes(),v.activeObj.textSettings.fontSize=parseInt(v.fontSizeColl[parseInt("3",10)-1].text,10)),v.img.destWidth<100?v.activeObj.textSettings.fontSize=Math.floor(v.img.destWidth/20):v.img.destHeight<100&&(v.activeObj.textSettings.fontSize=Math.floor(v.img.destHeight/20)),v.activeObj.shapeDegree=v.transform.degree,v.activeObj.shapeFlip=v.transform.currFlipState,v.activeObj.flipObjColl=[],this.updateFontStyles(),v.activeObj.order=this.getNewOrder();var m=this.upperContext.measureText(v.activeObj.textSettings.text).width+v.activeObj.textSettings.fontSize*.5,C=v.activeObj.textSettings.fontSize;if(t){v.activeObj.keyHistory=t;var M=this.getMaxText();M=M||v.activeObj.textSettings.text,m=this.upperContext.measureText(M).width+v.activeObj.textSettings.fontSize*.5;var I=t.split(`
`);I.length>1&&(C=I.length*v.activeObj.textSettings.fontSize,C+=i*.25)}if(!d(n)&&!d(s)?(v.activeObj.activePoint.startX=n,v.activeObj.activePoint.startY=s,v.activeObj.activePoint.endX=v.activeObj.activePoint.startX+m,v.activeObj.activePoint.endY=v.activeObj.activePoint.startY+C):this.setCenterPoints(!0,m,C),g){v.notify("selection",{prop:"setTransformedShape",onPropertyChange:!1,value:{bool:!0}}),this.setTransformColl(g);var N=v.activeObj;N.shapeDegree=0,N.shapeFlip="";for(var O=0,x=N.rotateFlipColl,D=0;D<x.length;D++)typeof x[D]=="number"&&(O+=x[D]);O%90===0&&Math.abs(O)%180===90&&(N.activePoint.endX=N.activePoint.startX+C,N.activePoint.endY=N.activePoint.startY+m,N.activePoint.width=N.activePoint.endX-N.activePoint.startX,N.activePoint.height=N.activePoint.endY-N.activePoint.startY)}var A={shapeSettingsObj:{}};v.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:A}});var P=A.shapeSettingsObj,V={cancel:!1,action:"insert",previousShapeSettings:P,currentShapeSettings:P};if(v.trigger("shapeChanging",V),v.editCompleteArgs=V,this.drawShapeTextEvent(V),p&&(v.activeObj.rotatedAngle=p*(Math.PI/180),v.notify("selection",{prop:"updPtCollForShpRot",onPropertyChange:!1,value:{obj:v.activeObj}}),this.upperContext.clearRect(0,0,v.upperCanvas.width,v.upperCanvas.height),v.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:v.activeObj,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:null}}),v.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1}),v.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}})),t&&t.indexOf(`
`)>-1&&v.isPublicMethod){var q=String(v.fontSizeColl.findIndex(function(re){return re.text===String(v.activeObj.textSettings.fontSize)})+1);v.noPushUndo=!0,v.updateFontSize("5"),parseInt(q,10)>0&&v.updateFontSize(q),v.noPushUndo=!1}v.isPublicMethod&&!h&&v.notify("undo-redo",{prop:"updateUndoRedo",value:{operation:"shapeInsert"},onPropertyChange:!1}),v.isPublicMethod=!1}},l.prototype.drawShapeImageEvent=function(t,e){var i=this.parent;this.updateShapeChangeEventArgs(t.currentShapeSettings,t.allowShapeOverflow),i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),i.objColl.push(i.activeObj);var r=y({},i.cropObj,{},!0);i.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeInsert",previousObj:this.prevObj,previousObjColl:this.prevObj.objColl,previousPointColl:this.prevObj.pointColl,previousSelPointColl:this.prevObj.selPointColl,previousCropObj:r,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),i.notify("selection",{prop:"redrawShape",onPropertyChange:!1,value:{obj:i.objColl[i.objColl.length-1]}}),e?(i.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"shapes",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),i.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1}),i.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}})):i.okBtn(null,!0),i.notify("selection",{prop:"isShapeInserted",onPropertyChange:!1,value:{bool:!0}})},l.prototype.setTransformColl=function(t){var e=this.parent;if(e.activeObj.rotateFlipColl=[],t)for(var i=0;i<t.length;i++)t[i].degree?e.activeObj.rotateFlipColl.push(t[i].degree):e.activeObj.rotateFlipColl.push(t[i].flip.toLowerCase())},l.prototype.drawShapeTextEvent=function(t){var e=this.parent;this.updateShapeChangeEventArgs(t.currentShapeSettings,t.allowShapeOverflow),this.addLetter(e.activeObj.textSettings.text),e.activeObj.textFlip=e.transform.currFlipState,this.updateFontRatio(e.activeObj),e.objColl.push(e.activeObj);var i=y({},e.cropObj,{},!0);e.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeInsert",previousObj:this.prevObj,previousObjColl:this.prevObj.objColl,previousPointColl:this.prevObj.pointColl,previousSelPointColl:this.prevObj.selPointColl,previousCropObj:i,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),e.notify("selection",{prop:"redrawShape",onPropertyChange:!1,value:{obj:e.objColl[e.objColl.length-1]}}),e.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}}),e.notify("selection",{prop:"isShapeInserted",onPropertyChange:!1,value:{bool:!0}}),e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"text",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),e.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1})},l.prototype.initializeTextShape=function(t,e,i,r,o,a,n,s,h){var p=this.parent;this.keyHistory="",p.upperCanvas.style.display="block",p.activeObj.strokeSettings.strokeColor=a||p.activeObj.strokeSettings.strokeColor,p.activeObj.strokeSettings.fillColor=n||p.activeObj.strokeSettings.fillColor,p.activeObj.textSettings.text=t||p.activeObj.textSettings.text,p.activeObj.textSettings.fontFamily=e||p.activeObj.textSettings.fontFamily,p.activeObj.textSettings.fontSize=i||p.activeObj.textSettings.fontSize,p.activeObj.textSettings.bold=r||p.activeObj.textSettings.bold,p.activeObj.textSettings.italic=o||p.activeObj.textSettings.italic,p.activeObj.strokeSettings.outlineColor=s||p.activeObj.strokeSettings.outlineColor,p.activeObj.strokeSettings.outlineWidth=h||p.activeObj.strokeSettings.outlineWidth},l.prototype.drawImage=function(t,e,i,r,o,a,n,s,h){this.initializeShape("image"),this.onLoadImgShape(t,e,i,r,o,null,a,n,s,h)},l.prototype.redrawActObj=function(t,e,i){var r,o=this.parent;o.activeObj.shape&&(r=o.activeObj.shape.split("-")),o.activeObj.horTopLine&&o.activeObj.shape&&r[0]!=="crop"&&(o.textArea.style.display==="block"||o.textArea.style.display==="inline-block"?(o.notify("selection",{prop:"setTextBoxStylesToActObj",onPropertyChange:!1}),this.updateFontRatio(o.activeObj,!0),t&&e?t!==o.activeObj.activePoint.startX&&e!==o.activeObj.activePoint.startY&&this.updateTextFromTextArea():(this.updateTextFromTextArea(),o.textArea.style.transform="",o.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1})),this.refreshActiveObj()):this.applyActObj(i))},l.prototype.apply=function(t,e,i){var r=this.parent;if(!r.disabled)if(r.togglePen&&!r.currObjType.isCustomCrop){var o=r.img.destLeft,a=r.img.destTop,n=r.img.destWidth,s=r.img.destHeight;r.notify("draw",{prop:"callUpdateCurrTransState",onPropertyChange:!1});var h=this.lowerContext.filter;this.lowerContext.filter="none",r.togglePen=!1,(r.isCircleCrop||r.currSelectionPoint&&r.currSelectionPoint.shape==="crop-circle")&&r.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),r.img.destLeft=o,r.img.destTop=a,r.img.destWidth=n,r.img.destHeight=s,this.lowerContext.filter=h}else i=i||"original",d(r.activeObj.shape)&&d(t)?r.currObjType.shape="":r.currObjType.shape=t||r.currObjType.shape,r.currObjType.shape!==""&&(this.upperContext.clearRect(0,0,r.upperCanvas.width,r.upperCanvas.height),r.activeObj.shape==="text"?r.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:i,obj:e,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:null}}):r.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:i,obj:e}}),r.activeObj.shape=r.currObjType.shape.toLowerCase(),!t&&r.currObjType.shape!==""&&!r.currObjType.isCustomCrop&&r.objColl.push(y({},r.activeObj,{},!0)),this.keyHistory="")},l.prototype.setCenterPoints=function(t,e,i){var r=this.parent,o,a;t&&e&&i?(o=e,a=i):(o=r.activeObj.activePoint.width,a=r.activeObj.activePoint.height),r.activeObj.activePoint.startX=r.lowerCanvas.width/2-o/2,r.activeObj.activePoint.startY=r.lowerCanvas.height/2-a/2,r.activeObj.activePoint.endX=r.lowerCanvas.width/2+o/2,r.activeObj.activePoint.endY=r.lowerCanvas.height/2+a/2},l.prototype.updSelChangeEventArgs=function(t){var e=this.parent;e.activeObj.activePoint={startX:t.startX,startY:t.startY,endX:e.activeObj.activePoint.startX+e.activeObj.activePoint.width,endY:e.activeObj.activePoint.startY+e.activeObj.activePoint.height,width:t.width,height:t.height},e.activeObj.activePoint.endX=e.activeObj.activePoint.startX+e.activeObj.activePoint.width,e.activeObj.activePoint.endY=e.activeObj.activePoint.startY+e.activeObj.activePoint.height},l.prototype.updateShapeChangeEventArgs=function(t,e){var i=this.parent,r;if(t.id&&t.id.indexOf("shape_")===-1&&t.id.indexOf("pen_")===-1&&(i.activeObj.currIndex?i.activeObj.currIndex="shape_"+t.id:i.pointColl[r].id="pen_"+t.id),t.id&&t.id.split("_")[0]&&t.id.split("_")[0]==="pen")r=parseInt(t.id.split("_")[1],10)-1,i.pointColl[r].points=t.points,i.pointColl[r].strokeColor=t.strokeColor,i.pointColl[r].strokeWidth=t.strokeWidth,i.pointColl[r].opacity=t.opacity,t.index&&(i.pointColl[r].order=t.index);else{switch(i.activeObj.activePoint.startX=t.startX,i.activeObj.activePoint.startY=t.startY,t.width&&t.height&&(i.activeObj.activePoint.width=t.width,i.activeObj.activePoint.height=t.height,i.activeObj.activePoint.endX=i.activeObj.activePoint.startX+i.activeObj.activePoint.width,i.activeObj.activePoint.endY=i.activeObj.activePoint.startY+i.activeObj.activePoint.height),i.activeObj.shape!=="text"&&(i.activeObj.strokeSettings.strokeColor=t.strokeColor,i.activeObj.strokeSettings.strokeWidth=t.strokeWidth),i.activeObj.strokeSettings.fillColor=t.fillColor,i.activeObj.opacity=t.opacity,t.index&&(i.activeObj.order=t.index),i.activeObj.preventShapeDragOut=!e,d(t.degree)&&(t.degree=0),i.activeObj.shape){case"ellipse":i.activeObj.activePoint.width=t.radiusX*2,i.activeObj.activePoint.height=t.radiusY*2,i.activeObj.activePoint.endX=i.activeObj.activePoint.startX+i.activeObj.activePoint.width,i.activeObj.activePoint.endY=i.activeObj.activePoint.startY+i.activeObj.activePoint.height,t.degree&&(i.activeObj.rotatedAngle=t.degree*(Math.PI/180));break;case"line":case"arrow":i.activeObj.activePoint.width=t.length,i.activeObj.activePoint.endX=t.endX,i.activeObj.activePoint.endY=t.endY,i.activeObj.activePoint.width=i.activeObj.activePoint.startX+i.activeObj.activePoint.width,i.activeObj.activePoint.height=i.activeObj.activePoint.startY+i.activeObj.activePoint.height,i.activeObj.shape==="arrow"&&(i.activeObj.start=this.getArrowType(t.arrowHead),i.activeObj.end=this.getArrowType(t.arrowTail));break;case"text":i.activeObj.keyHistory=i.activeObj.textSettings.text=t.text,i.activeObj.textSettings.fontSize=t.fontSize,i.activeObj.strokeSettings.strokeColor=t.color,i.activeObj.strokeSettings.outlineColor=t.strokeColor,i.activeObj.strokeSettings.outlineWidth=t.strokeWidth,i.activeObj.strokeSettings.fillColor=t.fillColor,i.activeObj.textSettings.fontFamily=t.fontFamily,this.setTransformColl(t.transformCollection),t.degree&&(i.activeObj.rotatedAngle=t.degree*(Math.PI/180)),this.updateFontRatio(i.activeObj);break;case"rectangle":case"image":t.degree&&(i.activeObj.rotatedAngle=t.degree*(Math.PI/180));break;case"path":i.activeObj.pointColl=t.points;break}if(i.activeObj.shape==="text"&&i.activeObj.textSettings){i.activeObj.textSettings.bold=!1,i.activeObj.textSettings.italic=!1,i.activeObj.textSettings.underline=!1;for(var o=0;o<t.fontStyle.length;o++)switch(t.fontStyle[o]){case"bold":i.activeObj.textSettings.bold=!0;break;case"italic":i.activeObj.textSettings.italic=!0;break}}}},l.prototype.addLetter=function(t){var e=this.parent;if(e.textArea.style.display==="none"&&(e.currObjType.isText||e.activeObj.shape==="text")){var i=e.activeObj.textSettings.fontSize;t==="Backspace"?this.keyHistory=this.keyHistory.slice(0,-1):this.keyHistory+=t,this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),this.updateFontStyles();var r=this.upperContext.measureText(this.keyHistory).width+i*.5,o=i;this.upperContext.fillText(this.keyHistory,e.activeObj.activePoint.startX,e.activeObj.activePoint.startY+i),this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),e.currObjType.isText=!0,e.notify("selection",{prop:"setActivePoint",onPropertyChange:!1,value:{startX:r,startY:o}})}},l.prototype.redrawText=function(){var t=this.parent,e=t.activeObj.textSettings,i=e.fontSize,r=e.fontFamily,o=e.bold,a=e.italic,n="";o&&(n+="bold "),a&&(n+="italic "),this.upperContext.font=n+i+"px "+r;var s=t.activeObj.keyHistory.split(`
`),h=t.textArea.style.display==="block"||t.textArea.style.display==="inline-block"?this.getMaxText(!0):this.getMaxText(),p=this.upperContext.measureText(h).width+i*.5,u=s.length*i;s.length>1&&(u+=i*.5),t.notify("selection",{prop:"setTextSelection",onPropertyChange:!1,value:{width:p,height:u}}),t.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:t.activeObj.activePoint,obj:t.activeObj,isMouseMove:null,x:null,y:null}}),t.notify("selection",{prop:"redrawShape",onPropertyChange:!1,value:{obj:t.activeObj}})},l.prototype.updateTextFromTextArea=function(){var t=this.parent,e=!1,i=t.activeObj.textSettings.fontSize,r=y({},t.activeObj,{},!0),o=y({},t.cropObj,{},!0),a={currObj:{}};t.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:a}});var n=a.currObj;n.objColl=y([],t.objColl,[],!0),n.pointColl=y([],t.pointColl,[],!0),n.afterCropActions=y([],t.afterCropActions,[],!0);var s={selPointColl:null};t.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:s}}),n.selPointColl=y([],s.selPointColl,[],!0),t.activeObj.keyHistory!==t.textArea.value&&(e=!0),t.activeObj.keyHistory=t.textArea.value,t.textArea.style.display="none",t.textArea.value="",this.updateFontStyles();var h=this.upperContext.measureText(t.activeObj.keyHistory).width+i*.5,p=i,u=t.activeObj.keyHistory.split(`
`);if(u.length>1){p*=u.length,p+=i*.1*u.length;for(var c=[],f=0,g=u.length;f<g;f++)c.push(this.upperContext.measureText(u[f]).width+i*.5);h=Math.max.apply(Math,c)}if(t.notify("selection",{prop:"setTextSelection",onPropertyChange:!1,value:{width:h,height:p}}),t.activeObj.rotatedAngle!==0){var v=t.activeObj.activePoint.width-r.activePoint.width,m=t.activeObj.activePoint.height-r.activePoint.height,C="";v>0&&m>0?C="widthHeight":v!==0?C="width":m!==0&&(C="height"),t.activeObj.activePoint=y({},r.activePoint,{},!0),t.notify("selection",{prop:"adjustRotationPoints",onPropertyChange:!1,value:{rectangle:t.activeObj.activePoint,x:v,y:m,angle:t.activeObj.rotatedAngle,type:"text",elem:C}}),t.notify("shape",{prop:"updateFontSize",onPropertyChange:!1,value:{obj:t.activeObj}})}t.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:t.activeObj.activePoint,obj:t.activeObj,isMouseMove:null,x:null,y:null}}),this.updImgRatioForActObj(),t.activeObj.rotatedAngle!==0&&t.notify("selection",{prop:"updPtCollForShpRot",onPropertyChange:!1,value:{obj:t.activeObj}}),e?(this.apply(t.activeObj.shape,t.activeObj),t.objColl.push(y({},t.activeObj,{},!0)),t.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"text",previousObj:n,previousObjColl:n.objColl,previousPointColl:n.pointColl,previousSelPointColl:n.selPointColl,previousCropObj:o,previousText:t.activeObj.keyHistory,currentText:t.textArea.value,previousFilter:null,isCircleCrop:null}})):(this.apply(t.activeObj.shape,t.activeObj),t.objColl.push(y({},t.activeObj,{},!0)))},l.prototype.iterateObjColl=function(){var t=this.parent;if(t.objColl.length>0)for(var e=this.getSmallestIndex(),i=y([],t.objColl,[],!0);i.length>0;){for(var r=!1,o=0;o<i.length;o++){var a=i[o];if(d(a.order)){i.splice(o,1),o--;continue}if(a.order===e){this.apply(a.shape,a),a.shape==="redact"&&JSON.stringify(a.activePoint)===JSON.stringify(t.activeObj.activePoint)&&a.redactImage!==t.activeObj.redactImage&&(a.redactImage=t.activeObj.redactImage,t.objColl[o]&&JSON.stringify(t.objColl[o].activePoint)===JSON.stringify(a.activePoint)&&(t.objColl[o].redactImage=t.activeObj.redactImage)),this.refreshActiveObj(),e++,this.isIndexInObjColl(e)||e++,i.splice(o,1),r=!0;break}}if(!r)break}},l.prototype.getSmallestIndex=function(){for(var t=this.parent,e,i=0,r=t.objColl.length;i<r;i++){var o=t.objColl[i];d(o.order)||(d(e)||o.order<e)&&(e=o.order)}return e},l.prototype.isIndexInObjColl=function(t){for(var e=this.parent,i=0,r=e.objColl.length;i<r;i++){var o=e.objColl[i];if(!d(o.order)&&o.order===t)return!0}return!1},l.prototype.updImgRatioForActObj=function(){var t=this.parent,e={startX:t.img.destLeft,startY:t.img.destTop,width:t.img.destWidth,height:t.img.destHeight};this.straightenShapes();var i=t.img,r=i.destLeft,o=i.destTop,a=i.destWidth,n=i.destHeight,s=t.activeObj.activePoint;t.activeObj.imageRatio={startX:(s.startX-r)/a,startY:(s.startY-o)/n,endX:(s.endX-r)/a,endY:(s.endY-o)/n,width:a/s.width,height:n/s.height},t.activeObj.rotationCirclePointColl&&(t.activeObj.rotationCirclePointColl.ratioX=(t.activeObj.rotationCirclePointColl.x-r)/a,t.activeObj.rotationCirclePointColl.ratioY=(t.activeObj.rotationCirclePointColl.y-o)/n),t.activeObj.shape==="path"?this.updatePathRatio(t.activeObj):t.activeObj.shape==="arrow"&&this.updateArrowRatio(t.activeObj),t.img.destLeft=e.startX,t.img.destTop=e.startY,t.img.destWidth=e.width,t.img.destHeight=e.height},l.prototype.zoomObjColl=function(t){var e=this.parent,i={startX:e.img.destLeft,startY:e.img.destTop,width:e.img.destWidth,height:e.img.destHeight};if(this.straightenShapes(),e.objColl.length>0){for(var r=0,o=e.objColl.length;r<o;r++){var a=e.objColl[r];if(a.imageRatio&&(a.activePoint.startX=a.imageRatio.startX*e.img.destWidth+e.img.destLeft,a.activePoint.startY=a.imageRatio.startY*e.img.destHeight+e.img.destTop,a.activePoint.endX=a.imageRatio.endX*e.img.destWidth+e.img.destLeft,a.activePoint.endY=a.imageRatio.endY*e.img.destHeight+e.img.destTop),a=this.updateWidthHeight(a),a.shape==="text")this.updateFontSize(a);else if(a.shape==="line"||a.shape==="arrow"){a.pointColl=this.getLinePoints(a.activePoint.startX,a.activePoint.startY,a.activePoint.endX,a.activePoint.endY);for(var n=0,s=a.pointColl.length;n<s;n++)a.pointColl[n].ratioX=(a.pointColl[n].x-e.img.destLeft)/e.img.destWidth,a.pointColl[n].ratioY=(a.pointColl[n].y-e.img.destTop)/e.img.destHeight;a.shape==="arrow"&&this.updateArrowSize(a),e.transform.straighten!==0&&(a.shape==="line"||a.shape==="arrow")&&this.straightenShapePoints(a)}else if(a.shape==="path"){for(var h=0,p=a.pointColl.length;h<p;h++)a.pointColl[h].x=a.pointColl[h].ratioX*e.img.destWidth+e.img.destLeft,a.pointColl[h].y=a.pointColl[h].ratioY*e.img.destHeight+e.img.destTop;this.updatePathRatio(a),e.transform.straighten!==0&&this.straightenPath(a)}e.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:a.activePoint,obj:a}}),a.shape!=="line"&&a.shape!=="arrow"&&a.shape!=="path"&&a.rotatedAngle!==0&&(this.setPointCollForShapeRotation(a),a.rotationCirclePoint.x=a.rotationCirclePoint.ratioX*e.img.destWidth+e.img.destLeft,a.rotationCirclePoint.y=a.rotationCirclePoint.ratioY*e.img.destHeight+e.img.destTop,a.rotationCirclePointColl&&(a.rotationCirclePointColl.x=a.rotationCirclePointColl.ratioX*e.img.destWidth+e.img.destLeft,a.rotationCirclePointColl.y=a.rotationCirclePointColl.ratioY*e.img.destHeight+e.img.destTop))}if(d(t)){var u=this.lowerContext.filter;this.lowerContext.filter="none",this.iterateObjColl(),this.lowerContext.filter=u}}e.img.destLeft=i.startX,e.img.destTop=i.startY,e.img.destWidth=i.width,e.img.destHeight=i.height},l.prototype.straightenPath=function(t){for(var e,i=0,r=t.pointColl.length;i<r;i++)e=this.straightenPoints(t.pointColl[i].x,t.pointColl[i].y),t.pointColl[i].x=e.x,t.pointColl[i].y=e.y},l.prototype.straightenFHD=function(){for(var t=this.parent,e=0,i=t.freehandCounter;e<i;e++){t.points=y([],t.pointColl[e].points,[]);for(var r=t.points.length,o=void 0,a=0;a<r;a++)o=this.straightenPoints(t.points[a].x,t.points[a].y),t.points[a].x=o.x,t.points[a].y=o.y}var n={selPointColl:null};t.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:n}});for(var e=0,i=t.freehandCounter;e<i;e++)if(n.selPointColl[e]&&n.selPointColl[e].points)for(var r=n.selPointColl[e].points.length,o=void 0,a=0;a<r;a++)o=this.straightenPoints(n.selPointColl[e].points[a].x,n.selPointColl[e].points[a].y),n.selPointColl[e].points[a].x=o.x,n.selPointColl[e].points[a].y=o.y;var s={straightenPoint:null};if(t.notify("freehand-draw",{prop:"getStraightenPoint",onPropertyChange:!1,value:{obj:s}}),s.straightenPoint.x&&s.straightenPoint.y){var h={angle:0};t.notify("freehand-draw",{prop:"getStraightenPointAngle",onPropertyChange:!1,value:{obj:h}});var p=((t.transform.straighten===360?0:t.transform.straighten)-h.angle)*(Math.PI/180),o=this.straightenPoints(s.straightenPoint.x,s.straightenPoint.y,p);p===0&&(o.x=s.straightenPoint.x,o.y=s.straightenPoint.y),t.notify("freehand-draw",{prop:"setStraightenPoint",onPropertyChange:!1,value:{x:o.x,y:o.y}})}},l.prototype.straightenPoints=function(t,e,i){var r=this.parent,o={x:r.img.destLeft+r.img.destWidth/2,y:r.img.destTop+r.img.destHeight/2};i=i||r.transform.straighten*(Math.PI/180);var a={x:Math.cos(i)*(t-o.x)-Math.sin(i)*(e-o.y)+o.x,y:Math.sin(i)*(t-o.x)+Math.cos(i)*(e-o.y)+o.y};return a},l.prototype.straightenShapes=function(){var t=this.parent,e=t.img,i=e.destLeft,r=e.destTop,o=e.destWidth,a=e.destHeight,n={bool:t.isStraightening};if(!(!n.bool||t.transform.straighten===0)){t.notify("draw",{prop:"updateImgCanvasPoints"});var s={points:null};t.notify("draw",{prop:"getImageCanvasPoints",value:{obj:s}});var h={x:i+o/2,y:r+a/2},p=-(t.transform.straighten*(Math.PI/180)),u={x:Math.cos(p)*(s.points[0].x-h.x)-Math.sin(p)*(s.points[0].y-h.y)+h.x,y:Math.sin(p)*(s.points[0].x-h.x)+Math.cos(p)*(s.points[0].y-h.y)+h.y},c={x:Math.cos(p)*(s.points[1].x-h.x)-Math.sin(p)*(s.points[1].y-h.y)+h.x,y:Math.sin(p)*(s.points[1].x-h.x)+Math.cos(p)*(s.points[1].y-h.y)+h.y},f={x:Math.cos(p)*(s.points[2].x-h.x)-Math.sin(p)*(s.points[2].y-h.y)+h.x,y:Math.sin(p)*(s.points[2].x-h.x)+Math.cos(p)*(s.points[2].y-h.y)+h.y};t.img.destWidth=c.x-u.x,t.img.destHeight=f.y-c.y,t.img.destLeft=u.x,t.img.destTop=u.y}},l.prototype.straightenShapePoints=function(t,e){var i=this.parent,r=i.img,o=r.destLeft,a=r.destTop,n=r.destWidth,s=r.destHeight,h={bool:i.isStraightening};if(h.bool&&(t.shape==="line"||t.shape==="arrow")){t.activePoint.width=t.activePoint.endX>t.activePoint.startX?t.activePoint.endX-t.activePoint.startX:t.activePoint.startX-t.activePoint.endX,t.activePoint.height=t.activePoint.endY>t.activePoint.startY?t.activePoint.endY-t.activePoint.startY:t.activePoint.startY-t.activePoint.endY;var p={x:o+n/2,y:a+s/2},u=(e?-i.transform.straighten:i.transform.straighten)*(Math.PI/180),c={x:Math.cos(u)*(t.activePoint.startX-p.x)-Math.sin(u)*(t.activePoint.startY-p.y)+p.x,y:Math.sin(u)*(t.activePoint.startX-p.x)+Math.cos(u)*(t.activePoint.startY-p.y)+p.y},f={x:Math.cos(u)*(t.activePoint.endX-p.x)-Math.sin(u)*(t.activePoint.endY-p.y)+p.x,y:Math.sin(u)*(t.activePoint.endX-p.x)+Math.cos(u)*(t.activePoint.endY-p.y)+p.y};t.activePoint.startX=c.x,t.activePoint.startY=c.y,t.activePoint.endX=f.x,t.activePoint.endY=f.y,t.activePoint.width=t.activePoint.endX>t.activePoint.startX?t.activePoint.endX-t.activePoint.startX:t.activePoint.startX-t.activePoint.endX,t.activePoint.height=t.activePoint.endY>t.activePoint.startY?t.activePoint.endY-t.activePoint.startY:t.activePoint.startY-t.activePoint.endY,i.notify("selection",{prop:"adjustActObjForLineArrow",onPropertyChange:!1,value:{obj:t}})}},l.prototype.redrawObj=function(t){var e=this.parent,i=!1;if(e.objColl.length>0){if(t==="horizontal"||t==="vertical"||t==="Horizontal"||t==="Vertical"||t==="horizontalVertical"||t==="verticalHorizontal")this.updateCurrentActiveObjPoint(t.toLowerCase());else if(typeof t=="number"){this.updateCurrentActiveObjPoint(t);var r=this.lowerContext.filter;this.lowerContext.filter="brightness(1) contrast(100%) hue-rotate(0deg) saturate(100%) opacity(1) blur(0px) sepia(0%) grayscale(0%) invert(0%)";for(var o=0,a=e.objColl.length;o<a;o++){var n=e.objColl[o].shape.split("-");n[0]!=="crop"&&(this.apply(e.objColl[o].shape,e.objColl[o]),i=!0)}i&&e.notify("draw",{prop:"applyFrame",value:{ctx:this.lowerContext,frame:e.frameObj.type,preventImg:!0}}),this.lowerContext.filter=r}}},l.prototype.updateCurrentActiveObjPoint=function(t){for(var e=this.parent,i,r=e.img,o=r.destLeft,a=r.destTop,n=r.destWidth,s=r.destHeight,h=0,p=e.objColl.length;h<p;h++){var u=e.objColl[h];if(e.activeObj.shape===u.shape&&e.activeObj.activePoint.startX===u.activePoint.startX&&e.activeObj.activePoint.startY===u.activePoint.startY&&e.activeObj.activePoint.endX===u.activePoint.endX&&e.activeObj.activePoint.endY===u.activePoint.endY&&e.activeObj.currIndex===u.currIndex){i=h;break}}if(t==="horizontal"||t==="vertical"||t==="Horizontal"||t==="Vertical"||t==="horizontalvertical"||t==="verticalhorizontal"){if(t==="horizontal"||t==="Horizontal")for(var c=0,p=e.objColl.length;c<p;c++){var u=e.objColl[c];u.shapeFlip!==e.transform.currFlipState&&(u.activePoint.startX<=o+n/2?(u.activePoint.endX=o+n-(u.activePoint.startX-o),u.activePoint.startX=u.activePoint.endX-u.activePoint.width,e.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:u.activePoint,obj:u}})):u.activePoint.startX>=o+n/2&&(u.activePoint.startX=o+(o+n-u.activePoint.endX),u.activePoint.endX=u.activePoint.startX+u.activePoint.width,e.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:u.activePoint,obj:u}})),u.shape==="line"||u.shape==="arrow"||u.shape==="path"?this.flipLineArrowObj(u,"horizontal"):u.rotatedAngle!==0&&(u.rotatedAngle=u.rotatedAngle+(Math.PI-u.rotatedAngle)*2,u.rotationCirclePointColl.x<=o+n/2?u.rotationCirclePointColl.x=o+n-(u.rotationCirclePointColl.x-o):u.rotationCirclePointColl.x>=o+n/2&&(u.rotationCirclePointColl.x=o+(o+n-u.rotationCirclePointColl.x)),u.rotationCirclePointColl.ratioX=(u.rotationCirclePointColl.x-o)/n),u.shapeFlip=e.transform.currFlipState,u.imageRatio={startX:(u.activePoint.startX-o)/n,startY:(u.activePoint.startY-a)/s,endX:(u.activePoint.endX-o)/n,endY:(u.activePoint.endY-a)/s,width:n/u.activePoint.width,height:s/u.activePoint.height})}else if(t==="vertical"||t==="Vertical")for(var c=0;c<e.objColl.length;c++){var u=e.objColl[c];u.shapeFlip!==e.transform.currFlipState&&(u.activePoint.startY<=a+s/2?(u.activePoint.endY=a+s-(u.activePoint.startY-a),u.activePoint.startY=u.activePoint.endY-u.activePoint.height,e.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:u.activePoint,obj:u}})):u.activePoint.startY>=e.lowerCanvas.height/2&&(u.activePoint.startY=a+(a+s-u.activePoint.endY),u.activePoint.endY=u.activePoint.startY+u.activePoint.height,e.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:u.activePoint,obj:u}})),u.shape==="line"||u.shape==="arrow"||u.shape==="path"?this.flipLineArrowObj(u,"vertical"):u.rotatedAngle!==0&&(u.rotatedAngle=-u.rotatedAngle,u.rotationCirclePointColl.y<=a+s/2?u.rotationCirclePointColl.y=a+s-(u.rotationCirclePointColl.y-a):u.rotationCirclePointColl.y>=a+s/2&&(u.rotationCirclePointColl.y=a+(a+s-u.rotationCirclePointColl.y)),u.rotationCirclePointColl.ratioY=(u.rotationCirclePointColl.y-a)/s),u.shapeFlip=e.transform.currFlipState,u.imageRatio={startX:(u.activePoint.startX-o)/n,startY:(u.activePoint.startY-a)/s,endX:(u.activePoint.endX-o)/n,endY:(u.activePoint.endY-a)/s,width:n/u.activePoint.width,height:s/u.activePoint.height})}else if(t==="verticalhorizontal"||t==="horizontalvertical")for(var c=0,p=e.objColl.length;c<p;c++){var u=e.objColl[c];u.shapeFlip!==e.transform.currFlipState&&(u.activePoint.startX<=o+n/2?(u.activePoint.endX=o+n-(u.activePoint.startX-o),u.activePoint.startX=u.activePoint.endX-u.activePoint.width,e.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:u.activePoint,obj:u}})):u.activePoint.startX>=o+n/2&&(u.activePoint.startX=o+(o+n-u.activePoint.endX),u.activePoint.endX=u.activePoint.startX+u.activePoint.width,e.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:u.activePoint,obj:u}})),u.activePoint.startY<=a+s/2?(u.activePoint.endY=a+s-(u.activePoint.startY-a),u.activePoint.startY=u.activePoint.endY-u.activePoint.height,e.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:u.activePoint,obj:u}})):u.activePoint.startY>=e.lowerCanvas.height/2&&(u.activePoint.startY=a+(a+s-u.activePoint.endY),u.activePoint.endY=u.activePoint.startY+u.activePoint.height,e.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:u.activePoint,obj:u}})),(u.shape==="line"||u.shape==="arrow"||u.shape==="path")&&this.flipLineArrowObj(u,t),u.shapeFlip=e.transform.currFlipState,u.imageRatio={startX:(u.activePoint.startX-o)/n,startY:(u.activePoint.startY-a)/s,endX:(u.activePoint.endX-o)/n,endY:(u.activePoint.endY-a)/s,width:n/u.activePoint.width,height:s/u.activePoint.height})}i!==void 0&&(e.activeObj=y({},e.objColl[i],{},!0))}else if(t===90)this.rotateObjColl();else if(t===-90)for(var c=0;c<3;c++)this.rotateObjColl();else if(typeof t=="number")if(t>0)this.rotateObjColl();else for(var c=0;c<3;c++)this.rotateObjColl()},l.prototype.rotateObjColl=function(){for(var t=this.parent,e=t.img,i=e.destWidth,r=e.destHeight,o=e.destLeft,a=e.destTop,n=0,s=t.objColl.length;n<s;n++){var h=t.objColl[n],p=h.shape;h.activePoint.startY=a+r*h.imageRatio.startX,h.activePoint.endY=a+r*h.imageRatio.endX,h.activePoint.startX=o+i-i*h.imageRatio.endY,h.activePoint.endX=o+i-i*h.imageRatio.startY,h=this.updateWidthHeight(t.objColl[n]),this.updateFontSize(h),p==="line"||p==="arrow"||p==="path"?(this.rotateLineArrowObj(h),p==="arrow"&&this.updateArrowSize(h)):h.rotatedAngle!==0&&(h.rotationCirclePointColl.y=a+r*h.rotationCirclePointColl.ratioX,h.rotationCirclePointColl.x=o+i-i*h.rotationCirclePointColl.ratioY,h.rotationCirclePointColl.ratioX=(h.rotationCirclePointColl.x-o)/i,h.rotationCirclePointColl.ratioY=(h.rotationCirclePointColl.y-a)/r)}for(var n=0,s=t.objColl.length;n<s;n++)t.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:t.objColl[n].activePoint,obj:t.objColl[n]}});for(var n=0,s=t.objColl.length;n<s;n++){var h=t.objColl[n];h.imageRatio={startX:(h.activePoint.startX-o)/i,startY:(h.activePoint.startY-a)/r,endX:(h.activePoint.endX-o)/i,endY:(h.activePoint.endY-a)/r,width:i/h.activePoint.width,height:r/h.activePoint.height}}},l.prototype.rotateLineArrowObj=function(t){if(!d(t.pointColl)){var e=this.parent,i=e.img,r=i.destWidth,o=i.destHeight,a=i.destLeft,n=i.destTop;if(t.pointColl.length>0){for(var s=0;s<t.pointColl.length;s++)t.pointColl[s].y=n+o*t.pointColl[s].ratioX,t.pointColl[s].x=a+r-r*t.pointColl[s].ratioY;for(var s=0;s<t.pointColl.length;s++)t.pointColl[s].ratioX=(t.pointColl[s].x-a)/r,t.pointColl[s].ratioY=(t.pointColl[s].y-n)/o;var h=void 0;d(t.pointColl[t.pointColl.length-2])?h={x:0,y:0}:h={x:t.pointColl[t.pointColl.length-2].x,y:t.pointColl[t.pointColl.length-2].y};var p=t.pointColl[t.pointColl.length-1].x-h.x,u=t.pointColl[t.pointColl.length-1].y-h.y;t.activePoint.startX=t.pointColl[0].x,t.activePoint.startY=t.pointColl[0].y,t.activePoint.endX=t.pointColl[t.pointColl.length-1].x+p/2,t.activePoint.endY=t.pointColl[t.pointColl.length-1].y+u/2,t=this.updateWidthHeight(t)}}},l.prototype.flipLineArrowObj=function(t,e){if(e=e.toLowerCase(),!d(t.pointColl)&&(e==="horizontal"?this.lineArrowHorizontalFlip(t):e==="vertical"?this.lineArrowVerticalFlip(t):(this.lineArrowHorizontalFlip(t),t.shapeFlip="",this.lineArrowVerticalFlip(t)),t.activePoint.startX=t.pointColl[0].x,t.activePoint.startY=t.pointColl[0].y,t.activePoint.endX=t.pointColl[t.pointColl.length-1].x,t.activePoint.endY=t.pointColl[t.pointColl.length-1].y,t.activePoint.startX>t.activePoint.endX)){var i=t.activePoint.startX;t.activePoint.startX=t.activePoint.endX,t.activePoint.endX=i,i=t.activePoint.startY,t.activePoint.startY=t.activePoint.endY,t.activePoint.endY=i}},l.prototype.lineArrowHorizontalFlip=function(t){var e=this.parent,i=e.img,r=i.destWidth,o=i.destHeight,a=i.destLeft,n=i.destTop;if(t.shapeFlip!==e.transform.currFlipState){for(var s=0,h=t.pointColl.length;s<h;s++){var p=t.pointColl[s];p.x<=a+r/2?p.x=a+r-(p.x-a):p.x>=a+r/2&&(p.x=a+(a+r-p.x)),p.ratioX=(p.x-a)/r,p.ratioY=(p.y-n)/o}if(t.shape==="arrow"){var u=t.start;t.start=t.end,t.end=u}t.shapeFlip=e.transform.currFlipState}},l.prototype.lineArrowVerticalFlip=function(t){var e=this.parent,i=e.img,r=i.destWidth,o=i.destHeight,a=i.destLeft,n=i.destTop;if(t.shapeFlip!==e.transform.currFlipState){for(var s=0,h=t.pointColl.length;s<h;s++){var p=t.pointColl[s];p.y<=n+o/2?p.y=n+o-(p.y-n):p.y>=n+o/2&&(p.y=n+(n+o-p.y)),p.ratioX=(p.x-a)/r,p.ratioY=(p.y-n)/o}t.shapeFlip=e.transform.currFlipState}},l.prototype.getRotDegOfShape=function(t,e){var i=this.parent,r;t.shapeDegree===0?r=this.parent.transform.degree:r=this.parent.transform.degree-t.shapeDegree,r<0&&(r=360+r);var o={bool:!1};if(i.notify("selection",{prop:"getTransformedShape",onPropertyChange:!1,value:{obj:o}}),o.bool&&!e&&i.activeObj.rotateFlipColl){r=0;for(var a=0;a<i.activeObj.rotateFlipColl.length;a++)typeof i.activeObj.rotateFlipColl[a]=="number"&&(r+=i.activeObj.rotateFlipColl[a])}return r},l.prototype.renderTextArea=function(t,e,i){var r=this.parent,o={shapeSettingsObj:{}};r.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:o}});var a=o.shapeSettingsObj,n={cancel:!1,action:"text-edit",previousShapeSettings:a,currentShapeSettings:a};r.trigger("shapeChanging",n),this.updateShapeChangeEventArgs(n.currentShapeSettings,n.allowShapeOverflow);var s=this.getRotDegOfShape(r.activeObj);this.transformTextArea(),r.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1});var h=r.element.querySelector("#"+r.element.id+"_zOrderBtn"),p=r.element.querySelector("#"+r.element.id+"_duplicate"),u=r.element.querySelector("#"+r.element.id+"_remove"),c=r.element.querySelector("#"+r.element.id+"_editText"),f=i.strokeSettings.outlineColor,g=i.strokeSettings.outlineWidth,v=[];h&&h.classList.add("e-overlay"),p&&p.classList.add("e-overlay"),u&&u.classList.add("e-overlay"),c&&c.classList.add("e-overlay"),i.strokeSettings.fillColor!==""?r.textArea.style.backgroundColor=i.strokeSettings.fillColor:r.textArea.style.backgroundColor="transparent",r.textArea.style.display="block",r.textArea.style.left=t+"px",r.textArea.style.top=e+"px",r.textArea.style.fontFamily=i.textSettings.fontFamily,r.textArea.style.fontSize=i.textSettings.fontSize+"px",r.textArea.style.color=i.strokeSettings.strokeColor;var m=i.textSettings.fontSize,C=Math.max(1,g/2),M=C*(Math.floor((m-1)/16)*.5+.5);if(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$|^[a-zA-Z]+$/.test(i.strokeSettings.outlineColor)){for(var I=-M;I<=M;I++)for(var N=-M;N<=M;N++)(I!==0||N!==0)&&v.push(I/2+"px "+N/2+"px 0 "+f);r.textArea.style.textShadow=v.join(", ")}else r.textArea.style.textShadow=null;r.textArea.style.fontWeight=i.textSettings.bold?"bold":"normal",r.textArea.style.fontStyle=i.textSettings.italic?"italic":"normal",r.textArea.style.border="2px solid "+r.themeColl[r.theme].primaryColor,r.textArea.value=i.keyHistory,r.textArea.style.overflow="hidden",r.textArea.style.width="auto",r.textArea.style.height="auto",r.textArea.focus();var O=i.activePoint,x=O.width,D=O.height;s%90===0&&s%180!==0&&s!==0?(r.textArea.style.width=D+D*.25+"px",r.textArea.style.height=x+x*.25+"px"):(r.textArea.style.width=x+x*.25+"px",r.textArea.style.height=D+D*.25+"px"),this.setTextBoxWidth();var A={flipColl:null};if(r.notify("transform",{prop:"getFlipColl",onPropertyChange:!1,value:{obj:A}}),A.flipColl.length<=1&&this.setTextBoxHeight(),parseFloat(r.textArea.style.maxHeight)<r.activeObj.textSettings.fontSize&&(r.textArea.style.maxHeight=r.activeObj.textSettings.fontSize+"px"),s%90===0&&s%180!==0?parseFloat(r.textArea.style.left)+parseFloat(r.textArea.style.width)>r.img.destTop+r.img.destHeight&&this.alignTextAreaIntoCanvas():parseFloat(r.textArea.style.left)+parseFloat(r.textArea.style.width)>r.img.destLeft+r.img.destWidth&&this.alignTextAreaIntoCanvas(),i.rotatedAngle!==0){var P=parseFloat(r.textArea.style.left),V=parseFloat(r.textArea.style.top);if(i.flipObjColl.length>0){var q={panRegion:""},re=r.lowerCanvas,ae=re.clientWidth,E=re.clientHeight,L={x:0,y:0};r.notify("crop",{prop:"getCurrFlipState",onPropertyChange:!1,value:{panObj:q}}),q.panRegion!==""&&(q.panRegion==="horizontal"?(L.x=ae-ae/2,P=L.x-P+L.x):q.panRegion==="vertical"?(L.y=E-E/2,V=L.y-V+L.y):(L={x:ae-ae/2,y:E-E/2},P=L.x-P+L.x,V=L.y-V+L.y))}var k=P+parseFloat(r.textArea.style.width),U=V+parseFloat(r.textArea.style.height),B=parseFloat(r.textArea.style.width),R=parseFloat(r.textArea.style.height),$={x:k-B/2,y:U-R/2},oe=Math.cos(i.rotatedAngle),he=Math.sin(i.rotatedAngle),pe={x:oe*(k-$.x)-he*(U-$.y)+$.x,y:he*(k-$.x)+oe*(U-$.y)+$.y};if(pe.x>r.img.destLeft&&pe.x<r.img.destLeft+r.img.destWidth&&pe.y>r.img.destTop&&pe.y+parseFloat(r.textArea.style.fontSize)<r.img.destTop+r.img.destHeight)r.textArea.style.width=r.textArea.style.width;else for(var Te=0,Pe=parseFloat(r.textArea.style.width);;)if(Te++,B-=1,k=P+B,$={x:k-B/2,y:U-R/2},pe={x:oe*(k-$.x)-he*(U-$.y)+$.x,y:he*(k-$.x)+oe*(U-$.y)+$.y},pe.x>r.img.destLeft&&pe.x<r.img.destLeft+r.img.destWidth&&pe.y>r.img.destTop&&pe.y+parseFloat(r.textArea.style.fontSize)<r.img.destTop+r.img.destHeight||Te===Pe){r.textArea.style.width=B+"px";break}}r.notify("selection",{prop:"clearUpperCanvas",onPropertyChange:!1})},l.prototype.setTextBoxWidth=function(t){var e=this.parent;if(e.activeObj.rotatedAngle!==0){e.textArea.style.whiteSpace="nowrap",e.textArea.style.textOverflow="ellipsis",e.textArea.style.display="inline-block";return}else e.textArea.style.whiteSpace="",e.textArea.style.textOverflow="",e.textArea.style.display==="inline-block"&&(e.textArea.style.display="block");var i=this.getMaxText(!0);e.textArea.style.display==="block"||e.textArea.style.display==="inline-block"?this.updateFontStyles(!0):this.updateFontStyles();var r=this.upperContext.measureText(i).width+parseFloat(e.textArea.style.fontSize)/2,o=t?this.upperContext.measureText(String.fromCharCode(t.which)).width:0,a=y({},e.activeObj,{},!0),n="",s=this.getRotDegOfShape(a);if(a.shapeFlip!==e.transform.currFlipState?n="":n=e.transform.currFlipState,t&&parseFloat(e.textArea.style.width)<r+o||d(t)){if(s===0)n.toLowerCase()==="horizontal"?parseFloat(e.textArea.style.left)-e.img.destLeft-r-o>0&&(e.textArea.style.width=r+o+"px"):e.img.destWidth-(parseFloat(e.textArea.style.left)-e.img.destLeft)>r+o&&(e.textArea.style.width=r+o+"px");else if(s===90)n.toLowerCase()==="vertical"?parseFloat(e.textArea.style.top)-e.img.destTop-r-o>0&&(e.textArea.style.width=r+o+"px"):e.img.destHeight-(parseFloat(e.textArea.style.top)-e.img.destTop)>r+o&&(e.textArea.style.width=r+o+"px");else if(s===180){var h=parseFloat(e.textArea.style.left),p=e.img.destLeft;if(n.toLowerCase()==="horizontal"){var u=e.img.destWidth-(h-p);u>r+o&&(e.textArea.style.width=r+o+"px")}else{var c=h-p;c-r-o>0&&(e.textArea.style.width=r+o+"px")}}else if(s===270){var f=parseFloat(e.textArea.style.top),g=e.img.destTop;if(n.toLowerCase()==="vertical"){var v=e.img.destHeight-(f-g);v>r+o&&(e.textArea.style.width=r+o+"px")}else{var m=f-g;m-r-o>0&&(e.textArea.style.width=r+o+"px")}}}},l.prototype.setTextBoxHeight=function(){var t=this.parent,e,i=y({},t.activeObj,{},!0),r="",o=this.getRotDegOfShape(i);switch(i.textFlip===t.transform.currFlipState?r="":i.textFlip===""?r=t.transform.currFlipState:r=i.textFlip,o){case 0:r.toLowerCase()==="vertical"?t.textArea.style.maxHeight=t.img.destHeight-(t.img.destHeight-parseFloat(t.textArea.style.top))+"px":(e=parseFloat(t.textArea.style.top)-t.img.destTop,t.textArea.style.maxHeight=t.img.destHeight-e+"px");break;case 90:r.toLowerCase()==="horizontal"?t.textArea.style.maxHeight=t.img.destWidth-(parseFloat(t.textArea.style.left)-t.img.destLeft)+"px":t.textArea.style.maxHeight=parseFloat(t.textArea.style.left)-t.img.destLeft+"px";break;case 180:r.toLowerCase()==="vertical"?(e=parseFloat(t.textArea.style.top)-t.img.destTop,t.textArea.style.maxHeight=t.img.destHeight-e+"px"):t.textArea.style.maxHeight=parseFloat(t.textArea.style.top)-t.img.destTop+"px";break;case 270:r.toLowerCase()==="horizontal"?t.textArea.style.maxHeight=parseFloat(t.textArea.style.left)-t.img.destLeft+"px":t.textArea.style.maxHeight=t.img.destWidth-(parseFloat(t.textArea.style.left)-t.img.destLeft)+"px";break}},l.prototype.updatePathRatio=function(t){for(var e=this.parent,i=0,r=t.pointColl.length;i<r;i++){var o=t.pointColl[i];o.ratioX=(o.x-e.img.destLeft)/e.img.destWidth,o.ratioY=(o.y-e.img.destTop)/e.img.destHeight}},l.prototype.stopPathDrawing=function(t,e){var i=this.parent;if(i.activeObj.shape==="path"){var r={shape:null};if(i.notify("selection",{prop:"getCurrentDrawingShape",value:{obj:r}}),r.shape==="path"){var o=y({},i.cropObj,{},!0),a={currObj:{}};i.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:a}});var n=a.currObj;n.objColl=y([],i.objColl,[],!0),n.pointColl=y([],i.pointColl,[],!0),n.afterCropActions=y([],i.afterCropActions,[],!0);var s={selPointColl:null};if(i.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:s}}),n.selPointColl=y([],s.selPointColl,[],!0),i.notify("selection",{prop:"setCurrentDrawingShape",value:{value:""}}),i.currObjType.isDragging=!1,t&&t.type!=="touchstart"&&d(e)&&i.activeObj.pointColl.pop(),this.updatePathRatio(i.activeObj),d(i.activeObj.imageRatio)&&i.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),i.objColl.push(i.activeObj),i.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:n,previousObjColl:n.objColl,previousPointColl:n.pointColl,previousSelPointColl:n.selPointColl,previousCropObj:o,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),i.objColl.pop(),t&&(i.notify("selection",{prop:"mouseUpEventHandler",value:{e:t}}),this.lowerContext.clearRect(0,0,i.lowerCanvas.width,i.lowerCanvas.height),i.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),i.objColl.length>0)){var h=i.activeObj.activePoint,p=i.objColl[i.objColl.length-1].activePoint;Math.floor(h.startX)===Math.floor(p.startX)&&Math.floor(h.startY)===Math.floor(p.startY)&&Math.floor(h.endX)===Math.floor(p.endX)&&Math.floor(h.endY)===Math.floor(p.endY)&&this.refreshActiveObj()}if(i.notify("draw",{prop:"setNewPath",value:{bool:!0}}),i.objColl[i.objColl.length-1]){var u=i.drawingShape;i.notify("selection",{prop:"setCurrentDrawingShape",value:{value:""}}),i.noRedact=!0,i.selectShape(i.objColl[i.objColl.length-1].currIndex),i.notify("selection",{prop:"setCurrentDrawingShape",value:{value:"path"}}),i.drawingShape=u}i.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}});var c={shapeSettingsObj:{}};i.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:c}});var f=c.shapeSettingsObj,g={cancel:!1,action:"draw-end",previousShapeSettings:f},v={cancel:!1,action:"move",previousShapeSettings:f};i.notify("selection",{prop:"triggerShapeChange",onPropertyChange:!1,value:{shapeResizingArgs:g,shapeMovingArgs:v,type:"mouse-up"}}),i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})}}},l.prototype.findTextTarget=function(t){var e=this.parent;if(t){if(e.activeObj.shape!=="text")if(e.activeObj.shape==="path"){this.stopPathDrawing(t,null);return}else if(t.type==="dblclick"){e.notify("selection",{prop:"setPanDown",onPropertyChange:!1,value:{panDown:null}});var i=y({},e.activeObj,{},!0),r=y([],e.objColl,[],!0),o={bool:null};if(e.notify("selection",{prop:"findTargetObj",onPropertyChange:!1,value:{x:t.clientX,y:t.clientY,isCrop:!1,obj:o}}),e.objColl=r,!o.bool||e.activeObj.shape!=="text"){e.activeObj=y({},i,{},!0);return}}else return;var a,n;if(t.type==="dblclick"?(a=t.clientX,n=t.clientY):t.type==="touchstart"&&(a=t.touches[0].clientX,n=t.touches[0].clientY,e.notify("selection",{prop:"setTouchEndPoint",onPropertyChange:!1,value:{x:t.touches[0].clientX,y:t.touches[0].clientY}})),e.notify("toolbar",{prop:"setPreventZoomBtn",onPropertyChange:!1,value:{isPrevent:!0}}),e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"text",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),e.notify("toolbar",{prop:"setPreventZoomBtn",onPropertyChange:!1,value:{isPrevent:!1}}),e.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1}),!d(a)&&!d(n)){var s=e.lowerCanvas.getBoundingClientRect();a-=s.left,n-=s.top;var h="",p=this.getRotDegOfShape(e.activeObj);e.activeObj.textFlip===""?e.activeObj.textFlip===e.transform.currFlipState?h="":h=e.transform.currFlipState:e.activeObj.textFlip===e.transform.currFlipState?h="":e.transform.currFlipState===""?h=e.activeObj.textFlip:h=e.transform.currFlipState;var u=void 0;if(e.textArea.style.display==="none"){u=y({},e.activeObj,{},!0);for(var c=0;c<e.objColl.length;c++)JSON.stringify(e.activeObj)===JSON.stringify(e.objColl[c])&&e.objColl.splice(c,1);this.refreshActiveObj(),this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),this.lowerContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),e.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),e.notify("draw",{prop:"redrawDownScale"}),e.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),e.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}}),(e.currSelectionPoint&&e.currSelectionPoint.shape==="crop-circle"||e.isCircleCrop)&&e.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),e.activeObj=u,this.updateFontStyles();var f=y({},e.activeObj,{},!0),g=f.topLeftCircle.radius,v=f.activePoint,m=v.startX,C=v.startY,M=v.endX,I=v.endY,N=v.width,O=v.height,x={x:m+N/2,y:C+O/2},D=Math.cos(f.rotatedAngle),A=Math.sin(f.rotatedAngle),P={x:D*(m-x.x)-A*(C-x.y)+x.x,y:A*(m-x.x)+D*(C-x.y)+x.y},V={x:D*(M-x.x)-A*(C-x.y)+x.x,y:A*(M-x.x)+D*(C-x.y)+x.y},q={x:D*(m-x.x)-A*(I-x.y)+x.x,y:A*(m-x.x)+D*(I-x.y)+x.y},re={x:D*(M-x.x)-A*(I-x.y)+x.x,y:A*(M-x.x)+D*(I-x.y)+x.y},o={position:null,x:a,y:n,x1:P.x,y1:P.y,x2:V.x,y2:V.y,x3:q.x,y3:q.y,x4:re.x,y4:re.y};if(e.notify("draw",{prop:"checkPointPosition",onPropertyChange:!1,value:{obj:o}}),f.rotatedAngle!==0&&(o.position==="inside"||o.position==="on")||f.rotatedAngle===0&&a>=f.activePoint.startX-g*2&&a<=f.activePoint.endX+g*2&&n>=f.activePoint.startY-g*2&&n<=f.activePoint.endY+g*2){if(this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height),f.flipObjColl.length===4&&(f.flipObjColl=[],h="",f.shapeFlip=""),h===""&&f.flipObjColl.length>1&&(h=f.flipObjColl[f.flipObjColl.length-1]),f.flipObjColl.length<=1){var ae=this.setTextBoxPos(f,p,h,a,n);a=ae.x,n=ae.y}else{var ae=this.setTextBoxPoints(f,p,h,a,n);a=ae.x,n=ae.y}if(e.activeObj.rotatedAngle!==0){var E=this.getTextBoxPosition(e.activeObj);a=E.x,n=E.y,E=this.setFlipState(a,n,e.activeObj),a=E.x,n=E.y}this.renderTextArea(a,n,f)}else this.applyActObj()}}else if((e.textArea.style.display==="block"||e.textArea.style.display==="inline-block")&&this.selectedText()!==""&&t.type==="mousedown"){var u=e.textArea.value;e.textArea.value+="a",e.textArea.value=u}else e.textArea.style.display==="none"&&(e.textArea.style.display="block")}},l.prototype.getTextBoxPosition=function(t,e){var i={x:0,y:0},r=t.activePoint,o=r.startX,a=r.startY,n=r.endX,s=r.endY,h=r.width,p=r.height,u={x:o+h/2,y:a+p/2},c=Math.cos(t.rotatedAngle),f=Math.sin(t.rotatedAngle),g={x:c*(o-u.x)-f*(a-u.y)+u.x,y:f*(o-u.x)+c*(a-u.y)+u.y},v={x:c*(n-u.x)-f*(a-u.y)+u.x,y:f*(n-u.x)+c*(a-u.y)+u.y},m={x:c*(o-u.x)-f*(s-u.y)+u.x,y:f*(o-u.x)+c*(s-u.y)+u.y},C={x:c*(n-u.x)-f*(s-u.y)+u.x,y:f*(n-u.x)+c*(s-u.y)+u.y},M=this.getRotDegOfShape(t);return M===0||M===360?i={x:g.x,y:g.y}:M===90||M===-270?i={x:v.x,y:v.y}:M===180||M===-180?i={x:C.x,y:C.y}:(M===270||M===-90)&&(i={x:m.x,y:m.y}),e&&(e.x=i.x,e.y=i.y),i},l.prototype.setFlipState=function(t,e,i,r){var o=this.parent,a={panRegion:""},n=o.lowerCanvas,s=n.clientWidth,h=n.clientHeight,p={x:0,y:0};return o.notify("crop",{prop:"getCurrFlipState",onPropertyChange:!1,value:{panObj:a}}),a.panRegion!==""&&(a.panRegion==="horizontal"?(p.x=s-s/2,t=p.x-t+p.x):a.panRegion==="vertical"?(p.y=h-h/2,e=p.y-e+p.y):(p={x:s-s/2,y:h-h/2},t=p.x-t+p.x,e=p.y-e+p.y)),r&&(r.x=t,r.y=e),{x:t,y:e}},l.prototype.fileChanged=function(t){var e=t.target.files[0],i=e,r=i.name&&i.name.split(".").pop().toLowerCase();if(r&&["jpg","jpeg","png","svg","webp"].indexOf(r)===-1){this.refreshActiveObj();return}var o=window.URL,a=o.createObjectURL(t.target.files[0]);this.onLoadImgShape(null,null,null,null,a.toString(),!0),document.getElementById(this.parent.element.id+"_fileUpload").value=""},l.prototype.onLoadImgShape=function(t,e,i,r,o,a,n,s,h,p){var u=this,c=this.parent;typeof o=="string"?this.shapeImg.src=o:(c.inMemoryCanvas.width=o.width,c.inMemoryCanvas.height=o.height,c.inMemoryCanvas.getContext("2d").putImageData(o,0,0),this.shapeImg.src=c.inMemoryCanvas.toDataURL()),this.prevObjColl(),c.activeObj.shape="image",this.initShapeProps(),this.shapeImg.onload=function(){u.upperContext.drawImage(u.shapeImg,0,0,u.shapeImg.width,u.shapeImg.height),u.updateImgCanvas(a,t,e,i,r,n,s,h,p)}},l.prototype.updateImgCanvas=function(t,e,i,r,o,a,n,s,h){var p=this.parent;p.activeObj.imageElement=this.shapeImg,p.activeObj.imageCanvas=p.createElement("canvas");var u={width:0,height:0};if(p.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:this.shapeImg.width,height:this.shapeImg.height,obj:u,isImgShape:null}}),r&&o)if(n){var c={ratio:null};p.notify("selection",{prop:"findImageRatio",onPropertyChange:!1,value:{width:this.shapeImg.width,height:this.shapeImg.height,obj:c}}),u=this.resizeImage(r,c.ratio)}else u={width:r,height:o};if(this.updateObj(u,e,i),p.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:p.activeObj.imageCanvas.getContext("2d"),isImgAnnotation:!0,isHFlip:null,isVFlip:null}}),p.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:this.shapeImg.width,height:this.shapeImg.height,obj:u,isImgShape:!0}}),r&&o)if(n){var f={ratio:null};p.notify("selection",{prop:"findImageRatio",onPropertyChange:!1,value:{width:this.shapeImg.width,height:this.shapeImg.height,obj:f}}),u=this.resizeImage(r,f.ratio)}else u={width:r,height:o};s!=null&&(p.activeObj.opacity=s),this.updateObj(u,e,i),p.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),this.shapeImg=null,a&&(p.activeObj.rotatedAngle=a*(Math.PI/180),p.notify("selection",{prop:"updPtCollForShpRot",onPropertyChange:!1,value:{obj:p.activeObj}}));var g={shapeSettingsObj:{}};p.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:g}});var v=g.shapeSettingsObj,m={cancel:!1,action:"insert",previousShapeSettings:v,currentShapeSettings:v};p.trigger("shapeChanging",m),p.editCompleteArgs=m,t=t||h,this.drawShapeImageEvent(m,t),p.isPublicMethod&&!h?p.notify("undo-redo",{prop:"updateUndoRedo",onPropertyChange:!1}):p.isPublicMethod||p.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1}),p.isPublicMethod=!1},l.prototype.updateObj=function(t,e,i){var r=this.parent;r.activeObj.activePoint.width=t.width,r.activeObj.activePoint.height=t.height,r.activeObj.activePoint.startX=e||r.lowerCanvas.width/2-t.width/2,r.activeObj.activePoint.startY=i||r.lowerCanvas.height/2-t.height/2,r.activeObj.activePoint.endX=r.activeObj.activePoint.startX+t.width,r.activeObj.activePoint.endY=r.activeObj.activePoint.startY+t.height},l.prototype.resizeImage=function(t,e){var i=e.split(":"),r=parseInt(i[0],10),o=parseInt(i[1],10),a=Math.round(t*o/r);return{width:t,height:a}},l.prototype.setTextBoxPos=function(t,e,i,r,o){var a={x:r,y:o},n=t.activePoint,s=n.startX,h=n.startY,p=n.endX,u=n.endY;switch(i=i.toLowerCase(),e){case 0:i==="horizontal"?(a.x=p,a.y=h):i==="vertical"?(a.x=s,a.y=u):(a.x=s,a.y=h);break;case 90:i==="horizontal"?(a.x=s,a.y=h):i==="vertical"?(a.x=p,a.y=u):(a.x=p,a.y=h);break;case 180:i==="horizontal"?(a.x=s,a.y=u):i==="vertical"?(a.x=p,a.y=h):(a.x=p,a.y=u);break;case 270:i==="horizontal"?(a.x=p,a.y=u):i==="vertical"?(a.x=s,a.y=h):(a.x=s,a.y=u);break}return a},l.prototype.setTextBoxPoints=function(t,e,i,r,o){var a={x:r,y:o},n=t.activePoint,s=n.startX,h=n.startY,p=n.endX,u=n.endY;switch(i=i.toLowerCase(),e){case 0:t.flipObjColl[0]&&t.flipObjColl[0].toLowerCase()==="horizontal"?i==="horizontal"?(a.x=s,a.y=h):i==="vertical"&&(a.x=p,a.y=u):i==="horizontal"?(a.x=p,a.y=u):i==="vertical"&&(a.x=p,a.y=h);break;case 90:t.flipObjColl[0]&&t.flipObjColl[0].toLowerCase()==="horizontal"?i==="horizontal"?(a.x=p,a.y=u):i==="vertical"&&(a.x=s,a.y=u):i==="horizontal"?(a.x=s,a.y=u):i==="vertical"&&(a.x=s,a.y=h);break;case 180:t.flipObjColl[0]&&t.flipObjColl[0].toLowerCase()==="horizontal"?(i==="horizontal"||i==="vertical")&&(a.x=s,a.y=h):i==="horizontal"?(a.x=s,a.y=h):i==="vertical"&&(a.x=s,a.y=u);break;case 270:t.flipObjColl[0]&&t.flipObjColl[0].toLowerCase()==="horizontal"?i==="horizontal"?(a.x=s,a.y=h):i==="vertical"&&(a.x=p,a.y=h):i==="horizontal"?(a.x=p,a.y=h):i==="vertical"&&(a.x=p,a.y=u);break}return a},l.prototype.selectedText=function(){var t=this.parent,e=t.textArea.selectionStart,i=t.textArea.selectionEnd;return t.textArea.value.substring(e,i)},l.prototype.panObjColl=function(t,e,i){var r=this.parent;if(r.objColl.length>0){for(var o=0,a=r.objColl.length;o<a;o++){var n=r.objColl[o];if(i===""){if(n.activePoint.startX+=t,n.activePoint.endX+=t,n.rotationCirclePointColl&&(n.rotationCirclePointColl.x+=t),n.shape==="path")for(var s=0,h=n.pointColl.length;s<h;s++)n.pointColl[s].x+=t;if(n.activePoint.startY+=e,n.activePoint.endY+=e,n.rotationCirclePointColl&&(n.rotationCirclePointColl.y+=e),n.shape==="path")for(var s=0;s<n.pointColl.length;s++)n.pointColl[s].y+=e}if(n=this.updateWidthHeight(n),r.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:n.activePoint,obj:n}}),n.shape==="line"||n.shape==="arrow"){n.pointColl=this.getLinePoints(n.activePoint.startX,n.activePoint.startY,n.activePoint.endX,n.activePoint.endY);for(var p=0,u=n.pointColl.length;p<u;p++)n.pointColl[p].ratioX=(n.pointColl[p].x-r.img.destLeft)/r.img.destWidth,n.pointColl[p].ratioY=(n.pointColl[p].y-r.img.destTop)/r.img.destHeight}this.refreshActiveObj()}var c=this.lowerContext.filter;this.lowerContext.filter="none",this.iterateObjColl(),this.lowerContext.filter=c,this.refreshActiveObj(),r.notify("draw",{prop:"applyFrame",value:{ctx:this.lowerContext,frame:r.frameObj.type,preventImg:!0}})}},l.prototype.updateFontStyles=function(t){var e=this.parent;this.upperContext.strokeStyle=e.activeObj.strokeSettings.strokeColor,this.upperContext.fillStyle=e.activeObj.strokeSettings.strokeColor;var i="";e.activeObj.textSettings.bold&&(i="bold "),e.activeObj.textSettings.italic&&(i="italic "),e.activeObj.textSettings.bold&&e.activeObj.textSettings.italic&&(i="italic bold ");var r=t?parseFloat(e.textArea.style.fontSize):e.activeObj.textSettings.fontSize,o=e.textArea.style.display==="block"||e.textArea.style.display==="inline-block"?e.textArea.style.fontFamily:e.activeObj.textSettings.fontFamily;this.upperContext.font=i+r+"px "+o},l.prototype.applyFontStyle=function(t){var e=this.parent,i={shapeSettingsObj:{}};e.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:i}});var r=i.shapeSettingsObj;this.pushActItemIntoObj();var o=y([],e.objColl,[],!0);switch(e.objColl.pop(),e.textArea.style.display==="none"?this.updateFontRatio(e.activeObj):this.updateFontRatio(e.activeObj,!0),t){case"default":this.updateFontStyle(t,o,"normal","normal");break;case"bold":this.updateFontStyle(t,o,"bold","normal");break;case"italic":this.updateFontStyle(t,o,"normal","italic");break;case"bolditalic":this.updateFontStyle(t,o,"bold","italic");break}var a={action:"font-style",currentShapeSettings:y({},r,{},!0)};a.currentShapeSettings.fontStyle=[t],e.trigger("shapeChange",a),e.editCompleteArgs=a},l.prototype.updateFontStyle=function(t,e,i,r){var o=this.parent,a=o.textArea.style;if(a.display==="block"||a.display==="inline-block"){i==="bold"?a.fontWeight="bold":a.fontWeight="normal",r==="italic"?a.fontStyle="italic":a.fontStyle="normal";var n=a.fontWeight==="normal"&&a.fontStyle==="normal"?"default":a.fontWeight==="bold"&&a.fontStyle==="normal"?"bold":a.fontWeight==="normal"&&a.fontStyle==="italic"?"italic":"bolditalic",s=this.getTextAreaWidth(n);a.width=s+"px",this.updateObjColl(t,e)}else this.textSettings.bold=o.activeObj.textSettings.bold=i!=="normal",this.textSettings.italic=o.activeObj.textSettings.italic=r!=="normal",(o.activeObj.activePoint.width!==0||o.activeObj.activePoint.height!==0)&&this.redrawText(),o.notify("undo-redo",{prop:"updateUrObj",onPropertyChange:!1,value:{objColl:e}})},l.prototype.updateArrowRatio=function(t){var e=this.parent,i={arrowDimension:null};e.notify("draw",{prop:"getArrowDimension",onPropertyChange:!1,value:{obj:i}});var r;Math.abs(t.activePoint.width)>Math.abs(t.activePoint.height)?r=Math.abs(t.activePoint.width):r=Math.abs(t.activePoint.height);for(var o,a=["bar","arrow","arrowSolid","circle","square"],n=0,s=a;n<s.length;n++){o=s[n];var h=r/i.arrowDimension[o].width,p=r/i.arrowDimension[o].height;i.arrowDimension[o].ratioX=h,i.arrowDimension[o].ratioY=p}},l.prototype.updateArrowSize=function(t){var e={arrowDimension:null};this.parent.notify("draw",{prop:"getArrowDimension",onPropertyChange:!1,value:{obj:e}});var i;Math.abs(t.activePoint.width)>Math.abs(t.activePoint.height)?i=Math.abs(t.activePoint.width):i=Math.abs(t.activePoint.height);for(var r,o=["bar","arrow","arrowSolid","circle","square"],a=0,n=o;a<n.length;a++){r=n[a];var s=e.arrowDimension[r].ratioX,h=e.arrowDimension[r].ratioY;e.arrowDimension[r].width=i/s,e.arrowDimension[r].height=i/h}},l.prototype.updateFontRatio=function(t,e){var i=this.parent,r=this.getMaxText(e),o=this.upperContext.measureText(r).width+i.activeObj.textSettings.fontSize*.5,a=i.activeObj.textSettings.fontSize,n=this.getRotDegOfShape(t);if(d(e))n===0||Math.abs(n)===180?t.textSettings.fontRatio=o/t.textSettings.fontSize:t.textSettings.fontRatio=a/t.textSettings.fontSize;else if(e){var s={bool:!1};i.notify("selection",{prop:"getTransformedShape",onPropertyChange:!1,value:{obj:s}}),!s.bool||n===0||Math.abs(n)===180?t.textSettings.fontRatio=o/parseFloat(i.textArea.style.fontSize):t.textSettings.fontRatio=a/parseFloat(i.textArea.style.fontSize)}},l.prototype.updateFontSize=function(t){var e=this.getRotDegOfShape(t,!0);e===0||Math.abs(e)===180?t.textSettings.fontSize=t.activePoint.width/t.textSettings.fontRatio:t.textSettings.fontSize=t.activePoint.height/t.textSettings.fontRatio},l.prototype.updateObjColl=function(t,e){var i=this.parent,r=y({},i.cropObj,{},!0),o={currObj:{}};i.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:o}});var a=o.currObj;a.objColl=e,a.pointColl=y([],i.pointColl,[],!0),a.afterCropActions=y([],i.afterCropActions,[],!0);var n={selPointColl:null};i.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:n}}),a.selPointColl=y([],n.selPointColl,[],!0);var s=i.activeObj.textSettings.bold,h=i.activeObj.textSettings.italic;switch(t){case"default":i.activeObj.textSettings.bold=!1,i.activeObj.textSettings.italic=!1;break;case"bold":i.activeObj.textSettings.bold=!0,i.activeObj.textSettings.italic=!1;break;case"italic":i.activeObj.textSettings.bold=!1,i.activeObj.textSettings.italic=!0;break;case"bolditalic":i.activeObj.textSettings.bold=!0,i.activeObj.textSettings.italic=!0;break}i.objColl.push(i.activeObj),i.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"textAreaCustomization",previousObj:a,previousObjColl:a.objColl,previousPointColl:a.pointColl,previousSelPointColl:a.selPointColl,previousCropObj:r,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),i.objColl.pop(),i.activeObj.textSettings.bold=s,i.activeObj.textSettings.italic=h},l.prototype.pushActItemIntoObj=function(){var t=this.parent;if(t.textArea.style.display==="none")(t.activeObj.activePoint.width!==0||t.activeObj.activePoint.height!==0)&&t.objColl.push(t.activeObj);else{var e=y({},t.activeObj,{},!0);t.notify("selection",{prop:"setTextBoxStylesToActObj",onPropertyChange:!1}),t.objColl.push(t.activeObj),t.activeObj=e}},l.prototype.clearActObj=function(){var t=this.parent;t.textArea.style.display==="none"&&(this.refreshActiveObj(),this.applyActObj(),this.refreshActiveObj(),t.currObjType.isCustomCrop=!1)},l.prototype.refreshActiveObj=function(){var t=this.parent;t.activeObj={},t.activeObj.activePoint={startX:0,startY:0,endX:0,endY:0,width:0,height:0},t.activeObj.triangle=[],t.activeObj.triangleRatio=[],t.activeObj.order=null,t.activeObj.flipObjColl=[],t.activeObj.strokeSettings=this.strokeSettings,t.activeObj.textSettings=this.textSettings,t.activeObj.rotatedAngle=0,t.activeObj.opacity=1,t.activeObj.redactType=this.redactType,t.activeObj.redactBlur=t.tempRedactBlur,t.activeObj.redactPixelate=t.tempRedactPixel},l.prototype.applyActObj=function(t){var e=this.parent,i=!1;if(e.activeObj.shape!==void 0&&e.activeObj.shape==="text"&&e.activeObj.keyHistory==="")this.refreshActiveObj(),this.upperContext.clearRect(0,0,e.upperCanvas.width,e.upperCanvas.height);else{var r=void 0,o=!1;if(e.activeObj.shape!==void 0&&(r=e.activeObj.shape.split("-")),(r===void 0&&e.currObjType.isCustomCrop||r!==void 0&&r[0]==="crop")&&(o=!0),e.activeObj.shape&&!o&&e.activeObj.shape!=="shape"){for(var a=0;a<e.objColl.length;a++)if(JSON.stringify(e.activeObj)===JSON.stringify(e.objColl[a])){i=!0;break}if(!i){d(e.activeObj.currIndex)&&(e.activeObj.currIndex=this.getNewShapeId()),d(e.activeObj.order)&&(e.activeObj.order=this.getNewOrder()),this.updImgRatioForActObj();var n=e.activeObj.currIndex.split("_"),s=e.objColl.splice(0,parseInt(n[1],10)-1);s.push(y({},e.activeObj,{},!0));for(var a=0;a<e.objColl.length;a++)s.push(e.objColl[a]);e.objColl=s,s=[],this.refreshActiveObj(),this.lowerContext.clearRect(0,0,e.lowerCanvas.width,e.lowerCanvas.height),e.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),e.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),e.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}}),e.currObjType.shape="",this.refreshActiveObj(),e.isCircleCrop&&e.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),e.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1}),d(t)&&(e.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),e.notify("draw",{prop:"setPrevActObj",onPropertyChange:!1,value:{prevActObj:null}}))}}}},l.prototype.getNewShapeId=function(){for(var t=this.parent,e=t.objColl.length+1,i=0;i<t.objColl.length;i++)t.objColl[i].currIndex==="shape_"+e&&(e++,i=-1);return"shape_"+e},l.prototype.getNewOrder=function(){var t=this.parent;this.updateShapeColl();for(var e=t.shapeColl.length+1,i=0;i<t.shapeColl.length;i++)t.shapeColl[i].order===e&&(e++,i=-1);return e},l.prototype.getHighestOrder=function(){var t=this.parent;this.updateShapeColl();for(var e=0,i=0;i<t.shapeColl.length;i++)t.shapeColl[i].order>e&&(e=t.shapeColl[i].order);return e},l.prototype.getLowestOrder=function(){var t=this.parent;this.updateShapeColl();for(var e=1,i=0;i<t.shapeColl.length;i++)t.shapeColl[i].order<e&&(e=t.shapeColl[i].order);return e},l.prototype.alignTextAreaIntoCanvas=function(){var t=this.parent,e=t.textArea.value;t.textArea.value="";for(var i=0,r=e.length;i<r;i++)t.textArea.value+=e[i],t.textArea.style.height="auto",t.textArea.style.height=t.textArea.scrollHeight+"px",this.setTextBoxWidth()},l.prototype.transformTextArea=function(){var t=this.parent;if(t.activeObj.shape==="text"){t.textArea.style.transformOrigin="0 0";var e=t.activeObj.rotatedAngle*(180/Math.PI),i="",r=this.getRotDegOfShape(t.activeObj);if(t.activeObj.flipObjColl.length>0)for(var o=0;o<t.activeObj.flipObjColl.length;o++)r!==0&&r%90===0&&r!==180?i+=t.activeObj.flipObjColl[o].toLowerCase()==="horizontal"?"scale(1, -1)":"scale(-1, 1)":i+=t.activeObj.flipObjColl[o].toLowerCase()==="horizontal"?"scale(-1, 1)":"scale(1, -1)",r+=e,(t.activeObj.flipObjColl[o].toLowerCase()==="horizontal"||t.activeObj.flipObjColl[o].toLowerCase()==="vertical")&&(t.textArea.style.transform="rotate("+r+"deg)"+i);else r+=e,t.textArea.style.transform="rotate("+r+"deg)"}},l.prototype.getTextAreaWidth=function(t){var e=this.parent,i=e.activeObj.textSettings.bold,r=e.activeObj.textSettings.italic;switch(t){case"default":e.activeObj.textSettings.bold=!1,e.activeObj.textSettings.italic=!1;break;case"bold":e.activeObj.textSettings.bold=!0,e.activeObj.textSettings.italic=!1;break;case"italic":e.activeObj.textSettings.bold=!1,e.activeObj.textSettings.italic=!0;break;case"bolditalic":e.activeObj.textSettings.bold=!0,e.activeObj.textSettings.italic=!0;break}var o=e.textArea.style.display!=="none";this.updateFontStyles(o);var a;return o?a=this.upperContext.measureText(e.textArea.value).width+e.activeObj.textSettings.fontSize*.5:a=this.upperContext.measureText(e.activeObj.keyHistory).width+e.activeObj.textSettings.fontSize*.5,e.activeObj.textSettings.bold=i,e.activeObj.textSettings.italic=r,a},l.prototype.getRedactObjDetails=function(t){var e=this.parent,i={};switch(i.id=t.currIndex,i.type=e.toPascalCase(t.redactType),i.startX=t.activePoint.startX,i.startY=t.activePoint.startY,i.width=t.activePoint.width,i.height=t.activePoint.height,t.redactType){case"blur":i.blurIntensity=t.redactBlur;break;case"pixelate":i.pixelSize=t.redactPixelate;break}return i},l.prototype.getObjDetails=function(t){var e=this.parent,i={};i.id=t.currIndex,i.type=e.toPascalCase(t.shape),i.startX=t.activePoint.startX,i.startY=t.activePoint.startY,i.index=t.order;var r={coll:null};switch(t.shape){case"rectangle":i.width=t.activePoint.width,i.height=t.activePoint.height,i.strokeColor=t.strokeSettings.strokeColor,i.fillColor=t.strokeSettings.fillColor,i.strokeWidth=t.strokeSettings.strokeWidth,i.degree=t.rotatedAngle*(180/Math.PI);break;case"ellipse":i.radius=t.activePoint.width/2,i.strokeColor=t.strokeSettings.strokeColor,i.fillColor=t.strokeSettings.fillColor,i.strokeWidth=t.strokeSettings.strokeWidth,i.radiusX=t.activePoint.width/2,i.radiusY=t.activePoint.height/2,i.degree=t.rotatedAngle*(180/Math.PI);break;case"line":case"arrow":if(i.length=t.activePoint.width,i.strokeColor=t.strokeSettings.strokeColor,i.strokeWidth=t.strokeSettings.strokeWidth,i.endX=t.activePoint.endX,i.endY=t.activePoint.endY,t.shape==="arrow"){var o={type:null};e.notify("selection",{prop:"getArrowType",onPropertyChange:!1,value:{type:t.start,obj:o}}),i.arrowHead=o.type,e.notify("selection",{prop:"getArrowType",onPropertyChange:!1,value:{type:t.end,obj:o}}),i.arrowTail=o.type}break;case"text":i.text=t.keyHistory,i.fontSize=t.textSettings.fontSize,i.fontFamily=t.textSettings.fontFamily,i.color=t.strokeSettings.strokeColor,i.strokeColor=t.strokeSettings.outlineColor,i.fillColor=t.strokeSettings.fillColor,i.strokeWidth=t.strokeSettings.outlineWidth,i.fontStyle=[],t.textSettings.bold&&i.fontStyle.push("bold"),t.textSettings.italic&&i.fontStyle.push("italic"),i.degree=t.rotatedAngle*(180/Math.PI),e.notify("selection",{prop:"updateTransColl",onPropertyChange:!1,value:{obj:r,object:t}}),i.transformCollection=r.coll;break;case"path":i.strokeColor=t.strokeSettings.strokeColor,i.strokeWidth=t.strokeSettings.strokeWidth,i.points=t.pointColl;break;case"image":i.imageData=t.imageCanvas.toDataURL(),i.degree=t.rotatedAngle*(180/Math.PI),i.width=t.activePoint.width,i.height=t.activePoint.height,i.opacity=t.opacity;break}return i},l.prototype.getFreehandDrawDetails=function(t){var e=this.parent,i={};return i.id=e.pointColl[t].id,i.type=bt.FreehandDraw,i.points=y([],e.pointColl[t].points),i.strokeColor=e.pointColl[t].strokeColor,i.strokeWidth=e.pointColl[t].strokeWidth,i.index=e.pointColl[t].order,i},l.prototype.getShapeSetting=function(t,e){var i=this.parent,r;if(!i.disabled&&i.isImageLoaded)if(i.textArea.style.display!=="none"?i.okBtn(null,!0):this.applyActObj(!0),t.split("_")[0]==="shape"){for(var o,a=0,n=i.objColl.length;a<n;a++)if(i.objColl[a].currIndex===t){o=y({},i.objColl[a],{},!0);break}r=this.getObjDetails(o)}else t.split("_")[0]==="pen"&&(r=this.getFreehandDrawDetails(parseInt(t.split("_")[1],10)-1));e.shapeDetails=r},l.prototype.getShapeSettings=function(t){var e=this.parent,i=[];if(!e.disabled&&e.isImageLoaded){e.textArea.style.display!=="none"?e.okBtn(null,!0):this.applyActObj(!0);for(var r=0,o=e.objColl.length;r<o;r++){var a=this.getObjDetails(e.objColl[r]);i.push(a)}for(var r=0;r<e.freehandCounter;r++){var a=this.getFreehandDrawDetails(r);i.push(a)}}t.shapeDetailsColl=i},l.prototype.getRedactSettings=function(t){var e=this.parent,i=[];if(!e.disabled&&e.isImageLoaded){e.textArea.style.display!=="none"?e.okBtn(null,!0):this.applyActObj(!0);for(var r=0,o=e.objColl.length;r<o;r++){var a=this.getRedactObjDetails(e.objColl[r]);i.push(a)}}t.shapeDetailsColl=i},l.prototype.isPointsInRange=function(t,e,i){var r=!1,o=this.parent;!d(t)&&!d(e)&&t>=o.img.destLeft&&e>=o.img.destTop&&t<=o.img.destLeft+o.img.destWidth&&e<=o.img.destTop+o.img.destHeight&&(r=!0),i.inRange=r},l.prototype.alignRotateFlipColl=function(t,e,i){return t=this.popForDefaultTransformedState(t),t=this.popForDefaultFlipState(t),t=this.popForDefaultRotateState(t),t.length===0&&e&&(this.parent.transform.degree=0,this.parent.transform.currFlipState=""),i.collection=t,t},l.prototype.popForDefaultTransformedState=function(t){for(var e=0,i=0,r=0,o=0,a=0;a<t.length;a++)t[a]===90||t[a]==="rotateRight"?(e++,i=0,r=0,o=0,e===4&&(t.pop(),t.pop(),t.pop(),t.pop())):t[a]===-90||t[a]==="rotateLeft"?(i++,e=0,r=0,o=0,i===4&&(t.pop(),t.pop(),t.pop(),t.pop())):t[a]==="horizontal"||t[a]==="Horizontal"||t[a]==="horizontalflip"?(r++,i=0,e=0,o=0,r===2&&(t.pop(),t.pop())):(t[a]==="vertical"||t[a]==="Vertical"||t[a]==="verticalflip")&&(o++,r=0,i=0,e=0,o===2&&(t.pop(),t.pop()));return t},l.prototype.popForDefaultFlipState=function(t){for(var e=0,i=t.length-3;e<i;e++){var r=t[e]==="horizontal"||t[e]==="Horizontal"||t[e]==="horizontalFlip",o=t[e]==="vertical"||t[e]==="Vertical"||t[e]==="verticalFlip",a=t[e+1]==="horizontal"||t[e+1]==="Horizontal"||t[e+1]==="horizontalFlip",n=t[e+1]==="vertical"||t[e+1]==="Vertical"||t[e+1]==="verticalFlip",s=t[e+2]==="horizontal"||t[e+2]==="Horizontal"||t[e+2]==="horizontalFlip",h=t[e+2]==="vertical"||t[e+2]==="Vertical"||t[e+2]==="verticalFlip",p=t[e+3]==="horizontal"||t[e+3]==="Horizontal"||t[e+3]==="horizontalFlip";(r&&n&&s&&h||o&&a&&h&&p)&&(t.splice(e,4),e-=4)}return t},l.prototype.popForDefaultRotateState=function(t){for(var e=0;e<t.length-1;e++){var i=t[e],r=t[e+1];((i===90||i==="rotateRight")&&(r===-90||r==="rotateLeft")||(i===-90||i==="rotateLeft")&&(r===90||r==="rotateRight"))&&(t.splice(e,2),e-=2)}return t},l.prototype.selectShape=function(t,e){var i=this.parent,r=!1;if(!i.disabled&&i.isImageLoaded){if(this.applyActObj(),t.split("_")[0]==="shape"){for(var o,a=0,n=i.objColl.length;a<n;a++)if(i.objColl[a].currIndex===t){o=y({},i.objColl[a],{},!0);break}if(d(o))r=!1;else{r=!0,i.activeObj=o;var s={canvasFilter:null};i.notify("toolbar",{prop:"getCanvasFilter",onPropertyChange:!1,value:{obj:s}}),this.lowerContext.filter=s.canvasFilter,i.notify("selection",{prop:"redrawShape",onPropertyChange:!1,value:{obj:i.activeObj}}),i.activeObj.shape==="text"?i.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"text",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}):i.activeObj.shape==="pen"?i.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"pen",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}):i.activeObj.shape==="redact"?i.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"redact",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}):i.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"shapes",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),i.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1}),i.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}})}}else if(t.split("_")[0]==="pen"){var s={bool:!1};i.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:s}}),s.bool&&i.okBtn(null,!0);var h={isIndex:!1};i.notify("freehand-draw",{prop:"isFHDIdx",value:{index:parseInt(t.split("_")[1],10)-1,obj:h}}),h.isIndex?(r=!0,i.notify("freehand-draw",{prop:"selectFhd",value:{id:t}}),i.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:!0}}),i.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1})):r=!1}}e.isSelected=r},l.prototype.deleteShape=function(t){var e=this.parent;if(!e.disabled&&e.isImageLoaded){if(e.activeObj.currIndex&&e.activeObj.currIndex===t)e.notify("selection",{prop:"deleteItem",onPropertyChange:!1});else if(this.applyActObj(),t.split("_")[0]==="shape"){for(var i=0,r=e.objColl.length;i<r;i++)if(e.objColl[i].currIndex===t){e.objColl.splice(i,1);break}}else t.split("_")[0]==="pen"&&e.notify("freehand-draw",{prop:"handle-freehand-draw",value:{id:t}});var o={canvasFilter:null};e.notify("toolbar",{prop:"getCanvasFilter",onPropertyChange:!1,value:{obj:o}}),this.lowerContext.filter=o.canvasFilter,this.lowerContext.clearRect(0,0,e.lowerCanvas.width,e.lowerCanvas.height),e.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),e.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1})}},l.prototype.getMaxText=function(t,e,i){if(d(e)&&(e=t?this.parent.textArea.value:this.parent.activeObj.keyHistory,!e))return e;for(var r,o=e.split(`
`),a=o[0].length,n=o[0],s=1;s<o.length;s++)r=o[s].length,r>a&&(n=o[s],a=r);return i&&(i.maxText=n),n},l.prototype.getLinePoints=function(t,e,i,r){var o=[],a,n;if(t===i){e<r?(a=[t,e],n=[i,r]):(n=[t,e],a=[i,r]);for(var s=this.getSlope(a,n,!0),h=this.getIntercept(a,s),p=a[1];p<=n[1];p++){var u=s*p+h;o.push({x:u,y:p})}}else{t<i?(a=[t,e],n=[i,r]):(n=[t,e],a=[i,r]);for(var s=this.getSlope(a,n,!1),h=this.getIntercept(a,s),u=a[0];u<=n[0];u++){var p=s*u+h;o.push({x:u,y:p})}}if(Math.floor(t)===Math.floor(i)||o.length<10&&(r-e>10||e-r>10)){o=[];for(var c=Math.min(e,r),f=0;f<Math.abs(Math.floor(r)-Math.floor(e));f++)o.push({x:t,y:c+f});if(o.length>1){var g=void 0;d(o[o.length-2])?g={x:0,y:0}:g=o[o.length-2];var v=o[o.length-1].x-g.x,m=o[o.length-1].y-g.y;o.push({x:o[o.length-1].x+v/2,y:o[o.length-1].y+m/2})}}else if(Math.floor(e)===Math.floor(r)||o.length<10&&(i-t>10||t-i>10)){o=[];for(var C=Math.min(t,i),M=0;M<Math.abs(Math.floor(i)-Math.floor(t));M++)o.push({x:C+M,y:e});if(o.length>1){var g=void 0;d(o[o.length-2])?g={x:0,y:0}:g=o[o.length-2];var v=o[o.length-1].x-g.x,m=o[o.length-1].y-g.y;o.push({x:o[o.length-1].x+v/2,y:o[o.length-1].y+m/2})}}return o},l.prototype.getSlope=function(t,e,i){var r;if(i){if(t[1]===e[1])return null;r=(e[0]-t[0])/(e[1]-t[1])}else{if(t[0]===e[0])return null;r=(e[1]-t[1])/(e[0]-t[0])}return r},l.prototype.getIntercept=function(t,e){return e===null?t[0]:t[1]-e*t[0]},l.prototype.setPointCollForShapeRotation=function(t){var e=this.parent,i=t.activePoint,r=i.startX,o=i.startY,a=i.endX,n=i.endY,s=i.width,h=i.height,p={x:r+s/2,y:o+h/2},u=Math.cos(t.rotatedAngle),c=Math.sin(t.rotatedAngle),f={x:u*(r-p.x)-c*(o-p.y)+p.x,y:c*(r-p.x)+u*(o-p.y)+p.y},g={x:u*(a-p.x)-c*(o-p.y)+p.x,y:c*(a-p.x)+u*(o-p.y)+p.y},v={x:u*(r-p.x)-c*(n-p.y)+p.x,y:c*(r-p.x)+u*(n-p.y)+p.y},m={x:u*(a-p.x)-c*(n-p.y)+p.x,y:c*(a-p.x)+u*(n-p.y)+p.y};t.horTopLinePointColl=this.getLinePoints(f.x,f.y,g.x,g.y),t.horTopLinePointColl=this.getLinePoints(f.x,f.y,g.x,g.y),t.horBottomLinePointColl=this.getLinePoints(v.x,v.y,m.x,m.y),t.verLeftLinePointColl=this.getLinePoints(f.x,f.y,v.x,v.y),t.verRightLinePointColl=this.getLinePoints(g.x,g.y,m.x,m.y),t.verLeftLinePointColl.reverse(),t.verRightLinePointColl.reverse();for(var C=0;C<t.horTopLinePointColl.length;C++)t.horTopLinePointColl[C].ratioX=(t.horTopLinePointColl[C].x-this.parent.img.destLeft)/this.parent.img.destWidth,t.horTopLinePointColl[C].ratioY=(t.horTopLinePointColl[C].y-this.parent.img.destTop)/this.parent.img.destHeight;for(var C=0;C<t.horBottomLinePointColl.length;C++)t.horBottomLinePointColl[C].ratioX=(t.horBottomLinePointColl[C].x-this.parent.img.destLeft)/this.parent.img.destWidth,t.horBottomLinePointColl[C].ratioY=(t.horBottomLinePointColl[C].y-this.parent.img.destTop)/this.parent.img.destHeight;for(var C=0;C<t.verLeftLinePointColl.length;C++)t.verLeftLinePointColl[C].ratioX=(t.verLeftLinePointColl[C].x-this.parent.img.destLeft)/this.parent.img.destWidth,t.verLeftLinePointColl[C].ratioY=(t.verLeftLinePointColl[C].y-this.parent.img.destTop)/this.parent.img.destHeight;for(var C=0;C<t.verRightLinePointColl.length;C++)t.verRightLinePointColl[C].ratioX=(t.verRightLinePointColl[C].x-this.parent.img.destLeft)/this.parent.img.destWidth,t.verRightLinePointColl[C].ratioY=(t.verRightLinePointColl[C].y-this.parent.img.destTop)/this.parent.img.destHeight;if(e.upperCanvas.style.cursor!=="move"){var M={rotationCirclePoint:null};e.notify("selection",{prop:"getTransRotationPoint",value:{obj:t,object:M}});var I=M.rotationCirclePoint;I&&(t.rotationCirclePointColl={x:u*(I.x-p.x)-c*(I.y-p.y)+p.x,y:c*(I.x-p.x)+u*(I.y-p.y)+p.y},t.rotationCirclePointColl.ratioX=(t.rotationCirclePointColl.x-e.img.destLeft)/e.img.destWidth,t.rotationCirclePointColl.ratioY=(t.rotationCirclePointColl.y-e.img.destTop)/e.img.destHeight)}},l.prototype.getSquarePointForRotatedShape=function(t,e){var i={startX:0,startY:0,endX:0,endY:0,width:0,height:0},r=t.activePoint,o=r.startX,a=r.startY,n=r.endX,s=r.endY,h=r.width,p=r.height,u={x:o+h/2,y:a+p/2},c=Math.cos(t.rotatedAngle),f=Math.sin(t.rotatedAngle),g={x:c*(o-u.x)-f*(a-u.y)+u.x,y:f*(o-u.x)+c*(a-u.y)+u.y},v={x:c*(n-u.x)-f*(a-u.y)+u.x,y:f*(n-u.x)+c*(a-u.y)+u.y},m={x:c*(o-u.x)-f*(s-u.y)+u.x,y:f*(o-u.x)+c*(s-u.y)+u.y},C={x:c*(n-u.x)-f*(s-u.y)+u.x,y:f*(n-u.x)+c*(s-u.y)+u.y};return i.startX=g.x,i.startY=g.y,i.endX=g.x,i.endY=g.y,i.startX>v.x&&(i.startX=v.x),i.startX>m.x&&(i.startX=m.x),i.startX>C.x&&(i.startX=C.x),i.startY>v.y&&(i.startY=v.y),i.startY>m.y&&(i.startY=m.y),i.startY>C.y&&(i.startY=C.y),i.endX<v.x&&(i.endX=v.x),i.endX<m.x&&(i.endX=m.x),i.endX<C.x&&(i.endX=C.x),i.endY<v.y&&(i.endY=v.y),i.endY<m.y&&(i.endY=m.y),i.endY<C.y&&(i.endY=C.y),i.width=i.endX-i.startX,i.height=i.endY-i.startY,e&&(e.activePoint=i),i},l.prototype.updateZOrder=function(t,e){var i=this.parent;e=e.toLowerCase();var r=t;if(!d(r.order)){var o,a,n=this.getHighestOrder();if(this.updateShapeColl(),i.shapeColl.length!==0){for(var s,h=0;h<i.shapeColl.length;h++)s=i.shapeColl[h],r.id&&r.id.indexOf("pen")>-1?s.id&&s.id===r.id&&i.shapeColl.splice(h,1):s.shape&&s.shape.indexOf("crop-")>-1&&i.shapeColl.splice(h,1);switch(e){case"sendtoback":a=r.order,o=r.order,r.order=1;break;case"sendbackward":r.order-=1,o=r.order;break;case"bringtofront":a=r.order,o=n,r.order=o;break;case"bringforward":r.order+=1,o=r.order;break}this.reArrangeObjColl(o,e,a),r.id&&r.id.indexOf("pen")>-1&&this.reUpdateShapeColl(r)}}},l.prototype.reArrangeObjColl=function(t,e,i){var r=this.parent,o;switch(e){case"sendtoback":for(var a=0,n=r.shapeColl.length;a<n;a++)o=r.shapeColl[a],o.order<i&&o.order<=t&&(o.order+=1,this.reUpdateShapeColl(o));break;case"sendbackward":for(var a=0,n=r.shapeColl.length;a<n;a++)if(o=r.shapeColl[a],o.order===t){o.order+=1,this.reUpdateShapeColl(o);break}break;case"bringtofront":for(var a=0,n=r.shapeColl.length;a<n;a++)o=r.shapeColl[a],o.order>i&&o.order<=t&&(o.order-=1,this.reUpdateShapeColl(o));break;case"bringforward":for(var a=0,n=r.shapeColl.length;a<n;a++)if(o=r.shapeColl[a],o.order===t){o.order-=1,this.reUpdateShapeColl(o);break}break}},l.prototype.reorderRedact=function(t){var e=t.filter(function(r){return r.shape!=="redact"}),i=t.filter(function(r){return r.shape==="redact"});return i.concat(e)},l.prototype.updateShapeColl=function(){var t=this.parent,e=!1,i=1,r=y([],t.objColl,[],!0);r=this.reorderRedact(r);var o=y([],t.pointColl,[],!0);if(t.shapeColl.length>0&&t.shapeColl.length===t.objColl.length+t.pointColl.length){for(var a=0;a<t.shapeColl.length;a++)if(t.shapeColl[a].order===i)e=!0,i++;else{e=!1;break}if(e){for(var a=0;a<t.shapeColl.length;a++)if(t.shapeColl[a].currIndex&&t.shapeColl[a].currIndex.indexOf("shape")>-1){for(var n=0;n<r.length;n++)if(t.shapeColl[a].currIndex===r[n].currIndex){t.shapeColl[a]=y({},r[n],{},!0),r.splice(n,1);break}}else if(t.shapeColl[a].id&&t.shapeColl[a].id.indexOf("pen")>-1){for(var n=0;n<o.length;n++)if(t.shapeColl[a].id===o[n].id){t.shapeColl[a]=y([],o[n],[],!0),o.splice(n,1);break}}return}}r=y([],t.objColl,[],!0),o=y([],t.pointColl,[],!0),t.shapeColl=[];for(var s=1,h,p=!1;r.length!==0||o.length!==0;){h=p=!1;for(var a=0;a<r.length;a++)if(r[a].order===s||!r[a].order&&r[a].shape&&r[a].shape.indexOf("crop-")>-1){t.shapeColl.push(y({},r[a],{},!0)),r[a].shape&&r[a].shape.indexOf("crop-")>-1&&(p=!0),r.splice(a,1),h=!0;break}if(!h){for(var a=0;a<o.length;a++)if(o[a].order===s){t.shapeColl.push(y([],o[a],[],!0)),o.splice(a,1),h=!0;break}}p||s++}},l.prototype.reUpdateShapeColl=function(t){var e=this.parent;if(t.id&&t.id.indexOf("pen")>-1){if(e.freehandCounter>0)for(var i=0;i<e.freehandCounter;i++)e.pointColl[i].id===t.id&&(e.pointColl[i].order=t.order)}else if(t.currIndex&&t.currIndex.indexOf("shape")>-1)for(var i=0;i<e.objColl.length;i++)e.objColl[i].currIndex===t.currIndex&&(e.objColl[i].order=t.order)},l.prototype.drawAnnotations=function(t,e,i,r,o,a,n){var s=this.parent,h=y({},s.activeObj,{},!0),p=y([],s.objColl,[],!0),u=y([],s.pointColl,[],!0),c={selPointColl:null};s.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:c}});var f={selPointColl:null};s.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:f}}),this.updateShapeColl();var g=y([],s.shapeColl,[],!0);g=this.reorderRedact(g);var v=!1;this.preventFrameAnnotation||(this.preventFrameAnnotation=v=!0);for(var m=0;m<g.length;m++){var C=g[m].id;if(g[m].order||!g[m].order&&g[m].shape&&g[m].shape.indexOf("crop-")>-1||!g[m].order&&g[m].shape==="path"&&s.drawingShape==="path"){if(g[m].currIndex&&g[m].currIndex.indexOf("shape")>-1){if(s.objColl=[],s.objColl.push(y({},g[m],{},!0)),e==="iterate"){var M=this.lowerContext.filter;this.lowerContext.filter="none",this.iterateObjColl(),this.lowerContext.filter=M}else if(e==="zoom"||e==="pan"){for(var I=-1,N=0;N<p.length;N++)if(JSON.stringify(p[N])===JSON.stringify(s.objColl[0])){I=N;break}e==="zoom"?this.zoomObjColl(r):this.panObjColl(o,a,n),I>-1&&(p[I]=y({},s.objColl[0],{},!0))}}else if(g[m].id&&g[m].id.indexOf("pen")>-1){if(s.pointColl=[],s.freehandCounter=0,s.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:[]}}}),s.pointColl.push(y({},g[m],{},!0)),s.notify("freehand-draw",{prop:"pushSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:f.selPointColl[m]}}}),s.freehandCounter=s.pointColl.length,i==="iterate")s.notify("freehand-draw",{prop:"freehandRedraw",onPropertyChange:!1,value:{context:t,points:null}});else if(i==="zoom"||i==="pan"){i==="zoom"?s.notify("freehand-draw",{prop:"zoomFHDColl",onPropertyChange:!1,value:{isPreventApply:r}}):s.notify("freehand-draw",{prop:"panFHDColl",onPropertyChange:!1,value:{xDiff:o,yDiff:a,panRegion:n}});for(var O=0;O<u.length;O++)if(u[O].id===s.pointColl[0].id){u[O]=y({},s.pointColl[0],{},!0);break}for(var x=0,D=c.selPointColl.length;x<D;x++)if(c.selPointColl[x].id===f.selPointColl[x].id){c.selPointColl[x]=y({},f.selPointColl[x],{},!0);break}}}}else(!g[m].shape&&!C||!g[m].currIndex&&!C)&&g.splice(m,1)}i&&i==="zoom"&&(s.pointColl=[],s.freehandCounter=0,s.notify("freehand-draw",{prop:"zoomFHDColl",onPropertyChange:!1,value:{isPreventApply:r}})),s.objColl=p,s.pointColl=u,s.freehandCounter=s.pointColl.length,s.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:c.selPointColl}}}),v&&this.preventFrameAnnotation&&(s.notify("draw",{prop:"applyFrame",value:{ctx:this.lowerContext,frame:s.frameObj.type,preventImg:!0}}),this.preventFrameAnnotation=!1),s.activeObj=h},l}(),gv=function(){function l(t){this.isReverseFlip=!1,this.disablePan=!1,this.isReverseRotate=!1,this.flipColl=[],this.prevZoomValue=1,this.cropDimension={width:0,height:0},this.isPreventSelect=!1,this.preventDownScale=!1,this.resizedImgAngle=null,this.parent=t,this.addEventListener()}return l.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},l.prototype.addEventListener=function(){this.parent.on("transform",this.transform,this),this.parent.on("destroyed",this.destroy,this)},l.prototype.removeEventListener=function(){this.parent.off("transform",this.transform),this.parent.off("destroyed",this.destroy)},l.prototype.transform=function(t){switch(this.initTransformPvtVar(),t.prop){case"flipImage":this.flipImage(t.value.direction);break;case"setDestPointsForFlipState":this.setDestPointsForFlipState();break;case"zoomAction":this.zoomAction(t.value.zoomFactor,t.value.zoomPoint,t.value.isResize);break;case"disableZoomOutBtn":this.disableZoomOutBtn(t.value.isZoomOut);break;case"rotatedFlip":this.rotatedFlip();break;case"drawPannedImage":this.drawPannedImage(t.value.xDiff,t.value.yDiff);break;case"drawPannImage":this.drawPannImage(t.value.point);break;case"performTransformation":this.performTransformation(t.value.text);break;case"updateTransform":this.updateTransform(t.value.text);break;case"rotatePan":this.rotatePan(t.value.isCropSelection,t.value.isDefaultZoom);break;case"resetZoom":this.resetZoom();break;case"pan":this.pan(t.value.value,t.value.x,t.value.y);break;case"zoom":this.zoom(t.value.zoomFactor,t.value.zoomPoint);break;case"setCurrPanRegion":this.setCurrPanRegion(t.value.region,t.value.type,t.value.obj);break;case"rotate":this.rotate(t.value.degree,t.value.obj);break;case"flip":this.flip(t.value.direction);break;case"update":this.update();break;case"calcMaxDimension":this.calcMaxDimension(t.value.width,t.value.height,t.value.obj,t.value.isImgShape);break;case"getPanMove":t.value.obj.panMove=this.panMove;break;case"setPanMove":this.panMove=t.value.point;break;case"getTempPanMove":t.value.obj.tempPanMove=this.tempPanMove;break;case"setTempPanMove":this.tempPanMove=t.value.point;break;case"setReverseFlip":this.isReverseFlip=t.value.isReverseFlip;break;case"setDisablePan":this.disablePan=t.value.bool;break;case"setCurrDestinationPoint":this.currDestPoint=t.value.point,this.currDestPoint.startX-=this.parent.cropObj.totalPannedPoint.x,this.currDestPoint.startY-=this.parent.cropObj.totalPannedPoint.y;break;case"setReverseRotate":this.isReverseRotate=t.value.bool;break;case"getFlipColl":t.value.obj.flipColl=this.flipColl;break;case"setFlipColl":this.flipColl=t.value.flipColl;break;case"getPreviousZoomValue":t.value.obj.previousZoomValue=this.prevZoomValue;break;case"setPreviousZoomValue":this.prevZoomValue=t.value.previousZoomValue;break;case"getCropDimension":t.value.obj.cropDimension=this.cropDimension;break;case"setCropDimension":this.cropDimension.width=t.value.width,this.cropDimension.height=t.value.height;break;case"getPreventSelect":t.value.obj.bool=this.isPreventSelect;break;case"setPreventSelect":this.isPreventSelect=t.value.bool;break;case"resizeImage":this.resizeImage(t.value.width,t.value.height);break;case"resizeCrop":this.resizeCrop(t.value.width,t.value.height);break;case"updateResize":this.updateResize();break;case"resize":this.resize(t.value.width,t.value.height,t.value.isAspectRatio);break;case"straightenImage":this.straightenImage(t.value.degree);break;case"reset":this.reset();break;case"cropZoom":t.value.obj.maxDimension=this.cropZoom(t.value.value,t.value.selectionObj);break;case"setResizedImgAngle":this.resizedImgAngle=t.value.angle;break}},l.prototype.getModuleName=function(){return"transform"},l.prototype.initTransformPvtVar=function(){this.parent.lowerCanvas&&(this.lowerContext=this.parent.lowerCanvas.getContext("2d")),this.parent.upperCanvas&&(this.upperContext=this.parent.upperCanvas.getContext("2d"))},l.prototype.reset=function(){this.zoomBtnHold=null,this.tempPanMove=null,this.panMove=null,this.disablePan=!1,this.currDestPoint=null,this.isReverseRotate=!1,this.flipColl=[],this.resizedImgAngle=null,this.transCurrObj=null,this.prevZoomValue=1,this.isPreventSelect=this.preventDownScale=!1},l.prototype.rotateImage=function(t){var e=this.parent,i={cancel:!1,previousDegree:e.transform.degree,currentDegree:Math.abs(e.transform.degree+t)===360?0:e.transform.degree+t};this.isPreventSelect||(e.trigger("rotating",i),e.editCompleteArgs=i),this.rotateEvent(i,t)},l.prototype.rotateEvent=function(t,e){var i=this.parent;if(t.cancel)i.notify("draw",{prop:"setCurrentObj",onPropertyChange:!1,value:{obj:i.prevEventObjPoint}}),i.activeObj=i.prevEventSelectionPoint,i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:i.activeObj}});else{var r=void 0;if(d(this.transCurrObj)){var o={currObj:{}};i.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:o}}),r=o.currObj,r.objColl=y([],i.objColl,null,!0),r.pointColl=y({},i.pointColl,null,!0),r.afterCropActions=y([],i.afterCropActions,[],!0);var a={selPointColl:null};i.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:a}}),r.selPointColl=y([],a.selPointColl,[],!0)}i.afterCropActions.push(e===90?"rotateRight":"rotateLeft");var n=[],s=void 0;i.activeObj.activePoint&&i.activeObj.shape&&(i.activeObj.shape!==void 0&&(n=i.activeObj.shape.split("-")),(i.currObjType.isCustomCrop||n[0]==="crop")&&(s=i.currObjType.isCustomCrop?"custom":n[1],i.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),i.objColl.push(i.activeObj),i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}))),i.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:!0}}),this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),this.drawRotatedImage(e),i.notify("draw",{prop:"setImageEdited",onPropertyChange:!1}),i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}}),i.isCircleCrop&&i.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),s&&(this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),i.activeObj=y({},i.objColl[i.objColl.length-1],{},!0),i.objColl.pop(),i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:i.activeObj}})),i.isUndoRedo=!1;var h={collection:i.rotateFlipColl};i.notify("shape",{prop:"alignRotateFlipColl",onPropertyChange:!1,value:{collection:i.rotateFlipColl,isRotateFlipCollection:!0,obj:h}}),i.rotateFlipColl=h.collection,i.cropObj.activeObj.shape&&!this.isPreventSelect&&(i.notify("draw",{prop:"setIsCropSelect",value:{bool:!0}}),this.isPreventSelect=!0,i.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:"custom",startX:null,startY:null,width:null,height:null}}),this.isPreventSelect=!1,i.setProperties({zoomSettings:{zoomFactor:1}},!0),this.prevZoomValue=i.zoomSettings.zoomFactor)}},l.prototype.drawRotatedImage=function(t){var e=this.parent;t===0?e.transform.degree=0:e.transform.degree+=t,Math.abs(e.transform.degree)===360&&(e.transform.degree=0),e.notify("draw",{prop:"setDestPoints",onPropertyChange:!1});var i=y([],e.objColl,[],!0),r=y({},e.activeObj,{},!0);if(e.objColl=[],e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.isReverseRotate||e.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"initial",isPreventDestination:null,isRotatePan:null}}),this.rotateDegree(t),this.isReverseRotate||(e.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"reverse",isPreventDestination:null,isRotatePan:null}}),e.rotateFlipColl.push(t)),e.objColl=y([],i,[],!0),e.activeObj=y({},r,{},!0),e.isCircleCrop&&e.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),e.notify("shape",{prop:"redrawObj",onPropertyChange:!1,value:{degree:t}}),e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),t>0)e.notify("freehand-draw",{prop:"rotateFhdColl",onPropertyChange:!1});else for(var o=0;o<3;o++)e.notify("freehand-draw",{prop:"rotateFhdColl",onPropertyChange:!1});e.notify("freehand-draw",{prop:"freehandRedraw",onPropertyChange:!1,value:{context:this.lowerContext,points:null}}),this.updateCurrSelectionPoint(t)},l.prototype.rotateDegree=function(t){var e=this.parent;this.lowerContext.save(),this.lowerContext.clearRect(0,0,e.lowerCanvas.width,e.lowerCanvas.height),this.lowerContext.translate(e.lowerCanvas.width/2,e.lowerCanvas.height/2),this.lowerContext.rotate(Math.PI/180*t),this.lowerContext.translate(-e.lowerCanvas.width/2,-e.lowerCanvas.height/2);var i=this.lowerContext.filter;e.notify("draw",{prop:"drawImage",onPropertyChange:!1}),this.lowerContext.filter=i,this.lowerContext.translate(e.lowerCanvas.width/2,e.lowerCanvas.height/2),this.lowerContext.rotate(Math.PI/180*-t),this.lowerContext.translate(-e.lowerCanvas.width/2,-e.lowerCanvas.height/2),this.lowerContext.restore()},l.prototype.updateCurrSelectionPoint=function(t){var e=this.parent;if(e.currSelectionPoint&&this.currDestPoint){var i=y({},e.activeObj,{},!0),r=y([],e.objColl,[],!0),o={startX:e.img.srcLeft,startY:e.img.srcTop,width:e.img.srcWidth,height:e.img.srcHeight},a={startX:e.img.destLeft,startY:e.img.destTop,width:e.img.destWidth,height:e.img.destHeight};e.objColl=[],e.objColl.push(y({},e.currSelectionPoint,{},!0)),e.img={srcLeft:0,srcTop:0,srcWidth:e.baseImgCanvas.width,srcHeight:e.baseImgCanvas.height,destLeft:this.currDestPoint.startX,destTop:this.currDestPoint.startY,destWidth:this.currDestPoint.width,destHeight:this.currDestPoint.height},typeof t=="number"&&(e.notify("draw",{prop:"setDestPoints",onPropertyChange:!1}),e.notify("draw",{prop:"setClientTransDim",onPropertyChange:!1,value:{isPreventDimension:null}})),e.notify("shape",{prop:"redrawObj",onPropertyChange:!1,value:{degree:t}}),e.currSelectionPoint=y({},e.objColl[0],{},!0),this.currDestPoint={startX:e.img.destLeft,startY:e.img.destTop,width:e.img.destWidth,height:e.img.destHeight},e.objColl=r,e.activeObj=i,e.img={srcLeft:o.startX,srcTop:o.startY,srcWidth:o.width,srcHeight:o.height,destLeft:a.startX,destTop:a.startY,destWidth:a.width,destHeight:a.height}}},l.prototype.flipImage=function(t){var e=this.parent,i={direction:t,cancel:!1,previousDirection:e.toPascalCase(e.transform.currFlipState||t)};this.isPreventSelect||(e.trigger("flipping",i),e.editCompleteArgs=i),this.flipEvent(i,t)},l.prototype.flipEvent=function(t,e){var i=this.parent;if(t.cancel){i.notify("draw",{prop:"setCurrentObj",onPropertyChange:!1,value:{obj:i.prevEventObjPoint}}),i.activeObj=i.prevEventSelectionPoint,i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:i.activeObj}});return}var r;if(d(this.transCurrObj)){var o={currObj:{}};i.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:o}}),r=o.currObj,r.objColl=y([],i.objColl,null,!0),r.pointColl=y({},i.pointColl,null,!0),r.afterCropActions=y([],i.afterCropActions,[],!0);var a={selPointColl:null};i.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:a}}),r.selPointColl=y([],a.selPointColl,[],!0)}i.afterCropActions.push(e.toLowerCase()==="horizontal"?"horizontalflip":"verticalflip");var n=[],s;i.activeObj.activePoint&&(i.activeObj.shape!==void 0&&(n=i.activeObj.shape.split("-")),(i.currObjType.isCustomCrop||n[0]==="crop")&&(s=i.currObjType.isCustomCrop?"custom":n[1],i.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),i.objColl.push(i.activeObj),i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}))),i.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:!0}}),i.clearContext(this.lowerContext),i.clearContext(this.upperContext);var h=y([],i.objColl,[],!0),p=y({},i.activeObj,{},!0);i.objColl=[],i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.isReverseFlip||i.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"initial",isPreventDestination:null,isRotatePan:null}});var u=e.toLowerCase();this.updateFlipState(u);var c=i.transform.currFlipState.toLowerCase();i.transform.currFlipState=u==="horizontal"&&c==="horizontal"||u==="vertical"&&c==="vertical"?"":u;var f={isSelected:null};i.notify("draw",{prop:"getRotatedFlipCropSelection",onPropertyChange:!1,value:{bool:f}}),f.isSelected&&(i.img.destLeft+=i.panPoint.totalPannedInternalPoint.x,i.img.destTop+=i.panPoint.totalPannedInternalPoint.y);var g=this.lowerContext.filter;if(i.notify("draw",{prop:"drawImage",onPropertyChange:!1}),this.lowerContext.filter=g,i.notify("draw",{prop:"setImageEdited",onPropertyChange:!1}),this.updateFlipState(e.toLowerCase()),this.isReverseFlip||(i.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"reverse",isPreventDestination:null,isRotatePan:null}}),this.updateFlipColl(e.toLocaleLowerCase()),i.rotateFlipColl.push(e.toLowerCase())),i.rotateFlipColl.length===1){var v={panRegion:""};i.notify("crop",{prop:"getCurrFlipState",onPropertyChange:!1,value:{panObj:v}}),v.panRegion===""?i.notify("draw",{prop:"setClientTransDim",onPropertyChange:!1,value:{isPreventDimension:null}}):this.setDestPointsForFlipState()}i.isCircleCrop&&i.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),i.objColl=y([],h,[],!0),i.activeObj=y({},p,{},!0);for(var m=0,C=i.objColl.length;m<C;m++){var M=i.objColl[m].flipObjColl;M.length===0?M.push(e):M[M.length-1]===e?M.pop():M.push(e)}i.notify("shape",{prop:"redrawObj",onPropertyChange:!1,value:{degree:e.toLowerCase()}});var I=this.lowerContext.filter;this.lowerContext.filter="brightness(1) contrast(100%) hue-rotate(0deg) saturate(100%) opacity(1) blur(0px) sepia(0%) grayscale(0%) invert(0%)",i.notify("shape",{prop:"iterateObjColl",onPropertyChange:!1});var N=e.toLowerCase();N==="horizontal"||N==="vertical"?(i.notify("freehand-draw",{prop:"flipFHDColl",onPropertyChange:!1,value:{value:N}}),i.notify("freehand-draw",{prop:"freehandRedraw",onPropertyChange:!1,value:{context:this.lowerContext,points:null}})):i.notify("freehand-draw",{prop:"freehandRedraw",onPropertyChange:!1,value:{context:this.lowerContext,points:null}}),this.lowerContext.filter=I,i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.updateCurrSelectionPoint(N),i.isUndoRedo=!1,i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}}),i.isCircleCrop&&i.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),s&&(this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),i.activeObj=y({},i.objColl[i.objColl.length-1],{},!0),i.objColl.pop(),i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:i.activeObj}}));var O={collection:i.rotateFlipColl};i.notify("shape",{prop:"alignRotateFlipColl",onPropertyChange:!1,value:{collection:i.rotateFlipColl,isRotateFlipCollection:!0,obj:O}}),i.rotateFlipColl=O.collection,i.cropObj.activeObj.shape&&!this.isPreventSelect&&(i.notify("draw",{prop:"setIsCropSelect",value:{bool:!0}}),this.isPreventSelect=!0,i.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:"custom",startX:null,startY:null,width:null,height:null}}),this.isPreventSelect=!1,i.setProperties({zoomSettings:{zoomFactor:1}},!0),this.prevZoomValue=i.zoomSettings.zoomFactor)},l.prototype.updateFlipState=function(t){var e=this.parent.transform.degree;t==="horizontal"?e%90===0&&e%180!==0?this.verticalFlip():this.horizontalFlip():t==="vertical"&&(e%90===0&&e%180!==0?this.horizontalFlip():this.verticalFlip())},l.prototype.horizontalFlip=function(){this.lowerContext.translate(this.lowerContext.canvas.width,0),this.lowerContext.scale(-1,1),this.upperContext.translate(this.upperContext.canvas.width,0),this.upperContext.scale(-1,1)},l.prototype.verticalFlip=function(){this.lowerContext.translate(0,this.lowerContext.canvas.height),this.lowerContext.scale(1,-1),this.upperContext.translate(0,this.upperContext.canvas.height),this.upperContext.scale(1,-1)},l.prototype.updateFlipColl=function(t){if(!this.isPreventSelect&&(this.flipColl.length===0||this.flipColl[this.flipColl.length-1]!==t?this.flipColl.push(t):this.flipColl.pop(),this.flipColl.length>=4)){var e=this.flipColl.slice(-4);(e[0]==="horizontal"&&e[1]==="vertical"&&e[2]==="horizontal"&&e[3]==="vertical"||e[0]==="vertical"&&e[1]==="horizontal"&&e[2]==="vertical"&&e[3]==="horizontal")&&this.flipColl.splice(-4)}},l.prototype.setDestPointsForFlipState=function(){var t=this.parent,e={panRegion:""},i=t.img,r=i.destLeft,o=i.destTop,a=i.destWidth,n=i.destHeight,s=t.lowerCanvas,h=s.clientWidth,p=s.clientHeight;t.notify("crop",{prop:"getCurrFlipState",onPropertyChange:!1,value:{panObj:e}}),e.panRegion!==""&&(e.panRegion==="horizontal"?t.img.destLeft=h-(a+r):(e.panRegion==="vertical"||(t.img.destLeft=h-(a+r)),t.img.destTop=p-(n+o)))},l.prototype.zoomAction=function(t,e,i,r){var o=this.parent;if(!o.disabled&&o.isImageLoaded){if(d(i)&&(o.zoomSettings.zoomFactor>=o.zoomSettings.maxZoomFactor&&t>0||o.zoomSettings.zoomFactor>o.zoomSettings.minZoomFactor&&t<0&&this.disableZoomOutBtn(!0)||o.zoomSettings.zoomFactor<=o.zoomSettings.minZoomFactor&&t<0)){o.notify("toolbar",{prop:"zoom-up-handler",onPropertyChange:!1});return}o.notify("draw",{prop:"setImageEdited",onPropertyChange:!1});var a=t;t=a>0?.1:-.1;for(var n=0;n<Math.round(Math.abs(a/.1));n++)if(this.prevZoomValue===1)this.prevZoomValue+=t>0?t*10:t*10/10;else if(this.prevZoomValue>1)this.prevZoomValue+=t*10;else if(this.prevZoomValue<1){this.prevZoomValue+=t*10/10;var s=Math.pow(10,1);this.prevZoomValue=Math.round(this.prevZoomValue*s)/s}t=a,o.setProperties({zoomSettings:{zoomFactor:this.prevZoomValue}},!0);var h=void 0;this.tempActiveObj=null,this.isShape=!1,o.activeObj.shape!==void 0&&(o.activeObj.shape==="shape"?o.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}):h=o.activeObj.shape.split("-")),h!==void 0&&h[0]==="crop"?(this.tempActiveObj=y({},o.activeObj,{},!0),o.isCropTab=!0):(o.activeObj.shape&&h[0]!=="crop"&&(o.activeObj.activePoint.width!==0||o.activeObj.activePoint.height!==0)||o.activeObj.shape==="path"&&o.activeObj.pointColl.length>0)&&(this.isShape=!0);var p={zoomType:null};o.notify("selection",{prop:"getZoomType",onPropertyChange:!1,value:{obj:p}}),d(e)&&(o.isCropTab&&this.tempActiveObj?e={x:o.activeObj.activePoint.startX+o.activeObj.activePoint.width/2,y:o.activeObj.activePoint.startY+o.activeObj.activePoint.height/2}:e={x:o.lowerCanvas.clientWidth/2,y:o.lowerCanvas.clientHeight/2},(p.zoomType==="MouseWheel"||p.zoomType==="Pinch")&&(e={x:o.zoomSettings.zoomPoint.x,y:o.zoomSettings.zoomPoint.y}));var u=o.zoomSettings.zoomFactor-t*10,c={zoomPoint:e,cancel:!1,previousZoomFactor:u,currentZoomFactor:o.zoomSettings.zoomFactor,zoomTrigger:p.zoomType};!o.isCropToolbar&&o.isZoomBtnClick&&(o.trigger("zooming",c),o.editCompleteArgs=c),this.zoomEvent(c,t,r)}},l.prototype.zoomEvent=function(t,e,i){var r=this.parent,o,a=r.zoomSettings,n=a.zoomFactor,s=a.minZoomFactor;if(t.cancel){r.isZoomBtnClick=!1;return}this.parent.activeObj.redactType!=="blur"&&this.parent.activeObj.redactType!=="pixelate"&&r.notify("toolbar",{prop:"close-contextual-toolbar",onPropertyChange:!1}),!r.isCropTab&&r.activeObj.shape&&(o=r.activeObj.currIndex),r.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:!0}}),r.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,r.lowerCanvas.width,r.lowerCanvas.height);var h={canvasFilter:r.canvasFilter};this.lowerContext.filter=h.canvasFilter,r.upperCanvas.style.cursor=r.cursor="default";var p=y([],r.objColl,[],!0);if(!r.isCropTab){if(r.transform.degree!==0){r.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:null}}),r.panPoint.currentPannedPoint={x:0,y:0};var u=r.allowDownScale;r.allowDownScale=!1,this.rotatePan(!0,!0),r.allowDownScale=u}else r.transform.currFlipState!==""&&(r.panPoint.totalPannedPoint={x:0,y:0});r.transform.straighten===0&&!this.isPreventSelect&&r.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1,value:{isPreventApply:i}})}if(r.transform.degree===0){this.drawZoomImgToCanvas(e,this.tempActiveObj);var c={panRegion:""};if(r.notify("crop",{prop:"getCurrFlipState",onPropertyChange:!1,value:{panObj:c}}),c.panRegion!==""){r.notify("crop",{prop:"setTempFlipPanPoint",onPropertyChange:!1,value:{point:r.panPoint.totalPannedPoint,isAdd:!0}}),p=y([],r.objColl,[],!0),r.objColl=[];var f=r.img.destLeft,g=r.img.destTop;this.setDestPointsForFlipState(),this.rotatedFlip(),r.img.destLeft=f,r.img.destTop=g,r.objColl=p,r.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:i}}),r.transform.straighten===0&&!this.isPreventSelect&&r.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1,value:{isPreventApply:i}})}n<=s&&!r.isCropTab&&(r.panPoint.totalPannedPoint={x:0,y:0})}else{r.transform.straighten===0&&!this.isPreventSelect&&r.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1,value:{isPreventApply:i}}),r.panPoint.totalPannedClientPoint={x:0,y:0},r.panPoint.totalPannedInternalPoint={x:0,y:0},this.rotateZoom(e);var v={panRegion:""};if(r.notify("crop",{prop:"getCurrFlipState",onPropertyChange:!1,value:{panObj:v}}),v.panRegion!==""){var u=this.lowerContext.filter;this.lowerContext.filter="none",r.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:i}}),this.lowerContext.filter=u}}var m=Math.pow(10,1);(n<=s||Math.round(r.transform.zoomFactor*m)/m===2)&&(clearInterval(this.zoomBtnHold),this.zoomBtnHold=0);var C={panRegion:""};if(r.notify("crop",{prop:"getCurrFlipState",onPropertyChange:!1,value:{panObj:C}}),C.panRegion===""){var u=this.lowerContext.filter;this.lowerContext.filter="none",r.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:i}}),this.lowerContext.filter=u}(r.currSelectionPoint&&r.currSelectionPoint.shape==="crop-circle"||r.isCircleCrop)&&r.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),r.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),r.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.tempActiveObj&&(r.activeObj=y({},this.tempActiveObj,{},!0),r.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:r.activeObj}}),n<=s&&(r.currSelectionPoint=null)),r.isUndoRedo=!1;var M;M=document.querySelector("#"+r.element.id+"_zoomOut"),M&&n<=s?(M.classList.add("e-disabled"),M.parentElement.classList.add("e-overlay")):M&&(M.classList.remove("e-disabled"),M.parentElement.classList.remove("e-overlay"));var I=r.drawingShape;if(this.autoEnablePan(),r.drawingShape=I,this.tempActiveObj&&(r.activeObj=y({},this.tempActiveObj,{},!0)),r.activeObj.shape==="crop-custom"&&(r.currObjType.isCustomCrop=!0),this.isShape){if(o){for(var N=0,O=r.objColl.length;N<O;N++)if(r.objColl[N].currIndex===o){r.activeObj=y({},r.objColl[N],{},!0),r.objColl.splice(N,1);break}}else r.activeObj=y({},r.objColl[r.objColl.length-1],{},!0),r.objColl.pop();r.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:r.activeObj,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:null}}),r.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1}),r.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}})}if(r.notify("toolbar",{prop:"enable-disable-btns",onPropertyChange:!1}),r.notify("selection",{prop:"setZoomType",onPropertyChange:!1,value:{zoomType:"Toolbar"}}),t={zoomPoint:t.zoomPoint,previousZoomFactor:t.previousZoomFactor,currentZoomFactor:t.currentZoomFactor,zoomTrigger:t.zoomTrigger},!r.isCropToolbar&&r.isZoomBtnClick&&(r.isZoomBtnClick=!1),r.drawingShape){var x=y({},r.activeObj,{},!0);if(r.enableShapeDrawing(r.toPascalCase(r.drawingShape),!0),r.activeObj=x,x.activePoint.width>0||x.activePoint.height>0||x.pointColl&&x.pointColl.length>0){x.shape==="redact"&&r.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}});var D=r.element.querySelector("#"+r.element.id+"_zOrderBtn"),A=r.element.querySelector("#"+r.element.id+"_duplicate"),P=r.element.querySelector("#"+r.element.id+"_remove"),V=r.element.querySelector("#"+r.element.id+"_editText");D&&D.classList.remove("e-overlay"),A&&A.classList.remove("e-overlay"),P&&P.classList.remove("e-overlay"),V&&V.classList.remove("e-overlay")}}else r.activeObj.shape&&r.activeObj.shape==="redact"&&(r.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"redact",isApplyBtn:!1,isCropping:!1}}),r.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}}))},l.prototype.disableZoomOutBtn=function(t){var e=this.parent,i=e.zoomSettings,r=i.zoomFactor,o=i.minZoomFactor,a=!1,n;d(t)||(e.transform.zoomFactor-=.1),n=e.element.querySelector("#"+e.element.id+"_zoomOut");var s={destLeft:e.img.destLeft,destTop:e.img.destTop,destWidth:e.img.destWidth,destHeight:e.img.destHeight};if(e.activeObj.shape){var h=this.setZoomDimension(-.1,e.activeObj);if(!d(n)){var p=e.activeObj.activePoint;if(e.transform.straighten===0)e.img.destLeft>p.startX||e.img.destTop>p.startY||e.img.destLeft+e.img.destWidth<p.endX||e.img.destTop+e.img.destHeight<p.endY||r===o?(n.classList.add("e-disabled"),n.parentElement.classList.add("e-overlay"),a=!0):(n.classList.remove("e-disabled"),n.parentElement.classList.remove("e-overlay"),a=!1);else{e.img.destWidth=h.width,e.img.destHeight=h.height;var u={isIntersect:null};e.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),e.notify("draw",{prop:"isLinesIntersect",onPropertyChange:!1,value:{obj:u}}),u.isIntersect||r===o?(n.classList.add("e-disabled"),n.parentElement.classList.add("e-overlay"),a=!0):(n.classList.remove("e-disabled"),n.parentElement.classList.remove("e-overlay"),a=!1)}}}else this.setZoomDimension(-.1,null);return d(t)||(e.transform.zoomFactor+=.1),e.img.destLeft=s.destLeft,e.img.destTop=s.destTop,e.img.destWidth=s.destWidth,e.img.destHeight=s.destHeight,a},l.prototype.drawZoomImgToCanvas=function(t,e){var i=this.parent,r=Math.pow(10,1),o=Math.round(i.transform.zoomFactor*r)/r;o===.1&&t===-.1||o===0&&t===-.025?i.transform.zoomFactor=0:i.transform.zoomFactor+=t,i.transform[i.isCropTab?"cropZoomFactor":"defaultZoomFactor"]=i.transform.zoomFactor;var a={width:0,height:0};i.isCropTab?a=this.cropZoom(t,e):(a=this.calcMaxDimension(i.img.srcWidth,i.img.srcHeight),a.width+=a.width*i.transform.zoomFactor,a.height+=a.height*i.transform.zoomFactor,i.img.destLeft=(i.lowerCanvas.clientWidth-a.width)/2,i.img.destTop=(i.lowerCanvas.clientHeight-a.height+1)/2),i.notify("draw",{prop:"draw-image-to-canvas",value:{dimension:a}}),a.width=this.cropDimension.width,a.height=this.cropDimension.height,a.width+=a.width*i.transform.zoomFactor,a.height+=a.height*i.transform.zoomFactor,i.notify("draw",{prop:"setZoomCropWidth",value:{width:a.width,height:a.height}})},l.prototype.rotatedFlip=function(){var t=this.parent;this.isReverseFlip=!0;var e=t.transform.currFlipState,i=this.flipColl,r=y([],t.objColl,[],!0),o=y({},t.activeObj,{},!0);this.flipColl=[],t.objColl=[],t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),t.notify("draw",{prop:"currTransState",onPropertyChange:!1,value:{type:"initial",isPreventDestination:null,context:null,isPreventCircleCrop:null}});var a=this.lowerContext.filter;t.notify("draw",{prop:"drawImage",onPropertyChange:!1}),this.lowerContext.filter=a,t.notify("draw",{prop:"currTransState",onPropertyChange:!1,value:{type:"reverse",isPreventDestination:!0,context:null,isPreventCircleCrop:null}}),e===""&&t.transform.currFlipState!==""&&(e=t.transform.currFlipState),t.transform.currFlipState=e,this.flipColl=i,t.objColl=y([],r,[],!0),this.lowerContext.filter="none",t.notify("shape",{prop:"iterateObjColl",onPropertyChange:!1}),this.lowerContext.filter=a,o.activePoint.width!==0&&(t.activeObj=y({},o,{},!0)),this.isReverseFlip=!1},l.prototype.rotateZoom=function(t){var e=this.parent,i=Math.pow(10,1),r=Math.round(e.transform.zoomFactor*i)/i;r===.1&&t===-.1||r===0&&t===-.025?e.transform.zoomFactor=0:e.transform.zoomFactor+=t,e.isCropTab?e.transform.cropZoomFactor=e.transform.zoomFactor:e.transform.defaultZoomFactor=e.transform.zoomFactor;var o=y([],e.objColl,[],!0),a=y({},e.activeObj,{},!0);e.objColl=[],e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),e.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"initial",isPreventDestination:null,isRotatePan:null}}),e.notify("draw",{prop:"setRotateZoom",onPropertyChange:!1,value:{isRotateZoom:!0}}),e.notify("draw",{prop:"setDestPoints",onPropertyChange:!1});var n=this.lowerContext.filter;e.notify("draw",{prop:"drawImage",onPropertyChange:!1}),this.lowerContext.filter=n,e.notify("draw",{prop:"setRotateZoom",onPropertyChange:!1,value:{isRotateZoom:!1}}),e.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"reverse",isPreventDestination:null,isRotatePan:null}}),e.objColl=o,e.activeObj=a;var s={width:this.cropDimension.width,height:this.cropDimension.height};s.width+=s.width*e.transform.zoomFactor,s.height+=s.height*e.transform.zoomFactor,e.notify("draw",{prop:"setZoomCropWidth",value:{width:s.width,height:s.height}})},l.prototype.autoEnablePan=function(){var t=this.parent;t.transform.zoomFactor<=0?(t.togglePan=!1,t.notify("selection",{prop:"setDragCanvas",value:{bool:!1}}),t.pan(!1),this.disablePan=!1):t.pan(!this.disablePan)},l.prototype.cropZoom=function(t,e){var i=this.parent,r=i.img.destLeft,o=i.img.destTop,a={width:0,height:0};return i.transform.degree%90===0&&i.transform.degree%180!==0?a=this.calcMaxDimension(i.img.srcHeight,i.img.srcWidth):a=this.calcMaxDimension(i.img.srcWidth,i.img.srcHeight),a.width+=a.width*i.transform.zoomFactor,a.height+=a.height*i.transform.zoomFactor,i.img.destLeft=r-(a.width-i.img.destWidth)/2,i.img.destTop=o-(a.height-i.img.destHeight)/2,r=i.img.destLeft,o=i.img.destTop,e&&i.transform.straighten===0&&(i.img.destLeft>e.activePoint.startX&&(i.img.destLeft=e.activePoint.startX,i.transform.degree===0&&(i.panPoint.totalPannedPoint.x-=r-i.img.destLeft)),i.img.destTop>e.activePoint.startY&&(i.img.destTop=e.activePoint.startY,i.transform.degree===0&&(i.panPoint.totalPannedPoint.y-=o-i.img.destTop)),i.img.destLeft+a.width<e.activePoint.endX&&(i.img.destLeft=e.activePoint.endX-a.width,i.transform.degree===0&&(i.panPoint.totalPannedPoint.x-=r-i.img.destLeft)),i.img.destTop+a.height<e.activePoint.endY&&(i.img.destTop=e.activePoint.endY-a.height,i.transform.degree===0&&(i.panPoint.totalPannedPoint.y-=o-i.img.destTop))),a},l.prototype.setZoomDimension=function(t,e){var i=this.parent,r=i.transform.degree,o={width:0,height:0};if(r%90===0&&r%180!==0?o=this.calcMaxDimension(i.img.srcHeight,i.img.srcWidth):o=this.calcMaxDimension(i.img.srcWidth,i.img.srcHeight),o.width+=o.width*i.transform.zoomFactor,o.height+=o.height*i.transform.zoomFactor,i.img.destLeft+=(i.img.destWidth-o.width)/2,i.img.destTop+=(i.img.destHeight-o.height)/2,t<0&&e){var a=e.activePoint.startX,n=e.activePoint.startY,s=e.activePoint.width,h=e.activePoint.height,p=i.img.destLeft+o.width,u=i.img.destTop+o.height;i.img.destLeft>a&&(i.img.destLeft=a),i.img.destTop>n&&(i.img.destTop=n),p<a+s&&(i.img.destLeft=a+s-o.width),u<n+h&&(i.img.destTop=n+h-o.height)}else t<0&&d(e)&&(i.img.destLeft>0&&(i.img.destLeft=0),i.img.destTop>0&&(i.img.destTop=0),i.img.destLeft+o.width<i.lowerCanvas.clientWidth&&(i.img.destLeft=i.lowerCanvas.clientWidth-i.img.destWidth),i.img.destTop+o.height<i.lowerCanvas.clientHeight&&(i.img.destTop=i.lowerCanvas.clientHeight-i.img.destHeight));return o},l.prototype.drawPannedImage=function(t,e){var i=this.parent,r={panDown:null};i.notify("selection",{prop:"getPanDown",onPropertyChange:!1,value:{obj:r}});var o={startPoint:r.panDown,endPoint:this.panMove,cancel:!1};i.trigger("panning",o),!o.cancel&&this.panEvent(t,e)},l.prototype.panEvent=function(t,e,i){var r=this.parent,o=!1;if(r.activeObj.shape&&r.activeObj.shape==="shape"&&r.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),d(r.activeObj.shape)){o=!0;var a=r.activeObj.activePoint={startX:r.img.destLeft,startY:r.img.destTop,endX:r.img.destLeft+r.img.destWidth,endY:r.img.destTop+r.img.destHeight},n=a.startX,s=a.startY,h=a.endX,p=a.endY;n<0&&(a.startX=0),s<0&&(a.startY=0),h>r.lowerCanvas.width&&(a.endX=r.lowerCanvas.width),p>r.lowerCanvas.height&&(a.endY=r.lowerCanvas.height),a.width=a.endX-a.startX,a.height=a.endY-a.startY,r.activeObj.shape="crop-custom";var u={strokeSettings:{}};r.notify("shape",{prop:"getStrokeSettings",onPropertyChange:!1,value:{obj:u}}),r.activeObj.strokeSettings=u.strokeSettings,r.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:a,obj:r.activeObj,isMouseMove:null,x:null,y:null}}),r.isCropTab=!0}if(r.transform.degree===0){var c=void 0;d(t)&&d(e)||i?i?c=this.updatePanPoints(t,e):c=this.updatePanPoints():c={x:t,y:e},r.panPoint.totalPannedPoint.x+=c.x,r.panPoint.totalPannedPoint.y+=c.y;var f=y({},r.activeObj,{},!0),g=this.lowerContext.filter;this.drawPannImage(c,o),this.lowerContext.filter=g,this.tempPanMove=y({},this.panMove,{},!0),r.activeObj=y({},f,{},!0),this.upperContext.clearRect(0,0,r.upperCanvas.width,r.upperCanvas.height),r.activeObj.shape&&r.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:r.activeObj}})}else{var v=r.transform.currFlipState;r.isCropTab=!0,d(t)&&d(e)||i?i?r.panPoint.currentPannedPoint=this.updatePanPoints(t,e):r.panPoint.currentPannedPoint=this.updatePanPoints():r.panPoint.currentPannedPoint={x:t,y:e},r.transform.currFlipState=v,this.rotatePan(null,null,o),r.isCropTab=!1,this.tempPanMove=y({},this.panMove,{},!0)}o&&(r.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),r.isCropTab=!1,this.upperContext.clearRect(0,0,r.upperCanvas.width,r.upperCanvas.height))},l.prototype.drawPannImage=function(t,e){var i=this.parent,r=this.lowerContext.filter,o={startX:i.img.destLeft,startY:i.img.destTop,width:i.img.destWidth,height:i.img.destHeight};this.lowerContext.clearRect(0,0,i.lowerCanvas.width,i.lowerCanvas.height),i.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"initial",isPreventDestination:null,isRotatePan:null}}),i.img.destLeft=o.startX,i.img.destTop=o.startY,i.img.destWidth=o.width,i.img.destHeight=o.height,this.setDestPointsForFlipState(),e&&(i.isCropTab=!1),i.notify("draw",{prop:"drawImage",onPropertyChange:!1}),e&&(i.isCropTab=!0),(i.currSelectionPoint&&i.currSelectionPoint.shape==="crop-circle"||i.isCircleCrop)&&i.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:!0}}),this.lowerContext.filter=r,i.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"reverse",isPreventDestination:null,isRotatePan:null}}),i.img.destLeft=o.startX,i.img.destTop=o.startY,i.img.destWidth=o.width,i.img.destHeight=o.height;var a=this.lowerContext.filter;this.lowerContext.filter="none",e&&(i.isCropTab=!1),i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"pan",pen:"pan",x:t.x,y:t.y,panRegion:""}}),e&&(i.isCropTab=!0),this.lowerContext.filter=a,i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),i.isCircleCrop&&i.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:!0}})},l.prototype.resetZoom=function(){var t=this.parent;if(t.transform.defaultZoomFactor!==0){var e=t.isUndoRedo,i={currObj:{}};t.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:i}}),this.transCurrObj=i.currObj,this.transCurrObj.objColl=y([],t.objColl,null,!0),this.transCurrObj.pointColl=y({},t.pointColl,null,!0),this.transCurrObj.afterCropActions=y([],t.afterCropActions,[],!0);var r={selPointColl:null};t.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:r}}),this.transCurrObj.selPointColl=y([],r.selPointColl,[],!0),t.isUndoRedo=t.isCropToolbar=!0;var o=t.transform.defaultZoomFactor;o>0?this.zoomAction(-o):this.zoomAction(Math.abs(o)),t.isCropToolbar=!1,t.isUndoRedo=e}},l.prototype.performTransformation=function(t){var e=this.parent;this.resetZoom(),this.updateTransform(t);for(var i=0,r=e.objColl.length;i<r;i++)if(e.objColl[i].flipObjColl.length>0){var o={collection:e.objColl[i].flipObjColl};e.notify("shape",{prop:"alignRotateFlipColl",onPropertyChange:!1,value:{collection:o.collection,isRotateFlipCollection:null,obj:o}}),e.objColl[i].flipObjColl=o.collection,e.objColl[i].flipObjColl.length===0&&(e.objColl[i].shapeFlip="")}},l.prototype.updateTransform=function(t){switch(t.toLowerCase()){case"rotateleft":this.rotateImage(-90);break;case"rotateright":this.rotateImage(90);break;case"horizontalflip":this.flipImage(Oo.Horizontal);break;case"verticalflip":this.flipImage(Oo.Vertical);break}},l.prototype.rotatePan=function(t,e,i){var r=this.parent;this.isReverseRotate=!0;var o=r.transform.degree,a,n={selPointColl:null};r.activeObj.activePoint&&r.activeObj.shape&&(a=y({},r.activeObj,{},!0));var s=y([],r.objColl,[],!0),h=y([],r.pointColl,[],!0);r.objColl=[],r.pointColl=[],r.freehandCounter=0,r.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:n}});var p=n.selPointColl;r.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:[]}}}),r.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),r.notify("draw",{prop:"setRotateZoom",onPropertyChange:!1,value:{isRotateZoom:!0}}),r.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"initial",isPreventDestination:null,isRotatePan:null}});var u=r.img.destLeft,c=r.img.destTop,f=r.panPoint.totalPannedInternalPoint;r.isCropTab&&(r.img.destLeft+=f.x,r.img.destTop+=f.y),r.notify("crop",{prop:"updateRotatePan",onPropertyChange:!1}),r.isCropTab&&(r.panPoint.totalPannedInternalPoint.x=r.img.destLeft-u,r.panPoint.totalPannedInternalPoint.y=r.img.destTop-c);var g=this.lowerContext.filter;i&&(r.isCropTab=!1),r.notify("draw",{prop:"drawImage",onPropertyChange:!1}),i&&(r.isCropTab=!0),r.notify("draw",{prop:"setRotateZoom",onPropertyChange:!1,value:{isRotateZoom:!1}}),r.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"reverse",isPreventDestination:!0,isRotatePan:!0}});var v=r.img.destLeft,m=r.img.destTop;r.img.destLeft+=r.panPoint.totalPannedClientPoint.x,r.img.destTop+=r.panPoint.totalPannedClientPoint.y,r.img.destLeft+=r.panPoint.currentPannedPoint.x,r.img.destTop+=r.panPoint.currentPannedPoint.y,r.panPoint.totalPannedClientPoint.x=r.img.destLeft-v,r.panPoint.totalPannedClientPoint.y=r.img.destTop-m,r.objColl=s,r.pointColl=h,r.freehandCounter=r.pointColl.length,r.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:p}}}),r.transform.degree=o,this.lowerContext.filter="none",t&&(e?(r.panPoint.totalPannedClientPoint.x=-r.panPoint.totalPannedClientPoint.x,r.panPoint.totalPannedClientPoint.y=-r.panPoint.totalPannedClientPoint.y,r.panPoint.currentPannedPoint=y({},r.panPoint.totalPannedClientPoint,{},!0),r.panPoint.totalPannedClientPoint={x:0,y:0},r.img.destLeft+=r.panPoint.currentPannedPoint.x,r.img.destTop+=r.panPoint.currentPannedPoint.y):r.panPoint.currentPannedPoint=y({},r.panPoint.totalPannedClientPoint,{},!0)),i&&(r.isCropTab=!1),r.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"pan",pen:"pan",x:r.panPoint.currentPannedPoint.x,y:r.panPoint.currentPannedPoint.y,panRegion:""}}),i&&(r.isCropTab=!0),this.lowerContext.filter=g,r.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),this.upperContext.clearRect(0,0,r.upperCanvas.width,r.upperCanvas.height),r.activeObj=y({},a,{},!0),r.activeObj.activePoint&&r.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:r.activeObj,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:null}}),this.isReverseRotate=!1},l.prototype.limitPan=function(){var t=this.parent,e=t.activeObj.activePoint,i=e.startX,r=e.startY,o=e.endX,a=e.endY,n=t.img;t.activeObj.activePoint&&(n.destLeft>i&&(t.img.destLeft=i),n.destTop>r&&(t.img.destTop=r),n.destLeft+n.destWidth<o&&(t.img.destLeft=o-n.destWidth),n.destTop+n.destHeight<a&&(t.img.destTop=a-n.destHeight))},l.prototype.pan=function(t,e,i){var r=this.parent;!r.disabled&&r.isImageLoaded&&(t?(r.togglePan=!0,r.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:null}}),r.notify("selection",{prop:"setDragCanvas",value:{bool:!0}}),r.lowerCanvas.style.cursor=r.upperCanvas.style.cursor=r.cursor="grab",r.notify("selection",{prop:"setPanDown",onPropertyChange:!1,value:{panDown:null}}),(e||i)&&(e=e||0,i=i||0,d(this.panMove)&&(this.panMove={x:e,y:i}),d(this.tempPanMove)&&(this.tempPanMove={x:this.panMove.x,y:this.panMove.y}),this.panEvent(e,i,!0),this.tempPanMove=null)):(r.togglePan=r.currObjType.isCustomCrop=!1,r.notify("selection",{prop:"setDragCanvas",value:{bool:!1}}),r.lowerCanvas.style.cursor=r.upperCanvas.style.cursor=r.cursor="default"))},l.prototype.zoom=function(t,e){var i=this.parent;if(!i.disabled&&i.isImageLoaded){var r=this.getCurrentZoomFactor(t);if(d(e))this.zoomAction(r,e);else for(var o=r>0?"zoomIn":"zoomOut",a=Math.abs(r)*10,n=0;n<a;n++)i.notify("draw",{prop:"performPointZoom",onPropertyChange:!1,value:{x:e.x,y:e.y,type:o,isResize:null}});var s={action:r>0?"zoom-in":"zoom-out",actionEventArgs:i.editCompleteArgs};i.triggerEditCompleteEvent(s)}},l.prototype.getCurrentZoomFactor=function(t){return t>=1?this.prevZoomValue<1?t-this.prevZoomValue:(t-this.prevZoomValue)*.1:t-this.prevZoomValue},l.prototype.setCurrPanRegion=function(t,e,i){var r=t;t===""?r=e==="horizontal"?"horizontal":e==="vertical"?"vertical":t:t==="horizontal"?r=e==="horizontal"?"horizontalVertical":e==="vertical"?"verticalHorizontal":e===90?"vertical":e===-90?"horizontal":t:t==="vertical"?r=e==="horizontal"?"horizontalVertical":e==="vertical"?"verticalHorizontal":e===90?"horizontal":e===-90?"vertical":t:r=e==="horizontal"?"vertical":e==="vertical"?"horizontal":t,i.panRegion=r},l.prototype.rotate=function(t,e){var i=this.parent,r=!1;!i.disabled&&i.isImageLoaded&&t%90===0&&this.rotateImage(t),e.isRotate=r},l.prototype.flip=function(t){var e=this.parent;!e.disabled&&e.isImageLoaded&&this.flipImage(t)},l.prototype.update=function(){var t=this.parent,e=0,i=!1,r={bool:!1},o={bool:t.isStraightening},a=0,n=t.element.querySelector("#"+t.element.id+"_contextualToolbar"),s=t.element.querySelector(".e-contextual-toolbar-wrapper"),h=t.element.querySelector("#"+t.element.id+"_headWrapper");if(t.isImageLoaded){var p=!1,u=void 0;S.isDevice&&(t.activeObj.shape&&(u=t.activeObj.shape.split("-")),(t.currObjType.isCustomCrop||u&&u[0]==="crop")&&(p=!0));var c={bool:null};t.notify("toolbar",{prop:"getFrameToolbar",onPropertyChange:!1,value:{obj:c}}),!o.bool&&(n&&!n.parentElement.classList.contains("e-hide")||h&&!h.parentElement.classList.contains("e-hide"))&&(s.classList.add("e-hide"),p||t.okBtn(null,!0),t.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1}),t.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1})),t.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:r}}),r.bool&&t.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1});var f=y({},t.activeObj.activePoint,{},!0);t.activeObj.shape&&(f.width!==0||f.height!==0)&&(i=!0,t.textArea.style.display==="block"||t.textArea.style.display==="inline-block"?(t.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:null}}),t.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1})):(t.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),t.objColl.push(t.activeObj)),t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}))}t.updateDropInfoContent(t.element.querySelector(".e-ie-drop-info"));var g=this.lowerContext.filter,v=t.element.querySelector("#"+t.element.id+"_canvasWrapper");if(v&&(v.style.width=t.element.offsetWidth-2+"px"),t.lowerCanvas.width=t.upperCanvas.width=t.maskCanvas.width=t.element.offsetWidth-2,t.toolbarTemplate)e=t.element.querySelector("#"+t.element.id+"_toolbarArea").clientHeight;else if(t.element.querySelector("#"+t.element.id+"_toolbar")&&(e=t.element.querySelector("#"+t.element.id+"_toolbar").clientHeight,e===0&&t.toolbar&&t.toolbar.length>0&&t.toolbar.indexOf("Open")===-1)){var m={toolbarHeight:0};t.notify("toolbar",{prop:"getToolbarHeight",value:{obj:m}}),e=m.toolbarHeight}var C=t.element.querySelector("#"+t.element.id+"_contextualToolbarArea");if(S.isDevice&&o.bool&&C&&(a=C.clientHeight),t.notify("toolbar",{prop:"setToolbarHeight",value:{height:e}}),S.isDevice?v&&(v.style.height=t.element.offsetHeight-(2*e+a)-4+"px"):v&&(v.style.height=t.element.offsetHeight-e-2+"px"),t.lowerCanvas.height=t.upperCanvas.height=parseFloat(v.style.height),this.lowerContext.filter="brightness(1) contrast(100%) hue-rotate(0deg) saturate(100%) opacity(1) blur(0px) sepia(0%) grayscale(0%) invert(0%)",t.notify("filter",{prop:"setAdjustmentValue",onPropertyChange:!1,value:{adjustmentValue:this.lowerContext.filter}}),t.canvasFilter=this.lowerContext.filter,t.initialAdjustmentValue=this.lowerContext.filter,t.clearContext(this.lowerContext),t.clearContext(this.upperContext),t.isImageLoaded){if(t.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:null}}),t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.lowerContext.filter=g,t.initialAdjustmentValue=g,t.canvasFilter=this.lowerContext.filter,t.isImageLoaded&&(Bt(t.element),t.element.style.opacity="0.5"),this.lowerContext.clearRect(0,0,t.lowerCanvas.width,t.lowerCanvas.height),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),v){v.style.width=t.element.offsetWidth-2+"px",v.style.height=t.element.offsetHeight+"px";var M={toolbarHeight:0};t.notify("toolbar",{prop:"getToolbarHeight",value:{obj:M}}),S.isDevice?v.style.height=parseFloat(v.style.height)-2*M.toolbarHeight-a-4+"px":v.style.height=parseFloat(v.style.height)-M.toolbarHeight-2+"px"}t.lowerCanvas.width=t.upperCanvas.width=t.maskCanvas.width=parseFloat(v.style.width),t.lowerCanvas.height=t.upperCanvas.height=t.maskCanvas.height=parseFloat(v.style.height),this.lowerContext.filter=g;var m={width:0,height:0};this.calcMaxDimension(t.img.srcWidth,t.img.srcHeight,m);var I=m;if(o.bool&&t.transform.cropZoomFactor!==0?(I.width+=I.width*t.transform.cropZoomFactor,I.height+=I.height*t.transform.cropZoomFactor):t.transform.defaultZoomFactor>0&&(I.width+=I.width*t.transform.defaultZoomFactor,I.height+=I.height*t.transform.defaultZoomFactor),t.img.destLeft=(t.lowerCanvas.clientWidth-I.width)/2,t.img.destTop=(t.lowerCanvas.clientHeight-I.height+1)/2,t.transform.degree===0&&t.transform.currFlipState==="")t.transform.defaultZoomFactor>0&&(t.img.destLeft+=t.panPoint.totalPannedPoint.x,t.img.destTop+=t.panPoint.totalPannedPoint.y),t.notify("draw",{prop:"draw-image-to-canvas",value:{dimension:I}});else{t.notify("draw",{prop:"draw-image-to-canvas",value:{dimension:I}}),t.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"initial",isPreventDestination:null,isRotatePan:null}});var N=this.lowerContext.filter;t.notify("draw",{prop:"drawImage",onPropertyChange:!1}),this.lowerContext.filter=N,t.notify("draw",{prop:"updateCurrTransState",onPropertyChange:!1,value:{type:"reverse",isPreventDestination:null,isRotatePan:null}})}t.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),t.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),t.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}}),t.isCircleCrop&&t.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),gt(t.element),t.element.style.opacity="1";var O={defToolbarItems:null};if(t.notify("toolbar",{prop:"getDefToolbarItems",value:{obj:O}}),O.defToolbarItems&&O.defToolbarItems.length>0&&document.getElementById(t.element.id+"_toolbar")){var x=Q(t.element.id+"_toolbar","toolbar");x&&x.refreshOverflow(),s&&!o.bool&&s.classList.add("e-hide")}if(t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),i){var D=y({},t.objColl[t.objColl.length-1],null,!0);t.objColl.pop(),D.activePoint.width!==0&&D.activePoint.height!==0&&(this.lowerContext.clearRect(0,0,t.lowerCanvas.width,t.lowerCanvas.height),t.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),t.objColl.push(D),t.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),D=y({},t.objColl[t.objColl.length-1],null,!0),t.objColl.pop(),this.lowerContext.clearRect(0,0,t.lowerCanvas.width,t.lowerCanvas.height),t.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),t.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:D}}),o.bool&&t.notify("draw",{prop:"setStraightenActObj",value:{activeObj:D}}),(t.activeObj.shape==="rectangle"||t.activeObj.shape==="ellipse"||t.activeObj.shape==="text"||t.activeObj.shape==="line"||t.activeObj.shape==="arrow"||t.activeObj.shape==="path"||t.activeObj.shape==="image")&&t.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}}))}if(r.bool&&t.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:!0}}),t.isResize&&(t.aspectWidth=Math.ceil(t.img.destWidth),t.aspectHeight=Math.ceil(t.img.destHeight),t.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"resize",isApplyBtn:!1,isCropping:!1}}),t.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"resize",isApplyBtn:!1,isCropping:!1}})),(t.transform.degree!==0||t.transform.currFlipState!=="")&&t.transform.defaultZoomFactor>0){var A=y({},t.panPoint.totalPannedPoint,null,!0),P=y({},t.panPoint.totalPannedInternalPoint,null,!0),V=y({},t.panPoint.totalPannedClientPoint,null,!0);this.zoomAction(.1),this.zoomAction(-.1),t.transform.degree===0?(t.img.destLeft+=A.x,t.img.destTop+=A.y,t.panPoint.totalPannedPoint=A,t.notify("draw",{prop:"updateFlipPan",value:{tempSelectionObj:null}})):(t.panPoint.totalPannedInternalPoint=P,t.panPoint.totalPannedClientPoint=V,t.panPoint.currentPannedPoint={x:0,y:0},t.isCropTab=!0,this.rotatePan(),t.isCropTab=!1)}else t.transform.degree!==0&&t.transform.cropZoomFactor>0&&(t.transform.zoomFactor=0,t.transform.cropZoomFactor=null,t.notify("toolbar",{prop:"enable-disable-btns",onPropertyChange:!1}))}},l.prototype.calcMaxDimension=function(t,e,i,r){var o={toolbarHeight:0},a=this.parent;a.notify("toolbar",{prop:"getToolbarHeight",value:{obj:o}});var n=r?a.element.clientWidth/3:a.element.clientWidth,s=r?(a.element.clientHeight-o.toolbarHeight)/3:a.element.clientHeight-o.toolbarHeight;if(s=S.isDevice?s-o.toolbarHeight:s,S.isDevice&&a.isStraightening){var h=a.element.querySelector("#"+a.element.id+"_contextualToolbarArea");s-=h?h.clientHeight:0}!r&&a.element.clientHeight===0&&(s=0),d(r)&&(n>30&&(n-=30),s>30&&(s-=30));var p=n/t,u=s/e,c=Math.min(t,n),f=Math.min(e,s);if(p<1&&p<u?(c=t*p,f=e*p):u<1&&u<p&&(c=t*u,f=e*u),d(r)){var g={bool:null};a.notify("crop",{prop:"getPreventScaling",onPropertyChange:!1,value:{obj:g}}),g.bool&&a.cropObj.activeObj.activePoint&&a.cropObj.activeObj.activePoint.width!==0&&a.cropObj.activeObj.activePoint.height!==0&&(c=a.cropObj.activeObj.activePoint.width,f=a.cropObj.activeObj.activePoint.height)}return i&&(i.width=c,i.height=f),{width:c,height:f}},l.prototype.updatePanPoints=function(t,e){var i=this.parent,r=y({},i.activeObj,{},!0),o=i.img.destLeft,a=i.img.destTop;d(this.tempPanMove)&&(this.tempPanMove={x:this.panMove.x,y:this.panMove.y});var n=this.panMove.x-this.tempPanMove.x,s=this.panMove.y-this.tempPanMove.y;(t||e)&&(n=t,s=e),i.img.destLeft+=n,i.img.destTop+=s,this.limitPan();var h={bool:null},p={isIntersect:null};i.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),i.notify("draw",{prop:"isLinesIntersect",onPropertyChange:!1,value:{obj:p}}),i.notify("draw",{prop:"isSelOutsideImg",onPropertyChange:!1,value:{obj:h}});for(var u=0;i.transform.straighten!==0&&(p.isIntersect||h.bool)&&(u++,i.img.destLeft=o,i.img.destTop=a,n!==0&&n>0?n-=1:n!==0&&n<0&&(n+=1),s!==0&&s>0?s-=1:s!==0&&s<0&&(s+=1),!(n===0&&s===0||u===200));)i.img.destLeft+=n,i.img.destTop+=s,this.limitPan(),i.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),i.notify("draw",{prop:"isLinesIntersect",onPropertyChange:!1,value:{obj:p}}),i.notify("draw",{prop:"isSelOutsideImg",onPropertyChange:!1,value:{obj:h}});return i.activeObj=r,{x:i.img.destLeft-o,y:i.img.destTop-a}},l.prototype.resizeImage=function(t,e){var i=this.parent,r=!0,o=!0;i.allowDownScale=!1,i.img.srcLeft=0,i.img.srcTop=0,i.isAspectRatio=!0;var a=[];for(i.img.srcWidth=i.baseImgCanvas.width,i.img.srcHeight=i.baseImgCanvas.height,i.resizeSrc&&i.resizeSrc.width!==0&&i.resizeSrc.height!==0&&(i.img.srcLeft=i.resizeSrc.startX,i.img.srcTop=i.resizeSrc.startY,i.img.srcWidth=i.resizeSrc.width,i.img.srcHeight=i.resizeSrc.height);(t<i.img.destWidth||e<i.img.destHeight)&&o;)if(this.zoomAction(-.1,null,!0,!0),t>i.img.destWidth||e>i.img.destHeight)for(;t>i.img.destWidth||e>i.img.destHeight;)this.zoomAction(.0125,null,!0,!0),o=!1,a.push(i.img.destWidth);for(;(t>i.img.destWidth||e>i.img.destHeight)&&o&&r;)if(this.zoomAction(.1,null,!0,!0),t<i.img.destWidth||e<i.img.destHeight)for(;t<i.img.destWidth;)this.zoomAction(-.0125,null,!0,!0),r=!1,a.push(i.img.destWidth);for(var n=a[0],s=Math.abs(i.img.destWidth-n),h=0,p=a;h<p.length;h++){var u=p[h],c=Math.abs(t-u);c<s&&(n=u,s=c)}n<t&&r&&(this.zoomAction(-.0125,null,!0,!0),r=!1),n>t&&!r&&(this.zoomAction(.0125,null,!0,!0),r=!1),this.zoomAction(.0125,null,!0),i.allowDownScale=!0,this.zoomAction(-.0125,null,!0);var f=y({},i.cropObj,{},!0),g=y({},this.prevResizeCurrObj,{},!0);i.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"resize",previousObj:g,previousObjColl:g.objColl,previousPointColl:g.pointColl,previousSelPointColl:g.selPointColl,previousCropObj:f,previousText:null,currentText:null,previousFilter:null,isCircleCrop:i.isCircleCrop}}),i.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}})},l.prototype.resizeCrop=function(t,e){var i=this.parent,r=!0,o={prevObj:i.prevObj};i.cropObj=y({},i.prevCropObj,{},!0),i.allowDownScale=!1,i.notify("toolbar",{prop:"getPrevObj",onPropertyChange:!1,value:{obj:o}});var a=y({},o.prevObj.activeObj,{},!0);o.prevObj.activeObj=y({},i.activeObj,{},!0),i.notify("draw",{prop:"setCurrentObj",onPropertyChange:!1,value:{obj:o.prevObj}}),i.objColl=y([],o.prevObj.objColl,[],!0),i.pointColl=y([],o.prevObj.pointColl,[],!0),i.transform.straighten=0,i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),i.transform.straighten===0&&!this.isPreventSelect&&i.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1});var n=t,s=e,h=!1;if(e>=t&&e<=Math.ceil(i.img.destHeight)){for(;e<=Math.ceil(i.img.destHeight)&&r;)if(this.zoomAction(-.1,null,!0,!0),t>i.img.destWidth||e>i.img.destHeight)for(;t>i.img.destWidth||e>i.img.destHeight;)this.zoomAction(.0125,null,!0,!0),r=!1}else if(e<=t&&t<i.img.destWidth){for(;t<i.img.destWidth&&r;)if(this.zoomAction(-.1,null,!0,!0),t>i.img.destWidth||e>i.img.destHeight)for(;t>i.img.destWidth||e>i.img.destHeight;)this.zoomAction(.0125,null,!0,!0),r=!1}else if(e>=t&&e>=i.img.destHeight)for(;e>=i.img.destHeight&&r;)this.zoomAction(.1,null,!0,!0);else if(t>=e&&t>=i.img.destWidth){for(;t>=i.img.destWidth&&r;)this.zoomAction(.1,null,!0,!0);if(t<i.img.destWidth&&e<i.img.destHeight){for(;t<i.img.destWidth&&e<i.img.destHeight;)this.zoomAction(-.0125,null,!0,!0),r=!1;this.zoomAction(.0125,null,!0,!0)}}else if(e>i.img.destHeight&&t>i.img.destWidth){for(;e>i.img.destHeight&&t>i.img.destWidth&&r;)this.zoomAction(.1,null,!0,!0);if(t<i.img.destWidth&&e<i.img.destHeight){for(;t<i.img.destWidth&&e<i.img.destHeight;)this.zoomAction(-.0125,null,!0,!0),r=!1;this.zoomAction(.0125,null,!0,!0)}}if(this.resizeImg(a,t,e),t=n,e=s,e!==i.img.destHeight||t!==i.img.destWidth){for(;e>i.img.destHeight||t>i.img.destWidth;)this.zoomAction(.0125,null,!0,!0),h=!0;h&&(this.zoomAction(-.0125,null,!0,!0),h=!1)}if(e!==i.img.destHeight||t!==i.img.destWidth){for(;e<i.img.destHeight||t<i.img.destWidth;)this.zoomAction(-.0125,null,!0,!0),h=!0;h&&(this.zoomAction(-.0125,null,!0,!0),h=!1)}o.prevObj.activeObj=y({},a,{},!0),this.zoomAction(.0125,null,!0),i.allowDownScale=!this.preventDownScale,i.isCropTab=!1,this.zoomAction(-.0125,null,!0),i.aspectWidth=t,i.aspectHeight=e},l.prototype.resizeImg=function(t,e,i){var r=this.parent,o=e/r.img.destWidth,a=i/r.img.destHeight;t.shape?(r.currSelectionPoint=t,r.notify("crop",{prop:"setInitCrop",onPropertyChange:!1,value:{bool:!0}})):r.img.srcWidth===r.baseImgCanvas.width&&r.img.srcHeight===r.baseImgCanvas.height&&(r.currSelectionPoint=null,r.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:"custom",startX:null,startY:null,width:null,height:null}})),d(r.currSelectionPoint)?r.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:"custom",startX:r.img.destLeft,startY:r.img.destTop,width:r.img.destWidth,height:r.img.destHeight}}):r.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:"custom",startX:null,startY:null,width:null,height:null}}),e=r.activeObj.activePoint.width*o,i=r.activeObj.activePoint.height*a;for(var n=r.activeObj.activePoint.startX+r.activeObj.activePoint.width/2-e/2,s=r.activeObj.activePoint.startY+r.activeObj.activePoint.height/2-i/2,h=0;S.isDevice&&h<500&&(n<0||s<0||n+e>r.img.destWidth||s+i>r.img.destHeight);)h++,e-=1,i-=1,n=r.activeObj.activePoint.startX+r.activeObj.activePoint.width/2-e/2,s=r.activeObj.activePoint.startY+r.activeObj.activePoint.height/2-i/2;if(r.transform.defaultZoomFactor=0,r.notify("draw",{prop:"setResizeSelect",value:{bool:!0}}),r.notify("draw",{prop:"setIsCropSelect",value:{bool:!0}}),r.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:"custom",startX:n,startY:s,width:e,height:i}}),r.notify("draw",{prop:"setResizeSelect",value:{bool:!1}}),r.transform.straighten!==0){var p={isIntersect:null,arr:null};for(r.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),r.notify("draw",{prop:"isLinesIntersect",onPropertyChange:!1,value:{obj:p}});p.arr[0]||p.arr[1]||p.arr[2]||p.arr[3];)this.zoomAction(.0125,null,!0),r.notify("draw",{prop:"updateImgCanvasPoints",onPropertyChange:!1}),r.notify("draw",{prop:"isLinesIntersect",onPropertyChange:!1,value:{obj:p}})}r.isCropToolbar=!0,r.crop(),r.isCropToolbar=!1},l.prototype.updateResize=function(){var t=this.parent;t.prevCropObj=y({},t.cropObj,{},!0);var e={currObj:{}};t.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:e}}),t.prevObj=e.currObj,t.currSelectionPoint&&t.prevCropObj.activeObj.shape&&(t.prevObj.activeObj=y({},t.prevCropObj.activeObj,{},!0)),t.prevObj.objColl=y([],t.objColl,[],!0),t.prevObj.pointColl=y([],t.pointColl,[],!0),t.prevObj.afterCropActions=y([],t.afterCropActions,[],!0);var i={selPointColl:null};t.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:i}}),t.prevObj.selPointColl=y([],i.selPointColl,[],!0),t.resizeSrc={startX:t.img.srcLeft,startY:t.img.srcTop,width:t.img.srcWidth,height:t.img.srcHeight}},l.prototype.resize=function(t,e,i){var r=this.parent,o;r.isResize=!0,d(r.prevCropObj)&&d(r.prevObj)&&r.notify("transform",{prop:"updateResize",value:{bool:!1}});var a=r.element.querySelector("#"+r.element.id+"_aspectratio"),n=r.element.querySelector("#"+r.element.id+"_nonaspectratio");a&&n&&(r.notify("toolbar",{prop:"initResizeToolbar"}),S.isDevice&&r.notify("toolbar",{prop:"init-main-toolbar",value:{isApplyBtn:!1,isDevice:!0,isOkBtn:!0,isResize:!0}}));var s=r.element.querySelector("#"+r.element.id+"_resizeHeight");s?o=s.value===""?s.placeholder:s.value:o=e+"px";var h={cancel:!1,previousWidth:Math.ceil(r.img.destWidth),previousHeight:Math.ceil(r.img.destHeight),width:Math.ceil(t),height:Math.ceil(e&&e!==0?e:i?parseFloat(o):r.img.destHeight),isAspectRatio:i||!1};r.trigger("resizing",h),r.editCompleteArgs=h,h.cancel?r.aspectHeight&&r.aspectWidth&&(r.aspectHeight=h.previousHeight,r.aspectWidth=h.previousWidth):this.resizeEventHandler(h)},l.prototype.resizeEventHandler=function(t){var e=this.parent,i,r=e.element.querySelector("#"+e.element.id+"_resizeWidth"),o=e.element.querySelector("#"+e.element.id+"_resizeHeight");if(t.isAspectRatio)if((this.resizedImgAngle==null||this.resizedImgAngle!==e.transform.degree)&&(this.resizedImgAngle=e.transform.degree,i=!0),i){e.notify("transform",{prop:"resizeImage",value:{width:t.width,height:0}});var a=e.img.destWidth,n=e.img.destHeight,s=void 0;if(o){s=parseFloat(r.value===""?r.placeholder:r.value);var h=s/(a/n),p=h%1>=.5||h%1<=-.5?Math.round(h):h<0?Math.ceil(h):Math.floor(h);if(Q(o,"numerictextbox").value=p,o.value=p.toString()+" px",e.aspectHeight=p,r&&r.value===""){var u=parseFloat(o.value===""?o.placeholder:o.value);h=u/(n/a);var c=h%1>=.5||h%1<=-.5?Math.round(h):h<0?Math.ceil(h):Math.floor(h);Q(r,"numerictextbox").value=c,r.value=c.toString()+" px",e.aspectWidth=c}}}else e.notify("transform",{prop:"resizeImage",value:{width:t.width,height:null}});else this.resizedImgAngle!==null&&this.resizedImgAngle!==e.transform.degree&&(this.resizedImgAngle=e.transform.degree,i=!0),i?(e.notify("transform",{prop:"setPreventDownScale",value:{bool:!0}}),e.notify("transform",{prop:"resizeCrop",value:{width:t.width,height:t.height}}),e.notify("undo-redo",{prop:"setPreventUR",value:{bool:!0}}),e.okBtn(null,!0),e.notify("undo-redo",{prop:"setPreventUR",value:{bool:!1}}),e.resizeSrc={startX:e.img.srcLeft,startY:e.img.srcTop,width:e.img.srcWidth,height:e.img.srcHeight},e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"resize",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),e.notify("transform",{prop:"setPreventDownScale",value:{bool:!1}}),e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"resize",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}})):e.notify("transform",{prop:"resizeCrop",value:{width:t.width,height:t.height}});this.resizedImgAngle=e.transform.degree},l.prototype.straightenImage=function(t){var e=this.parent,i=e.activeObj.shape&&e.activeObj.shape.indexOf("crop-")>-1;e.toolbar&&e.toolbar.length===0&&e.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:"custom",startX:null,startY:null,width:null,height:null}}),e.notify("toolbar",{prop:"performCropTransformClick",value:{shape:null}}),e.setStraighten(t),i||e.okBtn()},l}(),vv=function(){function l(t){this.undoRedoStep=0,this.undoRedoColl=[],this.appliedUndoRedoColl=[],this.tempUndoRedoColl=[],this.tempUndoRedoStep=0,this.isPreventing=!1,this.parent=t,this.addEventListener()}return l.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},l.prototype.addEventListener=function(){this.parent.on("undo-redo",this.undoRedo,this),this.parent.on("destroyed",this.destroy,this)},l.prototype.removeEventListener=function(){this.parent.off("undo-redo",this.undoRedo),this.parent.off("destroyed",this.destroy)},l.prototype.initializeUrPvtProp=function(){this.parent.lowerCanvas&&(this.lowerContext=this.parent.lowerCanvas.getContext("2d")),this.parent.upperCanvas&&(this.upperContext=this.parent.upperCanvas.getContext("2d"))},l.prototype.undoRedo=function(t){switch(this.initializeUrPvtProp(),t.prop){case"updateUndoRedoColl":this.updateUrc(t.value.operation,t.value.previousObj,t.value.previousObjColl,t.value.previousPointColl,t.value.previousSelPointColl,t.value.previousCropObj,t.value.previousText,t.value.currentText,t.value.previousFilter,t.value.isCircleCrop);break;case"refreshUrc":this.refreshUrc(t.value.bool);break;case"updateCurrUrc":this.updateCurrUrc(t.value.type,t.value.isCancel);break;case"call-undo":this.callUndo();break;case"call-redo":this.callRedo();break;case"undo":this.undo();break;case"redo":this.redo();break;case"updateUrObj":this.updateUrObj(t.value.objColl,t.value.operation);break;case"updateUndoRedo":this.updateUndoRedo(t.value?t.value.operation:null);break;case"getAppliedUndoRedoColl":t.value.obj.appliedUndoRedoColl=this.appliedUndoRedoColl;break;case"getUndoRedoStep":t.value.obj.undoRedoStep=this.undoRedoStep;break;case"setUndoRedoStep":this.undoRedoStep=t.value.step;break;case"undoDefault":this.undoDefault(t.value.obj);break;case"setPreventUR":this.isPreventing=t.value.bool;break;case"updateUndoRedoStack":t.value&&t.value.isPenDraw?this.updateUndoRedoStack(t.value.isPenDraw):this.updateUndoRedoStack();break;case"reset":this.reset();break}},l.prototype.getModuleName=function(){return"undo-redo"},l.prototype.reset=function(){this.tempCurrSelPoint=null,this.undoRedoStep=0,this.undoRedoColl=[],this.appliedUndoRedoColl=[],this.tempActObj=null,this.tempUndoRedoColl=[],this.tempUndoRedoStep=0,this.isPreventing=!1},l.prototype.refreshUrc=function(t){var e=this.parent;e.isImageUpdated||(t=t||!1,t&&(e.notify("toolbar",{prop:"setEnableDisableUndoRedo",value:{isPrevent:!0}}),this.tempUndoRedoColl=y([],this.appliedUndoRedoColl,[],!0),this.tempUndoRedoStep=this.undoRedoStep),e.notify("toolbar",{prop:"setEnableDisableUndoRedo",value:{isPrevent:!1}}),this.undoRedoColl=this.undoRedoColl.slice(0,this.undoRedoStep),this.appliedUndoRedoColl=this.appliedUndoRedoColl.slice(0,this.undoRedoStep),e.isUndoRedo=e.currObjType.isUndoAction=!1,e.notify("toolbar",{prop:"enable-disable-btns"}))},l.prototype.updateCurrUrc=function(t,e){var i=this.parent;if(!(i.isResize||this.isPreventing||i.noPushUndo)){if(i.notify("toolbar",{prop:"setEnableDisableUndoRedo",value:{isPrevent:!1}}),t==="ok"){i.notify("draw",{prop:"setShapeTextInsert",onPropertyChange:!1,value:{bool:!1}});var r=this.tempUndoRedoColl.length>0?y([],this.tempUndoRedoColl,[],!0):y([],this.undoRedoColl,[],!0),o=this.undoRedoColl[this.undoRedoColl.length-1],a=this.appliedUndoRedoColl[this.appliedUndoRedoColl.length-1],n=o?y({},o.previousObj,{},!0):null;if(d(a)?this.undoRedoColl[0]&&(o.previousCropObj=r[0].previousCropObj,o.previousObj=r[0].previousObj,o.previousObjColl=r[0].previousObjColl,o.previousPointColl=r[0].previousPointColl,o.previousText=r[0].previousText):o.operation!=="imageHFlip"&&o.operation!=="imageVFlip"&&(o.previousCropObj=a.currentCropObj,o.previousObj=a.currentObj,o.previousObjColl=a.currentObjColl,o.previousPointColl=a.currentPointColl,o.previousText=a.currentText,o.operation==="frame"&&o.previousObj&&n&&(o.previousObj.defaultZoom=n.defaultZoom,o.previousObj.zoomFactor=n.zoomFactor,o.previousObj.cropZoom=n.cropZoom)),o){if(o.operation!=="imageHFlip"&&o.operation!=="imageVFlip"){var s=this.getZeroZoomObjPointValue(o.currentObjColl,o.currentPointColl);o.currentObjColl=s.obj,o.currentPointColl=s.point;var h={adjustmentLevel:null};i.notify("filter",{prop:"getAdjustmentLevel",onPropertyChange:!1,value:{obj:h}}),o.currentObj.adjustmentLevel=y({},h.adjustmentLevel,{},!0),i.notify("filter",{prop:"setTempAdjVal"}),o.currentObj.currentFilter=i.currentFilter}this.appliedUndoRedoColl.push(o),e||this.triggerActionCompletedEvent(o.operation)}this.tempUndoRedoColl=[],this.tempUndoRedoStep=0}else this.tempUndoRedoColl.length>0&&(this.appliedUndoRedoColl=y([],this.tempUndoRedoColl,[],!0),this.undoRedoStep=this.tempUndoRedoStep,this.tempUndoRedoColl=[],this.tempUndoRedoStep=0);var p=this.appliedUndoRedoColl[this.appliedUndoRedoColl.length-1],u=this.appliedUndoRedoColl[this.appliedUndoRedoColl.length-2];if(this.appliedUndoRedoColl.length>16)this.appliedUndoRedoColl.splice(0,1);else if(!e&&p&&u){if((p.operation==="shapeTransform"&&u.operation==="shapeTransform"||p.operation==="shapeInsert"&&u.operation==="shapeInsert")&&JSON.stringify(p.currentObjColl)===JSON.stringify(u.currentObjColl)||p.operation==="freehand-draw"&&u.operation==="freehand-draw"&&JSON.stringify(p.currentPointColl)===JSON.stringify(u.currentPointColl)||p.operation==="freehanddrawCustomized"&&u.operation==="freehanddrawCustomized"&&JSON.stringify(p.currentPointColl)===JSON.stringify(u.currentPointColl))this.appliedUndoRedoColl.splice(this.appliedUndoRedoColl.length-1,1);else if(this.undoRedoStep!==this.appliedUndoRedoColl.length-1&&(p=this.appliedUndoRedoColl[this.appliedUndoRedoColl.length-1],u=this.appliedUndoRedoColl[this.undoRedoStep],p&&u&&p.operation==="shapeTransform"&&u.operation==="shapeTransform"&&JSON.stringify(p.currentObjColl)===JSON.stringify(u.previousObjColl))){this.appliedUndoRedoColl.splice(this.appliedUndoRedoColl.length-1,1),this.undoRedoColl=[],this.undoRedoColl=y([],this.appliedUndoRedoColl,[],!0);return}}this.undoRedoColl=[],this.undoRedoColl=y([],this.appliedUndoRedoColl,[],!0),t==="ok"&&(this.undoRedoStep=this.undoRedoColl.length,i.notify("toolbar",{prop:"enable-disable-btns"})),i.transform.zoomFactor>0&&(i.togglePan=!0,i.notify("selection",{prop:"setDragCanvas",value:{bool:!0}}))}},l.prototype.triggerActionCompletedEvent=function(t){var e=this.parent,i={brightness:"fine-tune",contrast:"fine-tune",hue:"fine-tune",saturation:"fine-tune",opacity:"fine-tune",blur:"fine-tune",exposure:"fine-tune",default:"filter",chrome:"filter",cold:"filter",warm:"filter",grayscale:"filter",sepia:"filter",invert:"filter",deleteObj:"shape-delete",deleteFreehandDrawing:"freehand-draw-delete",shapeInsert:"shape-insert",shapeTransform:"shape-customize",freehanddrawCustomized:"freehand-draw-customize"},r=i[t]||t,o={action:r,actionEventArgs:e.editCompleteArgs};e.triggerEditCompleteEvent(o)},l.prototype.getUndoRedoAction=function(t){var e={brightness:"fine-tune",contrast:"fine-tune",hue:"fine-tune",saturation:"fine-tune",opacity:"fine-tune",blur:"fine-tune",exposure:"fine-tune",default:"filter",chrome:"filter",cold:"filter",warm:"filter",grayscale:"filter",sepia:"filter",invert:"filter",deleteObj:"shape-delete",deleteFreehandDrawing:"freehand-drawing-delete",shapeInsert:"shape-insert",shapeTransform:"shape-customize",imageRotate:"shape-customize",freehanddraw:"freehand-draw",freehanddrawCustomized:"freehand-draw-customize",textAreaCustomization:"text-area-customization",imageHFlip:"shape-customize",imageVFlip:"shape-customize",bgColor:"background-color",updateImage:"image-update"};return e[t]||t},l.prototype.cancelCropSelection=function(){var t=this.parent,e=!1,i;t.activeObj.shape&&(i=t.activeObj.shape.split("-")),(t.currObjType.isCustomCrop||i&&i[0]==="crop")&&(e=!0),e&&t.notify("draw",{prop:"performCancel",value:{isContextualToolbar:null}}),(this.tempUndoRedoColl.length!==0||this.tempUndoRedoStep!==0)&&(this.appliedUndoRedoColl=y([],this.tempUndoRedoColl,[],!0),this.undoRedoColl=y([],this.tempUndoRedoColl,[],!0),this.undoRedoStep=this.tempUndoRedoStep,this.tempUndoRedoColl=[],this.tempUndoRedoStep=0,t.notify("toolbar",{prop:"setEnableDisableUndoRedo",value:{isPrevent:!1}}))},l.prototype.refreshToolbarActions=function(){var t=this.parent;t.activeObj.shape?(t.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"shapes",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),t.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1})):t.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1})},l.prototype.applyCurrentChanges=function(){var t=this.parent;t.currObjType.isFiltered=!1,t.transform.zoomFactor===0&&(t.togglePan=!1,t.notify("selection",{prop:"setDragCanvas",value:{bool:!1}})),t.element.querySelector(".e-contextual-toolbar-wrapper")&&t.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide"),t.togglePen&&(t.togglePen=!1,t.upperCanvas.style.cursor=t.cursor="default",this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height)),this.appliedUndoRedoColl.length>0&&(this.undoRedoColl=y([],this.appliedUndoRedoColl,[],!0))},l.prototype.callUndo=function(){this.applyCurrentChanges(),this.undo()},l.prototype.callRedo=function(){this.applyCurrentChanges(),this.redo()},l.prototype.undo=function(){var t=this.parent;if(this.cancelCropSelection(),t.notify("draw",{prop:"resetFrameZoom",onPropertyChange:!1,value:{isOk:!1}}),!t.disabled&&t.isImageLoaded&&this.undoRedoStep>0){this.refreshToolbarActions(),t.activeObj.activePoint&&t.activeObj.activePoint.width!==0&&(this.tempActObj=t.activeObj),t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.undoRedoStep--,t.notify("toolbar",{prop:"enable-disable-btns"}),t.element.querySelector(".e-contextual-toolbar-wrapper")&&t.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide"),t.isUndoRedo=!0;var e=this.undoRedoColl[this.undoRedoStep];this.undoRedoColl.length===this.undoRedoStep?t.currObjType.isUndoAction=!1:t.currObjType.isUndoAction=!0,e.operation!=="textAreaCustomization"&&(t.textArea.style.display==="block"||t.textArea.style.display==="inline-block")&&(t.textArea.style.display="none"),t.notify("draw",{prop:"setCancelAction",onPropertyChange:!1,value:{bool:!0}});var i=void 0;t.cropObj=y({},e.previousCropObj,{},!0),t.afterCropActions=e.previousObj.afterCropActions,this.lowerContext.filter=e.previousObj.filter,t.notify("filter",{prop:"setAdjustmentLevel",onPropertyChange:!1,value:{adjustmentLevel:e.previousObj.adjustmentLevel}}),t.notify("filter",{prop:"setTempAdjVal"}),t.currentFilter=e.previousObj.currentFilter,t.notify("filter",{prop:"setTempFilVal"}),t.canvasFilter=this.lowerContext.filter,t.initialAdjustmentValue=this.lowerContext.filter,t.notify("filter",{prop:"setBevelFilter",onPropertyChange:!1,value:{bevelFilter:this.lowerContext.filter}});var r={action:this.getUndoRedoAction(e.operation)};switch(e.operation){case"shapeTransform":case"brightness":case"contrast":case"hue":case"saturation":case"opacity":case"blur":case"exposure":case"default":case"chrome":case"cold":case"warm":case"grayscale":case"blackandwhite":case"sepia":case"invert":case"sharpen":case"imageRotate":case"shapeInsert":this.shapeTransform(e.previousObjColl,e.previousPointColl);break;case"freehanddraw":case"freehand-draw":this.updateFreehandDraw(e.previousPointColl,e.previousSelPointColl),t.notify("freehand-draw",{prop:"setCurrentFreehandDrawIndex",value:{value:t.pointColl.length}});break;case"freehanddrawCustomized":this.updateFreehandDrawCustomized(e.previousObjColl,e.previousPointColl);break;case"deleteFreehandDrawing":case"deleteObj":this.updateDelete(e.operation,e.previousObjColl,e.previousPointColl,e.previousSelPointColl);break;case"textAreaCustomization":this.shapeTransform(e.previousObjColl,e.previousPointColl),this.updateTextAreaCustomization(i,e.previousObjColl);break;case"text":this.updateText(e.previousObjColl,!0);break;case"frame":t.transform.zoomFactor=t.transform.defaultZoomFactor=e.previousObj.defaultZoom,t.setProperties({zoomSettings:{zoomFactor:e.previousObj.zoomFactor}},!0),t.notify("transform",{prop:"setPreviousZoomValue",onPropertyChange:!1,value:{previousZoomValue:t.zoomSettings.zoomFactor}}),y(t.frameObj,e.previousObj.frameObj),t.notify("draw",{prop:"render-image",value:{isMouseWheel:!0,isPreventClearRect:null,isFrame:!0}});break;case"imageHFlip":this.imageFlip("horizontal",e.previousObjColl);break;case"imageVFlip":this.imageFlip("vertical",e.previousObjColl);break;case"bgColor":t.notify("draw",{prop:"imageBackgroundColor",onPropertyChange:!1,value:{color:e.previousObj.bgColor}}),t.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}});break;case"updateImage":t.isImageUpdated=!0,t.baseImg.src=e.previousObj.imageSource,setTimeout(function(){t.cropObj.straighten!==0?(t.notify("toolbar",{prop:"performCropTransformClick",value:{shape:"crop-custom"}}),t.noPushUndo=!0,t.crop(),t.noPushUndo=!1):t.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),t.isImageUpdated=!1});break;default:this.undoDefault(e,!0),t.notify("filter",{prop:"set-adjustment",value:{operation:e.operation}}),t.notify("filter",{prop:"update-filter",value:{operation:e.operation,filter:e.filter}});break}if(e.operation==="crop"){e.previousObj.currSelectionPoint&&(t.currSelectionPoint=y({},e.previousObj.currSelectionPoint,{},!0),t.currSelectionPoint&&d(t.currSelectionPoint.shape)&&(t.currSelectionPoint=null)),t.updateCropTransformItems(),t.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:"custom",startX:null,startY:null,width:null,height:null}}),t.isCircleCrop&&(t.isCircleCrop=!1,this.tempCurrSelPoint=y({},t.currSelectionPoint,{},!0),t.currSelectionPoint=null);var o=t.cancelCropSelection.isCircleCrop;t.cancelCropSelection.isCircleCrop=!1,t.notify("draw",{prop:"performCancel",value:{isContextualToolbar:null,isUndoRedo:!0}}),t.cancelCropSelection.isCircleCrop=o,t.currObjType.isActiveObj=!1,t.transform.straighten!==0&&t.notify("draw",{prop:"setStraightenActObj",value:{activeObj:null}})}else e.operation==="resize"&&t.cropObj&&t.cropObj.activeObj&&(t.currSelectionPoint=y({},t.cropObj.activeObj,{},!0));this.undoRedoColl[this.undoRedoStep-1]&&this.undoRedoColl[this.undoRedoStep-1].isCircleCrop&&(t.isCircleCrop=!0,t.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}})),this.endUndoRedo(e.operation,!0);var a={action:"undo",actionEventArgs:r};t.triggerEditCompleteEvent(a)}},l.prototype.redo=function(){var t=this.parent;if(this.cancelCropSelection(),t.notify("draw",{prop:"resetFrameZoom",onPropertyChange:!1,value:{isOk:!1}}),!t.disabled&&t.isImageLoaded&&this.undoRedoStep<this.appliedUndoRedoColl.length){this.refreshToolbarActions(),this.undoRedoStep++,t.notify("toolbar",{prop:"enable-disable-btns"}),t.isUndoRedo=!0;var e=this.undoRedoColl[this.undoRedoStep-1];this.undoRedoColl.length===this.undoRedoStep?t.currObjType.isUndoAction=!1:t.currObjType.isUndoAction=!0,e.operation!=="textAreaCustomization"&&(t.textArea.style.display==="block"||t.textArea.style.display==="inline-block")&&(t.textArea.style.display="none"),t.notify("draw",{prop:"setCancelAction",onPropertyChange:!1,value:{bool:!0}}),t.cropObj=y({},e.currentCropObj,{},!0),t.afterCropActions=e.currentObj.afterCropActions,this.lowerContext.filter=e.currentObj.filter,t.element.querySelector(".e-contextual-toolbar-wrapper")&&t.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide"),t.notify("filter",{prop:"setAdjustmentLevel",onPropertyChange:!1,value:{adjustmentLevel:e.currentObj.adjustmentLevel}}),t.notify("filter",{prop:"setTempAdjVal"}),t.currentFilter=e.currentObj.currentFilter,t.notify("filter",{prop:"setTempFilVal"}),t.canvasFilter=this.lowerContext.filter,t.initialAdjustmentValue=this.lowerContext.filter,t.notify("filter",{prop:"setBevelFilter",onPropertyChange:!1,value:{bevelFilter:this.lowerContext.filter}});var i=void 0,r={action:this.getUndoRedoAction(e.operation)};switch(e.operation){case"shapeTransform":case"brightness":case"contrast":case"hue":case"saturation":case"opacity":case"blur":case"exposure":case"default":case"chrome":case"cold":case"warm":case"grayscale":case"blackandwhite":case"sepia":case"invert":case"sharpen":case"imageRotate":case"shapeInsert":this.shapeTransform(e.currentObjColl,e.currentPointColl);break;case"freehanddraw":case"freehand-draw":this.updateFreehandDraw(e.currentPointColl,e.currentSelPointColl),t.notify("freehand-draw",{prop:"setCurrentFreehandDrawIndex",value:{value:t.pointColl.length}});break;case"freehanddrawCustomized":this.updateFreehandDrawCustomized(e.currentObjColl,e.currentPointColl);break;case"deleteFreehandDrawing":case"deleteObj":this.updateDelete(e.operation,e.currentObjColl,e.currentPointColl,e.currentSelPointColl);break;case"textAreaCustomization":this.shapeTransform(e.currentObjColl,e.currentPointColl),this.updateTextAreaCustomization(i,e.currentObjColl);break;case"text":this.updateText(e.currentObjColl,!1);break;case"frame":y(t.frameObj,e.currentObj.frameObj),t.notify("draw",{prop:"render-image",value:{isMouseWheel:!0,isPreventClearRect:null,isFrame:!0}});break;case"imageHFlip":this.imageFlip("horizontal",e.currentObjColl);break;case"imageVFlip":this.imageFlip("vertical",e.currentObjColl);break;case"bgColor":t.notify("draw",{prop:"imageBackgroundColor",onPropertyChange:!1,value:{color:e.currentObj.bgColor}}),t.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}});break;case"updateImage":t.isImageUpdated=!0,t.baseImg.src=e.currentObj.imageSource,setTimeout(function(){t.cropObj.straighten!==0?(t.notify("toolbar",{prop:"performCropTransformClick",value:{shape:"crop-custom"}}),t.noPushUndo=!0,t.crop(),t.noPushUndo=!1):t.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),t.isImageUpdated=!1});break;default:t.objColl=[],t.pointColl=[],t.freehandCounter=0,t.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:[]}}}),t.notify("draw",{prop:"setCurrentObj",onPropertyChange:!1,value:{obj:e.currentObj,isUndoRedo:!0}}),t.img.destLeft=e.currentObj.destPoints.startX,t.img.destTop=e.currentObj.destPoints.startY,i=y({},t.activeObj,{},!0),t.objColl=y([],e.currentObjColl,[],!0),t.pointColl=y([],e.currentPointColl,[],!0),t.freehandCounter=t.pointColl.length,t.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:y([],e.currentSelPointColl,[],!0)}}}),t.transform.straighten=0,this.lowerContext.filter="none",t.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),this.lowerContext.filter=e.currentObj.filter,t.prevStraightenedDegree=t.transform.straighten,t.activeObj=i,this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.activeObj.activePoint.width!==0&&t.activeObj.activePoint.height!==0&&t.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),t.notify("filter",{prop:"set-adjustment",value:{operation:e.operation}}),t.notify("filter",{prop:"update-filter",value:{operation:e.operation}});break}e.operation==="crop"&&e.isCircleCrop&&(t.isCircleCrop=!0,t.currSelectionPoint=y({},this.tempCurrSelPoint,{},!0),this.tempCurrSelPoint=null),e.operation==="crop"&&!e.isCircleCrop&&(t.isCircleCrop=!1),e.operation==="crop"&&e.currentObj.currSelectionPoint&&(t.currSelectionPoint=y({},e.currentObj.currSelectionPoint,{},!0),t.notify("draw",{prop:"setStraightenActObj",value:{activeObj:t.currSelectionPoint}})),t.currSelectionPoint&&d(t.currSelectionPoint.shape)&&(t.currSelectionPoint=null),e.operation==="resize"&&t.cropObj&&t.cropObj.activeObj&&(t.currSelectionPoint=y({},t.cropObj.activeObj,{},!0)),this.endUndoRedo(e.operation,!1);var o={action:"redo",actionEventArgs:r};t.triggerEditCompleteEvent(o)}},l.prototype.imageFlip=function(t,e){var i=this.parent;this.shapeTransform(e,null),i.activeObj=y({},i.objColl[i.objColl.length-1],{},!0);var r=i.activeObj,o=r.shape,a=r.isHorImageFlip,n=r.isVerImageFlip;i.objColl.pop(),o&&o==="image"?(t==="horizontal"?d(a)&&n?(i.activeObj.isHorImageFlip=!0,i.activeObj.isVerImageFlip=null,i.horizontalFlip(this.upperContext,!0)):(d(a)||!a?i.activeObj.isHorImageFlip=!0:i.activeObj.isHorImageFlip=null,i.horizontalFlip(this.upperContext,!0)):t==="vertical"&&(d(n)&&a?(i.activeObj.isVerImageFlip=!0,i.activeObj.isHorImageFlip=null,i.verticalFlip(this.upperContext,!0)):(d(n)||!n?i.activeObj.isVerImageFlip=!0:i.activeObj.isVerImageFlip=null,i.verticalFlip(this.upperContext,!0))),i.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:!0}})):i.notify("draw",{prop:"render-image",value:{isMouseWheel:!0}})},l.prototype.shapeTransform=function(t,e){var i=this.parent;i.objColl=y([],t,[],!0),e&&(i.pointColl=y([],e,[],!0),i.freehandCounter=i.pointColl.length),i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),this.lowerContext.clearRect(0,0,i.lowerCanvas.width,i.lowerCanvas.height),this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),i.isUndoRedo=!0,i.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1})},l.prototype.updateFreehandDraw=function(t,e){var i=this.parent;i.pointColl=t,i.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:e}}}),i.freehandCounter=i.pointColl.length,i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),this.lowerContext.clearRect(0,0,i.lowerCanvas.width,i.lowerCanvas.height),this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),i.isUndoRedo=!0,i.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1})},l.prototype.updateFreehandDrawCustomized=function(t,e){var i=this.parent;i.objColl=y([],t,[],!0),i.pointColl=e,i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),this.lowerContext.clearRect(0,0,i.lowerCanvas.width,i.lowerCanvas.height),this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),i.isUndoRedo=!0,i.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1})},l.prototype.updateDelete=function(t,e,i,r){var o=this.parent;t==="deleteFreehandDrawing"?(o.pointColl=i,o.freehandCounter=o.pointColl.length,o.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:r}}}),o.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}})):t==="deleteObj"&&(o.objColl=e,o.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}})),this.lowerContext.clearRect(0,0,o.lowerCanvas.width,o.lowerCanvas.height),this.upperContext.clearRect(0,0,o.upperCanvas.width,o.upperCanvas.height),o.isUndoRedo=!0,o.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1})},l.prototype.updateTextAreaCustomization=function(t,e){var i=this.parent;i.objColl=y([],e,[],!0),i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),this.lowerContext.clearRect(0,0,i.lowerCanvas.width,i.lowerCanvas.height),i.isUndoRedo=!0,i.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1});for(var r=0,o=e.length;r<o;r++)if(this.tempActObj){if(this.tempActObj.currIndex===e[r].currIndex){t=y({},e[r],{},!0),i.objColl.splice(r,1);break}}else{t=y({},e[e.length-1],{},!0),i.objColl.splice(r,1);break}t&&this.updateTextBox(t),(i.textArea.style.display==="block"||i.textArea.style.display==="inline-block")&&i.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:null}})},l.prototype.updateText=function(t,e){var i=this.parent;if(this.tempActObj&&(i.activeObj=y({},this.tempActObj,{},!0)),t.length===0&&i.objColl.length===1)this.tempActObj=y({},i.objColl[0],{},!0);else for(var r=0,o=i.objColl.length;r<o;r++){if(i.objColl[r]&&d(t[r])){this.tempActObj=y({},i.objColl[r],{},!0);break}if(t[r].currIndex!==i.objColl[r].currIndex){this.tempActObj=y({},i.objColl[r],{},!0);break}}e&&(i.activeObj=y({},this.tempActObj,{},!0)),i.objColl=y([],t,[],!0),i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:!0}}),this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),this.lowerContext.clearRect(0,0,i.lowerCanvas.width,i.lowerCanvas.height),i.isUndoRedo=!0,i.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1})},l.prototype.updateTextBox=function(t){var e=this.parent;this.upperContext.clearRect(0,0,e.lowerCanvas.width,e.lowerCanvas.height),this.lowerContext.clearRect(0,0,e.lowerCanvas.width,e.lowerCanvas.height),e.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),e.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1});var i=e.textArea;i.style.display="block",i.style.fontFamily=t.textSettings.fontFamily,i.style.fontSize=t.textSettings.fontSize+"px",i.style.color=t.strokeSettings.strokeColor,i.style.fontWeight=t.textSettings.bold?"bold":"normal",i.style.fontStyle=t.textSettings.italic?"italic":"normal",i.style.border="2px solid "+e.themeColl[e.theme].primaryColor,i.value=t.keyHistory,e.activeObj=y({},t,{},!0),e.notify("shape",{prop:"updateFontStyles",onPropertyChange:!1,value:{isTextBox:null}}),e.textArea.style.width=e.activeObj.activePoint.width+"px"},l.prototype.undoDefault=function(t,e){this.lowerContext.filter=t.previousObj.filter;var i=this.parent;i.objColl=[],i.pointColl=[],i.freehandCounter=0,i.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:[]}}});var r=e?!1:t.isCircleCrop;i.notify("draw",{prop:"setCurrentObj",onPropertyChange:!1,value:{obj:t.previousObj,isUndoRedo:e,isCircleCrop:r}}),i.prevStraightenedDegree=i.transform.straighten,this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),i.img.destLeft=t.previousObj.destPoints.startX,i.img.destTop=t.previousObj.destPoints.startY;var o=y({},i.activeObj,{},!0);i.objColl=y([],t.previousObjColl,[],!0),i.pointColl=y([],t.previousPointColl,[],!0),i.freehandCounter=i.pointColl.length,i.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:y([],t.previousSelPointColl,[],!0)}}}),i.transform.straighten=0,this.lowerContext.filter="none",i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),this.lowerContext.filter=t.previousObj.filter,i.activeObj=o,this.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),i.activeObj.activePoint.width!==0&&i.activeObj.activePoint.height!==0&&i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}})},l.prototype.endUndoRedo=function(t,e){var i=this.parent,r={type:"none",color:"#fff",size:20,inset:20,offset:20,radius:0,amount:1,border:"solid",gradientColor:""};(i.currSelectionPoint&&i.currSelectionPoint.shape==="crop-circle"||i.isCircleCrop)&&JSON.stringify(i.frameObj)!==JSON.stringify(r)&&i.notify("draw",{prop:"render-image",value:{isMouseWheel:!0}}),i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),i.isCircleCrop&&(e&&t!=="crop"||!e)&&i.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}}),i.transform.zoomFactor>0&&i.notify("selection",{prop:"setDragCanvas",value:{bool:!0}}),i.notify("draw",{prop:"setCancelAction",onPropertyChange:!1,value:{bool:!1}}),i.activeObj.shape&&i.activeObj.shape.split("-")[0]==="crop"?i.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:!0,isCropping:!0,isZooming:null,cType:null}}):i.notify("toolbar",{prop:"refresh-main-toolbar",onPropertyChange:!1}),i.notify("toolbar",{prop:"enable-disable-btns"}),document.getElementById(i.element.id+"_quickAccessToolbarArea")&&(document.getElementById(i.element.id+"_quickAccessToolbarArea").style.display="none"),i.notify("toolbar",{prop:"enable-disable-btns"}),i.transform.degree!==0&&i.notify("transform",{prop:"drawPannedImage",onPropertyChange:!1,value:{xDiff:0,yDiff:0}}),i.notify("filter",{prop:"setAdjustmentValue",onPropertyChange:!1,value:{adjustmentValue:this.lowerContext.filter}}),i.currObjType.isCustomCrop=!1},l.prototype.updateUrc=function(t,e,i,r,o,a,n,s,h,p){var u=this.parent;if(!(u.isResize||this.isPreventing)){var c={isInitialLoaded:!1};if(u.currObjType.isUndoAction&&this.refreshUrc(!0),u.notify("draw",{prop:"isInitialLoaded",onPropertyChange:!1,value:{object:c}}),!c.isInitialLoaded&&u.allowUndoRedo){var f={currObj:{}};u.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:f}});var g=f.currObj;g.objColl=y([],u.objColl,[],!0),g.pointColl=y([],u.pointColl,[],!0),g.afterCropActions=y([],u.afterCropActions,[],!0);var v={selPointColl:null};if(u.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:v}}),g.selPointColl=y([],v.selPointColl,[],!0),t==="crop")g.currSelectionPoint=y({},u.currSelectionPoint,{},!0);else if(t==="frame")e.destPoints={startX:u.frameDestPoints.destLeft,startY:u.frameDestPoints.destTop,width:u.frameDestPoints.destWidth,height:u.frameDestPoints.destHeight},g.destPoints={startX:u.frameDestPoints.destLeft,startY:u.frameDestPoints.destTop,width:u.frameDestPoints.destWidth,height:u.frameDestPoints.destHeight},d(u.tempFrameZoomLevel)||(e.defaultZoom=g.defaultZoom=u.tempFrameZoomLevel);else if((t==="imageHFlip"||t==="imageVFlip")&&this.appliedUndoRedoColl.length>0){var m=i[i.length-1].currIndex;if(i=this.appliedUndoRedoColl[this.appliedUndoRedoColl.length-1].currentObjColl,m){for(var C=0,M=i.length;C<M;C++)if(i[C].currIndex===m){var I=y({},i[C],{},!0);i.splice(C,1),i.push(I);break}}}this.undoRedoColl.push({operation:t,previousObj:e,currentObj:g,previousObjColl:i,currentObjColl:g.objColl,previousPointColl:r,currentPointColl:g.pointColl,previousSelPointColl:o,currentSelPointColl:g.selPointColl,previousCropObj:a,currentCropObj:y({},u.cropObj,{},!0),previousText:n,currentText:s,filter:h,isCircleCrop:p}),u.notify("toolbar",{prop:"enable-disable-btns",onPropertyChange:!1})}}},l.prototype.updateUrObj=function(t,e){var i=this.parent;if(i.allowUndoRedo){i.currObjType.isUndoAction&&!i.isShapeDrawing&&this.refreshUrc(!0),d(i.activeObj.imageRatio)&&i.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),i.objColl.push(i.activeObj);var r=y({},i.cropObj,{},!0),o={currObj:{}};i.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:o}});var a=o.currObj;a.objColl=y([],i.objColl,[],!0),a.pointColl=y([],i.pointColl,[],!0),a.afterCropActions=y([],i.afterCropActions,[],!0);var n={selPointColl:null};i.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:n}}),a.selPointColl=y([],n.selPointColl,[],!0);var s=e||"shapeTransform";this.undoRedoColl.push({operation:s,previousObj:a,currentObj:a,previousObjColl:t,currentObjColl:a.objColl,previousPointColl:a.pointColl,currentPointColl:a.pointColl,previousSelPointColl:a.selPointColl,currentSelPointColl:a.selPointColl,previousCropObj:r,currentCropObj:r}),i.notify("selection",{prop:"redrawShape",onPropertyChange:!1,value:{obj:i.objColl[i.objColl.length-1]}})}},l.prototype.updateUndoRedo=function(t){var e=this.parent,i=y({},e.cropObj,{},!0),r={currObj:{}};e.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:r}});var o=r.currObj;o.objColl=y([],e.objColl,[],!0),o.pointColl=y([],e.pointColl,[],!0),o.afterCropActions=y([],e.afterCropActions,[],!0);var a={selPointColl:null};e.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:a}}),o.selPointColl=y([],a.selPointColl,[],!0),d(e.activeObj.imageRatio)&&e.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),e.objColl.push(e.activeObj);var n=t||"shapeTransform";this.updateUrc(n,o,o.objColl,o.pointColl,o.selPointColl,i),e.objColl.pop(),e.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:null}}),e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"shapes",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),e.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}})},l.prototype.getZeroZoomObjPointValue=function(t,e){var i=this.parent;this.updateObjColl();var r={currObj:{}};i.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:r}});var o=r.currObj;o.objColl=y([],i.objColl,[],!0),o.pointColl=y([],i.pointColl,[],!0),o.afterCropActions=y([],i.afterCropActions,[],!0);var a={selPointColl:null};i.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:a}}),o.selPointColl=y([],a.selPointColl,[],!0);var n={cropDimension:null};i.notify("transform",{prop:"getCropDimension",onPropertyChange:!1,value:{obj:n}});var s=y([],i.objColl,[],!0),h=y([],i.pointColl,[],!0),p={arrowDimension:null};this.parent.notify("draw",{prop:"getArrowDimension",onPropertyChange:!1,value:{obj:p}});var u=y({},p.arrowDimension,{},!0);if(i.transform.zoomFactor>0&&(t.length>0||e.length>0)){if(t.length>0)for(var c=0;c<t.length;c++)t[c].currIndex||(t[c].currIndex="shape_"+(c+1));i.objColl=t,i.pointColl=e;var f=i.isUndoRedo,g=i.isCropTab;if(i.transform.zoomFactor!==0){i.isUndoRedo=!0,i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:!0}}),i.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1}),i.isCropTab=!0;var v=y({},i.zoomSettings,null,!0);i.transform.zoomFactor>0?i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-i.transform.zoomFactor,zoomPoint:null,isResize:null}}):i.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:Math.abs(i.transform.zoomFactor),zoomPoint:null,isResize:null}}),i.zoomSettings=v,i.isCropTab=g,i.isUndoRedo=f,s=y([],i.objColl,[],!0),h=y([],i.pointColl,[],!0),i.objColl=[],i.pointColl=[],i.freehandCounter=0,i.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:[]}}}),i.notify("transform",{prop:"setCropDimension",onPropertyChange:!1,value:{width:n.cropDimension.width,height:n.cropDimension.height}});var m={width:n.cropDimension.width,height:n.cropDimension.height};m.width+=m.width*o.defaultZoom,m.height+=m.height*o.defaultZoom,i.notify("draw",{prop:"setZoomCropWidth",value:{width:m.width,height:m.height}}),i.notify("draw",{prop:"setCurrentObj",onPropertyChange:!1,value:{obj:o}}),i.img.destLeft=o.destPoints.startX,i.img.destTop=o.destPoints.startY,i.panPoint.totalPannedPoint=o.totalPannedPoint,i.panPoint.totalPannedClientPoint=o.totalPannedClientPoint,i.panPoint.totalPannedInternalPoint=o.totalPannedInternalPoint,i.objColl=y([],o.objColl,[],!0),i.pointColl=y([],o.pointColl,[],!0),i.freehandCounter=i.pointColl.length,i.notify("draw",{prop:"setArrowDimension",onPropertyChange:!1,value:{arrowDimension:u}}),i.notify("freehand-draw",{prop:"setSelPointColl",onPropertyChange:!1,value:{obj:{selPointColl:y([],o.selPointColl,[],!0)}}}),this.lowerContext.filter="none",i.transform.straighten=0,this.applyImgTranform(),i.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"iterate",pen:"iterate",isPreventApply:null}}),i.notify("freehand-draw",{prop:"updateFHDCurPts",onPropertyChange:!1}),this.lowerContext.filter=o.filter,i.transform.degree!==0&&i.notify("transform",{prop:"drawPannedImage",onPropertyChange:!1,value:{xDiff:0,yDiff:0}}),i.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),(i.isCircleCrop||i.currSelectionPoint&&i.currSelectionPoint.shape==="crop-circle")&&i.notify("crop",{prop:"cropCircle",onPropertyChange:!1,value:{context:this.lowerContext,isSave:null,isFlip:null}})}}return{obj:s,point:h}},l.prototype.updateObjColl=function(){for(var t=this.parent,e=0;e<t.objColl.length;e++){var i=t.objColl[e],r=!1;if((i.shape==="line"||i.shape==="arrow")&&(i.activePoint.width<0&&(i.activePoint.width=Math.abs(i.activePoint.width),r=!0),i.activePoint.height<0&&(i.activePoint.height=Math.abs(i.activePoint.height),r=!0),r)){var o=y({},t.activeObj,{},!0);t.activeObj=i,t.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),i=t.activeObj,t.activeObj=o}}},l.prototype.applyImgTranform=function(){for(var t=this.parent,e=y({},t.activeObj,{},!0),i=0,r=t.objColl.length;i<r;i++)if(t.objColl[i].shape==="image"){t.activeObj=y({},t.objColl[i],{},!0);var o=t.objColl[i].imageCanvas.getContext("2d");t.notify("selection",{prop:"applyTransformToImg",onPropertyChange:!1,value:{ctx:o}}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.notify("selection",{prop:"setImageClarity",onPropertyChange:!1,value:{bool:!0}})}t.activeObj=e},l.prototype.updateUndoRedoStack=function(t){var e=this.parent;if(e.activeObj.currIndex&&e.activeObj.activePoint.width!==0||e.activeObj.activePoint.height!==0||e.activeObj.pointColl&&e.activeObj.pointColl.length>0||t){var i=e.textArea.style.display!=="none",r=e.noPushUndo;if(e.noPushUndo=!1,e.isUndoRedoStack=!0,t){var o=e.togglePen,a={freehandDrawSelectedId:null};e.notify("freehand-draw",{prop:"getFreehandDrawSelectedId",onPropertyChange:!1,value:{obj:a}}),e.okBtn(),e.noPushUndo=r,a.freehandDrawSelectedId?(e.noRedact=!0,e.selectShape(a.freehandDrawSelectedId)):e.freeHandDraw(!0),e.togglePen=o}else if(e.activeObj.currIndex){var n=e.activeObj.currIndex;e.okBtn(),e.noPushUndo=r,e.noRedact=!0,e.selectShape(n),e.drawingShape&&e.notify("selection",{prop:"setCurrentDrawingShape",onPropertyChange:!1,value:{value:e.drawingShape.toLowerCase()}}),i&&e.enableTextEditing()}e.isUndoRedoStack=!1}},l}(),K={RTL:"e-rtl",DISABLE:"e-disabled",INPUT:"e-input",TEXTAREA:"e-multi-line-input",INPUTGROUP:"e-input-group",FLOATINPUT:"e-float-input",FLOATLINE:"e-float-line",FLOATTEXT:"e-float-text",FLOATTEXTCONTENT:"e-float-text-content",CLEARICON:"e-clear-icon",CLEARICONHIDE:"e-clear-icon-hide",LABELTOP:"e-label-top",LABELBOTTOM:"e-label-bottom",NOFLOATLABEL:"e-no-float-label",INPUTCUSTOMTAG:"e-input-custom-tag",FLOATCUSTOMTAG:"e-float-custom-tag"},Ja=["title","style","class"],qs="e-input-focus",ne;(function(l){var t=!0;function e(j,w){j.element.__eventHandlers={};var F=d(w)?Ie:w,H={container:null,buttons:[],clearButton:null};if(j.floatLabelType,t=j.bindClearAction,d(j.floatLabelType)||j.floatLabelType==="Never"?(H.container=L(j,K.INPUTGROUP,K.INPUTCUSTOMTAG,"span",F),j.element.parentNode.insertBefore(H.container,j.element),W([j.element],K.INPUT),H.container.appendChild(j.element)):v(j,H,F),a(j),!d(j.properties)&&!d(j.properties.showClearButton)&&j.properties.showClearButton&&(Pe(j.properties.showClearButton,j.element,H,!0,F),H.clearButton.setAttribute("role","button"),H.container.classList.contains(K.FLOATINPUT)&&W([H.container],K.INPUTGROUP)),!d(j.buttons))for(var _=0;_<j.buttons.length;_++)H.buttons.push(Lo(j.buttons[_],H.container,F));return!d(j.element)&&j.element.tagName==="TEXTAREA"&&W([H.container],K.TEXTAREA),xn(H.container,j.element),H=M(j,H),Eo(H.container,F),H}l.createInput=e;function i(j){var w=O(j.element);(w.classList.contains("e-input-group")||w.classList.contains("e-outline")||w.classList.contains("e-filled"))&&w.classList.add("e-input-focus"),j.floatLabelType!=="Never"&&setTimeout(function(){l.calculateWidth(j.element,w)},80)}function r(j){var w=O(j.element);(w.classList.contains("e-input-group")||w.classList.contains("e-outline")||w.classList.contains("e-filled"))&&w.classList.remove("e-input-focus"),j.floatLabelType!=="Never"&&setTimeout(function(){l.calculateWidth(j.element,w)},80)}function o(j){s(j.floatLabelType,j.element)}function a(j){s(j.floatLabelType,j.element);var w=function(){return i(j)},F=function(){return r(j)},H=function(){return o(j)};j.element.addEventListener("focus",w),j.element.addEventListener("blur",F),j.element.addEventListener("input",H),j.element.__eventHandlers.inputFocusHandler={focusHandler:w},j.element.__eventHandlers.inputBlurHandler={blurHandler:F},j.element.__eventHandlers.inputHandler={inputHandler:H}}l.bindInitialEvent=a;function n(j){if(!d(j.element)&&!d(j.element.__eventHandlers)&&!d(j.element.__eventHandlers.inputFocusHandler)&&!d(j.element.__eventHandlers.inputBlurHandler)&&!d(j.element.__eventHandlers.inputHandler)){var w=j.element.__eventHandlers.inputFocusHandler.focusHandler,F=j.element.__eventHandlers.inputBlurHandler.blurHandler,H=j.element.__eventHandlers.inputHandler.inputHandler;j.element.removeEventListener("focus",w),j.element.removeEventListener("blur",F),j.element.removeEventListener("input",H),delete j.element.__eventHandlers.inputFocusHandler,delete j.element.__eventHandlers.inputBlurHandler,delete j.element.__eventHandlers.inputHandler}}function s(j,w){var F=w.value,H=w.parentElement,_=H&&H.parentElement;F!==""&&!d(F)?H&&H.classList.contains("e-input-group")?H.classList.add("e-valid-input"):_&&_.classList.contains("e-input-group")&&_.classList.add("e-valid-input"):j!=="Always"&&(H&&H.classList.contains("e-input-group")?H.classList.remove("e-valid-input"):_&&_.classList.contains("e-input-group")&&_.classList.remove("e-valid-input"))}function h(){var j=O(this).getElementsByClassName("e-float-text")[0];d(j)||(W([j],K.LABELTOP),j.classList.contains(K.LABELBOTTOM)&&G([j],K.LABELBOTTOM))}function p(){var j=O(this);if(j.getElementsByTagName("textarea")[0]?j.getElementsByTagName("textarea")[0].value==="":j.getElementsByTagName("input")[0].value===""){var w=j.getElementsByClassName("e-float-text")[0];d(w)||(w.classList.contains(K.LABELTOP)&&G([w],K.LABELTOP),W([w],K.LABELBOTTOM))}}function u(j){j.addEventListener("focus",h),j.addEventListener("blur",p)}l.wireFloatingEvents=u;function c(j){d(j)||(j.removeEventListener("focus",h),j.removeEventListener("blur",p))}function f(j){E(j.element,j.floatLabelType)}function g(j){E(j.element,j.floatLabelType)}function v(j,w,F){var H=d(F)?Ie:F;j.floatLabelType==="Auto"&&u(j.element),d(w.container)?(w.container=L(j,K.FLOATINPUT,K.FLOATCUSTOMTAG,"div",H),w.container.classList.add(K.INPUTGROUP),j.element.parentNode&&j.element.parentNode.insertBefore(w.container,j.element)):(d(j.customTag)||w.container.classList.add(K.FLOATCUSTOMTAG),w.container.classList.add(K.FLOATINPUT));var _=H("span",{className:K.FLOATLINE}),J=H("label",{className:K.FLOATTEXT});if(!d(j.element.id)&&j.element.id!==""&&(J.id="label_"+j.element.id.replace(/ /g,"_"),ge(j.element,{"aria-labelledby":J.id})),!d(j.element.placeholder)&&j.element.placeholder!==""&&(J.innerText=k(j.element.placeholder),j.element.removeAttribute("placeholder")),!d(j.properties)&&!d(j.properties.placeholder)&&j.properties.placeholder!==""&&(J.innerText=k(j.properties.placeholder)),J.innerText||w.container.classList.add(K.NOFLOATLABEL),w.container.classList.contains("e-float-icon-left")){var Ce=w.container.querySelector(".e-input-in-wrap");Ce.appendChild(j.element),Ce.appendChild(_),Ce.appendChild(J)}else w.container.appendChild(j.element),w.container.appendChild(_),w.container.appendChild(J);if(N(j.element.value,J),j.floatLabelType==="Always"&&(J.classList.contains(K.LABELBOTTOM)&&G([J],K.LABELBOTTOM),W([J],K.LABELTOP)),j.floatLabelType==="Auto"){var $e=function(){return f(j)},qe=function(){return g(j)};j.element.addEventListener("input",$e),j.element.addEventListener("blur",qe),j.element.__eventHandlers.floatInputHandler={inputFloatHandler:$e},j.element.__eventHandlers.floatBlurHandler={blurFloatHandler:qe}}else m(j);d(j.element.getAttribute("id"))||J.setAttribute("for",j.element.getAttribute("id"))}function m(j){if(!d(j.element)&&!d(j.element.__eventHandlers)&&!d(j.element.__eventHandlers.floatInputHandler)&&!d(j.element.__eventHandlers.floatBlurHandler)){var w=j.element.__eventHandlers.floatInputHandler.inputFloatHandler,F=j.element.__eventHandlers.floatBlurHandler.blurFloatHandler;j.element.removeEventListener("input",w),j.element.removeEventListener("blur",F),delete j.element.__eventHandlers.floatInputHandler,delete j.element.__eventHandlers.floatBlurHandler}}function C(j,w){j==="Always"&&w.classList.contains("e-outline")&&w.classList.add("e-valid-input")}function M(j,w){if(!d(j.properties))for(var F=0,H=Object.keys(j.properties);F<H.length;F++){var _=H[F];switch(_){case"cssClass":B(j.properties.cssClass,[w.container]),C(j.floatLabelType,w.container);break;case"enabled":Te(j.properties.enabled,j.element,j.floatLabelType,w.container);break;case"enableRtl":pe(j.properties.enableRtl,[w.container]);break;case"placeholder":oe(j.properties.placeholder,j.element);break;case"readonly":he(j.properties.readonly,j.element);break}}return w}function I(j,w,F){d(w)||(j&&!F?G([w],K.CLEARICONHIDE):W([w],K.CLEARICONHIDE))}function N(j,w,F){if(F===void 0&&(F=null),j)W([w],K.LABELTOP),w.classList.contains(K.LABELBOTTOM)&&G([w],K.LABELBOTTOM);else{var H=F!=null?F!==document.activeElement:!0;H&&(w.classList.contains(K.LABELTOP)&&G([w],K.LABELTOP),W([w],K.LABELBOTTOM))}}function O(j){var w=d(j.parentNode)?j:j.parentNode;return w&&w.classList.contains("e-input-in-wrap")&&(w=w.parentNode),w}function x(j,w,F,H){var _=d(H)?Ie:H,J=_("span",{className:K.CLEARICON}),Ce=w.container;if(!d(F))Ce.appendChild(J);else{var $e=w.container.classList.contains(K.FLOATINPUT)?w.container.querySelector("."+K.FLOATTEXT):j;$e.insertAdjacentElement("afterend",J)}return W([J],K.CLEARICONHIDE),q(j,J),J.setAttribute("aria-label","close"),J}function D(j,w,F){w.classList.contains(K.DISABLE)||w.readOnly||(j.preventDefault(),w!==document.activeElement&&w.focus(),w.value="",W([F],K.CLEARICONHIDE))}function A(j,w){I(j.value,w)}function P(j,w){I(j.value,w,j.readOnly)}function V(j,w){setTimeout(function(){d(w)||(W([w],K.CLEARICONHIDE),w=!d(j)&&j.classList.contains("e-combobox")?null:w)},200)}function q(j,w,F){if(t===void 0||t){var H=function($e){return D($e,j,w)};w.addEventListener("click",H),j.__eventHandlers.clearClickHandler={clickHandlerEvent:H}}var _=function(){return A(j,w)},J=function(){return P(j,w)},Ce=function(){return V(j,w)};j.addEventListener("input",_),j.addEventListener("focus",J),j.addEventListener("blur",Ce),j.__eventHandlers.clearInputHandler={inputHandlerEvent:_},j.__eventHandlers.clearFocusHandler={focusHandlerEvent:J},j.__eventHandlers.clearBlurHandler={blurHandlerEvent:Ce}}l.wireClearBtnEvents=q;function re(j,w){if(!d(j)&&!d(j.__eventHandlers)){if(!d(j.__eventHandlers.clearClickHandler)){var F=j.__eventHandlers.clearClickHandler.clickHandlerEvent;(t===void 0||t)&&(d(w)||w.removeEventListener("click",F)),delete j.__eventHandlers.clearClickHandler}if(!d(j.__eventHandlers.clearInputHandler)&&!d(j.__eventHandlers.clearFocusHandler)&&!d(j.__eventHandlers.clearBlurHandler)){var H=j.__eventHandlers.clearInputHandler.inputHandlerEvent,_=j.__eventHandlers.clearFocusHandler.focusHandlerEvent,J=j.__eventHandlers.clearBlurHandler.blurHandlerEvent;j.removeEventListener("input",H),j.removeEventListener("focus",_),j.removeEventListener("blur",J),delete j.__eventHandlers.clearInputHandler,delete j.__eventHandlers.clearFocusHandler,delete j.__eventHandlers.clearBlurHandler}}}function ae(j,w){w===void 0&&(w=null),n(j),j.floatLabelType==="Auto"&&m(j),j.properties.showClearButton&&re(j.element,w),d(j.buttons)||kr(!1,null,j.buttons),c(j.element),d(j.element)||(delete j.element.__eventHandlers,j.element.classList.contains(K.INPUT)&&j.element.classList.remove(K.INPUT))}l.destroy=ae;function E(j,w){var F=O(j);if(F.classList.contains(K.FLOATINPUT)&&w==="Auto"){var H=O(j).getElementsByClassName("e-float-text")[0];N(j.value,H,j)}}function L(j,w,F,H,_){var J=d(_)?Ie:_,Ce;return d(j.customTag)?Ce=J(H,{className:w}):(Ce=J(j.customTag,{className:w}),Ce.classList.add(F)),Ce.classList.add("e-control-wrapper"),Ce}function k(j){var w="";if(!d(j)&&j!==""){var F=document.createElement("span");F.innerHTML='<input  placeholder="'+j+'"/>';var H=F.children[0];w=H.placeholder}return w}function U(j,w,F,H){if(w.value=j,F!=="Never"&&R(w,w.parentElement),!d(F)&&F==="Auto"&&E(w,F),!d(H)&&H){var _=O(w);if(!d(_)){var J=_.getElementsByClassName(K.CLEARICON)[0];d(J)||(w.value&&!d(_)&&_.classList.contains("e-input-focus")?G([J],K.CLEARICONHIDE):W([J],K.CLEARICONHIDE))}}s(F,w)}l.setValue=U;function B(j,w,F){!d(F)&&F!==""&&G(w,F.split(" ")),!d(j)&&j!==""&&W(w,j.split(" "))}l.setCssClass=B;function R(j,w,F){if(!(F!=="multiselect"&&!Zh(j))){var H=F==="multiselect"?j:j.clientWidth-parseInt(getComputedStyle(j,null).getPropertyValue("padding-left"),10);!d(w)&&!d(w.getElementsByClassName("e-float-text-content")[0])&&(w.getElementsByClassName("e-float-text-content")[0].classList.contains("e-float-text-overflow")&&w.getElementsByClassName("e-float-text-content")[0].classList.remove("e-float-text-overflow"),(H<w.getElementsByClassName("e-float-text-content")[0].clientWidth||H===w.getElementsByClassName("e-float-text-content")[0].clientWidth)&&w.getElementsByClassName("e-float-text-content")[0].classList.add("e-float-text-overflow"))}}l.calculateWidth=R;function $(j,w){typeof j=="number"?w.style.width=ee(j):typeof j=="string"&&(w.style.width=j.match(/px|%|em/)?j:ee(j)),R(w.firstChild,w)}l.setWidth=$;function oe(j,w){j=k(j);var F=O(w);if(F.classList.contains(K.FLOATINPUT))if(!d(j)&&j!==""){var H=F.getElementsByClassName("e-float-text-content")[0];H&&H.children[0]?H.children[0].textContent=j:F.getElementsByClassName(K.FLOATTEXT)[0].textContent=j,F.classList.remove(K.NOFLOATLABEL),w.removeAttribute("placeholder")}else{F.classList.add(K.NOFLOATLABEL);var H=F.getElementsByClassName("e-float-text-content")[0];H?H.children[0].textContent="":F.getElementsByClassName(K.FLOATTEXT)[0].textContent=""}else!d(j)&&j!==""?ge(w,{placeholder:j}):w.removeAttribute("placeholder")}l.setPlaceholder=oe;function he(j,w,F){j?ge(w,{readonly:""}):w.removeAttribute("readonly"),d(F)||E(w,F)}l.setReadonly=he;function pe(j,w){j?W(w,K.RTL):G(w,K.RTL)}l.setEnableRtl=pe;function Te(j,w,F,H){var _={disabled:"","aria-disabled":"true"},J=!d(H);j?(w.classList.remove(K.DISABLE),Ue(_,w),J&&G([H],K.DISABLE)):(w.classList.add(K.DISABLE),Se(_,w),J&&W([H],K.DISABLE)),d(F)||E(w,F)}l.setEnabled=Te;function Pe(j,w,F,H,_){var J=d(_)?Ie:_;j?F.clearButton=x(w,F,H,J):(it(F.clearButton),F.clearButton=null)}l.setClearButton=Pe;function Ue(j,w){for(var F=0,H=Object.keys(j);F<H.length;F++){var _=H[F],J=O(w);_==="disabled"&&w.classList.remove(K.DISABLE),_==="disabled"&&J.classList.contains(K.INPUTGROUP)&&J.classList.remove(K.DISABLE),_==="placeholder"&&J.classList.contains(K.FLOATINPUT)?J.getElementsByClassName(K.FLOATTEXT)[0].textContent="":w.removeAttribute(_)}}l.removeAttributes=Ue;function Se(j,w){for(var F=0,H=Object.keys(j);F<H.length;F++){var _=H[F],J=O(w);_==="disabled"&&w.classList.add(K.DISABLE),_==="disabled"&&J.classList.contains(K.INPUTGROUP)&&J.classList.add(K.DISABLE),_==="placeholder"&&J.classList.contains(K.FLOATINPUT)?J.getElementsByClassName(K.FLOATTEXT)[0].textContent=j[""+_]:w.setAttribute(_,j[""+_])}}l.addAttributes=Se;function Pt(j){var w=j.container;if(!d(w)&&w.classList.contains(K.FLOATINPUT)){var F=w.querySelector("textarea")?w.querySelector("textarea"):w.querySelector("input"),H=w.querySelector("."+K.FLOATTEXT).textContent,_=w.querySelector(".e-clear-icon")!==null;X(w.querySelector("."+K.FLOATLINE)),X(w.querySelector("."+K.FLOATTEXT)),lt(w,[K.INPUTGROUP],[K.FLOATINPUT]),c(F),ge(F,{placeholder:H}),F.classList.add(K.INPUT),!_&&F.tagName==="INPUT"&&F.removeAttribute("required")}}l.removeFloating=Pt;function jt(j,w,F,H){var _=d(H)?Ie:H,J=ce(j,"."+K.INPUTGROUP),Ce=J.tagName;Ce=Ce!=="DIV"&&Ce!=="SPAN"?Ce:null;var $e={element:j,floatLabelType:w,customTag:Ce,properties:{placeholder:F}};if(w!=="Never"){var qe=J.querySelector(".e-clear-icon"),Et={container:J};j.classList.remove(K.INPUT),v($e,Et,_),Eo(Et.container,_),R($e.element,Et.container);var Lt=J.classList.contains("e-float-icon-left");if(d(qe))if(Lt){var tp=J.querySelector(".e-input-in-wrap");qe=tp.querySelector(".e-input-group-icon")}else qe=J.querySelector(".e-input-group-icon");if(d(qe))Lt&&(qe=J.querySelector(".e-input-group-icon"));else{var ip=J.querySelector("."+K.FLOATLINE),rp=J.querySelector("."+K.FLOATTEXT),Yo=Lt?J.querySelector(".e-input-in-wrap"):J;Yo.insertBefore(j,qe),Yo.insertBefore(ip,qe),Yo.insertBefore(rp,qe)}}else m($e);C(w,j.parentElement)}l.addFloating=jt;function Eo(j,w){if(j.classList.contains("e-outline")&&j.getElementsByClassName("e-float-text")[0]){var F=w("span",{className:K.FLOATTEXTCONTENT});F.innerHTML=j.getElementsByClassName("e-float-text")[0].innerHTML,j.getElementsByClassName("e-float-text")[0].innerHTML="",j.getElementsByClassName("e-float-text")[0].appendChild(F)}}l.createSpanElement=Eo;function qh(j,w){for(var F=0;F<w.length;F++)kr(j,w[parseInt(F.toString(),10)].container)}l.setRipple=qh;function kr(j,w,F){var H=[];H.push(F);var _=d(F)?w.querySelectorAll(".e-input-group-icon"):H;if(j&&_.length>0)for(var J=0;J<_.length;J++)_[parseInt(J.toString(),10)].addEventListener("mousedown",Nn,!1),_[parseInt(J.toString(),10)].addEventListener("mouseup",Dn,!1);else if(_.length>0)for(var J=0;J<_.length;J++)_[parseInt(J.toString(),10)].removeEventListener("mousedown",Nn,this),_[parseInt(J.toString(),10)].removeEventListener("mouseup",Dn,this)}function _h(j,w){!j.classList.contains("e-disabled")&&!j.querySelector("input").readOnly&&w.classList.add("e-input-btn-ripple")}function Zh(j){if(!j)return!1;for(var w=j;w&&w!==document.body;){var F=window.getComputedStyle(w);if(F.display==="none")return!1;w=w.parentElement}return!0}function Nn(){for(var j=this,w=this.parentElement;!w.classList.contains("e-input-group");)w=w.parentElement;_h(w,j)}function Dn(){var j=this;setTimeout(function(){j.classList.remove("e-input-btn-ripple")},500)}function wn(j,w){var F=w("span",{className:j});return F.classList.add("e-input-group-icon"),F}function Gh(j,w,F,H,_){var J=typeof w=="string"?w.split(","):w;if(j.toLowerCase()==="append")for(var Ce=0,$e=J;Ce<$e.length;Ce++){var qe=$e[Ce];Lo(qe,F,_)}else for(var Et=0,Lt=J;Et<Lt.length;Et++){var qe=Lt[Et];On(qe,F,H,_)}F.getElementsByClassName("e-input-group-icon")[0]&&F.getElementsByClassName("e-float-text-overflow")[0]&&F.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon")}l.addIcon=Gh;function On(j,w,F,H){var _=d(H)?Ie:H,J=wn(j,_);w.classList.add("e-float-icon-left");var Ce=w.querySelector(".e-input-in-wrap");if(d(Ce)){Ce=_("span",{className:"e-input-in-wrap"}),F.parentNode.insertBefore(Ce,F);var $e=w.querySelectorAll(F.tagName+" ~ *");Ce.appendChild(F);for(var qe=0;qe<$e.length;qe++){var Et=$e[parseInt(qe.toString(),10)],Lt=Ce.parentElement;(!Et.classList.contains("e-float-line")||!(Lt&&Lt.classList.contains("e-filled"))&&Lt)&&Ce.appendChild(Et)}}return Ce.parentNode.insertBefore(J,Ce),kr(!0,w,J),J}l.prependSpan=On;function Lo(j,w,F){var H=d(F)?Ie:F,_=wn(j,H),J=w.classList.contains("e-float-icon-left")?w.querySelector(".e-input-in-wrap"):w;return J.appendChild(_),kr(!0,w,_),_}l.appendSpan=Lo;function xn(j,w){w.type==="hidden"?j.classList.add("e-hidden"):j.classList.contains("e-hidden")&&j.classList.remove("e-hidden")}l.validateInputType=xn;function Jh(j,w){if(!d(j))for(var F=0,H=Object.keys(j);F<H.length;F++){var _=H[F];Ja.indexOf(_)<0&&w.setAttribute(_,j[""+_])}}l.updateHTMLAttributesToElement=Jh;function Kh(j,w,F){B(ko(j),[F],ko(w))}l.updateCssClass=Kh;function ko(j){var w=j;return!d(j)&&j!==""&&(w=j.replace(/\s+/g," ").trim()),w}l.getInputValidClassList=ko;function $h(j,w){if(!d(j))for(var F=0,H=Object.keys(j);F<H.length;F++){var _=H[F];if(Ja.indexOf(_)>-1)if(_==="class"){var J=this.getInputValidClassList(j[""+_]);J!==""&&W([w],J.split(" "))}else if(_==="style"){var Ce=w.getAttribute(_);Ce=d(Ce)?j[""+_]:Ce+j[""+_],w.setAttribute(_,Ce)}else w.setAttribute(_,j[""+_])}}l.updateHTMLAttributesToWrapper=$h;function ep(j){return!j||/^\s*$/.test(j)}l.isBlank=ep})(ne||(ne={}));var yv=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),xe=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},mv="e-control-wrapper e-numeric",ha="e-input-group-icon",pa="e-spin-up",Cv="e-spin-down",_s="e-error",Ni="increment",$i="decrement",Mv=new RegExp("^(-)?(\\d*)$"),bv=".",jv="e-numerictextbox",Iv="e-control",Zs="e-input-focus",Tv="e-numeric-hidden",Gs=["title","style","class"],Js=0,Yi=function(l){yv(t,l);function t(e,i){var r=l.call(this,e,i)||this;return r.preventChange=!1,r.isDynamicChange=!1,r.numericOptions=e,r}return t.prototype.preRender=function(){this.isPrevFocused=!1,this.decimalSeparator=".",this.intRegExp=new RegExp("/^(-)?(d*)$/"),this.isCalled=!1;var e=Z("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),G([this.cloneElement],[Iv,jv,"e-lib"]),this.angularTagName=null,this.formEle=ce(this.element,"form"),this.element.tagName==="EJS-NUMERICTEXTBOX"){this.angularTagName=this.element.tagName;var i=this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var o=this.element.attributes[r].nodeName;o!=="id"&&o!=="class"?(i.setAttribute(this.element.attributes[r].nodeName,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML):o==="class"&&i.setAttribute(o,this.element.className.split(" ").filter(function(n){return n.indexOf("ng-")!==0}).join(" "))}this.element.hasAttribute("name")&&this.element.removeAttribute("name"),this.element.classList.remove("e-control","e-numerictextbox"),this.element.appendChild(i),this.element=i,Ae("ej2_instances",e,this.element)}ge(this.element,{role:"spinbutton",tabindex:"0",autocomplete:"off"});var a={incrementTitle:"Increment value",decrementTitle:"Decrement value",placeholder:this.placeholder};this.l10n=new Mi("numerictextbox",a,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",Ve("numerictextbox")),this.isValidState=!0,this.inputStyle=null,this.inputName=null,this.cultureInfo={},this.initCultureInfo(),this.initCultureFunc(),this.prevValue=this.value,this.updateHTMLAttrToElement(),this.checkAttributes(!1),this.formEle&&(this.inputEleValue=this.value),this.validateMinMax(),this.validateStep(),this.placeholder===null&&this.updatePlaceholder()},t.prototype.render=function(){this.element.tagName.toLowerCase()==="input"&&(this.createWrapper(),this.showSpinButton&&this.spinBtnCreation(),this.setElementWidth(this.width),this.container.classList.contains("e-input-group")||this.container.classList.add("e-input-group"),this.changeValue(this.value===null||isNaN(this.value)?null:this.strictMode?this.trimValue(this.value):this.value),this.wireEvents(),this.value!==null&&!isNaN(this.value)&&this.decimals&&this.setProperties({value:this.roundNumber(this.value,this.decimals)},!0),(this.element.getAttribute("value")||this.value)&&(this.element.setAttribute("value",this.element.value),this.hiddenInput.setAttribute("value",this.hiddenInput.value)),this.elementPrevValue=this.element.value,this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),!this.element.hasAttribute("aria-labelledby")&&!this.element.hasAttribute("placeholder")&&!this.element.hasAttribute("aria-label")&&this.element.setAttribute("aria-label","numerictextbox"),!d(ce(this.element,"fieldset"))&&ce(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete())},t.prototype.checkAttributes=function(e){for(var i=e?d(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","step","disabled","readonly","style","name","placeholder"],r=0,o=i;r<o.length;r++){var a=o[r];if(!d(this.element.getAttribute(a)))switch(a){case"disabled":if(d(this.numericOptions)||this.numericOptions.enabled===void 0||e){var n=!(this.element.getAttribute(a)==="disabled"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true");this.setProperties({enabled:n},!e)}break;case"readonly":if(d(this.numericOptions)||this.numericOptions.readonly===void 0||e){var s=this.element.getAttribute(a)==="readonly"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true";this.setProperties({readonly:s},!e)}break;case"placeholder":(d(this.numericOptions)||this.numericOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.element.placeholder},!e);break;case"value":if(d(this.numericOptions)||this.numericOptions.value===void 0||e){var h=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));this.setProperties(Ae(a,h,{}),!e)}break;case"min":if(d(this.numericOptions)||this.numericOptions.min===void 0||e){var p=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));p!==null&&!isNaN(p)&&this.setProperties(Ae(a,p,{}),!e)}break;case"max":if(d(this.numericOptions)||this.numericOptions.max===void 0||e){var u=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));u!==null&&!isNaN(u)&&this.setProperties(Ae(a,u,{}),!e)}break;case"step":if(d(this.numericOptions)||this.numericOptions.step===void 0||e){var c=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));c!==null&&!isNaN(c)&&this.setProperties(Ae(a,c,{}),!e)}break;case"style":this.inputStyle=this.element.getAttribute(a);break;case"name":this.inputName=this.element.getAttribute(a);break;default:{var f=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(a));(f!==null&&!isNaN(f)||a==="value")&&this.setProperties(Ae(a,f,{}),!0)}break}}},t.prototype.updatePlaceholder=function(){this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0)},t.prototype.initCultureFunc=function(){this.instance=new Mo(this.locale)},t.prototype.initCultureInfo=function(){this.cultureInfo.format=this.format,Z("currency",this)!==null&&(Ae("currency",this.currency,this.cultureInfo),this.setProperties({currencyCode:this.currency},!0))},t.prototype.createWrapper=function(){var e=this.cssClass;!d(this.cssClass)&&this.cssClass!==""&&(e=this.getNumericValidClassList(this.cssClass));var i=ne.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:e,enableRtl:this.enableRtl,showClearButton:this.showClearButton,enabled:this.enabled}},this.createElement);this.inputWrapper=i,this.container=i.container,this.container.setAttribute("class",mv+" "+this.container.getAttribute("class")),this.updateHTMLAttrToWrapper(),this.readonly&&ge(this.element,{"aria-readonly":"true"}),this.hiddenInput=this.createElement("input",{attrs:{type:"text",validateHidden:"true","aria-label":"hidden",class:Tv}}),this.inputName=this.inputName!==null?this.inputName:this.element.id,this.element.removeAttribute("name"),this.isAngular&&this.angularTagName==="EJS-NUMERICTEXTBOX"&&this.cloneElement.id.length>0?ge(this.hiddenInput,{name:this.cloneElement.id}):ge(this.hiddenInput,{name:this.inputName}),this.container.insertBefore(this.hiddenInput,this.container.childNodes[1]),this.updateDataAttribute(!1),this.inputStyle!==null&&ge(this.container,{style:this.inputStyle})},t.prototype.updateDataAttribute=function(e){var i={};if(e)i=this.htmlAttributes;else for(var r=0;r<this.element.attributes.length;r++)i[this.element.attributes[r].name]=this.element.getAttribute(this.element.attributes[r].name);for(var o=0,a=Object.keys(i);o<a.length;o++){var n=a[o];n.indexOf("data")===0&&this.hiddenInput.setAttribute(n,i[""+n])}},t.prototype.updateHTMLAttrToElement=function(){if(!d(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];Gs.indexOf(r)<0&&this.element.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.updateCssClass=function(e,i){ne.setCssClass(this.getNumericValidClassList(e),[this.container],this.getNumericValidClassList(i))},t.prototype.getNumericValidClassList=function(e){var i=e;return!d(e)&&e!==""&&(i=e.replace(/\s+/g," ").trim()),i},t.prototype.updateHTMLAttrToWrapper=function(){if(!d(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(Gs.indexOf(r)>-1)if(r==="class"){var o=this.getNumericValidClassList(this.htmlAttributes[""+r]);o!==""&&W([this.container],o.split(" "))}else if(r==="style"){var a=this.container.getAttribute(r);a=d(a)?this.htmlAttributes[""+r]:a+this.htmlAttributes[""+r],this.container.setAttribute(r,a)}else this.container.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.setElementWidth=function(e){d(e)||(typeof e=="number"?this.container.style.width=ee(e):typeof e=="string"&&(this.container.style.width=e.match(/px|%|em/)?e:ee(e)))},t.prototype.spinBtnCreation=function(){this.spinDown=ne.appendSpan(ha+" "+Cv,this.container,this.createElement),ge(this.spinDown,{title:this.l10n.getConstant("decrementTitle")}),this.spinUp=ne.appendSpan(ha+" "+pa,this.container,this.createElement),ge(this.spinUp,{title:this.l10n.getConstant("incrementTitle")}),this.wireSpinBtnEvents()},t.prototype.validateMinMax=function(){typeof this.min=="number"&&!isNaN(this.min)||this.setProperties({min:-Number.MAX_VALUE},!0),typeof this.max=="number"&&!isNaN(this.max)||this.setProperties({max:Number.MAX_VALUE},!0),this.decimals!==null&&(this.min!==-Number.MAX_VALUE&&this.setProperties({min:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.min))},!0),this.max!==Number.MAX_VALUE&&this.setProperties({max:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.max))},!0)),this.setProperties({min:this.min>this.max?this.max:this.min},!0),this.min!==-Number.MAX_VALUE&&ge(this.element,{"aria-valuemin":this.min.toString()}),this.max!==Number.MAX_VALUE&&ge(this.element,{"aria-valuemax":this.max.toString()})},t.prototype.formattedValue=function(e,i){return this.instance.getNumberFormat({maximumFractionDigits:e,minimumFractionDigits:e,useGrouping:!1})(i)},t.prototype.validateStep=function(){this.decimals!==null&&this.setProperties({step:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.step))},!0)},t.prototype.action=function(e,i){this.isInteract=!0;var r=this.isFocused?this.instance.getNumberParser({format:"n"})(this.element.value):this.value;this.changeValue(this.performAction(r,this.step,e)),this.raiseChangeEvent(i)},t.prototype.checkErrorClass=function(){this.isValidState?G([this.container],_s):W([this.container],_s),ge(this.element,{"aria-invalid":this.isValidState?"false":"true"})},t.prototype.bindClearEvent=function(){this.showClearButton&&b.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},t.prototype.resetHandler=function(e){e.preventDefault(),(!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")||this.inputWrapper.container.classList.contains("e-static-clear"))&&this.clear(e),this.isInteract=!0,this.raiseChangeEvent(e)},t.prototype.clear=function(e){this.setProperties({value:null},!0),this.setElementValue(""),this.hiddenInput.value="";var i=ce(this.element,"form");if(i){var r=this.element.nextElementSibling,o=document.createEvent("KeyboardEvent");o.initEvent("keyup",!1,!0),r.dispatchEvent(o)}},t.prototype.resetFormHandler=function(){this.element.tagName==="EJS-NUMERICTEXTBOX"?this.updateValue(null):this.updateValue(this.inputEleValue)},t.prototype.setSpinButton=function(){d(this.spinDown)||ge(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),d(this.spinUp)||ge(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")})},t.prototype.wireEvents=function(){b.add(this.element,"focus",this.focusHandler,this),b.add(this.element,"blur",this.focusOutHandler,this),b.add(this.element,"keydown",this.keyDownHandler,this),b.add(this.element,"keyup",this.keyUpHandler,this),b.add(this.element,"input",this.inputHandler,this),b.add(this.element,"keypress",this.keyPressHandler,this),b.add(this.element,"change",this.changeHandler,this),b.add(this.element,"paste",this.pasteHandler,this),this.enabled&&(this.bindClearEvent(),this.formEle&&b.add(this.formEle,"reset",this.resetFormHandler,this))},t.prototype.wireSpinBtnEvents=function(){b.add(this.spinUp,S.touchStartEvent,this.mouseDownOnSpinner,this),b.add(this.spinDown,S.touchStartEvent,this.mouseDownOnSpinner,this),b.add(this.spinUp,S.touchEndEvent,this.mouseUpOnSpinner,this),b.add(this.spinDown,S.touchEndEvent,this.mouseUpOnSpinner,this),b.add(this.spinUp,S.touchMoveEvent,this.touchMoveOnSpinner,this),b.add(this.spinDown,S.touchMoveEvent,this.touchMoveOnSpinner,this)},t.prototype.unwireEvents=function(){b.remove(this.element,"focus",this.focusHandler),b.remove(this.element,"blur",this.focusOutHandler),b.remove(this.element,"keyup",this.keyUpHandler),b.remove(this.element,"input",this.inputHandler),b.remove(this.element,"keydown",this.keyDownHandler),b.remove(this.element,"keypress",this.keyPressHandler),b.remove(this.element,"change",this.changeHandler),b.remove(this.element,"paste",this.pasteHandler),this.formEle&&b.remove(this.formEle,"reset",this.resetFormHandler)},t.prototype.unwireSpinBtnEvents=function(){b.remove(this.spinUp,S.touchStartEvent,this.mouseDownOnSpinner),b.remove(this.spinDown,S.touchStartEvent,this.mouseDownOnSpinner),b.remove(this.spinUp,S.touchEndEvent,this.mouseUpOnSpinner),b.remove(this.spinDown,S.touchEndEvent,this.mouseUpOnSpinner),b.remove(this.spinUp,S.touchMoveEvent,this.touchMoveOnSpinner),b.remove(this.spinDown,S.touchMoveEvent,this.touchMoveOnSpinner)},t.prototype.changeHandler=function(e){e.stopPropagation(),this.element.value.length||this.setProperties({value:null},!0);var i=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(i,e)},t.prototype.raiseChangeEvent=function(e){if(this.inputValue=d(this.inputValue)||isNaN(this.inputValue)?null:this.inputValue,this.prevValue!==this.value||this.prevValue!==this.inputValue){var i={};this.changeEventArgs={value:this.value,previousValue:this.prevValue,isInteracted:this.isInteract,isInteraction:this.isInteract,event:e},e&&(this.changeEventArgs.event=e),this.changeEventArgs.event===void 0&&(this.changeEventArgs.isInteracted=!1,this.changeEventArgs.isInteraction=!1),mi(i,this.changeEventArgs),this.prevValue=this.value,this.isInteract=!1,this.elementPrevValue=this.element.value,this.preventChange=!1,this.trigger("change",i)}},t.prototype.pasteHandler=function(){var e=this;if(!(!this.enabled||this.readonly)){var i=this.element.value;setTimeout(function(){e.numericRegex().test(e.element.value)||e.setElementValue(i)})}},t.prototype.preventHandler=function(){var e=this,i=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);setTimeout(function(){if(e.element.selectionStart>0){var r=e.element.selectionStart,o=e.element.selectionStart-1,a=0,n=e.element.value.split(""),s=Gi(e.locale),h=Z("decimal",s),p=h.charCodeAt(0);e.element.value[o]===" "&&e.element.selectionStart>0&&!i?(d(e.prevVal)?e.element.value=e.element.value.trim():o!==0?e.element.value=e.prevVal:o===0&&(e.element.value=e.element.value.trim()),e.element.setSelectionRange(o,o)):isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&e.element.value[e.element.selectionStart-1].charCodeAt(0)!==45?(n.indexOf(e.element.value[e.element.selectionStart-1])!==n.lastIndexOf(e.element.value[e.element.selectionStart-1])&&e.element.value[e.element.selectionStart-1].charCodeAt(0)===p||e.element.value[e.element.selectionStart-1].charCodeAt(0)!==p)&&(e.element.value=e.element.value.substring(0,o)+e.element.value.substring(r,e.element.value.length),e.element.setSelectionRange(o,o),isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&e.element.selectionStart>0&&e.element.value.length&&e.preventHandler()):isNaN(parseFloat(e.element.value[e.element.selectionStart-2]))&&e.element.selectionStart>1&&e.element.value[e.element.selectionStart-2].charCodeAt(0)!==45&&(n.indexOf(e.element.value[e.element.selectionStart-2])!==n.lastIndexOf(e.element.value[e.element.selectionStart-2])&&e.element.value[e.element.selectionStart-2].charCodeAt(0)===p||e.element.value[e.element.selectionStart-2].charCodeAt(0)!==p)&&(e.element.setSelectionRange(o,o),e.nextEle=e.element.value[e.element.selectionStart],e.cursorPosChanged=!0,e.preventHandler()),e.cursorPosChanged===!0&&e.element.value[e.element.selectionStart]===e.nextEle&&isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&(e.element.setSelectionRange(e.element.selectionStart+1,e.element.selectionStart+1),e.cursorPosChanged=!1,e.nextEle=null),e.element.value.trim()===""&&e.element.setSelectionRange(a,a),e.element.selectionStart>0&&(e.element.value[e.element.selectionStart-1].charCodeAt(0)===45&&e.element.selectionStart>1&&(d(e.prevVal)||(e.element.value=e.prevVal),e.element.setSelectionRange(e.element.selectionStart,e.element.selectionStart)),e.element.value[e.element.selectionStart-1]===h&&e.decimals===0&&e.validateDecimalOnType&&(e.element.value=e.element.value.substring(0,o)+e.element.value.substring(r,e.element.value.length))),e.prevVal=e.element.value}})},t.prototype.keyUpHandler=function(){if(!(!this.enabled||this.readonly)){var e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);!e&&S.isDevice&&this.preventHandler();var i=this.instance.getNumberParser({format:"n"})(this.element.value);i=i===null||isNaN(i)?null:i,this.hiddenInput.value=i||i===0?i.toString():null;var r=ce(this.element,"form");if(r){var o=this.element.nextElementSibling,a=document.createEvent("KeyboardEvent");a.initEvent("keyup",!1,!0),o.dispatchEvent(a)}}},t.prototype.inputHandler=function(e){var i=this;if(!(!this.enabled||this.readonly)){var r=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),o=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if((o||r)&&S.isDevice&&this.preventHandler(),this.isAngular&&this.element.value!==Z("decimal",Gi(this.locale))&&this.element.value!==Z("minusSign",Gi(this.locale))){var a=this.instance.getNumberParser({format:"n"})(this.element.value);a=isNaN(a)?null:a,i.localChange({value:a}),this.preventChange=!0}if(this.isVue){var n=this.instance.getNumberParser({format:"n"})(this.element.value),s=this.instance.getNumberParser({format:"n"})(this.elementPrevValue),h=new RegExp("[^0-9]+$");(h.test(this.element.value)||(this.elementPrevValue.indexOf(".")!==-1||this.elementPrevValue.indexOf("-")!==-1)&&this.element.value[this.element.value.length-1]==="0")&&(n=this.value);var p={event:e,value:n===null||isNaN(n)?null:n,previousValue:s===null||isNaN(s)?null:s};this.preventChange=!0,this.elementPrevValue=this.element.value,this.trigger("input",p)}}},t.prototype.keyDownHandler=function(e){if(!this.readonly)switch(e.keyCode){case 38:e.preventDefault(),this.action(Ni,e);break;case 40:e.preventDefault(),this.action($i,e);break}},t.prototype.performAction=function(e,i,r){(e===null||isNaN(e))&&(e=0);var o=r===Ni?e+i:e-i;return o=this.correctRounding(e,i,o),this.strictMode?this.trimValue(o):o},t.prototype.correctRounding=function(e,i,r){var o=new RegExp("[,.](.*)"),a=o.test(e.toString()),n=o.test(i.toString());if(a||n){var s=a?o.exec(e.toString())[0].length:0,h=n?o.exec(i.toString())[0].length:0,p=Math.max(s,h);return e=this.roundValue(r,p)}return r},t.prototype.roundValue=function(e,i){i=i||0;var r=Math.pow(10,i);return e*=r,e=Math.round(e)/r},t.prototype.updateValue=function(e,i){i&&(this.isInteract=!0),e!==null&&!isNaN(e)&&this.decimals&&(e=this.roundNumber(e,this.decimals)),this.inputValue=e,this.isVue&&this.element&&this.element.hasAttribute("modelvalue")&&this.isDynamicChange||this.changeValue(e===null||isNaN(e)?null:this.strictMode?this.trimValue(e):e),this.isDynamicChange||this.raiseChangeEvent(i)},t.prototype.updateCurrency=function(e,i){Ae(e,i,this.cultureInfo),this.updateValue(this.value)},t.prototype.changeValue=function(e){if(!(e||e===0))e=null,this.setProperties({value:e},!0);else{var i=this.getNumberOfDecimals(e);this.setProperties({value:this.roundNumber(e,i)},!0)}this.modifyText(),this.strictMode||this.validateState()},t.prototype.modifyText=function(){if(this.value||this.value===0){var e=this.formatNumber(),i=this.isFocused?e:this.instance.getNumberFormat(this.cultureInfo)(this.value);this.setElementValue(i),ge(this.element,{"aria-valuenow":e}),d(this.hiddenInput)||(this.hiddenInput.value=this.value.toString(),this.value!==null&&this.serverDecimalSeparator&&(this.hiddenInput.value=this.hiddenInput.value.replace(".",this.serverDecimalSeparator)))}else this.setElementValue(""),this.element.removeAttribute("aria-valuenow"),this.hiddenInput.value=null},t.prototype.setElementValue=function(e,i){ne.setValue(e,i||this.element,this.floatLabelType,this.showClearButton)},t.prototype.validateState=function(){this.isValidState=!0,(this.value||this.value===0)&&(this.isValidState=!(this.value>this.max||this.value<this.min)),this.checkErrorClass()},t.prototype.getNumberOfDecimals=function(e){var i,r=new RegExp("[eE][-+]?([0-9]+)"),o=e.toString();if(r.test(o)){var a=r.exec(o);d(a)||(o=e.toFixed(Math.min(parseInt(a[1],10),20)))}var n=o.split(".")[1];return i=!n||!n.length?0:n.length,this.decimals!==null&&(i=i<this.decimals?i:this.decimals),i},t.prototype.formatNumber=function(){var e=this.getNumberOfDecimals(this.value);return this.instance.getNumberFormat({maximumFractionDigits:e,minimumFractionDigits:e,useGrouping:!1})(this.value)},t.prototype.trimValue=function(e){return e>this.max?this.max:e<this.min?this.min:e},t.prototype.roundNumber=function(e,i){var r=e,o=i||0,a=r.toString().split("e");r=Math.round(+(a[0]+"e"+(a[1]?Number(a[1])+o:o)));var n=r.toString().split("e");return r=+(n[0]+"e"+(n[1]?Number(n[1])-o:-o)),Number(r.toFixed(o))},t.prototype.cancelEvent=function(e){return e.preventDefault(),!1},t.prototype.keyPressHandler=function(e){if(!this.enabled||this.readonly)return!0;if(!S.isDevice&&S.info.version==="11.0"&&e.keyCode===13){var i=this.instance.getNumberParser({format:"n"})(this.element.value);return this.updateValue(i,e),!0}if(e.which===0||e.metaKey||e.ctrlKey||e.keyCode===8||e.keyCode===13)return!0;var r=String.fromCharCode(e.which),o=Z("decimal",Gi(this.locale)),a=e.code==="NumpadDecimal"&&r!==o;a&&(r=o);var n=this.element.value;if(n=n.substring(0,this.element.selectionStart)+r+n.substring(this.element.selectionEnd),this.numericRegex().test(n)){if(a){var s=this.element.selectionStart+1;this.element.value=n,this.element.setSelectionRange(s,s),e.preventDefault(),e.stopPropagation()}return!0}else return e.preventDefault(),e.stopPropagation(),!1},t.prototype.numericRegex=function(){var e=Gi(this.locale),i=Z("decimal",e),r="*";return i===bv&&(i="\\"+i),this.decimals===0&&this.validateDecimalOnType?Mv:(this.decimals&&this.validateDecimalOnType&&(r="{0,"+this.decimals+"}"),new RegExp("^\\s*(-)?(((\\d+("+i+"\\d"+r+")?)|("+i+"\\d"+r+")))?$"))},t.prototype.mouseWheel=function(e){e.preventDefault();var i,r=e;r.wheelDelta?i=r.wheelDelta/120:r.detail&&(i=-r.detail/3),i>0?this.action(Ni,e):i<0&&this.action($i,e),this.cancelEvent(e)},t.prototype.focusHandler=function(e){var i=this;if(clearTimeout(Js),this.focusEventArgs={event:e,value:this.value,container:this.container},this.trigger("focus",this.focusEventArgs),!(!this.enabled||this.readonly)){if(this.isFocused=!0,this.prevValue=this.value,this.value||this.value===0){var r=this.formatNumber();if(this.setElementValue(r),!this.isPrevFocused)if(!S.isDevice&&S.info.version==="11.0")this.element.setSelectionRange(0,r.length);else{var o=S.isDevice&&S.isIos?600:0;Js=setTimeout(function(){i.element.setSelectionRange(0,r.length)},o)}}S.isDevice||b.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this)}},t.prototype.focusOutHandler=function(e){var i=this;if(this.blurEventArgs={event:e,value:this.value,container:this.container},this.trigger("blur",this.blurEventArgs),!(!this.enabled||this.readonly)){if(this.isPrevFocused){if(e.preventDefault(),S.isDevice){var r=this.element.value;this.element.focus(),this.isPrevFocused=!1;var o=this.element;setTimeout(function(){i.setElementValue(r,o)},200)}}else{this.isFocused=!1,this.element.value.length||this.setProperties({value:null},!0);var a=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(a),S.isDevice||b.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)}var n=ce(this.element,"form");if(n){var s=this.element.nextElementSibling,h=document.createEvent("FocusEvent");h.initEvent("focusout",!1,!0),s.dispatchEvent(h)}}},t.prototype.mouseDownOnSpinner=function(e){var i=this;if(this.isFocused&&(this.isPrevFocused=!0,e.preventDefault()),!!this.getElementData(e)){this.getElementData(e);var r=e.currentTarget,o=r.classList.contains(pa)?Ni:$i;b.add(r,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval(function(){i.isCalled=!0,i.action(o,e)},150),b.add(document,"mouseup",this.mouseUpClick,this)}},t.prototype.touchMoveOnSpinner=function(e){var i;if(e.type==="touchmove"){var r=e.touches;i=r.length&&document.elementFromPoint(r[0].pageX,r[0].pageY)}else i=document.elementFromPoint(e.clientX,e.clientY);i.classList.contains(ha)||clearInterval(this.timeOut)},t.prototype.mouseUpOnSpinner=function(e){if(this.prevValue=this.value,this.isPrevFocused&&(this.element.focus(),S.isDevice||(this.isPrevFocused=!1)),S.isDevice||e.preventDefault(),!!this.getElementData(e)){var i=e.currentTarget,r=i.classList.contains(pa)?Ni:$i;b.remove(i,"mouseleave",this.mouseUpClick),this.isCalled||this.action(r,e),this.isCalled=!1,b.remove(document,"mouseup",this.mouseUpClick);var o=ce(this.element,"form");if(o){var a=this.element.nextElementSibling,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),a.dispatchEvent(n)}}},t.prototype.getElementData=function(e){return e.which&&e.which===3||e.button&&e.button===2||!this.enabled||this.readonly?!1:(clearInterval(this.timeOut),!0)},t.prototype.floatLabelTypeUpdate=function(){ne.removeFloating(this.inputWrapper);var e=this.hiddenInput;this.hiddenInput.remove(),ne.addFloating(this.element,this.floatLabelType,this.placeholder,this.createElement),this.container.insertBefore(e,this.container.childNodes[1])},t.prototype.mouseUpClick=function(e){e.stopPropagation(),clearInterval(this.timeOut),this.isCalled=!1,this.spinUp&&b.remove(this.spinUp,"mouseleave",this.mouseUpClick),this.spinDown&&b.remove(this.spinDown,"mouseleave",this.mouseUpClick)},t.prototype.increment=function(e){e===void 0&&(e=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,e,Ni)),this.raiseChangeEvent()},t.prototype.decrement=function(e){e===void 0&&(e=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,e,$i)),this.raiseChangeEvent()},t.prototype.destroy=function(){this.unwireEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),X(this.hiddenInput),this.showSpinButton&&(this.unwireSpinBtnEvents(),X(this.spinUp),X(this.spinDown));for(var e=["aria-labelledby","role","autocomplete","aria-readonly","aria-disabled","autocapitalize","spellcheck","aria-autocomplete","tabindex","aria-valuemin","aria-valuemax","aria-valuenow","aria-invalid"],i=0;i<e.length;i++)this.element.removeAttribute(e[i]);this.element.classList.remove("e-input"),this.container.insertAdjacentElement("afterend",this.element),X(this.container),this.spinUp=null,this.spinDown=null,this.container=null,this.hiddenInput=null,this.changeEventArgs=null,this.blurEventArgs=null,this.focusEventArgs=null,this.inputWrapper=null,ne.destroy({element:this.element,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),l.prototype.destroy.call(this)},t.prototype.getText=function(){return this.element.value},t.prototype.focusIn=function(){document.activeElement!==this.element&&this.enabled&&(this.element.focus(),W([this.container],[Zs]))},t.prototype.focusOut=function(){document.activeElement===this.element&&this.enabled&&(this.element.blur(),G([this.container],[Zs]))},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.onPropertyChanged=function(e,i){for(var r=0,o=Object.keys(e);r<o.length;r++){var a=o[r];switch(a){case"width":this.setElementWidth(e.width),ne.calculateWidth(this.element,this.container);break;case"cssClass":this.updateCssClass(e.cssClass,i.cssClass);break;case"enabled":ne.setEnabled(e.enabled,this.element),this.bindClearEvent();break;case"enableRtl":ne.setEnableRtl(e.enableRtl,[this.container]);break;case"readonly":ne.setReadonly(e.readonly,this.element),this.readonly?ge(this.element,{"aria-readonly":"true"}):this.element.removeAttribute("aria-readonly");break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.updateDataAttribute(!0),this.checkAttributes(!0),ne.validateInputType(this.container,this.element);break;case"placeholder":ne.setPlaceholder(e.placeholder,this.element),ne.calculateWidth(this.element,this.container);break;case"step":this.step=e.step,this.validateStep();break;case"showSpinButton":this.updateSpinButton(e);break;case"showClearButton":this.updateClearButton(e);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,this.floatLabelTypeUpdate();break;case"value":this.isDynamicChange=(this.isAngular||this.isVue)&&this.preventChange,this.updateValue(e.value),this.isDynamicChange&&(this.preventChange=!1,this.isDynamicChange=!1);break;case"min":case"max":Ae(a,Z(a,e),this),this.validateMinMax(),this.updateValue(this.value);break;case"strictMode":this.strictMode=e.strictMode,this.updateValue(this.value),this.validateState();break;case"locale":this.initCultureFunc(),this.l10n.setLocale(this.locale),this.setSpinButton(),this.updatePlaceholder(),ne.setPlaceholder(this.placeholder,this.element),this.updateValue(this.value);break;case"currency":{var n=Z(a,e);this.setProperties({currencyCode:n},!0),this.updateCurrency(a,n)}break;case"currencyCode":{var s=Z(a,e);this.setProperties({currency:s},!0),this.updateCurrency("currency",s)}break;case"format":Ae(a,Z(a,e),this),this.initCultureInfo(),this.updateValue(this.value);break;case"decimals":this.decimals=e.decimals,this.updateValue(this.value)}}},t.prototype.updateClearButton=function(e){ne.setClearButton(e.showClearButton,this.element,this.inputWrapper,void 0,this.createElement),this.bindClearEvent()},t.prototype.updateSpinButton=function(e){e.showSpinButton?this.spinBtnCreation():(X(this.spinUp),X(this.spinDown))},t.prototype.getModuleName=function(){return"numerictextbox"},xe([T("")],t.prototype,"cssClass",void 0),xe([T(null)],t.prototype,"value",void 0),xe([T(-Number.MAX_VALUE)],t.prototype,"min",void 0),xe([T(Number.MAX_VALUE)],t.prototype,"max",void 0),xe([T(1)],t.prototype,"step",void 0),xe([T(null)],t.prototype,"width",void 0),xe([T(null)],t.prototype,"placeholder",void 0),xe([T({})],t.prototype,"htmlAttributes",void 0),xe([T(!0)],t.prototype,"showSpinButton",void 0),xe([T(!1)],t.prototype,"readonly",void 0),xe([T(!0)],t.prototype,"enabled",void 0),xe([T(!1)],t.prototype,"showClearButton",void 0),xe([T(!1)],t.prototype,"enablePersistence",void 0),xe([T("n2")],t.prototype,"format",void 0),xe([T(null)],t.prototype,"decimals",void 0),xe([T(null)],t.prototype,"currency",void 0),xe([T(null)],t.prototype,"currencyCode",void 0),xe([T(!0)],t.prototype,"strictMode",void 0),xe([T(!1)],t.prototype,"validateDecimalOnType",void 0),xe([T("Never")],t.prototype,"floatLabelType",void 0),xe([Y()],t.prototype,"created",void 0),xe([Y()],t.prototype,"destroyed",void 0),xe([Y()],t.prototype,"change",void 0),xe([Y()],t.prototype,"focus",void 0),xe([Y()],t.prototype,"blur",void 0),t=xe([Qe],t),t}(ct),Lr=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),fe=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},Sv=function(l){Lr(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return fe([T("None")],t.prototype,"placement",void 0),fe([T(10)],t.prototype,"largeStep",void 0),fe([T(1)],t.prototype,"smallStep",void 0),fe([T(!1)],t.prototype,"showSmallTicks",void 0),fe([T(null)],t.prototype,"format",void 0),t}(Be),Nv=function(l){Lr(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return fe([T(null)],t.prototype,"color",void 0),fe([T(null)],t.prototype,"start",void 0),fe([T(null)],t.prototype,"end",void 0),t}(Be),Dv=function(l){Lr(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return fe([T(!1)],t.prototype,"enabled",void 0),fe([T(null)],t.prototype,"minStart",void 0),fe([T(null)],t.prototype,"minEnd",void 0),fe([T(null)],t.prototype,"maxStart",void 0),fe([T(null)],t.prototype,"maxEnd",void 0),fe([T(!1)],t.prototype,"startHandleFixed",void 0),fe([T(!1)],t.prototype,"endHandleFixed",void 0),t}(Be),wv=function(l){Lr(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return fe([T("")],t.prototype,"cssClass",void 0),fe([T("Before")],t.prototype,"placement",void 0),fe([T("Focus")],t.prototype,"showOn",void 0),fe([T(!1)],t.prototype,"isVisible",void 0),fe([T(null)],t.prototype,"format",void 0),t}(Be),Ov=6,xv=3,Jt=1e-10,z={root:"e-slider",rtl:"e-rtl",sliderHiddenInput:"e-slider-input",controlWrapper:"e-control-wrapper",sliderHandle:"e-handle",rangeBar:"e-range",sliderButton:"e-slider-button",firstButton:"e-first-button",secondButton:"e-second-button",scale:"e-scale",tick:"e-tick",large:"e-large",tickValue:"e-tick-value",sliderTooltip:"e-slider-tooltip",sliderHover:"e-slider-hover",sliderFirstHandle:"e-handle-first",sliderSecondHandle:"e-handle-second",sliderDisabled:"e-disabled",sliderContainer:"e-slider-container",horizontalTooltipBefore:"e-slider-horizontal-before",horizontalTooltipAfter:"e-slider-horizontal-after",verticalTooltipBefore:"e-slider-vertical-before",verticalTooltipAfter:"e-slider-vertical-after",materialTooltip:"e-material-tooltip",materialTooltipOpen:"e-material-tooltip-open",materialTooltipActive:"e-tooltip-active",materialSlider:"e-material-slider",sliderTrack:"e-slider-track",sliderHorizantalColor:"e-slider-horizantal-color",sliderVerticalColor:"e-slider-vertical-color",sliderHandleFocused:"e-handle-focused",verticalSlider:"e-vertical",horizontalSlider:"e-horizontal",sliderHandleStart:"e-handle-start",sliderTooltipStart:"e-material-tooltip-start",sliderTabHandle:"e-tab-handle",sliderButtonIcon:"e-button-icon",sliderSmallSize:"e-small-size",sliderTickPosition:"e-tick-pos",sliderFirstTick:"e-first-tick",sliderLastTick:"e-last-tick",sliderButtonClass:"e-slider-btn",sliderTooltipWrapper:"e-tooltip-wrap",sliderTabTrack:"e-tab-track",sliderTabRange:"e-tab-range",sliderActiveHandle:"e-handle-active",sliderMaterialHandle:"e-material-handle",sliderMaterialRange:"e-material-range",sliderMaterialDefault:"e-material-default",materialTooltipShow:"e-material-tooltip-show",materialTooltipHide:"e-material-tooltip-hide",readonly:"e-read-only",limits:"e-limits",limitBarDefault:"e-limit-bar",limitBarFirst:"e-limit-first",limitBarSecond:"e-limit-second",dragHorizontal:"e-drag-horizontal",dragVertical:"e-drag-vertical"},Mr=function(l){Lr(t,l);function t(e,i){var r=l.call(this,e,i)||this;return r.horDir="left",r.verDir="bottom",r.transition={handle:"left .4s cubic-bezier(.25, .8, .25, 1), right .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1) , bottom .4s cubic-bezier(.25, .8, .25, 1)",rangeBar:"all .4s cubic-bezier(.25, .8, .25, 1)"},r.transitionOnMaterialTooltip={handle:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, top 1ms ease-out",rangeBar:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, width 1ms ease-out, height 1ms ease-out"},r.scaleTransform="transform .4s cubic-bezier(.25, .8, .25, 1)",r.customAriaText=null,r.drag=!0,r.isDragComplete=!1,r.initialTooltip=!0,r}return t.prototype.preRender=function(){var e={incrementTitle:"Increase",decrementTitle:"Decrease"};this.l10n=new Mi("slider",e,this.locale),this.isElementFocused=!1,this.tickElementCollection=[],this.tooltipFormatInfo={},this.ticksFormatInfo={},this.initCultureInfo(),this.initCultureFunc(),this.formChecker()},t.prototype.formChecker=function(){var e=ce(this.element,"form");e?(this.isForm=!0,d(this.formResetValue)||this.setProperties({value:this.formResetValue},!0),this.formResetValue=this.value,this.type==="Range"&&(d(this.formResetValue)||typeof this.formResetValue!="object")?this.formResetValue=[parseFloat(ee(this.min)),parseFloat(ee(this.max))]:d(this.formResetValue)&&(this.formResetValue=parseFloat(ee(this.min))),this.formElement=e):this.isForm=!1},t.prototype.initCultureFunc=function(){this.internationalization=new Mo(this.locale)},t.prototype.initCultureInfo=function(){this.tooltipFormatInfo.format=d(this.tooltip.format)?null:this.tooltip.format,this.ticksFormatInfo.format=d(this.ticks.format)?null:this.ticks.format},t.prototype.formatString=function(e,i){var r=null,o=null;if(e||e===0){r=this.formatNumber(e);var a=this.numberOfDecimals(e);o=this.internationalization.getNumberFormat(i)(this.makeRoundNumber(e,a))}return{elementVal:r,formatString:o}},t.prototype.formatNumber=function(e){var i=this.numberOfDecimals(e);return this.internationalization.getNumberFormat({maximumFractionDigits:i,minimumFractionDigits:i,useGrouping:!1})(e)},t.prototype.numberOfDecimals=function(e){var i=e.toString().split(".")[1],r=!i||!i.length?0:i.length;return r},t.prototype.makeRoundNumber=function(e,i){var r=i||0;return Number(e.toFixed(r))},t.prototype.render=function(){var e=this;this.initialize(),this.initRender(),this.wireEvents(),this.setZindex(),this.renderComplete(),this.element.tagName==="EJS-SLIDER"&&this.getTheme(this.sliderContainer)==="none"&&setTimeout(function(){e.refresh()},0)},t.prototype.initialize=function(){W([this.element],z.root),this.setCSSClass()},t.prototype.setElementWidth=function(e){!d(e)&&!d(this.sliderContainer)&&(typeof e=="number"?this.sliderContainer.style.width=ee(e):typeof e=="string"&&(this.sliderContainer.style.width=e.match(/px|%|em/)?e:ee(e)))},t.prototype.setCSSClass=function(e){e&&G([this.element],e.split(" ")),this.cssClass&&W([this.element],this.cssClass.split(" "))},t.prototype.setEnabled=function(){this.enabled?(G([this.sliderContainer],[z.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.remove(z.sliderDisabled),this.wireEvents()):(W([this.sliderContainer],[z.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.add(z.sliderDisabled),this.unwireEvents())},t.prototype.getTheme=function(e){var i=window.getComputedStyle(e,":after").getPropertyValue("content");return i.replace(/['"]+/g,"")},t.prototype.initRender=function(){this.sliderContainer=this.createElement("div",{className:z.sliderContainer+" "+z.controlWrapper}),this.element.parentNode.insertBefore(this.sliderContainer,this.element),this.sliderContainer.appendChild(this.element),this.sliderTrack=this.createElement("div",{className:z.sliderTrack}),this.element.appendChild(this.sliderTrack),this.setElementWidth(this.width),this.element.tabIndex=-1,this.getThemeInitialization(),this.setHandler(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setOrientClass(),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",value:d(this.value)?d(this.min)?"0":this.min.toString():this.value.toString(),name:this.element.getAttribute("name")||this.element.getAttribute("id")||"_"+(Math.random()*1e3).toFixed(0)+"slider",class:z.sliderHiddenInput}}),this.hiddenInput.tabIndex=-1,this.sliderContainer.appendChild(this.hiddenInput),this.showButtons&&this.setButtons(),this.setEnableRTL(),this.type==="Range"?this.rangeValueUpdate():this.value=d(this.value)?d(this.min)?0:parseFloat(ee(this.min.toString())):this.value,this.previousVal=this.type!=="Range"?this.checkHandleValue(parseFloat(ee(this.value.toString()))):[this.checkHandleValue(parseFloat(ee(this.value[0].toString()))),this.checkHandleValue(parseFloat(ee(this.value[1].toString())))],this.previousChanged=this.previousVal,d(this.element.hasAttribute("name"))||this.element.removeAttribute("name"),this.setValue(),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.renderScale(),this.tooltip.isVisible&&this.renderTooltip(),this.enabled?G([this.sliderContainer],[z.sliderDisabled]):W([this.sliderContainer],[z.sliderDisabled]),this.readonly?W([this.sliderContainer],[z.readonly]):G([this.sliderContainer],[z.readonly])},t.prototype.getThemeInitialization=function(){this.isMaterial=this.getTheme(this.sliderContainer)==="material"||this.getTheme(this.sliderContainer)==="material-dark",this.isMaterial3=this.getTheme(this.sliderContainer)==="Material3"||this.getTheme(this.sliderContainer)==="Material3-dark",this.isBootstrap=this.getTheme(this.sliderContainer)==="bootstrap"||this.getTheme(this.sliderContainer)==="bootstrap-dark",this.isBootstrap4=this.getTheme(this.sliderContainer)==="bootstrap4",this.isTailwind=this.getTheme(this.sliderContainer)==="tailwind"||this.getTheme(this.sliderContainer)==="tailwind-dark",this.isTailwind3=this.getTheme(this.sliderContainer)==="tailwind3"||this.getTheme(this.sliderContainer)==="tailwind3-dark",this.isBootstrap5=this.getTheme(this.sliderContainer)==="bootstrap5",this.isFluent=this.getTheme(this.sliderContainer)==="FluentUI",this.isFluent2=this.getTheme(this.sliderContainer)==="fluent2",this.isBootstrap5Dot3=this.getTheme(this.sliderContainer)==="bootstrap5.3",this.isMaterialTooltip=(this.isMaterial||this.isMaterial3)&&this.type!=="Range"&&this.tooltip.isVisible},t.prototype.createRangeBar=function(){this.type!=="Default"&&(this.rangeBar=this.createElement("div",{attrs:{class:z.rangeBar}}),this.element.appendChild(this.rangeBar),this.drag&&this.type==="Range"&&(this.orientation==="Horizontal"?this.rangeBar.classList.add(z.dragHorizontal):this.rangeBar.classList.add(z.dragVertical)))},t.prototype.createLimitBar=function(){var e=this.type!=="Range"?z.limitBarDefault:z.limitBarFirst;e+=" "+z.limits,this.limitBarFirst=this.createElement("div",{attrs:{class:e}}),this.element.appendChild(this.limitBarFirst),this.type==="Range"&&(this.limitBarSecond=this.createElement("div",{attrs:{class:z.limitBarSecond+" "+z.limits}}),this.element.appendChild(this.limitBarSecond))},t.prototype.setOrientClass=function(){this.orientation!=="Vertical"?(this.sliderContainer.classList.remove(z.verticalSlider),this.sliderContainer.classList.add(z.horizontalSlider),this.firstHandle.setAttribute("aria-orientation","horizontal"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","horizontal")):(this.sliderContainer.classList.remove(z.horizontalSlider),this.sliderContainer.classList.add(z.verticalSlider),this.firstHandle.setAttribute("aria-orientation","vertical"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","vertical"))},t.prototype.setAriaAttributes=function(e){var i=this,r=this.min,o=this.max;if(!d(this.customValues)&&this.customValues.length>0&&(r=this.customValues[0],o=this.customValues[this.customValues.length-1]),this.type!=="Range")ge(e,{"aria-valuemin":d(r)?"0":r.toString(),"aria-valuemax":d(o)?"100":o.toString()});else{var a=!d(this.customValues)&&this.customValues.length>0?[[r.toString(),this.customValues[this.value[1]].toString()],[this.customValues[this.value[0]].toString(),o.toString()]]:[[r.toString(),this.value[1].toString()],[this.value[0].toString(),o.toString()]];a.forEach(function(n,s){var h=s===0?i.firstHandle:i.secondHandle;h&&ge(h,{"aria-valuemin":n[0],"aria-valuemax":n[1]})})}},t.prototype.createSecondHandle=function(){this.secondHandle=this.createElement("div",{attrs:{class:z.sliderHandle,role:"slider",tabIndex:"0","aria-label":"slider"}}),this.secondHandle.classList.add(z.sliderSecondHandle),this.element.appendChild(this.secondHandle)},t.prototype.createFirstHandle=function(){this.firstHandle=this.createElement("div",{attrs:{class:z.sliderHandle,role:"slider",tabIndex:"0","aria-label":"slider"}}),this.firstHandle.classList.add(z.sliderFirstHandle),this.element.appendChild(this.firstHandle),this.isMaterialTooltip&&(this.materialHandle=this.createElement("div",{attrs:{class:z.sliderHandle+" "+z.sliderMaterialHandle}}),this.element.appendChild(this.materialHandle))},t.prototype.wireFirstHandleEvt=function(e){e?(b.remove(this.firstHandle,"mousedown touchstart",this.handleFocus),b.remove(this.firstHandle,"transitionend",this.transitionEnd),b.remove(this.firstHandle,"mouseenter touchenter",this.handleOver),b.remove(this.firstHandle,"mouseleave touchend",this.handleLeave)):(b.add(this.firstHandle,"mousedown touchstart",this.handleFocus,this),b.add(this.firstHandle,"transitionend",this.transitionEnd,this),b.add(this.firstHandle,"mouseenter touchenter",this.handleOver,this),b.add(this.firstHandle,"mouseleave touchend",this.handleLeave,this))},t.prototype.wireSecondHandleEvt=function(e){e?(b.remove(this.secondHandle,"mousedown touchstart",this.handleFocus),b.remove(this.secondHandle,"transitionend",this.transitionEnd),b.remove(this.secondHandle,"mouseenter touchenter",this.handleOver),b.remove(this.secondHandle,"mouseleave touchend",this.handleLeave)):(b.add(this.secondHandle,"mousedown touchstart",this.handleFocus,this),b.add(this.secondHandle,"transitionend",this.transitionEnd,this),b.add(this.secondHandle,"mouseenter touchenter",this.handleOver,this),b.add(this.secondHandle,"mouseleave touchend",this.handleLeave,this))},t.prototype.handleStart=function(){this.type!=="Range"&&(this.firstHandle.classList[this.handlePos1===0?"add":"remove"](z.sliderHandleStart),this.isMaterialTooltip&&(this.materialHandle.classList[this.handlePos1===0?"add":"remove"](z.sliderHandleStart),this.tooltipElement&&this.tooltipElement.classList[this.handlePos1===0?"add":"remove"](z.sliderTooltipStart)))},t.prototype.transitionEnd=function(e){e.propertyName!=="transform"&&(this.handleStart(),this.enableAnimation||(this.getHandle().style.transition="none"),this.type!=="Default"&&(this.rangeBar.style.transition="none"),(this.isMaterial||this.isMaterial3)&&this.tooltip.isVisible&&this.type==="Default"&&(this.tooltipElement.style.transition=this.transition.handle),this.tooltipToggle(this.getHandle()),this.closeTooltip())},t.prototype.handleFocusOut=function(){this.firstHandle.classList.contains(z.sliderHandleFocused)&&this.firstHandle.classList.remove(z.sliderHandleFocused),this.type==="Range"&&this.secondHandle.classList.contains(z.sliderHandleFocused)&&this.secondHandle.classList.remove(z.sliderHandleFocused)},t.prototype.handleFocus=function(e){this.focusSliderElement(),this.sliderBarClick(e),e.currentTarget===this.firstHandle?(this.firstHandle.classList.add(z.sliderHandleFocused),this.firstHandle.classList.add(z.sliderTabHandle)):(this.secondHandle.classList.add(z.sliderHandleFocused),this.secondHandle.classList.add(z.sliderTabHandle)),b.add(document,"mousemove touchmove",this.sliderBarMove,this),b.add(document,"mouseup touchend",this.sliderBarUp,this)},t.prototype.handleOver=function(e){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&this.tooltipToggle(e.currentTarget),this.type==="Default"&&this.tooltipToggle(this.getHandle())},t.prototype.handleLeave=function(e){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&!e.currentTarget.classList.contains(z.sliderHandleFocused)&&!e.currentTarget.classList.contains(z.sliderTabHandle)&&this.closeTooltip()},t.prototype.setHandler=function(){this.createFirstHandle(),this.type==="Range"&&this.createSecondHandle()},t.prototype.setEnableRTL=function(){this.enableRtl&&this.orientation!=="Vertical"?W([this.sliderContainer],z.rtl):G([this.sliderContainer],z.rtl);var e=this.orientation!=="Vertical"?this.horDir:this.verDir;this.enableRtl?(this.horDir="right",this.verDir="bottom"):(this.horDir="left",this.verDir="bottom");var i=this.orientation!=="Vertical"?this.horDir:this.verDir;e!==i&&this.orientation==="Horizontal"&&(de(this.firstHandle,{right:"",left:"auto"}),this.type==="Range"&&de(this.secondHandle,{top:"",left:"auto"})),this.setBarColor()},t.prototype.tooltipValue=function(){var e=this,i,r={value:this.value,text:""};this.initialTooltip&&(this.initialTooltip=!1,this.setTooltipContent(),r.text=i=typeof this.tooltipObj.content=="function"?this.tooltipObj.content():this.tooltipObj.content,this.trigger("tooltipChange",r,function(o){if(e.addTooltipClass(o.text),i!==o.text){e.customAriaText=o.text,e.enableHtmlSanitizer?o.text=pt.sanitize(o.text.toString()):o.text=o.text.toString();var a=function(){return o.text};e.tooltipObj.content=ss(a),e.setAriaAttrValue(e.firstHandle),e.type==="Range"&&e.setAriaAttrValue(e.secondHandle)}}),this.isMaterialTooltip&&this.setPreviousVal("change",this.value))},t.prototype.setTooltipContent=function(){var e=this.formatContent(this.tooltipFormatInfo,!1),i=function(){return e};this.tooltipObj.content=ss(i)},t.prototype.formatContent=function(e,i){var r="",o=this.handleVal1,a=this.handleVal2;return!d(this.customValues)&&this.customValues.length>0&&(o=this.customValues[this.handleVal1],a=this.customValues[this.handleVal2]),i?(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?r=!d(this.tooltip)&&!d(this.tooltip.format)?this.formatString(a,e).elementVal+" - "+this.formatString(o,e).elementVal:a.toString()+" - "+o.toString():r=!d(this.tooltip)&&!d(this.tooltip.format)?this.formatString(o,e).elementVal+" - "+this.formatString(a,e).elementVal:o.toString()+" - "+a.toString():d(o)||(r=!d(this.tooltip)&&!d(this.tooltip.format)?this.formatString(o,e).elementVal:o.toString()),r):(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?r=d(e.format)?a.toString()+" - "+o.toString():this.formatString(a,e).formatString+" - "+this.formatString(o,e).formatString:r=d(e.format)?o.toString()+" - "+a.toString():this.formatString(o,e).formatString+" - "+this.formatString(a,e).formatString:d(o)||(r=d(e.format)?o.toString():this.formatString(o,e).formatString),r)},t.prototype.addTooltipClass=function(e){if(this.isMaterialTooltip){var i=e.toString().length;if(this.tooltipElement){var r=i>4?{oldCss:z.sliderMaterialDefault,newCss:z.sliderMaterialRange}:{oldCss:z.sliderMaterialRange,newCss:z.sliderMaterialDefault};this.tooltipElement.classList.remove(r.oldCss),this.tooltipElement.classList.contains(r.newCss)||(this.tooltipElement.classList.add(r.newCss),this.tooltipElement.style.transform=i>4?"scale(1)":this.getTooltipTransformProperties(this.previousTooltipClass).rotate)}else{var r=i>4?z.sliderMaterialRange:z.sliderMaterialDefault;this.tooltipObj.cssClass=z.sliderTooltip+" "+r}}},t.prototype.tooltipPlacement=function(){return this.orientation==="Horizontal"?this.tooltip.placement==="Before"?"TopCenter":"BottomCenter":this.tooltip.placement==="Before"?"LeftCenter":"RightCenter"},t.prototype.tooltipBeforeOpen=function(e){this.tooltipElement=e.element,this.tooltip.cssClass&&W([this.tooltipElement],this.tooltip.cssClass.split(" ").filter(function(i){return i})),e.target.removeAttribute("aria-describedby"),this.isMaterialTooltip&&(this.tooltipElement.firstElementChild.classList.add(z.materialTooltipHide),this.handleStart(),this.setTooltipTransform())},t.prototype.tooltipCollision=function(e){if(this.isBootstrap||this.isBootstrap4||(this.isMaterial||this.isMaterial3)&&!this.isMaterialTooltip){var i=this.isBootstrap4?xv:Ov;switch(e){case"TopCenter":this.tooltipObj.setProperties({offsetY:-i},!1);break;case"BottomCenter":this.tooltipObj.setProperties({offsetY:i},!1);break;case"LeftCenter":this.tooltipObj.setProperties({offsetX:-i},!1);break;case"RightCenter":this.tooltipObj.setProperties({offsetX:i},!1);break}}},t.prototype.materialTooltipEventCallBack=function(e){this.sliderBarClick(e),b.add(document,"mousemove touchmove",this.sliderBarMove,this),b.add(document,"mouseup touchend",this.sliderBarUp,this)},t.prototype.wireMaterialTooltipEvent=function(e){this.isMaterialTooltip&&(e?b.remove(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack):b.add(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack,this))},t.prototype.tooltipPositionCalculation=function(e){var i;switch(e){case"TopCenter":i=z.horizontalTooltipBefore;break;case"BottomCenter":i=z.horizontalTooltipAfter;break;case"LeftCenter":i=z.verticalTooltipBefore;break;case"RightCenter":i=z.verticalTooltipAfter;break}return i},t.prototype.getTooltipTransformProperties=function(e){var i;if(this.tooltipElement){var r=this.orientation==="Horizontal"?this.tooltipElement.clientHeight+14-this.tooltipElement.clientHeight/2:this.tooltipElement.clientWidth+14-this.tooltipElement.clientWidth/2;i=this.orientation==="Horizontal"?e===z.horizontalTooltipBefore?{rotate:"rotate(45deg)",translate:"translateY("+r+"px)"}:{rotate:"rotate(225deg)",translate:"translateY("+-r+"px)"}:e===z.verticalTooltipBefore?{rotate:"rotate(-45deg)",translate:"translateX("+r+"px)"}:{rotate:"rotate(-225deg)",translate:"translateX("+-r+"px)"}}return i},t.prototype.openMaterialTooltip=function(){var e=this;if(this.isMaterialTooltip){this.refreshTooltip(this.firstHandle);var i=this.tooltipElement.firstElementChild;i.classList.remove(z.materialTooltipHide),i.classList.add(z.materialTooltipShow),this.firstHandle.style.cursor="default",this.tooltipElement.style.transition=this.scaleTransform,this.tooltipElement.classList.add(z.materialTooltipOpen),this.materialHandle.style.transform="scale(0)",i.innerText.length>4?this.tooltipElement.style.transform="scale(1)":this.tooltipElement.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate,this.type==="Default"?setTimeout(function(){e.tooltipElement&&(e.tooltipElement.style.transition=e.transition.handle)},2500):setTimeout(function(){e.tooltipElement&&(e.tooltipElement.style.transition="none")},2500)}},t.prototype.closeMaterialTooltip=function(){var e=this;if(this.isMaterialTooltip){var i=this.tooltipElement.firstElementChild;this.tooltipElement.style.transition=this.scaleTransform,i.classList.remove(z.materialTooltipShow),i.classList.add(z.materialTooltipHide),this.firstHandle.style.cursor="-webkit-grab",this.firstHandle.style.cursor="grab",this.materialHandle&&(this.materialHandle.style.transform="scale(1)"),this.tooltipElement.classList.remove(z.materialTooltipOpen),this.setTooltipTransform(),this.tooltipTarget=void 0,setTimeout(function(){e.tooltipElement&&(e.tooltipElement.style.transition="none")},2500)}},t.prototype.checkTooltipPosition=function(e){var i=this.tooltipPositionCalculation(e.collidedPosition);(this.tooltipCollidedPosition===void 0||this.tooltipCollidedPosition!==e.collidedPosition||!e.element.classList.contains(i))&&(this.isMaterialTooltip&&(i!==void 0&&(e.element.classList.remove(this.previousTooltipClass),e.element.classList.add(i),this.previousTooltipClass=i),e.element.style.transform&&e.element.classList.contains(z.materialTooltipOpen)&&e.element.firstElementChild.innerText.length<=4&&(e.element.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate)),this.tooltipCollidedPosition=e.collidedPosition),this.isMaterialTooltip&&this.tooltipElement&&this.tooltipElement.style.transform.indexOf("translate")!==-1&&this.setTooltipTransform()},t.prototype.setTooltipTransform=function(){var e=this.getTooltipTransformProperties(this.previousTooltipClass);d(this.tooltipElement)||(this.tooltipElement.firstElementChild.innerText.length>4?this.tooltipElement.style.transform=e.translate+" scale(0.01)":this.tooltipElement.style.transform=e.translate+" "+e.rotate+" scale(0.01)")},t.prototype.renderTooltip=function(){this.tooltipObj=new qa({showTipPointer:this.isBootstrap||this.isMaterial||this.isMaterial3||this.isBootstrap4||this.isTailwind||this.isTailwind3||this.isBootstrap5||this.isFluent||this.isFluent2||this.isBootstrap5Dot3,cssClass:z.sliderTooltip,height:this.isMaterial||this.isMaterial3?30:"auto",animation:{open:{effect:"None"},close:{effect:"FadeOut",duration:500}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),beforeClose:this.tooltipBeforeClose.bind(this),enableHtmlSanitizer:this.enableHtmlSanitizer}),this.tooltipObj.appendTo(this.firstHandle),this.initializeTooltipProps()},t.prototype.initializeTooltipProps=function(){var e=this.tooltip.showOn==="Auto"?"Hover":this.tooltip.showOn;this.setProperties({tooltip:{showOn:e}},!0),this.tooltipObj.position=this.tooltipPlacement(),this.tooltipCollision(this.tooltipObj.position),[this.firstHandle,this.rangeBar,this.secondHandle].forEach(function(i){d(i)||(i.style.transition="none")}),this.isMaterialTooltip&&(this.sliderContainer.classList.add(z.materialSlider),this.tooltipValue(),this.tooltipObj.animation.close.effect="None",this.tooltipObj.open(this.firstHandle))},t.prototype.tooltipBeforeClose=function(){this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0},t.prototype.setButtons=function(){this.firstBtn=this.createElement("div",{className:z.sliderButton+" "+z.firstButton}),this.firstBtn.appendChild(this.createElement("span",{className:z.sliderButtonIcon})),(this.isTailwind||this.isTailwind3)&&this.firstBtn.querySelector("span").classList.add("e-icons"),this.firstBtn.tabIndex=-1,this.secondBtn=this.createElement("div",{className:z.sliderButton+" "+z.secondButton}),this.secondBtn.appendChild(this.createElement("span",{className:z.sliderButtonIcon})),(this.isTailwind||this.isTailwind3)&&this.secondBtn.querySelector("span").classList.add("e-icons"),this.secondBtn.tabIndex=-1,this.sliderContainer.classList.add(z.sliderButtonClass),this.sliderContainer.appendChild(this.firstBtn),this.sliderContainer.appendChild(this.secondBtn),this.sliderContainer.appendChild(this.element),this.buttonTitle()},t.prototype.buttonTitle=function(){var e=this.enableRtl&&this.orientation!=="Vertical";this.l10n.setLocale(this.locale);var i=this.l10n.getConstant("decrementTitle"),r=this.l10n.getConstant("incrementTitle");ge(e?this.secondBtn:this.firstBtn,{"aria-label":i,title:i}),ge(e?this.firstBtn:this.secondBtn,{"aria-label":r,title:r})},t.prototype.buttonFocusOut=function(){(this.isMaterial||this.isMaterial3)&&this.getHandle().classList.remove("e-large-thumb-size")},t.prototype.repeatButton=function(e){var i=this.handleValueUpdate(),r=this.enableRtl&&this.orientation!=="Vertical",o;e.target.parentElement.classList.contains(z.firstButton)||e.target.classList.contains(z.firstButton)?r?o=this.add(i,parseFloat(this.step.toString()),!0):o=this.add(i,parseFloat(this.step.toString()),!1):(e.target.parentElement.classList.contains(z.secondButton)||e.target.classList.contains(z.secondButton))&&(r?o=this.add(i,parseFloat(this.step.toString()),!1):o=this.add(i,parseFloat(this.step.toString()),!0)),this.limits.enabled&&(o=this.getLimitCorrectedValues(o)),o>=this.min&&o<=this.max&&(this.changeHandleValue(o),this.tooltipToggle(this.getHandle()))},t.prototype.repeatHandlerMouse=function(e){e.preventDefault(),(e.type==="mousedown"||e.type==="touchstart")&&(this.buttonClick(e),this.repeatInterval=setInterval(this.repeatButton.bind(this),180,e))},t.prototype.materialChange=function(){this.getHandle().classList.contains("e-large-thumb-size")||this.getHandle().classList.add("e-large-thumb-size")},t.prototype.focusHandle=function(){this.getHandle().classList.contains(z.sliderTabHandle)||this.getHandle().classList.add(z.sliderTabHandle)},t.prototype.repeatHandlerUp=function(e){this.changeEvent("changed",e),this.closeTooltip(),clearInterval(this.repeatInterval),this.getHandle().focus()},t.prototype.customTickCounter=function(e){var i=4;return!d(this.customValues)&&this.customValues.length>0&&(e>4&&(i=3),e>7&&(i=2),e>14&&(i=1),e>28&&(i=0)),i},t.prototype.renderScale=function(){var e=this.orientation==="Vertical"?"v":"h";this.ul=this.createElement("ul",{className:z.scale+" e-"+e+"-scale "+z.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation","aria-hidden":"true"}}),this.ul.style.zIndex="-1",S.isAndroid&&e==="h"&&this.ul.classList.add(z.sliderTickPosition);var i=this.ticks.smallStep;this.ticks.showSmallTicks?i<=0&&(i=parseFloat(ee(this.step))):this.ticks.largeStep>0?i=this.ticks.largeStep:i=parseFloat(ee(this.max))-parseFloat(ee(this.min));var r=parseFloat(ee(this.min)),o=parseFloat(ee(this.max)),a=parseFloat(ee(i)),n=!d(this.customValues)&&this.customValues.length>0&&this.customValues.length-1,s=this.customTickCounter(n),h=!d(this.customValues)&&this.customValues.length>0?n*s+n:Math.abs((o-r)/a);this.element.appendChild(this.ul);var p,u=parseFloat(this.min.toString());e==="v"&&(u=parseFloat(this.max.toString()));var c=0,f,g=100/h;g===1/0&&(g=5);for(var v=0,m=!d(this.customValues)&&this.customValues.length>0?this.customValues.length-1:0,C=0;v<=h;v++){if(p=this.createElement("li",{attrs:{class:z.tick,role:"presentation","aria-hidden":"true"}}),!d(this.customValues)&&this.customValues.length>0)f=v%(s+1)===0,f&&(e==="h"?(u=this.customValues[C],C++):(u=this.customValues[m],m--),p.setAttribute("title",u.toString()));else if(p.setAttribute("title",u.toString()),this.numberOfDecimals(this.max)===0&&this.numberOfDecimals(this.min)===0&&this.numberOfDecimals(this.step)===0)if(e==="h"){var M=(u-parseFloat(this.min.toString()))%this.ticks.largeStep;f=Math.abs(M)<Jt||Math.abs(this.ticks.largeStep-M)<Jt}else{var M=Math.abs(u-parseFloat(this.max.toString()))%this.ticks.largeStep;f=Math.abs(M)<Jt||Math.abs(this.ticks.largeStep-M)<Jt}else{var I=this.ticks.largeStep,N=u;if(e==="h"){var M=(N-r)%I;f=Math.abs(M)<Jt||Math.abs(I-M)<Jt}else{var M=Math.abs(N-parseFloat(o.toString()))%I;f=Math.abs(M)<Jt||Math.abs(I-M)<Jt}}f&&p.classList.add(z.large),e==="h"?p.style.width=g+"%":p.style.height=g+"%";var O=f?this.ticks.placement==="Both"?2:1:0;if(f)for(var x=0;x<O;x++)this.createTick(p,u);else d(this.customValues)&&this.formatTicksValue(p,u);this.ul.appendChild(p),this.tickElementCollection.push(p);var D=void 0;d(this.customValues)&&(this.numberOfDecimals(i)>this.numberOfDecimals(u)?D=this.numberOfDecimals(i):D=this.numberOfDecimals(u),e==="h"?u=this.makeRoundNumber(u+i,D):this.min>this.max?u=this.makeRoundNumber(u+i,D):u=this.makeRoundNumber(u-i,D),c=this.makeRoundNumber(c+i,D))}this.ticksAlignment(e,g)},t.prototype.ticksAlignment=function(e,i,r){r===void 0&&(r=!0),this.firstChild=this.ul.firstElementChild,this.lastChild=this.ul.lastElementChild,this.firstChild.classList.add(z.sliderFirstTick),this.lastChild.classList.add(z.sliderLastTick),this.sliderContainer.classList.add(z.scale+"-"+this.ticks.placement.toLowerCase()),e==="h"?(this.firstChild.style.width=i/2+"%",this.lastChild.style.width=i/2+"%"):(this.firstChild.style.height=i/2+"%",this.lastChild.style.height=i/2+"%");var o={ticksWrapper:this.ul,tickElements:this.tickElementCollection};r&&this.trigger("renderedTicks",o),this.scaleAlignment()},t.prototype.createTick=function(e,i){var r=this.createElement("span",{className:z.tickValue+" "+z.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation","aria-hidden":"true"}});e.appendChild(r),d(this.customValues)?this.formatTicksValue(e,i,r):this.enableHtmlSanitizer?r.innerHTML=pt.sanitize(i.toString()):r.innerHTML=i.toString()},t.prototype.formatTicksValue=function(e,i,r){var o=this,a=this.formatNumber(i),n=!d(this.ticks)&&!d(this.ticks.format)?this.formatString(i,this.ticksFormatInfo).formatString:a,s={value:i,text:n,tickElement:e};this.trigger("renderingTicks",s,function(h){e.setAttribute("title",h.text.toString()),r&&(o.enableHtmlSanitizer?r.innerHTML=pt.sanitize(h.text.toString()):r.innerHTML=h.text.toString())})},t.prototype.scaleAlignment=function(){this.tickValuePosition(),this.orientation==="Vertical"?this.element.getBoundingClientRect().width<=15?this.sliderContainer.classList.add(z.sliderSmallSize):this.sliderContainer.classList.remove(z.sliderSmallSize):this.element.getBoundingClientRect().height<=15?this.sliderContainer.classList.add(z.sliderSmallSize):this.sliderContainer.classList.remove(z.sliderSmallSize)},t.prototype.tickValuePosition=function(){this.firstChild=this.element.querySelector("ul").children[0];var e=this.firstChild.getBoundingClientRect(),i,r,o=this.ticks.smallStep,a=Math.abs(parseFloat(ee(this.max))-parseFloat(ee(this.min)))/o;this.firstChild.children.length>0&&(i=this.firstChild.children[0].getBoundingClientRect());var n=[this.sliderContainer.querySelectorAll("."+z.tick+"."+z.large+" ."+z.tickValue)],s;this.ticks.placement==="Both"?s=[].slice.call(n[0],2):s=[].slice.call(n[0],1);for(var h=this.orientation==="Vertical"?e.height*2:e.width*2,p=0;p<this.firstChild.children.length;p++)this.orientation==="Vertical"?this.firstChild.children[p].style.top=-(i.height/2)+"px":this.enableRtl?this.firstChild.children[p].style.left=(h-this.firstChild.children[p].getBoundingClientRect().width)/2+"px":this.firstChild.children[p].style.left=-(i.width/2)+"px";for(var p=0;p<s.length;p++)r=s[p].getBoundingClientRect(),this.orientation==="Vertical"?de(s[p],{top:(h-r.height)/2+"px"}):de(s[p],{left:(h-r.width)/2+"px"});this.enableRtl&&this.lastChild.children.length&&a!==0&&(this.lastChild.children[0].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px",this.ticks.placement==="Both"&&(this.lastChild.children[1].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px")),a===0&&(this.orientation==="Horizontal"&&(this.enableRtl?(this.firstChild.classList.remove(z.sliderLastTick),this.firstChild.style.right=this.firstHandle.style.right,this.firstChild.children[0].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px",this.ticks.placement==="Both"&&(this.firstChild.children[1].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px")):(this.firstChild.classList.remove(z.sliderLastTick),this.firstChild.style.left=this.firstHandle.style.left)),this.orientation==="Vertical"&&this.firstChild.classList.remove(z.sliderLastTick))},t.prototype.setAriaAttrValue=function(e){var i,r=!d(this.ticks)&&!d(this.ticks.format),o=r?this.formatContent(this.tooltipFormatInfo,!1):this.formatContent(this.ticksFormatInfo,!1),a=r?this.formatContent(this.ticksFormatInfo,!0):this.formatContent(this.tooltipFormatInfo,!0);o=this.customAriaText?this.customAriaText:o,o.split(" - ").length===2?i=o.split(" - "):i=[o,o],this.setAriaAttributes(e),this.type!=="Range"?ge(e,{"aria-valuenow":a,"aria-valuetext":o}):this.enableRtl?e===this.firstHandle?ge(e,{"aria-valuenow":a.split(" - ")[1],"aria-valuetext":i[1]}):ge(e,{"aria-valuenow":a.split(" - ")[0],"aria-valuetext":i[0]}):e===this.firstHandle?ge(e,{"aria-valuenow":a.split(" - ")[0],"aria-valuetext":i[0]}):ge(e,{"aria-valuenow":a.split(" - ")[1],"aria-valuetext":i[1]})},t.prototype.handleValueUpdate=function(){var e;return this.type==="Range"?this.activeHandle===1?e=this.handleVal1:e=this.handleVal2:e=this.handleVal1,e},t.prototype.getLimitCorrectedValues=function(e){return this.type==="MinRange"||this.type==="Default"?e=this.getLimitValueAndPosition(e,this.limits.minStart,this.limits.minEnd)[0]:this.activeHandle===1?e=this.getLimitValueAndPosition(e,this.limits.minStart,this.limits.minEnd)[0]:e=this.getLimitValueAndPosition(e,this.limits.maxStart,this.limits.maxEnd)[0],e},t.prototype.focusSliderElement=function(){this.isElementFocused||(this.element.focus(),this.isElementFocused=!0)},t.prototype.buttonClick=function(e){this.focusSliderElement();var i,r=this.enableRtl&&this.orientation!=="Vertical",o=this.handleValueUpdate();e.keyCode===40||e.keyCode===37||e.currentTarget.classList.contains(z.firstButton)?r?i=this.add(o,parseFloat(this.step.toString()),!0):i=this.add(o,parseFloat(this.step.toString()),!1):e.keyCode===38||e.keyCode===39||e.currentTarget.classList.contains(z.secondButton)?r?i=this.add(o,parseFloat(this.step.toString()),!1):i=this.add(o,parseFloat(this.step.toString()),!0):e.keyCode===33||e.currentTarget.classList.contains(z.firstButton)?r?i=this.add(o,parseFloat(this.ticks.largeStep.toString()),!1):i=this.add(o,parseFloat(this.ticks.largeStep.toString()),!0):e.keyCode===34||e.currentTarget.classList.contains(z.secondButton)?r?i=this.add(o,parseFloat(this.ticks.largeStep.toString()),!0):i=this.add(o,parseFloat(this.ticks.largeStep.toString()),!1):e.keyCode===36?i=parseFloat(this.min<this.max?this.min.toString():this.max.toString()):e.keyCode===35&&(i=parseFloat(this.min<this.max?this.max.toString():this.min.toString())),this.limits.enabled&&(i=this.getLimitCorrectedValues(i)),this.changeHandleValue(i),(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(z.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.getHandle().focus(),this.focusHandle(),e.currentTarget.classList.contains(z.firstButton)&&b.add(this.firstBtn,"mouseup touchend",this.buttonUp,this),e.currentTarget.classList.contains(z.secondButton)&&b.add(this.secondBtn,"mouseup touchend",this.buttonUp,this)},t.prototype.tooltipToggle=function(e){this.isMaterialTooltip?this.tooltipElement.classList.contains(z.materialTooltipOpen)?this.refreshTooltip(this.firstHandle):this.openMaterialTooltip():this.tooltipElement?this.refreshTooltip(e):this.openTooltip(e)},t.prototype.buttonUp=function(e){e.currentTarget.classList.contains(z.firstButton)&&b.remove(this.firstBtn,"mouseup touchend",this.buttonUp),e.currentTarget.classList.contains(z.secondButton)&&b.remove(this.secondBtn,"mouseup touchend",this.buttonUp)},t.prototype.setRangeBar=function(){this.orientation==="Horizontal"&&!d(this.rangeBar)?this.type==="MinRange"?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",de(this.rangeBar,{width:d(this.handlePos1)?0:this.handlePos1+"px"})):(this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",de(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"})):d(this.rangeBar)||(this.type==="MinRange"?(this.rangeBar.style.bottom=this.min>this.max?this.handlePos1+"px":"0px",de(this.rangeBar,{height:d(this.handlePos1)?0:this.min>this.max?this.element.clientHeight-this.handlePos1+"px":this.handlePos1+"px"})):(this.rangeBar.style.bottom=this.min>this.max?this.handlePos2+"px":this.handlePos1+"px",de(this.rangeBar,{height:this.min>this.max?this.handlePos1-this.handlePos2+"px":this.handlePos2-this.handlePos1+"px"})))},t.prototype.checkValidValueAndPos=function(e){return e=this.checkHandleValue(e),e=this.checkHandlePosition(e),e},t.prototype.setLimitBarPositions=function(e,i,r,o){this.orientation==="Horizontal"?this.enableRtl?(this.limitBarFirst.style.right=e+"px",this.limitBarFirst.style.width=i-e+"px"):(this.limitBarFirst.style.left=e+"px",this.limitBarFirst.style.width=i-e+"px"):(this.limitBarFirst.style.bottom=(this.min<this.max?e:i)+"px",this.limitBarFirst.style.height=(this.min<this.max?i-e:e-i)+"px"),this.type==="Range"&&(this.orientation==="Horizontal"?this.enableRtl?(this.limitBarSecond.style.right=r+"px",this.limitBarSecond.style.width=o-r+"px"):(this.limitBarSecond.style.left=r+"px",this.limitBarSecond.style.width=o-r+"px"):(this.limitBarSecond.style.bottom=(this.min<this.max?r:o)+"px",this.limitBarSecond.style.height=(this.min<this.max?o-r:r-o)+"px"))},t.prototype.setLimitBar=function(){if(this.type==="Default"||this.type==="MinRange"){var e=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];e=this.checkValidValueAndPos(e);var i=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];i=this.checkValidValueAndPos(i),this.setLimitBarPositions(e,i)}else if(this.type==="Range"){var r=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];r=this.checkValidValueAndPos(r);var o=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];o=this.checkValidValueAndPos(o);var a=this.getLimitValueAndPosition(this.limits.maxStart,this.limits.maxStart,this.limits.maxEnd,!0)[0];a=this.checkValidValueAndPos(a);var n=this.getLimitValueAndPosition(this.limits.maxEnd,this.limits.maxStart,this.limits.maxEnd,!0)[0];n=this.checkValidValueAndPos(n),this.setLimitBarPositions(r,o,a,n)}},t.prototype.getLimitValueAndPosition=function(e,i,r,o){return d(i)&&(i=this.min<this.max?this.min:this.max,d(e)&&o&&(e=i)),d(r)&&(r=this.min<this.max?this.max:this.min,d(e)&&o&&(e=r)),e<i&&(e=i),e>r&&(e=r),[e,this.checkHandlePosition(e)]},t.prototype.setValue=function(){if(!d(this.customValues)&&this.customValues.length>0&&(this.min=0,this.max=this.customValues.length-1,this.setBarColor()),this.setAriaAttributes(this.firstHandle),this.handleVal1=d(this.value)?this.checkHandleValue(parseFloat(this.min.toString())):this.checkHandleValue(parseFloat(this.value.toString())),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.preHandlePos1=this.handlePos1,d(this.activeHandle)&&(this.activeHandle=this.type==="Range"?2:1),this.type==="Default"||this.type==="MinRange"){if(this.limits.enabled){var e=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=e[0],this.handlePos1=e[1],this.preHandlePos1=this.handlePos1}this.setHandlePosition(null),this.handleStart(),this.value=this.handleVal1,this.setAriaAttrValue(this.firstHandle),this.changeEvent("changed",null)}else this.validateRangeValue();this.type!=="Default"&&this.setRangeBar(),this.limits.enabled&&this.setLimitBar()},t.prototype.rangeValueUpdate=function(){(this.value===null||typeof this.value!="object")&&(this.value=[parseFloat(ee(this.min)),parseFloat(ee(this.max))])},t.prototype.validateRangeValue=function(){this.rangeValueUpdate(),this.setRangeValue()},t.prototype.modifyZindex=function(){this.type==="Range"&&!d(this.firstHandle)&&!d(this.secondHandle)?this.activeHandle===1?(this.firstHandle.style.zIndex=this.zIndex+4+"",this.secondHandle.style.zIndex=this.zIndex+3+""):(this.firstHandle.style.zIndex=this.zIndex+3+"",this.secondHandle.style.zIndex=this.zIndex+4+""):this.isMaterialTooltip&&this.tooltipElement&&(this.tooltipElement.style.zIndex=Ri(this.element)+"")},t.prototype.setHandlePosition=function(e){var i=this,r,o=this.activeHandle===1?this.handlePos1:this.handlePos2;this.isMaterialTooltip?r=[this.firstHandle,this.materialHandle]:r=[this.getHandle()],this.handleStart(),r.forEach(function(a){d(a)||(i.orientation==="Horizontal"?i.enableRtl?a.style.right=o+"px":a.style.left=o+"px":a.style.bottom=o+"px")}),this.changeEvent("change",e)},t.prototype.getHandle=function(){return this.activeHandle===1?this.firstHandle:this.secondHandle},t.prototype.setRangeValue=function(){this.updateRangeValue(),this.activeHandle=1,this.setHandlePosition(null),this.activeHandle=2,this.setHandlePosition(null),this.activeHandle=1},t.prototype.changeEvent=function(e,i){var r=e==="change"?this.previousVal:this.previousChanged;if(this.type!=="Range")this.setProperties({value:this.handleVal1},!0),r!==this.value&&(!this.isMaterialTooltip||!this.initialTooltip)&&(this.trigger(e,this.changeEventArgs(e,i)),this.initialTooltip=!0,this.setPreviousVal(e,this.value)),this.setAriaAttrValue(this.firstHandle);else{var o=this.value=[this.handleVal1,this.handleVal2];this.setProperties({value:o},!0),(r.length===this.value.length&&this.value[0]!==r[0]||this.value[1]!==r[1])&&(this.initialTooltip=!1,this.trigger(e,this.changeEventArgs(e,i)),this.initialTooltip=!0,this.setPreviousVal(e,this.value)),this.setAriaAttrValue(this.getHandle())}this.hiddenInput.value=this.value.toString()},t.prototype.changeEventArgs=function(e,i){var r;return this.tooltip.isVisible&&this.tooltipObj&&this.initialTooltip?(this.tooltipValue(),r={value:this.value,previousValue:e==="change"?this.previousVal:this.previousChanged,action:e,text:typeof this.tooltipObj.content=="function"?this.tooltipObj.content():this.tooltipObj.content,isInteracted:!d(i)}):r={value:this.value,previousValue:e==="change"?this.previousVal:this.previousChanged,action:e,text:d(this.ticksFormatInfo.format)?this.value.toString():this.type!=="Range"?this.formatString(this.value,this.ticksFormatInfo).formatString:this.formatString(this.value[0],this.ticksFormatInfo).formatString+" - "+this.formatString(this.value[1],this.ticksFormatInfo).formatString,isInteracted:!d(i)},r},t.prototype.setPreviousVal=function(e,i){e==="change"?this.previousVal=i:this.previousChanged=i},t.prototype.updateRangeValue=function(){var e=this.value.toString().split(",").map(Number);if(this.enableRtl&&this.orientation!=="Vertical"||this.rtl?this.value=[e[1],e[0]]:this.value=[e[0],e[1]],this.enableRtl&&this.orientation!=="Vertical"?(this.handleVal1=this.checkHandleValue(this.value[1]),this.handleVal2=this.checkHandleValue(this.value[0])):(this.handleVal1=this.checkHandleValue(this.value[0]),this.handleVal2=this.checkHandleValue(this.value[1])),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.min<this.max&&this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.min>this.max&&this.handlePos1<this.handlePos2&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.preHandlePos1=this.handlePos1,this.preHandlePos2=this.handlePos2,this.limits.enabled){this.activeHandle=1;var i=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=i[0],this.handlePos1=i[1],this.preHandlePos1=this.handlePos1,this.activeHandle=2,i=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=i[0],this.handlePos2=i[1],this.preHandlePos2=this.handlePos2}},t.prototype.checkHandlePosition=function(e){var i;return e=100*(e-parseFloat(ee(this.min)))/(parseFloat(ee(this.max))-parseFloat(ee(this.min))),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(e/100):i=this.element.getBoundingClientRect().height*(e/100),parseFloat(ee(this.max))===parseFloat(ee(this.min))&&(this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width:i=this.element.getBoundingClientRect().height),i},t.prototype.checkHandleValue=function(e){if(this.min===this.max)return parseFloat(ee(this.max));var i=this.tempStartEnd();return e<i.start?e=i.start:e>i.end&&(e=i.end),e},t.prototype.reposition=function(){var e=this;d(this.firstHandle)||(this.firstHandle.style.transition="none"),this.type!=="Default"&&!d(this.rangeBar)&&(this.rangeBar.style.transition="none"),this.type==="Range"&&!d(this.secondHandle)&&(this.secondHandle.style.transition="none"),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handleVal2&&(this.handlePos2=this.checkHandlePosition(this.handleVal2)),this.orientation==="Horizontal"?(this.enableRtl?this.firstHandle.style.right=this.handlePos1+"px":this.firstHandle.style.left=this.handlePos1+"px",this.isMaterialTooltip&&!d(this.materialHandle)&&(this.enableRtl?this.materialHandle.style.right=this.handlePos1+"px":this.materialHandle.style.left=this.handlePos1+"px"),this.type==="MinRange"&&!d(this.rangeBar)?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",de(this.rangeBar,{width:d(this.handlePos1)?0:this.handlePos1+"px"})):this.type==="Range"&&!d(this.secondHandle)&&!d(this.rangeBar)&&(this.enableRtl?(this.secondHandle.style.right=this.handlePos2+"px",this.rangeBar.style.right=this.handlePos1+"px"):(this.secondHandle.style.left=this.handlePos2+"px",this.rangeBar.style.left=this.handlePos1+"px"),de(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"}))):(this.firstHandle.style.bottom=this.handlePos1+"px",this.isMaterialTooltip&&(this.materialHandle.style.bottom=this.handlePos1+"px"),this.type==="MinRange"?(this.rangeBar.style.bottom=this.min>this.max?this.handlePos1+"px":"0px",de(this.rangeBar,{height:d(this.handlePos1)?0:this.min>this.max?this.element.clientHeight-this.handlePos1+"px":this.handlePos1+"px"})):this.type==="Range"&&(this.secondHandle.style.bottom=this.handlePos2+"px",this.rangeBar.style.bottom=this.min>this.max?this.handlePos2+"px":this.handlePos1+"px",de(this.rangeBar,{height:this.min>this.max?this.handlePos1-this.handlePos2+"px":this.handlePos2-this.handlePos1+"px"}))),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.handleStart(),this.tooltip.isVisible||setTimeout(function(){d(e.firstHandle)||(e.firstHandle.style.transition=e.scaleTransform),e.type==="Range"&&!d(e.secondHandle)&&(e.secondHandle.style.transition=e.scaleTransform)}),this.refreshTooltip(this.tooltipTarget),this.setBarColor()},t.prototype.changeHandleValue=function(e){var i=null;this.activeHandle===1?(this.limits.enabled&&this.limits.startHandleFixed||(this.handleVal1=this.checkHandleValue(e),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.type==="Range"&&(this.handlePos1>this.handlePos2&&this.min<this.max||this.handlePos1<this.handlePos2&&this.min>this.max)&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.handlePos1!==this.preHandlePos1&&(i=this.preHandlePos1=this.handlePos1)),this.modifyZindex()):(this.limits.enabled&&this.limits.endHandleFixed||(this.handleVal2=this.checkHandleValue(e),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.type==="Range"&&(this.handlePos2<this.handlePos1&&this.min<this.max||this.handlePos2>this.handlePos1&&this.min>this.max)&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.handlePos2!==this.preHandlePos2&&(i=this.preHandlePos2=this.handlePos2)),this.modifyZindex()),i!==null&&(this.type!=="Default"&&this.setRangeBar(),this.setHandlePosition(null))},t.prototype.tempStartEnd=function(){return this.min>this.max?{start:this.max,end:this.min}:{start:this.min,end:this.max}},t.prototype.xyToPosition=function(e){var i;if(this.min===this.max)return 100;if(this.orientation==="Horizontal"){var r=e.x-this.element.getBoundingClientRect().left,o=this.element.offsetWidth/100;this.val=r/o}else{var a=e.y-this.element.getBoundingClientRect().top,o=this.element.offsetHeight/100;this.val=100-a/o}var n=this.stepValueCalculation(this.val);return n<0?n=0:n>100&&(n=100),this.enableRtl&&this.orientation!=="Vertical"&&(n=100-n),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(n/100):i=this.element.getBoundingClientRect().height*(n/100),i},t.prototype.stepValueCalculation=function(e){this.step===0&&(this.step=1);var i=parseFloat(ee(this.step))/((parseFloat(ee(this.max))-parseFloat(ee(this.min)))/100),r=e%Math.abs(i);return r!==0&&(i/2>r?e-=r:e+=Math.abs(i)-r),e},t.prototype.add=function(e,i,r){var o=Math.pow(10,3),a;return r?a=(Math.round(e*o)+Math.round(i*o))/o:a=(Math.round(e*o)-Math.round(i*o))/o,a},t.prototype.positionToValue=function(e){var i,r=parseFloat(ee(this.max))-parseFloat(ee(this.min));this.orientation==="Horizontal"?i=e/this.element.getBoundingClientRect().width*r:i=e/this.element.getBoundingClientRect().height*r;var o=this.add(i,parseFloat(this.min.toString()),!0);return o},t.prototype.sliderBarClick=function(e){e.preventDefault();var i;e.type==="mousedown"||e.type==="mouseup"||e.type==="click"?i={x:e.clientX,y:e.clientY}:(e.type==="touchend"||e.type==="touchstart")&&(i={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY});var r=this.xyToPosition(i),o=this.positionToValue(r);if(this.type==="Range"&&(this.min<this.max&&this.handlePos2-r<r-this.handlePos1||this.min>this.max&&this.handlePos1-r>r-this.handlePos2)){if(this.activeHandle=2,!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.limits.enabled){var a=this.getLimitValueAndPosition(o,this.limits.maxStart,this.limits.maxEnd);o=a[0],r=a[1]}this.secondHandle.classList.add(z.sliderActiveHandle),this.handlePos2=this.preHandlePos2=r,this.handleVal2=o}this.modifyZindex(),this.secondHandle.focus()}else{if(this.activeHandle=1,!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var a=this.getLimitValueAndPosition(o,this.limits.minStart,this.limits.minEnd);o=a[0],r=a[1]}this.firstHandle.classList.add(z.sliderActiveHandle),this.handlePos1=this.preHandlePos1=r,this.handleVal1=o}this.modifyZindex(),this.firstHandle.focus()}this.isMaterialTooltip&&this.tooltipElement.classList.add(z.materialTooltipActive);var n=this.element.querySelector("."+z.sliderTabHandle);n&&this.getHandle()!==n&&n.classList.remove(z.sliderTabHandle);var s=this.activeHandle===1?this.firstHandle:this.secondHandle;if((e.type==="click"||e.type==="mousedown")&&e.target===s){var h=e.clientX,p=e.clientY;document.elementFromPoint(h,p)}if(this.checkRepeatedValue(o)){var u=(this.isMaterial||this.isMaterial3)&&this.tooltip.isVisible?this.transitionOnMaterialTooltip:this.transition;this.getHandle().style.transition=u.handle,this.type!=="Default"&&(this.rangeBar.style.transition=u.rangeBar),this.setHandlePosition(e),this.isMaterialTooltip&&(this.initialTooltip=!1),e.target!==s&&this.changeEvent("changed",e),this.type!=="Default"&&this.setRangeBar()}},t.prototype.handleValueAdjust=function(e,i,r){r===1?(this.handleVal1=i,this.handleVal2=this.handleVal1+this.minDiff):r===2&&(this.handleVal2=i,this.handleVal1=this.handleVal2-this.minDiff),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2)},t.prototype.dragRangeBarMove=function(e){var i,r;e.type!=="touchmove"&&e.preventDefault(),this.rangeBarDragged=!0;var o;this.rangeBar.style.transition="none",this.firstHandle.style.transition="none",this.secondHandle.style.transition="none";var a,n;if(e.type==="mousemove"?(i=[e.clientX,e.clientY],a=i[0],n=i[1]):(r=[e.changedTouches[0].clientX,e.changedTouches[0].clientY],a=r[0],n=r[1]),!(this.limits.enabled&&this.limits.startHandleFixed)&&!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.enableRtl?o={x:a+this.secondPartRemain,y:n+this.secondPartRemain}:o={x:a-this.firstPartRemain,y:n+this.secondPartRemain},this.min>this.max?(this.handlePos2=this.xyToPosition(o),this.handleVal2=this.positionToValue(this.handlePos2)):(this.handlePos1=this.xyToPosition(o),this.handleVal1=this.positionToValue(this.handlePos1)),this.enableRtl?o={x:a-this.firstPartRemain,y:n-this.firstPartRemain}:o={x:a+this.secondPartRemain,y:n-this.firstPartRemain},this.min>this.max?(this.handlePos1=this.xyToPosition(o),this.handleVal1=this.positionToValue(this.handlePos1)):(this.handlePos2=this.xyToPosition(o),this.handleVal2=this.positionToValue(this.handlePos2)),this.limits.enabled){var s=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=s[0],this.handlePos1=s[1],this.handleVal1===this.limits.minEnd&&this.handleValueAdjust(this.handleVal1,this.limits.minEnd,1),this.handleVal1===this.limits.minStart&&this.handleValueAdjust(this.handleVal1,this.limits.minStart,1),s=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=s[0],this.handlePos2=s[1],this.handleVal2===this.limits.maxStart&&this.handleValueAdjust(this.handleVal2,this.limits.maxStart,2),this.handleVal2===this.limits.maxEnd&&this.handleValueAdjust(this.handleVal2,this.limits.maxEnd,2)}this.handleVal2===(this.min>this.max?this.min:this.max)&&this.handleValueAdjust(this.handleVal2,this.min>this.max?this.min:this.max,2),this.handleVal1===(this.min>this.max?this.max:this.min)&&this.handleValueAdjust(this.handleVal1,this.min>this.max?this.max:this.min,1)}this.activeHandle=1,this.setHandlePosition(e),this.activeHandle=2,this.setHandlePosition(e),this.tooltipToggle(this.rangeBar),this.setRangeBar()},t.prototype.sliderBarUp=function(e){this.changeEvent("changed",e),this.handleFocusOut(),this.firstHandle.classList.remove(z.sliderActiveHandle),this.type==="Range"&&(this.initialTooltip=!1,this.secondHandle.classList.remove(z.sliderActiveHandle)),this.closeTooltip(),(this.isMaterial||this.isMaterial3)&&(this.getHandle().classList.remove("e-large-thumb-size"),this.isMaterialTooltip&&this.tooltipElement.classList.remove(z.materialTooltipActive)),b.remove(document,"mousemove touchmove",this.sliderBarMove),b.remove(document,"mouseup touchend",this.sliderBarUp)},t.prototype.sliderBarMove=function(e){e.type!=="touchmove"&&e.preventDefault();var i;e.type==="mousemove"?i={x:e.clientX,y:e.clientY}:i={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY};var r=this.xyToPosition(i),o=this.positionToValue(r);if(r=Math.round(r),this.type!=="Range"&&this.activeHandle===1){if(!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var a=this.getLimitValueAndPosition(o,this.limits.minStart,this.limits.minEnd);r=a[1],o=a[0]}this.handlePos1=r,this.handleVal1=o}this.firstHandle.classList.add(z.sliderActiveHandle)}if(this.type==="Range"){if(this.activeHandle===1){if(this.firstHandle.classList.add(z.sliderActiveHandle),!(this.limits.enabled&&this.limits.startHandleFixed)&&((this.min<this.max&&r>this.handlePos2||this.min>this.max&&r<this.handlePos2)&&(r=this.handlePos2,o=this.handleVal2),r!==this.preHandlePos1)){if(this.limits.enabled){var n=this.getLimitValueAndPosition(o,this.limits.minStart,this.limits.minEnd);o=n[0],r=n[1]}this.handlePos1=this.preHandlePos1=r,this.handleVal1=o,this.activeHandle=1}}else if(this.activeHandle===2&&(this.secondHandle.classList.add(z.sliderActiveHandle),!(this.limits.enabled&&this.limits.endHandleFixed)&&((this.min<this.max&&r<this.handlePos1||this.min>this.max&&r>this.handlePos1)&&(r=this.handlePos1,o=this.handleVal1),r!==this.preHandlePos2))){if(this.limits.enabled){var n=this.getLimitValueAndPosition(o,this.limits.maxStart,this.limits.maxEnd);o=n[0],r=n[1]}this.handlePos2=this.preHandlePos2=r,this.handleVal2=o,this.activeHandle=2}}this.checkRepeatedValue(o)&&(this.getHandle().style.transition=this.scaleTransform,this.type!=="Default"&&(this.rangeBar.style.transition="none"),this.setHandlePosition(e),(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(z.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.type!=="Default"&&this.setRangeBar())},t.prototype.dragRangeBarUp=function(e){this.rangeBarDragged?this.isDragComplete=!0:(this.focusSliderElement(),this.sliderBarClick(e)),this.changeEvent("changed",e),this.closeTooltip(),b.remove(document,"mousemove touchmove",this.dragRangeBarMove),b.remove(document,"mouseup touchend",this.dragRangeBarUp),this.rangeBarDragged=!1},t.prototype.checkRepeatedValue=function(e){if(this.type==="Range"){var i=this.enableRtl&&this.orientation!=="Vertical"?this.activeHandle===1?this.previousVal[1]:this.previousVal[0]:this.activeHandle===1?this.previousVal[0]:this.previousVal[1];if(e===i)return 0}else if(e===this.previousVal)return 0;return 1},t.prototype.refreshTooltip=function(e){this.tooltip.isVisible&&this.tooltipObj&&(this.tooltipValue(),e&&(this.tooltipObj.refresh(e),this.tooltipTarget=e))},t.prototype.openTooltip=function(e){this.tooltip.isVisible&&this.tooltipObj&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.open(e),this.tooltipTarget=e)},t.prototype.closeTooltip=function(){this.tooltip.isVisible&&this.tooltipObj&&this.tooltip.showOn!=="Always"&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.close(),this.tooltipTarget=void 0)},t.prototype.keyDown=function(e){switch(e.keyCode){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:e.preventDefault(),this.buttonClick(e);break}},t.prototype.wireButtonEvt=function(e){e?(b.remove(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut),b.remove(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut),b.remove(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse),b.remove(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),b.remove(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse),b.remove(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),b.remove(this.firstBtn,"focusout",this.sliderFocusOut),b.remove(this.secondBtn,"focusout",this.sliderFocusOut)):(b.add(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut,this),b.add(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut,this),b.add(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse,this),b.add(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),b.add(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse,this),b.add(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),b.add(this.firstBtn,"focusout",this.sliderFocusOut,this),b.add(this.secondBtn,"focusout",this.sliderFocusOut,this))},t.prototype.rangeBarMousedown=function(e){var i,r;if(e.preventDefault(),this.focusSliderElement(),this.type==="Range"&&this.drag&&e.target===this.rangeBar){var o=void 0,a=void 0;e.type==="mousedown"?(i=[e.clientX,e.clientY],o=i[0],a=i[1]):e.type==="touchstart"&&(r=[e.changedTouches[0].clientX,e.changedTouches[0].clientY],o=r[0],a=r[1]),this.orientation==="Horizontal"?(this.firstPartRemain=o-this.rangeBar.getBoundingClientRect().left,this.secondPartRemain=this.rangeBar.getBoundingClientRect().right-o):(this.firstPartRemain=a-this.rangeBar.getBoundingClientRect().top,this.secondPartRemain=this.rangeBar.getBoundingClientRect().bottom-a),this.minDiff=this.handleVal2-this.handleVal1,this.tooltipToggle(this.rangeBar);var n=this.element.querySelector("."+z.sliderTabHandle);n&&n.classList.remove(z.sliderTabHandle),b.add(document,"mousemove touchmove",this.dragRangeBarMove,this),b.add(document,"mouseup touchend",this.dragRangeBarUp,this)}},t.prototype.elementClick=function(e){if(this.isDragComplete){this.isDragComplete=!1;return}e.preventDefault(),this.focusSliderElement(),this.sliderBarClick(e),this.focusHandle()},t.prototype.wireEvents=function(){this.onresize=this.reposition.bind(this),window.addEventListener("resize",this.onresize),this.enabled&&!this.readonly&&(b.add(this.element,"click",this.elementClick,this),this.type==="Range"&&this.drag&&b.add(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown,this),b.add(this.sliderContainer,"keydown",this.keyDown,this),b.add(this.sliderContainer,"keyup",this.keyUp,this),b.add(this.element,"focusout",this.sliderFocusOut,this),b.add(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover,this),this.wireFirstHandleEvt(!1),this.type==="Range"&&this.wireSecondHandleEvt(!1),this.showButtons&&this.wireButtonEvt(!1),this.wireMaterialTooltipEvent(!1),this.isForm&&b.add(this.formElement,"reset",this.formResetHandler,this))},t.prototype.unwireEvents=function(){b.remove(this.element,"click",this.elementClick),this.type==="Range"&&this.drag&&b.remove(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown),b.remove(this.sliderContainer,"keydown",this.keyDown),b.remove(this.sliderContainer,"keyup",this.keyUp),b.remove(this.element,"focusout",this.sliderFocusOut),b.remove(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover),this.wireFirstHandleEvt(!0),this.type==="Range"&&this.wireSecondHandleEvt(!0),this.showButtons&&this.wireButtonEvt(!0),this.wireMaterialTooltipEvent(!0),b.remove(this.element,"reset",this.formResetHandler)},t.prototype.formResetHandler=function(){this.setProperties({value:this.formResetValue},!0),this.setValue()},t.prototype.keyUp=function(e){if(e.keyCode===9&&e.target.classList.contains(z.sliderHandle)&&(this.focusSliderElement(),!e.target.classList.contains(z.sliderTabHandle))){this.element.querySelector("."+z.sliderTabHandle)&&this.element.querySelector("."+z.sliderTabHandle).classList.remove(z.sliderTabHandle),e.target.classList.add(z.sliderTabHandle);var i=e.target.parentElement;if(i===this.element&&(i.querySelector("."+z.sliderTrack).classList.add(z.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&i.querySelector("."+z.rangeBar).classList.add(z.sliderTabRange)),this.type==="Range"){var r=e.target.previousSibling;r&&r.classList.contains(z.sliderHandle)?this.activeHandle=2:this.activeHandle=1}this.getHandle().focus(),this.tooltipToggle(this.getHandle())}this.closeTooltip(),this.changeEvent("changed",e)},t.prototype.hover=function(e){if(!d(e))if(e.type==="mouseover"||e.type==="touchmove"||e.type==="mousemove"||e.type==="pointermove"||e.type==="touchstart")this.sliderContainer.classList.add(z.sliderHover);else{this.sliderContainer.classList.remove(z.sliderHover);var i=e.currentTarget;this.tooltip.isVisible&&this.tooltip.showOn!=="Always"&&this.tooltipObj&&this.isMaterialTooltip&&!i.classList.contains(z.sliderHandleFocused)&&!i.classList.contains(z.sliderTabHandle)&&this.closeMaterialTooltip()}},t.prototype.sliderFocusOut=function(e){e.relatedTarget!==this.secondHandle&&e.relatedTarget!==this.firstHandle&&e.relatedTarget!==this.element&&e.relatedTarget!==this.firstBtn&&e.relatedTarget!==this.secondBtn&&(this.closeMaterialTooltip(),this.closeTooltip(),this.element.querySelector("."+z.sliderTabHandle)&&this.element.querySelector("."+z.sliderTabHandle).classList.remove(z.sliderTabHandle),this.element.querySelector("."+z.sliderTabTrack)&&(this.element.querySelector("."+z.sliderTabTrack).classList.remove(z.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&this.element.querySelector("."+z.sliderTabRange)&&this.element.querySelector("."+z.sliderTabRange).classList.remove(z.sliderTabRange)),this.hiddenInput.focus(),this.hiddenInput.blur(),this.isElementFocused=!1)},t.prototype.removeElement=function(e){e.parentNode&&e.parentNode.removeChild(e)},t.prototype.changeSliderType=function(e,i){this.isMaterialTooltip&&this.materialHandle&&(this.sliderContainer.classList.remove(z.materialSlider),this.removeElement(this.materialHandle),this.materialHandle=void 0),this.removeElement(this.firstHandle),this.firstHandle=void 0,e!=="Default"&&(e==="Range"&&(this.removeElement(this.secondHandle),this.secondHandle=void 0),this.removeElement(this.rangeBar),this.rangeBar=void 0),this.tooltip.isVisible&&!d(this.tooltipObj)&&(this.tooltipObj.destroy(),this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0),this.limits.enabled&&(e==="MinRange"||e==="Default"?d(this.limitBarFirst)||(this.removeElement(this.limitBarFirst),this.limitBarFirst=void 0):d(this.limitBarSecond)||(this.removeElement(this.limitBarSecond),this.limitBarSecond=void 0)),this.activeHandle=1,this.getThemeInitialization(),this.type==="Range"&&this.rangeValueUpdate(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setHandler(),this.setOrientClass(),this.wireFirstHandleEvt(!this.enabled),this.type==="Range"&&this.wireSecondHandleEvt(!this.enabled),this.setValue(),this.tooltip.isVisible&&(this.renderTooltip(),this.wireMaterialTooltipEvent(!1)),this.setBarColor(),i!=="tooltip"&&this.updateConfig(),this.readonly&&(this.sliderContainer.classList.remove(z.readonly),this.setReadOnly())},t.prototype.changeRtl=function(){if(!this.enableRtl&&this.type==="Range"&&(this.value=[this.handleVal2,this.handleVal1]),this.updateConfig(),this.tooltip.isVisible&&this.tooltipObj.refresh(this.firstHandle),this.showButtons){var e=this.enableRtl&&this.orientation!=="Vertical";ge(e?this.secondBtn:this.firstBtn,{"aria-label":"Decrease",title:"Decrease"}),ge(e?this.firstBtn:this.secondBtn,{"aria-label":"Increase",title:"Increase"})}},t.prototype.changeOrientation=function(){this.changeSliderType(this.type,"null")},t.prototype.updateConfig=function(){this.setEnableRTL(),this.setValue(),this.tooltip.isVisible&&this.refreshTooltip(this.tooltipTarget),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.limitsPropertyChange()},t.prototype.limitsPropertyChange=function(){this.limits.enabled?(d(this.limitBarFirst)&&this.type!=="Range"&&this.createLimitBar(),d(this.limitBarFirst)&&d(this.limitBarSecond)&&this.type==="Range"&&this.createLimitBar(),this.setLimitBar(),this.setValue()):(d(this.limitBarFirst)||X(this.limitBarFirst),d(this.limitBarSecond)||X(this.limitBarSecond))},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.destroy=function(){l.prototype.destroy.call(this),this.unwireEvents(),window.removeEventListener("resize",this.onresize),G([this.sliderContainer],[z.sliderDisabled]),this.firstHandle.removeAttribute("aria-orientation"),this.type==="Range"&&this.secondHandle.removeAttribute("aria-orientation"),this.sliderContainer.parentNode&&this.sliderContainer.parentNode.insertBefore(this.element,this.sliderContainer),X(this.sliderContainer),this.tooltip.isVisible&&this.tooltipObj.destroy(),this.element.innerHTML="",this.hiddenInput=null,this.sliderContainer=null,this.sliderTrack=null,this.rangeBar=null,this.firstHandle=null,this.secondHandle=null,this.tickElementCollection=null,this.ul=null,this.firstBtn=null,this.secondBtn=null,this.materialHandle=null,this.tooltipObj=null,this.tooltipTarget=null,this.limitBarFirst=null,this.limitBarSecond=null,this.firstChild=null,this.lastChild=null,this.tooltipElement=null},t.prototype.onPropertyChanged=function(e,i){for(var r=this,o=0,a=Object.keys(e);o<a.length;o++){var n=a[o];switch(n){case"cssClass":this.setCSSClass(i.cssClass);break;case"value":if(e&&i){var s=d(e.value)?this.type==="Range"?[this.min,this.max]:this.min:e.value;this.setProperties({value:s},!0),!d(i.value)&&i.value.toString()!==s.toString()&&(this.setValue(),this.refreshTooltip(this.tooltipTarget),this.type==="Range"&&(d(e.value)||i.value[1]===s[1]?this.activeHandle=1:this.activeHandle=2))}break;case"min":case"step":case"max":this.setMinMaxValue();break;case"tooltip":!d(e.tooltip)&&!d(i.tooltip)&&(this.initialTooltip=!0,this.setTooltip(n),this.showButtons||this.wireEvents());break;case"type":!d(i)&&Object.keys(i).length&&!d(i.type)&&(this.changeSliderType(i.type,n),this.setZindex());break;case"enableRtl":i.enableRtl!==e.enableRtl&&this.orientation!=="Vertical"&&(this.rtl=i.enableRtl,this.changeRtl());break;case"limits":this.limitsPropertyChange();break;case"orientation":this.changeOrientation();break;case"ticks":d(this.sliderContainer.querySelector("."+z.scale))||(X(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(h){h.match(/e-scale-/)&&r.sliderContainer.classList.remove(h)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex());break;case"locale":this.showButtons&&this.buttonTitle();break;case"showButtons":e.showButtons?(this.setButtons(),this.reposition(),this.enabled&&!this.readonly&&this.wireButtonEvt(!1)):this.firstBtn&&this.secondBtn&&(this.sliderContainer.removeChild(this.firstBtn),this.sliderContainer.removeChild(this.secondBtn),this.sliderContainer.classList.remove(z.sliderButtonClass),this.firstBtn=void 0,this.secondBtn=void 0,this.reposition());break;case"enabled":this.setEnabled();break;case"readonly":this.setReadOnly();break;case"customValues":this.setValue(),this.reposition();break;case"colorRange":this.reposition();break;case"width":this.setElementWidth(e.width),this.setMinMaxValue(),this.limits&&this.limitsPropertyChange();break}}},t.prototype.setReadOnly=function(){this.readonly?(this.unwireEvents(),this.sliderContainer.classList.add(z.readonly)):(this.wireEvents(),this.sliderContainer.classList.remove(z.readonly))},t.prototype.setMinMaxValue=function(){var e=this;this.setValue(),this.refreshTooltip(this.tooltipTarget),d(this.sliderContainer.querySelector("."+z.scale))||this.ul&&(X(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(i){i.match(/e-scale-/)&&e.sliderContainer.classList.remove(i)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex())},t.prototype.setZindex=function(){this.zIndex=6,!d(this.ticks)&&this.ticks.placement!=="None"&&!d(this.ul)&&!d(this.element)&&(this.ul.style.zIndex=this.zIndex+-7+"",this.element.style.zIndex=this.zIndex+2+""),!this.isMaterial&&!this.isMaterial3&&!d(this.ticks)&&this.ticks.placement==="Both"&&(this.element.style.zIndex=this.zIndex+2+""),d(this.firstHandle)||(this.firstHandle.style.zIndex=this.zIndex+3+""),this.type==="Range"&&!d(this.secondHandle)&&(this.secondHandle.style.zIndex=this.zIndex+4+"")},t.prototype.setTooltip=function(e){this.changeSliderType(this.type,e)},t.prototype.setBarColor=function(){for(var e,i,r=this.sliderTrack.lastElementChild;r;)this.sliderTrack.removeChild(r),r=this.sliderTrack.lastElementChild;for(var o=0;o<this.colorRange.length;o++)if(!d(this.colorRange[o].start)&&!d(this.colorRange[o].end)&&this.colorRange[o].end>this.colorRange[o].start){this.colorRange[o].start<this.min&&(this.colorRange[o].start=this.min),this.colorRange[o].end>this.max&&(this.colorRange[o].end=this.max);var a=this.checkHandlePosition(this.colorRange[o].start),n=this.checkHandlePosition(this.colorRange[o].end),s=this.createElement("div");s.style.backgroundColor=this.colorRange[o].color,s.style.border="1px solid "+this.colorRange[o].color,this.orientation==="Horizontal"?(i=z.sliderHorizantalColor,this.enableRtl?d(this.customValues)?e=this.checkHandlePosition(this.max)-this.checkHandlePosition(this.colorRange[o].end):e=this.checkHandlePosition(this.customValues.length-this.colorRange[o].end-1):e=this.checkHandlePosition(this.colorRange[o].start),s.style.width=n-a+"px",s.style.left=e+"px"):(i=z.sliderVerticalColor,e=this.checkHandlePosition(this.colorRange[o].start),s.style.height=n-a+"px",s.style.bottom=e+"px"),s.classList.add(i),this.sliderTrack.appendChild(s)}},t.prototype.getModuleName=function(){return"slider"},fe([T(null)],t.prototype,"value",void 0),fe([T(null)],t.prototype,"customValues",void 0),fe([T(1)],t.prototype,"step",void 0),fe([T(null)],t.prototype,"width",void 0),fe([T(0)],t.prototype,"min",void 0),fe([T(100)],t.prototype,"max",void 0),fe([T(!1)],t.prototype,"readonly",void 0),fe([T("Default")],t.prototype,"type",void 0),fe([qi([{}],Nv)],t.prototype,"colorRange",void 0),fe([Ke({},Sv)],t.prototype,"ticks",void 0),fe([Ke({},Dv)],t.prototype,"limits",void 0),fe([T(!0)],t.prototype,"enabled",void 0),fe([Ke({},wv)],t.prototype,"tooltip",void 0),fe([T(!1)],t.prototype,"showButtons",void 0),fe([T(!0)],t.prototype,"enableAnimation",void 0),fe([T("Horizontal")],t.prototype,"orientation",void 0),fe([T("")],t.prototype,"cssClass",void 0),fe([T(!0)],t.prototype,"enableHtmlSanitizer",void 0),fe([Y()],t.prototype,"created",void 0),fe([Y()],t.prototype,"change",void 0),fe([Y()],t.prototype,"changed",void 0),fe([Y()],t.prototype,"renderingTicks",void 0),fe([Y()],t.prototype,"renderedTicks",void 0),fe([Y()],t.prototype,"tooltipChange",void 0),t=fe([Qe],t),t}(ct),Po=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),le=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},Av="e-upload e-control-wrapper",Ks="e-file-select",ua="e-file-drop",zv="e-file-select-wrap",$s="e-upload-files",Vr="e-upload-file-list",Re="e-file-status",Pv="e-upload-actions",Ev="e-file-upload-btn e-css e-btn e-flat e-primary",Lv="e-file-clear-btn e-css e-btn e-flat",el="e-file-name",tl="e-file-type",il="e-file-size",Ze="e-file-remove-btn",mt="e-file-delete-btn",rl="e-spinner-pane",Fe="e-file-abort-btn",Yt="e-file-reload-btn",ca="e-upload-drag-hover",pi="e-upload-progress-wrap",qr="e-upload-progress-bar",da="e-progress-bar-text",Ct="e-upload-progress",St="e-upload-success",Mt="e-upload-fails",fa="e-file-container",ol="e-validation-fails",al="e-rtl",ga="e-disabled",nl="e-rtl-container",va="e-clear-icon-focus",kv="e-progress-inner-wrap",et="e-file-pause-btn",ui="e-file-play-btn",er="e-restrict-retry",sl=["title","style","class"],ll="e-form-upload",Yv="e-hidden-file-input",Di="e-file-invalid",Fv="e-file-information",Uv=function(l){Po(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return le([T("")],t.prototype,"name",void 0),le([T(null)],t.prototype,"size",void 0),le([T("")],t.prototype,"type",void 0),t}(Be),Rv=function(l){Po(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return le([T("Browse...")],t.prototype,"browse",void 0),le([T("Upload")],t.prototype,"upload",void 0),le([T("Clear")],t.prototype,"clear",void 0),t}(Be),Bv=function(l){Po(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return le([T("")],t.prototype,"saveUrl",void 0),le([T("")],t.prototype,"removeUrl",void 0),le([T(0)],t.prototype,"chunkSize",void 0),le([T(3)],t.prototype,"retryCount",void 0),le([T(500)],t.prototype,"retryAfterDelay",void 0),t}(Be),Li=function(l){Po(t,l);function t(e,i){var r=l.call(this,e,i)||this;return r.initialAttr={accept:null,multiple:!1,disabled:!1},r.uploadedFilesData=[],r.base64String=[],r.isForm=!1,r.allTypes=!1,r.pausedData=[],r.uploadMetaData=[],r.tabIndex="0",r.btnTabIndex="0",r.disableKeyboardNavigation=!1,r.count=-1,r.actionCompleteCount=0,r.flag=!0,r.selectedFiles=[],r.uploaderName="UploadFiles",r.fileStreams=[],r.newFileRef=0,r.isFirstFileOnSelection=!1,r.dragCounter=0,r.fileList=[],r.filesData=[],r.uploaderOptions=e,r}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,o=Object.keys(e);r<o.length;r++){var a=o[r];switch(a){case"allowedExtensions":this.setExtensions(this.allowedExtensions),this.clearAll();break;case"enabled":this.setControlStatus();break;case"multiple":this.setMultipleSelection();break;case"enableRtl":this.setRTL(),this.reRenderFileList();break;case"buttons":this.buttons.browse=d(this.buttons.browse)?"":this.buttons.browse,this.buttons.clear=d(this.buttons.clear)?"":this.buttons.clear,this.buttons.upload=d(this.buttons.upload)?"":this.buttons.upload,this.renderButtonTemplates();break;case"dropArea":this.unBindDropEvents(),this.updateDropArea();break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.checkHTMLAttributes(!0);break;case"files":this.renderPreLoadFiles();break;case"directoryUpload":this.updateDirectoryAttributes();break;case"template":this.isReact?this.reRenderFileList():this.clearAll();break;case"minFileSize":case"maxFileSize":case"autoUpload":this.clearAll();break;case"sequentialUpload":this.clearAll();break;case"locale":this.l10n.setLocale(this.locale),this.setLocalizedTexts(),this.preLocaleObj=Z("currentLocale",this.l10n);break;case"cssClass":this.setCSSClass(i.cssClass);break}}},t.prototype.setLocalizedTexts=function(){d(this.template)&&(typeof this.buttons.browse=="string"&&(this.browseButton.innerText=this.buttons.browse==="Browse..."?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText),this.uploadWrapper&&!d(this.uploadWrapper.querySelector("."+ua))&&(this.uploadWrapper.querySelector("."+ua).innerHTML=this.localizedTexts("dropFilesHint"))),this.updateFileList())},t.prototype.getKeyValue=function(e){for(var i,r=0,o=Object.keys(this.preLocaleObj);r<o.length;r++){var a=o[r];this.preLocaleObj[""+a]===e&&(i=a)}return i},t.prototype.updateFileList=function(){var e;if(this.fileList.length>0&&!d(this.uploadWrapper.querySelector("."+$s)))for(var i=0;i<this.fileList.length;i++)e=this.fileList[i].querySelector(".e-file-status"),e.innerHTML=this.localizedTexts(this.getKeyValue(this.filesData[i].status)),this.filesData[i].status=this.localizedTexts(this.getKeyValue(this.filesData[i].status)),this.fileList[i].classList.contains(St)&&this.fileList[i].querySelector(".e-icons").setAttribute("title",this.localizedTexts("delete")),this.fileList[i].querySelector(".e-file-play-btn")&&this.fileList[i].querySelector(".e-icons").setAttribute("title",this.localizedTexts("resume")),this.fileList[i].querySelector(".e-file-remove-btn")&&this.fileList[i].querySelector(".e-icons").setAttribute("title",this.localizedTexts("remove")),this.fileList[i].querySelector(".e-file-reload-btn")&&this.fileList[i].querySelector(".e-icons").setAttribute("title",this.localizedTexts("retry")),this.autoUpload||(this.uploadButton.innerText=this.buttons.upload==="Upload"?this.localizedTexts("Upload"):this.buttons.upload,this.uploadButton.setAttribute("title",this.localizedTexts("Upload")),this.clearButton.innerText=this.buttons.clear==="Clear"?this.localizedTexts("Clear"):this.buttons.clear,this.clearButton.setAttribute("title",this.localizedTexts("Clear")))},t.prototype.reRenderFileList=function(){this.listParent&&(X(this.listParent),this.listParent=null,this.fileList=[],this.internalCreateFileList(this.filesData),this.actionButtons&&(this.removeActionButtons(),this.renderActionButtons(),this.checkActionButtonStatus()))},t.prototype.preRender=function(){this.localeText={Browse:"Browse...",Clear:"Clear",Upload:"Upload",invalidFileName:"File Name is not allowed",dropFilesHint:"Or drop files here",invalidMaxFileSize:"File size is too large",invalidMinFileSize:"File size is too small",invalidFileType:"File type is not allowed",uploadFailedMessage:"File failed to upload",uploadSuccessMessage:"File uploaded successfully",removedSuccessMessage:"File removed successfully",removedFailedMessage:"Unable to remove file",inProgress:"Uploading",readyToUploadMessage:"Ready to upload",abort:"Abort",remove:"Remove",cancel:"Cancel",delete:"Delete file",pauseUpload:"File upload paused",pause:"Pause",resume:"Resume",retry:"Retry",fileUploadCancel:"File upload canceled",invalidFileSelection:"Invalid files selected",totalFiles:"Total files",size:"Size"},this.l10n=new Mi("uploader",this.localeText,this.locale),this.preLocaleObj=Z("currentLocale",this.l10n),this.formRendered(),this.updateHTMLAttrToElement(),this.checkHTMLAttributes(!1);var e=Z("ej2_instances",this.element);if(this.element.tagName==="EJS-UPLOADER"){var i=this.createElement("input",{attrs:{type:"file"}}),r=0;for(r;r<this.element.attributes.length;r++)this.element.attributes[r].nodeName!=="id"?i.setAttribute(this.element.attributes[r].nodeName,this.element.attributes[r].nodeValue):this.element.attributes[r].nodeName==="id"&&i.setAttribute(this.element.attributes[r].nodeName,Ve("uploader")),i.innerHTML=this.element.innerHTML;i.hasAttribute("name")||i.setAttribute("name","UploadFiles"),this.element.appendChild(i),this.element=i,Ae("ej2_instances",e,this.element)}e[0].isPureReactComponent&&(d(e[0].props.name)?!d(e[0].props.id)&&d(e[0].props.name)?this.element.setAttribute("name",e[0].props.id):this.element.setAttribute("name","UploadFiles"):this.element.setAttribute("name",e[0].props.name)),d(this.element.getAttribute("name"))&&this.element.setAttribute("name",this.element.getAttribute("id")),this.element.hasAttribute("type")||this.element.setAttribute("type","file"),this.updateDirectoryAttributes(),this.keyConfigs={enter:"enter"},this.element.hasAttribute("tabindex")&&(this.tabIndex=this.element.getAttribute("tabindex")),this.browserName=S.info.name,this.uploaderName=this.element.getAttribute("name")},t.prototype.formRendered=function(){var e=ce(this.element,"form");if(!d(e))for(;e&&e!==document.documentElement;e=e.parentElement)e.tagName==="FORM"&&(this.isForm=!0,this.formElement=e,e.setAttribute("enctype","multipart/form-data"),e.setAttribute("encoding","multipart/form-data"))},t.prototype.getPersistData=function(){return this.addOnPersist(["filesData"])},t.prototype.getModuleName=function(){return"uploader"},t.prototype.updateDirectoryAttributes=function(){this.directoryUpload?(this.element.setAttribute("directory","true"),this.element.setAttribute("webkitdirectory","true")):(this.element.removeAttribute("directory"),this.element.removeAttribute("webkitdirectory"))},t.prototype.render=function(){this.renderBrowseButton(),this.initializeUpload(),this.updateHTMLAttrToWrapper(),this.wireEvents(),this.setMultipleSelection(),this.setExtensions(this.allowedExtensions),this.setRTL(),this.renderPreLoadFiles(),this.setControlStatus(),this.setCSSClass()},t.prototype.renderBrowseButton=function(){this.browseButton=this.createElement("button",{className:"e-css e-btn",attrs:{type:"button"}}),this.browseButton.setAttribute("tabindex",this.tabIndex),typeof this.buttons.browse=="string"?(this.browseButton.textContent=this.buttons.browse==="Browse..."?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText)):this.browseButton.appendChild(this.buttons.browse),this.element.setAttribute("aria-label","Uploader")},t.prototype.renderActionButtons=function(){this.element.setAttribute("tabindex","-1"),this.actionButtons=this.createElement("div",{className:Pv}),this.uploadButton=this.createElement("button",{className:Ev,attrs:{type:"button",tabindex:this.btnTabIndex,"aria-label":this.localizedTexts("Upload")}}),this.clearButton=this.createElement("button",{className:Lv,attrs:{type:"button",tabindex:this.btnTabIndex,"aria-label":this.localizedTexts("Clear")}}),this.actionButtons.appendChild(this.clearButton),this.actionButtons.appendChild(this.uploadButton),this.renderButtonTemplates(),this.uploadWrapper.appendChild(this.actionButtons),this.browseButton.blur(),this.isPreloadFiles||this.uploadButton.focus(),this.wireActionButtonEvents()},t.prototype.serverActionButtonsEventBind=function(e){e&&!this.isForm&&(this.browseButton.blur(),this.actionButtons=e,this.uploadButton=this.actionButtons.querySelector(".e-file-upload-btn"),this.clearButton=this.actionButtons.querySelector(".e-file-clear-btn"),this.uploadButton.focus(),this.unwireActionButtonEvents(),this.wireActionButtonEvents(),this.checkActionButtonStatus())},t.prototype.wireActionButtonEvents=function(){b.add(this.uploadButton,"click",this.uploadButtonClick,this),b.add(this.clearButton,"click",this.clearButtonClick,this)},t.prototype.unwireActionButtonEvents=function(){b.remove(this.uploadButton,"click",this.uploadButtonClick),b.remove(this.clearButton,"click",this.clearButtonClick)},t.prototype.removeActionButtons=function(){this.actionButtons&&(this.unwireActionButtonEvents(),X(this.actionButtons),this.actionButtons=null)},t.prototype.renderButtonTemplates=function(){if(typeof this.buttons.browse=="string"?(this.browseButton.textContent=this.buttons.browse==="Browse..."?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.textContent)):(this.browseButton.innerHTML="",this.browseButton.appendChild(this.buttons.browse)),this.uploadButton){var e=d(this.buttons.upload)?"Upload":this.buttons.upload;this.buttons.upload=e,typeof this.buttons.upload=="string"?(this.uploadButton.textContent=this.buttons.upload==="Upload"?this.localizedTexts("Upload"):this.buttons.upload,this.uploadButton.setAttribute("title",this.uploadButton.textContent)):(this.uploadButton.innerHTML="",this.uploadButton.appendChild(this.buttons.upload))}if(this.clearButton){var i=d(this.buttons.clear)?"Clear":this.buttons.clear;this.buttons.clear=i,typeof this.buttons.clear=="string"?(this.clearButton.textContent=this.buttons.clear==="Clear"?this.localizedTexts("Clear"):this.buttons.clear,this.clearButton.setAttribute("title",this.clearButton.textContent)):(this.clearButton.innerHTML="",this.clearButton.appendChild(this.buttons.clear))}},t.prototype.initializeUpload=function(){this.element.setAttribute("tabindex","-1");var e=this.createElement("span",{className:Ks});this.element.parentElement.insertBefore(e,this.element),this.dropAreaWrapper=this.createElement("div",{className:zv}),this.element.parentElement.insertBefore(this.dropAreaWrapper,this.element),e.appendChild(this.element),this.dropAreaWrapper.appendChild(this.browseButton),this.dropAreaWrapper.appendChild(e),this.uploadWrapper=this.createElement("div",{className:Av}),this.dropAreaWrapper.parentElement.insertBefore(this.uploadWrapper,this.dropAreaWrapper),this.uploadWrapper.appendChild(this.dropAreaWrapper),this.setDropArea()},t.prototype.renderPreLoadFiles=function(){if(this.files.length){if(this.enablePersistence&&this.filesData.length){this.internalCreateFileList(this.filesData);return}if(d(this.files[0].size))return;this.isPreloadFiles=!0;var e=[].slice.call(this.files),i=[];this.multiple||(this.clearData(),e=[e[0]]);for(var r=0,o=e;r<o.length;r++){var a=o[r],n={name:a.name+"."+a.type.split(".")[a.type.split(".").length-1],rawFile:"",size:a.size,status:this.localizedTexts("uploadSuccessMessage"),type:a.type,validationMessages:{minSize:"",maxSize:""},statusCode:"2"};i.push(n),this.filesData.push(n)}this.internalCreateFileList(i),!this.autoUpload&&this.listParent&&!this.actionButtons&&(!this.isForm||this.allowUpload())&&this.showFileList&&this.renderActionButtons(),this.checkActionButtonStatus(),this.sequentialUpload&&(this.count=this.filesData.length-1),this.isPreloadFiles=!1}},t.prototype.checkActionButtonStatus=function(){if(this.actionButtons){var e=this.uploadWrapper.querySelectorAll("."+ol).length+this.uploadWrapper.querySelectorAll(".e-upload-fails:not(.e-upload-progress)").length+this.uploadWrapper.querySelectorAll("span."+St).length+this.uploadWrapper.querySelectorAll("span."+Ct).length;e>0&&e===this.uploadWrapper.querySelectorAll("li").length?this.uploadButton.setAttribute("disabled","disabled"):this.uploadButton.removeAttribute("disabled")}},t.prototype.setDropArea=function(){var e=this.dropAreaWrapper.querySelector(".e-file-drop");if(this.dropArea){this.dropZoneElement=typeof this.dropArea!="string"?this.dropArea:te(this.dropArea,document);for(var i=this.element,r=!1;i.parentNode;)i=i.parentNode,i===this.dropZoneElement&&(r=!0,e?e.innerHTML=this.localizedTexts("dropFilesHint"):this.createDropTextHint());!r&&e&&it(e)}else!d(this.uploaderOptions)&&this.uploaderOptions.dropArea===void 0&&(this.createDropTextHint(),this.dropZoneElement=this.uploadWrapper,this.setProperties({dropArea:this.uploadWrapper},!0));this.bindDropEvents()},t.prototype.updateDropArea=function(){if(this.dropArea)this.setDropArea();else{this.dropZoneElement=null;var e=this.dropAreaWrapper.querySelector(".e-file-drop");e&&it(e)}},t.prototype.createDropTextHint=function(){var e=this.createElement("span",{className:ua});e.innerHTML=this.localizedTexts("dropFilesHint"),this.dropAreaWrapper.appendChild(e)},t.prototype.updateHTMLAttrToElement=function(){if(!d(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];sl.indexOf(r)<0&&this.element.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.updateHTMLAttrToWrapper=function(){if(!d(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(sl.indexOf(r)>-1)if(r==="class"){var o=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();o!==""&&W([this.uploadWrapper],o.split(" "))}else if(r==="style"){var a=this.uploadWrapper.getAttribute(r);a=d(a)?this.htmlAttributes[""+r]:a+this.htmlAttributes[""+r],this.uploadWrapper.setAttribute(r,a)}else this.uploadWrapper.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.setMultipleSelection=function(){if(this.multiple&&!this.element.hasAttribute("multiple")){var e=document.createAttribute("multiple");e.value="multiple",this.element.setAttributeNode(e)}else this.multiple||this.element.removeAttribute("multiple")},t.prototype.checkAutoUpload=function(e){this.autoUpload?(this.sequentialUpload?this.sequenceUpload(e):this.upload(e),this.removeActionButtons()):this.actionButtons||this.renderActionButtons(),this.checkActionButtonStatus()},t.prototype.sequenceUpload=function(e){if(this.filesData.length-e.length===0||this.filesData[this.filesData.length-e.length-1].statusCode!=="1"){(this.multiple||this.count<0)&&++this.count;var i=!this.showFileList;typeof this.filesData[this.count]=="object"?(this.isFirstFileOnSelection=!1,this.upload(this.filesData[this.count],i),this.filesData[this.count].statusCode==="0"&&this.sequenceUpload(e)):--this.count}},t.prototype.setCSSClass=function(e){var i=e;d(e)||(i=e.replace(/\s+/g," ").trim()),!d(e)&&i!==""&&G([this.uploadWrapper],i.split(" "));var r=this.cssClass;!d(this.cssClass)&&this.cssClass!==""&&(r=this.cssClass.replace(/\s+/g," ").trim()),!d(this.cssClass)&&r!==""&&W([this.uploadWrapper],r.split(r.indexOf(",")>-1?",":" "))},t.prototype.wireEvents=function(){b.add(this.browseButton,"click",this.browseButtonClick,this),b.add(this.element,"change",this.onSelectFiles,this),b.add(document,"click",this.removeFocus,this),this.keyboardModule=new bo(this.uploadWrapper,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.isForm&&b.add(this.formElement,"reset",this.resetForm,this)},t.prototype.unWireEvents=function(){b.remove(this.browseButton,"click",this.browseButtonClick),b.remove(this.element,"change",this.onSelectFiles),b.remove(document,"click",this.removeFocus),this.isForm&&b.remove(this.formElement,"reset",this.resetForm),this.keyboardModule&&this.keyboardModule.destroy()},t.prototype.resetForm=function(){this.clearAll()},t.prototype.keyActionHandler=function(e){var i=e.target;switch(e.action){case"enter":if(e.target===this.clearButton)this.clearButtonClick();else if(e.target===this.uploadButton)this.uploadButtonClick();else if(e.target===this.browseButton)this.browseButtonClick();else if(i.classList.contains(et)){var r=this.getCurrentMetaData(null,e);r.file.statusCode="4",r.file.status=this.localizedTexts("pauseUpload"),this.abortUpload(r,!1)}else if(i.classList.contains(ui))this.resumeUpload(this.getCurrentMetaData(null,e),e);else if(i.classList.contains(Yt)){var r=this.getCurrentMetaData(null,e);if(!d(r))r.file.statusCode="1",r.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(r.file);else{var o=e.target.parentElement,a=this.filesData[this.fileList.indexOf(o)];this.retry(a)}}else this.removeFiles(e),i.classList.contains(Fe)||this.browseButton.focus();e.preventDefault(),e.stopPropagation();break}},t.prototype.getCurrentMetaData=function(e,i){var r,o;if(d(e)){var a=i.target.parentElement;r=this.filesData[this.fileList.indexOf(a)]}else r=e;for(var n=0;n<this.uploadMetaData.length;n++)this.uploadMetaData[n].file.name===r.name&&(o=this.uploadMetaData[n]);return o},t.prototype.removeFocus=function(){this.uploadWrapper&&this.listParent&&this.listParent.querySelector("."+va)&&(document.activeElement.blur(),this.listParent.querySelector("."+va).classList.remove(va))},t.prototype.browseButtonClick=function(){this.element.click()},t.prototype.uploadButtonClick=function(){this.sequentialUpload?this.sequenceUpload(this.filesData):this.upload(this.filesData)},t.prototype.clearButtonClick=function(){this.clearAll(),this.sequentialUpload&&(this.count=-1),this.actionCompleteCount=0},t.prototype.bindDropEvents=function(){this.dropZoneElement&&(b.add(this.dropZoneElement,"drop",this.dropElement,this),b.add(this.dropZoneElement,"dragover",this.dragHover,this),b.add(this.dropZoneElement,"dragleave",this.onDragLeave,this),b.add(this.dropZoneElement,"paste",this.onPasteFile,this),b.add(this.dropZoneElement,"dragenter",this.onDragEnter,this))},t.prototype.unBindDropEvents=function(){this.dropZoneElement&&(b.remove(this.dropZoneElement,"drop",this.dropElement),b.remove(this.dropZoneElement,"dragover",this.dragHover),b.remove(this.dropZoneElement,"dragleave",this.onDragLeave),b.remove(this.dropZoneElement,"dragenter",this.onDragEnter))},t.prototype.onDragEnter=function(e){this.enabled&&(this.dropZoneElement.classList.add(ca),this.dragCounter=this.dragCounter+1,e.preventDefault(),e.stopPropagation())},t.prototype.onDragLeave=function(){this.enabled&&(this.dragCounter=this.dragCounter-1,this.dragCounter||this.dropZoneElement.classList.remove(ca))},t.prototype.dragHover=function(e){this.enabled&&(this.dropEffect!=="Default"&&(e.dataTransfer.dropEffect=this.dropEffect.toLowerCase()),e.preventDefault(),e.stopPropagation())},t.prototype.dropElement=function(e){this.dragCounter=0,this.dropZoneElement.classList.remove(ca),this.onSelectFiles(e),e.preventDefault(),e.stopPropagation()},t.prototype.onPasteFile=function(e){var i=e.clipboardData.items;if(e.type==="paste"&&this.browserName!=="msie"&&this.browserName!=="edge"&&this.browserName!=="safari"&&(this.element.files=e.clipboardData.files),!(i.length!==1&&!this.multiple))for(var r=0;r<i.length;r++){var o=[].slice.call(i)[r];!d(o.getAsFile())&&(o.kind==="file"||o.type.match("^image/"))&&this.renderSelectedFiles(e,[o.getAsFile()],!1,!0)}},t.prototype.getSelectedFiles=function(e){for(var i=[],r=this.fileList[e],o=this.getFilesData(),a=+r.getAttribute("data-files-count"),n=0,s=0;s<e;s++)n+=+this.fileList[s].getAttribute("data-files-count");for(var h=n;h<n+a;h++)i.push(o[h]);return i},t.prototype.removeFiles=function(e){if(this.enabled){var i=e.target.parentElement,r=this.fileList.indexOf(i),o=this.fileList[r],a=this.isFormUpload(),n=a?this.getSelectedFiles(r):this.getFilesInArray(this.filesData[r]);if(!d(n)){if(e.target.classList.contains(Fe)&&!a){if(n[0].statusCode="5",!d(o)){var s=o.querySelector("."+Fe);yo({target:s,width:"20px"}),Bt(s)}this.sequentialUpload&&this.uploadSequential(),o.classList.contains(er)||this.checkActionComplete(!0)}else ce(e.target,"."+rl)||this.remove(n,!1,!1,!0,e);if(this.isForm&&o&&o.classList.contains(Di)&&(this.element.value=""),this.checkActionButtonStatus(),this.actionButtons&&this.clearButton&&this.uploadWrapper){var h=this.uploadWrapper.querySelectorAll(".e-upload-progress-bar.e-upload-progress:not(.e-upload-success):not(.e-upload-fails)");h.length===1&&i.contains(h[0])&&this.clearButton.hasAttribute("disabled")&&this.clearButton.removeAttribute("disabled")}}}},t.prototype.removeFilesData=function(e,i){var r;if(i){this.showFileList||(r=this.filesData.indexOf(e),this.filesData.splice(r,1));return}var o=this.getLiElement(e);d(o)||(this.element.value="",X(o),r=this.fileList.indexOf(o),this.fileList.splice(r,1),this.filesData.splice(r,1),this.fileList.length===0&&!d(this.listParent)&&(X(this.listParent),this.listParent=null,this.removeActionButtons()),this.sequentialUpload&&r<=this.count&&--this.count)},t.prototype.removeUploadedFile=function(e,i,r,o){var a=this,n=e,s=new Zi(this.asyncSettings.removeUrl,"POST",!0,null);s.emitError=!1;var h=new FormData;s.beforeSend=function(p){i.currentRequest=s.httpRequest,r?a.removingEventCallback(i,h,n,e):a.trigger("removing",i,function(u){u.cancel?p.cancel=!0:a.removingEventCallback(u,h,n,e)})},s.onLoad=function(p){return a.removeCompleted(p,n,o),{}},s.onError=function(p){return a.removeFailed(p,n,o),{}},s.send(h)},t.prototype.removingEventCallback=function(e,i,r,o){var a=this.element.getAttribute("name"),n=this.getLiElement(o);if(!d(n)&&(!d(n.querySelector("."+mt))||!d(n.querySelector("."+Ze)))){var s=n.querySelector("."+mt)?n.querySelector("."+mt):n.querySelector("."+Ze);yo({target:s,width:"20px"}),Bt(s)}e.postRawFile&&!d(r.rawFile)&&r.rawFile!==""?i.append(a,r.rawFile,r.name):i.append(a,r.name),this.updateFormData(i,e.customFormData)},t.prototype.updateFormData=function(e,i){if(i.length>0&&i[0])for(var r=function(a){var n=i[a],s=Object.keys(n).map(function(h){return n[""+h]});e.append(Object.keys(n)[0],s)},o=0;o<i.length;o++)r(o)},t.prototype.updateCustomheader=function(e,i){if(i.length>0&&i[0])for(var r=function(a){var n=i[a],s=Object.keys(n).map(function(h){return n[""+h]});e.setRequestHeader(Object.keys(n)[0],s)},o=0;o<i.length;o++)r(o)},t.prototype.removeCompleted=function(e,i,r){var o=e&&e.currentTarget?this.getResponse(e):null,a=e.target;if(a.readyState===4&&a.status>=200&&a.status<=299){var n={e,response:o,operation:"remove",file:this.updateStatus(i,this.localizedTexts("removedSuccessMessage"),"2")};this.trigger("success",n),this.removeFilesData(i,r);var s=this.uploadedFilesData.indexOf(i);this.uploadedFilesData.splice(s,1),this.trigger("change",{files:this.uploadedFilesData})}else this.removeFailed(e,i,r)},t.prototype.removeFailed=function(e,i,r){var o=e&&e.currentTarget?this.getResponse(e):null,a={e,response:o,operation:"remove",file:this.updateStatus(i,this.localizedTexts("removedFailedMessage"),"0")};if(!r){var n=this.filesData.indexOf(i),s=this.fileList[n];if(s){s.classList.remove(St),s.classList.add(Mt);var h=s.querySelector("."+Re);h&&(h.classList.remove(St),h.classList.add(Mt))}this.checkActionButtonStatus()}this.trigger("failure",a);var p=this.getLiElement(i);if(!d(p)&&!d(p.querySelector("."+mt))){var u=p.querySelector("."+mt);gt(u),X(p.querySelector(".e-spinner-pane"))}},t.prototype.getFilesFromFolder=function(e){this.filesEntries=[];var i=this.multiple?e.dataTransfer.items:[e.dataTransfer.items[0]],r=this.checkDirectoryUpload(i);if(r)for(var o=function(s){var h=i[s].webkitGetAsEntry();if(h.isFile){var p=[];h.file(function(u){var c=h.fullPath;p.push({path:c,file:u})}),a.renderSelectedFiles(e,p,!0)}else h.isDirectory&&a.traverseFileTree(h,e)},a=this,n=0;n<i.length;n++)o(n)},t.prototype.checkDirectoryUpload=function(e){for(var i=0;e&&i<e.length;i++){var r=e[i].webkitGetAsEntry();if(r.isDirectory)return!0}return!1},t.prototype.traverseFileTree=function(e,i){if(e.isFile)this.filesEntries.push(e);else if(e.isDirectory){var r=e.createReader();this.readFileFromDirectory(r,i)}},t.prototype.readFileFromDirectory=function(e,i){var r=this;e.readEntries(function(o){for(var a=0;a<o.length;a++)r.traverseFileTree(o[a],i);r.pushFilesEntries(i),o.length&&r.readFileFromDirectory(e)})},t.prototype.pushFilesEntries=function(e){for(var i=this,r=[],o=function(s){a.filesEntries[s].file(function(h){if(i.filesEntries.length){var p=i.filesEntries[s].fullPath;r.push({path:p,file:h}),s===i.filesEntries.length-1&&(i.filesEntries=[],i.renderSelectedFiles(e,r,!0))}})},a=this,n=0;n<this.filesEntries.length;n++)o(n)},t.prototype.onSelectFiles=function(e){if(this.enabled){var i;if(e.type==="drop")if(this.directoryUpload)this.getFilesFromFolder(e);else{var r=this.sortFilesList=e.dataTransfer.files;this.browserName!=="msie"&&this.browserName!=="edge"&&this.browserName!=="safari"&&(this.element.files=r),r.length>0&&(i=this.multiple?this.sortFileList(r):[r[0]],this.renderSelectedFiles(e,i))}else i=[].slice.call(e.target.files),this.renderSelectedFiles(e,i);(this.isAngular||this.isReact)&&e.stopPropagation()}},t.prototype.getBase64=function(e){return new Promise(function(i,r){var o=new FileReader;o.readAsDataURL(e),o.onload=function(){return i(o.result)},o.onerror=function(a){return r(a)}})},t.prototype.renderSelectedFiles=function(e,i,r,o){var a=this;this.base64String=[];var n={event:e,cancel:!1,filesData:[],isModified:!1,modifiedFilesData:[],progressInterval:"",isCanceled:!1,currentRequest:null,customFormData:null};if(i.length<1){n.isCanceled=!0,this.trigger("selected",n);return}this.flag=!0;var s=[];this.multiple||(this.clearData(!0),this.actionCompleteCount=0,i=[i[0]]);for(var h=0;h<i.length;h++){var p=r?i[h].file:i[h];this.updateInitialFileDetails(e,i,p,h,s,r,o)}if(n.filesData=s,!d(this.allowedExtensions)&&this.allowedExtensions.indexOf("*")>-1&&(this.allTypes=!0),this.enableHtmlSanitizer)for(var h=0;h<s.length;h++){for(var u=pt.beforeSanitize(),c=pt.serializeValue(u,s[parseInt(h.toString(),10)].name),f=s[parseInt(h.toString(),10)].name,g=!1,v=0;v<f.length;v++)if(f.charCodeAt(v)>127){g=!0;break}var m=/<([a-z][a-z0-9]*)\b[^>]*>(.*?)<\/\1>/i,C=m.test(f);if(c!==s[parseInt(h.toString(),10)].name&&!(g&&!C)){var M=i[parseInt(h.toString(),10)].name.replace(/[\u00A0-\u9999<>\\&]/g,function(N){return"&#"+N.charCodeAt(0)+";"});s[parseInt(h.toString(),10)].name=M,s[parseInt(h.toString(),10)].status=this.localizedTexts("invalidFileName"),s[parseInt(h.toString(),10)].statusCode="0"}}this.allTypes||(s=this.checkExtension(s)),this.trigger("selected",n,function(I){a._internalRenderSelect(I,s)})},t.prototype.updateInitialFileDetails=function(e,i,r,o,a,n,s){var h=n?i[o].path.substring(1,i[o].path.length):s?Ve(r.name.substring(0,r.name.lastIndexOf(".")))+"."+this.getFileType(r.name):this.directoryUpload?i[o].webkitRelativePath:r.name,p={name:h,rawFile:r,size:r.size,status:this.localizedTexts("readyToUploadMessage"),type:this.getFileType(r.name),validationMessages:this.validatedFileSize(r.size),statusCode:"1",id:Ve(r.name.substring(0,r.name.lastIndexOf(".")))+"."+this.getFileType(r.name)};s&&(p.fileSource="paste"),p.status=p.validationMessages.minSize!==""?this.localizedTexts("invalidMinFileSize"):p.validationMessages.maxSize!==""?this.localizedTexts("invalidMaxFileSize"):p.status,(p.validationMessages.minSize!==""||p.validationMessages.maxSize!=="")&&(p.statusCode="0",this.checkActionComplete(!0)),a.push(p)},t.prototype._internalRenderSelect=function(e,i){if(!e.cancel){if(this.selectedFiles=this.selectedFiles.concat(i),this.btnTabIndex=this.disableKeyboardNavigation?"-1":"0",this.showFileList){if(e.isModified&&e.modifiedFilesData.length>0){for(var r=0;r<e.modifiedFilesData.length;r++)for(var o=0;o<i.length;o++)e.modifiedFilesData[r].id===i[o].id&&(e.modifiedFilesData[r].rawFile=i[o].rawFile);var a=this.allTypes?e.modifiedFilesData:this.checkExtension(e.modifiedFilesData);this.updateSortedFileList(a),this.filesData=this.filesData.concat(a),(!this.isForm||this.allowUpload())&&this.checkAutoUpload(a)}else{if(this.internalCreateFileList(i),this.autoUpload&&this.sequenceUpload&&this.sequentialUpload&&this.filesData.length>0&&this.filesData[this.filesData.length-1].statusCode!=="2"&&this.filesData[this.filesData.length-1].statusCode!=="0"){this.filesData=this.filesData.concat(i);return}this.filesData=this.filesData.concat(i),(!this.isForm||this.allowUpload())&&this.checkAutoUpload(i)}!d(e.progressInterval)&&e.progressInterval!==""&&(this.progressInterval=e.progressInterval)}else this.filesData=this.filesData.concat(i),this.autoUpload&&this.upload(this.filesData,!0);this.raiseActionComplete(),this.isFirstFileOnSelection=!0}},t.prototype.allowUpload=function(){var e=!1;return this.isForm&&!d(this.asyncSettings.saveUrl)&&this.asyncSettings.saveUrl!==""&&(e=!0),e},t.prototype.isFormUpload=function(){var e=!1;return this.isForm&&(d(this.asyncSettings.saveUrl)||this.asyncSettings.saveUrl==="")&&(d(this.asyncSettings.removeUrl)||this.asyncSettings.removeUrl==="")&&(e=!0),e},t.prototype.clearData=function(e){d(this.listParent)||(X(this.listParent),this.listParent=null),this.browserName!=="msie"&&!e&&(this.element.value=""),this.fileList=[],this.filesData=[],this.removeActionButtons()},t.prototype.updateSortedFileList=function(e){var i=this.createElement("div",{id:"clonewrapper"}),r=-1;if(this.listParent){for(var o=0;o<this.listParent.querySelectorAll("li").length;o++){var a=this.listParent.querySelectorAll("li")[o];i.appendChild(a.cloneNode(!0))}this.removeActionButtons();var n=[].slice.call(i.childNodes);this.createParentUL();for(var s=0;s<e.length;s++){for(var h=0;h<this.filesData.length;h++)this.filesData[h].name===e[s].name&&(this.listParent.appendChild(n[h]),b.add(n[h].querySelector(".e-icons"),"click",this.removeFiles,this),this.fileList.push(n[h]),r=s);r!==s&&this.internalCreateFileList([e[s]])}}else this.internalCreateFileList(e)},t.prototype.isBlank=function(e){return!e||/^\s*$/.test(e)},t.prototype.checkGenericExtension=function(e,i){var r=[];switch(e.toLowerCase()){case"image/*":r.push("jpg","jpeg","png","gif","bmp","tiff","svg","webp","heic");break;case"audio/*":r.push("mp3","wav","aac","flac","ogg","m4a");break;case"video/*":r.push("mp4","mov","avi","mkv","flv","wmv","webm","mpeg");break;case"application/*":r.push("doc","docx","xls","xlsx","ppt","pptx","zip","rar","7z","tar","pdf");break;case"text/*":r.push("txt","csv","html","css","js","json","xml","md");break}return r.includes(i.toLowerCase())},t.prototype.checkExtension=function(e){var i=e;if(!this.isBlank(this.allowedExtensions)){for(var r=[],o=d(r)?[""]:this.allowedExtensions.split(","),a=0,n=o;a<n.length;a++){var s=n[a];r.push(s.trim().toLocaleLowerCase())}for(var h=0;h<e.length;h++){var p=e[h].type.indexOf(".")!==-1?e[h].type.replace(".",""):e[h].type;if(r[0].indexOf("/*")!==-1){var u=this.checkGenericExtension(r[0],p);u||(e[h].status=this.localizedTexts("invalidFileType"),e[h].statusCode="0")}else r.indexOf(("."+p).toLocaleLowerCase())===-1&&(e[h].status=this.localizedTexts("invalidFileType"),e[h].statusCode="0")}}return i},t.prototype.validatedFileSize=function(e){var i="",r="";e<this.minFileSize?i=this.localizedTexts("invalidMinFileSize"):e>this.maxFileSize?r=this.localizedTexts("invalidMaxFileSize"):(i="",r="");var o={minSize:i,maxSize:r};return o},t.prototype.isPreLoadFile=function(e){for(var i=!1,r=0;r<this.files.length;r++)this.files[r].name===e.name.slice(0,e.name.lastIndexOf("."))&&this.files[r].type===e.type&&(i=!0);return i},t.prototype.createCustomfileList=function(e){this.createParentUL();for(var i=0,r=e;i<r.length;i++){var o=r[i],a=this.createElement("li",{className:Vr,attrs:{"data-file-name":o.name}});this.uploadTemplateFn=this.templateComplier(this.template);var n=this.uploadTemplateFn(o,this,"template",this.element.id+"Template",this.isStringTemplate,null,a);if(n){var s=[].slice.call(n);Qi(s,a)}var h=e.indexOf(o),p={element:a,fileInfo:o,index:h,isPreload:this.isPreLoadFile(o)},u={element:a,fileInfo:o,index:h,isPreload:this.isPreLoadFile(o)};this.trigger("rendering",p),this.trigger("fileListRendering",u),this.listParent.appendChild(a),this.fileList.push(a)}this.renderReactTemplates()},t.prototype.createParentUL=function(){d(this.listParent)&&(this.listParent=this.createElement("ul",{className:$s}),this.uploadWrapper.appendChild(this.listParent))},t.prototype.formFileList=function(e,i){var r=this.createElement("li",{className:Vr});r.setAttribute("data-files-count",e.length+"");for(var o=this.createElement("span",{className:fa}),a,n=0,s=e;n<s.length;n++){var h=s[n],p=this.createElement("span",{className:el});p.innerHTML=this.getFileNameOnly(h.name);var u=this.createElement("span",{className:tl}),c=this.getFileType(h.name);if(u.innerHTML="."+c,c||u.classList.add("e-hidden"),!this.enableRtl)o.appendChild(p),o.appendChild(u);else{var f=this.createElement("span",{className:nl});f.appendChild(u),f.appendChild(p),o.appendChild(f)}this.truncateName(p),a=this.formValidateFileInfo(h,r)}r.appendChild(o),this.setListToFileInfo(e,r);var g=this.listParent.querySelectorAll("li").length,v=this.createElement("span");if(r.classList.contains(Di)?(v.classList.add(Re),v.classList.add(Di),v.innerText=e.length>1?this.localizedTexts("invalidFileSelection"):a):(v.classList.add(e.length>1?Fv:il),v.innerText=e.length>1?this.localizedTexts("totalFiles")+": "+e.length+" , "+this.localizedTexts("size")+": "+this.bytesToSize(this.getFileSize(e)):this.bytesToSize(e[0].size),this.createFormInput(e)),o.appendChild(v),d(r.querySelector(".e-icons"))){var m=this.createElement("span",{className:"e-icons",attrs:{tabindex:this.btnTabIndex}});this.browserName==="msie"&&m.classList.add("e-msie"),m.setAttribute("title",this.localizedTexts("remove")),r.appendChild(o),r.appendChild(m),b.add(m,"click",this.removeFiles,this),m.classList.add(Ze)}var C={element:r,fileInfo:this.mergeFileInfo(e,r),index:g,isPreload:this.isPreLoadFile(this.mergeFileInfo(e,r))},M={element:r,fileInfo:this.mergeFileInfo(e,r),index:g,isPreload:this.isPreLoadFile(this.mergeFileInfo(e,r))};this.trigger("rendering",C),this.trigger("fileListRendering",M),this.listParent.appendChild(r),this.fileList.push(r)},t.prototype.formValidateFileInfo=function(e,i){var r=e.status,o=this.validatedFileSize(e.size);(o.minSize!==""||o.maxSize!=="")&&(this.addInvalidClass(i),r=o.minSize!==""?this.localizedTexts("invalidMinFileSize"):o.maxSize!==""?this.localizedTexts("invalidMaxFileSize"):r);var a=this.checkExtension(this.getFilesInArray(e))[0].status;return a===this.localizedTexts("invalidFileType")&&(this.addInvalidClass(i),r=a),r},t.prototype.addInvalidClass=function(e){e.classList.add(Di)},t.prototype.createFormInput=function(e){if(this.browserName!=="safari"){var i=this.element.cloneNode(!0);i.classList.add(Yv);for(var r=0,o=e;r<o.length;r++){var a=o[r];a.input=i}i.setAttribute("id",Ve("hiddenUploader")),i.setAttribute("name",this.uploaderName),this.uploadWrapper.querySelector("."+Ks).appendChild(i),this.browserName!=="msie"&&this.browserName!=="edge"&&(this.element.value="")}},t.prototype.getFileSize=function(e){for(var i=0,r=0,o=e;r<o.length;r++){var a=o[r];i+=a.size}return i},t.prototype.mergeFileInfo=function(e,i){for(var r={name:"",rawFile:"",size:0,status:"",type:"",validationMessages:{minSize:"",maxSize:""},statusCode:"1",list:i},o=[],a="",n=0,s=e;n<s.length;n++){var h=s[n];o.push(h.name),a=h.type}return r.name=o.join(", "),r.size=this.getFileSize(e),r.type=a,r.status=this.statusForFormUpload(e,i),r},t.prototype.statusForFormUpload=function(e,i){for(var r=!0,o,a=0,n=e;a<n.length;a++){var s=n[a];o=s.status;var h=this.validatedFileSize(s.size);(h.minSize!==""||h.maxSize!=="")&&(r=!1,o=h.minSize!==""?this.localizedTexts("invalidMinFileSize"):h.maxSize!==""?this.localizedTexts("invalidMaxFileSize"):o);var p=this.checkExtension(this.getFilesInArray(s))[0].status;p===this.localizedTexts("invalidFileType")&&(r=!1,o=p)}return r?o=this.localizedTexts("totalFiles")+": "+e.length+" , "+this.localizedTexts("size")+": "+this.bytesToSize(this.getFileSize(e)):(i.classList.add(Di),o=e.length>1?this.localizedTexts("invalidFileSelection"):o),o},t.prototype.formCustomFileList=function(e,i){this.createParentUL();var r=this.createElement("li",{className:Vr});r.setAttribute("data-files-count",e.length+""),this.setListToFileInfo(e,r);var o=this.mergeFileInfo(e,r);r.setAttribute("data-file-name",o.name),this.uploadTemplateFn=this.templateComplier(this.template);var a=this.uploadTemplateFn(o,this,"template",this.element.id+"Template",this.isStringTemplate,null,r);if(a){var n=[].slice.call(a);Qi(n,r)}var s=this.listParent.querySelectorAll("li").length;r.classList.contains(Di)||this.createFormInput(e);var h={element:r,fileInfo:o,index:s,isPreload:this.isPreLoadFile(o)},p={element:r,fileInfo:o,index:s,isPreload:this.isPreLoadFile(o)};this.trigger("rendering",h),this.trigger("fileListRendering",p),this.listParent.appendChild(r),this.fileList.push(r),this.renderReactTemplates()},t.prototype.createFileList=function(e){this.filesData=this.filesData&&this.filesData.length>0?this.filesData.concat(e):e,this.internalCreateFileList(e)},t.prototype.internalCreateFileList=function(e){if(this.createParentUL(),this.template!==""&&!d(this.template))this.isFormUpload()?(this.uploadWrapper.classList.add(ll),this.formCustomFileList(e,this.element.files)):this.createCustomfileList(e);else if(this.isFormUpload())this.uploadWrapper.classList.add(ll),this.formFileList(e,this.element.files);else for(var i=0,r=e;i<r.length;i++){var o=r[i],a=this.createElement("li",{className:Vr,attrs:{"data-file-name":o.name,"data-files-count":"1"}}),n=this.createElement("span",{className:fa}),s=this.createElement("span",{className:el,attrs:{title:o.name}});s.innerHTML=this.getFileNameOnly(o.name);var h=this.createElement("span",{className:tl}),p=this.getFileType(o.name);if(h.innerHTML="."+p,p||h.classList.add("e-hidden"),!this.enableRtl)n.appendChild(s),n.appendChild(h);else{var u=this.createElement("span",{className:nl});u.appendChild(h),u.appendChild(s),n.appendChild(u)}var c=this.createElement("span",{className:il});c.innerHTML=this.bytesToSize(o.size),n.appendChild(c);var f=this.createElement("span",{className:Re});n.appendChild(f),f.innerHTML=o.status,a.appendChild(n);var g=this.createElement("span",{className:" e-icons",attrs:{tabindex:this.btnTabIndex}});this.browserName==="msie"&&g.classList.add("e-msie"),g.setAttribute("title",this.localizedTexts("remove")),a.appendChild(g),b.add(g,"click",this.removeFiles,this),o.statusCode==="2"?(f.classList.add(St),g.classList.add(mt),g.setAttribute("title",this.localizedTexts("delete")),g.setAttribute("aria-label",this.localizedTexts("delete"))):o.statusCode!=="1"&&(f.classList.remove(St),f.classList.add(ol)),this.autoUpload&&o.statusCode==="1"&&this.asyncSettings.saveUrl!==""&&(f.innerHTML=""),g.classList.contains(mt)||(g.classList.add(Ze),g.setAttribute("aria-label",this.localizedTexts("remove")));var v=e.indexOf(o),m={element:a,fileInfo:o,index:v,isPreload:this.isPreLoadFile(o)},C={element:a,fileInfo:o,index:v,isPreload:this.isPreLoadFile(o)};this.trigger("rendering",m),this.trigger("fileListRendering",C),this.listParent.appendChild(a),this.fileList.push(a),this.truncateName(s);var M=this.flag;this.isPreLoadFile(o)&&(this.flag=!1,this.checkActionComplete(!0),this.flag=M)}},t.prototype.getSlicedName=function(e){var i=e.textContent;e.dataset.tail=i.slice(i.length-10)},t.prototype.setListToFileInfo=function(e,i){for(var r=0,o=e;r<o.length;r++){var a=o[r];a.list=i}},t.prototype.truncateName=function(e){var i=e;this.browserName!=="edge"&&i.offsetWidth<i.scrollWidth?this.getSlicedName(i):i.offsetWidth+1<i.scrollWidth&&this.getSlicedName(i)},t.prototype.getFileType=function(e){var i,r=e.lastIndexOf(".");return r>=0&&(i=e.substring(r+1)),i||""},t.prototype.getFileNameOnly=function(e){var i=this.getFileType(e),r=e.split("."+i);return i=r[0]},t.prototype.setInitialAttributes=function(){if(this.initialAttr.accept&&this.element.setAttribute("accept",this.initialAttr.accept),this.initialAttr.disabled&&this.element.setAttribute("disabled","disabled"),this.initialAttr.multiple){var e=document.createAttribute("multiple");this.element.setAttributeNode(e)}},t.prototype.filterfileList=function(e){for(var i=[],r,o=0;o<e.length;o++)r=this.getLiElement(e[o]),(!d(r)&&!r.classList.contains(St)||!this.showFileList&&e[o].status!=="File uploaded successfully")&&i.push(e[o]);return i},t.prototype.updateStatus=function(e,i,r,o){if(o===void 0&&(o=!0),!(i===""||d(i))&&!(r===""||d(r))&&(e.status=i,e.statusCode=r),o){var a=this.getLiElement(e);d(a)||!d(a.querySelector("."+Re))&&!(i===""||d(i))&&(a.querySelector("."+Re).textContent=i)}return e},t.prototype.getLiElement=function(e){for(var i,r=0;r<this.filesData.length;r++)!d(e)&&(!d(this.filesData[r].id)&&!d(e.id)?this.filesData[r].name===e.name&&this.filesData[r].id===e.id:this.filesData[r].name===e.name)&&(i=r);return this.fileList[i]},t.prototype.createProgressBar=function(e){var i=this.createElement("span",{className:pi}),r=this.createElement("progressbar",{className:qr,attrs:{value:"0",max:"100"}}),o=this.createElement("span",{className:kv});r.setAttribute("style","width: 0%");var a=this.createElement("span",{className:da});a.textContent="0%",o.appendChild(r),i.appendChild(o),i.appendChild(a),e.querySelector("."+fa).appendChild(i)},t.prototype.updateProgressbar=function(e,i){if(!isNaN(Math.round(e.loaded/e.total*100))&&!d(i.querySelector("."+qr)))if(!d(this.progressInterval)&&this.progressInterval!==""){var r=Math.round(e.loaded/e.total*100)%parseInt(this.progressInterval,10);(r===0||r===100)&&this.changeProgressValue(i,Math.round(e.loaded/e.total*100).toString()+"%")}else this.changeProgressValue(i,Math.round(e.loaded/e.total*100).toString()+"%")},t.prototype.changeProgressValue=function(e,i){e.querySelector("."+qr).setAttribute("style","width:"+i),e.querySelector("."+da).textContent=i},t.prototype.uploadInProgress=function(e,i,r,o){var a=this.getLiElement(i);if(!(d(a)&&!r)){if(d(a))this.cancelUploadingFile(i,e,o);else{i.statusCode==="5"&&this.cancelUploadingFile(i,e,o,a),!(a.querySelectorAll("."+pi).length>0)&&a.querySelector("."+Re)&&(a.querySelector("."+Re).classList.add(Ct),this.createProgressBar(a),this.updateProgressBarClasses(a,Ct),a.querySelector("."+Re).classList.remove(Mt)),this.updateProgressbar(e,a);var n=a.querySelector("."+Ze);d(n)||(n.classList.add(Fe,Ct),n.setAttribute("title",this.localizedTexts("abort")),n.classList.remove(Ze))}var s={e,operation:"upload",file:this.updateStatus(i,this.localizedTexts("inProgress"),"3")};this.trigger("progress",s)}},t.prototype.cancelUploadingFile=function(e,i,r,o){var a=this;if(e.statusCode==="5"){var n={event:i,fileData:e,cancel:!1,customFormData:[],currentRequest:null};this.trigger("canceling",n,function(s){if(s.cancel){if(e.statusCode="3",!d(o)){var h=o.querySelector("."+Fe);d(h)||(gt(h),X(o.querySelector(".e-spinner-pane")))}}else{r.emitError=!1,r.httpRequest.abort();var p=new FormData;if(e.statusCode==="5"){var u=a.element.getAttribute("name");p.append(u,e.name),p.append("cancel-uploading",e.name),a.updateFormData(p,s.customFormData);var c=new Zi(a.asyncSettings.removeUrl,"POST",!0,null);c.emitError=!1,c.beforeSend=function(f){s.currentRequest&&a.updateCustomheader(c.httpRequest,s.currentRequest)},c.onLoad=function(f){return a.removecanceledFile(f,e),{}},c.send(p)}}})}},t.prototype.removecanceledFile=function(e,i){var r=this.getLiElement(i);if(!(d(r)||r.querySelector("."+Yt)||d(r.querySelector("."+Fe)))){this.updateStatus(i,this.localizedTexts("fileUploadCancel"),"5"),this.renderFailureState(e,i,r);var o=r.querySelector("."+Ze);d(r)||(gt(o),d(r.querySelector(".e-spinner-pane"))||X(r.querySelector(".e-spinner-pane")));var a=e&&e.currentTarget?this.getResponse(e):null,n={event:e,response:a,operation:"cancel",file:i};this.trigger("success",n)}},t.prototype.renderFailureState=function(e,i,r){var o=this;this.updateProgressBarClasses(r,Mt),this.removeProgressbar(r,"failure"),d(r.querySelector(".e-file-status"))||r.querySelector(".e-file-status").classList.add(Mt);var a=r.querySelector("."+Fe);if(!d(a)){a.classList.remove(Fe,Ct),a.classList.add(Ze),a.setAttribute("title",this.localizedTexts("remove")),this.pauseButton=this.createElement("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:this.btnTabIndex}}),a.parentElement.insertBefore(this.pauseButton,a),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),this.pauseButton.setAttribute("aria-label",this.localizedTexts("retry"));var n=r.querySelector("."+Yt);n.addEventListener("click",function(s){o.reloadcanceledFile(s,i,r,!1)},!1)}},t.prototype.reloadcanceledFile=function(e,i,r,o){i.statusCode="1",i.status=this.localizedTexts("readyToUploadMessage"),o||(d(r.querySelector("."+Re))||r.querySelector("."+Re).classList.remove(Mt),d(r.querySelector("."+Yt))||X(r.querySelector("."+Yt)),this.pauseButton=null),d(r)||r.classList.add(er),this.upload([i])},t.prototype.uploadComplete=function(e,i,r){var o=e.target;if(o.readyState===4&&o.status>=200&&o.status<=299){var a=this.getLiElement(i);if(d(a)&&(!r||d(r))&&this.showFileList)return;if(!d(a)){this.updateProgressBarClasses(a,St),this.removeProgressbar(a,"success");var n=a.querySelector("."+Fe);d(n)||(n.classList.add(mt),n.setAttribute("title",this.localizedTexts("delete")),n.setAttribute("aria-label",this.localizedTexts("delete")),n.classList.remove(Fe),n.classList.remove(Ct))}this.raiseSuccessEvent(e,i)}else this.uploadFailed(e,i)},t.prototype.getResponse=function(e){var i=e.currentTarget,r={readyState:i.readyState,statusCode:i.status,statusText:i.statusText,headers:i.getAllResponseHeaders(),withCredentials:i.withCredentials};return r},t.prototype.raiseSuccessEvent=function(e,i){var r=this,o=e&&e.currentTarget?this.getResponse(e):null,a=this.localizedTexts("uploadSuccessMessage"),n={e,response:o,operation:"upload",file:this.updateStatus(i,a,"2",!1),statusText:a},s=this.getLiElement(i);if(!d(s)){var h=s.querySelector("."+rl);d(h)||(gt(s),X(h))}this.trigger("success",n,function(p){r.updateStatus(i,p.statusText,"2"),r.multiple?r.uploadedFilesData.push(i):r.uploadedFilesData=[i],r.trigger("change",{file:r.uploadedFilesData}),r.checkActionButtonStatus(),r.fileList.length>0?r.getLiElement(i).classList.contains(er)?r.getLiElement(i).classList.remove(er):(r.uploadSequential(),r.checkActionComplete(!0)):r.showFileList||r.checkActionComplete(!0)})},t.prototype.uploadFailed=function(e,i){var r=this,o=this.getLiElement(i),a=e&&e.currentTarget?this.getResponse(e):null,n=this.localizedTexts("uploadFailedMessage"),s={e,response:a,operation:"upload",file:this.updateStatus(i,n,"0",!1),statusText:n};d(o)||this.renderFailureState(e,i,o),this.trigger("failure",s,function(h){r.updateStatus(i,h.statusText,"0"),r.checkActionButtonStatus(),r.uploadSequential(),r.checkActionComplete(!0)})},t.prototype.uploadSequential=function(){this.sequentialUpload&&(this.autoUpload?this.checkAutoUpload(this.filesData):this.uploadButtonClick())},t.prototype.checkActionComplete=function(e){e?++this.actionCompleteCount:--this.actionCompleteCount,this.raiseActionComplete()},t.prototype.raiseActionComplete=function(){if(this.filesData.length===this.actionCompleteCount&&this.flag){this.flag=!1;var e={fileData:[]};e.fileData=this.getSelectedFileStatus(this.selectedFiles),this.trigger("actionComplete",e)}},t.prototype.getSelectedFileStatus=function(e){for(var i=[],r=0,o=0;o<e.length;o++)for(var a=e[o],n=0;n<this.filesData.length;n++)if(this.filesData[n].name===a.name&&this.filesData[n].status===a.status){i[r]=this.filesData[n],++r;break}return i},t.prototype.updateProgressBarClasses=function(e,i){var r=e.querySelector("."+qr);d(r)||(r.classList.add(i),this.actionButtons&&this.clearButton&&this.uploadWrapper&&(i==="e-upload-progress"&&!this.clearButton.hasAttribute("disabled")?this.clearButton.setAttribute("disabled","disabled"):(i==="e-upload-success"||i==="e-upload-fails")&&this.uploadWrapper.querySelectorAll(".e-upload-progress-bar.e-upload-progress:not(.e-upload-success):not(.e-upload-fails)").length===0&&this.clearButton.hasAttribute("disabled")&&this.clearButton.removeAttribute("disabled")))},t.prototype.removeProgressbar=function(e,i){var r=this;d(e.querySelector("."+pi))||(this.progressAnimation=new ai({duration:1250}),this.progressAnimation.animate(e.querySelector("."+pi),{name:"FadeOut"}),this.progressAnimation.animate(e.querySelector("."+da),{name:"FadeOut"}),setTimeout(function(){r.animateProgressBar(e,i)},750))},t.prototype.animateProgressBar=function(e,i){i==="success"?(e.classList.add(St),d(e.querySelector("."+Re))||(e.querySelector("."+Re).classList.remove(Ct),this.progressAnimation.animate(e.querySelector("."+Re),{name:"FadeIn"}),e.querySelector("."+Re).classList.add(St))):d(e.querySelector("."+Re))||(e.querySelector("."+Re).classList.remove(Ct),this.progressAnimation.animate(e.querySelector("."+Re),{name:"FadeIn"}),e.querySelector("."+Re).classList.add(Mt)),e.querySelector("."+pi)&&X(e.querySelector("."+pi))},t.prototype.setExtensions=function(e){e!==""&&!d(e)?this.element.setAttribute("accept",e):this.element.removeAttribute("accept")},t.prototype.templateComplier=function(e){if(e)try{return typeof e!="function"&&me(e,document).length?ht(te(e,document).innerHTML.trim()):ht(e)}catch{return ht(e)}},t.prototype.setRTL=function(){this.enableRtl?W([this.uploadWrapper],al):G([this.uploadWrapper],al)},t.prototype.localizedTexts=function(e){return this.l10n.setLocale(this.locale),this.l10n.getConstant(e)},t.prototype.setControlStatus=function(){this.enabled?(this.uploadWrapper.classList.contains(ga)&&this.uploadWrapper.classList.remove(ga),!d(this.browseButton)&&this.element.hasAttribute("disabled")&&(this.element.removeAttribute("disabled"),this.browseButton.removeAttribute("disabled")),!d(this.clearButton)&&this.clearButton.hasAttribute("disabled")&&this.clearButton.removeAttribute("disabled"),!d(this.uploadButton)&&this.uploadButton.hasAttribute("disabled")&&this.uploadButton.hasAttribute("disabled")):(this.uploadWrapper.classList.add(ga),this.element.setAttribute("disabled","disabled"),this.browseButton.setAttribute("disabled","disabled"),d(this.clearButton)||this.clearButton.setAttribute("disabled","disabled"),d(this.uploadButton)||this.uploadButton.setAttribute("disabled","disabled"))},t.prototype.checkHTMLAttributes=function(e){for(var i=e?d(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["accept","multiple","disabled"],r=0,o=i;r<o.length;r++){var a=o[r];if(!d(this.element.getAttribute(a)))switch(a){case"accept":(d(this.uploaderOptions)||this.uploaderOptions.allowedExtensions===void 0||e)&&(this.setProperties({allowedExtensions:this.element.getAttribute("accept")},!e),this.initialAttr.accept=this.allowedExtensions);break;case"multiple":if(d(this.uploaderOptions)||this.uploaderOptions.multiple===void 0||e){var n=this.element.getAttribute(a)==="multiple"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true";this.setProperties({multiple:n},!e),this.initialAttr.multiple=!0}break;case"disabled":if(d(this.uploaderOptions)||this.uploaderOptions.enabled===void 0||e){var s=!(this.element.getAttribute(a)==="disabled"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true");this.setProperties({enabled:s},!e),this.initialAttr.disabled=!0}}}},t.prototype.chunkUpload=function(e,i,r){var o=0,a=Math.min(this.asyncSettings.chunkSize,e.size),n=0,s=e.rawFile.slice(o,a),h={chunkIndex:n,blob:s,file:e,start:o,end:a,retryCount:0,request:null};this.sendRequest(e,h,i,r)},t.prototype.sendRequest=function(e,i,r,o){var a=this,n=new FormData,s=e.rawFile.slice(i.start,i.end);n.append(this.uploaderName,s,e.name),n.append("chunk-index",i.chunkIndex.toString()),n.append("chunkIndex",i.chunkIndex.toString());var h=Math.max(Math.ceil(e.size/this.asyncSettings.chunkSize),1);n.append("total-chunk",h.toString()),n.append("totalChunk",h.toString());var p=new Zi({url:this.asyncSettings.saveUrl,type:"POST",async:!0,contentType:null});p.emitError=!1,p.onLoad=function(c){return a.chunkUploadComplete(c,i,r),{}},p.onUploadProgress=function(c){return a.chunkUploadInProgress(c,i,r),{}};var u={fileData:e,customFormData:[],cancel:!1,chunkSize:this.asyncSettings.chunkSize===0?null:this.asyncSettings.chunkSize};p.beforeSend=function(c){u.currentRequest=p.httpRequest,u.currentChunkIndex=i.chunkIndex,u.currentChunkIndex===0?a.trigger("uploading",u,function(f){a.uploadingEventCallback(n,f,c,e)}):a.trigger("chunkUploading",u,function(f){a.uploadingEventCallback(n,f,c,e)})},p.onError=function(c){return a.chunkUploadFailed(c,i,r),{}},p.send(n),i.request=p},t.prototype.uploadingEventCallback=function(e,i,r,o){i.cancel?this.eventCancelByArgs(r,i,o):this.updateFormData(e,i.customFormData)},t.prototype.eventCancelByArgs=function(e,i,r){var o=this;if(e.cancel=!0,i.fileData.statusCode!=="5"){i.fileData.statusCode="5",i.fileData.status=this.localizedTexts("fileUploadCancel");var a=this.getLiElement(i.fileData);if(a){d(a.querySelector("."+Re))||(a.querySelector("."+Re).innerHTML=this.localizedTexts("fileUploadCancel"),a.querySelector("."+Re).classList.add(Mt)),this.pauseButton=this.createElement("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:this.btnTabIndex}});var n=a.querySelector("."+Ze);n&&n.parentElement.insertBefore(this.pauseButton,n),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),this.pauseButton.addEventListener("click",function(s){o.reloadcanceledFile(s,r,a)},!1),this.checkActionButtonStatus()}}},t.prototype.checkChunkUpload=function(){return!(this.asyncSettings.chunkSize<=0||d(this.asyncSettings.chunkSize))},t.prototype.chunkUploadComplete=function(e,i,r){var o=this,a=e.target,n;if(a.readyState===4&&a.status>=200&&a.status<300){var s=e&&e.currentTarget?this.getResponse(e):null,h=Math.max(Math.ceil(i.file.size/this.asyncSettings.chunkSize),1),p={event:e,file:i.file,chunkIndex:i.chunkIndex,totalChunk:h,chunkSize:this.asyncSettings.chunkSize,response:s};if(this.trigger("chunkSuccess",p),(d(r)||!r)&&(n=this.getLiElement(i.file)),this.updateMetaData(i),i.end===i.file.size&&(i.file.statusCode="3"),i.file.statusCode==="5"){var u={event:e,fileData:i.file,cancel:!1,customFormData:[]};this.trigger("canceling",u,function(f){if(f.cancel){i.file.statusCode="3";var g=n.querySelector("."+Fe);!d(n)&&!d(g)&&(gt(g),X(n.querySelector(".e-spinner-pane"))),o.sendNextRequest(i)}else{i.request.emitError=!1,a.abort();var v=new FormData,m=o.element.getAttribute("name");v.append(m,i.file.name),v.append("cancel-uploading",i.file.name),v.append("cancelUploading",i.file.name),o.updateFormData(v,f.customFormData);var C=new Zi(o.asyncSettings.removeUrl,"POST",!0,null);C.emitError=!1,C.onLoad=function(M){return o.removeChunkFile(M,i,r),{}},C.send(v)}})}else{if(h-1===i.chunkIndex&&h>i.chunkIndex){var c=this.pausedData.indexOf(i);c>=0&&this.pausedData.splice(c,1),d(this.template)&&(d(r)||!r)&&n&&(n&&!d(n.querySelector("."+et))&&X(n.querySelector("."+et)),this.removeChunkProgressBar(i)),this.raiseSuccessEvent(e,i.file);return}i.file.statusCode!=="4"&&this.sendNextRequest(i)}}else this.chunkUploadFailed(e,i)},t.prototype.sendNextRequest=function(e){e.start=e.end,e.end+=this.asyncSettings.chunkSize,e.end=Math.min(e.end,e.file.size),e.chunkIndex+=1,this.sendRequest(e.file,e)},t.prototype.removeChunkFile=function(e,i,r){if(d(this.template)&&d(r)&&!r){var o=this.getLiElement(i.file),a=o.querySelector("."+Fe),n=a;this.updateStatus(i.file,this.localizedTexts("fileUploadCancel"),"5"),this.updateProgressBarClasses(o,Mt),this.removeProgressbar(o,"failure"),a&&(a.classList.remove(Fe),a.classList.add(Ze),a.setAttribute("title",this.localizedTexts("remove")));var s=o.querySelector("."+et);s&&(s.classList.add(Yt),s.classList.remove(et),s.setAttribute("title",this.localizedTexts("retry"))),!d(o)&&!d(a)&&!d(o.querySelector(".e-spinner-pane"))&&(gt(n),X(o.querySelector(".e-spinner-pane")))}},t.prototype.pauseUpload=function(e,i,r){e.file.statusCode="4",e.file.status=this.localizedTexts("pause"),this.updateMetaData(e);var o={event:i||null,file:e.file,chunkIndex:e.chunkIndex,chunkCount:Math.round(e.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.abortUpload(e,r,o),this.sequentialUpload&&this.uploadSequential()},t.prototype.abortUpload=function(e,i,r){e.file.statusCode!=="4"&&(e.request.emitError=!1,e.request.httpRequest.abort());var o=this.getLiElement(e.file);if(d(this.template)&&(d(i)||!i)){var a=o.querySelector("."+et);a.classList.remove(et),a.classList.add(ui),a.setAttribute("title",this.localizedTexts("resume")),a.nextElementSibling.classList.add(Ze),a.nextElementSibling.classList.remove(Fe),a.nextElementSibling.setAttribute("title",this.localizedTexts("remove"))}for(var n=0;n<this.pausedData.length;n++)this.pausedData[n].file.name===e.file.name&&this.pausedData.splice(n,1);this.pausedData.push(e),this.trigger("pausing",r)},t.prototype.resumeUpload=function(e,i,r){var o=this.getLiElement(e.file),a;d(o)||(a=o.querySelector("."+ui)),!d(a)&&(d(r)||!r)&&(a.classList.remove(ui),a.classList.add(et),a.setAttribute("title",this.localizedTexts("pause")),a.nextElementSibling.classList.remove(Ze),a.nextElementSibling.classList.add(Fe),a.nextElementSibling.setAttribute("title",this.localizedTexts("abort"))),e.file.status=this.localizedTexts("inProgress"),e.file.statusCode="3",this.updateMetaData(e);var n={event:i||null,file:e.file,chunkIndex:e.chunkIndex,chunkCount:Math.round(e.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.trigger("resuming",n);for(var s=0;s<this.pausedData.length;s++)this.pausedData[s].end===this.pausedData[s].file.size?this.chunkUploadComplete(i,e,r):this.pausedData[s].file.name===e.file.name&&(this.pausedData[s].start=this.pausedData[s].end,this.pausedData[s].end=this.pausedData[s].end+this.asyncSettings.chunkSize,this.pausedData[s].end=Math.min(this.pausedData[s].end,this.pausedData[s].file.size),this.pausedData[s].chunkIndex=this.pausedData[s].chunkIndex+1,this.sendRequest(this.pausedData[s].file,this.pausedData[s],r))},t.prototype.updateMetaData=function(e){this.uploadMetaData.indexOf(e)===-1?this.uploadMetaData.push(e):(this.uploadMetaData.splice(this.uploadMetaData.indexOf(e),1),this.uploadMetaData.push(e))},t.prototype.removeChunkProgressBar=function(e){var i=this.getLiElement(e.file);if(!d(i)){this.updateProgressBarClasses(i,St),this.removeProgressbar(i,"success");var r=i.querySelector("."+Fe);d(r)||(r.classList.add(mt),r.setAttribute("title",this.localizedTexts("delete")),r.classList.remove(Fe,Ct))}},t.prototype.chunkUploadFailed=function(e,i,r){var o=this,a=Math.max(Math.ceil(i.file.size/this.asyncSettings.chunkSize),1),n;d(this.template)&&(d(r)||!r)&&(n=this.getLiElement(i.file));var s=e&&e.currentTarget?this.getResponse(e):null,h={event:e,file:i.file,chunkIndex:i.chunkIndex,totalChunk:a,chunkSize:this.asyncSettings.chunkSize,cancel:!1,response:s};this.trigger("chunkFailure",h,function(p){if(!p.cancel)if(i.retryCount<o.asyncSettings.retryCount)setTimeout(function(){o.retryRequest(n,i,r)},o.asyncSettings.retryAfterDelay);else{if(!d(n)){var u=n.querySelector("."+et)?n.querySelector("."+et):n.querySelector("."+ui);d(u)||(u.classList.add(Yt),u.classList.remove(et,ui)),o.updateProgressBarClasses(n,Mt),o.removeProgressbar(n,"failure"),n.querySelector(".e-icons").classList.remove(Ct);var c=n.querySelector("."+Fe)?n.querySelector("."+Fe):n.querySelector("."+Ze);c.classList.remove(Fe),d(n.querySelector("."+et))||X(n.querySelector("."+et)),i.start>0?(c.classList.add(mt),c.setAttribute("title",o.localizedTexts("delete"))):(c.classList.add(Ze),c.setAttribute("title",o.localizedTexts("remove")))}i.retryCount=0;var f=i.file,g=o.localizedTexts("uploadFailedMessage"),v={e,response:s,operation:"upload",file:o.updateStatus(f,g,"0",!1),statusText:g};o.trigger("failure",v,function(m){o.updateStatus(f,m.statusText,"0"),o.uploadSequential(),o.checkActionComplete(!0)})}})},t.prototype.retryRequest=function(e,i,r){d(this.template)&&(d(r)||!r)&&e&&this.updateProgressBarClasses(e,Mt),i.retryCount+=1,this.sendRequest(i.file,i)},t.prototype.checkPausePlayAction=function(e){var i=e.target,r=e.target.parentElement,o=this.fileList.indexOf(r),a=this.filesData[o],n=this.getCurrentMetaData(a);i.classList.contains(et)?this.pauseUpload(n,e):i.classList.contains(ui)?this.resumeUpload(n,e):i.classList.contains(Yt)&&(n.file.status===this.localizedTexts("fileUploadCancel")?this.retryUpload(n,!1):this.retryUpload(n,!0))},t.prototype.retryUpload=function(e,i){i?(e.end=e.end+this.asyncSettings.chunkSize,e.start=e.start+this.asyncSettings.chunkSize,this.sendRequest(e.file,e)):(e.file.statusCode="1",e.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(e.file)),this.getLiElement(e.file).classList.add(er)},t.prototype.chunkUploadInProgress=function(e,i,r){var o=this;if(i.file.statusCode!=="4"){i.file.statusCode!=="4"&&i.file.statusCode!=="5"&&(i.file.statusCode="3",i.file.status=this.localizedTexts("inProgress")),this.updateMetaData(i);var a=this.getLiElement(i.file);if(!d(a)){var n=a.querySelector("."+Yt);if(d(n)||(n.classList.add(et),n.setAttribute("title",this.localizedTexts("pause")),n.classList.remove(Yt)),!d(a)){if(!(a.querySelectorAll("."+pi).length>0)){var s=a.querySelector("."+Re);d(this.template)&&(s.classList.add(Ct),s.classList.remove(Mt),this.createProgressBar(a),this.updateProgressBarClasses(a,Ct));var h=a.querySelector("."+Ze)?a.querySelector("."+Ze):a.querySelector("."+mt);d(h)||(h.classList.add(Fe),h.setAttribute("title",this.localizedTexts("abort")),h.classList.remove(Ze))}if(!isNaN(Math.round(e.loaded/e.total*100))&&d(this.template)&&i.file.statusCode!=="4"){var p=void 0,u=Math.ceil(i.file.size/this.asyncSettings.chunkSize)-1;this.asyncSettings.chunkSize&&u&&(p=Math.round(i.chunkIndex/u*100),this.changeProgressValue(a,p.toString()+"%"))}i.chunkIndex===0&&this.checkActionButtonStatus()}if(d(a.querySelector("."+et))&&d(this.template)&&d(a.querySelector("."+mt))){this.pauseButton=this.createElement("span",{className:"e-icons e-file-pause-btn",attrs:{tabindex:this.btnTabIndex}}),this.browserName==="msie"&&this.pauseButton.classList.add("e-msie");var c=a.querySelector("."+Fe);c.parentElement.insertBefore(this.pauseButton,c),this.pauseButton.setAttribute("title",this.localizedTexts("pause")),this.pauseButton.addEventListener("click",function(f){o.checkPausePlayAction(f)},!1)}}}},t.prototype.bytesToSize=function(e){var i=-1;if(!e)return"0.0 KB";do e=e/1024,i++;while(e>99);return i>=2&&(e=e*1024,i=1),Math.max(e,0).toFixed(1)+" "+["KB","MB"][i]},t.prototype.sortFileList=function(e){e=e||this.sortFilesList;for(var i=e,r=[],o=0;o<i.length;o++)r.push(i[o].name);for(var a=r.sort(),n=[],s=0,h=a;s<h.length;s++)for(var p=h[s],o=0;o<i.length;o++)p===i[o].name&&n.push(i[o]);return n},t.prototype.destroy=function(){this.element.value=null,this.clearTemplate(),this.clearAll(),this.unWireEvents(),this.unBindDropEvents(),this.multiple&&this.element.removeAttribute("multiple"),this.enabled||this.element.removeAttribute("disabled"),this.element.removeAttribute("accept"),this.setInitialAttributes();for(var e=["aria-label","directory","webkitdirectory","tabindex"],i=0,r=e;i<r.length;i++){var o=r[i];this.element.removeAttribute(o)}d(this.uploadWrapper)||(this.uploadWrapper.parentElement.appendChild(this.element),X(this.uploadWrapper)),this.uploadWrapper=null,this.uploadWrapper=null,this.browseButton=null,this.dropAreaWrapper=null,this.dropZoneElement=null,this.dropArea=null,this.keyboardModule=null,this.clearButton=null,this.uploadButton=null,l.prototype.destroy.call(this)},t.prototype.upload=function(e,i){var r=this;if(e=e||this.filesData,this.sequentialUpload&&(this.isFirstFileOnSelection||i))this.sequenceUpload(e);else{var o=this.getFilesInArray(e),a={customFormData:[],currentRequest:null,cancel:!1};this.trigger("beforeUpload",a,function(n){n.cancel||(r.customFormDatas=n.customFormData&&n.customFormData.length>0?n.customFormData:r.customFormDatas,r.uploadFiles(o,i))})}},t.prototype.getFilesInArray=function(e){var i=[];return e&&(e instanceof Array?i=e:i.push(e)),i},t.prototype.serverReadFileBase64=function(e,i,r){var o=this;return new Promise(function(a,n){var s=o.fileStreams[e].rawFile;try{var h=new FileReader;h.onload=function(p){return function(){try{var u=p.result,c=u?u.split(";base64,")[1]:null;a(c)}catch(f){n(f)}}}(h),h.readAsDataURL(s.slice(i,i+r))}catch(p){n(p)}})},t.prototype.uploadFileCount=function(e){var i=this.filesData;if(!i||i.length===0)return-1;var r=i.length;return r},t.prototype.getFileRead=function(e,i){var r=this.filesData;if(!r||r.length===0)return-1;var o=r[e],a=this.newFileRef++;return this.fileStreams[a]=o,a},t.prototype.uploadFiles=function(e,i){var r=[];if(!(this.asyncSettings.saveUrl===""||d(this.asyncSettings.saveUrl))){if(!i||d(i))if(this.multiple)r=this.filterfileList(e);else{var o=[];o.push(e[0]),r=this.filterfileList(o)}else r=e;for(var a=0;a<r.length;a++)this.uploadFilesRequest(r,a,i)}},t.prototype.uploadFilesRequest=function(e,i,r){var o=this,a=this.checkChunkUpload(),n=new Zi(this.asyncSettings.saveUrl,"POST",!0,null);n.emitError=!1;var s={fileData:e[i],customFormData:[],cancel:!1},h=new FormData;if(n.beforeSend=function(u){s.currentRequest=n.httpRequest,o.trigger("uploading",s,function(c){c.cancel&&o.eventCancelByArgs(u,c,e[i]),o.customFormDatas&&o.customFormDatas.length>0&&o.updateFormData(h,o.customFormDatas),o.updateFormData(h,c.customFormData)})},e[i].statusCode==="1"){var p=this.element.getAttribute("name");h.append(p,e[i].rawFile,e[i].name),a&&e[i].size>this.asyncSettings.chunkSize?this.chunkUpload(e[i],r,i):(n.onLoad=function(u){return s.cancel?{}:(o.uploadComplete(u,e[i],r),{})},n.onUploadProgress=function(u){return s.cancel?{}:(o.uploadInProgress(u,e[i],r,n),{})},n.onError=function(u){return o.uploadFailed(u,e[i]),{}},n.send(h))}},t.prototype.spliceFiles=function(e){for(var i=this.fileList[e],r=this.getFilesData(),o=+i.getAttribute("data-files-count"),a=0,n=0;n<e;n++)a+=+this.fileList[n].getAttribute("data-files-count");for(var s=a+o-1,h=s;h>=a;h--)r.splice(h,1)},t.prototype.remove=function(e,i,r,o,a){var n=this;d(o)&&(o=!0);var s={event:a,cancel:!1,filesData:[],customFormData:[],postRawFile:o,currentRequest:null},h={cancel:!1,customFormData:[],currentRequest:null};this.trigger("beforeRemove",h,function(p){if(!p.cancel)if(n.isFormUpload())s.filesData=e,n.trigger("removing",s,function(M){if(!M.cancel)for(var I=n.getFilesInArray(e),N=!1,O=void 0,x=0,D=I;x<D.length;x++){var A=D[x];if(N||(O=n.fileList.indexOf(A.list)),O>-1){var P=d(A.input)?null:A.input;P&&X(P),n.spliceFiles(O),X(n.fileList[O]),n.fileList.splice(O,1),N=!0,O=-1}}});else if(n.isForm&&(d(n.asyncSettings.removeUrl)||n.asyncSettings.removeUrl===""))s.filesData=n.getFilesData(),n.trigger("removing",s,function(M){M.cancel||n.clearAll()});else{var u=[];e=d(e)?n.filesData:e,e instanceof Array?u=e:u.push(e),s.filesData=u;for(var c=n.asyncSettings.removeUrl,f=!(c===""||d(c)),g=function(M){var I=n.uploadedFilesData.indexOf(M);(M.statusCode==="2"||M.statusCode==="4"||M.statusCode==="0"&&I!==-1)&&f?n.removeUploadedFile(M,s,r,i):r?n.removeFilesData(M,i):n.trigger("removing",s,function(N){N.cancel||n.removeFilesData(M,i)}),a&&!a.target.classList.contains(Ze)&&n.checkActionComplete(!1)},v=0,m=u;v<m.length;v++){var C=m[v];g(C)}}})},t.prototype.clearAll=function(){var e=this;if(d(this.listParent)){this.browserName!=="msie"&&(this.element.value=""),this.filesData=[];return}var i={cancel:!1,filesData:this.filesData};this.trigger("clearing",i,function(r){r.cancel||(e.clearData(),e.actionCompleteCount=0,e.count=-1)})},t.prototype.getFilesData=function(e){return d(e)?this.filesData:this.getSelectedFiles(e)},t.prototype.pause=function(e,i){e=e||this.filesData;var r=this.getFilesInArray(e);this.pauseUploading(r,i)},t.prototype.pauseUploading=function(e,i){for(var r=this.getFiles(e),o=0;o<r.length;o++)r[o].statusCode==="3"&&this.pauseUpload(this.getCurrentMetaData(r[o],null),null,i)},t.prototype.getFiles=function(e){var i=[];return!d(e)&&!(e instanceof Array)?i.push(e):i=e,i},t.prototype.resume=function(e,i){e=e||this.filesData;var r=this.getFilesInArray(e);this.resumeFiles(r,i)},t.prototype.resumeFiles=function(e,i){for(var r=this.getFiles(e),o=0;o<r.length;o++)r[o].statusCode==="4"&&this.resumeUpload(this.getCurrentMetaData(r[o],null),null,i)},t.prototype.retry=function(e,i,r){e=e||this.filesData;var o=this.getFilesInArray(e);this.sequentialUpload&&this.isFirstFileOnSelection&&(this.isFirstFileOnSelection=!1),this.retryFailedFiles(o,i,r)},t.prototype.retryFailedFiles=function(e,i,r){for(var o=this.getFiles(e),a=0;a<o.length;a++)if(o[a].statusCode==="5"||o[a].statusCode==="0")if(this.asyncSettings.chunkSize>0&&this.getCurrentMetaData(o[a],null))this.retryUpload(this.getCurrentMetaData(o[a],null),i);else{var n=void 0;r||(n=this.fileList[this.filesData.indexOf(o[a])]),this.reloadcanceledFile(null,o[a],n,r)}},t.prototype.cancel=function(e){e=e||this.filesData;var i=this.getFilesInArray(e);this.cancelUpload(i)},t.prototype.cancelUpload=function(e){var i=this.getFiles(e);if(this.asyncSettings.chunkSize>0){for(var r=0;r<i.length;r++)if(i[r].statusCode==="3"){var o=this.getCurrentMetaData(i[r],null);o.file.statusCode="5",o.file.status=this.localizedTexts("fileUploadCancel"),this.updateMetaData(o),this.showHideUploadSpinner(i[r])}}else for(var r=0;r<i.length;r++)i[r].statusCode==="3"&&(i[r].statusCode="5",i[r].status=this.localizedTexts("fileUploadCancel"),this.showHideUploadSpinner(i[r]))},t.prototype.showHideUploadSpinner=function(e){var i=this.getLiElement(e);if(!d(i)&&d(this.template)){var r=i.querySelector("."+Fe);yo({target:r,width:"20px"}),Bt(r)}},le([Ke({saveUrl:"",removeUrl:""},Bv)],t.prototype,"asyncSettings",void 0),le([T(!1)],t.prototype,"sequentialUpload",void 0),le([T({})],t.prototype,"htmlAttributes",void 0),le([T("")],t.prototype,"cssClass",void 0),le([T(!0)],t.prototype,"enabled",void 0),le([T(null)],t.prototype,"template",void 0),le([T(!0)],t.prototype,"multiple",void 0),le([T(!0)],t.prototype,"autoUpload",void 0),le([T(!0)],t.prototype,"enableHtmlSanitizer",void 0),le([Ke({},Rv)],t.prototype,"buttons",void 0),le([T("")],t.prototype,"allowedExtensions",void 0),le([T(0)],t.prototype,"minFileSize",void 0),le([T(3e7)],t.prototype,"maxFileSize",void 0),le([T(null)],t.prototype,"dropArea",void 0),le([qi([{}],Uv)],t.prototype,"files",void 0),le([T(!0)],t.prototype,"showFileList",void 0),le([T(!1)],t.prototype,"directoryUpload",void 0),le([T("Default")],t.prototype,"dropEffect",void 0),le([Y()],t.prototype,"created",void 0),le([Y()],t.prototype,"actionComplete",void 0),le([Y()],t.prototype,"rendering",void 0),le([Y()],t.prototype,"beforeUpload",void 0),le([Y()],t.prototype,"fileListRendering",void 0),le([Y()],t.prototype,"selected",void 0),le([Y()],t.prototype,"uploading",void 0),le([Y()],t.prototype,"success",void 0),le([Y()],t.prototype,"failure",void 0),le([Y()],t.prototype,"removing",void 0),le([Y()],t.prototype,"beforeRemove",void 0),le([Y()],t.prototype,"clearing",void 0),le([Y()],t.prototype,"progress",void 0),le([Y()],t.prototype,"change",void 0),le([Y()],t.prototype,"chunkSuccess",void 0),le([Y()],t.prototype,"chunkFailure",void 0),le([Y()],t.prototype,"chunkUploading",void 0),le([Y()],t.prototype,"canceling",void 0),le([Y()],t.prototype,"pausing",void 0),le([Y()],t.prototype,"resuming",void 0),t=le([Qe],t),t}(ct),Hv=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),wi=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};function wr(l,t){for(var e=y({},l),i=0,r=Object.keys(e);i<r.length;i++){var o=r[i];t.indexOf(o)<0&&an(e,o)}return e}function Qv(l,t){var e=t===40?0:l.childElementCount-1,i=e,r,o=l.querySelector(".e-selected");o&&o.classList.remove("e-selected");for(var a=0,n=l.children.length;a<n;a++)l.children[a].classList.contains("e-focused")&&(r=l.children[a],i=a,r.classList.remove("e-focused"),t===40?i++:i--,i===(t===40?l.childElementCount:-1)&&(i=e));r=l.children[i],i=Fh(l,r,i,t),i!==-1&&(W([l.children[i]],"e-focused"),l.children[i].focus())}function Fh(l,t,e,i,r){if(r===void 0&&(r=0),(t.classList.contains("e-separator")||t.classList.contains("e-disabled"))&&(e===(i===40?l.childElementCount-1:0)?e=i===40?0:l.childElementCount-1:i===40?e++:e--),t=l.children[e],t.classList.contains("e-separator")||t.classList.contains("e-disabled")){if(r++,r===l.childElementCount)return e=-1;e=Fh(l,t,e,i,r)}return e}function Xv(l,t){var e=[].slice.call(l.getElementsByClassName("e-blank-icon"));if(e.length){var i=l.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)");if(!d(i)){i.classList.contains("e-url")&&(i=i.querySelector(".e-menu-url"));var r=i.querySelector(".e-menu-icon"),o,a=l.classList.contains("e-rtl");a?o={padding:"paddingRight",margin:"marginLeft"}:o={padding:"paddingLeft",margin:"marginRight"};var n=parseInt(getComputedStyle(r).fontSize,10)+parseInt(getComputedStyle(r)[o.margin],10)+parseInt(getComputedStyle(i).paddingLeft,10)+"px";e.forEach(function(s){s.classList.contains("e-url")&&s.querySelector(".e-menu-url")?s.querySelector(".e-menu-url").style[o.padding]=n:s.style[o.padding]=n})}}}var Ka=function(l){Hv(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return wi([T("")],t.prototype,"iconCss",void 0),wi([T("")],t.prototype,"id",void 0),wi([T(!1)],t.prototype,"separator",void 0),wi([T("")],t.prototype,"text",void 0),wi([T("")],t.prototype,"url",void 0),wi([T(!1)],t.prototype,"disabled",void 0),t}(Be),Uh=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ye=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},rt={DISABLED:"e-disabled",FOCUS:"e-focused",ICON:"e-menu-icon",ITEM:"e-item",POPUP:"e-dropdown-popup",RTL:"e-rtl",SEPARATOR:"e-separator",VERTICAL:"e-vertical",POPUPWIDTH:"e-dropdown-popup-width"},Wv=function(l){Uh(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return Ye([T("SlideDown")],t.prototype,"effect",void 0),Ye([T(400)],t.prototype,"duration",void 0),Ye([T("ease")],t.prototype,"easing",void 0),t}(Be),De=function(l){Uh(t,l);function t(e,i){var r=l.call(this,e,i)||this;return r.isPopupCreated=!0,r}return t.prototype.preRender=function(){},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.createPopupOnClick&&!this.isPopupCreated?(this.createPopup(),this.openPopUp()):this.closePopup()},t.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(e,i){for(var r,o=this.items.length,a=0,n=this.items.length;a<n;a++)if(i===this.items[a].text){o=a;break}for(var s=e.length-1;s>=0;s--)r=new Ka(this,"items",e[s],!0),this.items.splice(o,0,r);this.canOpen()||this.createItems()},t.prototype.removeItems=function(e,i){for(var r=!1,o=0,a=e.length;o<a;o++)for(var n=0,s=this.items.length;n<s;n++)if(e[o]===(i?this.items[n].id:this.items[n].text)){this.items.splice(n,1),r=!0;break}r&&this.getULElement()&&this.createItems()},t.prototype.createPopup=function(){var e,i=this.createElement("div",{className:this.popupWidth!=="auto"?rt.POPUP+" "+rt.POPUPWIDTH:rt.POPUP,id:this.element.id+"-popup"});if(document.body.appendChild(i),this.dropDown=new Or(i,{width:this.popupWidth,relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),this.dropDown.element.setAttribute("role","dialog"),this.dropDown.element.setAttribute("aria-label","dropdown menu"),d(this.popupContent)||(this.popupContent.style.display=""),this.dropDown.element.style.position==="fixed"&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),ge(this.element,(e={},e["aria-haspopup"]=this.items.length||this.target?"true":"false",e["aria-expanded"]="false",e.type="button",e)),this.cssClass&&W([i],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPopupCreated=!0,this.createPopupOnClick){var r=Q(this.activeElem[0],"split-btn");r&&(r.isPopupCreated=!0)}},t.prototype.getTargetElement=function(){return this.createPopupOnClick&&!this.isColorPicker()&&!d(this.popupContent)?this.popupContent:typeof this.target=="string"?te(this.target):this.target},t.prototype.createItems=function(e){var i=this,r=this.items,o=this.hasIcon(this.items,"iconCss"),a,n,s,h,p=this.getULElement();if(p?p.innerHTML="":p=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}}),this.itemTemplate){var u=this.compiletemplate(this.itemTemplate);r.forEach(function(m){var C=i.createElement("li",{className:m.separator?rt.ITEM+" "+rt.SEPARATOR:rt.ITEM,attrs:m.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":m.text},id:m.id?m.id:Ve("e-"+i.getModuleName()+"-item")}),M=u(m,i,"template",null,!1,null,C);M&&Qi(M,C),m.disabled&&C.classList.add("e-disabled");var I={item:m,element:C};i.trigger("beforeItemRender",I),I.item.disabled!==m.disabled&&C.classList[I.item.disabled?"add":"remove"]("e-disabled"),p.appendChild(C)}),this.isReact&&this.renderReactTemplates()}else for(var c=0;c<r.length;c++){n=r[c],this.enableHtmlSanitizer&&(n.text=pt.sanitize(n.text));var f=n.text;s=this.createElement("li",{innerHTML:n.url?"":f,className:n.separator?rt.ITEM+" "+rt.SEPARATOR:rt.ITEM,attrs:n.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":f},id:n.id?n.id:Ve("e-"+this.getModuleName()+"-item")}),this.enableHtmlSanitizer?s.textContent=n.url?"":f:s.innerHTML=n.url?"":f,n.url&&(s.appendChild(this.createAnchor(n)),s.classList.add("e-url")),n.iconCss?(a=this.createElement("span",{className:rt.ICON+" "+n.iconCss}),n.url?s.childNodes[0].appendChild(a):s.insertBefore(a,s.childNodes[0])):o&&!n.separator&&s.classList.add("e-blank-icon");var g=n.disabled;n.disabled&&s.classList.add("e-disabled"),h={item:n,element:s},this.trigger("beforeItemRender",h);var v=h.item.disabled;g!==v&&(h.item.disabled?s.classList.add("e-disabled"):s.classList.remove("e-disabled")),p.appendChild(s)}e&&this.getPopUpElement().appendChild(p),o&&Xv(this.getPopUpElement())},t.prototype.compiletemplate=function(e){if(this.itemTemplate)try{if(typeof this.itemTemplate!="function"){var i=document.querySelector(this.itemTemplate);if(i)return ht(i.innerHTML.trim())}return ht(e)}catch{return ht(e)}},t.prototype.hasIcon=function(e,i){for(var r=0,o=e.length;r<o;r++)if(e[r][""+i])return!0;return!1},t.prototype.createAnchor=function(e){var i=e.text,r=this.createElement("a",{className:"e-menu-text e-menu-url",attrs:{href:e.url}});return this.enableHtmlSanitizer?r.textContent=i:r.innerHTML=i,r},t.prototype.initialize=function(){this.button=new Xi({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.createElement=this.createElement,this.button.appendTo(this.element),this.element.id||(this.element.id=Ve("e-"+this.getModuleName())),this.appendArrowSpan(),this.setActiveElem([this.element]),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-label",this.element.textContent?this.element.textContent:"dropdownbutton"),this.target&&!this.isColorPicker()&&!this.createPopupOnClick||!this.createPopupOnClick?this.createPopup():(this.isPopupCreated=!1,this.target&&!this.isColorPicker()&&this.createPopupOnClick&&(this.popupContent=this.getTargetElement(),this.popupContent.style.display="none"))},t.prototype.isColorPicker=function(){if(!this.element)return!1;var e=this.element.previousSibling;return!!(e&&e.classList&&e.classList.contains("e-split-colorpicker"))},t.prototype.appendArrowSpan=function(){this.cssClass=d(this.cssClass)?"":this.cssClass,this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(rt.VERTICAL)>-1?"bottom":"right")+" e-caret"}))},t.prototype.setActiveElem=function(e){this.activeElem=e},t.prototype.getModuleName=function(){return"dropdown-btn"},t.prototype.canOpen=function(){var e=!1;return this.isPopupCreated&&(e=this.getPopUpElement().classList.contains("e-popup-close")),e},t.prototype.destroy=function(){var e=this;if(l.prototype.destroy.call(this),this.getModuleName()==="dropdown-btn"){var i;this.element.querySelector("span.e-caret")&&X(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&G([this.element],i),G(this.activeElem,["e-active"]);var r=this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"];r.forEach(function(o){e.element.removeAttribute(o)}),this.popupUnWireEvents(),this.destroyPopup(),this.isPopupCreated=!1,this.disabled||this.unWireEvents()}},t.prototype.destroyPopup=function(){if(this.isPopupCreated){if(this.dropDown.destroy(),this.getPopUpElement()){var e=document.getElementById(this.getPopUpElement().id);e&&(G([e],["e-popup-open","e-popup-close"]),X(e))}b.remove(this.getPopUpElement(),"click",this.clickHandler),b.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.isPopupCreated&&this.dropDown&&(this.dropDown.element=null,this.dropDown=void 0)}this.isPopupCreated=!1;var i=Q(this.activeElem[0],"split-btn");if(this.createPopupOnClick&&i){var r=Q(this.activeElem[1],"dropdown-btn");r&&(r.isPopupCreated=!1)}},t.prototype.getPopUpElement=function(){var e=null;if(!this.dropDown&&this.activeElem[0].classList.contains("e-split-btn")){var i=Q(this.activeElem[1],"dropdown-btn");i&&(this.dropDown=i.dropDown)}return this.dropDown&&(e=this.dropDown.element),e},t.prototype.getULElement=function(){var e=null;return this.getPopUpElement()&&(e=this.getPopUpElement().children[0]),e},t.prototype.wireEvents=function(){this.delegateMousedownHandler=this.mousedownHandler.bind(this),this.createPopupOnClick||b.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),b.add(this.element,"click",this.clickHandler,this),b.add(this.element,"keydown",this.keyBoardHandler,this),b.add(window,"resize",this.windowResize,this)},t.prototype.windowResize=function(){!this.canOpen()&&this.dropDown&&this.dropDown.refreshPosition(this.element)},t.prototype.popupWireEvents=function(){this.delegateMousedownHandler||(this.delegateMousedownHandler=this.mousedownHandler.bind(this));var e=this.getPopUpElement();this.createPopupOnClick&&b.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),e&&(b.add(e,"click",this.clickHandler,this),b.add(e,"keydown",this.keyBoardHandler,this),this.closeActionEvents&&b.add(e,this.closeActionEvents,this.focusoutHandler,this)),this.rippleFn=jr(e,{selector:"."+rt.ITEM})},t.prototype.popupUnWireEvents=function(){var e=this.getPopUpElement();this.createPopupOnClick&&b.remove(document,"mousedown touchstart",this.delegateMousedownHandler),e&&e.parentElement&&(b.remove(e,"click",this.clickHandler),b.remove(e,"keydown",this.keyBoardHandler),this.closeActionEvents&&b.remove(e,this.closeActionEvents,this.focusoutHandler))},t.prototype.keyBoardHandler=function(e){if(!(e.target===this.element&&(e.keyCode===9||!e.altKey&&e.keyCode===40||e.keyCode===38)))switch(e.target&&(e.target.classList.contains("e-item")||e.target.parentElement&&e.target.parentElement.classList.contains("e-split-btn-wrapper"))&&e.keyCode===13&&e.preventDefault(),e.keyCode){case 38:case 40:e.altKey&&(e.keyCode===38||e.keyCode===40)?this.keyEventHandler(e):this.upDownKeyHandler(e);break;case 9:case 13:case 27:case 32:this.keyEventHandler(e);break}},t.prototype.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},t.prototype.upDownKeyHandler=function(e){this.target&&(e.keyCode===38||e.keyCode===40)||(e.preventDefault(),Qv(this.getULElement(),e.keyCode))},t.prototype.keyEventHandler=function(e){if(!(this.target&&(e.keyCode===13||e.keyCode===9))){if(e.keyCode===13&&this.activeElem[0].classList.contains("e-split-btn")){this.triggerSelect(e),this.activeElem[0].focus();return}e.target&&e.target.className.indexOf("e-edit-template")>-1&&e.keyCode===32||(e.keyCode!==9&&e.preventDefault(),e.keyCode===27||e.keyCode===38||e.keyCode===9?this.canOpen()||this.closePopup(e,this.element):this.clickHandler(e))}},t.prototype.getLI=function(e){return e.tagName==="LI"?e:ce(e,"li")},t.prototype.mousedownHandler=function(e){var i=e.target;this.dropDown&&!this.canOpen()&&this.getPopUpElement()&&!(ce(i,'[id="'+this.getPopUpElement().id+'"]')||ce(i,'[id="'+this.element.id+'"]'))&&this.closePopup(e)},t.prototype.focusoutHandler=function(e){if(this.isPopupCreated&&!this.canOpen()){var i=e.relatedTarget||e.target;if(i&&i.className.indexOf("e-item")>-1){var r=this.getLI(i);if(r){var o=Array.prototype.indexOf.call(this.getULElement().children,r),a=this.items[o];if(a){var n={element:r,item:a,event:e};this.trigger("select",n)}}}this.closePopup(e)}},t.prototype.clickHandler=function(e){var i=e.target;if(ce(i,'[id="'+this.element.id+'"]'))!this.createPopupOnClick||this.target&&this.target!==""&&!this.isColorPicker()&&!this.createPopupOnClick?this.getPopUpElement().classList.contains("e-popup-close")?this.openPopUp(e):this.closePopup(e):this.isPopupCreated?this.closePopup(e,this.activeElem[0]):(this.createPopup(),this.openPopUp(e));else if(ce(i,'[id="'+this.getPopUpElement().id+'"]')){var r=this.getLI(e.target);r&&(this.triggerSelect(e),this.closePopup(e,this.activeElem[0]))}},t.prototype.triggerSelect=function(e){var i,r,o,a=this.getLI(e.target);a&&(r=Array.prototype.indexOf.call(this.getULElement().children,a),o=this.items[r],o&&(i={element:a,item:o,event:e},this.trigger("select",i)))},t.prototype.openPopUp=function(e){var i=this;e===void 0&&(e=null);var r=this.getPopUpElement();if(this.activeElem[0]&&this.activeElem[0].classList.contains("e-dropdown-btn")&&r.style.width&&r.style.width!=="auto"&&this.setWidth(r),!this.target)this.createItems(!0);else if(this.activeElem.length>1){var o=Q(this.activeElem[0],"split-btn");o.isReact&&r.childNodes.length<1&&(o.appendReactElement&&o.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates())}else this.isReact&&r.childNodes.length<1&&(this.appendReactElement&&this.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates());var a=this.getULElement();this.popupWireEvents();var n={element:a,items:this.items,event:e,cancel:!1};this.trigger("beforeOpen",n,function(s){if(!s.cancel){var h=i.getULElement(),p=i.animationSettings.effect!=="None"?{name:i.animationSettings.effect,duration:i.animationSettings.duration,timingFunction:i.animationSettings.easing}:null;if(p&&i.animatePopup(p,h),i.dropDown.show(null,i.element),W([i.element],"e-active"),i.element.setAttribute("aria-expanded","true"),i.element.setAttribute("aria-owns",i.getPopUpElement().id),h&&!i.isSafari()&&h.focus(),i.enableRtl&&h.parentElement.style.left!=="0px"){var u=void 0;i.element.parentElement&&i.element.parentElement.classList.contains("e-split-btn-wrapper")?u=i.element.parentElement.offsetWidth:u=i.element.offsetWidth;var c=h.parentElement.offsetWidth-u,f=parseFloat(h.parentElement.style.left)-c;f<0&&(f=0),h.parentElement.style.left=f+"px"}var g={element:h,items:i.items};i.trigger("open",g),h&&i.isSafari()&&h.focus()}})},t.prototype.animatePopup=function(e,i){new ai(e).animate(i,{begin:function(r){r.element.parentElement.style.height=r.element.parentElement.offsetHeight+"px"}})},t.prototype.setWidth=function(e){var i=ee(e.style.width);if(i.indexOf("%")>-1){var r=this.element.offsetWidth*parseFloat(i)/100;e.style.width=r+"px"}},t.prototype.closePopup=function(e,i){var r=this;e===void 0&&(e=null);var o=this.getULElement(),a={element:o,items:this.items,event:e,cancel:!1};this.trigger("beforeClose",a,function(n){if(n.cancel)o&&o.focus();else{var s=r.getPopUpElement();s&&b.remove(s,"keydown",r.keyBoardHandler),r.popupUnWireEvents();var h=r.getULElement(),p=void 0;h&&(p=h.querySelector(".e-selected")),p&&p.classList.remove("e-selected"),r.dropDown&&r.dropDown.hide(),G(r.activeElem,"e-active"),r.element.setAttribute("aria-expanded","false"),r.element.removeAttribute("aria-owns"),i&&(r.isSafari()?i.focus({preventScroll:!0}):i.focus());var u={element:h,items:r.items};r.trigger("close",u),!r.target&&h&&X(h),(!r.target||r.isColorPicker()||r.target&&!r.isColorPicker())&&r.createPopupOnClick&&r.destroyPopup()}})},t.prototype.unWireEvents=function(){this.createPopupOnClick||b.remove(document,"mousedown touchstart",this.delegateMousedownHandler),b.remove(this.element,"click",this.clickHandler),b.remove(this.element,"keydown",this.keyBoardHandler),this.isPopupCreated&&(b.remove(this.getPopUpElement(),"click",this.clickHandler),b.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler)),b.remove(window,"resize",this.windowResize)},t.prototype.onPropertyChanged=function(e,i){var r=["content","cssClass","iconCss","iconPosition","disabled","enableRtl"];this.button.setProperties(wr(e,r));var o;this.isPopupCreated&&(o=this.getPopUpElement(),this.dropDown.setProperties(wr(e,["enableRtl"])));for(var a=0,n=Object.keys(e);a<n.length;a++){var s=n[a];switch(s){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":e.disabled?(this.unWireEvents(),this.isPopupCreated&&!this.canOpen()&&this.closePopup()):this.wireEvents();break;case"cssClass":if(i.cssClass=d(i.cssClass)?"":i.cssClass,e.cssClass.indexOf(rt.VERTICAL)>-1||i.cssClass.indexOf(rt.VERTICAL)>-1){this.element.querySelector("span.e-caret")||this.appendArrowSpan();var h=this.element.querySelector("span.e-caret");e.cssClass.indexOf(rt.VERTICAL)>-1?lt(h,["e-icon-bottom"],["e-icon-right"]):lt(h,["e-icon-right"],["e-icon-bottom"])}this.isPopupCreated&&(i.cssClass&&G([o],i.cssClass.split(" ")),e.cssClass&&W([o],e.cssClass.replace(/\s+/g," ").trim().split(" ")));break;case"target":this.dropDown.content=this.getTargetElement(),this.dropDown.dataBind();break;case"items":this.isPopupCreated&&this.getULElement()&&this.createItems();break;case"createPopupOnClick":e.createPopupOnClick?this.destroyPopup():this.createPopup();break}}},t.prototype.focusIn=function(){this.element.focus()},Ye([T("")],t.prototype,"content",void 0),Ye([T("")],t.prototype,"cssClass",void 0),Ye([T(!1)],t.prototype,"disabled",void 0),Ye([T("")],t.prototype,"iconCss",void 0),Ye([T("Left")],t.prototype,"iconPosition",void 0),Ye([T(!0)],t.prototype,"enableHtmlSanitizer",void 0),Ye([qi([],Ka)],t.prototype,"items",void 0),Ye([T(!1)],t.prototype,"createPopupOnClick",void 0),Ye([T("")],t.prototype,"target",void 0),Ye([T("")],t.prototype,"closeActionEvents",void 0),Ye([T(null)],t.prototype,"itemTemplate",void 0),Ye([T("auto")],t.prototype,"popupWidth",void 0),Ye([Ke({effect:"None"},Wv)],t.prototype,"animationSettings",void 0),Ye([Y()],t.prototype,"beforeItemRender",void 0),Ye([Y()],t.prototype,"beforeOpen",void 0),Ye([Y()],t.prototype,"beforeClose",void 0),Ye([Y()],t.prototype,"close",void 0),Ye([Y()],t.prototype,"open",void 0),Ye([Y()],t.prototype,"select",void 0),Ye([Y()],t.prototype,"created",void 0),t=Ye([Qe],t),t}(ct),Vv=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ge=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},_r="e-rtl",ya="EJS-SPLITBUTTON",qv=function(l){Vv(t,l);function t(e,i){return l.call(this,e,i)||this}return t.prototype.preRender=function(){var e=this.element;if(e.tagName===ya){for(var i=Z("ej2_instances",e),r=this.createElement("button",{attrs:{type:"button"}}),o=this.createElement(ya,{className:"e-"+this.getModuleName()+"-wrapper"}),a=0,n=e.attributes.length;a<n;a++)r.setAttribute(e.attributes[a].nodeName,e.attributes[a].nodeValue);e.parentNode.insertBefore(o,e),X(e),e=r,o.appendChild(e),Ae("ej2_instances",i,e),this.wrapper=o,this.element=e}this.element.id||(this.element.id=Ve("e-"+this.getModuleName()))},t.prototype.render=function(){this.initWrapper(),this.createPrimaryButton(),this.renderControl()},t.prototype.renderControl=function(){this.createSecondaryButton(),this.setActiveElem([this.element,this.secondaryBtnObj.element]),this.setAria(),this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(e,i){l.prototype.addItems.call(this,e,i),this.secondaryBtnObj.items=this.items},t.prototype.removeItems=function(e,i){l.prototype.removeItems.call(this,e,i),this.secondaryBtnObj.items=this.items},t.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element)),this.element.classList.remove("e-"+this.getModuleName()),this.enableRtl&&this.wrapper.classList.add(_r),this.cssClass&&W([this.wrapper],this.cssClass.replace(/\s+/g," ").trim().split(" "))},t.prototype.createPrimaryButton=function(){var e={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled};this.primaryBtnObj=new Xi(e),this.primaryBtnObj.createElement=this.createElement,this.primaryBtnObj.appendTo(this.element),this.element.classList.add("e-"+this.getModuleName()),this.element.type="button",this.wrapper.appendChild(this.element)},t.prototype.createSecondaryButton=function(){var e=this,i=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(i);var r={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,createPopupOnClick:this.createPopupOnClick};r.beforeItemRender=function(o){e.createPopupOnClick&&(e.secondaryBtnObj.dropDown.relateTo=e.wrapper,e.dropDown=e.secondaryBtnObj.dropDown),e.trigger("beforeItemRender",o)},r.open=function(o){e.trigger("open",o)},r.close=function(o){e.trigger("close",o)},r.select=function(o){e.trigger("select",o)},r.beforeOpen=function(o){e.createPopupOnClick&&e.items.length===0&&(e.secondaryBtnObj.dropDown.relateTo=e.wrapper,e.dropDown=e.secondaryBtnObj.dropDown);var a=new wo;return e.trigger("beforeOpen",o,function(n){a.resolve(n)}),a},r.beforeClose=function(o){var a=new wo;return e.trigger("beforeClose",o,function(n){a.resolve(n)}),a},this.secondaryBtnObj=new De(r),this.secondaryBtnObj.createElement=this.createElement,this.secondaryBtnObj.appendTo(i),this.createPopupOnClick||(this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown),this.isPopupCreated=this.secondaryBtnObj.isPopupCreated,this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element],this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right"),this.disabled&&this.wrapper.classList.add("e-splitbtn-disabled")},t.prototype.setAria=function(){ge(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent?this.element.textContent+" splitbutton":"splitbutton","aria-owns":this.element.id+"_dropdownbtn-popup"})},t.prototype.getModuleName=function(){return"split-btn"},t.prototype.toggle=function(){this.secondaryBtnObj.toggle()},t.prototype.destroy=function(){var e=this,i=[_r];if(this.cssClass&&(i=i.concat(this.cssClass.split(" "))),this.element){var r=document.getElementById(this.element.id);r&&r.parentElement===this.wrapper&&(this.wrapper.tagName===ya?(this.wrapper.innerHTML="",G([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),G([this.wrapper],this.cssClass.split(" "))):(G([this.element],i),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(o){e.element.removeAttribute(o)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),it(this.wrapper)),this.unWireEvents())}this.primaryBtnObj.destroy(),this.secondaryBtnObj.destroy(),l.prototype.destroy.call(this),this.element&&!this.element.getAttribute("class")&&this.element.removeAttribute("class"),this.refreshing&&this.isAngular&&(this.element=this.wrapper,["e-control","e-split-btn","e-lib"].forEach(function(o){e.element.classList.add(o)}),Ae("ej2_instances",[this],this.element)),this.wrapper=null},t.prototype.wireEvents=function(){b.add(this.element,"click",this.primaryBtnClickHandler,this),new bo(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow",enter:"enter"}})},t.prototype.unWireEvents=function(){b.remove(this.element,"click",this.primaryBtnClickHandler),Pi(this.element,bo).destroy()},t.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},t.prototype.btnKeyBoardHandler=function(e){switch(e.action){case"altdownarrow":this.clickHandler(e);break;case"enter":this.clickHandler(e),this.getPopUpElement()&&!this.getPopUpElement().classList.contains("e-popup-close")?(this.element.classList.remove("e-active"),this.secondaryBtnObj.element.classList.add("e-active")):this.secondaryBtnObj.element.classList.remove("e-active");break}},t.prototype.onPropertyChanged=function(e,i){var r=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"];this.primaryBtnObj.setProperties(wr(e,r)),r=["beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl","createPopupOnClick"],Object.keys(e).indexOf("items")>-1&&(this.secondaryBtnObj.items=e.items,this.secondaryBtnObj.dataBind()),this.secondaryBtnObj.setProperties(wr(e,r));for(var o=0,a=Object.keys(e);o<a.length;o++){var n=a[o];switch(n){case"cssClass":i.cssClass&&G([this.wrapper],i.cssClass.split(" ")),W([this.wrapper],e.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":e.enableRtl?W([this.wrapper],_r):G([this.wrapper],_r);break;case"disabled":e.disabled?W([this.wrapper],"e-splitbtn-disabled"):G([this.wrapper],"e-splitbtn-disabled")}}},t.prototype.focusIn=function(){this.element.focus()},Ge([T("")],t.prototype,"content",void 0),Ge([T("")],t.prototype,"cssClass",void 0),Ge([T(!1)],t.prototype,"disabled",void 0),Ge([T("")],t.prototype,"iconCss",void 0),Ge([T("Left")],t.prototype,"iconPosition",void 0),Ge([T(!1)],t.prototype,"createPopupOnClick",void 0),Ge([qi([],Ka)],t.prototype,"items",void 0),Ge([T("")],t.prototype,"target",void 0),Ge([Y()],t.prototype,"beforeItemRender",void 0),Ge([Y()],t.prototype,"beforeOpen",void 0),Ge([Y()],t.prototype,"beforeClose",void 0),Ge([Y()],t.prototype,"click",void 0),Ge([Y()],t.prototype,"close",void 0),Ge([Y()],t.prototype,"open",void 0),Ge([Y()],t.prototype,"select",void 0),Ge([Y()],t.prototype,"created",void 0),t=Ge([Qe],t),t}(De),wo=function(){function l(){var t=this;this.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),this.catch=this.promise.catch.bind(this.promise),this.then=this.promise.then.bind(this.promise)}return l}(),_v=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ke=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},tr="e-apply",Zr="e-cancel",ma="e-current",Zv="e-container",ir="e-ctrl-btn",Oi="e-switch-ctrl-btn",hl="e-disabled",pl="e-value-switch-btn",ul="e-handler",cl="e-hex",Ca="e-hide-hex-value",Ma="e-hide-opacity",xi="e-hide-switchable-value",ci="e-hide-value",dl="e-hide-valueswitcher",rr="e-hsv-color",fl="e-hsv-container",Ai="e-selected-value",Gr="e-mode-switch-btn",ba="e-nocolor-item",ja="e-opacity-value",or="e-palette",Jr="e-color-palette",Ia="e-color-picker",Kr="e-preview-container",$r="e-previous",Gv="e-rtl",zi="e-show-value",ar="e-selected",eo="e-split-preview",to="e-tile",Jv={default:["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},Kt=function(l){_v(t,l);function t(e,i){var r=l.call(this,e,i)||this;return r.recentColors=[],r}return t.prototype.preRender=function(){var e=this.element;this.formElement=ce(this.element,"form"),this.formElement&&b.add(this.formElement,"reset",this.formResetHandler,this);var i={Apply:"Apply",Cancel:"Cancel",ModeSwitcher:"Switch Mode",RecentColors:"Recent colors"};this.l10n=new Mi("colorpicker",i,this.locale),e.getAttribute("ejs-for")&&!e.getAttribute("name")&&e.setAttribute("name",e.id)},t.prototype.render=function(){this.initWrapper(),this.inline?this.createWidget():this.createSplitBtn(),this.enableOpacity||W([this.container.parentElement],Ma),this.renderComplete()},t.prototype.initWrapper=function(){var e=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"});this.element.parentNode.insertBefore(e,this.element),e.appendChild(this.element),ge(this.element,{tabindex:"-1",spellcheck:"false","aria-label":"colorpicker"}),this.container=this.createElement("div",{className:Zv}),this.getWrapper().appendChild(this.container);var i=this.value?this.roundValue(this.value).toLowerCase():"#008000ff";this.noColor&&this.mode==="Palette"&&this.value===""&&(i="");var r=i.slice(0,7);d(this.initialInputValue)&&(this.initialInputValue=r),this.element.value=r,this.enableOpacity?this.setProperties({value:i},!0):this.setProperties({value:r},!0),this.enableRtl&&e.classList.add(Gv),this.cssClass&&W([e],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.tileRipple=jr(this.container,{selector:"."+to}),this.ctrlBtnRipple=jr(this.container,{selector:".e-btn"})},t.prototype.getWrapper=function(){return this.element.parentElement},t.prototype.createWidget=function(){this.mode==="Palette"?(this.createPalette(),this.inline||this.firstPaletteFocus()):(this.createPicker(),this.inline||this.getDragHandler().focus()),this.isRgb=!0,this.createInput(),this.createCtrlBtn(),this.disabled||this.wireEvents(),this.inline&&this.disabled&&this.toggleDisabled(!0),S.isDevice&&this.refreshPopupPos()},t.prototype.createSplitBtn=function(){var e=this,i=this.createElement("button",{className:"e-split-colorpicker"});this.getWrapper().appendChild(i),this.splitBtn=new qv({iconCss:"e-selected-color",target:this.container,disabled:this.disabled,enableRtl:this.enableRtl,createPopupOnClick:this.createPopupOnClick,open:this.onOpen.bind(this),click:function(){var n=new MouseEvent("click",{bubbles:!0,cancelable:!1});e.trigger("change",{currentValue:{hex:e.value.slice(0,7),rgba:e.convertToRgbString(e.hexToRgb(e.value))},previousValue:{hex:null,rgba:null},value:e.value,event:n})}}),this.splitBtn.createElement=this.createElement,this.splitBtn.appendTo(i),this.splitBtn.element.setAttribute("aria-label","colorpicker");var r=this.createElement("span",{className:eo});te(".e-selected-color",i).appendChild(r),r.style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value));var o=this.getPopupEle();if(W([o],"e-colorpicker-popup"),this.cssClass&&W([o],this.cssClass.replace(/\s+/g," ").trim().split(" ")),S.isDevice&&!this.createPopupOnClick){var a=this.getPopupInst();a.relateTo=document.body,a.position={X:"center",Y:"center"},a.targetType="container",a.collision={X:"fit",Y:"fit"},a.offsetY=4,o.style.zIndex=Ri(this.splitBtn.element).toString()}this.bindCallBackEvent()},t.prototype.onOpen=function(){if(this.trigger("open",{element:this.container}),!S.isDevice){var e=this.getPopupInst(),i=cn(e.element);i.length>0&&(e.collision={X:"flip",Y:"fit"},e.position={X:"right",Y:"bottom"},e.targetType="container")}},t.prototype.getPopupInst=function(){return Pi(this.getPopupEle(),Or)},t.prototype.bindCallBackEvent=function(){var e=this;this.splitBtn.beforeOpen=function(i){var r=new wo;return e.trigger("beforeOpen",i,function(o){if(!o.cancel){var a=e.getPopupEle();if(a.style.top=ee(0+pageYOffset),a.style.left=ee(0+pageXOffset),a.style.display="block",e.createWidget(),a.style.display="",S.isDevice){if(e.createPopupOnClick){var n=e.getPopupInst();n.relateTo=document.body,n.position={X:"center",Y:"center"},n.targetType="container",n.collision={X:"fit",Y:"fit"},n.offsetY=4,a.style.zIndex=Ri(e.splitBtn.element).toString()}e.modal=e.createElement("div"),e.modal.className="e-"+e.getModuleName()+" e-modal",e.modal.style.display="none",document.body.insertBefore(e.modal,a),document.body.className+=" e-colorpicker-overflow",e.modal.style.display="block",e.modal.style.zIndex=(Number(a.style.zIndex)-1).toString()}}i.cancel=o.cancel,r.resolve(o)}),r},this.splitBtn.beforeClose=function(i){var r=new wo;if(d(i.event))r.resolve(i);else{var o={element:e.container,event:i.event,cancel:!1};e.trigger("beforeClose",o,function(a){S.isDevice&&i.event.target===e.modal&&(a.cancel=!0),a.cancel||e.onPopupClose(),i.cancel=a.cancel,r.resolve(a)})}return r}},t.prototype.onPopupClose=function(){this.unWireEvents(),this.destroyOtherComp(),this.container.style.width="",te("."+eo,this.splitBtn.element).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value)),this.container.innerHTML="",G([this.container],[Ia,Jr]),S.isDevice&&this.modal&&(G([document.body],"e-colorpicker-overflow"),this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)},t.prototype.createPalette=function(){if(lt(this.container,[Jr],[Ia]),this.presetColors){var e=this.createElement("div",{className:"e-custom-palette"});this.appendElement(e);var i=Object.keys(this.presetColors);if(i.length===1)this.appendPalette(this.presetColors[i[0]],i[0],e);else for(var r=0,o=i.length;r<o;r++)this.appendPalette(this.presetColors[i[r]],i[r],e);me(".e-row",e).length>10&&W([e],"e-palette-group")}else this.appendPalette(Jv.default,"default");this.mode==="Palette"&&!this.modeSwitcher&&this.noColor&&this.setNoColor(),this.showRecentColors&&this.recentColors&&this.recentColors.length>0&&this.renderRecentColor();var a=parseInt(getComputedStyle(this.container).borderBottomWidth,10);this.container.style.width=ee(this.container.children[0].offsetWidth+a+a),this.rgb=this.hexToRgb(this.roundValue(this.value)),this.hsv=this.rgbToHsv.apply(this,this.rgb)},t.prototype.renderRecentColor=function(){var e=this,i=this.container.querySelector(".e-clr-pal-rec-wpr");i&&X(i);var r=this.createElement("div",{className:"e-clr-pal-rec-wpr"}),o=this.container.querySelector(".e-switch-ctrl-btn");o?this.container.insertBefore(r,o):this.container.appendChild(r);var a=this.createElement("label",{className:"e-recent-clr-span"});if(a.textContent=this.l10n.getConstant("RecentColors"),r.appendChild(a),this.recentColors.length>0){for(this.recentColors=this.recentColors.filter(function(n,s){return e.recentColors.indexOf(n)===s});this.recentColors.length>10;)this.recentColors.pop();this.appendPalette(this.recentColors,"recent-color",r)}},t.prototype.firstPaletteFocus=function(){te("."+ar,this.container.children[0])||me("."+or,this.container)[0].focus()},t.prototype.appendPalette=function(e,i,r){var o=this.createElement("div",{className:or,attrs:{tabindex:"0",role:"grid"}});i==="recent-color"&&o.classList.add("e-recent-palette"),r?r.appendChild(o):this.appendElement(o);for(var a,n,s,h=0,p=e.length;h<p;h++)(h===0||h%this.columns===0)&&(a=this.createElement("div",{className:"e-row",attrs:{role:"row"}}),o.appendChild(a)),s=this.roundValue(e[h]).toLowerCase(),n=this.createElement("span",{className:to,attrs:{role:"gridcell","aria-label":s,"aria-selected":"false"}}),this.trigger("beforeTileRender",{element:n,presetName:i,value:e[h]}),a.appendChild(n),this.value===s&&i!=="recent-color"&&(this.addTileSelection(n),o.focus()),n.style.backgroundColor=this.convertToRgbString(this.hexToRgb(s))},t.prototype.setNoColor=function(){var e=this.container.querySelector(".e-row").children[0];e.classList.add(ba),this.value||(e.classList.add(ar),ce(e,"."+or).focus()),["aria-selected","aria-label"].forEach(function(i){e.removeAttribute(i)}),e.style.backgroundColor=""},t.prototype.appendElement=function(e,i){i===void 0&&(i=0);var r=this.container.children[i];r?this.container.insertBefore(e,r):this.container.appendChild(e)},t.prototype.addTileSelection=function(e){e&&(e.classList.add(ar),e.setAttribute("aria-selected","true"))},t.prototype.createPicker=function(){lt(this.container,[Ia],[Jr]);var e=this.createElement("div",{className:fl});this.appendElement(e),e.appendChild(this.createElement("div",{className:rr}));var i=this.createElement("span",{className:ul,attrs:{tabindex:"0"}});e.appendChild(i),(this.value===null||this.value==="")&&(this.value="#008000ff"),this.rgb=this.hexToRgb(this.value),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHsvContainerBg(),this.setHandlerPosition(),this.createSlider(),this.createDragTooltip()},t.prototype.setHsvContainerBg=function(e){e===void 0&&(e=this.hsv[0]),this.getHsvContainer().style.backgroundColor=this.convertToRgbString(this.hsvToRgb(e,100,100,1))},t.prototype.getHsvContainer=function(){return te("."+fl,this.container)},t.prototype.setHandlerPosition=function(){var e=this.getDragHandler(),i=te("."+rr,this.container);this.enableRtl?e.style.left=ee((i.offsetWidth-e.offsetWidth/2.5)*Math.abs(100-this.hsv[1])/100):e.style.left=ee((i.offsetWidth-e.offsetWidth/2.5)*this.hsv[1]/100),e.style.top=ee((i.offsetHeight-e.offsetHeight/2.5)*(100-this.hsv[2])/100)},t.prototype.createSlider=function(){var e=this.createElement("div",{className:"e-slider-preview"});this.appendElement(e,1),this.createPreview(e);var i=this.createElement("div",{className:"e-colorpicker-slider"});e.insertBefore(i,e.children[0]);var r=this.createElement("div",{className:"e-hue-slider"});i.appendChild(r),this.hueSlider=new Mr({value:this.hsv[0],min:0,max:359,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.hueChange.bind(this)}),this.hueSlider.createElement=this.createElement,this.hueSlider.appendTo(r),this.enableOpacity&&(r=this.createElement("div",{className:"e-opacity-slider"}),i.appendChild(r),this.createOpacitySlider(r))},t.prototype.createOpacitySlider=function(e){this.opacitySlider=new Mr({value:this.rgb[3]*100,min:0,max:100,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.opacityChange.bind(this)}),this.opacitySlider.createElement=this.createElement,this.opacitySlider.appendTo(e);var i=this.createElement("div",{className:"e-opacity-empty-track"});e.appendChild(i),this.updateOpacitySliderBg()},t.prototype.updateOpacitySliderBg=function(){var e=this.enableRtl?"to left":"to right",i=te(".e-opacity-empty-track",this.opacitySlider.element);i&&(i.style.background="linear-gradient("+e+", rgba("+this.rgb.slice(0,3)+", 0) 0%, "+this.convertToRgbString(this.rgb.slice(0,3))+" 100%)")},t.prototype.hueChange=function(e){this.hsv[0]=e.value,this.setHsvContainerBg(),this.convertToOtherFormat()},t.prototype.opacityChange=function(e){var i=e.value,r=this.rgbToHex(this.rgb);this.hsv[3]=i/100,this.rgb[3]=i/100;var o=this.rgbToHex(this.rgb);this.updateOpacityInput(i);var a=this.convertToRgbString(this.rgb);this.updatePreview(a),this.triggerEvent(o,r,a)},t.prototype.updateOpacityInput=function(e){if(this.enableOpacity&&!this.getWrapper().classList.contains(ci)){var i=Pi(te("."+ja,this.container),Yi);i.value=e,i.dataBind()}},t.prototype.createPreview=function(e){var i=this.createElement("div",{className:Kr});e.appendChild(i);var r=this.createElement("span",{className:"e-preview "+ma});i.appendChild(r);var o=this.convertToRgbString(this.rgb);r.style.backgroundColor=o,r=this.createElement("span",{className:"e-preview "+$r}),i.appendChild(r),r.style.backgroundColor=o},t.prototype.isPicker=function(){return!this.container.classList.contains(Jr)},t.prototype.getPopupEle=function(){return this.container.parentElement},t.prototype.createNumericInput=function(e,i,r,o){var a=this,n=new Yi({value:i,placeholder:r,min:0,max:o,format:"###.##",showSpinButton:!1,floatLabelType:"Always",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker(),change:function(s){s.event&&a.inputHandler(s.event)}});n.createElement=this.createElement,n.appendTo(e)},t.prototype.createInput=function(){var e=this.isPicker(),i=this.getWrapper();if(e&&!i.classList.contains(ci)||!e&&i.classList.contains(zi)){var r=this.createElement("div",{className:Ai});e?this.appendElement(r,2):this.appendElement(r,1);var o=this.createElement("div",{className:"e-input-container"});if(r.appendChild(o),i.classList.contains(dl)||this.appendValueSwitchBtn(r),!i.classList.contains(Ca)){var a=this.createElement("input",{className:cl,attrs:{maxlength:"7",spellcheck:"false","aria-label":"HEX"}});o.appendChild(a),ne.createInput({element:a,floatLabelType:"Always",properties:{placeholder:"HEX",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker()}},this.createElement),ne.setValue(this.value.slice(0,7),a),a.addEventListener("input",this.inputHandler.bind(this))}if(!i.classList.contains(xi)){var n=void 0,s=void 0;this.isRgb?(n="RGB",s=this.rgb):(n="HSV",s=this.hsv);for(var h=["rh","gs","bv"],p=0;p<3;p++)this.createNumericInput(o.appendChild(this.createElement("input",{className:"e-"+h[p]+"-value"})),s[p],n[p],255);this.enableOpacity&&this.appendOpacityValue(o)}}},t.prototype.appendOpacityValue=function(e){this.createNumericInput(e.appendChild(this.createElement("input",{className:ja})),this.rgb[3]*100,"A",100)},t.prototype.appendValueSwitchBtn=function(e){var i=this.createElement("button",{className:"e-icons e-css e-btn e-flat e-icon-btn "+pl,attrs:{title:"Toggle format"}});e.appendChild(i),this.isPicker()&&!this.getWrapper().classList.contains(xi)&&i.addEventListener("click",this.formatSwitchHandler.bind(this))},t.prototype.createCtrlBtn=function(){if(this.modeSwitcher||this.showButtons){this.l10n.setLocale(this.locale);var e=this.createElement("div",{className:Oi});if(this.container.appendChild(e),this.showButtons){var i=this.createElement("div",{className:ir});e.appendChild(i);var r=this.l10n.getConstant("Apply");i.appendChild(this.createElement("button",{innerHTML:r,className:"e-btn e-css e-flat e-primary e-small "+tr,attrs:{title:r}}));var o=this.l10n.getConstant("Cancel");i.appendChild(this.createElement("button",{innerHTML:o,className:"e-btn e-css e-flat e-small "+Zr,attrs:{title:o}}))}this.modeSwitcher&&this.appendModeSwitchBtn()}},t.prototype.appendModeSwitchBtn=function(){var e=this.createElement("button",{className:"e-icons e-btn e-flat e-icon-btn "+Gr,attrs:{title:this.l10n.getConstant("ModeSwitcher")}});te("."+Oi,this.container).insertBefore(e,te("."+ir,this.container))},t.prototype.createDragTooltip=function(){var e=this,i=new qa({opensOn:"Custom",showTipPointer:!1,cssClass:"e-color-picker-tooltip",htmlAttributes:{title:"tooltip"},beforeOpen:function(r){e.tooltipEle=r.element},animation:{open:{effect:"None"},close:{effect:"None"}}});i.createElement=this.createElement,i.appendTo(this.container),i.open(this.container),this.tooltipEle.style.zIndex=Ri(this.tooltipEle).toString(),this.tooltipEle.setAttribute("aria-label","colorpicker-tooltip"),te(".e-tip-content",this.tooltipEle).appendChild(this.createElement("div",{className:"e-tip-transparent"}))},t.prototype.getTooltipInst=function(){return Pi(this.container,qa)},t.prototype.setTooltipOffset=function(e){this.getTooltipInst().offsetY=e},t.prototype.toggleDisabled=function(e){e?this.getWrapper().classList.add(hl):this.getWrapper().classList.remove(hl),this.showButtons&&[].slice.call(me(".e-btn",this.container)).forEach(function(i){e?ge(i,{disabled:""}):i.removeAttribute("disabled")})},t.prototype.convertToRgbString=function(e){return e.length?e.length===4?"rgba("+e.join()+")":"rgb("+e.join()+")":""},t.prototype.convertToHsvString=function(e){return e.length===4?"hsva("+e.join()+")":"hsv("+e.join()+")"},t.prototype.updateHsv=function(){this.hsv[1]=this.hsv[1]>100?100:this.hsv[1],this.hsv[2]=this.hsv[2]>100?100:this.hsv[2],this.setHandlerPosition()},t.prototype.convertToOtherFormat=function(e,i){e===void 0&&(e=!1);var r=this.rgbToHex(this.rgb);this.rgb=this.hsvToRgb.apply(this,this.hsv);var o=this.rgbToHex(this.rgb),a=this.convertToRgbString(this.rgb);this.updatePreview(a),this.updateInput(o),this.triggerEvent(o,r,a,e,i)},t.prototype.updateInput=function(e){var i=this.getWrapper();i.classList.contains(ci)||(i.classList.contains(Ca)||ne.setValue(e.substr(0,7),te("."+cl,this.container)),i.classList.contains(xi)||(this.isRgb?this.updateValue(this.rgb,!1):this.updateValue(this.hsv,!1)))},t.prototype.updatePreview=function(e){this.enableOpacity&&this.updateOpacitySliderBg(),te(".e-tip-transparent",this.tooltipEle).style.backgroundColor=e,te("."+Kr+" ."+ma,this.container).style.backgroundColor=e,te("."+Kr+" ."+$r,this.container).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value))},t.prototype.getDragHandler=function(){return te("."+ul,this.container)},t.prototype.removeTileSelection=function(){var e=[].slice.call(me("."+ar,this.container));e.forEach(function(i){i.classList.remove(ar),i.setAttribute("aria-selected","false")})},t.prototype.convertRgbToNumberArray=function(e){return e.slice(e.indexOf("(")+1,e.indexOf(")")).split(",").map(function(i,r){return r!==3?parseInt(i,10):parseFloat(i)})},t.prototype.getValue=function(e,i){if(e||(e=this.value),i=i?i.toLowerCase():"hex",e[0]==="r"){var r=this.convertRgbToNumberArray(e);if(i==="hex"||i==="hexa"){var o=this.rgbToHex(r);return i==="hex"?o.slice(0,7):o}else return i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,r.slice(0,3))):i==="hsva"?this.convertToHsvString(this.rgbToHsv.apply(this,r)):"null"}else if(e[0]==="h"){var r=this.hsvToRgb.apply(this,this.convertRgbToNumberArray(e));if(i==="rgba")return this.convertToRgbString(r);if(i==="hex"||i==="hexa"){var o=this.rgbToHex(r);return i==="hex"?o.slice(0,7):o}else return i==="rgb"?this.convertToRgbString(r.slice(0,3)):"null"}else{e=this.roundValue(e);var a=this.hexToRgb(e);return(i==="rgb"||i==="hsv")&&(a=a.slice(0,3)),i==="rgba"||i==="rgb"?this.convertToRgbString(a):i==="hsva"||i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,a)):i==="hex"?e.slice(0,7):i==="a"?a[3].toString():"null"}},t.prototype.toggle=function(){this.container.parentElement.classList.contains("e-popup-close")?this.splitBtn.toggle():this.closePopup(null)},t.prototype.getModuleName=function(){return"colorpicker"},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.wireEvents=function(){if(this.isPicker()){var e=this.getDragHandler();b.add(e,"keydown",this.pickerKeyDown,this);var i=te("."+ir,this.container);i&&b.add(i,"keydown",this.ctrlBtnKeyDown,this),b.add(this.getHsvContainer(),"mousedown touchstart",this.handlerDown,this),(this.modeSwitcher||this.showButtons)&&this.addCtrlSwitchEvent(),b.add(te("."+$r,this.container),"click",this.previewHandler,this)}else b.add(this.container,"click",this.paletteClickHandler,this),b.add(this.container,"keydown",this.paletteKeyDown,this)},t.prototype.formResetHandler=function(){this.value=this.initialInputValue,ge(this.element,{value:this.initialInputValue})},t.prototype.addCtrlSwitchEvent=function(){var e=te("."+Oi,this.container);e&&b.add(e,"click",this.btnClickHandler,this)},t.prototype.ctrlBtnKeyDown=function(e){if(e.keyCode===13){var i=te("."+tr,this.container);if(i){var r=this.rgbToHex(this.rgb);this.triggerChangeEvent(r)}this.splitBtn.element.focus()}},t.prototype.pickerKeyDown=function(e){switch(e.keyCode){case 39:this.handlerDragPosition(1,this.enableRtl?-1:1,e);break;case 37:this.handlerDragPosition(1,this.enableRtl?1:-1,e);break;case 38:this.handlerDragPosition(2,1,e);break;case 40:this.handlerDragPosition(2,-1,e);break;case 13:{e.preventDefault();var i=this.rgbToHex(this.rgb);this.enterKeyHandler(i)}}},t.prototype.enterKeyHandler=function(e){this.triggerChangeEvent(e),this.inline||this.splitBtn.element.focus()},t.prototype.closePopup=function(e){var i=this,r={element:this.container,event:e,cancel:!1};this.trigger("beforeClose",r,function(o){o.cancel||(i.splitBtn.toggle(),i.onPopupClose())})},t.prototype.triggerChangeEvent=function(e,i){var r=e.slice(0,7);this.trigger("change",{currentValue:{hex:r,rgba:this.convertToRgbString(this.rgb)},event:i,previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:this.enableOpacity?e:r}),this.showRecentColors&&(this.recentColors.unshift(r),this.inline&&this.renderRecentColor()),this.enableOpacity?this.setProperties({value:e},!0):this.setProperties({value:r},!0),this.element.value=r||"#000000"},t.prototype.handlerDragPosition=function(e,i,r){r.preventDefault(),this.hsv[e]+=i*(r.ctrlKey?1:3),this.hsv[e]<0&&(this.hsv[e]=0),this.updateHsv(),this.convertToOtherFormat(!0,r)},t.prototype.handlerDown=function(e){e.preventDefault(),e.type==="mousedown"?(this.clientX=Math.abs(e.pageX-pageXOffset),this.clientY=Math.abs(e.pageY-pageYOffset),this.setTooltipOffset(8)):(this.clientX=Math.abs(e.changedTouches[0].pageX-pageXOffset),this.clientY=Math.abs(e.changedTouches[0].pageY-pageYOffset),this.setTooltipOffset(-8)),this.setHsv(this.clientX,this.clientY),this.getDragHandler().style.transition="left .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1)",this.updateHsv(),this.convertToOtherFormat(!1,e),this.getDragHandler().focus(),b.add(document,"mousemove touchmove",this.handlerMove,this),b.add(document,"mouseup touchend",this.handlerEnd,this)},t.prototype.handlerMove=function(e){e.type!=="touchmove"&&e.preventDefault();var i,r;e.type==="mousemove"?(i=Math.abs(e.pageX-pageXOffset),r=Math.abs(e.pageY-pageYOffset)):(i=Math.abs(e.changedTouches[0].pageX-pageXOffset),r=Math.abs(e.changedTouches[0].pageY-pageYOffset)),this.setHsv(i,r);var o=this.getDragHandler();this.updateHsv(),this.convertToOtherFormat(!1,e),this.getTooltipInst().refresh(o),this.tooltipEle.style.transform||(Math.abs(this.clientX-i)>8||Math.abs(this.clientY-r)>8)&&(te("."+rr,this.container).style.cursor="pointer",o.style.transition="none",this.inline||(this.tooltipEle.style.zIndex=(parseInt(this.getPopupEle().style.zIndex,10)+1).toString()),this.tooltipEle.style.transform="rotate(45deg)",o.classList.add("e-hide-handler"))},t.prototype.setHsv=function(e,i){var r=te("."+rr,this.container),o=r.getBoundingClientRect();this.enableRtl?e=e>o.right?0:Math.abs(e-o.right):e=e>o.left?Math.abs(e-o.left):0,i=i>o.top?Math.abs(i-o.top):0,this.hsv[2]=Math.round(Number(100*(r.offsetHeight-Math.max(0,Math.min(r.offsetHeight,i-r.offsetTop)))/r.offsetHeight)*10)/10,this.hsv[1]=Math.round(Number(100*Math.max(0,Math.min(r.offsetWidth,e-r.offsetLeft))/r.offsetWidth)*10)/10},t.prototype.handlerEnd=function(e){e.type!=="touchend"&&e.preventDefault(),b.remove(document,"mousemove touchmove",this.handlerMove),b.remove(document,"mouseup touchend",this.handlerEnd);var i=this.getDragHandler();te("."+rr,this.container).style.cursor="",this.tooltipEle.style.transform&&(this.tooltipEle.style.transform="",i.classList.remove("e-hide-handler")),!this.inline&&!this.showButtons&&this.closePopup(e)},t.prototype.btnClickHandler=function(e){var i=e.target;ce(i,"."+Gr)?(e.stopPropagation(),this.switchToPalette()):(i.classList.contains(tr)||i.classList.contains(Zr))&&this.ctrlBtnClick(i,e)},t.prototype.switchToPalette=function(){this.trigger("beforeModeSwitch",{element:this.container,mode:"Palette"}),this.unWireEvents(),this.destroyOtherComp(),X(te(".e-slider-preview",this.container)),this.getWrapper().classList.contains(ci)||it(te("."+Ai,this.container)),X(this.getHsvContainer()),this.createPalette(),this.firstPaletteFocus(),this.createInput(),this.refreshPopupPos(),this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("e-ie-ddb-popup")&&this.refreshImageEditorPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Palette"})},t.prototype.refreshImageEditorPopupPos=function(){if(S.isDevice){var e=this.getPopupEle();e.style.left=ee(0+pageXOffset),e.style.top=ee(0+pageYOffset);var i=document.querySelector("#"+this.element.parentElement.parentElement.id.split("-popup")[0]);i&&e.parentElement.ej2_instances[0].refreshPosition(i)}},t.prototype.refreshPopupPos=function(){if(!this.inline){var e=this.getPopupEle();e.style.left=ee(0+pageXOffset),e.style.top=ee(0+pageYOffset),this.getPopupInst().refreshPosition(this.splitBtn.element.parentElement)}},t.prototype.formatSwitchHandler=function(){this.isRgb?(this.updateValue(this.hsv,!0,3,[360,100,100]),this.isRgb=!1):(this.updateValue(this.rgb,!0,2),this.isRgb=!0)},t.prototype.updateValue=function(e,i,r,o){for(var a=["e-rh-value","e-gs-value","e-bv-value"],n,s=0,h=a.length;s<h;s++)n=Pi(te("."+a[s],this.container),Yi),n.value=Math.round(e[s]),i&&(n.placeholder=a[s].substr(r,1).toUpperCase(),n.max=o?o[s]:255),n.dataBind()},t.prototype.previewHandler=function(e){var i=e.target,r=this.rgbToHex(this.rgb);this.rgb=this.convertRgbToNumberArray(i.style.backgroundColor),this.rgb[3]||(this.rgb[3]=1);var o=this.rgbToHex(this.rgb),a=this.rgbToHsv.apply(this,this.rgb);a[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:a[0]},!0),this.hueSlider.refresh()),this.setHsvContainerBg(a[0]),this.enableOpacity&&a[3]!==this.hsv[3]&&(this.opacitySlider.setProperties({value:a[3]*100},!0),this.opacitySlider.refresh(),this.updateOpacitySliderBg()),this.hsv=a,this.setHandlerPosition(),this.updateInput(o),te("."+Kr+" ."+ma,this.container).style.backgroundColor=this.convertToRgbString(this.rgb),this.triggerEvent(o,r,this.convertToRgbString(this.rgb),!1,e)},t.prototype.paletteClickHandler=function(e){e.preventDefault();var i=e.target;if(i.classList.contains(to)){if(this.removeTileSelection(),this.addTileSelection(i),i.classList.contains(ba))this.noColorTile();else{var r=i.getAttribute("aria-label"),o=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(this.roundValue(r)),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(zi)&&this.updateInput(r),this.triggerEvent(r,o,this.convertToRgbString(this.rgb),!1,e)}!this.inline&&!this.showButtons&&this.closePopup(e)}else ce(i,"."+Gr)?this.switchToPicker():i.classList.contains(tr)||i.classList.contains(Zr)?this.ctrlBtnClick(i,e):this.getWrapper().classList.contains(zi)&&ce(i,"."+pl)&&this.formatSwitchHandler()},t.prototype.noColorTile=function(e){e===void 0&&(e=!1);var i=this.rgbToHex(this.rgb);this.rgb=[],this.hsv=[],this.triggerEvent("",i,"",e)},t.prototype.switchToPicker=function(){var e=this.getWrapper();this.trigger("beforeModeSwitch",{element:this.container,mode:"Picker"}),this.unWireEvents(),[].slice.call(me("."+or,this.container)).forEach(function(r){X(r)}),this.container.querySelector(".e-clr-pal-rec-wpr")&&X(this.container.querySelector(".e-clr-pal-rec-wpr")),e.classList.contains(zi)&&X(te("."+Ai,this.container)),this.container.style.width="";var i=te(".e-custom-palette",this.container);this.presetColors&&it(i),this.createPicker(),this.getDragHandler().focus(),this.createInput(),this.refreshPopupPos(),this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("e-ie-ddb-popup")&&this.refreshImageEditorPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Picker"})},t.prototype.ctrlBtnClick=function(e,i){if(e.classList.contains(tr)){var r=this.rgbToHex(this.rgb);this.triggerChangeEvent(r,i)}if(!this.inline)this.closePopup(i),this.splitBtn.element.focus();else if(e.classList.contains(Zr)){var o={element:this.container,event:i,cancel:!1};this.trigger("beforeClose",o)}},t.prototype.paletteKeyDown=function(e){var i=e.target;if(i.classList.contains(or)){var r,o,a=[].slice.call(me("."+to,i)),n=a.filter(function(h){return h.classList.contains("e-selected")}).pop();switch(!e.altKey&&e.keyCode){case 39:e.preventDefault(),r=n?a[this.tilePosition(a,n,this.enableRtl?-1:1)]:a[this.enableRtl?a.length-1:0],this.keySelectionChanges(r);break;case 37:e.preventDefault(),r=n?a[this.tilePosition(a,n,this.enableRtl?1:-1)]:a[this.enableRtl?0:a.length-1],this.keySelectionChanges(r);break;case 38:e.preventDefault(),o=n?this.tilePosition(a,n,-this.columns):0,r=a[o]?a[o]:a[o-this.columns],this.keySelectionChanges(r);break;case 40:e.preventDefault(),o=n?this.tilePosition(a,n,this.columns):a.length-1,a[o]||(o%=a.length,o+=a[a.length-1].parentElement.childElementCount),r=a[o],this.keySelectionChanges(r);break;case 13:if(e.preventDefault(),n){var s=n.getAttribute("aria-label");this.enterKeyHandler(s||"")}break}}},t.prototype.keySelectionChanges=function(e){if(this.removeTileSelection(),this.addTileSelection(e),e.classList.contains(ba))this.noColorTile(!0);else{var i=e.getAttribute("aria-label"),r=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(i),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(zi)&&this.updateInput(i),this.triggerEvent(i,r,this.convertToRgbString(this.rgb),!0)}},t.prototype.tilePosition=function(e,i,r){e=Array.prototype.slice.call(e);var o=e.length,a=this.columns-e[o-1].parentElement.childElementCount,n=e.indexOf(i);return n+=r,n<0?n+=o+a:n%=o+a,n},t.prototype.inputHandler=function(e){var i=e.target;if(i.value.length){var r,o,a=te(".e-float-text",i.parentElement).textContent;switch(a){case"HEX":{var n="";if((i.value[0]==="#"&&i.value.length!==5||i.value[0]!=="#"&&i.value.length!==4)&&(n=this.roundValue(i.value)),n.length===9)o=this.rgbToHex(this.rgb),this.rgb=this.hexToRgb(n+n.substr(-2)),this.inputValueChange(this.rgbToHsv.apply(this,this.rgb),o,i.value,e);else return;break}case"R":this.rgb[0]!==Number(i.value)&&(o=this.rgbToHex(this.rgb),this.rgb[0]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,o,null,e));break;case"G":this.rgb[1]!==Number(i.value)&&(o=this.rgbToHex(this.rgb),this.rgb[1]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,o,null,e));break;case"B":this.rgb[2]!==Number(i.value)&&(o=this.rgbToHex(this.rgb),this.rgb[2]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,o,null,e));break;case"H":this.hueSlider.value=Number(i.value);break;case"S":this.hsv[1]!==Number(i.value)&&(this.hsv[1]=Number(i.value),this.updateHsv(),this.convertToOtherFormat(!1,e));break;case"V":this.hsv[2]!==Number(i.value)&&(this.hsv[2]=Number(i.value),this.updateHsv(),this.convertToOtherFormat(!1,e));break;case"A":this.opacitySlider.value=Number(i.value);break}}},t.prototype.inputValueChange=function(e,i,r,o){e[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:e[0]},!0),this.hueSlider.refresh(),this.setHsvContainerBg(e[0])),this.hsv=e;var a=this.rgbToHex(this.rgb);this.setHandlerPosition(),this.updateInput(r||a);var n=this.convertToRgbString(this.rgb);this.updatePreview(n),this.triggerEvent(a,i,n,!1,o)},t.prototype.triggerEvent=function(e,i,r,o,a){o===void 0&&(o=!1);var n=e.slice(0,7);d(a)&&(a=new MouseEvent("click",{bubbles:!0,cancelable:!1})),!this.showButtons&&!o?(this.trigger("change",{currentValue:{hex:n,rgba:r},event:a,previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:e}),this.showRecentColors&&(this.recentColors.unshift(n),this.inline&&this.renderRecentColor()),this.enableOpacity?this.setProperties({value:e},!0):this.setProperties({value:n},!0),this.element.value=n||"#000000"):this.trigger("select",{currentValue:{hex:n,rgba:r},event:a,previousValue:{hex:i.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(i))}})},t.prototype.destroy=function(){var e=this,i=this.getWrapper();l.prototype.destroy.call(this),["tabindex","spellcheck"].forEach(function(r){e.element.removeAttribute(r)}),this.inline?(this.unWireEvents(),this.destroyOtherComp()):(this.isPopupOpen()&&(this.unWireEvents(),this.destroyOtherComp()),this.splitBtn.destroy(),this.splitBtn=null),this.tileRipple(),this.tileRipple=null,this.ctrlBtnRipple(),this.ctrlBtnRipple=null,this.element.nextElementSibling&&X(this.element.nextElementSibling),i&&(i.parentElement.insertBefore(this.element,i),X(i)),this.container=null,this.formElement&&b.remove(this.formElement,"reset",this.formResetHandler)},t.prototype.destroyOtherComp=function(){if(this.isPicker()){for(var e=ce(this.hueSlider.element,".e-color-picker"),i=e.querySelectorAll(".e-numerictextbox"),r=0;r<i.length;r++)Pi(i[r],Yi).destroy();this.hueSlider.destroy(),this.enableOpacity&&(this.opacitySlider.destroy(),this.opacitySlider=null),this.hueSlider=null;var o=this.getTooltipInst();o.close(),o.destroy(),this.tooltipEle=null}},t.prototype.isPopupOpen=function(){return this.getPopupEle().classList.contains("e-popup-open")},t.prototype.unWireEvents=function(){if(this.isPicker()){var e=this.getDragHandler();b.remove(e,"keydown",this.pickerKeyDown);var i=te("."+ir,this.container);i&&b.remove(i,"keydown",this.ctrlBtnKeyDown),b.remove(this.getHsvContainer(),"mousedown touchstart",this.handlerDown),(this.modeSwitcher||this.showButtons)&&b.remove(te("."+Oi,this.container),"click",this.btnClickHandler),b.remove(te("."+$r,this.container),"click",this.previewHandler)}else b.remove(this.container,"click",this.paletteClickHandler),b.remove(this.container,"keydown",this.paletteKeyDown)},t.prototype.roundValue=function(e){if(!e)return"";e[0]!=="#"&&(e="#"+e);var i=e.length;if(i===4&&(e+="f",i=5),i===5){for(var r="",o=1,a=e.length;o<a;o++)r+=e.charAt(o)+e.charAt(o);e="#"+r,i=9}return i===7&&(e+="ff"),e},t.prototype.hexToRgb=function(e){if(!e)return[];e=e.trim(),e.length!==9&&(e=this.roundValue(e));var i=Number((parseInt(e.slice(-2),16)/255).toFixed(2));e=e.slice(1,7);var r=parseInt(e,16),o=[];return o.push(r>>16&255),o.push(r>>8&255),o.push(r&255),o.push(i),o},t.prototype.rgbToHsv=function(e,i,r,o){if(this.rgb&&!this.rgb.length)return[];e/=255,i/=255,r/=255;var a=Math.max(e,i,r),n=Math.min(e,i,r),s,h=a,p=a-n,u=a===0?0:p/a;if(a===n)s=0;else{switch(a){case e:s=(i-r)/p+(i<r?6:0);break;case i:s=(r-e)/p+2;break;case r:s=(e-i)/p+4;break}s/=6}var c=[Math.round(s*360),Math.round(u*1e3)/10,Math.round(h*1e3)/10];return d(o)||c.push(o),c},t.prototype.hsvToRgb=function(e,i,r,o){var a,n,s;if(i/=100,r/=100,i===0)return a=n=s=r,[Math.round(a*255),Math.round(n*255),Math.round(s*255),o];e/=60;var h=Math.floor(e),p=e-h,u=r*(1-i),c=r*(1-i*p),f=r*(1-i*(1-p));switch(h){case 0:a=r,n=f,s=u;break;case 1:a=c,n=r,s=u;break;case 2:a=u,n=r,s=f;break;case 3:a=u,n=c,s=r;break;case 4:a=f,n=u,s=r;break;default:a=r,n=u,s=c}var g=[Math.round(a*255),Math.round(n*255),Math.round(s*255)];return d(o)||g.push(o),g},t.prototype.rgbToHex=function(e){return e.length?"#"+this.hex(e[0])+this.hex(e[1])+this.hex(e[2])+(d(e[3])?"":e[3]!==0?(Math.round(e[3]*255)+65536).toString(16).substr(-2):"00"):""},t.prototype.hex=function(e){return("0"+e.toString(16)).slice(-2)},t.prototype.changeModeSwitcherProp=function(e){var i=te("."+Oi,this.container);e?i?this.appendModeSwitchBtn():(this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):i&&(this.showButtons?X(te("."+Gr,i)):it(i))},t.prototype.changeShowBtnProps=function(e){var i=te("."+Oi,this.container);e?(i&&it(i),this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):this.modeSwitcher?X(te("."+ir,i)):it(i)},t.prototype.changeValueProp=function(e){if(this.isPicker())this.rgb=this.hexToRgb(e),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHandlerPosition(),X(ce(this.hueSlider.element,".e-slider-preview")),this.createSlider(),this.setHsvContainerBg(),this.updateInput(e),this.rgb.length===4&&this.updateOpacityInput(this.rgb[3]*100);else{this.removeTileSelection();var i=this.container.querySelector('span[aria-label="'+this.roundValue(e)+'"]');i&&this.addTileSelection(i)}},t.prototype.setInputEleProps=function(){it(te("."+Ai,this.container)),this.createInput()},t.prototype.changeDisabledProp=function(e){this.isPicker()&&(this.hueSlider.enabled=!e,this.opacitySlider.enabled=!e,this.setInputEleProps()),e?(this.toggleDisabled(!0),this.unWireEvents()):(this.toggleDisabled(!1),this.wireEvents())},t.prototype.changeCssClassProps=function(e,i){var r=this.getWrapper(),o=this.getPopupEle();i&&G([r,o],i.split(" ")),e&&W([r,o],e.replace(/\s+/g," ").trim().split(" "))},t.prototype.changeRtlProps=function(e){e?W([this.getWrapper()],"e-rtl"):G([this.getWrapper()],"e-rtl")},t.prototype.changePaletteProps=function(){X(this.container.children[0]),this.container.style.width="",this.createPalette()},t.prototype.changeOpacityProps=function(e){var i=this.getWrapper();e?(G([this.container.parentElement],Ma),this.createOpacitySlider(te(".e-colorpicker-slider",this.container).appendChild(this.createElement("div",{className:"e-opacity-slider"}))),!i.classList.contains(ci)&&!i.classList.contains(xi)&&this.appendOpacityValue(te(".e-input-container",this.container))):(W([this.container.parentElement],Ma),this.opacitySlider.destroy(),it(this.opacitySlider.element),this.opacitySlider=null,!i.classList.contains(ci)&&!i.classList.contains(xi)&&it(te("."+ja,this.container).parentElement))},t.prototype.onPropertyChanged=function(e,i){var r=this;if(!d(e.value)){var o=this.roundValue(e.value);if(o.length===9){this.element.value=this.roundValue(o).slice(0,7);var a=this.splitBtn&&te("."+eo,this.splitBtn.element);a&&(a.style.backgroundColor=this.convertToRgbString(this.hexToRgb(e.value)))}else if(this.noColor&&this.mode==="Palette"&&this.value===""){var a=this.splitBtn&&te("."+eo,this.splitBtn.element);a.style.backgroundColor=""}else this.value=i.value}if(!this.inline&&d(e.inline)){var n=["disabled","enableRtl"];if(this.splitBtn.setProperties(wr(e,n)),!this.isPopupOpen()){this.changeCssClassProps(e.cssClass,i.cssClass),this.changeRtlProps(e.enableRtl);return}}for(var s=function(f){switch(f){case"inline":e.inline?(h.getWrapper().appendChild(h.container),h.splitBtn.destroy(),X(h.element.nextElementSibling),h.container.children.length||h.createWidget()):(h.destroyOtherComp(),h.unWireEvents(),h.container.innerHTML="",h.createSplitBtn());break;case"cssClass":{h.changeCssClassProps(e.cssClass,i.cssClass);var g=e.cssClass.split(" ").concat(i.cssClass.split(" "));g=g.reduce(function(C,M){return C.indexOf(M)<0&&C.push(M),C},[]);var v=0;g.forEach(function(C){if(v===0&&(C===ci||C===dl||C===zi||C===Ca||C===xi)){var M=te("."+Ai,r.container);M&&it(te("."+Ai,r.container)),r.createInput(),v++}});break}case"enableRtl":h.isPicker()&&(h.hueSlider.enableRtl=e.enableRtl,h.enableOpacity&&(h.opacitySlider.enableRtl=e.enableRtl),h.setInputEleProps()),h.changeRtlProps(e.enableRtl);break;case"disabled":h.changeDisabledProp(e.disabled);break;case"value":h.value!==i.value&&h.changeValueProp(e.value);break;case"showButtons":h.changeShowBtnProps(e.showButtons);break;case"mode":e.mode==="Picker"?h.switchToPicker():h.switchToPalette();break;case"modeSwitcher":h.changeModeSwitcherProp(e.modeSwitcher);break;case"columns":case"presetColors":h.isPicker()||h.changePaletteProps();break;case"noColor":e.noColor?h.mode==="Palette"&&!h.modeSwitcher&&h.setNoColor():h.changePaletteProps();break;case"enableOpacity":h.changeOpacityProps(e.enableOpacity);break;case"showRecentColors":if(!e.showRecentColors){var m=h.container.querySelector(".e-clr-pal-rec-wpr");m&&X(m)}h.recentColors=[];break}},h=this,p=0,u=Object.keys(e);p<u.length;p++){var c=u[p];s(c)}},t.prototype.focusIn=function(){this.element.parentElement.focus()},ke([T("#008000ff")],t.prototype,"value",void 0),ke([T("")],t.prototype,"cssClass",void 0),ke([T(!1)],t.prototype,"disabled",void 0),ke([T("Picker")],t.prototype,"mode",void 0),ke([T(!0)],t.prototype,"modeSwitcher",void 0),ke([T(null)],t.prototype,"presetColors",void 0),ke([T(!0)],t.prototype,"showButtons",void 0),ke([T(10)],t.prototype,"columns",void 0),ke([T(!1)],t.prototype,"inline",void 0),ke([T(!1)],t.prototype,"noColor",void 0),ke([T(!1)],t.prototype,"enablePersistence",void 0),ke([T(!0)],t.prototype,"enableOpacity",void 0),ke([T(!1)],t.prototype,"createPopupOnClick",void 0),ke([T(!1)],t.prototype,"showRecentColors",void 0),ke([Y()],t.prototype,"select",void 0),ke([Y()],t.prototype,"change",void 0),ke([Y()],t.prototype,"beforeTileRender",void 0),ke([Y()],t.prototype,"beforeOpen",void 0),ke([Y()],t.prototype,"open",void 0),ke([Y()],t.prototype,"beforeClose",void 0),ke([Y()],t.prototype,"beforeModeSwitch",void 0),ke([Y()],t.prototype,"onModeSwitch",void 0),ke([Y()],t.prototype,"created",void 0),t=ke([Qe],t),t}(ct),Kv=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Xe=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},$v="e-clear-icon-hide",ey=function(l){Kv(t,l);function t(e,i){var r=l.call(this,e,i)||this;return r.previousValue=null,r.isHiddenInput=!1,r.isForm=!1,r.inputPreviousValue=null,r.textboxOptions=e,r}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,o=Object.keys(e);r<o.length;r++){var a=o[r];switch(a){case"floatLabelType":ne.removeFloating(this.textboxWrapper),ne.addFloating(this.respectiveElement,this.floatLabelType,this.placeholder);break;case"enabled":ne.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container),this.bindClearEvent();break;case"width":ne.setWidth(e.width,this.textboxWrapper.container);break;case"value":{var n=this.isProtectedOnChange;this.isProtectedOnChange=!0,ne.isBlank(this.value)||(this.value=this.value.toString()),this.isProtectedOnChange=n,ne.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.inputPreviousValue=this.respectiveElement.value,(this.isAngular||this.isVue)&&this.preventChange===!0?(this.previousValue=this.isAngular?this.value:this.previousValue,this.preventChange=!1):(d(this.isAngular)||!this.isAngular||this.isAngular&&!this.preventChange||this.isAngular&&d(this.preventChange))&&this.raiseChangeEvent()}break;case"htmlAttributes":this.updateHTMLAttributesToElement(),this.updateHTMLAttributesToWrapper(),this.checkAttributes(!0),this.multiline&&!d(this.textarea)?ne.validateInputType(this.textboxWrapper.container,this.textarea):ne.validateInputType(this.textboxWrapper.container,this.element);break;case"readonly":ne.setReadonly(this.readonly,this.respectiveElement);break;case"type":this.respectiveElement.tagName!=="TEXTAREA"&&(this.respectiveElement.setAttribute("type",this.type),ne.validateInputType(this.textboxWrapper.container,this.element),this.raiseChangeEvent());break;case"showClearButton":ne.setClearButton(this.showClearButton,this.respectiveElement,this.textboxWrapper),this.bindClearEvent();break;case"enableRtl":ne.setEnableRtl(this.enableRtl,[this.textboxWrapper.container]);break;case"placeholder":ne.setPlaceholder(this.placeholder,this.respectiveElement),ne.calculateWidth(this.respectiveElement,this.textboxWrapper.container);break;case"autocomplete":this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:this.removeAttributes(["autocomplete"]);break;case"cssClass":ne.updateCssClass(e.cssClass,i.cssClass,this.textboxWrapper.container);break;case"locale":this.globalize=new Mo(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),ne.setPlaceholder(this.placeholder,this.respectiveElement);break}}},t.prototype.getModuleName=function(){return"textbox"},t.prototype.preRender=function(){if(this.cloneElement=this.element.cloneNode(!0),this.formElement=ce(this.element,"form"),d(this.formElement)||(this.isForm=!0),this.element.tagName==="EJS-TEXTBOX"){var e=Z("ej2_instances",this.element),i=this.multiline?this.createElement("textarea"):this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var o=this.element.attributes[r].nodeName;o!=="id"&&o!=="class"?(i.setAttribute(o,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML,o==="name"&&this.element.removeAttribute("name")):o==="class"&&i.setAttribute(o,this.element.className.split(" ").filter(function(s){return s.indexOf("ng-")!==0}).join(" "))}this.element.appendChild(i),this.element=i,Ae("ej2_instances",e,this.element)}this.updateHTMLAttributesToElement(),this.checkAttributes(!1),(d(this.textboxOptions)||this.textboxOptions.value===void 0)&&this.element.value!==""&&this.setProperties({value:this.element.value},!0),this.element.tagName!=="TEXTAREA"&&this.element.setAttribute("type",this.type),(this.type==="text"||this.element.tagName==="INPUT"&&this.multiline&&this.isReact)&&this.element.setAttribute("role","textbox"),this.globalize=new Mo(this.locale);var a={placeholder:this.placeholder};if(this.l10n=new Mi("textbox",a,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",Ve("textbox")),this.element.hasAttribute("name")||this.element.setAttribute("name",this.element.getAttribute("id")),this.element.tagName==="INPUT"&&this.multiline){this.isHiddenInput=!0,this.textarea=this.createElement("textarea"),this.element.parentNode.insertBefore(this.textarea,this.element),this.element.setAttribute("type","hidden"),this.textarea.setAttribute("name",this.element.getAttribute("name")),this.element.removeAttribute("name"),this.textarea.setAttribute("role",this.element.getAttribute("role")),this.element.removeAttribute("role"),this.textarea.setAttribute("id",Ve("textarea"));for(var n=["placeholder","disabled","value","readonly","type","autocomplete"],r=0;r<this.element.attributes.length;r++){var o=this.element.attributes[r].nodeName;this.element.hasAttribute(o)&&Ja.indexOf(o)<0&&!(o==="id"||o==="type"||o==="e-mappinguid")&&(this.textarea.setAttribute(o,this.element.attributes[r].nodeValue),n.indexOf(o)<0&&(this.element.removeAttribute(o),r--))}}},t.prototype.checkAttributes=function(e){for(var i=e?d(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["placeholder","disabled","value","readonly","type","autocomplete"],r=0,o=i;r<o.length;r++){var a=o[r];if(!d(this.element.getAttribute(a)))switch(a){case"disabled":if(d(this.textboxOptions)||this.textboxOptions.enabled===void 0||e){var n=!(this.element.getAttribute(a)==="disabled"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true");this.setProperties({enabled:n},!e)}break;case"readonly":if(d(this.textboxOptions)||this.textboxOptions.readonly===void 0||e){var s=this.element.getAttribute(a)==="readonly"||this.element.getAttribute(a)===""||this.element.getAttribute(a)==="true";this.setProperties({readonly:s},!e)}break;case"placeholder":(d(this.textboxOptions)||this.textboxOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.element.placeholder},!e);break;case"autocomplete":if(d(this.textboxOptions)||this.textboxOptions.autocomplete===void 0||e){var h=this.element.autocomplete==="off"?"off":"on";this.setProperties({autocomplete:h},!e)}break;case"value":(d(this.textboxOptions)||this.textboxOptions.value===void 0||e)&&this.element.value!==""&&this.setProperties({value:this.element.value},!e);break;case"type":(d(this.textboxOptions)||this.textboxOptions.type===void 0||e)&&this.setProperties({type:this.element.type},!e);break}}},t.prototype.render=function(){var e=this.cssClass;!d(this.cssClass)&&this.cssClass!==""&&(e=ne.getInputValidClassList(this.cssClass)),this.respectiveElement=this.isHiddenInput?this.textarea:this.element,this.textboxWrapper=ne.createInput({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:{enabled:this.enabled,enableRtl:this.enableRtl,cssClass:e,readonly:this.readonly,placeholder:this.placeholder,showClearButton:this.showClearButton}}),this.updateHTMLAttributesToWrapper(),this.isHiddenInput&&this.respectiveElement.parentNode.insertBefore(this.element,this.respectiveElement),this.wireEvents(),d(this.value)||(ne.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value)),d(this.value)||(this.initialValue=this.value,this.setInitialValue()),this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:!d(this.textboxOptions)&&this.textboxOptions.autocomplete!==void 0&&this.removeAttributes(["autocomplete"]),this.previousValue=this.value,this.inputPreviousValue=this.value,this.respectiveElement.defaultValue=this.respectiveElement.value,ne.setWidth(this.width,this.textboxWrapper.container),!d(ce(this.element,"fieldset"))&&ce(this.element,"fieldset").disabled&&(this.enabled=!1),!this.element.hasAttribute("aria-labelledby")&&!this.element.hasAttribute("placeholder")&&!this.element.hasAttribute("aria-label")&&this.element.setAttribute("aria-label","textbox"),this.renderComplete()},t.prototype.updateHTMLAttributesToWrapper=function(){ne.updateHTMLAttributesToWrapper(this.htmlAttributes,this.textboxWrapper.container)},t.prototype.updateHTMLAttributesToElement=function(){ne.updateHTMLAttributesToElement(this.htmlAttributes,this.respectiveElement?this.respectiveElement:this.multiline&&!d(this.textarea)?this.textarea:this.element)},t.prototype.setInitialValue=function(){this.isAngular||this.respectiveElement.setAttribute("value",this.initialValue)},t.prototype.wireEvents=function(){b.add(this.respectiveElement,"focus",this.focusHandler,this),b.add(this.respectiveElement,"blur",this.focusOutHandler,this),b.add(this.respectiveElement,"keydown",this.keydownHandler,this),b.add(this.respectiveElement,"input",this.inputHandler,this),b.add(this.respectiveElement,"change",this.changeHandler,this),this.isForm&&b.add(this.formElement,"reset",this.resetForm,this),this.bindClearEvent(),!d(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-autofill")&&this.textboxWrapper.container.classList.contains("e-outline")&&b.add(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler,this)},t.prototype.animationHandler=function(){this.textboxWrapper.container.classList.add("e-valid-input");var e=this.textboxWrapper.container.querySelector(".e-float-text");d(e)||(e.classList.add("e-label-top"),e.classList.contains("e-label-bottom")&&e.classList.remove("e-label-bottom"))},t.prototype.resetValue=function(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.value=e,e==null&&this.textboxWrapper.container.classList.contains("e-valid-input")&&!(this.floatLabelType==="Always"&&this.textboxWrapper.container.classList.contains("e-outline"))&&this.textboxWrapper.container.classList.remove("e-valid-input"),this.isProtectedOnChange=i},t.prototype.resetForm=function(){if(this.isAngular?this.resetValue(""):this.resetValue(this.initialValue),!d(this.textboxWrapper)){var e=this.textboxWrapper.container.querySelector(".e-float-text");!d(e)&&this.floatLabelType!=="Always"&&(d(this.initialValue)||this.initialValue===""?(e.classList.add("e-label-bottom"),e.classList.remove("e-label-top")):this.initialValue!==""&&(e.classList.add("e-label-top"),e.classList.remove("e-label-bottom")))}},t.prototype.focusHandler=function(e){var i={container:this.textboxWrapper.container,event:e,value:this.value};this.trigger("focus",i)},t.prototype.focusOutHandler=function(e){!(this.previousValue===null&&this.value===null&&this.respectiveElement.value==="")&&this.previousValue!==this.value&&this.raiseChangeEvent(e,!0);var i={container:this.textboxWrapper.container,event:e,value:this.value};this.trigger("blur",i)},t.prototype.keydownHandler=function(e){(e.keyCode===13||e.keyCode===9)&&!((this.previousValue===null||this.previousValue==="")&&(this.value===null||this.value==="")&&this.respectiveElement.value==="")&&this.setProperties({value:this.respectiveElement.value},!0)},t.prototype.inputHandler=function(e){var i=this,r={event:e,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};this.inputPreviousValue=this.respectiveElement.value,this.isAngular&&(i.localChange({value:this.respectiveElement.value}),this.preventChange=!0),this.isVue&&(this.preventChange=!0),this.trigger("input",r),e.stopPropagation()},t.prototype.changeHandler=function(e){this.setProperties({value:this.respectiveElement.value},!0),this.previousValue!==this.value&&this.raiseChangeEvent(e,!0),e.stopPropagation()},t.prototype.raiseChangeEvent=function(e,i){var r={event:e,value:this.value,previousValue:this.previousValue,container:this.textboxWrapper.container,isInteraction:i||!1,isInteracted:i||!1};this.preventChange=!1,this.trigger("change",r),this.previousValue=this.value,this.element.tagName==="INPUT"&&this.multiline&&S.info.name==="mozilla"&&(this.element.value=this.respectiveElement.value)},t.prototype.bindClearEvent=function(){this.showClearButton&&(this.enabled?b.add(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler,this):b.remove(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler))},t.prototype.resetInputHandler=function(e){if(e.preventDefault(),!this.textboxWrapper.clearButton.classList.contains($v)||this.textboxWrapper.container.classList.contains("e-static-clear")){ne.setValue("",this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.setProperties({value:this.respectiveElement.value},!0);var i={event:e,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};if(this.trigger("input",i),this.inputPreviousValue=this.respectiveElement.value,this.raiseChangeEvent(e,!0),ce(this.element,"form")){var r=this.element,o=document.createEvent("KeyboardEvent");o.initEvent("keyup",!1,!0),r.dispatchEvent(o)}}},t.prototype.unWireEvents=function(){b.remove(this.respectiveElement,"focus",this.focusHandler),b.remove(this.respectiveElement,"blur",this.focusOutHandler),b.remove(this.respectiveElement,"keydown",this.keydownHandler),b.remove(this.respectiveElement,"input",this.inputHandler),b.remove(this.respectiveElement,"change",this.changeHandler),this.isForm&&b.remove(this.formElement,"reset",this.resetForm),!d(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-outline")&&this.textboxWrapper.container.classList.contains("e-autofill")&&b.remove(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler)},t.prototype.destroy=function(){this.unWireEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),this.element.tagName==="INPUT"&&this.multiline&&(X(this.textboxWrapper.container.getElementsByTagName("textarea")[0]),this.respectiveElement=this.element,this.element.removeAttribute("type")),this.respectiveElement.value=this.respectiveElement.defaultValue,this.respectiveElement.classList.remove("e-input"),this.removeAttributes(["aria-disabled","aria-readonly","aria-labelledby"]),d(this.textboxWrapper)||(this.textboxWrapper.container.insertAdjacentElement("afterend",this.respectiveElement),X(this.textboxWrapper.container)),this.textboxWrapper=null,ne.destroy({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),l.prototype.destroy.call(this)},t.prototype.addIcon=function(e,i){ne.addIcon(e,i,this.textboxWrapper.container,this.respectiveElement,this.createElement)},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.addAttributes=function(e){for(var i=0,r=Object.keys(e);i<r.length;i++){var o=r[i];o==="disabled"?(this.setProperties({enabled:!1},!0),ne.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):o==="readonly"?(this.setProperties({readonly:!0},!0),ne.setReadonly(this.readonly,this.respectiveElement)):o==="class"?this.respectiveElement.classList.add(e[""+o]):o==="placeholder"?(this.setProperties({placeholder:e[""+o]},!0),ne.setPlaceholder(this.placeholder,this.respectiveElement)):o==="rows"&&this.respectiveElement.tagName==="TEXTAREA"?this.respectiveElement.setAttribute(o,e[""+o]):this.respectiveElement.setAttribute(o,e[""+o])}},t.prototype.removeAttributes=function(e){for(var i=0,r=e;i<r.length;i++){var o=r[i];o==="disabled"?(this.setProperties({enabled:!0},!0),ne.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):o==="readonly"?(this.setProperties({readonly:!1},!0),ne.setReadonly(this.readonly,this.respectiveElement)):o==="placeholder"?(this.setProperties({placeholder:null},!0),ne.setPlaceholder(this.placeholder,this.respectiveElement)):this.respectiveElement.removeAttribute(o)}},t.prototype.focusIn=function(){document.activeElement!==this.respectiveElement&&this.enabled&&(this.respectiveElement.focus(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&W([this.textboxWrapper.container],[qs]))},t.prototype.focusOut=function(){document.activeElement===this.respectiveElement&&this.enabled&&(this.respectiveElement.blur(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&G([this.textboxWrapper.container],[qs]))},Xe([T("text")],t.prototype,"type",void 0),Xe([T(!1)],t.prototype,"readonly",void 0),Xe([T(null)],t.prototype,"value",void 0),Xe([T("Never")],t.prototype,"floatLabelType",void 0),Xe([T("")],t.prototype,"cssClass",void 0),Xe([T(null)],t.prototype,"placeholder",void 0),Xe([T("on")],t.prototype,"autocomplete",void 0),Xe([T({})],t.prototype,"htmlAttributes",void 0),Xe([T(!1)],t.prototype,"multiline",void 0),Xe([T(!0)],t.prototype,"enabled",void 0),Xe([T(!1)],t.prototype,"showClearButton",void 0),Xe([T(!1)],t.prototype,"enablePersistence",void 0),Xe([T(null)],t.prototype,"width",void 0),Xe([Y()],t.prototype,"created",void 0),Xe([Y()],t.prototype,"destroyed",void 0),Xe([Y()],t.prototype,"change",void 0),Xe([Y()],t.prototype,"blur",void 0),Xe([Y()],t.prototype,"focus",void 0),Xe([Y()],t.prototype,"input",void 0),t=Xe([Qe],t),t}(ct),_i=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ie=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},ty=function(l){_i(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return ie([T(null)],t.prototype,"allowedExtensions",void 0),ie([T(null)],t.prototype,"minFileSize",void 0),ie([T(null)],t.prototype,"maxFileSize",void 0),t}(Be),iy=function(l){_i(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return ie([T(null)],t.prototype,"brightness",void 0),ie([T(null)],t.prototype,"contrast",void 0),ie([T(null)],t.prototype,"hue",void 0),ie([T(null)],t.prototype,"saturation",void 0),ie([T(null)],t.prototype,"exposure",void 0),ie([T(null)],t.prototype,"opacity",void 0),ie([T(null)],t.prototype,"blur",void 0),t}(Be),ry=function(l){_i(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return ie([T(null)],t.prototype,"zoomTrigger",void 0),ie([T(1)],t.prototype,"minZoomFactor",void 0),ie([T(10)],t.prototype,"maxZoomFactor",void 0),ie([T(1)],t.prototype,"zoomFactor",void 0),ie([T(null)],t.prototype,"zoomPoint",void 0),t}(Be),oy=function(l){_i(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return ie([T(!0)],t.prototype,"showCircle",void 0),ie([T(null)],t.prototype,"strokeColor",void 0),ie([T(null)],t.prototype,"fillColor",void 0),t}(Be),ay=function(l){_i(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return ie([T("Arial")],t.prototype,"default",void 0),ie([T(null)],t.prototype,"items",void 0),t}(Be),ny=function(l){_i(t,l);function t(i,r){var o=l.call(this,i)||this;return o.isImageLoaded=!1,o.activeObj={activePoint:{startX:0,startY:0,endX:0,endY:0,width:0,height:0},flipObjColl:[],triangle:[],triangleRatio:[],rotatedAngle:0,opacity:1,order:null},o.currObjType={shape:"",isDragging:!1,isActiveObj:!1,isText:!1,isInitialText:!1,isLine:!1,isInitialLine:!1,isCustomCrop:!1,isZoomed:!1,isUndoZoom:!1,isUndoAction:!1,isFiltered:!1,isSave:!1,isResize:!1,isRedact:!1},o.objColl=[],o.pointColl={},o.freehandCounter=0,o.points=[],o.togglePen=!1,o.togglePan=!1,o.img={destLeft:0,destTop:0,destWidth:0,destHeight:0,srcLeft:0,srcTop:0,srcWidth:0,srcHeight:0},o.rotateFlipColl=[],o.cropObj={cropZoom:0,defaultZoom:0,totalPannedPoint:{x:0,y:0},totalPannedClientPoint:{x:0,y:0},totalPannedInternalPoint:{x:0,y:0},tempFlipPanPoint:{x:0,y:0},activeObj:{},rotateFlipColl:[],degree:0,currFlipState:"",straighten:0,destPoints:{startX:0,startY:0,width:0,height:0},srcPoints:{startX:0,startY:0,width:0,height:0},filter:"",isBrightAdjust:!1,zoomFactor:0,previousZoomValue:0,aspectWidth:null,aspectHeight:null,frame:"none",straightenZoom:0,adjustmentLevel:{brightness:0,contrast:0,hue:0,opacity:100,saturation:0,blur:0,exposure:0,transparency:100,sharpen:!1,bw:!1},currentFilter:""},o.afterCropActions=[],o.transform={degree:0,currFlipState:"",zoomFactor:0,cropZoomFactor:null,defaultZoomFactor:0,straighten:0},o.panPoint={currentPannedPoint:{x:0,y:0},totalPannedPoint:{x:0,y:0},totalPannedInternalPoint:{x:0,y:0},totalPannedClientPoint:{x:0,y:0}},o.isUndoRedo=!1,o.isCropTab=!1,o.isCircleCrop=!1,o.fontSizeColl=[],o.initialAdjustmentValue="",o.currentFilter="",o.canvasFilter="brightness(1) contrast(100%) hue-rotate(0deg) saturate(100%) opacity(1) blur(0px) sepia(0%) grayscale(0%) invert(0%)",o.toolbarHeight=0,o.isPublicMethod=!1,o.isCropToolbar=!1,o.cursor="default",o.resizeSrc={startX:o.img.srcLeft,startY:o.img.srcTop,width:o.img.srcWidth,height:o.img.srcHeight},o.isResize=!1,o.isAspectRatio=!1,o.frameObj={type:"none",color:"#fff",size:20,inset:20,offset:20,radius:0,amount:1,border:"solid",gradientColor:""},o.tempFrameObj={type:"none",color:"#fff",size:20,inset:20,offset:20,radius:0,amount:1,border:"solid",gradientColor:""},o.allowDownScale=!0,o.gradientColor="",o.size=20,o.inset=0,o.offset=0,o.borderRadius=0,o.lineCount=0,o.prevStraightenedDegree=0,o.tempStraighten=0,o.isStraightening=!1,o.isFinetuning=!1,o.isZoomBtnClick=!1,o.isFinetuneBtnClick=!1,o.isFilterCanvasClick=!1,o.isFrameBtnClick=!1,o.isChangesSaved=!1,o.isShapeDrawing=!1,o.noPushUndo=!1,o.isUndoRedoStack=!1,o.shapeColl=[],o.isKBDNavigation=!1,o.isMaskImage=!1,o.tempObjColl=[],o.tempPointColl=[],o.tempShapeColl=[],o.isImageUpdated=!1,o.noRedact=!1,o.tempRedactBlur=50,o.tempRedactPixel=40,o.tempToolbarHeight=0,o.tempToolbar=[],e.Inject(Ff,hv,dv,gv,pv,Ny),e.Inject(vv),e.Inject(uv),e.Inject(fv),e.Inject(cv),r&&o.appendTo(r),o}e=t,t.prototype.requiredModules=function(){var i=[];return i.push({member:"crop",args:[this]}),i.push({member:"draw",args:[this]}),i.push({member:"selection",args:[this]}),i.push({member:"transform",args:[this]}),i.push({member:"export",args:[this]}),i.push({member:"toolbar-module",args:[this]}),i.push({member:"undo-redo",args:[this]}),i.push({member:"filter",args:[this]}),i.push({member:"shape",args:[this]}),i.push({member:"freehand-draw",args:[this]}),i},t.prototype.preRender=function(){this.element.id=this.element.id||Ve("ej2-image-editor"),this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),S.isDevice&&this.element.classList.add("e-device"),this.initializeThemeColl()},t.prototype.render=function(){if(this.isAngular){var i=this.element,r=i.cloneNode(!0);i.parentNode.replaceChild(r,i),this.element=r,Ae("ej2_instances",[this],this.element)}this.initialize()},t.prototype.getModuleName=function(){return"image-editor"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.onPropertyChanged=function(i,r){for(var o,a=0,n=Object.keys(i);a<n.length;a++){var s=n[a];switch(s){case"cssClass":r.cssClass&&G([this.element],r.cssClass.replace(/\s+/g," ").trim().split(" ")),i.cssClass&&W([this.element],i.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"disabled":i.disabled?(this.element.classList.add("e-disabled"),this.unwireEvent()):(this.element.classList.remove("e-disabled"),this.wireEvent());break;case"height":this.element.style.height=i.height,this.update();break;case"width":this.element.style.width=i.width,this.update();break;case"theme":i.theme&&(this.theme&&this.theme!==""?this.theme=this.toPascalCase(this.theme):this.theme="Bootstrap5",this.upperContext.strokeStyle=this.themeColl[this.theme].primaryColor,this.upperContext.fillStyle=this.themeColl[this.theme].secondaryColor,this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}));break;case"finetuneSettings":i.finetuneSettings&&(this.finetuneSettings=i.finetuneSettings,this.notify("filter",{prop:"update-finetunes"}));break;case"locale":i.locale&&(this.notify("toolbar",{prop:"setLocale",onPropertyChange:!1,value:{locale:i.locale}}),this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}));break;case"allowUndoRedo":i.allowUndoRedo?this.allowUndoRedo=!0:this.allowUndoRedo=!1,this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}});break;case"showQuickAccessToolbar":i.showQuickAccessToolbar?(this.showQuickAccessToolbar=!0,this.notify("toolbar",{prop:"create-qa-toolbar",onPropertyChange:!1}),o={freehandSelectedIndex:null},this.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:o}}),this.activeObj.shape?this.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}}):o.freehandSelectedIndex&&this.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:!0}})):(this.showQuickAccessToolbar=!1,this.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1}));break;case"zoomSettings":i.zoomSettings&&(this.zoomSettings.zoomTrigger=i.zoomSettings.zoomTrigger),d(this.zoomSettings.zoomTrigger)?(this.zoomSettings.zoomTrigger=ze.MouseWheel|ze.Pinch|ze.Toolbar|ze.Commands,this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}})):(i.zoomSettings.zoomTrigger&ze.Toolbar)===ze.Toolbar&&this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}});break;case"selectionSettings":i.selectionSettings&&(this.selectionSettings=i.selectionSettings,this.activeObj.shape&&(this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height),this.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:this.activeObj}})));break;case"toolbar":i.toolbar&&(this.toolbar=i.toolbar,this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}));break;case"toolbarTemplate":i.toolbarTemplate&&(this.notify("toolbar",{prop:"destroy-bottom-toolbar",onPropertyChange:!1}),this.notify("toolbar",{prop:"destroy-top-toolbar",onPropertyChange:!1}),this.element.appendChild(this.createElement("div",{id:this.element.id+"_toolbarArea",className:"e-toolbar-area"})),this.toolbarTemplateFn());break;case"quickAccessToolbarTemplate":i.quickAccessToolbarTemplate&&(this.notify("toolbar",{prop:"destroy-qa-toolbar",onPropertyChange:!1}),this.quickAccessToolbarTemplateFn());break;case"uploadSettings":i.uploadSettings?(this.uploadSettings=i.uploadSettings,this.uploadSettings.allowedExtensions?this.notify("draw",{prop:"setNullExtension",value:{extension:!1}}):(this.uploadSettings.allowedExtensions=".jpg, .jpeg, .png, .svg, .webp",this.notify("draw",{prop:"setNullExtension",value:{extension:!0}})),this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}})):this.notify("draw",{prop:"setNullExtension",value:{extension:!0}}),this.updateDropInfoContent(this.element.querySelector(".e-ie-drop-info"));break}}},t.prototype.destroy=function(){var i=[];this.element.removeAttribute("tabindex");var r=this.element.querySelector("#"+this.element.id+"_saveDialog");r&&r.style.display==="block"&&Q(document.getElementById(this.element.id+"_saveDialog"),"dialog").destroy(),this.cssClass&&(i=i.concat(this.cssClass.replace(/\s+/g," ").trim().split(" "))),G([this.element],i),this.element.getAttribute("class")||this.element.removeAttribute("class"),this.unwireEvent(),this.notify("toolbar",{prop:"destroySubComponents",onPropertyChange:!1}),this.notify("destroyed",null),l.prototype.destroy.call(this),this.element.innerHTML=""},t.prototype.initialize=function(){if(this.toolbarTemplate?(this.element.appendChild(this.createElement("div",{id:this.element.id+"_toolbarArea",className:"e-toolbar-area"})),this.toolbarTemplateFn()):(this.notify("toolbar",{prop:"create-toolbar",onPropertyChange:!1}),this.notify("toolbar",{prop:"create-contextual-toolbar",onPropertyChange:!1})),this.uploadSettings.allowedExtensions?this.notify("draw",{prop:"setNullExtension",value:{extension:!1}}):this.setProperties({uploadSettings:{allowedExtensions:".jpg, .jpeg, .png, .svg, .webp"}},!0),this.createCanvas(),this.element.offsetWidth>359&&this.element.querySelector(".e-ie-min-drop-content")&&this.element.querySelector(".e-ie-drop-content")&&(this.element.querySelector(".e-ie-min-drop-content").style.display="none",this.element.querySelector(".e-ie-drop-content").style.display="block"),this.createDropUploader(),this.showQuickAccessToolbar){var i=document.querySelector("#"+this.element.id+"_canvasWrapper");i.appendChild(this.createElement("div",{id:this.element.id+"_quickAccessToolbarArea",className:"e-quick-access-toolbar-area"}));var r=document.getElementById(this.element.id+"_quickAccessToolbarArea");r.style.position="absolute",r.style.display="none",this.activeObj&&(r.style.left=this.activeObj.activePoint.startX+"px",r.style.top=this.activeObj.activePoint.startY+"px"),r.style.width="100%"}this.quickAccessToolbarTemplate?this.quickAccessToolbarTemplateFn():this.notify("toolbar",{prop:"create-qa-toolbar",onPropertyChange:!1}),this.wireEvent(),this.lowerContext=this.lowerCanvas.getContext("2d"),this.upperContext=this.upperCanvas.getContext("2d"),this.inMemoryContext=this.inMemoryCanvas.getContext("2d"),this.lowerContext.filter=this.getDefaultFilter(),this.notify("filter",{prop:"setAdjustmentValue",onPropertyChange:!1,value:{adjustmentValue:this.lowerContext.filter}}),this.canvasFilter=this.lowerContext.filter,this.notify("toolbar",{prop:"setInitialAdjustmentValue",onPropertyChange:!1,value:{value:this.lowerContext.filter}}),this.cssClass&&W([this.element],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.element&&yo({target:this.element}),this.initializeZoomSettings(),this.imgSrc&&this.open(this.imgSrc)},t.prototype.createDropUploader=function(){var i=this,r=this,o=new Li({dropArea:this.element.getElementsByClassName("e-canvas-wrapper")[0],allowedExtensions:this.uploadSettings.allowedExtensions,multiple:!1,selected:function(a){if(a.event.type==="change"||a.event.type==="drop"){var n=a.filesData[0].type,s="unsupported",h=i.getExtensionArray(),p=h.indexOf(n)>-1||n==="jpeg"&&(r.uploadSettings.allowedExtensions.indexOf("jpg")>-1||r.uploadSettings.allowedExtensions.indexOf("jpeg")>-1),u=a.filesData[0].size,c=r.uploadSettings.minFileSize&&u<r.uploadSettings.minFileSize||r.uploadSettings.maxFileSize&&u>r.uploadSettings.maxFileSize;(a.event.type==="change"||a.event.type==="drop"&&a.event.dataTransfer.files.length===1)&&p&&!c?i.notify("draw",{prop:"fileSelect",value:{inputElement:i.element.querySelector("#"+i.element.id+"_dropfileUpload"),args:a}}):(a.event.type==="drop"&&a.event.dataTransfer.files.length>1&&(s="multi-select-image"),i.showDialogPopup(s,!p))}}});o.appendTo("#"+this.element.id+"_dropfileUpload")},t.prototype.dlgCloseBtnClick=function(){Q(document.getElementById(this.element.id+"_dialog"),"dialog").destroy()},t.prototype.showDialogPopup=function(i,r){var o="";this.element.querySelector("#"+this.element.id+"_dialog").style.display="block";var a,n={key:"DlgOK"};if(this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:n}}),i==="multi-select-image"){a={key:"ImageErrorDialogHeader"},this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:a}});var s={key:"ImageErrorDialogContent"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:s}}),o="<span>"+s.value+"</span>"}else{a={key:"AlertDialogHeader"},this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:a}});var s={key:"AlertDialogContent"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:s}});var h={key:"SupportText"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:h}});var p=this.getExtensionString(),u={key:"MinMaxSizeAlert"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:u}});var c={key:"And"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:c}});var f=void 0;this.uploadSettings.minFileSize&&this.uploadSettings.maxFileSize?f=" "+u.value+" <b> "+this.formatSizeUnits(this.uploadSettings.minFileSize)+" </b> "+c.value+" <b> "+this.formatSizeUnits(this.uploadSettings.maxFileSize)+" </b> ":this.uploadSettings.minFileSize?(u.key="MinSizeAlert",this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:u}}),f=" "+u.value+" <b> "+this.formatSizeUnits(this.uploadSettings.minFileSize)+" </b> "):this.uploadSettings.maxFileSize&&(u.key="MaxSizeAlert",this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:u}}),f=" "+u.value+" <b> "+this.formatSizeUnits(this.uploadSettings.maxFileSize)+" </b> "),r?o="<span>"+s.value+" "+h.value+"<b>"+p+"</b></span>":f&&(o="<span>"+s.value+" "+h.value+f+"</span>")}var g=new Ao({header:a.value,closeOnEscape:!0,content:o,target:document.getElementById("target"),width:S.isDevice?"285px":"400px",isModal:!0,animationSettings:{effect:"Zoom"},close:this.dlgCloseBtnClick.bind(this),buttons:[{click:this.dlgCloseBtnClick.bind(this),buttonModel:{content:n.value}}]});g.appendTo("#"+this.element.id+"_dialog")},t.prototype.formatSizeUnits=function(i){var r="";return i>=1073741824?r=(i/1073741824).toFixed(2)+" GB":i>=1048576?r=(i/1048576).toFixed(2)+" MB":i>=1024?r=(i/1024).toFixed(2)+" KB":i>1?r=i+" bytes":i===1?r=i+" byte":r="0 bytes",r},t.prototype.getExtensionArray=function(){for(var i=["jpeg","jpg","png","svg","webp"],r=this.uploadSettings.allowedExtensions.split(","),o=[],a=0,n=r;a<n.length;a++)for(var s=n[a],h=s.trim(),p=0,u=i;p<u.length;p++){var c=u[p];if(h.indexOf(c)!==-1){o.push(c);break}}return o},t.prototype.getExtensionString=function(){var i={key:"And"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:i}});for(var r=this.getExtensionArray(),o="",a=0;a<r.length;a++){switch(a===r.length-1&&r.length>1&&!((r[a]==="jpeg"||r[a]==="jpg")&&o.indexOf("JPG")>-1)&&((r.length===2||r.length===3&&r.indexOf("jpeg")!==-1&&r.indexOf("jpg")!==-1)&&(o=o.replace(/,\s*$/,"")),o+=" "+i.value),r[a]){case"jpeg":case"jpg":o.indexOf("JPG")===-1&&(o+=" JPG,");break;case"png":o+=" PNG,";break;case"svg":o+=" SVG,";break;case"webp":o+=" WebP,";break}a===r.length-1&&(o=o.slice(0,-1))}return o},t.prototype.wireEvent=function(){b.add(document,"keydown",this.keyDownEventHandler,this),b.add(document,"keypress",this.keyUpEventHandler,this),b.add(this.upperCanvas,"mousedown",this.mouseDownEventHandler,this),b.add(this.upperCanvas,"mousemove",this.mouseMoveEventHandler,this),b.add(this.upperCanvas,"mouseup",this.mouseUpEventHandler,this),b.add(document,"mouseup",this.mouseUpEventHandler,this),b.add(this.lowerCanvas,"mousedown",this.canvasMouseDownHandler,this),b.add(this.lowerCanvas,"mousemove",this.canvasMouseMoveHandler,this),b.add(this.lowerCanvas,"mouseup",this.canvasMouseUpHandler,this),b.add(this.upperCanvas,"touchstart",this.touchStartHandler,this),b.add(this.lowerCanvas,"touchstart",this.touchStartHandler,this),b.add(this.lowerCanvas,"mousewheel DOMMouseScroll",this.handleScroll,this),b.add(this.upperCanvas,"mousewheel DOMMouseScroll",this.handleScroll,this),window.addEventListener("resize",this.windowResizeHandler.bind(this)),!S.isIos&&S.info.name!=="safari"&&screen.orientation.addEventListener("change",this.screenOrientation.bind(this)),this.notify("shape",{prop:"wireEvent",onPropertyChange:!1})},t.prototype.unwireEvent=function(){b.remove(document,"keydown",this.keyDownEventHandler),b.remove(document,"keypress",this.keyUpEventHandler),b.remove(this.upperCanvas,"mousedown",this.mouseDownEventHandler),b.remove(this.upperCanvas,"mousemove",this.mouseMoveEventHandler),b.remove(this.upperCanvas,"mouseup",this.mouseUpEventHandler),b.remove(document,"mouseup",this.mouseUpEventHandler),b.remove(this.lowerCanvas,"mousedown",this.canvasMouseDownHandler),b.remove(this.lowerCanvas,"mousemove",this.canvasMouseMoveHandler),b.remove(this.lowerCanvas,"mouseup",this.canvasMouseUpHandler),b.remove(this.upperCanvas,"touchstart",this.touchStartHandler),b.remove(this.lowerCanvas,"touchstart",this.touchStartHandler),b.remove(this.lowerCanvas,"mousewheel DOMMouseScroll",this.handleScroll),b.remove(this.upperCanvas,"mousewheel DOMMouseScroll",this.handleScroll),window.removeEventListener("resize",this.windowResizeHandler.bind(this)),!S.isIos&&S.info.name!=="safari"&&screen.orientation.removeEventListener("change",this.screenOrientation.bind(this)),this.notify("shape",{prop:"unWireEvent",onPropertyChange:!1}),this.notify("selection",{prop:"unWireEvent",onPropertyChange:!1})},t.prototype.createCanvas=function(){this.element.style.boxSizing="border-box";var i={toolbarHeight:0};this.notify("toolbar",{prop:"getToolbarHeight",value:{obj:i}});var r=i.toolbarHeight;this.toolbar&&this.toolbar.length>0&&this.toolbar.indexOf("Open")===-1&&(r=0),this.element.style.width=this.width,this.element.style.height=this.height;var o=this.createElement("div",{id:this.element.id+"_canvasWrapper",className:"e-canvas-wrapper"});o.style.cssText="height: "+(this.element.offsetHeight-r-2)+"px; width: "+(this.element.offsetWidth-2)+"px; position: relative; overflow: hidden; margin: 0 auto;";var a=this.element.appendChild(o),n={key:"DragText"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:n}});var s={key:"DropText"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:s}});var h={key:"BrowseText"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:h}});var p=this.createElement("div",{id:this.element.id+"_dropArea",className:"e-ie-drop-area"});p.style.position="relative";var u=this.createElement("span",{className:"e-ie-drop-icon e-icons e-image"});u.style.position="absolute";var c=this.createElement("span",{className:"e-ie-drop-content"});c.style.cssText="position: absolute; display: none;",c.textContent=n.value+" ";var f=this.createElement("span",{className:"e-ie-min-drop-content"});f.style.position="absolute",f.textContent=s.value+" ";var g=this.createElement("a",{id:this.element.id+"_dropBrowse",className:"e-ie-drop-browse"});g.textContent=h.value;var v=this.createElement("a",{id:this.element.id+"_dropBrowse",className:"e-ie-drop-browse"});v.textContent=h.value,c.appendChild(g),f.appendChild(v),g.href="",v.href="";var m=this.createElement("span",{className:"e-ie-drop-info",attrs:{position:"absolute"}});this.updateDropInfoContent(m);var C=p.appendChild(this.createElement("input",{id:this.element.id+"_dropfileUpload",className:"e-fileUpload e-image-upload"}));C.setAttribute("type","file"),C.setAttribute("accept","image/*"),p.appendChild(u),p.appendChild(c),p.appendChild(f),p.appendChild(m),a.appendChild(p),this.lowerCanvas=a.appendChild(this.createElement("canvas",{id:this.element.id+"_lowerCanvas",attrs:{name:"canvasImage"}})),this.maskCanvas=a.appendChild(this.createElement("canvas",{id:this.element.id+"_maskCanvas",attrs:{name:"canvasImage"}})),this.upperCanvas=a.appendChild(this.createElement("canvas",{id:this.element.id+"_upperCanvas",attrs:{name:"canvasImage"}})),this.inMemoryCanvas=this.createElement("canvas",{id:this.element.id+"_inMemoryCanvas",attrs:{name:"canvasImage"}}),this.baseImgCanvas=this.createElement("canvas",{id:this.element.id+"_baseImgCanvas",attrs:{name:"canvasImage"}}),this.textArea=a.appendChild(this.createElement("textarea",{id:this.element.id+"_textArea",className:"e-textarea",attrs:{name:"textArea"}}));var M=this.element.appendChild(this.createElement("div",{id:this.element.id+"_dialog",className:"e-dialog"}));M.style.display="none";var I=this.element.appendChild(this.createElement("input",{id:this.element.id+"_fileUpload",className:"e-fileUpload"}));I.setAttribute("type","file"),I.setAttribute("accept","image/*"),I.style.display="none",this.textArea.setAttribute("spellcheck","false"),this.textArea.style.lineHeight="normal",this.lowerCanvas.style.width=this.upperCanvas.style.width=this.maskCanvas.style.width=this.inMemoryCanvas.style.width="100%",this.lowerCanvas.style.height=this.upperCanvas.style.height=this.maskCanvas.style.height=this.inMemoryCanvas.style.height="100%",this.upperCanvas.style.position=this.lowerCanvas.style.position=this.maskCanvas.style.position=this.textArea.style.position="absolute",this.textArea.style.backgroundColor="transparent",this.textArea.style.display="none",this.maskCanvas.style.display=this.textArea.style.resize="none",this.lowerContext=this.lowerCanvas.getContext("2d"),this.baseImg=this.createElement("img",{id:this.element.id+"_orgImg",attrs:{name:"Image",crossorigin:"anonymous"}}),this.upperCanvas.style.cursor=this.cursor="default",this.upperCanvas.style.display="block",this.upperContext=this.upperCanvas.getContext("2d"),g.addEventListener("click",function(N){return N.preventDefault(),C.click(),!1}),v.addEventListener("click",function(N){return N.preventDefault(),C.click(),!1})},t.prototype.touchStartHandler=function(i){this.notify("selection",{prop:"touchStartHandler",onPropertyChange:!1,value:{e:i}})},t.prototype.mouseDownEventHandler=function(i){i.target.className!=="e-ie-drop-browse"&&this.notify("selection",{prop:"mouseDownEventHandler",onPropertyChange:!1,value:{e:i}})},t.prototype.mouseMoveEventHandler=function(i){this.notify("selection",{prop:"mouseMoveEventHandler",onPropertyChange:!1,value:{e:i}})},t.prototype.mouseUpEventHandler=function(i){i.target.className!=="e-ie-drop-browse"&&this.notify("selection",{prop:"mouseUpEventHandler",onPropertyChange:!1,value:{e:i}})},t.prototype.keyDownEventHandler=function(i){this.notify("selection",{prop:"keyDownEventHandler",onPropertyChange:!1,value:{e:i}})},t.prototype.keyUpEventHandler=function(i){(this.textArea.style.display==="block"||this.textArea.style.display==="inline-block")&&i.target.id===this.element.id+"_textArea"&&this.notify("selection",{prop:"textKeyDown",value:{e:i}})},t.prototype.canvasMouseDownHandler=function(i){i.target.className!=="e-ie-drop-browse"&&this.notify("selection",{prop:"canvasMouseDownHandler",onPropertyChange:!1,value:{e:i}})},t.prototype.canvasMouseMoveHandler=function(i){this.notify("selection",{prop:"canvasMouseMoveHandler",onPropertyChange:!1,value:{e:i}})},t.prototype.canvasMouseUpHandler=function(i){i.target.className!=="e-ie-drop-browse"&&this.notify("selection",{prop:"canvasMouseUpHandler",onPropertyChange:!1,value:{e:i}})},t.prototype.handleScroll=function(i){this.notify("selection",{prop:"handleScroll",onPropertyChange:!1,value:{e:i}})},t.prototype.adjustToScreen=function(){this.update()},t.prototype.screenOrientation=function(){S.isDevice&&setTimeout(this.adjustToScreen.bind(this),100)},t.prototype.windowResizeHandler=function(){!S.isDevice&&this.element.classList.contains("e-image-editor")&&this.adjustToScreen()},t.prototype.notifyResetForAllModules=function(){for(var i=this.requiredModules(),r=0;r<i.length;r++){var o=i[r].member;this.notify(o==="toolbar-module"?"toolbar":o,{prop:"reset",onPropertyChange:!1})}},t.prototype.allowShape=function(i,r){this.isPublicMethod=!0,this.applyShapes();var o={inRange:!1};return this.notify("shape",{prop:"isPointsInRange",onPropertyChange:!1,value:{x:i,y:r,obj:o}}),o.inRange},t.prototype.manageActiveAction=function(){this.applyShapes(),this.activeObj.shape&&this.activeObj.shape.indexOf("crop")>-1&&this.discard()},t.prototype.clearSelection=function(i){this.notify("selection",{prop:"clearSelection",onPropertyChange:!1,value:{resetCrop:i}})},t.prototype.crop=function(){var i={isCrop:!1};return this.notify("crop",{prop:"crop",onPropertyChange:!1,value:{obj:i}}),i.isCrop},t.prototype.flip=function(i){this.applyShapes(),this.updateImageTransformColl(i.toLowerCase()+"flip"),this.notify("transform",{prop:"flip",value:{direction:i}}),this.notify("draw",{prop:"redrawDownScale"}),this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}});var r={action:"flip",actionEventArgs:this.editCompleteArgs};this.triggerEditCompleteEvent(r)},t.prototype.getImageData=function(i){i=d(i)?!0:i;var r;if(i){var o={canvas:null};this.applyShapes(),this.notify("export",{prop:"exportToCanvas",value:{object:o}}),r=o.canvas.getContext("2d").getImageData(0,0,o.canvas.width,o.canvas.height)}else this.isMaskImage&&this.element.getAttribute("data-value")==="mask-drawing"?(r=this.getData(!0),this.updateColl("reset")):(r=this.getData(),this.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}));return r},t.prototype.open=function(i,r,o){if(r=d(r)?!0:r,r){if(d(i))return;var a=document.getElementById(this.element.id+"_dropArea");a&&(a.style.display="none"),this.notify("draw",{prop:"open",value:{data:i}})}else this.updateImage(i,o?o.backgroundColor:null)},t.prototype.reset=function(){this.updateColl("reset");var i={isErrorImage:!1};if(this.notify("draw",{prop:"getErrorImage",value:{obj:i}}),!this.disabled&&!i.isErrorImage){this.clearContext(this.inMemoryContext),this.clearContext(this.lowerContext),this.clearContext(this.upperContext),this.notify("shape",{prop:"setRedactType",onPropertyChange:!1,value:{redactType:"blur"}}),this.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:!1,isCropping:!1,isZooming:null,cType:null}}),S.isDevice&&document.getElementById(this.element.id+"_bottomToolbar")&&(Q(document.getElementById(this.element.id+"_bottomToolbar"),"toolbar").destroy(),this.notify("toolbar",{prop:"create-bottom-toolbar",onPropertyChange:!1}));var r=this.isImageLoaded;this.currObjType.isUndoAction=this.isUndoRedo=this.togglePan=this.togglePen=this.isImageLoaded=this.isFinetuning=!1,this.isCircleCrop=this.isCropTab=!1,this.objColl=[],this.transform.degree=0,this.upperCanvas.style.display="block",this.transform.currFlipState="",this.allowDownScale=!0,this.upperCanvas.style.cursor=this.cursor=this.lowerCanvas.style.cursor="default",this.lowerContext.lineWidth=this.upperContext.lineWidth=void 0,this.frameDestPoints=null,this.textArea.value=this.textArea.textContent="",this.textArea.style.display="none",this.lowerContext.filter=this.canvasFilter=this.getDefaultFilter(),this.img.destLeft=this.img.destTop=this.img.srcLeft=this.img.srcTop=0,this.img.destWidth=this.img.destHeight=this.img.srcWidth=this.img.srcHeight=null,this.currSelectionPoint=null,this.panPoint.currentPannedPoint={x:0,y:0},this.rotateFlipColl=[],this.points=[],this.pointColl={},this.freehandCounter=0,this.notify("draw",{prop:"resetPanPoints"}),this.lowerCanvas.style.left=this.upperCanvas.style.left="",this.fontSizeColl=[],this.lowerCanvas.style.top=this.upperCanvas.style.top="",this.lowerCanvas.style.maxWidth=this.upperCanvas.style.maxWidth="",this.lowerCanvas.style.maxHeight=this.upperCanvas.style.maxHeight="",this.transform.defaultZoomFactor=this.transform.zoomFactor=0,this.transform.cropZoomFactor=null,this.frameObj={type:"none",color:"#fff",size:20,inset:20,offset:20,radius:0,amount:1,border:"solid",gradientColor:""},this.tempFrameObj={type:"none",color:"#fff",size:20,inset:20,offset:20,radius:0,amount:1,border:"solid",gradientColor:""},this.currObjType={shape:"",isDragging:!1,isActiveObj:!1,isText:!1,isInitialText:!1,isLine:!1,isInitialLine:!1,isCustomCrop:!1,isZoomed:!1,isUndoZoom:!1,isUndoAction:!1,isFiltered:!1,isSave:!1,isResize:!1,isRedact:!1},this.cropObj={cropZoom:0,defaultZoom:0,totalPannedPoint:{x:0,y:0},totalPannedClientPoint:{x:0,y:0},totalPannedInternalPoint:{x:0,y:0},tempFlipPanPoint:{x:0,y:0},activeObj:{},rotateFlipColl:[],degree:0,currFlipState:"",straighten:0,zoomFactor:0,previousZoomValue:0,destPoints:{startX:0,startY:0,width:0,height:0},frame:"none",srcPoints:{startX:0,startY:0,width:0,height:0},filter:"",isBrightAdjust:!1,aspectWidth:null,aspectHeight:null,straightenZoom:0,adjustmentLevel:{brightness:0,contrast:0,hue:0,opacity:100,saturation:0,blur:0,exposure:0,transparency:100,sharpen:!1,bw:!1},currentFilter:""},this.afterCropActions=[],this.currentFilter="",this.tempFrameZoomLevel=null,this.cxtTbarHeight=null,this.straightenPoint=null,this.transform.straighten=0,this.cancelCropSelection=null,this.aspectWidth=this.aspectHeight=null,this.isResize=this.isMaskImage=!1,this.drawingShape=null,this.isShapeDrawing=this.noPushUndo=this.isUndoRedoStack=this.isKBDNavigation=!1,this.shapeColl=[],this.tempObjColl=[],this.tempPointColl=[],this.tempShapeColl=[],this.isImageUpdated=!1,this.tempToolbarHeight=0,this.tempToolbar=[],this.tempRedactBlur=50,this.tempRedactPixel=40;var o={initialZoomValue:!1};this.editCompleteArgs=null,this.isFinetuneBtnClick=!1,this.notify("draw",{prop:"getInitialZoomValue",onPropertyChange:!1,value:{obj:o}}),o.initialZoomValue&&this.setProperties({zoomSettings:{zoomFactor:o.initialZoomValue}},!0);var a=document.getElementById(this.element.id+"_quickAccessToolbarArea");a&&(a.style.display="none"),this.notifyResetForAllModules(),this.notify("filter",{prop:"update-finetunes"}),this.toolbarTemplate?this.toolbarHeight=this.element.querySelector("#"+this.element.id+"_toolbarArea").clientHeight:this.element.querySelector("#"+this.element.id+"_toolbar")&&(this.toolbarHeight=this.element.querySelector("#"+this.element.id+"_toolbar").clientHeight),this.notify("toolbar",{prop:"setToolbarHeight",value:{height:this.toolbarHeight}}),this.isImageLoaded=r,this.straightenBaseImageCanvas(),this.isImageLoaded=!1,this.notify("draw",{prop:"update-canvas",onPropertyChange:!1}),this.isImageLoaded=r,this.prevStraightenedDegree=0;var n=this.element.querySelector(".e-contextual-toolbar-wrapper");n&&n.classList.add("e-hide"),this.notify("toolbar",{prop:"refresh-dropdown-btn",value:{isDisabled:!1}}),this.notify("toolbar",{prop:"enable-disable-btns"});var s={bool:this.isStraightening};S.isDevice&&s.bool&&this.notify("crop",{prop:"resizeWrapper"});var h=this.element.querySelector("#"+this.element.id+"_saveDialog");h&&Q(h,"dialog").close();var p={action:"reset",actionEventArgs:null};this.triggerEditCompleteEvent(p)}},t.prototype.rotate=function(i){var r={isRotate:!1};this.applyShapes(),(i===90||i===-90)&&this.updateImageTransformColl(i===90?"rotateright":"rotateleft"),this.notify("transform",{prop:"rotate",value:{degree:i,obj:r}}),this.notify("draw",{prop:"redrawDownScale"});var o={action:"rotate",actionEventArgs:this.editCompleteArgs};return this.triggerEditCompleteEvent(o),r.isRotate},t.prototype.export=function(i,r,o){this.applyShapes(),this.notify("export",{prop:"export",onPropertyChange:!1,value:{type:i,fileName:r,imgQuality:o}})},t.prototype.select=function(i,r,o,a,n){this.applyShapes(),this.notify("toolbar",{prop:"performCropTransformClick",value:{shape:"crop-"+i}}),this.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:i,startX:r,startY:o,width:a,height:n}}),r&&o||a&&n?this.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:i,startX:r,startY:o,width:a,height:n}}):this.cropObj={cropZoom:0,defaultZoom:0,totalPannedPoint:{x:0,y:0},totalPannedClientPoint:{x:0,y:0},totalPannedInternalPoint:{x:0,y:0},tempFlipPanPoint:{x:0,y:0},activeObj:{},rotateFlipColl:[],degree:0,currFlipState:"",straighten:0,zoomFactor:0,previousZoomValue:0,destPoints:{startX:0,startY:0,width:0,height:0},frame:"none",srcPoints:{startX:0,startY:0,width:0,height:0},filter:"",isBrightAdjust:!1,aspectWidth:null,aspectHeight:null,straightenZoom:0,adjustmentLevel:{brightness:0,contrast:0,hue:0,opacity:100,saturation:0,blur:0,exposure:0,transparency:100,sharpen:!1,bw:!1},currentFilter:""}},t.prototype.freeHandDraw=function(i){this.notify("freehand-draw",{prop:"freeHandDraw",onPropertyChange:!1,value:{value:i}})},t.prototype.freehandDraw=function(i){if(!this.disabled&&this.isImageLoaded){if(!i&&this.isMaskImage){this.discard();return}this.manageActiveAction(),this.freeHandDraw(i);var r={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:r}});var o=r.shapeSettingsObj;o.type=bt.FreehandDraw;var a={cancel:!1,action:"insert",previousShapeSettings:o,currentShapeSettings:o};this.notify("freehand-draw",{prop:"triggerShapeChanging",value:{shapeChangingArgs:a}})}},t.prototype.pan=function(i,r,o){this.applyShapes(),this.notify("transform",{prop:"pan",onPropertyChange:!1,value:{value:i,x:r,y:o}})},t.prototype.zoom=function(i,r){this.isZoomBtnClick=!0,this.notify("transform",{prop:"zoom",onPropertyChange:!1,value:{zoomFactor:i,zoomPoint:r}}),this.notify("draw",{prop:"redrawDownScale"})},t.prototype.drawEllipse=function(i,r,o,a,n,s,h,p,u){var c=!1,f=this.allowShape(i,r);return!this.disabled&&this.isImageLoaded&&(f||d(i)&&d(r))&&(c=!0,this.manageActiveAction(),this.notify("shape",{prop:"drawEllipse",onPropertyChange:!1,value:{x:i,y:r,radiusX:o,radiusY:a,strokeWidth:n,strokeColor:s,fillColor:h,degree:p,isSelected:u}}),this.editCompleted()),c},t.prototype.drawLine=function(i,r,o,a,n,s,h){var p=!1,u=this.allowShape(i,r);return!this.disabled&&this.isImageLoaded&&(u||d(i)&&d(r))&&(p=!0,this.manageActiveAction(),this.notify("shape",{prop:"drawLine",onPropertyChange:!1,value:{startX:i,startY:r,endX:o,endY:a,strokeWidth:n,strokeColor:s,isSelected:h}}),this.editCompleted()),p},t.prototype.drawArrow=function(i,r,o,a,n,s,h,p,u){var c=!1,f=this.allowShape(i,r);return!this.disabled&&this.isImageLoaded&&(f||d(i)&&d(r))&&(c=!0,this.manageActiveAction(),this.notify("shape",{prop:"drawArrow",onPropertyChange:!1,value:{startX:i,startY:r,endX:o,endY:a,strokeWidth:n,strokeColor:s,arrowStart:h,arrowEnd:p,isSelected:u}}),this.editCompleted()),c},t.prototype.drawPath=function(i,r,o,a){this.isPublicMethod=!0;var n={inRange:!1},s=!1;if(i&&i.length>0)for(var h=0;h<i.length&&!n.inRange;h++)this.notify("shape",{prop:"isPointsInRange",onPropertyChange:!1,value:{x:i[h].x,y:i[h].y,obj:n}});return!this.disabled&&this.isImageLoaded&&(n.inRange||d(i))&&(s=!0,this.manageActiveAction(),this.notify("shape",{prop:"drawPath",onPropertyChange:!1,value:{pointColl:i,strokeWidth:r,strokeColor:o,isSelected:a}}),this.editCompleted()),s},t.prototype.drawRectangle=function(i,r,o,a,n,s,h,p,u,c){var f=!1,g=this.allowShape(i,r);return!this.disabled&&this.isImageLoaded&&(g||d(i)&&d(r))&&(f=!0,this.manageActiveAction(),this.notify("shape",{prop:"drawRectangle",onPropertyChange:!1,value:{x:i,y:r,width:o,height:a,strokeWidth:n,strokeColor:s,fillColor:h,degree:p,isSelected:u,radius:c}}),this.editCompleted()),f},t.prototype.drawText=function(i,r,o,a,n,s,h,p,u,c,f,g,v,m){var C=!1,M=this.allowShape(i,r);return!this.disabled&&this.isImageLoaded&&(M||d(i)&&d(r))&&(C=!0,this.manageActiveAction(),this.notify("shape",{prop:"drawText",onPropertyChange:!1,value:{x:i,y:r,text:o,fontFamily:a,fontSize:n,bold:s,italic:h,color:p,isSelected:u,degree:c,fillColor:f,outlineColor:g,outlineWidth:v,transformCollection:m}}),this.editCompleted()),C},t.prototype.drawImage=function(i,r,o,a,n,s,h,p,u){var c=!1,f=this.allowShape(r,o);if(!this.disabled&&this.isImageLoaded&&(f||d(r)&&d(o))){this.manageActiveAction();var g=this.objColl.length;this.notify("shape",{prop:"drawImage",onPropertyChange:!1,value:{x:r,y:o,width:a,height:n,src:i,degree:h,isAspectRatio:s,opacity:p,isSelected:u}}),this.editCompleted(),this.objColl.length>g&&(c=!0)}return c},t.prototype.updateShape=function(i,r){var o={isSelected:!1},a=!1,n={bool:!1};if(d(i.id))i.strokeColor&&(this.activeObj.strokeSettings.strokeColor=i.strokeColor),i.fillColor&&(this.activeObj.strokeSettings.fillColor=i.fillColor),i.strokeWidth&&(this.activeObj.strokeSettings.strokeWidth=i.strokeWidth),i.index&&(this.activeObj.order=i.index),i.type==="FreehandDraw"&&i.strokeWidth&&this.notify("freehand-draw",{prop:"setPenStrokeWidth",onPropertyChange:!1,value:{value:i.strokeWidth}});else if(i.type.toLowerCase()==="text"&&(this.textArea.style.display==="block"||this.textArea.style.display==="inline-block")&&(this.okBtn(null,!0),a=!0),this.notify("shape",{prop:"selectShape",onPropertyChange:!1,value:{id:i.id,obj:o,isShape:!0}}),this.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:n}}),o.isSelected){var s=this.activeObj.textSettings.fontSize;if(this.notify("shape",{prop:"updateShapeChangeEventArgs",onPropertyChange:!1,value:{shapeSettings:i}}),this.activeObj.shape==="text"&&s){var h=this.activeObj.textSettings.fontSize-s;h!==0&&(this.activeObj.activePoint.height+=h,this.activeObj.activePoint.startY-=h/2,this.activeObj.activePoint.endY+=h/2,this.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:this.activeObj.activePoint,obj:this.activeObj,isMouseMove:null,x:null,y:null}}))}var p=y({},this.activeObj,{},!0);this.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:null}}),this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height),p.shape&&this.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:p}}),this.activeObj.shape==="text"&&this.notify("toolbar",{prop:"editText",onPropertyChange:!1}),n.bool&&this.notify("undo-redo",{prop:"setPreventUR",value:{bool:!0}}),this.okBtn(r,!0),n.bool&&this.notify("undo-redo",{prop:"setPreventUR",value:{bool:!1}}),this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height),this.editCompleteArgs={action:"shape-update",currentShapeSettings:i},this.editCompleted("shape-customize"),a&&this.enableTextEditing(),r&&(this.noRedact=!0,this.selectShape(i.id))}return o.isSelected},t.prototype.selectShape=function(i){this.applyShapes();var r={isSelected:!1};return this.notify("shape",{prop:"selectShape",onPropertyChange:!1,value:{id:i,obj:r,isShape:!0}}),this.editCompleted("shape-select"),this.noRedact=!1,r.isSelected},t.prototype.deleteShape=function(i){var r=this.getShapeSetting(i);r.type!=="Redact"&&(this.applyShapes(),this.notify("shape",{prop:"deleteShape",onPropertyChange:!1,value:{id:i,isShape:!0}}),this.editCompleted("shape-delete"))},t.prototype.getShapeSetting=function(i){this.applyShapes();var r={shapeDetails:null};this.notify("shape",{prop:"getShapeSetting",onPropertyChange:!1,value:{id:i,obj:r}}),this.notify("draw",{prop:"redrawDownScale"});var o=r.shapeDetails?r.shapeDetails:{};return o},t.prototype.getShapeSettings=function(){this.applyShapes();var i={shapeDetailsColl:[]};return this.notify("shape",{prop:"getShapeSettings",onPropertyChange:!1,value:{obj:i}}),this.notify("draw",{prop:"redrawDownScale"}),i.shapeDetailsColl.filter(function(r){return r.type!=="redact"})},t.prototype.getRedacts=function(){this.applyShapes();var i={shapeDetailsColl:[]};return this.notify("shape",{prop:"getRedactSettings",onPropertyChange:!1,value:{obj:i}}),this.notify("draw",{prop:"redrawDownScale"}),i.shapeDetailsColl.filter(function(r){return r.type!=="redact"})},t.prototype.selectRedact=function(i){this.applyShapes();var r={isSelected:!1};return this.notify("shape",{prop:"selectShape",onPropertyChange:!1,value:{id:i,obj:r,isRedact:!0}}),this.editCompleted("redact-select"),this.noRedact=!1,r.isSelected},t.prototype.deleteRedact=function(i){this.applyShapes(),this.notify("shape",{prop:"deleteShape",onPropertyChange:!1,value:{id:i,isRedact:!0}}),this.editCompleted("redact-delete")},t.prototype.updateRedact=function(i,r){this.applyShapes();var o={isSelected:!1};if(this.notify("shape",{prop:"selectShape",onPropertyChange:!1,value:{id:i.id,obj:o,isRedact:!0}}),o.isSelected){this.notify("shape",{prop:"updateShapeChangeEventArgs",onPropertyChange:!1,value:{shapeSettings:i}}),i.blurIntensity&&(this.activeObj.redactBlur=i.blurIntensity),i.pixelSize&&(this.activeObj.redactPixelate=i.pixelSize),this.activeObj.redactType=i.type.toLowerCase()==="blur"?"blur":"pixelate";var a=y({},this.activeObj,{},!0);this.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:null}}),this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height),a.shape&&this.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:a}}),this.okBtn(r,!0),this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height),this.editCompleteArgs={action:"redact-update",currentShapeSettings:i},this.editCompleted("redact-customize"),r&&this.selectRedact(i.id)}return o.isSelected},t.prototype.update=function(){this.notify("transform",{prop:"update"})},t.prototype.finetuneImage=function(i,r){!this.disabled&&this.isImageLoaded&&(this.manageActiveAction(),this.notify("filter",{prop:"finetuneImage",value:{value:r,option:i}}),this.editCompleteArgs={finetune:i,value:r},this.editCompleted("fine-tune"))},t.prototype.applyImageFilter=function(i){!this.disabled&&this.isImageLoaded&&(this.manageActiveAction(),this.notify("filter",{prop:"applyImageFilter",value:{option:i.toString()}}),this.editCompleteArgs={filter:i},this.editCompleted("filter"),this.canvasFilter=this.lowerContext.filter,this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}))},t.prototype.undo=function(){this.manageActiveAction(),this.notify("undo-redo",{prop:"undo",onPropertyChange:!1}),this.notify("draw",{prop:"redrawDownScale"})},t.prototype.redo=function(){this.manageActiveAction(),this.notify("undo-redo",{prop:"redo",onPropertyChange:!1}),this.notify("draw",{prop:"redrawDownScale"})},t.prototype.getImageDimension=function(){return{x:this.img.destLeft,y:this.img.destTop,width:this.img.destWidth,height:this.img.destHeight}},t.prototype.resize=function(i,r,o){var a=!1;if(i.toString().length<=4&&r.toString().length<=4&&(!this.isCircleCrop||o)){this.manageActiveAction(),this.notify("toolbar",{prop:"resizeClick",value:{bool:!1}});var n={startX:this.img.destLeft,startY:this.img.destTop,width:this.img.destWidth,height:this.img.destHeight};o?(this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"resize",isApplyBtn:!1,isCropping:!1}}),this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"resize",isApplyBtn:!1,isCropping:!1}})):this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"resize",isApplyBtn:!1,isCropping:!1}});var s=this.element.querySelector("#"+this.element.id+"_resizeWidth"),h=this.element.querySelector("#"+this.element.id+"_resizeHeight");s&&h&&(Q(s,"numerictextbox").value=Math.floor(i),s.value=Math.floor(i).toString()+" px",Q(h,"numerictextbox").value=Math.floor(r),h.value=Math.floor(r).toString()+" px"),this.notify("transform",{prop:"resize",value:{width:i,height:r,isAspectRatio:o}}),n.startX!==this.img.destLeft||n.startY!==this.img.destTop||n.width!==this.img.destWidth||n.height!==this.img.destHeight?(a=!0,this.aspectWidth=i,this.aspectHeight=r,o&&(this.aspectHeight=null),this.okBtn(!1,!1,!0)):this.notify("draw",{prop:"performCancel",value:{isContextualToolbar:null}}),this.notify("draw",{prop:"redrawDownScale"})}return a},t.prototype.drawFrame=function(i,r,o,a,n,s,h,p,u){this.manageActiveAction();var c=!1,f={frameChangeEventArgs:null};r=r||"#fff",o=o||"",a=a||20,n=n||0,s=s||0,h=h||0,p=p||$a.Solid,u=u||0;var g={type:this.toPascalCase(this.frameObj.type),color:this.frameObj.color,gradientColor:this.frameObj.gradientColor,size:this.frameObj.size,inset:this.frameObj.inset,offset:this.frameObj.offset,borderRadius:this.frameObj.radius,frameLineStyle:this.toPascalCase(this.frameObj.border),lineCount:this.frameObj.amount};y(this.tempFrameObj,this.frameObj),this.tempFrameZoomLevel=this.transform.zoomFactor,this.frameDestPoints=y({},this.img,{},!0),this.notify("toolbar",{prop:"frameToolbarClick"}),this.frameObj.type=i.toLowerCase(),this.frameObj.color=r,this.frameObj.gradientColor=o,this.frameObj.size=a,this.frameObj.inset=n,this.frameObj.offset=s,this.frameObj.radius=h,this.frameObj.border=p.toLowerCase(),this.frameObj.amount=u,this.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:g,obj:f}}),f.frameChangeEventArgs&&!f.frameChangeEventArgs.cancel?(this.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),JSON.stringify(this.frameObj)!==JSON.stringify(this.tempFrameObj)?(c=!0,this.okBtn()):this.tempFrameZoomLevel=null):(this.notify("draw",{prop:"performCancel",value:{isContextualToolbar:null}}),y(this.frameObj,this.tempFrameObj),this.tempFrameZoomLevel=null),this.notify("draw",{prop:"redrawDownScale"});var v=this.element.querySelector(".e-contextual-toolbar-wrapper");return v&&v.classList.add("e-hide"),c},t.prototype.straightenImage=function(i){var r=!1;return i>=-45&&i<=45&&(this.applyShapes(),r=!0,this.notify("transform",{prop:"straightenImage",value:{degree:i}}),this.notify("draw",{prop:"redrawDownScale"})),r},t.prototype.cloneShape=function(i){var r={isSelected:!1};return i.split("_")[0]==="shape"&&(this.notify("shape",{prop:"selectShape",onPropertyChange:!1,value:{id:i,obj:r}}),r.isSelected&&(this.notify("toolbar",{prop:"duplicateShape",onPropertyChange:!1,value:{isPreventUndoRedo:!1}}),this.okBtn(null,!0),this.notify("draw",{prop:"redrawDownScale"}))),r.isSelected},t.prototype.getImageFilter=function(i){var r=this.createElement("canvas"),o=r.getContext("2d");return this.notify("filter",{prop:"updateAdj",value:{type:i.toLowerCase(),value:null,isPreview:!0,ctx:o}}),o.filter},t.prototype.enableTextEditing=function(){var i=y({},this.activeObj,{},!0);i.order||(this.noPushUndo=!0,this.okBtn(),this.noPushUndo=!1,this.noRedact=!0,this.selectShape(i.currIndex),i.order=this.activeObj.order),this.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!1}}),this.activeObj=i,this.notify("toolbar",{prop:"editText",onPropertyChange:!1})},t.prototype.canUndo=function(){var i=!1,r=this.getUndoRedoColl(),o=r.index;return o>0&&(i=!0),i},t.prototype.canRedo=function(){var i=!1,r=this.getUndoRedoColl(),o=r.undoRedoColl,a=r.index;return o&&o.length>0&&a<o.length-1&&(i=!0),a===o.length?i=!1:(a===0&&o.length>0||a>0)&&(i=!0),i},t.prototype.apply=function(){this.isMaskImage?this.discard():(this.updateColl("reset"),this.closeOverlayTbar(),this.okBtn(null,!0))},t.prototype.discard=function(){this.updateColl("reset"),this.notify("draw",{prop:"performCancel",value:{isContextualToolbar:this.closeOverlayTbar(),isFinalCancel:!0}})},t.prototype.enableShapeDrawing=function(i,r){if(r&&(this.drawingShape=i.toLowerCase(),this.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1})),i&&r){this.currObjType.shape=i.toLowerCase(),this.activeObj.shape=this.currObjType.shape,this.currObjType.isDragging=this.currObjType.isCustomCrop=!1,this.activeObj.shapeDegree=this.transform.degree,this.activeObj.shapeFlip=this.transform.currFlipState,this.activeObj.textFlip=this.transform.currFlipState,this.activeObj.flipObjColl=[];var o={order:null};this.notify("shape",{prop:"getNewOrder",onPropertyChange:!1,value:{obj:o}}),this.activeObj.order=o.order,this.notify("selection",{prop:"annotate",value:{shape:this.currObjType.shape}}),this.currObjType.shape==="text"?this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"text",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}):this.currObjType.shape==="redact"?this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"redact",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}):this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"shapes",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),this.notify("toolbar",{prop:"update-toolbar-items",onPropertyChange:!1})}else r||this.okBtn(null,!0)},t.prototype.bringToFront=function(i){this.noRedact=!0,this.selectShape(i)&&(this.updateShapeOrder(i,"bringToFront"),this.apply())},t.prototype.bringForward=function(i){this.noRedact=!0,this.selectShape(i)&&(this.updateShapeOrder(i,"bringForward"),this.apply())},t.prototype.sendToBack=function(i){this.noRedact=!0,this.selectShape(i)&&(this.updateShapeOrder(i,"sendToBack"),this.apply())},t.prototype.sendBackward=function(i){this.noRedact=!0,this.selectShape(i)&&(this.updateShapeOrder(i,"sendBackward"),this.apply())},t.prototype.clearImage=function(){this.reset(),this.isImageLoaded=!1,this.lowerContext.clearRect(0,0,this.lowerCanvas.width,this.lowerCanvas.height),this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height);var i=document.getElementById(this.element.id+"_bottomToolbar");S.isDevice&&i&&(document.getElementById(this.element.id+"_bottomToolbar").style.display="none"),this.notify("toolbar",{prop:"destroy-top-toolbar",onPropertyChange:!1}),this.notify("toolbar",{prop:"create-toolbar",onPropertyChange:!1}),this.notify("toolbar",{prop:"create-contextual-toolbar",onPropertyChange:!1});var r=document.getElementById(this.element.id+"_dropArea");r&&(r.style.display="block")},t.prototype.selectMaskImage=function(i,r){i=i||10,r=r||"#512da880",this.applyShapes(),this.isMaskImage=!0,this.updateColl("empty"),this.enableDisableToolbar(!0),this.update(),this.activeObj.strokeSettings.strokeWidth=i,this.notify("freehand-draw",{prop:"setPenStrokeWidth",onPropertyChange:!1,value:{value:i}}),this.activeObj.strokeSettings.strokeColor=r,this.notify("freehand-draw",{prop:"freeHandDraw",onPropertyChange:!1,value:{value:!0}}),this.maskCanvas.style.display="block"},t.prototype.enableDisableToolbar=function(i){var r,o=document.getElementById(this.element.id+"_toolbar");o&&(r=Q(o,"toolbar"),r&&r.disable(i)),o=document.getElementById(this.element.id+"_bottomToolbar"),o&&(r=Q(o,"toolbar"),r&&r.disable(i))},t.prototype.updateImage=function(i,r){var o=this;if(i||r||r===""){var a=y({},this.cropObj,{},!0),n={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:n}});var s=n.currObj;s.objColl=y([],this.objColl,[],!0),s.pointColl=y([],this.pointColl,[],!0),s.afterCropActions=y([],this.afterCropActions,[],!0);var h={selPointColl:null};if(this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:h}}),s.selPointColl=y([],h.selPointColl,[],!0),i){if(this.isImageUpdated=!0,typeof i!="string"){var p=this.createElement("canvas");p.width=i.width,p.height=i.height,p.getContext("2d").putImageData(i,0,0),i=p.toDataURL()}this.baseImg.src=i,setTimeout(function(){o.cropObj.straighten!==0?(o.notify("toolbar",{prop:"performCropTransformClick",value:{shape:"crop-custom"}}),o.noPushUndo=!0,o.crop(),o.noPushUndo=!1):o.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),o.isImageUpdated=!1,r||(o.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"updateImage",previousObj:s,previousObjColl:s.objColl,previousPointColl:s.pointColl,previousSelPointColl:s.selPointColl,previousCropObj:a,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),o.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}))},100)}(r||r==="")&&(this.notify("draw",{prop:"imageBackgroundColor",onPropertyChange:!1,value:{color:r}}),this.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),i||(this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"bgColor",previousObj:s,previousObjColl:s.objColl,previousPointColl:s.pointColl,previousSelPointColl:s.selPointColl,previousCropObj:a,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}))),i&&r&&(this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"updateImage",previousObj:s,previousObjColl:s.objColl,previousPointColl:s.pointColl,previousSelPointColl:s.selPointColl,previousCropObj:a,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}))}},t.prototype.editCompleted=function(i){this.notify("draw",{prop:"redrawDownScale"});var r={action:i||"shape-insert",actionEventArgs:this.editCompleteArgs};this.triggerEditCompleteEvent(r)},t.prototype.updateColl=function(i){this.isMaskImage&&(i==="empty"?(this.tempToolbarHeight=this.toolbarHeight,this.tempToolbar=this.toolbar?y([],this.toolbar,[],!0):null,this.tempObjColl=y([],this.objColl,[],!0),this.tempPointColl=y([],this.pointColl,[],!0),this.tempShapeColl=y([],this.shapeColl,[],!0),this.objColl=[],this.pointColl=[],this.shapeColl=[],this.freehandCounter=0,this.notify("freehand-draw",{prop:"setCurrentFreehandDrawIndex",value:{value:0}}),this.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}})):i==="reset"&&(this.objColl=this.tempObjColl,this.pointColl=this.tempPointColl,this.shapeColl=this.tempShapeColl,this.freehandCounter=this.pointColl.length,this.notify("freehand-draw",{prop:"setCurrentFreehandDrawIndex",value:{value:this.freehandCounter}}),this.enableDisableToolbar(!1),this.cropObj.straighten!==0&&(this.notify("toolbar",{prop:"performCropTransformClick",value:{shape:"crop-custom"}}),this.noPushUndo=!0,this.crop(),this.noPushUndo=!1),this.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),this.isMaskImage=!1,this.upperContext.globalCompositeOperation="source-over",this.maskCanvas.style.display="none",this.activeObj.strokeSettings={strokeColor:"#fff",fillColor:"",strokeWidth:null,radius:null,outlineColor:"",outlineWidth:null},this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:this.activeObj.strokeSettings,strokeColor:"#fff",fillColor:"",strokeWidth:null,outlineWidth:null}}),this.notify("freehand-draw",{prop:"setPenStrokeWidth",onPropertyChange:!1,value:{value:2}}),this.notify("freehand-draw",{prop:"setMasking",onPropertyChange:!1,value:{value:!1}})))},t.prototype.resetToolbar=function(){this.toolbarHeight!==this.tempToolbarHeight&&!(d(this.toolbar)||this.toolbar&&this.toolbar.length>0||!d(this.toolbarTemplate))&&(this.toolbarHeight=this.tempToolbarHeight,this.notify("toolbar",{prop:"setToolbarHeight",value:{height:this.toolbarHeight}}),this.toolbar=this.tempToolbar,this.toolbarTemplate||(this.notify("toolbar",{prop:"create-toolbar",onPropertyChange:!1}),this.notify("toolbar",{prop:"create-contextual-toolbar",onPropertyChange:!1})),this.update())},t.prototype.getData=function(i){i&&this.resetToolbar();var r=y([],this.objColl,null,!0),o=y([],this.pointColl,null,!0),a=y([],this.shapeColl,null,!0);if(i){this.notify("shape",{prop:"updateShapeColl",onPropertyChange:!1});for(var n=0;n<this.freehandCounter;n++)this.pointColl[n].strokeColor="#fff"}else this.objColl=[],this.pointColl=[],this.shapeColl=[],this.freehandCounter=0;var s=this.frameObj.type;this.frameObj.type="none";var h=this.aspectWidth,p=this.aspectHeight;this.aspectWidth=this.aspectHeight=null;var u=this.cropObj.straighten;this.togglePen=!1,this.notify("toolbar",{prop:"performCropTransformClick",value:{shape:"crop-custom"}});var c=y({},this.img,{},!0),f=y({},this.cropObj,{},!0),g=y({},this.activeObj,{},!0),v=y({},this.transform,{},!0),m=y({},this.panPoint,{},!0);u!==0&&this.setStraighten(0);var C=this.activeObj.activePoint;C.startX=this.img.destLeft,C.startY=this.img.destTop,C.width=this.img.destWidth,C.height=this.img.destHeight,C.endX=C.startX+C.width,C.endY=C.startY+C.height,this.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:C,obj:this.activeObj,isMouseMove:null,x:null,y:null}}),this.noPushUndo=!0,this.crop(),this.noPushUndo=!1,this.isCropTab=!1,this.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.notify("crop",{prop:"resetZoom",onPropertyChange:!1}),this.isCropTab=!0;var M=y([],this.afterCropActions,[],!0),I=y([],this.rotateFlipColl,[],!0);this.notify("crop",{prop:"revertTransform",value:{type:"initial",coll:I}});var N=this.getImageData();if(i){var O=this.createElement("canvas"),x=O.getContext("2d");if(O.width=N.width,O.height=N.height,x.fillRect(0,0,O.width,O.height),this.pointColl.length>0){var D={width:0,height:0};this.notify("crop",{prop:"calcRatio",onPropertyChange:!1,value:{obj:D,dimension:{width:O.width,height:O.height}}});var A=D;this.notify("export",{prop:"drawAnnotation",value:{context:x,ratio:A}})}this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height),N=x.getImageData(0,0,O.width,O.height)}return this.notify("crop",{prop:"revertTransform",value:{type:"reverse",coll:I}}),this.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.afterCropActions=M,i||(this.objColl=r,this.pointColl=o,this.shapeColl=a,this.freehandCounter=this.pointColl.length),this.frameObj.type=s,this.aspectWidth=h,this.aspectHeight=p,this.notify("toolbar",{prop:"performCropTransformClick",value:{shape:"crop-custom"}}),u!==0&&this.setStraighten(u),this.img=c,this.cropObj=f,this.activeObj=g,this.transform=v,this.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:.1,zoomPoint:null,isResize:null}}),this.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-.1,zoomPoint:null,isResize:null}}),this.transform.degree!==0&&(this.panPoint.currentPannedPoint={x:m.totalPannedClientPoint.x,y:m.totalPannedClientPoint.y},this.notify("transform",{prop:"drawPannedImage",value:{xDiff:m.totalPannedClientPoint.x,yDiff:m.totalPannedClientPoint.y}}),this.panPoint.currentPannedPoint={x:0,y:0},this.notify("transform",{prop:"setTempPanMove",value:{point:null}})),this.noPushUndo=!0,this.crop(),this.noPushUndo=!1,this.transform.straighten=0,this.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),N},t.prototype.applyShapes=function(){if(!this.isUndoRedoStack){var i=["rectangle","ellipse","line","arrow","path","text","image"],r={bool:!1};this.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:r}}),(r.bool||this.togglePen||this.activeObj.shape&&i.indexOf(this.activeObj.shape)!==-1||this.drawingShape)&&this.okBtn(null,!0)}},t.prototype.closeOverlayTbar=function(){var i=!1,r={bool:null};if(this.notify("toolbar",{prop:"getFrameToolbar",onPropertyChange:!1,value:{obj:r}}),!r.bool&&this.element.querySelector(".e-contextual-toolbar-wrapper")){this.element.querySelector(".e-contextual-toolbar-wrapper").classList.contains("e-hide")||(i=!0);var o={bool:this.isStraightening};(!S.isDevice||S.isDevice&&!o.bool)&&this.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide")}return i},t.prototype.toolbarTemplateFn=function(){var i,r=this.element.id+"_toolbar",o=this.element.querySelector("#"+this.element.id+"_toolbarArea");if(this.toolbarTemplate){if(this.toolbarFn=this.templateParser(this.toolbarTemplate),this.isReact)i=this.toolbarFn({type:"toolbar"},this,"Template",r)[0];else if(this.isAngular){var a=this.toolbarFn({type:"toolbar"},this,"Template",r);i=a[0].nodeType===3?a[1]:a[0]}else i=this.toolbarFn({type:"toolbar"},this,"Template",r)[0];o.appendChild(i),this.toolbarHeight=o.clientHeight,this.notify("toolbar",{prop:"setToolbarHeight",value:{height:this.toolbarHeight}}),this.renderReactTemplates()}},t.prototype.quickAccessToolbarTemplateFn=function(){var i,r=this.element.id+"_quickAccessToolbar",o=this.element.querySelector("#"+this.element.id+"_quickAccessToolbarArea");if(this.quickAccessToolbarTemplate){if(this.qatFn=this.templateParser(this.quickAccessToolbarTemplate),this.isReact)i=this.qatFn({type:"toolbar"},this,"Template",r)[0];else if(this.isAngular){var a=this.qatFn({type:"toolbar"},this,"Template",r);i=a[0].nodeType===3?a[1]:a[0]}else i=this.qatFn({type:"toolbar"},this,"Template",r)[0];o.appendChild(i),this.renderReactTemplates()}},t.prototype.templateParser=function(i){if(i)try{return typeof i!="function"&&document.querySelectorAll(i).length?ht(document.querySelector(i).innerHTML.trim()):ht(i)}catch{return ht(i)}},t.prototype.getTextFromId=function(i){var r={1:"none",2:"bar",3:"arrow",4:"arrowSolid",5:"circle",6:"circleSolid",7:"square",8:"squareSolid"};return r[""+i]},t.prototype.getFinetuneOption=function(i){var r={brightness:_t.Brightness,contrast:_t.Contrast,hue:_t.Hue,saturation:_t.Saturation,opacity:_t.Opacity,blur:_t.Blur,exposure:_t.Exposure};return r[""+i]},t.prototype.setPenStroke=function(i){this.notify("freehand-draw",{prop:"setPenStrokeWidth",onPropertyChange:!1,value:{value:parseInt(i,10)}})},t.prototype.updateFreehandDrawColorChange=function(){var i={tempFreeHandDrawEditingStyles:null};this.notify("freehand-draw",{prop:"getTempFreeHandDrawEditingStyles",value:{obj:i}}),this.notify("freehand-draw",{prop:"color-change",value:{color:i.tempFreeHandDrawEditingStyles.strokeColor}})},t.prototype.getUndoRedoColl=function(){var i={undoRedoColl:null,index:null},r={undoRedoStep:null},o={appliedUndoRedoColl:[]};return this.notify("undo-redo",{prop:"getAppliedUndoRedoColl",value:{obj:o}}),this.notify("undo-redo",{prop:"getUndoRedoStep",value:{obj:r}}),i.undoRedoColl=o.appliedUndoRedoColl,i.index=r.undoRedoStep,i},t.prototype.updateImageTransformColl=function(i){var r;i==="rotateleft"?r=-90:i==="rotateright"?r=90:i==="horizontalflip"?r="horizontal":i==="verticalflip"&&(r="vertical");for(var o=0;o<this.objColl.length;o++){var a=this.objColl[o].shape;if(a==="image"||a==="text"){d(this.objColl[o].rotateFlipColl)&&(this.objColl[o].rotateFlipColl=[]),this.objColl[o].rotateFlipColl.push(r);var n={collection:this.objColl[o].rotateFlipColl};this.notify("shape",{prop:"alignRotateFlipColl",onPropertyChange:!1,value:{collection:this.objColl[o].rotateFlipColl,isRotateFlipCollection:!1,obj:n}}),this.objColl[o].rotateFlipColl=n.collection}}},t.prototype.setInitialZoomState=function(){this.objColl.push(this.activeObj),this.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1});var i=this.isUndoRedo;this.isCropTab=!1,this.isUndoRedo=!0,this.transform.cropZoomFactor&&this.transform.cropZoomFactor>0?this.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-this.transform.cropZoomFactor,zoomPoint:null,isResize:!0}}):this.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:Math.abs(this.transform.cropZoomFactor),zoomPoint:null,isResize:!0}}),this.isUndoRedo=i,this.panPoint.totalPannedPoint={x:0,y:0},this.transform.cropZoomFactor=0,this.notify("freehand-draw",{prop:"updateFHDColl",onPropertyChange:!1}),this.activeObj=y({},this.objColl[this.objColl.length-1],{},!0),this.objColl.pop(),this.isCropTab=!0,this.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:this.activeObj}})},t.prototype.updateCropTransformItems=function(){this.prevCurrSelectionPoint=y({},this.currSelectionPoint,{},!0),this.notify("draw",{prop:"updateCropSelection",onPropertyChange:!1})},t.prototype.toPascalCase=function(i,r){var o=[];d(i)||(o=i.toLowerCase().split("-"));for(var a=0;a<o.length;a++)o[a]=o[a].charAt(0).toUpperCase()+o[a].slice(1);return r&&(r.maxText=o.join("")),o.join("")},t.prototype.getFontSizes=function(){var i=[];this.fontSizeColl=[];var r;this.transform.degree===0||this.transform.degree%180===0?r=this.img.destWidth/25:r=this.img.destHeight/25;for(var o=1;o<=10;o++)this.fontSizeColl.push({text:(o*Math.round(r/2)).toString()}),i.push({text:o.toString()});return i},t.prototype.updateDropInfoContent=function(i){if(i){var r={key:"SupportText"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:r}});var o=this.getExtensionString(),a={key:"MinMaxSize"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:a}});var n={key:"And"};this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:n}});var s;this.uploadSettings.minFileSize&&this.uploadSettings.maxFileSize?s=" "+a.value+" "+this.formatSizeUnits(this.uploadSettings.minFileSize)+" "+n.value+" "+this.formatSizeUnits(this.uploadSettings.maxFileSize):this.uploadSettings.minFileSize?(a.key="MinSize",this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:a}}),s=" "+a.value+" "+this.formatSizeUnits(this.uploadSettings.minFileSize)):this.uploadSettings.maxFileSize&&(a.key="MaxSize",this.notify("toolbar",{prop:"getLocaleText",onPropertyChange:!1,value:{obj:a}}),s=" "+a.value+" "+this.formatSizeUnits(this.uploadSettings.maxFileSize)),s?i.textContent=r.value+o+s:i.textContent=r.value+o}},t.prototype.okBtn=function(i,r,o){if(r){this.noPushUndo=!1;var a={activePoint:{startX:0,startY:0,endX:0,endY:0,width:0,height:0},flipObjColl:[],triangle:[],triangleRatio:[],order:null};this.notify("selection",{prop:"setTempActObj",onPropertyChange:!1,value:{obj:a}})}var n=this.element.querySelector(".e-contextual-toolbar-wrapper");n&&n.classList.remove("e-frame-wrapper");var s=!1,h;this.isResizeOkBtn=!0;var p=this.element.querySelector("#"+this.element.id+"_aspectratio"),u=this.element.querySelector("#"+this.element.id+"_nonaspectratio"),c=this.element.querySelector(".e-ie-toolbar-aspect-ratio-btn"),f=this.element.querySelector(".e-ie-toolbar-nonaspect-ratio-btn");if(this.activeObj.shape!==void 0&&(h=this.activeObj.shape.split("-")),(h===void 0&&this.currObjType.isCustomCrop||h!==void 0&&h[0]==="crop")&&(s=!0),this.allowDownScale=!0,(this.activeObj.shape&&this.activeObj.shape!=="image"||this.togglePen)&&!s){var g={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:g}});var v=g.shapeSettingsObj;this.togglePen&&(v.type=bt.FreehandDraw);var m={action:"apply",currentShapeSettings:y({},v,{},!0)};!this.currObjType.isRedact&&(r||this.isShapeDrawing)&&(this.isShapeDrawing&&(m.action="draw-end"),this.trigger("shapeChange",m)),this.editCompleteArgs=m,this.currObjType.isRedact&&(this.currObjType.isRedact=!1)}if(p||u){var C={width:null,height:null};this.notify("selection",{prop:"getNumTextValue",onPropertyChange:!1,value:{obj:C}});var M={x:C.width,y:C.height},I={prevCropObj:this.prevCropObj},N={prevObj:this.prevObj};if(M&&M.x&&M.y&&I.prevCropObj&&N.prevObj){u||f&&!f.classList.contains("e-hidden")?this.notify("transform",{prop:"resize",value:{width:M.x,height:M.y,isAspectRatio:!1}}):(p||c&&!c.classList.contains("e-hidden"))&&this.notify("transform",{prop:"resize",value:{width:M.x,height:null,isAspectRatio:!0}}),this.isResize=!1,this.aspectWidth=M.x,this.aspectHeight=M.y,this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:!1,isCropping:!1,isZooming:null,cType:null}}),this.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-this.transform.zoomFactor,zoomPoint:null,isResize:!0}}),this.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:N.prevObj.defaultZoom,zoomPoint:null,isResize:!0}}),N.prevObj.zoomFactor&&this.setProperties({zoomSettings:{zoomFactor:N.prevObj.zoomFactor}},!0),this.notify("transform",{prop:"setPreviousZoomValue",onPropertyChange:!1,value:{previousZoomValue:this.zoomSettings.zoomFactor}}),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"resize",previousObj:N.prevObj,previousObjColl:N.prevObj.objColl,previousPointColl:N.prevObj.pointColl,previousSelPointColl:N.prevObj.selPointColl,previousCropObj:I.prevCropObj,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}});var O=this.cancelCropSelection;O&&(d(u)||!u)&&(O.previousObj.aspectWidth=O.currentObj.aspectWidth=this.aspectWidth,O.previousObj.aspectHeight=O.currentObj.aspectHeight=this.aspectHeight,O.previousCropObj=y({},this.cropObj,{},!0),O.currentCropObj=y({},this.cropObj,{},!0),this.notify("draw",{prop:"updateCropSelObj"})),this.cancelCropSelection=null}else M&&(M.x===0||M.y===0)?this.notify("draw",{prop:"performCancel",value:{isContextualToolbar:null}}):this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:!1,isCropping:!1,isZooming:null,cType:null}});this.isAspectRatio=!1}else if(o){var x=!1;this.aspectWidth&&this.aspectHeight?this.notify("transform",{prop:"resize",value:{width:this.aspectWidth,height:this.aspectHeight,isAspectRatio:!1}}):this.aspectWidth&&(this.notify("transform",{prop:"resize",value:{width:this.aspectWidth,height:null,isAspectRatio:!0}}),this.aspectHeight=this.aspectWidth/(this.img.destWidth/this.img.destHeight),x=!0),this.isResize=!1,this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:!1,isCropping:!1,isZooming:null,cType:null}}),this.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-this.transform.zoomFactor,zoomPoint:null,isResize:!0}}),this.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:this.prevObj.defaultZoom,zoomPoint:null,isResize:!0}}),this.prevObj.zoomFactor&&this.setProperties({zoomSettings:{zoomFactor:this.prevObj.zoomFactor}},!0),this.notify("transform",{prop:"setPreviousZoomValue",onPropertyChange:!1,value:{previousZoomValue:this.zoomSettings.zoomFactor}}),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"resize",previousObj:this.prevObj,previousObjColl:this.prevObj.objColl,previousPointColl:this.prevObj.pointColl,previousSelPointColl:this.prevObj.selPointColl,previousCropObj:this.prevCropObj,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}});var D=this.cancelCropSelection;D&&x&&(D.previousObj.aspectWidth=D.currentObj.aspectWidth=this.aspectWidth,D.previousObj.aspectHeight=D.currentObj.aspectHeight=this.aspectHeight,D.previousCropObj=y({},this.cropObj,{},!0),D.currentCropObj=y({},this.cropObj,{},!0),this.notify("draw",{prop:"updateCropSelObj"})),this.cancelCropSelection=null,this.isAspectRatio=!1}var A=this.element.querySelector(".e-contextual-toolbar-wrapper .e-toolbar-item.e-selected"),P={bool:!1};this.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:P}});var V={bool:null};this.notify("toolbar",{prop:"getFrameToolbar",onPropertyChange:!1,value:{obj:V}});var q=document.querySelector("#"+this.element.id+"_sliderWrapper");if(A&&(this.currentFilter=A.children[0].children[0].id.replace("Canvas","")),s){if(this.transform.straighten!==0&&(this.panPoint.totalPannedPoint.x!==0||this.panPoint.totalPannedPoint.y!==0||this.panPoint.totalPannedClientPoint.x!==0||this.panPoint.totalPannedClientPoint.y!==0)){var re=this.prevStraightenedDegree;this.prevStraightenedDegree=this.transform.straighten,this.setStraighten(this.transform.straighten-3),this.setStraighten(this.transform.straighten+3),this.prevStraightenedDegree=re}this.isCroppedEvent=this.crop()}else if(this.togglePen){if(this.freeHandDraw(!1),!this.isMaskImage){var ae={penStrokeWidth:null};this.notify("freehand-draw",{prop:"getPenStrokeWidth",onPropertyChange:!1,value:{obj:ae}}),this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),this.notify("freehand-draw",{prop:"setPenStrokeWidth",onPropertyChange:!1,value:{value:ae.penStrokeWidth}})}this.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),this.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}})}else if(this.textArea.style.display==="block"||this.textArea.style.display==="inline-block")this.notify("shape",{prop:"redrawActObj",onPropertyChange:!1,value:{x:null,y:null,isMouseDown:null}}),this.lowerContext.clearRect(0,0,this.lowerCanvas.width,this.lowerCanvas.height),this.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),d(i)&&this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),this.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),this.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}});else if((q||this.currObjType.isFiltered)&&!this.drawingShape&&this.activeObj.shape!=="redact"){this.initialAdjustmentValue=this.canvasFilter=this.lowerContext.filter,this.currObjType.isFiltered=!1;var E={value:null};this.notify("draw",{prop:"getTempAdjustmentValue",value:{obj:E}}),(!q||q.parentElement.previousElementSibling.textContent!=="Opacity")&&this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),(this.activeObj.activePoint.width!==0&&this.activeObj.activePoint.height!==0||this.activeObj.shape==="path"&&this.activeObj.pointColl.length>0)&&this.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:null}})}else if(P.bool)this.notify("freehand-draw",{prop:"applyFhd",onPropertyChange:!1}),this.notify("selection",{prop:"setFreehandDrawCustomized",value:{isFreehandDrawCustomized:!1}}),this.notify("toolbar",{prop:"destroy-qa-toolbar"}),this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),this.notify("freehand-draw",{prop:"resetFreehandDrawSelectedId",onPropertyChange:!1});else if(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0||this.activeObj.shape==="path"&&this.activeObj.pointColl.length>0)this.activeObj.shape==="image"&&this.notify("draw",{prop:"setImageApply",onPropertyChange:!1,value:{bool:!0}}),this.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:null}});else{if(JSON.stringify(this.frameObj)!==JSON.stringify(this.tempFrameObj)){var L={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:L}}),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"frame",previousObj:L.currObj,previousObjColl:L.currObj.objColl,previousPointColl:L.currObj.pointColl,previousSelPointColl:L.currObj.selPointColl,previousCropObj:y({},this.cropObj,{},!0),previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}});var k={type:this.toPascalCase(this.frameObj.type),color:this.frameObj.color,gradientColor:this.frameObj.gradientColor,size:this.frameObj.size,inset:this.frameObj.inset,offset:this.frameObj.offset,borderRadius:this.frameObj.radius,frameLineStyle:this.toPascalCase(this.frameObj.border),lineCount:this.frameObj.amount},U={type:this.toPascalCase(this.tempFrameObj.type),color:this.tempFrameObj.color,gradientColor:this.tempFrameObj.gradientColor,size:this.tempFrameObj.size,inset:this.tempFrameObj.inset,offset:this.tempFrameObj.offset,borderRadius:this.tempFrameObj.radius,frameLineStyle:this.toPascalCase(this.tempFrameObj.border),lineCount:this.tempFrameObj.amount},B={cancel:!1,previousFrameSetting:U,currentFrameSetting:k};this.editCompleteArgs=B,this.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),this.tempFrameObj=y({},this.frameObj,{},!0)}this.notify("draw",{prop:"resetFrameZoom",onPropertyChange:!1,value:{isOk:!0}})}P.isCropToolbar||(this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:!1,isCropping:null,isZooming:null,cType:null}}),this.currObjType.isRedact=!1),this.notify("draw",{prop:"setNewPath",value:{bool:!1}}),this.transform.zoomFactor=this.transform.defaultZoomFactor,this.notify("selection",{prop:"setCurrentDrawingShape",onPropertyChange:!1,value:{value:""}}),this.isResizeOkBtn=!1,this.notify("draw",{prop:"redrawDownScale"}),this.isChangesSaved=this.isFinetuneBtnClick=!1,r&&(this.drawingShape=null,this.notify("draw",{prop:"resetTempObjColl"}),this.notify("draw",{prop:"resetTempPointColl"}))},t.prototype.triggerEditCompleteEvent=function(i){i.action==="shape-insert"&&i.actionEventArgs&&i.actionEventArgs.currentShapeSettings&&i.actionEventArgs.currentShapeSettings.type.toString()==="Redact"&&(i.action="redact"),this.trigger("editComplete",i),this.editCompleteArgs=null},t.prototype.getObjFromId=function(i){var r;if(this.activeObj.currIndex&&this.activeObj.currIndex===i)r=y({},this.activeObj,{},!0);else for(var o=0;o<this.shapeColl.length;o++){var a=this.shapeColl[o].id?this.shapeColl[o].id:this.shapeColl[o].currIndex;if(a===i){r=y({},this.shapeColl[o],{},!0);break}}return r},t.prototype.setTempFilterProperties=function(){this.upperCanvas.style.display="block",this.cropSelectedState();var i={adjustmentLevel:null};this.notify("filter",{prop:"getAdjustmentLevel",onPropertyChange:!1,value:{obj:i}}),this.lowerContext.filter=this.initialAdjustmentValue,this.notify("draw",{prop:"setTempAdjustmentValue",value:{tempAdjustmentValue:this.lowerContext.filter}}),this.notify("filter",{prop:"setTempAdjustmentLevel",onPropertyChange:!1,value:{tempAdjustmentLevel:y({},i.adjustmentLevel,{},!0)}}),this.notify("draw",{prop:"setTempFilter",value:{tempFilter:this.currentFilter}});var r={undoRedoStep:null};this.notify("undo-redo",{prop:"getUndoRedoStep",value:{obj:r}}),this.notify("draw",{prop:"setTempUndoRedoStep",value:{tempUndoRedoStep:r.undoRedoStep}})},t.prototype.cropSelectedState=function(){this.activeObj.shape&&this.activeObj.shape.split("-")[0]==="crop"&&this.okBtn()},t.prototype.getCurrentCanvasData=function(){var i=y({},this.frameObj,{},!0);this.frameObj={type:"none",color:"#fff",size:20,inset:20,offset:20,radius:0,amount:1,border:"solid",gradientColor:""};var r=this.lowerContext.filter;this.lowerContext.filter=this.canvasFilter="none";var o=y([],this.objColl,null,!0),a=y([],this.pointColl,null,!0);this.objColl=[],this.pointColl=[],this.freehandCounter=0,this.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}});var n=this.element.querySelector(".e-contextual-toolbar-wrapper");n&&n.classList.add("e-hide");var s=this.getImageData();return n&&n.classList.remove("e-hide"),S.isDevice||this.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"main",isApplyBtn:!0,isCropping:!1}}),this.element.querySelector("#"+this.element.id+"_contextualToolbarArea").classList.remove("e-hide"),this.objColl=o,this.pointColl=a,this.freehandCounter=a.length,this.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"iterate",pen:"iterate",isPreventApply:null}}),this.lowerContext.filter=this.canvasFilter=r,this.frameObj=i,s},t.prototype.setCurrAdjustmentValue=function(i,r){var o={finetune:this.getFinetuneOption(i),value:r,cancel:!1};this.trigger("finetuneValueChanging",o),this.editCompleteArgs=o,!o.cancel&&this.notify("filter",{prop:"setCurrAdjValue",value:{type:i.toLowerCase(),value:r}})},t.prototype.getSquarePointForPath=function(i){var r={startX:0,startY:0,endX:0,endY:0,width:0,height:0};if(i.pointColl.length>0){r={startX:i.pointColl[0].x,startY:i.pointColl[0].y,endX:i.pointColl[0].x,endY:i.pointColl[0].y};for(var o=1;o<i.pointColl.length;o++)i.pointColl[o].x<r.startX&&(r.startX=i.pointColl[o].x),i.pointColl[o].y<r.startY&&(r.startY=i.pointColl[o].y),i.pointColl[o].x>r.endX&&(r.endX=i.pointColl[o].x),i.pointColl[o].y>r.endY&&(r.endY=i.pointColl[o].y);r.width=r.endX-r.startX,r.height=r.endY-r.startY}return r},t.prototype.getSelectionType=function(i){i=i==="crop-custom"?"CropCustom":i;var r={CropCustom:"Custom",CropSquare:"Square",CropCircle:"Circle","Crop3:2":"3:2","Crop4:3":"4:3","Crop5:4":"5:4","Crop7:5":"7:5","Crop16:9":"16:9","Crop2:3":"2:3","Crop3:4":"3:4","Crop4:5":"4:5","Crop5:7":"5:7","Crop9:16":"9:16"};return r[""+i]?r[""+i]:i.split("Crop")[1]},t.prototype.clearContext=function(i){i.clearRect(0,0,i.canvas.width,i.canvas.height),i.clearRect(0,0,i.canvas.height,i.canvas.width)},t.prototype.updateArrow=function(i,r){var o=!1,a=this.objColl.length;this.notify("shape",{prop:"pushActItemIntoObj"}),a!==this.objColl.length&&(o=!0);var n=y({},this.cropObj,{},!0),s={currObj:{}},h={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:h}});var p=h.shapeSettingsObj;this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:s}});var u=s.currObj;if(u.objColl=y([],this.objColl,[],!0),u.pointColl=y([],this.pointColl,[],!0),u.afterCropActions=y([],this.afterCropActions,[],!0),o&&this.objColl.pop(),i==="startArrow"?this.activeObj.start=this.getTextFromId(r):i==="endArrow"&&(this.activeObj.end=this.getTextFromId(r)),this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:null,strokeWidth:this.activeObj.strokeSettings.strokeWidth}}),this.objColl.push(this.activeObj),(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:u,previousObjColl:u.objColl,previousPointColl:u.pointColl,previousCropObj:n,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}}),S.isDevice){if(document.getElementById(this.element.id+"_bottomToolbar")){var c=Q(this.element.id+"_bottomToolbar","toolbar");c.refreshOverflow()}}else if(document.getElementById(this.element.id+"_toolbar")){var f=Q(this.element.id+"_toolbar","toolbar");f.refreshOverflow()}var g={action:i,currentShapeSettings:y({},p,{},!0)};this.trigger("shapeChange",g),this.editCompleteArgs=g},t.prototype.updateFontFamily=function(i){this.notify("selection",{prop:"setInitialTextEdit",value:{bool:!1}});var r=!1,o=this.objColl.length;this.notify("shape",{prop:"pushActItemIntoObj"}),o!==this.objColl.length&&(r=!0);var a=y([],this.objColl,[],!0),n=y({},this.cropObj,{},!0),s={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:s}});var h=s.shapeSettingsObj,p={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:p}});var u=p.currObj;u.objColl=y([],this.objColl,[],!0),u.pointColl=y([],this.pointColl,[],!0),u.afterCropActions=y([],this.afterCropActions,[],!0);var c={selPointColl:null};if(this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:c}}),u.selPointColl=y([],c.selPointColl,[],!0),r&&this.objColl.pop(),this.textArea.style.display==="block"||this.textArea.style.display==="inline-block"){this.notify("shape",{prop:"updateFontRatio",onPropertyChange:!1,value:{obj:this.activeObj,isTextArea:!0}});var f=this.activeObj.textSettings.fontFamily;this.activeObj.textSettings.fontFamily=this.toPascalCase(i),(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&this.notify("shape",{prop:"redraw-text"}),this.objColl.push(this.activeObj),(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"textAreaCustomization",previousObj:u,previousObjColl:u.objColl,previousPointColl:u.pointColl,previousSelPointColl:u.selPointColl,previousCropObj:n,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.objColl.pop(),this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height);var g=this.activeObj.activePoint.width+this.activeObj.textSettings.fontSize*.25;this.textArea.style.width=g+"px",this.textArea.style.fontFamily=this.toPascalCase(i),this.activeObj.textSettings.fontFamily=f,this.notify("shape",{prop:"updateFontStyles",onPropertyChange:!1,value:{isTextBox:null}})}else{this.notify("shape",{prop:"updateFontRatio",onPropertyChange:!1,value:{obj:this.activeObj,isTextArea:null}});var v=this.activeObj.textSettings.fontFamily=this.toPascalCase(i);this.notify("shape",{prop:"setTextSettings",onPropertyChange:!1,value:{textSettings:null,fontFamily:v,fontSize:null}}),(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&this.notify("shape",{prop:"redraw-text"}),this.objColl.push(this.activeObj),(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:u,previousObjColl:a,previousPointColl:y([],this.pointColl,[],!0),previousSelPointColl:u.selPointColl,previousCropObj:n,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}})}var m={action:"font-family",currentShapeSettings:y({},h,{},!0)};m.currentShapeSettings.fontFamily=this.textArea.style.fontFamily,this.trigger("shapeChange",m),this.editCompleteArgs=m},t.prototype.updateFontSize=function(i){var r=i;this.notify("selection",{prop:"setInitialTextEdit",value:{bool:!1}});var o=!1,a=this.objColl.length;this.notify("shape",{prop:"pushActItemIntoObj"}),a!==this.objColl.length&&(o=!0);var n=y({},this.cropObj,{},!0),s={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:s}});var h=s.shapeSettingsObj,p={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:p}});var u=p.currObj;u.objColl=y([],this.objColl,[],!0),u.pointColl=y([],this.pointColl,[],!0),u.afterCropActions=y([],this.afterCropActions,[],!0);var c={selPointColl:null};if(this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:c}}),u.selPointColl=y([],c.selPointColl,[],!0),o&&this.objColl.pop(),this.textArea.style.display==="block"||this.textArea.style.display==="inline-block"){this.notify("shape",{prop:"updateFontRatio",onPropertyChange:!1,value:{obj:this.activeObj,isTextArea:!0}});var f=this.activeObj.textSettings.fontSize;this.activeObj.textSettings.fontSize=parseInt(this.fontSizeColl[parseInt(r,10)-1].text,10),this.objColl.push(this.activeObj),(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"textAreaCustomization",previousObj:u,previousObjColl:u.objColl,previousPointColl:u.pointColl,previousSelPointColl:u.selPointColl,previousCropObj:n,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.objColl.pop();var g="";this.textArea.style.fontWeight==="bold"&&(g="bold "),this.textArea.style.fontStyle==="italic"&&(g="italic "),this.textArea.style.fontWeight==="bold"&&this.textArea.style.fontStyle==="italic"&&(g="italic bold "),this.upperContext.font=g+this.activeObj.textSettings.fontSize+"px "+this.textArea.style.fontFamily;var v=this.textArea.value.split(`
`),m={maxText:""};this.notify("shape",{prop:"getMaxText",onPropertyChange:!1,value:{isTextBox:!0,text:null,obj:m}});var C=m.maxText,M=this.upperContext.measureText(C).width+this.activeObj.textSettings.fontSize*.5;this.textArea.style.width=M+"px",this.textArea.style.height=v.length*(this.activeObj.textSettings.fontSize+this.activeObj.textSettings.fontSize*.25)+"px",this.activeObj.textSettings.fontSize=f,this.upperContext.font=this.activeObj.textSettings.fontSize+"px "+this.activeObj.textSettings.fontFamily,this.textArea.style.fontSize=parseInt(this.fontSizeColl[parseInt(r,10)-1].text,10)+"px",this.textArea.style.fontFamily==="georgia"&&(this.textArea.style.width=parseFloat(this.textArea.style.width)+parseFloat(this.textArea.style.fontSize)+"px")}else{this.notify("shape",{prop:"updateFontRatio",onPropertyChange:!1,value:{obj:this.activeObj,isTextArea:null}});var I=this.activeObj.textSettings.fontSize=parseInt(this.fontSizeColl[parseInt(r,10)-1].text,10);this.notify("shape",{prop:"setTextSettings",onPropertyChange:!1,value:{textSettings:null,fontFamily:null,fontSize:I}}),this.upperContext.font=this.activeObj.textSettings.fontSize+"px "+this.activeObj.textSettings.fontFamily;var v=this.activeObj.keyHistory.split(`
`),m={maxText:""};this.notify("shape",{prop:"getMaxText",onPropertyChange:!1,value:{isTextBox:null,text:null,obj:m}});var N=m.maxText,M=this.upperContext.measureText(N).width+this.activeObj.textSettings.fontSize*.5,O=v.length*(this.activeObj.textSettings.fontSize+this.activeObj.textSettings.fontSize*.25);(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&(this.notify("selection",{prop:"setTextSelection",onPropertyChange:!1,value:{width:M,height:O}}),this.notify("draw",{prop:"updateActiveObject",onPropertyChange:!1,value:{actPoint:this.activeObj.activePoint,obj:this.activeObj,isMouseMove:null,x:null,y:null}}),this.notify("shape",{prop:"redraw-text"})),this.objColl.push(this.activeObj),(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:u,previousObjColl:u.objColl,previousPointColl:u.pointColl,previousSelPointColl:u.selPointColl,previousCropObj:n,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}})}var x={action:"font-size",currentShapeSettings:y({},h,{},!0)};x.currentShapeSettings.fontSize=this.activeObj.textSettings.fontSize,this.trigger("shapeChange",x),this.editCompleteArgs=x},t.prototype.updateFontColor=function(i,r){this.notify("selection",{prop:"setInitialTextEdit",value:{bool:!1}});var o=!1,a=this.objColl.length;this.notify("shape",{prop:"pushActItemIntoObj"}),a!==this.objColl.length&&(o=!0);var n=y({},this.cropObj,{},!0),s={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:s}});var h=s.shapeSettingsObj,p={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:p}});var u=p.currObj;u.objColl=y([],this.objColl,[],!0),u.pointColl=y([],this.pointColl,[],!0),u.afterCropActions=y([],this.afterCropActions,[],!0);var c={selPointColl:null};if(this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:c}}),u.selPointColl=y([],c.selPointColl,[],!0),o&&this.objColl.pop(),this.textArea.style.display==="none")r==="Text"?(this.activeObj.strokeSettings.strokeColor=i,this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:this.activeObj.strokeSettings.strokeColor,fillColor:null,strokeWidth:null}})):(this.activeObj.strokeSettings.fillColor=i,this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:this.activeObj.strokeSettings.fillColor,strokeWidth:null}})),this.togglePen||(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&(this.objColl.push(this.activeObj),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:u,previousObjColl:u.objColl,previousPointColl:u.pointColl,previousSelPointColl:u.selPointColl,previousCropObj:n,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}}));else if(this.textArea.style.display==="block"||this.textArea.style.display==="inline-block"){this.textArea.style[r==="Text"?"color":"backgroundColor"]=i;var f=r==="Text"?this.activeObj.strokeSettings.strokeColor:this.activeObj.strokeSettings.fillColor;this.activeObj.strokeSettings[r==="Text"?"strokeColor":"fillColor"]=i,(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&(this.objColl.push(this.activeObj),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"textAreaCustomization",previousObj:u,previousObjColl:u.objColl,previousPointColl:u.pointColl,previousSelPointColl:u.selPointColl,previousCropObj:n,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.objColl.pop()),this.activeObj.strokeSettings[r==="Text"?"strokeColor":"fillColor"]=f}else this.togglePen||(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&(this.objColl.push(this.activeObj),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:u,previousObjColl:u.objColl,previousPointColl:u.pointColl,previousSelPointColl:u.selPointColl,previousCropObj:n,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}}));var g={action:"font-color",currentShapeSettings:y({},h,{},!0)};g.currentShapeSettings.fillColor=i,this.trigger("shapeChange",g),this.editCompleteArgs=g},t.prototype.updateStrokeTextColor=function(i){this.notify("selection",{prop:"setInitialTextEdit",value:{bool:!1}});var r=!1,o=this.objColl.length;this.notify("shape",{prop:"pushActItemIntoObj"}),o!==this.objColl.length&&(r=!0);var a=y({},this.cropObj,{},!0),n={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:n}});var s=n.shapeSettingsObj,h={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:h}});var p=h.currObj;p.objColl=y([],this.objColl,[],!0),p.pointColl=y([],this.pointColl,[],!0),p.afterCropActions=y([],this.afterCropActions,[],!0);var u={selPointColl:null};if(this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:u}}),p.selPointColl=y([],u.selPointColl,[],!0),r&&this.objColl.pop(),this.textArea.style.display==="none")this.activeObj.strokeSettings.outlineColor=i,this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:null,strokeWidth:null,outlineColor:this.activeObj.strokeSettings.outlineColor}}),this.togglePen||(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&(this.objColl.push(this.activeObj),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:p,previousObjColl:p.objColl,previousPointColl:p.pointColl,previousSelPointColl:p.selPointColl,previousCropObj:a,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}}));else if(this.textArea.style.display==="block"||this.textArea.style.display==="inline-block"){this.textArea.style.textShadow="-1px -1px 0 "+i+", 1px -1px 0 "+i+", -1px 1px 0 "+i+", 1px 1px 0 "+i;var c=this.activeObj.strokeSettings.outlineColor;this.activeObj.strokeSettings.outlineColor=i,(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&(this.objColl.push(this.activeObj),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"textAreaCustomization",previousObj:p,previousObjColl:p.objColl,previousPointColl:p.pointColl,previousSelPointColl:p.selPointColl,previousCropObj:a,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.objColl.pop()),this.activeObj.strokeSettings.outlineColor=c}else this.togglePen||(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&(this.objColl.push(this.activeObj),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:p,previousObjColl:p.objColl,previousPointColl:p.pointColl,previousSelPointColl:p.selPointColl,previousCropObj:a,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}}));var f={action:"font-color",currentShapeSettings:y({},s,{},!0)};f.currentShapeSettings.fillColor=i,this.trigger("shapeChange",f),this.editCompleteArgs=f},t.prototype.updatePenStrokeWidth=function(i){var r=y([],this.pointColl,[],!0);this.updateFreehandDrawColorChange();var o=y({},this.cropObj,{},!0),a={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:a}});var n=a.shapeSettingsObj,s={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:s}});var h=s.currObj;h.objColl=y([],this.objColl,[],!0),h.pointColl=y([],this.pointColl,[],!0),h.afterCropActions=y([],this.afterCropActions,[],!0);var p={selPointColl:null};this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:p}}),h.selPointColl=y([],p.selPointColl,[],!0),this.pointColl=r,this.notify("selection",{prop:"setFreehandDrawCustomized",value:{isFreehandDrawCustomized:!0}}),this.setPenStroke(i);var u={bool:!1};if(this.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:u}}),u.bool){var c={penStrokeWidth:null};this.notify("freehand-draw",{prop:"getPenStrokeWidth",onPropertyChange:!1,value:{obj:c}}),this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height),this.lowerContext.clearRect(0,0,this.lowerCanvas.width,this.lowerCanvas.height),this.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:null,strokeWidth:c.penStrokeWidth}});var f={freehandSelectedIndex:null};this.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:f}}),this.pointColl[f.freehandSelectedIndex].strokeWidth=c.penStrokeWidth,this.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),this.notify("draw",{prop:"redrawDownScale"}),this.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:null,strokeWidth:c.penStrokeWidth}}),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"freehanddrawCustomized",previousObj:h,previousObjColl:h.objColl,previousPointColl:h.pointColl,previousSelPointColl:h.selPointColl,previousCropObj:o,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}})}n.type=bt.FreehandDraw;var g={action:"stroke-width",currentShapeSettings:y({},n,{},!0)};g.currentShapeSettings.strokeWidth=this.activeObj.strokeSettings.strokeWidth,this.trigger("shapeChange",g),this.editCompleteArgs=g},t.prototype.updatePenStrokeColor=function(i){var r=y([],this.pointColl,[],!0);this.updateFreehandDrawColorChange();var o=y({},this.cropObj,{},!0),a={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:a}});var n=a.shapeSettingsObj,s={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:s}});var h=s.currObj;h.objColl=y([],this.objColl,[],!0),h.pointColl=y([],this.pointColl,[],!0),h.afterCropActions=y([],this.afterCropActions,[],!0);var p={selPointColl:null};this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:p}}),h.selPointColl=y([],p.selPointColl,[],!0),this.pointColl=r,this.notify("selection",{prop:"setFreehandDrawCustomized",value:{isFreehandDrawCustomized:!0}}),this.activeObj.strokeSettings.strokeColor=i;var u={freehandSelectedIndex:null};this.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:u}}),u.freehandSelectedIndex!==null&&u.freehandSelectedIndex!==void 0&&(this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height),this.notify("draw",{prop:"render-image",value:{isMouseWheel:null}}),this.notify("draw",{prop:"redrawDownScale"}),this.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:null,strokeWidth:null}}));var c={bool:!1};if(this.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:c}}),c.bool){var f={freehandSelectedIndex:null};this.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:f}}),this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height),this.pointColl[f.freehandSelectedIndex].strokeColor=i,this.notify("freehand-draw",{prop:"hoverFhd",onPropertyChange:!1,value:{strokeColor:i}}),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"freehanddrawCustomized",previousObj:h,previousObjColl:h.objColl,previousPointColl:h.pointColl,previousSelPointColl:h.selPointColl,previousCropObj:o,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}})}else this.togglePen||this.notify("selection",{prop:"redrawShape",value:{obj:this.activeObj}});n.type=bt.FreehandDraw;var g={action:"stroke-color",currentShapeSettings:y({},n,{},!0)};g.currentShapeSettings.strokeColor=i,this.trigger("shapeChange",g),this.editCompleteArgs=g},t.prototype.updateStrokeWidth=function(i,r,o){if(this.activeObj.shape&&(this.activeObj.shape!=="path"||this.activeObj.shape==="path"&&this.activeObj.pointColl.length>0)){var a={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:a}});var n=a.shapeSettingsObj,s=!1,h=this.objColl.length;this.notify("shape",{prop:"pushActItemIntoObj"}),h!==this.objColl.length&&(s=!0);var p=y({},this.cropObj,{},!0),u={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:u}});var c=u.currObj;c.objColl=y([],this.objColl,[],!0),c.pointColl=y([],this.pointColl,[],!0),c.afterCropActions=y([],this.afterCropActions,[],!0);var f={selPointColl:null};this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:f}}),c.selPointColl=y([],f.selPointColl,[],!0),s&&this.objColl.pop(),this.activeObj.strokeSettings[r==="width"?o==="text"?"outlineWidth":"strokeWidth":"radius"]=parseInt(i,10),(this.activeObj.shape==="rectangle"||this.activeObj.shape==="ellipse")&&(this.activeObj.strokeSettings[r==="width"?o==="text"?"outlineWidth":"strokeWidth":"radius"]=parseInt(i,10)-1),this.activeObj.strokeSettings[r==="width"?o==="text"?"outlineWidth":"strokeWidth":"radius"]*=2,r==="width"?o==="text"?this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:null,strokeWidth:null,radius:null,outlineWidth:this.activeObj.strokeSettings.outlineWidth}}):this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:null,strokeWidth:this.activeObj.strokeSettings.strokeWidth,radius:null,outlineWidth:null}}):this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:null,strokeWidth:null,radius:this.activeObj.strokeSettings.radius}}),this.objColl.push(this.activeObj),(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:c,previousObjColl:c.objColl,previousPointColl:c.pointColl,previousSelPointColl:c.selPointColl,previousCropObj:p,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}});var g={action:"stroke-width",currentShapeSettings:y({},n,{},!0)};g.currentShapeSettings[r==="width"?o==="text"?"outlineWidth":"strokeWidth":"radius"]=this.activeObj.strokeSettings[r==="width"?o==="text"?"outlineWidth":"strokeWidth":"radius"],this.trigger("shapeChange",g),this.editCompleteArgs=g}else this.activeObj.shape&&this.activeObj.shape==="path"&&this.activeObj.pointColl.length===0&&(this.activeObj.strokeSettings.strokeWidth=parseInt(i,10),this.activeObj.strokeSettings.strokeWidth*=2,r==="width"?o==="text"?this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:null,strokeWidth:null,radius:null,outlineWidth:this.activeObj.strokeSettings.outlineWidth}}):this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:null,strokeWidth:this.activeObj.strokeSettings.strokeWidth,radius:null,outlineWidth:null}}):this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:null,strokeWidth:null,radius:this.activeObj.strokeSettings.radius}}))},t.prototype.updateStrokeColor=function(i){var r={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:r}});var o=r.shapeSettingsObj;if(this.activeObj.shape&&(this.activeObj.shape!=="path"||this.activeObj.shape==="path"&&this.activeObj.pointColl.length>0)){var a=!1,n=this.objColl.length;this.notify("shape",{prop:"pushActItemIntoObj"}),n!==this.objColl.length&&(a=!0);var s=y({},this.cropObj,{},!0),h={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:h}});var p=h.currObj;p.objColl=y([],this.objColl,[],!0),p.pointColl=y([],this.pointColl,[],!0),p.afterCropActions=y([],this.afterCropActions,[],!0);var u={selPointColl:null};this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:u}}),p.selPointColl=y([],u.selPointColl,[],!0),a&&this.objColl.pop(),this.activeObj.strokeSettings.strokeColor=i,this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:this.activeObj.strokeSettings.strokeColor,fillColor:null,strokeWidth:null}}),this.togglePen||(this.objColl.push(this.activeObj),(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:p,previousObjColl:p.objColl,previousPointColl:p.pointColl,previousSelPointColl:p.selPointColl,previousCropObj:s,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}}))}else this.activeObj.shape&&this.activeObj.shape==="path"&&this.activeObj.pointColl.length===0&&(this.activeObj.strokeSettings.strokeColor=i,this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:this.activeObj.strokeSettings.strokeColor,fillColor:null,strokeWidth:null}}));var c={action:"stroke-color",currentShapeSettings:y({},o,{},!0)};c.currentShapeSettings.strokeColor=i,this.trigger("shapeChange",c),this.editCompleteArgs=c},t.prototype.updateFillColor=function(i){var r={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:r}});var o=r.shapeSettingsObj,a=!1,n=this.objColl.length;this.notify("shape",{prop:"pushActItemIntoObj"}),n!==this.objColl.length&&(a=!0);var s=y({},this.cropObj,{},!0),h={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:h}});var p=h.currObj;p.objColl=y([],this.objColl,[],!0),p.pointColl=y([],this.pointColl,[],!0),p.afterCropActions=y([],this.afterCropActions,[],!0);var u={selPointColl:null};this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:u}}),p.selPointColl=y([],u.selPointColl,[],!0),a&&this.objColl.pop(),this.activeObj.strokeSettings.fillColor=i,this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:this.activeObj.strokeSettings.fillColor,strokeWidth:null}}),this.objColl.push(this.activeObj),(this.activeObj.activePoint.width!==0||this.activeObj.activePoint.height!==0)&&this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:p,previousObjColl:p.objColl,previousPointColl:p.pointColl,previousSelPointColl:p.selPointColl,previousCropObj:s,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}});var c={action:"fill-color",currentShapeSettings:y({},o,{},!0)};this.trigger("shapeChange",c),this.editCompleteArgs=c},t.prototype.horizontalFlip=function(i,r){var o,a;if(d(r)){d(this.activeObj.imageRatio)&&this.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),this.notify("shape",{prop:"pushActItemIntoObj"}),o=y({},this.cropObj,{},!0);var n={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:n}}),a=n.currObj,a.objColl=y([],this.objColl,[],!0),a.pointColl=y([],this.pointColl,[],!0),a.afterCropActions=y([],this.afterCropActions,[],!0);var s={selPointColl:null};this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:s}}),a.selPointColl=y([],s.selPointColl,[],!0),this.objColl.pop()}this.notify("toolbar",{prop:"refreshSlider"}),i.clearRect(0,0,this.activeObj.imageCanvas.width,this.activeObj.imageCanvas.height);var h=this.duplicateImage();this.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:this.activeObj.imageCanvas.getContext("2d"),isImgAnnotation:!0,isHFlip:!0,isVFlip:null}}),this.activeObj.activePoint=h,this.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),d(r)&&(this.objColl.push(this.activeObj),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"imageHFlip",previousObj:a,previousObjColl:a.objColl,previousPointColl:a.pointColl,previousSelPointColl:a.selPointColl,previousCropObj:o,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}}))},t.prototype.verticalFlip=function(i,r){var o,a;if(d(r)){d(this.activeObj.imageRatio)&&this.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),this.notify("shape",{prop:"pushActItemIntoObj"}),o=y({},this.cropObj,{},!0);var n={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:n}}),a=n.currObj,a.objColl=y([],this.objColl,[],!0),a.pointColl=y([],this.pointColl,[],!0),a.afterCropActions=y([],this.afterCropActions,[],!0);var s={selPointColl:null};this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:s}}),a.selPointColl=y([],s.selPointColl,[],!0),this.objColl.pop()}this.notify("toolbar",{prop:"refreshSlider"}),i.clearRect(0,0,this.activeObj.imageCanvas.width,this.activeObj.imageCanvas.height);var h=this.duplicateImage();this.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:this.activeObj.imageCanvas.getContext("2d"),isImgAnnotation:!0,isHFlip:null,isVFlip:!0}}),this.activeObj.activePoint=h,this.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),d(r)&&(this.objColl.push(this.activeObj),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"imageVFlip",previousObj:a,previousObjColl:a.objColl,previousPointColl:a.pointColl,previousSelPointColl:a.selPointColl,previousCropObj:o,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}}))},t.prototype.rotateImage=function(i){var r,o;d(this.activeObj.imageRatio)&&this.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),this.notify("shape",{prop:"pushActItemIntoObj"}),r=y({},this.cropObj,{},!0);var a={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:a}}),o=a.currObj,o.objColl=y([],this.objColl,[],!0),o.pointColl=y([],this.pointColl,[],!0),o.afterCropActions=y([],this.afterCropActions,[],!0);var n={selPointColl:null};this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:n}}),o.selPointColl=y([],n.selPointColl,[],!0),this.objColl.pop(),this.notify("toolbar",{prop:"refreshSlider"}),i==="rotleft"?this.activeObj.rotatedAngle-=90*(Math.PI/180):this.activeObj.rotatedAngle+=90*(Math.PI/180),this.notify("selection",{prop:"updPtCollForShpRot",onPropertyChange:!1,value:{obj:this.activeObj}}),this.upperContext.clearRect(0,0,this.upperCanvas.width,this.upperCanvas.height),this.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),this.objColl.push(this.activeObj),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"imageRotate",previousObj:o,previousObjColl:o.objColl,previousPointColl:o.pointColl,previousSelPointColl:o.selPointColl,previousCropObj:r,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}}),this.notify("toolbar",{prop:"destroy-qa-toolbar"}),this.notify("toolbar",{prop:"renderQAT",onPropertyChange:!1,value:{isPenEdit:null}})},t.prototype.pascalToSplitWords=function(i){i=i.charAt(0).toUpperCase()+i.slice(1);var r=i.match(/[A-Z][a-z]+/g);return d(r)?i:r.map(function(o){return o.charAt(0).toUpperCase()+o.slice(1)}).join(" ")},t.prototype.getCurrAdjustmentValue=function(i){var r=100,o={freehandSelectedIndex:null};if(this.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:o}}),i==="transparency"&&this.togglePen){var a={penOpacity:1};this.notify("freehand-draw",{prop:"getPenOpacity",onPropertyChange:!1,value:{obj:a}}),r=a.penOpacity*100}else if(i==="transparency"&&o.freehandSelectedIndex!==null&&o.freehandSelectedIndex!==void 0)r=this.pointColl[o.freehandSelectedIndex].opacity*100;else{var a={adjustmentLevel:null};this.notify("filter",{prop:"getAdjustmentLevel",onPropertyChange:!1,value:{obj:a}});var n={brightness:a.adjustmentLevel.brightness,contrast:a.adjustmentLevel.contrast,hue:a.adjustmentLevel.hue,saturation:a.adjustmentLevel.saturation,opacity:a.adjustmentLevel.opacity,blur:a.adjustmentLevel.blur,exposure:a.adjustmentLevel.exposure,transparency:a.adjustmentLevel.transparency,straighten:this.transform.straighten};r=n[""+i]}return r},t.prototype.transformSelect=function(i){this.transform.straighten===0&&(i==="rotateleft"||i==="rotateright")&&this.activeObj.shape&&(["crop-2:3","crop-3:2","crop-3:4","crop-4:3","crop-4:5","crop-5:4","crop-5:7","crop-7:5","crop-9:16","crop-16:9"].indexOf(this.activeObj.shape)!==-1||this.activeObj.shape.indexOf("crop-")!==-1&&this.activeObj.shape!=="crop-custom"&&this.activeObj.shape!=="crop-square"&&this.activeObj.shape!=="crop-circle")&&(this.activeObj.shape="crop-"+this.activeObj.shape.split("-")[1].split(":")[1]+":"+this.activeObj.shape.split("-")[1].split(":")[0],this.notify("toolbar",{prop:"performCropTransformClick",value:{shape:this.activeObj.shape,isTransform:!0}})),this.isCropToolbar=!0,this.allowDownScale=!1;var r=this.transform.straighten,o=y({},this.activeObj,{},!0),a=this.transform.zoomFactor;this.prevEventSelectionPoint=y({},this.activeObj,{},!0);var n={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:n}}),this.prevEventObjPoint=n.currObj,this.prevEventObjPoint.objColl=y([],this.objColl,[],!0),this.prevEventObjPoint.pointColl=y([],this.pointColl,[],!0),this.prevEventObjPoint.afterCropActions=y([],this.afterCropActions,[],!0);var s={selPointColl:null};if(this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:s}}),this.prevEventObjPoint.selPointColl=y([],s.selPointColl,[],!0),this.transform.straighten!==0){this.transform.straighten=0,this.straightenBaseImageCanvas();for(var h=0,p=this.objColl.length;h<p;h++){var u=this.objColl[h].shape;u!=="line"&&u!=="arrow"&&u!=="path"&&(this.objColl[h].rotatedAngle-=r*(Math.PI/180),this.notify("selection",{prop:"updPtCollForShpRot",onPropertyChange:!1,value:{obj:this.objColl[h]}}))}this.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),this.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}})}this.setInitialZoomState();var c=y({},this.activeObj,{},!0);if(this.notify("crop",{prop:"setTransformCrop",onPropertyChange:!1,value:{bool:!0}}),this.cropSelectedState(),this.notify("crop",{prop:"setTransformCrop",onPropertyChange:!1,value:{bool:!1}}),this.notify("draw",{prop:"resetCurrentSelectionPoint"}),this.updateImageTransformColl(i),this.notify("transform",{prop:"performTransformation",value:{text:i}}),this.isCropTab=!0,this.notify("draw",{prop:"moveToSelectionRange",value:{type:i,activeObj:c}}),this.isStraightening&&(i==="horizontalflip"||i==="verticalflip")&&(this.notify("draw",{prop:"resetStraightenDestPoints"}),this.notify("draw",{prop:"setDestForStraighten"})),r!==0){this.transform.straighten=r,this.straightenBaseImageCanvas();for(var h=0,p=this.objColl.length;h<p;h++){var u=this.objColl[h].shape;u!=="line"&&u!=="arrow"&&u!=="path"&&(this.objColl[h].rotatedAngle+=r*(Math.PI/180),this.notify("selection",{prop:"updPtCollForShpRot",onPropertyChange:!1,value:{obj:this.objColl[h]}}))}this.notify("shape",{prop:"drawAnnotations",onPropertyChange:!1,value:{ctx:this.lowerContext,shape:"zoom",pen:"zoom",isPreventApply:null}}),this.notify("draw",{prop:"render-image",value:{isMouseWheel:!1}}),this.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:o}}),this.notify("draw",{prop:"setStraightenActObj",value:{activeObj:null}}),this.notify("draw",{prop:"setStraightenInitZoom",value:{zoomFactor:a}}),(this.isStraightening&&(i==="horizontalflip"||i==="verticalflip")&&d(this.transform.zoomFactor)||this.transform.zoomFactor===0)&&(this.transform.degree===0?this.transform.zoomFactor+=.025:this.transform.zoomFactor===0&&(this.transform.zoomFactor=null)),this.notify("draw",{prop:"zoomToSel",value:{activeObj:o,isToolbar:!1}})}this.isCropToolbar=!1;var f=this.element.querySelector(".e-ie-straighten-value-span");f&&(f.innerHTML=this.transform.straighten.toString()+"&#176")},t.prototype.getDefaultFilter=function(){return"brightness(1) contrast(100%) hue-rotate(0deg) saturate(100%) opacity(1) blur(0px) sepia(0%) grayscale(0%) invert(0%)"},t.prototype.setStraighten=function(i){var r={cancel:!1,previousDegree:this.transform.straighten,currentDegree:i};if(this.trigger("rotating",r),this.editCompleteArgs=r,!r.cancel){this.performStraighten(r);var o={action:"straighten",actionEventArgs:this.editCompleteArgs};this.triggerEditCompleteEvent(o)}},t.prototype.duplicateImage=function(){var i=y({},this.activeObj.activePoint,{},!0),r={width:0,height:0};return this.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:this.activeObj.imageElement.width,height:this.activeObj.imageElement.height,obj:r,isImgShape:null}}),this.activeObj.activePoint.width=r.width,this.activeObj.activePoint.height=r.height,i},t.prototype.performStraighten=function(i){var r=i.currentDegree,o=this.element.querySelector(".e-ie-straighten-value-span");o&&(o.innerHTML=r.toString()+"&#176");var a=y({},this.activeObj,null,!0);this.notify("freehand-draw",{prop:"setCenterSelPoints"}),this.transform.straighten=r,this.straightenPoint={x:this.activeObj.activePoint.startX+this.activeObj.activePoint.width/2,y:this.activeObj.activePoint.startY+this.activeObj.activePoint.height/2},this.straightenBaseImageCanvas();for(var n=0,s=this.objColl.length;n<s;n++){var h=this.objColl[n].shape;h!=="line"&&h!=="arrow"&&h!=="path"&&(this.objColl[n].rotatedAngle+=(this.transform.straighten-this.prevStraightenedDegree)*(Math.PI/180),this.notify("selection",{prop:"updPtCollForShpRot",onPropertyChange:!1,value:{obj:this.objColl[n]}}))}this.transform.degree%90===0&&this.transform.degree%180!==0?(this.transform.straighten===0&&(this.transform.straighten=360),this.notify("draw",{prop:"performPointZoom",onPropertyChange:!1,value:{x:this.activeObj.activePoint.startX+this.activeObj.activePoint.width/2,y:this.activeObj.activePoint.startY+this.activeObj.activePoint.height/2,type:"zoomIn",isResize:!0}}),this.notify("draw",{prop:"performPointZoom",onPropertyChange:!1,value:{x:this.activeObj.activePoint.startX+this.activeObj.activePoint.width/2,y:this.activeObj.activePoint.startY+this.activeObj.activePoint.height/2,type:"zoomOut",isResize:!0}}),this.transform.straighten===360&&(this.transform.straighten=0)):this.notify("draw",{prop:"render-image",value:{isMouseWheel:!0,isPreventClearRect:null,isFrame:null,isStraighten:!0}}),this.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:a}}),this.notify("draw",{prop:"zoomToSel",value:{activeObj:a,isToolbar:!0}}),this.notify("transform",{prop:"disableZoomOutBtn",value:{isZoomOut:!0}}),this.prevStraightenedDegree=this.transform.straighten},t.prototype.straightenBaseImageCanvas=function(){if(this.isImageLoaded){var i=this.getStraightenFlipState(),r=i==="horizontal"||i==="vertical"?-this.transform.straighten:this.transform.straighten,o=this.baseImgCanvas.getContext("2d");if(o.canvas.width!==this.lowerContext.canvas.width&&o.canvas.height!==this.lowerContext.canvas.height){var a={width:0,height:0};this.notify("crop",{prop:"calcRatio",onPropertyChange:!1,value:{obj:a,dimension:{width:o.canvas.width,height:o.canvas.height}}})}var n=void 0;n=this.getRotatedCanvasDim(this.baseImg.width,this.baseImg.height,this.transform.straighten),this.img.srcWidth=o.canvas.width=n.width,this.img.srcHeight=o.canvas.height=n.height;var s=o.canvas.width/2,h=o.canvas.height/2;o.clearRect(0,0,o.canvas.width,o.canvas.height),o.translate(s,h),o.rotate(r*Math.PI/180),o.drawImage(this.baseImg,-this.baseImg.width/2,-this.baseImg.height/2,this.baseImg.width,this.baseImg.height),o.setTransform(1,0,0,1,0,0);var p={width:0,height:0};this.notify("crop",{prop:"calcRatio",onPropertyChange:!1,value:{obj:p,dimension:{width:o.canvas.width,height:o.canvas.height}}})}},t.prototype.getRotatedCanvasDim=function(i,r,o){var a=o*Math.PI/180,n=Math.cos(a),s=Math.sin(a),h=Math.min(0,i*n,r*Math.cos(Math.PI/2-a),i*n+r*Math.cos(Math.PI/2-a)),p=Math.max(0,i*n,r*Math.cos(Math.PI/2-a),i*n+r*Math.cos(Math.PI/2-a)),u=Math.min(0,i*s,r*Math.sin(Math.PI/2-a),i*s+r*Math.sin(Math.PI/2-a)),c=Math.max(0,i*s,r*Math.sin(Math.PI/2-a),i*s+r*Math.sin(Math.PI/2-a));return{width:Math.ceil(p-h),height:Math.ceil(c-u)}},t.prototype.updateShapeOrder=function(i,r){var o=this.getObjFromId(i);if(o.shape&&(o.shape!=="path"||o.shape==="path"&&o.pointColl.length>0)||o&&o.id&&o.id.indexOf("pen")>-1){var a={shapeSettingsObj:{}};this.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:a}});var n=a.shapeSettingsObj;o.shape&&this.notify("shape",{prop:"pushActItemIntoObj"});var s=y({},this.cropObj,{},!0),h={currObj:{}};this.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:h}});var p=h.currObj;p.objColl=y([],this.objColl,[],!0),p.pointColl=y([],this.pointColl,[],!0),p.afterCropActions=y([],this.afterCropActions,[],!0);var u={selPointColl:null};this.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:u}}),p.selPointColl=y([],u.selPointColl,[],!0),o.shape&&this.objColl.pop(),this.notify("shape",{prop:"z-order",onPropertyChange:!1,value:{obj:o,value:r}}),o.shape&&(this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:null,strokeWidth:o.strokeSettings.strokeWidth}}),this.objColl.push(o)),this.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:p,previousObjColl:p.objColl,previousPointColl:p.pointColl,previousSelPointColl:p.selPointColl,previousCropObj:s,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),o.shape&&(this.notify("selection",{prop:"redrawShape",value:{obj:this.objColl[this.objColl.length-1]}}),this.activeObj.order=o.order);var c={action:"stroke-width",previousShapeSettings:y({},n,{},!0),currentShapeSettings:y({},n,{},!0)};c.currentShapeSettings.strokeWidth=this.activeObj.strokeSettings.strokeWidth}else this.activeObj.shape&&this.activeObj.shape==="path"&&this.activeObj.pointColl.length===0&&this.notify("shape",{prop:"setStrokeSettings",value:{strokeSettings:null,strokeColor:null,fillColor:null,strokeWidth:this.activeObj.strokeSettings.strokeWidth}})},t.prototype.getStraightenFlipState=function(){var i="";if(this.rotateFlipColl.length>0)for(var r=0,o=this.rotateFlipColl.length;r<o;r++){var a=this.rotateFlipColl[r];a==="horizontal"?i+="horizontal":a==="vertical"&&(i+="vertical"),(i==="horizontalvertical"||i==="verticalhorizontal")&&(i="")}return i},t.prototype.initializeZoomSettings=function(){this.theme=d(this.theme)?"Bootstrap5":this.theme,(d(this.zoomSettings.zoomTrigger)||this.zoomSettings.zoomTrigger===0)&&(this.zoomSettings.zoomTrigger=ze.MouseWheel|ze.Pinch|ze.Toolbar|ze.Commands),d(this.selectionSettings.strokeColor)&&(this.selectionSettings.strokeColor=this.themeColl[this.theme].primaryColor),d(this.selectionSettings.fillColor)&&(this.selectionSettings.fillColor=this.themeColl[this.theme].secondaryColor)},t.prototype.initializeThemeColl=function(){this.themeColl={Bootstrap5:{primaryColor:"#0d6efd",secondaryColor:"#fff"},Bootstrap5Dark:{primaryColor:"#0d6efd",secondaryColor:"#fff"},Tailwind:{primaryColor:"#4f46e5",secondaryColor:"#fff"},TailwindDark:{primaryColor:"#22d3ee",secondaryColor:"#fff"},Fluent:{primaryColor:"#0078d4",secondaryColor:"#fff"},FluentDark:{primaryColor:"#0078d4",secondaryColor:"#fff"},Bootstrap4:{primaryColor:"#007bff",secondaryColor:"#fff"},Bootstrap:{primaryColor:"#317ab9",secondaryColor:"#fff"},BootstrapDark:{primaryColor:"#317ab9",secondaryColor:"#fff"},Material:{primaryColor:"#e3165b",secondaryColor:"#fff"},MaterialDark:{primaryColor:"#00b0ff",secondaryColor:"#fff"},Fabric:{primaryColor:"#0078d6",secondaryColor:"#fff"},FabricDark:{primaryColor:"#0074cc",secondaryColor:"#fff"},Highcontrast:{primaryColor:"#000000",secondaryColor:"#fff"},Material3:{primaryColor:"#6750a4",secondaryColor:"#fff"},Material3Dark:{primaryColor:"#d0bcff",secondaryColor:"#fff"},Fluent2:{primaryColor:"#0f6cbd",secondaryColor:"#fff"},Fluent2Dark:{primaryColor:"#115ea3",secondaryColor:"#fff"},Fluent2Highcontrast:{primaryColor:"#1aebff",secondaryColor:"#fff"},"Bootstrap5.3":{primaryColor:"#0d6efd",secondaryColor:"#fff"},"Bootstrap5.3Dark":{primaryColor:"#0d6efd",secondaryColor:"#fff"},Tailwind3:{primaryColor:"#4f46e5",secondaryColor:"#ffffff"},Tailwind3Dark:{primaryColor:"#6366f1",secondaryColor:"#ffffff03"}}},t.prototype.drawRedact=function(i,r,o,a,n,s){var h=!1,p=this.allowShape(r,o);return!this.disabled&&this.isImageLoaded&&(p||d(r)&&d(o))&&(h=!0,this.manageActiveAction(),this.notify("shape",{prop:"drawRedact",onPropertyChange:!1,value:{x:r,y:o,width:a,height:n,type:i,value:s}}),this.notify("draw",{prop:"redrawDownScale"})),h};var e;return ie([T("")],t.prototype,"cssClass",void 0),ie([T(!1)],t.prototype,"disabled",void 0),ie([T("100%")],t.prototype,"height",void 0),ie([T("Bootstrap5")],t.prototype,"theme",void 0),ie([T()],t.prototype,"toolbar",void 0),ie([T()],t.prototype,"toolbarTemplate",void 0),ie([T("100%")],t.prototype,"width",void 0),ie([T(!0)],t.prototype,"allowUndoRedo",void 0),ie([T(!0)],t.prototype,"showQuickAccessToolbar",void 0),ie([T()],t.prototype,"quickAccessToolbarTemplate",void 0),ie([T(!1)],t.prototype,"isReadOnly",void 0),ie([T(!1)],t.prototype,"enableRtl",void 0),ie([T(!1)],t.prototype,"enablePersistence",void 0),ie([Ke({},iy)],t.prototype,"finetuneSettings",void 0),ie([Ke({},ry)],t.prototype,"zoomSettings",void 0),ie([Ke({},oy)],t.prototype,"selectionSettings",void 0),ie([Ke({},ay)],t.prototype,"fontFamily",void 0),ie([Ke({},ty)],t.prototype,"uploadSettings",void 0),ie([Y()],t.prototype,"beforeSave",void 0),ie([Y()],t.prototype,"created",void 0),ie([Y()],t.prototype,"destroyed",void 0),ie([Y()],t.prototype,"zooming",void 0),ie([Y()],t.prototype,"panning",void 0),ie([Y()],t.prototype,"cropping",void 0),ie([Y()],t.prototype,"rotating",void 0),ie([Y()],t.prototype,"flipping",void 0),ie([Y()],t.prototype,"shapeChanging",void 0),ie([Y()],t.prototype,"selectionChanging",void 0),ie([Y()],t.prototype,"fileOpened",void 0),ie([Y()],t.prototype,"saved",void 0),ie([Y()],t.prototype,"toolbarCreated",void 0),ie([Y()],t.prototype,"toolbarUpdating",void 0),ie([Y()],t.prototype,"toolbarItemClicked",void 0),ie([Y()],t.prototype,"imageFiltering",void 0),ie([Y()],t.prototype,"finetuneValueChanging",void 0),ie([Y()],t.prototype,"click",void 0),ie([Y()],t.prototype,"shapeChange",void 0),ie([Y()],t.prototype,"quickAccessToolbarOpen",void 0),ie([Y()],t.prototype,"resizing",void 0),ie([Y()],t.prototype,"quickAccessToolbarItemClick",void 0),ie([Y()],t.prototype,"frameChange",void 0),ie([Y()],t.prototype,"editComplete",void 0),t=e=ie([Qe],t),t}(ct),gl;(function(l){l.Png="Png",l.Jpeg="Jpeg",l.Svg="Svg",l.WebP="WebP"})(gl||(gl={}));var Oo;(function(l){l.Horizontal="Horizontal",l.Vertical="Vertical"})(Oo||(Oo={}));var bt;(function(l){l.Rectangle="Rectangle",l.Ellipse="Ellipse",l.Line="Line",l.Arrow="Arrow",l.Path="Path",l.Text="Text",l.FreehandDraw="FreehandDraw",l.Image="Image"})(bt||(bt={}));var ze;(function(l){l[l.MouseWheel=1]="MouseWheel",l[l.Pinch=2]="Pinch",l[l.Commands=4]="Commands",l[l.Toolbar=8]="Toolbar"})(ze||(ze={}));var vl;(function(l){l.Bootstrap5="Bootstrap5",l.Bootstrap5Dark="Bootstrap5Dark",l.Tailwind="Tailwind",l.TailwindDark="TailwindDark",l.Fluent="Fluent",l.FluentDark="FluentDark",l.Bootstrap4="Bootstrap4",l.Bootstrap="Bootstrap",l.BootstrapDark="BootstrapDark",l.Material="Material",l.MaterialDark="MaterialDark",l.Fabric="Fabric",l.FabricDark="FabricDark",l.Highcontrast="Highcontrast",l.Fluent2="Fluent2",l.Fluent2Dark="Fluent2Dark",l.Tailwind3="Tailwind3",l.Tailwind3Dark="Tailwind3Dark"})(vl||(vl={}));var yl;(function(l){l.Crop="Crop",l.Transform="Transform",l.Annotate="Annotate",l.ZoomIn="ZoomIn",l.ZoomOut="ZoomOut",l.Open="Open",l.Reset="Reset",l.Save="Save",l.Pan="Pan",l.Move="Move",l.Pen="Pen",l.Line="Line",l.Arrow="Arrow",l.Path="Path",l.Rectangle="Rectangle",l.Image="Image",l.Ellipse="Ellipse",l.Text="Text",l.CustomSelection="CustomSelection",l.CircleSelection="CircleSelection",l.SquareSelection="SquareSelection",l.RatioSelection="RatioSelection",l.RotateLeft="RotateLeft",l.RotateRight="RotateRight",l.FlipHorizontal="FlipHorizontal",l.FlipVertical="FlipVertical",l.Undo="Undo",l.Redo="Redo",l.None="None",l.Mat="Mat",l.Bevel="Bevel",l.Inset="Inset",l.Hook="Hook",l.Finetune="Finetune",l.Filter="Filter",l.Frame="Frame",l.Resize="Resize",l.HorizontalFlip="HorizontalFlip",l.VerticalFlip="VerticalFlip",l.Brightness="Brightness",l.Contrast="Contrast",l.Hue="Hue",l.Saturation="Saturation",l.Opacity="Opacity",l.Blur="Blur",l.Exposure="Exposure",l.Default="Default",l.Chrome="Chrome",l.Cold="Cold",l.Warm="Warm",l.Grayscale="Grayscale",l.Sepia="Sepia",l.Invert="Invert",l.Straightening="Straightening"})(yl||(yl={}));var ml;(function(l){l.Default="Default",l.Chrome="Chrome",l.Cold="Cold",l.Warm="Warm",l.Grayscale="Grayscale",l.Sepia="Sepia",l.Invert="Invert"})(ml||(ml={}));var _t;(function(l){l.Brightness="Brightness",l.Contrast="Contrast",l.Hue="Hue",l.Saturation="Saturation",l.Exposure="Exposure",l.Opacity="Opacity",l.Blur="Blur"})(_t||(_t={}));var Fi;(function(l){l.None="None",l.Arrow="Arrow",l.SolidArrow="SolidArrow",l.Circle="Circle",l.SolidCircle="SolidCircle",l.Square="Square",l.SolidSquare="SolidSquare",l.Bar="Bar"})(Fi||(Fi={}));var Cl;(function(l){l.None="None",l.Mat="Mat",l.Bevel="Bevel",l.Line="Line",l.Inset="Inset",l.Hook="Hook"})(Cl||(Cl={}));var $a;(function(l){l.Solid="Solid",l.Dashed="Dashed",l.Dotted="Dotted"})($a||($a={}));var en;(function(l){l.Blur="Blur",l.Pixelate="Pixelate"})(en||(en={}));var sy=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ml=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},ly="e-hscroll",$t="e-rtl",ei="e-overlay",hy="e-hscroll-bar",py="e-hscroll-content",nr="e-nav-arrow",sr="e-nav-right-arrow",io="e-nav-left-arrow",di="e-scroll-nav",Ta="e-scroll-right-nav",bl="e-scroll-left-nav",jl="e-scroll-device",ro="e-scroll-overlay",Sa="e-scroll-right-overlay",Na="e-scroll-left-overlay",Il=40,uy=function(l){sy(t,l);function t(e,i){return l.call(this,e,i)||this}return t.prototype.preRender=function(){this.browser=S.info.name,this.browserCheck=this.browser==="mozilla",this.isDevice=S.isDevice,this.customStep=!0;var e=this.element;this.ieCheck=this.browser==="edge"||this.browser==="msie",this.initialize(),e.id===""&&(e.id=Ve("hscroll"),this.uniqueId=!0),e.style.display="block",this.enableRtl&&e.classList.add($t)},t.prototype.render=function(){this.touchModule=new Tr(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),b.add(this.scrollEle,"scroll",this.scrollHandler,this),this.isDevice?(this.element.classList.add(jl),this.createOverlay(this.element)):this.createNavIcon(this.element),this.setScrollState()},t.prototype.setScrollState=function(){d(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetWidth,this.customStep=!1):this.customStep=!0},t.prototype.initialize=function(){var e=this.createElement("div",{className:py}),i=this.createElement("div",{className:hy});i.setAttribute("tabindex","-1");for(var r=this.element,o=[].slice.call(r.children),a=0,n=o;a<n.length;a++){var s=n[a];e.appendChild(s)}i.appendChild(e),r.appendChild(i),i.style.overflowX="hidden",this.scrollEle=i,this.scrollItems=e},t.prototype.getPersistData=function(){var e=["scrollStep"];return this.addOnPersist(e)},t.prototype.getModuleName=function(){return"hScroll"},t.prototype.destroy=function(){var e=this.element;e.style.display="",e.classList.remove(ly),e.classList.remove(jl),e.classList.remove($t);var i=me(".e-"+e.id+"_nav."+di,e),r=me("."+ro,e);[].slice.call(r).forEach(function(s){X(s)});for(var o=0,a=[].slice.call(this.scrollItems.children);o<a.length;o++){var n=a[o];e.appendChild(n)}this.uniqueId&&this.element.removeAttribute("id"),X(this.scrollEle),i.length>0&&(X(i[0]),d(i[1])||X(i[1])),b.remove(this.scrollEle,"scroll",this.scrollHandler),this.touchModule.destroy(),this.touchModule=null,l.prototype.destroy.call(this)},t.prototype.disable=function(e){var i=me(".e-scroll-nav:not(."+ei+")",this.element);e?this.element.classList.add(ei):this.element.classList.remove(ei),[].slice.call(i).forEach(function(r){r.setAttribute("tabindex",e?"-1":"0")})},t.prototype.createOverlay=function(e){var i=e.id.concat("_nav"),r=this.createElement("div",{className:ro+" "+Sa}),o="e-"+e.id.concat("_nav "+di+" "+Ta),a=this.createElement("div",{id:i.concat("_right"),className:o}),n=this.createElement("div",{className:sr+" "+nr+" e-icons"});a.appendChild(n);var s=this.createElement("div",{className:ro+" "+Na});this.ieCheck&&a.classList.add("e-ie-align"),e.appendChild(r),e.appendChild(a),e.insertBefore(s,e.firstChild),this.eventBinding([a])},t.prototype.createNavIcon=function(e){var i=e.id.concat("_nav"),r="e-"+e.id.concat("_nav "+di+" "+Ta),o={role:"button",id:i.concat("_right"),"aria-label":"Scroll right"},a=this.createElement("div",{className:r,attrs:o});a.setAttribute("aria-disabled","false");var n=this.createElement("div",{className:sr+" "+nr+" e-icons"}),s="e-"+e.id.concat("_nav "+di+" "+bl),h={role:"button",id:i.concat("_left"),"aria-label":"Scroll left"},p=this.createElement("div",{className:s+" "+ei,attrs:h});p.setAttribute("aria-disabled","true");var u=this.createElement("div",{className:io+" "+nr+" e-icons"});p.appendChild(u),a.appendChild(n),e.appendChild(a),e.insertBefore(p,e.firstChild),this.ieCheck&&(a.classList.add("e-ie-align"),p.classList.add("e-ie-align")),this.eventBinding([a,p])},t.prototype.onKeyPress=function(e){var i=this;if(e.key==="Enter"){var r=function(){i.keyTimeout=!0,i.eleScrolling(10,e.target,!0)};this.keyTimer=window.setTimeout(function(){r()},100)}},t.prototype.onKeyUp=function(e){e.key==="Enter"&&(this.keyTimeout?this.keyTimeout=!1:e.target.click(),clearTimeout(this.keyTimer))},t.prototype.eventBinding=function(e){var i=this;[].slice.call(e).forEach(function(r){new Tr(r,{tapHold:i.tabHoldHandler.bind(i),tapHoldThreshold:500}),r.addEventListener("keydown",i.onKeyPress.bind(i)),r.addEventListener("keyup",i.onKeyUp.bind(i)),r.addEventListener("mouseup",i.repeatScroll.bind(i)),r.addEventListener("touchend",i.repeatScroll.bind(i)),r.addEventListener("contextmenu",function(o){o.preventDefault()}),b.add(r,"click",i.clickEventHandler,i)})},t.prototype.repeatScroll=function(){clearInterval(this.timeout)},t.prototype.tabHoldHandler=function(e){var i=this,r=e.originalEvent.target;r=this.contains(r,di)?r.firstElementChild:r;var o=10,a=function(){i.eleScrolling(o,r,!0)};this.timeout=window.setInterval(function(){a()},50)},t.prototype.contains=function(e,i){return e.classList.contains(i)},t.prototype.eleScrolling=function(e,i,r){var o=this.element,a=i.classList;a.contains(di)&&(a=i.querySelector("."+nr).classList),this.contains(o,$t)&&this.browserCheck&&(e=-e),!this.contains(o,$t)||this.browserCheck||this.ieCheck?a.contains(sr)?this.frameScrollRequest(e,"add",r):this.frameScrollRequest(e,"",r):a.contains(io)?this.frameScrollRequest(e,"add",r):this.frameScrollRequest(e,"",r)},t.prototype.clickEventHandler=function(e){this.eleScrolling(this.scrollStep,e.target,!1)},t.prototype.swipeHandler=function(e){var i=this.scrollEle,r;e.velocity<=1?r=e.distanceX/(e.velocity*10):r=e.distanceX/e.velocity;var o=.5,a=function(){var n=Math.sin(o);n<=0?window.cancelAnimationFrame(n):(e.swipeDirection==="Left"?i.scrollLeft+=r*n:e.swipeDirection==="Right"&&(i.scrollLeft-=r*n),o-=.5,window.requestAnimationFrame(a))};a()},t.prototype.scrollUpdating=function(e,i){i==="add"?this.scrollEle.scrollLeft+=e:this.scrollEle.scrollLeft-=e,this.enableRtl&&this.scrollEle.scrollLeft>0&&(this.scrollEle.scrollLeft=0)},t.prototype.frameScrollRequest=function(e,i,r){var o=this,a=10;if(r){this.scrollUpdating(e,i);return}this.customStep||[].slice.call(me("."+ro,this.element)).forEach(function(s){e-=s.offsetWidth});var n=function(){var s,h;o.contains(o.element,$t)&&o.browserCheck?(s=-e,h=-10):(s=e,h=a),s<a?window.cancelAnimationFrame(h):(o.scrollUpdating(h,i),e-=h,window.requestAnimationFrame(n))};n()},t.prototype.touchHandler=function(e){var i=this.scrollEle,r=e.distanceX;this.ieCheck&&this.contains(this.element,$t)&&(r=-r),e.scrollDirection==="Left"?i.scrollLeft=i.scrollLeft+r:e.scrollDirection==="Right"&&(i.scrollLeft=i.scrollLeft-r)},t.prototype.arrowDisabling=function(e,i){if(this.isDevice){var r=d(e)?i:e,o=r.querySelector("."+nr);d(e)?lt(o,[sr],[io]):lt(o,[io],[sr])}else e&&i&&(e.classList.add(ei),e.setAttribute("aria-disabled","true"),e.removeAttribute("tabindex"),i.classList.remove(ei),i.setAttribute("aria-disabled","false"),i.setAttribute("tabindex","0"));this.repeatScroll()},t.prototype.scrollHandler=function(e){var i=e.target,r=i.offsetWidth;this.element;var o=this.element.querySelector("."+bl),a=this.element.querySelector("."+Ta),n=this.element.querySelector("."+Na),s=this.element.querySelector("."+Sa),h=i.scrollLeft;if(h<=0&&(h=-h),this.isDevice&&(this.enableRtl&&!(this.browserCheck||this.ieCheck)&&(n=this.element.querySelector("."+Sa),s=this.element.querySelector("."+Na)),h<Il?n.style.width=h+"px":n.style.width="40px",i.scrollWidth-Math.ceil(r+h)<Il?s.style.width=i.scrollWidth-Math.ceil(r+h)+"px":s.style.width="40px"),h===0)this.arrowDisabling(o,a);else if(Math.ceil(r+h+.1)>=i.scrollWidth)this.arrowDisabling(a,o);else{var p=this.element.querySelector("."+di+"."+ei);p&&(p.classList.remove(ei),p.setAttribute("aria-disabled","false"),p.setAttribute("tabindex","0"))}},t.prototype.onPropertyChanged=function(e,i){for(var r=0,o=Object.keys(e);r<o.length;r++){var a=o[r];switch(a){case"scrollStep":this.setScrollState();break;case"enableRtl":e.enableRtl?this.element.classList.add($t):this.element.classList.remove($t);break}}},Ml([T(null)],t.prototype,"scrollStep",void 0),t=Ml([Qe],t),t}(ct),cy=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Tl=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},dy="e-vscroll",oo="e-rtl",ti="e-overlay",fy="e-vscroll-bar",gy="e-vscroll-content",lr="e-nav-arrow",ao="e-nav-up-arrow",hr="e-nav-down-arrow",fi="e-scroll-nav",Sl="e-scroll-up-nav",Da="e-scroll-down-nav",Nl="e-scroll-device",no="e-scroll-overlay",Dl="e-scroll-up-overlay",wl="e-scroll-down-overlay",Ol=40,vy=function(l){cy(t,l);function t(e,i){return l.call(this,e,i)||this}return t.prototype.preRender=function(){this.browser=S.info.name,this.browserCheck=this.browser==="mozilla",this.isDevice=S.isDevice,this.customStep=!0;var e=this.element;this.ieCheck=this.browser==="edge"||this.browser==="msie",this.initialize(),e.id===""&&(e.id=Ve("vscroll"),this.uniqueId=!0),e.style.display="block",this.enableRtl&&e.classList.add(oo)},t.prototype.render=function(){this.touchModule=new Tr(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),b.add(this.scrollEle,"scroll",this.scrollEventHandler,this),this.isDevice?(this.element.classList.add(Nl),this.createOverlayElement(this.element)):this.createNavIcon(this.element),this.setScrollState(),b.add(this.element,"wheel",this.wheelEventHandler,this)},t.prototype.setScrollState=function(){d(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetHeight,this.customStep=!1):this.customStep=!0},t.prototype.initialize=function(){var e=Ie("div",{className:gy}),i=Ie("div",{className:fy});i.setAttribute("tabindex","-1");for(var r=this.element,o=[].slice.call(r.children),a=0,n=o;a<n.length;a++){var s=n[a];e.appendChild(s)}i.appendChild(e),r.appendChild(i),i.style.overflow="hidden",this.scrollEle=i,this.scrollItems=e},t.prototype.getPersistData=function(){var e=["scrollStep"];return this.addOnPersist(e)},t.prototype.getModuleName=function(){return"vScroll"},t.prototype.destroy=function(){var e=this.element;e.style.display="",G([this.element],[dy,Nl,oo]);var i=me(".e-"+e.id+"_nav."+fi,e),r=me("."+no,e);[].slice.call(r).forEach(function(s){X(s)});for(var o=0,a=[].slice.call(this.scrollItems.children);o<a.length;o++){var n=a[o];e.appendChild(n)}this.uniqueId&&this.element.removeAttribute("id"),X(this.scrollEle),i.length>0&&(X(i[0]),d(i[1])||X(i[1])),b.remove(this.scrollEle,"scroll",this.scrollEventHandler),this.touchModule.destroy(),this.touchModule=null,l.prototype.destroy.call(this)},t.prototype.disable=function(e){var i=me(".e-scroll-nav:not(."+ti+")",this.element);e?this.element.classList.add(ti):this.element.classList.remove(ti),[].slice.call(i).forEach(function(r){r.setAttribute("tabindex",e?"-1":"0")})},t.prototype.createOverlayElement=function(e){var i=e.id.concat("_nav"),r=Ie("div",{className:no+" "+wl}),o="e-"+e.id.concat("_nav "+fi+" "+Da),a=Ie("div",{id:i.concat("down"),className:o}),n=Ie("div",{className:hr+" "+lr+" e-icons"});a.appendChild(n);var s=Ie("div",{className:no+" "+Dl});this.ieCheck&&a.classList.add("e-ie-align"),e.appendChild(r),e.appendChild(a),e.insertBefore(s,e.firstChild),this.eventBinding([a])},t.prototype.createNavIcon=function(e){var i=e.id.concat("_nav"),r="e-"+e.id.concat("_nav "+fi+" "+Da),o=Ie("div",{id:i.concat("_down"),className:r});o.setAttribute("aria-disabled","false");var a=Ie("div",{className:hr+" "+lr+" e-icons"}),n="e-"+e.id.concat("_nav "+fi+" "+Sl),s=Ie("div",{id:i.concat("_up"),className:n+" "+ti});s.setAttribute("aria-disabled","true");var h=Ie("div",{className:ao+" "+lr+" e-icons"});s.appendChild(h),o.appendChild(a),o.setAttribute("tabindex","0"),e.appendChild(o),e.insertBefore(s,e.firstChild),this.ieCheck&&(o.classList.add("e-ie-align"),s.classList.add("e-ie-align")),this.eventBinding([o,s])},t.prototype.onKeyPress=function(e){var i=this;if(e.key==="Enter"){var r=function(){i.keyTimeout=!0,i.eleScrolling(10,e.target,!0)};this.keyTimer=window.setTimeout(function(){r()},100)}},t.prototype.onKeyUp=function(e){e.key==="Enter"&&(this.keyTimeout?this.keyTimeout=!1:e.target.click(),clearTimeout(this.keyTimer))},t.prototype.eventBinding=function(e){var i=this;[].slice.call(e).forEach(function(r){new Tr(r,{tapHold:i.tabHoldHandler.bind(i),tapHoldThreshold:500}),r.addEventListener("keydown",i.onKeyPress.bind(i)),r.addEventListener("keyup",i.onKeyUp.bind(i)),r.addEventListener("mouseup",i.repeatScroll.bind(i)),r.addEventListener("touchend",i.repeatScroll.bind(i)),r.addEventListener("contextmenu",function(o){o.preventDefault()}),b.add(r,"click",i.clickEventHandler,i)})},t.prototype.repeatScroll=function(){clearInterval(this.timeout)},t.prototype.tabHoldHandler=function(e){var i=this,r=e.originalEvent.target;r=this.contains(r,fi)?r.firstElementChild:r;var o=10,a=function(){i.eleScrolling(o,r,!0)};this.timeout=window.setInterval(function(){a()},50)},t.prototype.contains=function(e,i){return e.classList.contains(i)},t.prototype.eleScrolling=function(e,i,r){var o=i.classList;o.contains(fi)&&(o=i.querySelector("."+lr).classList),o.contains(hr)?this.frameScrollRequest(e,"add",r):o.contains(ao)&&this.frameScrollRequest(e,"",r)},t.prototype.clickEventHandler=function(e){this.eleScrolling(this.scrollStep,e.target,!1)},t.prototype.wheelEventHandler=function(e){e.preventDefault(),this.frameScrollRequest(this.scrollStep,e.deltaY>0?"add":"",!1)},t.prototype.swipeHandler=function(e){var i=this.scrollEle,r;e.velocity<=1?r=e.distanceY/(e.velocity*10):r=e.distanceY/e.velocity;var o=.5,a=function(){var n=Math.sin(o);n<=0?window.cancelAnimationFrame(n):(e.swipeDirection==="Up"?i.scrollTop+=r*n:e.swipeDirection==="Down"&&(i.scrollTop-=r*n),o-=.02,window.requestAnimationFrame(a))};a()},t.prototype.scrollUpdating=function(e,i){i==="add"?this.scrollEle.scrollTop+=e:this.scrollEle.scrollTop-=e},t.prototype.frameScrollRequest=function(e,i,r){var o=this,a=10;if(r){this.scrollUpdating(e,i);return}this.customStep||[].slice.call(me("."+no,this.element)).forEach(function(s){e-=s.offsetHeight});var n=function(){e<a?window.cancelAnimationFrame(a):(o.scrollUpdating(a,i),e-=a,window.requestAnimationFrame(n))};n()},t.prototype.touchHandler=function(e){var i=this.scrollEle,r=e.distanceY;e.scrollDirection==="Up"?i.scrollTop=i.scrollTop+r:e.scrollDirection==="Down"&&(i.scrollTop=i.scrollTop-r)},t.prototype.arrowDisabling=function(e,i){if(this.isDevice){var r=d(e)?i:e,o=r.querySelector("."+lr);d(e)?lt(o,[hr],[ao]):lt(o,[ao],[hr])}else e.classList.add(ti),e.setAttribute("aria-disabled","true"),e.removeAttribute("tabindex"),i.classList.remove(ti),i.setAttribute("aria-disabled","false"),i.setAttribute("tabindex","0");this.repeatScroll()},t.prototype.scrollEventHandler=function(e){var i=e.target,r=i.offsetHeight,o=this.element.querySelector("."+Sl),a=this.element.querySelector("."+Da),n=this.element.querySelector("."+Dl),s=this.element.querySelector("."+wl),h=i.scrollTop;if(h<=0&&(h=-h),this.isDevice&&(h<Ol?n.style.height=h+"px":n.style.height="40px",i.scrollHeight-Math.ceil(r+h)<Ol?s.style.height=i.scrollHeight-Math.ceil(r+h)+"px":s.style.height="40px"),h===0)this.arrowDisabling(o,a);else if(Math.ceil(r+h+.1)>=i.scrollHeight)this.arrowDisabling(a,o);else{var p=this.element.querySelector("."+fi+"."+ti);p&&(p.classList.remove(ti),p.setAttribute("aria-disabled","false"),p.setAttribute("tabindex","0"))}},t.prototype.onPropertyChanged=function(e,i){for(var r=0,o=Object.keys(e);r<o.length;r++){var a=o[r];switch(a){case"scrollStep":this.setScrollState();break;case"enableRtl":e.enableRtl?this.element.classList.add(oo):this.element.classList.remove(oo);break}}},Tl([T(null)],t.prototype,"scrollStep",void 0),t=Tl([Qe],t),t}(ct),Rh=function(){var l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},l(t,e)};return function(t,e){l(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),je=function(l,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(l,t,e,i);else for(var n=l.length-1;n>=0;n--)(a=l[n])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},wa="e-vertical",we="e-toolbar-items",Oe="e-toolbar-item",Ft="e-rtl",Ee="e-separator",so="e-popup-up-icon",pr="e-popup-down-icon",xl="e-popup-open",Al="e-template",tt="e-overlay",zl="e-toolbar-text",Oa="e-popup-text",Nt="e-overflow-show",lo="e-overflow-hide",yy="e-tbar-btn",nt="e-hor-nav",Pl="e-scroll-nav",my="e-toolbar-right",Cy="e-toolbar-left",El="e-toolbar-center",Dt="e-tbar-pos",My="e-hscroll-content",by="e-vscroll-content",xa="e-hscroll-bar",jy="e-hor-nav",ur="e-toolbar-pop",ii="e-toolbar-popup",Iy="e-tbar-btn-text",cr="e-nav-active",dr="e-ignore",Aa="e-popup-alone",Ut="e-hidden",Ll="e-toolbar-multirow",kl="e-multirow-pos",za="e-multirow-separator",Pa="e-extended-separator",Yl="e-extended-toolbar",ho="e-toolbar-extended",Ty="e-expended-nav",Ea="e-tbar-extended",Sy=function(l){Rh(t,l);function t(){return l!==null&&l.apply(this,arguments)||this}return je([T("")],t.prototype,"id",void 0),je([T("")],t.prototype,"text",void 0),je([T("auto")],t.prototype,"width",void 0),je([T("")],t.prototype,"cssClass",void 0),je([T(!1)],t.prototype,"showAlwaysInPopup",void 0),je([T(!1)],t.prototype,"disabled",void 0),je([T("")],t.prototype,"prefixIcon",void 0),je([T("")],t.prototype,"suffixIcon",void 0),je([T(!0)],t.prototype,"visible",void 0),je([T("None")],t.prototype,"overflow",void 0),je([T("")],t.prototype,"template",void 0),je([T("Button")],t.prototype,"type",void 0),je([T("Both")],t.prototype,"showTextOn",void 0),je([T(null)],t.prototype,"htmlAttributes",void 0),je([T("")],t.prototype,"tooltipText",void 0),je([T("Left")],t.prototype,"align",void 0),je([Y()],t.prototype,"click",void 0),je([T(-1)],t.prototype,"tabIndex",void 0),t}(Be),dt=function(l){Rh(t,l);function t(e,i){var r=l.call(this,e,i)||this;return r.resizeContext=r.resize.bind(r),r.orientationChangeContext=r.orientationChange.bind(r),r.keyConfigs={moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow",popupOpen:"enter",popupClose:"escape",tab:"tab",home:"home",end:"end"},r}return t.prototype.destroy=function(){var e=this;(this.isReact||this.isAngular)&&this.clearTemplate();var i=this.element.querySelectorAll(".e-control.e-btn");for([].slice.call(i).forEach(function(r){!d(r)&&!d(r.ej2_instances)&&!d(r.ej2_instances[0])&&!r.ej2_instances[0].isDestroyed&&r.ej2_instances[0].destroy()}),this.unwireEvents(),this.tempId.forEach(function(r){d(e.element.querySelector(r))||(document.body.appendChild(e.element.querySelector(r)).style.display="none")}),this.destroyItems();this.element.lastElementChild;)this.element.removeChild(this.element.lastElementChild);this.trgtEle&&(this.element.appendChild(this.ctrlTem),this.trgtEle=null,this.ctrlTem=null),this.popObj&&(this.popObj.destroy(),X(this.popObj.element)),this.activeEle&&(this.activeEle=null),this.popObj=null,this.tbarAlign=null,this.tbarItemsCol=[],this.remove(this.element,"e-toolpop"),this.cssClass&&G([this.element],this.cssClass.split(" ")),this.element.removeAttribute("style"),["aria-disabled","aria-orientation","role"].forEach(function(r){return e.element.removeAttribute(r)}),l.prototype.destroy.call(this)},t.prototype.preRender=function(){var e={enableCollision:this.enableCollision,scrollStep:this.scrollStep};this.trigger("beforeCreate",e),this.enableCollision=e.enableCollision,this.scrollStep=e.scrollStep,this.scrollModule=null,this.popObj=null,this.tempId=[],this.tbarItemsCol=this.items,this.isVertical=!!this.element.classList.contains(wa),this.isExtendedOpen=!1,this.popupPriCount=0,this.enableRtl&&this.add(this.element,Ft)},t.prototype.wireEvents=function(){b.add(this.element,"click",this.clickHandler,this),window.addEventListener("resize",this.resizeContext),window.addEventListener("orientationchange",this.orientationChangeContext),this.allowKeyboard&&this.wireKeyboardEvent()},t.prototype.wireKeyboardEvent=function(){this.keyModule=new bo(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs}),b.add(this.element,"keydown",this.docKeyDown,this),this.updateTabIndex("0")},t.prototype.updateTabIndex=function(e){var i=this.element.querySelector("."+Oe+":not(."+tt+" ):not(."+Ee+" ):not(."+Ut+" )");if(!d(i)&&!d(i.firstElementChild)){var r=i.firstElementChild.getAttribute("data-tabindex");r&&r==="-1"&&i.firstElementChild.tagName!=="INPUT"&&i.firstElementChild.setAttribute("tabindex",e)}},t.prototype.unwireKeyboardEvent=function(){this.keyModule&&(b.remove(this.element,"keydown",this.docKeyDown),this.keyModule.destroy(),this.keyModule=null)},t.prototype.docKeyDown=function(e){if(e.target.tagName!=="INPUT"){var i=!d(this.popObj)&&st(this.popObj.element)&&this.overflowMode!=="Extended";e.keyCode===9&&e.target.classList.contains("e-hor-nav")===!0&&i&&this.popObj.hide({name:"FadeOut",duration:100});var r=e.keyCode===40||e.keyCode===38||e.keyCode===35||e.keyCode===36;r&&e.preventDefault()}},t.prototype.unwireEvents=function(){b.remove(this.element,"click",this.clickHandler),this.destroyScroll(),this.unwireKeyboardEvent(),window.removeEventListener("resize",this.resizeContext),window.removeEventListener("orientationchange",this.orientationChangeContext),document.removeEventListener("scroll",this.clickEvent),document.removeEventListener("click",this.scrollEvent),this.scrollEvent=null,this.clickEvent=null},t.prototype.clearProperty=function(){this.tbarEle=[],this.tbarAlgEle={lefts:[],centers:[],rights:[]}},t.prototype.docEvent=function(e){var i=ce(e.target,".e-popup");this.popObj&&st(this.popObj.element)&&!i&&this.overflowMode==="Popup"&&this.popObj.hide({name:"FadeOut",duration:100})},t.prototype.destroyScroll=function(){this.scrollModule&&(this.tbarAlign&&this.add(this.scrollModule.element,Dt),this.scrollModule.destroy(),this.scrollModule=null)},t.prototype.destroyItems=function(){if(this.element&&[].slice.call(this.element.querySelectorAll("."+Oe)).forEach(function(i){X(i)}),this.tbarAlign){var e=this.element.querySelector("."+we);[].slice.call(e.children).forEach(function(i){X(i)}),this.tbarAlign=!1,this.remove(e,Dt)}this.clearProperty()},t.prototype.destroyMode=function(){this.scrollModule&&(this.remove(this.scrollModule.element,Ft),this.destroyScroll()),this.remove(this.element,Ea),this.remove(this.element,Yl);var e=this.element.querySelector(".e-toolbar-multirow");e&&this.remove(e,Ll),this.popObj&&this.popupRefresh(this.popObj.element,!0)},t.prototype.add=function(e,i){e.classList.add(i)},t.prototype.remove=function(e,i){e.classList.remove(i)},t.prototype.elementFocus=function(e){var i=e.firstElementChild;i?(i.focus(),this.activeEleSwitch(e)):e.focus()},t.prototype.clstElement=function(e,i){var r;return e&&this.popObj&&st(this.popObj.element)?r=this.popObj.element.querySelector("."+Oe):this.element===i||e?r=this.element.querySelector("."+Oe+":not(."+tt+" ):not(."+Ee+" ):not(."+Ut+" )"):r=ce(i,"."+Oe),r},t.prototype.keyHandling=function(e,i,r,o,a){var n=this.popObj,s=this.element,h={name:"FadeOut",duration:100},p=i.action==="moveUp"?"previous":"next",u,c;switch(i.action){case"moveRight":if(this.isVertical)return;s===r?this.elementFocus(e):o||this.eleFocus(e,"next");break;case"moveLeft":if(this.isVertical)return;o||this.eleFocus(e,"previous");break;case"home":case"end":if(e){var f=ce(e,".e-popup"),g=this.element.querySelector("."+ho);this.overflowMode==="Extended"&&g&&g.classList.contains("e-popup-open")&&(f=i.action==="end"?g:null),f?st(this.popObj.element)&&(c=[].slice.call(f.children),i.action==="home"?u=this.focusFirstVisibleEle(c):u=this.focusLastVisibleEle(c)):(c=this.element.querySelectorAll("."+we+" ."+Oe+":not(."+Ee+")"),i.action==="home"?u=this.focusFirstVisibleEle(c):u=this.focusLastVisibleEle(c)),u&&this.elementFocus(u)}break;case"moveUp":case"moveDown":if(this.isVertical)i.action==="moveUp"?this.eleFocus(e,"previous"):this.eleFocus(e,"next");else if(n&&ce(r,".e-popup")){var v=n.element,m=v.firstElementChild;p==="previous"&&m===e?v.lastElementChild.firstChild.focus():p==="next"&&v.lastElementChild===e?m.firstChild.focus():this.eleFocus(e,p)}else i.action==="moveDown"&&n&&st(n.element)&&this.elementFocus(e);break;case"tab":if(!a&&!o){var C=e.firstElementChild;s===r&&(this.activeEle?this.activeEle.focus():(this.activeEleRemove(C),C.focus()))}break;case"popupClose":n&&this.overflowMode!=="Extended"&&n.hide(h);break;case"popupOpen":if(!o)return;n&&!st(n.element)?(n.element.style.top=s.offsetHeight+"px",n.show({name:"FadeIn",duration:100})):n.hide(h);break}},t.prototype.keyActionHandler=function(e){var i=e.target;if(!(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||this.element.classList.contains(tt))){e.preventDefault();var r=i.classList.contains(nt),o=i.classList.contains(Pl),a=this.clstElement(r,i);(a||o)&&this.keyHandling(a,e,i,r,o)}},t.prototype.disable=function(e){var i=this.element;e?i.classList.add(tt):i.classList.remove(tt),this.activeEle&&this.activeEle.setAttribute("tabindex",this.activeEle.getAttribute("data-tabindex")),this.scrollModule&&this.scrollModule.disable(e),this.popObj&&(st(this.popObj.element)&&this.overflowMode!=="Extended"&&this.popObj.hide(),i.querySelector("#"+i.id+"_nav").setAttribute("tabindex",e?"-1":"0"))},t.prototype.eleContains=function(e){return e.classList.contains(Ee)||e.classList.contains(tt)||e.getAttribute("disabled")||e.classList.contains(Ut)||!st(e)||!e.classList.contains(Oe)},t.prototype.focusFirstVisibleEle=function(e){for(var i,r=0;r<e.length;){var o=e[parseInt(r.toString(),10)];if(!o.classList.contains(Ut)&&!o.classList.contains(tt))return o;r++}return i},t.prototype.focusLastVisibleEle=function(e){for(var i,r=e.length-1;r>=0;){var o=e[parseInt(r.toString(),10)];if(!o.classList.contains(Ut)&&!o.classList.contains(tt))return o;r--}return i},t.prototype.eleFocus=function(e,i){var r=Object(e)[i+"ElementSibling"];if(r){var o=this.eleContains(r);if(o){this.eleFocus(r,i);return}this.elementFocus(r)}else if(this.tbarAlign){var a=Object(e.parentElement)[i+"ElementSibling"];if(!d(a)&&a.children.length===0&&(a=Object(a)[i+"ElementSibling"]),!d(a)&&a.children.length>0)if(i==="next"){var n=a.querySelector("."+Oe);this.eleContains(n)?this.eleFocus(n,i):(n.firstElementChild.focus(),this.activeEleSwitch(n))}else{var n=a.lastElementChild;this.eleContains(n)?this.eleFocus(n,i):this.elementFocus(n)}}else if(!d(e)){var s=this.element.querySelectorAll("."+we+" ."+Oe+":not(."+Ee+"):not(."+tt+"):not(."+Ut+")");i==="next"&&s?this.elementFocus(s[0]):i==="previous"&&s&&this.elementFocus(s[s.length-1])}},t.prototype.clickHandler=function(e){var i=this,r=e.target,o=this.element,a=!d(ce(r,"."+ur)),n=r.classList,s=ce(r,"."+nt);s||(s=r),!o.children[0].classList.contains("e-hscroll")&&!o.children[0].classList.contains("e-vscroll")&&n.contains(nt)&&(n=r.querySelector(".e-icons").classList),(n.contains(so)||n.contains(pr))&&this.popupClickHandler(o,s,Ft);var h,p=ce(e.target,"."+Oe);if(!((d(p)||p.classList.contains(tt))&&!s.classList.contains(nt))){if(p){var u=this.items[this.tbarEle.indexOf(p)];h=u}var c={originalEvent:e,item:h},f=h&&!d(h.click)&&typeof h.click=="object"?!d(h.click.observers)&&h.click.observers.length>0:!d(h)&&!d(h.click);f&&this.trigger("items["+this.tbarEle.indexOf(p)+"].click",c),c.cancel||this.trigger("clicked",c,function(g){!d(i.popObj)&&a&&!g.cancel&&i.overflowMode==="Popup"&&g.item&&g.item.type!=="Input"&&i.popObj.hide({name:"FadeOut",duration:100})})}},t.prototype.popupClickHandler=function(e,i,r){var o=this.popObj;st(o.element)?(i.classList.remove(cr),o.hide({name:"FadeOut",duration:100})):(e.classList.contains(r)&&(o.enableRtl=!0,o.position={X:"left",Y:"top"}),o.offsetX===0&&!e.classList.contains(r)&&(o.enableRtl=!1,o.position={X:"right",Y:"top"}),this.overflowMode==="Extended"&&(o.element.style.minHeight="0px",o.width=this.getToolbarPopupWidth(this.element)),o.dataBind(),o.refreshPosition(),o.element.style.top=this.getElementOffsetY()+"px",i.classList.add(cr),o.show({name:"FadeIn",duration:100}))},t.prototype.getToolbarPopupWidth=function(e){var i=window.getComputedStyle(e);return parseFloat(i.width)+parseFloat(i.borderRightWidth)*2},t.prototype.render=function(){var e=this;this.initialize(),this.renderControl(),this.wireEvents(),this.clickEvent=this.docEvent.bind(this),this.scrollEvent=this.docEvent.bind(this),this.renderComplete(),this.isReact&&this.portals&&this.portals.length>0&&this.renderReactTemplates(function(){e.refreshOverflow()})},t.prototype.initialize=function(){var e=ee(this.width),i=ee(this.height);(S.info.name!=="msie"||this.height!=="auto"||this.overflowMode==="MultiRow")&&de(this.element,{height:i}),de(this.element,{width:e});var r={role:"toolbar","aria-disabled":"false","aria-orientation":this.isVertical?"vertical":"horizontal"};ge(this.element,r),this.cssClass&&W([this.element],this.cssClass.split(" "))},t.prototype.renderControl=function(){var e=this.element;this.trgtEle=e.children.length>0?e.querySelector("div"):null,this.tbarAlgEle={lefts:[],centers:[],rights:[]},this.renderItems(),this.renderLayout()},t.prototype.renderLayout=function(){this.renderOverflowMode(),this.tbarAlign&&this.itemPositioning(),this.popObj&&this.popObj.element.childElementCount>1&&this.checkPopupRefresh(this.element,this.popObj.element)&&this.popupRefresh(this.popObj.element,!1),this.separator()},t.prototype.itemsAlign=function(e,i){var r,o;this.tbarEle||(this.tbarEle=[]);for(var a=0;a<e.length;a++)r=this.renderSubComponent(e[parseInt(a.toString(),10)],a),this.tbarEle.indexOf(r)===-1&&this.tbarEle.push(r),this.tbarAlign||this.tbarItemAlign(e[parseInt(a.toString(),10)],i,a),o=i.querySelector(".e-toolbar-"+e[parseInt(a.toString(),10)].align.toLowerCase()),o?(e[parseInt(a.toString(),10)].showAlwaysInPopup&&e[parseInt(a.toString(),10)].overflow!=="Show"||this.tbarAlgEle[(e[parseInt(a.toString(),10)].align+"s").toLowerCase()].push(r),o.appendChild(r)):i.appendChild(r);if(this.isReact){var n="portals";this.notify("render-react-toolbar-template",this[""+n]),this.renderReactTemplates()}},t.prototype.changeOrientation=function(){var e=this.element;this.isVertical?(e.classList.remove(wa),this.isVertical=!1,(this.height==="auto"||this.height==="100%")&&(e.style.height=this.height),e.setAttribute("aria-orientation","horizontal")):(e.classList.add(wa),this.isVertical=!0,e.setAttribute("aria-orientation","vertical"),de(this.element,{height:ee(this.height),width:ee(this.width)})),this.destroyMode(),this.refreshOverflow()},t.prototype.initScroll=function(e,i){if(!this.scrollModule&&this.checkOverflow(e,i[0])){this.tbarAlign&&this.element.querySelector("."+we+" ."+El).removeAttribute("style"),this.isVertical?this.scrollModule=new vy({scrollStep:this.scrollStep,enableRtl:this.enableRtl},i[0]):this.scrollModule=new uy({scrollStep:this.scrollStep,enableRtl:this.enableRtl},i[0]),this.cssClass&&W([i[0]],this.cssClass.split(" "));var r=this.scrollModule.element.querySelector("."+xa+", .e-vscroll-bar");r&&r.removeAttribute("tabindex"),this.remove(this.scrollModule.element,Dt),de(this.element,{overflow:"hidden"})}},t.prototype.itemWidthCal=function(e){var i=this,r=0,o;return[].slice.call(me("."+Oe,e)).forEach(function(a){st(a)&&(o=window.getComputedStyle(a),r+=i.isVertical?a.offsetHeight:a.offsetWidth,r+=parseFloat(i.isVertical?o.marginTop:o.marginRight),r+=parseFloat(i.isVertical?o.marginBottom:o.marginLeft))}),r},t.prototype.getScrollCntEle=function(e){var i=this.isVertical?".e-vscroll-content":".e-hscroll-content";return e.querySelector(i)},t.prototype.checkOverflow=function(e,i){if(d(e)||d(i)||!st(e))return!1;var r=this.isVertical?e.offsetHeight:e.offsetWidth,o=this.isVertical?i.offsetHeight:i.offsetWidth;(this.tbarAlign||this.scrollModule||r===o)&&(o=this.itemWidthCal(this.scrollModule?this.getScrollCntEle(i):i));var a=e.querySelector("."+nt),n=e.querySelector("."+Pl),s=0;return a?s=this.isVertical?a.offsetHeight:a.offsetWidth:n&&(s=this.isVertical?n.offsetHeight*2:n.offsetWidth*2),r>=o&&n?!1:o>r-s},t.prototype.refreshOverflow=function(){this.resize()},t.prototype.toolbarAlign=function(e){this.tbarAlign&&(this.add(e,Dt),this.itemPositioning())},t.prototype.renderOverflowMode=function(){var e=this.element,i=e.querySelector("."+we),r=this.popupPriCount>0;if(e&&e.children.length>0)switch(this.offsetWid=e.offsetWidth,this.remove(this.element,"e-toolpop"),S.info.name==="msie"&&this.height==="auto"&&(e.style.height=""),this.overflowMode){case"Scrollable":d(this.scrollModule)&&this.initScroll(e,[].slice.call(e.getElementsByClassName(we)));break;case"Popup":this.add(this.element,"e-toolpop"),this.tbarAlign&&this.removePositioning(),(this.checkOverflow(e,i)||r)&&this.setOverflowAttributes(e),this.toolbarAlign(i);break;case"MultiRow":this.add(i,Ll),this.checkOverflow(e,i)&&this.tbarAlign&&(this.removePositioning(),this.add(i,kl)),e.style.overflow==="hidden"&&(e.style.overflow=""),(S.info.name==="msie"||e.style.height!=="auto")&&(e.style.height="auto");break;case"Extended":this.add(this.element,Yl),(this.checkOverflow(e,i)||r)&&(this.tbarAlign&&this.removePositioning(),this.setOverflowAttributes(e)),this.toolbarAlign(i)}},t.prototype.setOverflowAttributes=function(e){this.createPopupEle(e,[].slice.call(me("."+we+" ."+Oe,e)));var i={tabindex:"0",role:"button","aria-haspopup":"true","aria-label":"overflow"};ge(this.element.querySelector("."+nt),i)},t.prototype.separator=function(){var e=this.element,i=[].slice.call(e.querySelectorAll("."+Ee)),r=e.querySelector("."+za),o=e.querySelector("."+Pa),a=this.overflowMode==="MultiRow"?r:o;a!==null&&(this.overflowMode==="MultiRow"?a.classList.remove(za):this.overflowMode==="Extended"&&a.classList.remove(Pa));for(var n=0;n<=i.length-1;n++)i[parseInt(n.toString(),10)].offsetLeft<30&&i[parseInt(n.toString(),10)].offsetLeft!==0&&(this.overflowMode==="MultiRow"?i[parseInt(n.toString(),10)].classList.add(za):this.overflowMode==="Extended"&&i[parseInt(n.toString(),10)].classList.add(Pa))},t.prototype.createPopupEle=function(e,i){var r=e.querySelector("."+nt),o=this.isVertical;r||this.createPopupIcon(e),r=e.querySelector("."+nt);var a=o?r.offsetHeight:r.offsetWidth,n=(o?e.offsetHeight:e.offsetWidth)-a;this.element.classList.remove("e-rtl"),de(this.element,{direction:"initial"}),this.checkPriority(e,i,n,!0),this.enableRtl&&this.element.classList.add("e-rtl"),this.element.style.removeProperty("direction"),this.createPopup()},t.prototype.pushingPoppedEle=function(e,i,r,o,a){var n=e.element,s=[].slice.call(me("."+ii,n.querySelector("."+we))),h=me("."+Nt,r),p=0,u=0;s.forEach(function(v,m){h=me("."+Nt,r),v.classList.contains(Nt)&&h.length>0?e.tbResize&&h.length>m?(r.insertBefore(v,h[parseInt(m.toString(),10)]),++u):(r.insertBefore(v,r.children[h.length]),++u):v.classList.contains(Nt)||e.tbResize&&v.classList.contains(lo)&&r.children.length>0&&h.length===0?(r.insertBefore(v,r.firstChild),++u):v.classList.contains(lo)?i.push(v):e.tbResize?(r.insertBefore(v,r.childNodes[p+u]),++p):r.appendChild(v),v.classList.contains(Ee)?de(v,{display:"",height:a+"px"}):de(v,{display:"",height:o+"px"})}),i.forEach(function(v){r.appendChild(v)});for(var c=me("."+Oe,n.querySelector("."+we)),f=c.length-1;f>=0;f--){var g=c[parseInt(f.toString(),10)];if(g.classList.contains(Ee)&&this.overflowMode!=="Extended")de(g,{display:"none"});else break}},t.prototype.createPopup=function(){var e=this.element,i,r;this.overflowMode==="Extended"&&(r=e.querySelector("."+Ee),i=e.style.height==="auto"||e.style.height===""?null:r&&r.offsetHeight);var o=e.querySelector("."+Oe+":not(."+Ee+"):not(."+ii+")"),a=e.style.height==="auto"||e.style.height===""?null:o&&o.offsetHeight,n,s=[];if(te("#"+e.id+"_popup."+ur,e))n=te("#"+e.id+"_popup."+ur,e);else{var h=this.createElement("div",{id:e.id+"_popup",className:ur+" "+ho}),p=this.createElement("div",{id:e.id+"_popup",className:ur});n=this.overflowMode==="Extended"?h:p}this.pushingPoppedEle(this,s,n,a,i),this.popupInit(e,n)},t.prototype.getElementOffsetY=function(){return this.overflowMode==="Extended"&&window.getComputedStyle(this.element).getPropertyValue("box-sizing")==="border-box"?this.element.clientHeight:this.element.offsetHeight},t.prototype.popupInit=function(e,i){if(this.popObj){if(this.overflowMode!=="Extended"){var a=this.popObj.element;de(a,{maxHeight:"",display:"block"}),de(a,{maxHeight:a.offsetHeight+"px",display:""})}}else{e.appendChild(i),this.cssClass&&W([i],this.cssClass.split(" ")),de(this.element,{overflow:""});var r=new Or(null,{relateTo:this.element,offsetY:this.isVertical?0:this.getElementOffsetY(),enableRtl:this.enableRtl,open:this.popupOpen.bind(this),close:this.popupClose.bind(this),collision:{Y:this.enableCollision?"flip":"none"},position:this.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"}});if(this.overflowMode==="Extended"&&(r.width=this.getToolbarPopupWidth(this.element),r.offsetX=0),r.appendTo(i),document.addEventListener("scroll",this.clickEvent),document.addEventListener("click",this.scrollEvent),this.overflowMode!=="Extended"&&(r.element.style.maxHeight=r.element.offsetHeight+"px"),this.isVertical&&(r.element.style.visibility="hidden"),this.isExtendedOpen){var o=this.element.querySelector("."+nt);o.classList.add(cr),lt(o.firstElementChild,[so],[pr]),this.element.querySelector("."+ho).classList.add(xl)}else r.hide();this.popObj=r}},t.prototype.tbarPopupHandler=function(e){this.overflowMode==="Extended"&&(e?this.add(this.element,Ea):this.remove(this.element,Ea))},t.prototype.popupOpen=function(e){var i=this.popObj;this.isVertical||(i.offsetY=this.getElementOffsetY(),i.dataBind());var r=this.popObj.element,o=this.popObj.element.parentElement,a=o.querySelector("."+nt);a.setAttribute("aria-expanded","true"),this.overflowMode==="Extended"?i.element.style.minHeight="":(de(i.element,{height:"auto",maxHeight:""}),i.element.style.maxHeight=i.element.offsetHeight+"px");var n=r.offsetTop+r.offsetHeight+at(o).top,s=a.firstElementChild;a.classList.add(cr),lt(s,[so],[pr]),this.tbarPopupHandler(!0);var h=d(window.scrollY)?0:window.scrollY;if(!this.isVertical&&window.innerHeight+h<n&&this.element.offsetTop<r.offsetHeight){var p=r.offsetHeight-(n-window.innerHeight-h+5);i.height=p+"px";for(var u=0;u<=r.childElementCount;u++){var c=r.children[parseInt(u.toString(),10)];if(c.offsetTop+c.offsetHeight>p){p=c.offsetTop;break}}this.overflowMode!=="Extended"&&de(i.element,{maxHeight:p+"px"})}else if(this.isVertical&&this.overflowMode!=="Extended"){var f=this.element.getBoundingClientRect();de(i.element,{maxHeight:f.top+this.element.offsetHeight+"px",bottom:0,visibility:""})}if(i){var g=r.getBoundingClientRect();g.right>document.documentElement.clientWidth&&g.width>o.getBoundingClientRect().width&&(i.collision={Y:"none"},i.dataBind()),i.refreshPosition()}},t.prototype.popupClose=function(e){var i=this.element,r=i.querySelector("."+nt);r.setAttribute("aria-expanded","false");var o=r.firstElementChild;r.classList.remove(cr),lt(o,[pr],[so]),this.tbarPopupHandler(!1)},t.prototype.checkPriority=function(e,i,r,o){for(var a=this.popupPriCount>0,n=i.length,s=r,h,p,u=0,c=0,f=0,g=function(x,D){var A=!1;return D.forEach(function(P){x.classList.contains(P)&&(A=!0)}),A},v=n-1;v>=0;v--){var m=void 0,C=window.getComputedStyle(i[parseInt(v.toString(),10)]);this.isVertical?(m=parseFloat(C.marginTop),m+=parseFloat(C.marginBottom)):(m=parseFloat(C.marginRight),m+=parseFloat(C.marginLeft));var M=i[parseInt(v.toString(),10)]===this.tbarEle[0];M&&(this.tbarEleMrgn=m),h=this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth;var I=M?h+m:h;if(g(i[parseInt(v.toString(),10)],[Aa])&&a&&(i[parseInt(v.toString(),10)].classList.add(ii),this.isVertical?de(i[parseInt(v.toString(),10)],{display:"none",minHeight:I+"px"}):de(i[parseInt(v.toString(),10)],{display:"none",minWidth:I+"px"}),f++),this.isVertical?p=i[parseInt(v.toString(),10)].offsetTop+i[parseInt(v.toString(),10)].offsetHeight+m>r:p=i[parseInt(v.toString(),10)].offsetLeft+i[parseInt(v.toString(),10)].offsetWidth+m>r,p){if(i[parseInt(v.toString(),10)].classList.contains(Ee)){if(this.overflowMode==="Extended"){var N=i[parseInt(v.toString(),10)];g(N,[Ee,dr])&&(i[parseInt(v.toString(),10)].classList.add(ii),f++),c++}else if(this.overflowMode==="Popup"){if(u>0&&c===f){var N=i[v+c+(u-1)];g(N,[Ee,dr])&&de(N,{display:"none"})}u++,c=0,f=0}}else c++;i[parseInt(v.toString(),10)].classList.contains(Nt)&&o?r-=(this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth)+m:g(i[parseInt(v.toString(),10)],[Ee,dr])?r-=(this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth)+m:(i[parseInt(v.toString(),10)].classList.add(ii),this.isVertical?de(i[parseInt(v.toString(),10)],{display:"none",minHeight:I+"px"}):de(i[parseInt(v.toString(),10)],{display:"none",minWidth:I+"px"}),f++)}}if(o){var O=me("."+Oe+":not(."+ii+")",this.element);this.checkPriority(e,O,s,!1)}},t.prototype.createPopupIcon=function(e){var i=e.id.concat("_nav"),r="e-"+e.id.concat("_nav "+jy);r=this.overflowMode==="Extended"?r+" "+Ty:r;var o=this.createElement("div",{id:i,className:r});(S.info.name==="msie"||S.info.name==="edge")&&o.classList.add("e-ie-align");var a=this.createElement("div",{className:pr+" e-icons"});o.appendChild(a),o.setAttribute("tabindex","0"),o.setAttribute("role","button"),e.appendChild(o)},t.prototype.tbarPriRef=function(e,i,r,o,a,n,s,h,p){var u=h,c=this.popObj.element,f="."+Oe+":not(."+Ee+"):not(."+Nt+")",g=me("."+ii+":not(."+Nt+")",c).length,v=function(N,O){return N.classList.contains(O)};if(me(f,e).length===0){var m=e.children[i-(i-r)-1],C=!d(m)&&v(m,dr);if(!d(m)&&v(m,Ee)&&!st(m)||C){m.style.display="unset";var M=m.offsetWidth+parseFloat(window.getComputedStyle(m).marginRight)*2,I=m.previousElementSibling;n+M<s||a?(e.insertBefore(o,e.children[i+u-(i-r)]),d(I)||(I.style.display="")):(de(o,p),I.classList.contains(Ee)&&(I.style.display="none")),m.style.display=""}else e.insertBefore(o,e.children[i+u-(i-r)])}else e.insertBefore(o,e.children[i+u-g])},t.prototype.popupRefresh=function(e,i){var r=this,o=this.element,a=this.isVertical,n=o.querySelector("."+we),s=o.querySelector("."+nt);if(!d(s)){n.removeAttribute("style"),e.style.display="block";var h;a?h=o.offsetHeight-(s.offsetHeight+n.offsetHeight):h=o.offsetWidth-(s.offsetWidth+n.offsetWidth);var p=0;[].slice.call(e.children).forEach(function(u){p+=r.popupEleWidth(u),de(u,{position:""})}),h+(a?s.offsetHeight:s.offsetWidth)>p&&this.popupPriCount===0&&(i=!0),this.popupEleRefresh(h,e,i),e.style.display="",e.children.length===0&&s&&this.popObj&&(X(s),s=null,this.popObj.destroy(),X(this.popObj.element),this.popObj=null)}},t.prototype.ignoreEleFetch=function(e,i){var r=[].slice.call(i.querySelectorAll("."+dr)),o=[],a=0;if(r.length>0)r.forEach(function(n){o.push([].slice.call(i.children).indexOf(n))});else return 0;return o.forEach(function(n){n<=e&&a++}),a},t.prototype.checkPopupRefresh=function(e,i){i.style.display="block";var r=this.popupEleWidth(i.firstElementChild);i.firstElementChild.style.removeProperty("Position");var o=e.offsetWidth-e.querySelector("."+nt).offsetWidth,a=e.querySelector("."+we).offsetWidth;return i.style.removeProperty("display"),o>r+a},t.prototype.popupEleWidth=function(e){e.style.position="absolute";var i=this.isVertical?e.offsetHeight:e.offsetWidth,r=e.querySelector("."+Iy);if(e.classList.contains("e-tbtn-align")||e.classList.contains(Oa)){var o=e.children[0];!d(r)&&e.classList.contains(Oa)?r.style.display="none":!d(r)&&e.classList.contains(zl)&&(r.style.display="block"),o.style.minWidth="0%",i=parseFloat(this.isVertical?e.style.minHeight:e.style.minWidth),o.style.minWidth="",o.style.minHeight="",d(r)||(r.style.display="")}return i},t.prototype.popupEleRefresh=function(e,i,r){for(var o=this.popupPriCount>0,a=this.tbarEle,n,s,h=this.element.querySelector("."+we),p=0,u=function(M){if(M.classList.contains(Aa)&&o&&!r)return"continue";var I=c.popupEleWidth(M);if(M===c.tbarEle[0]&&(I+=c.tbarEleMrgn),M.style.position="",I<e||r){var N={minWidth:M.style.minWidth,height:M.style.height,minHeight:M.style.minHeight};if(de(M,{minWidth:"",height:"",minHeight:""}),M.classList.contains(lo)||M.classList.remove(ii),s=c.tbarEle.indexOf(M),c.tbarAlign){var O=c.items[parseInt(s.toString(),10)].align;s=c.tbarAlgEle[(O+"s").toLowerCase()].indexOf(M),a=c.tbarAlgEle[(O+"s").toLowerCase()],h=c.element.querySelector("."+we+" .e-toolbar-"+O.toLowerCase())}var x=0;c.overflowMode!=="Extended"&&a.slice(0,s).forEach(function(D){(D.classList.contains(Nt)||D.classList.contains(Ee))&&(D.classList.contains(Ee)&&(D.style.display="",e-=D.offsetWidth),x++)}),p=c.ignoreEleFetch(s,h),M.classList.contains(Nt)?(c.tbarPriRef(h,s,x,M,r,I,e,p,N),e-=M.offsetWidth):s===0?(h.insertBefore(M,h.firstChild),e-=M.offsetWidth):(n=me("."+Nt,c.popObj.element).length,h.insertBefore(M,h.children[s+p-n]),e-=M.offsetWidth),M.style.height=""}else return"break"},c=this,f=0,g=[].slice.call(i.children);f<g.length;f++){var v=g[f],m=u(v);if(m==="break")break}var C=this.checkOverflow(this.element,this.element.getElementsByClassName(we)[0]);C&&!r&&this.renderOverflowMode()},t.prototype.removePositioning=function(){var e=this.element.querySelector("."+we);if(!(d(e)||!e.classList.contains(Dt))){this.remove(e,Dt);var i=[].slice.call(e.childNodes);i[1].removeAttribute("style"),i[2].removeAttribute("style")}},t.prototype.refreshPositioning=function(){var e=this.element.querySelector("."+we);this.add(e,Dt),this.itemPositioning()},t.prototype.itemPositioning=function(){var e=this.element.querySelector("."+we),i;if(!(d(e)||!e.classList.contains(Dt))){var r=this.element.querySelector("."+nt),o;if(this.scrollModule){var a=this.isVertical?by:My;o=[].slice.call(e.querySelector("."+a).children)}else o=[].slice.call(e.childNodes);this.isVertical?i=o[0].offsetHeight+o[2].offsetHeight:i=o[0].offsetWidth+o[2].offsetWidth;var n=this.isVertical?this.element.offsetHeight:this.element.offsetWidth;if(r){n-=this.isVertical?r.offsetHeight:r.offsetWidth;var s=(this.isVertical?r.offsetHeight:r.offsetWidth)+"px";o[2].removeAttribute("style"),this.isVertical?this.enableRtl?o[2].style.top=s:o[2].style.bottom=s:this.enableRtl?o[2].style.left=s:o[2].style.right=s}if(!(n<=i)){var h=(n-i-(this.isVertical?o[1].offsetHeight:o[1].offsetWidth))/2;o[1].removeAttribute("style");var p=(this.isVertical?o[0].offsetHeight:o[0].offsetWidth)+h+"px";this.isVertical?this.enableRtl?o[1].style.marginBottom=p:o[1].style.marginTop=p:this.enableRtl?o[1].style.marginRight=p:o[1].style.marginLeft=p}}},t.prototype.tbarItemAlign=function(e,i,r){var o=this;if(!(e.showAlwaysInPopup&&e.overflow!=="Show")){var a=[];if(a.push(this.createElement("div",{className:Cy,attrs:{role:"group"}})),a.push(this.createElement("div",{className:El,attrs:{role:"group"}})),a.push(this.createElement("div",{className:my,attrs:{role:"group"}})),r===0&&e.align!=="Left")a.forEach(function(h){i.appendChild(h)}),this.tbarAlign=!0,this.add(i,Dt);else if(e.align!=="Left"){var n=i.childNodes,s=a[0];[].slice.call(n).forEach(function(h){o.tbarAlgEle.lefts.push(h),s.appendChild(h)}),i.appendChild(s),i.appendChild(a[1]),i.appendChild(a[2]),this.tbarAlign=!0,this.add(i,Dt)}}},t.prototype.ctrlTemplate=function(){var e=this;this.ctrlTem=this.trgtEle.cloneNode(!0),this.add(this.trgtEle,we),this.tbarEle=[];var i=[].slice.call(this.trgtEle.children);i.forEach(function(r){r.tagName==="DIV"&&(e.tbarEle.push(r),d(r.firstElementChild)||r.firstElementChild.setAttribute("aria-disabled","false"),e.add(r,Oe))})},t.prototype.renderItems=function(){var e=this.element,i=this.items;if(this.trgtEle!=null)this.ctrlTemplate();else if(e&&i.length>0){var r=void 0;e&&e.children.length>0&&(r=e.querySelector("."+we)),r||(r=this.createElement("div",{className:we})),this.itemsAlign(i,r),e.appendChild(r)}},t.prototype.setAttr=function(e,i){for(var r=Object.keys(e),o,a=0;a<r.length;a++)o=r[parseInt(a.toString(),10)],o==="class"?this.add(i,e[""+o]):i.setAttribute(o,e[""+o])},t.prototype.enableItems=function(e,i){var r=this,o=e,a=o.length,n;d(i)&&(i=!0);var s=function(c,f){c?(f.classList.remove(tt),d(f.firstElementChild)||(f.firstElementChild.setAttribute("aria-disabled","false"),r.updateTabIndex("0"))):(f.classList.add(tt),d(f.firstElementChild)||(f.firstElementChild.setAttribute("aria-disabled","true"),f.firstElementChild.setAttribute("tabindex","-1"),r.updateTabIndex("0")))};if(!d(a)&&a>=1){for(var h=0,p=[].slice.call(o);h<a;h++){var u=p[parseInt(h.toString(),10)];if(typeof u=="number"){if(n=this.getElementByIndex(u),d(n))return;o[parseInt(h.toString(),10)]=n}else n=u;s(i,n)}i?G(o,tt):W(o,tt)}else{if(typeof o=="number"){if(n=this.getElementByIndex(o),d(n))return}else n=e;s(i,n)}},t.prototype.getElementByIndex=function(e){return this.tbarEle[parseInt(e.toString(),10)]?this.tbarEle[parseInt(e.toString(),10)]:null},t.prototype.addItems=function(e,i){var r;this.extendedOpen();var o=this.element.querySelector("."+we);if(d(o)){this.itemsRerender(e);return}var a,n="Left";d(i)&&(i=0),e.forEach(function(f){!d(f.align)&&f.align!=="Left"&&n==="Left"&&(n=f.align)});for(var s=0,h=e;s<h.length;s++){var p=h[s];if(d(p.type)&&(p.type="Button"),r=me("."+Oe,this.element),p.align=n,a=this.renderSubComponent(p,i),this.tbarEle.length>=i&&r.length>=0){d(this.scrollModule)&&this.destroyMode();var u=p.align[0]==="L"?0:p.align[0]==="C"?1:2,c=void 0;!this.tbarAlign&&n!=="Left"?(this.tbarItemAlign(p,o,1),this.tbarAlign=!0,c=ce(r[0],"."+we).children[parseInt(u.toString(),10)],c.appendChild(a),this.tbarAlgEle[(p.align+"s").toLowerCase()].push(a),this.refreshPositioning()):this.tbarAlign?(c=ce(r[0],"."+we).children[parseInt(u.toString(),10)],c.insertBefore(a,c.children[parseInt(i.toString(),10)]),this.tbarAlgEle[(p.align+"s").toLowerCase()].splice(i,0,a),this.refreshPositioning()):r.length===0?(r=me("."+we,this.element),r[0].appendChild(a)):r[0].parentNode.insertBefore(a,r[parseInt(i.toString(),10)]),this.items.splice(i,0,p),p.template&&this.tbarEle.splice(this.tbarEle.length-1,1),this.tbarEle.splice(i,0,a),i++,this.offsetWid=o.offsetWidth}}o.style.width="",this.renderOverflowMode(),this.isReact&&this.renderReactTemplates()},t.prototype.removeItems=function(e){var i=e,r,o=[].slice.call(me("."+Oe,this.element));if(typeof i=="number")r=parseInt(e.toString(),10),this.removeItemByIndex(r,o);else if(i&&i.length>1)for(var a=0,n=[].slice.call(i);a<n.length;a++){var s=n[a];r=this.tbarEle.indexOf(s),this.removeItemByIndex(r,o),o=me("."+Oe,this.element)}else{var s=i&&i.length&&i.length===1?i[0]:e;r=o.indexOf(s),this.removeItemByIndex(r,o)}this.resize()},t.prototype.removeItemByIndex=function(e,i){if(this.tbarEle[parseInt(e.toString(),10)]&&i[parseInt(e.toString(),10)]){var r=this.tbarEle.indexOf(i[parseInt(e.toString(),10)]);if(this.tbarAlign){var o=this.tbarAlgEle[(this.items[parseInt(r.toString(),10)].align+"s").toLowerCase()].indexOf(this.tbarEle[parseInt(r.toString(),10)]);this.tbarAlgEle[(this.items[parseInt(r.toString(),10)].align+"s").toLowerCase()].splice(parseInt(o.toString(),10),1)}this.isReact&&this.clearToolbarTemplate(i[parseInt(e.toString(),10)]);var a=i[parseInt(e.toString(),10)].querySelector(".e-control.e-btn");!d(a)&&!d(a.ej2_instances[0])&&!a.ej2_instances[0].isDestroyed&&a.ej2_instances[0].destroy(),X(i[parseInt(e.toString(),10)]),this.items.splice(r,1),this.tbarEle.splice(r,1)}},t.prototype.templateRender=function(e,i,r,o){var a=r.type,n=e,s;if(typeof e=="object"&&(s=typeof n.appendTo=="function"),typeof e=="string"||!s){var h=void 0,p=e,u=new RegExp(/<(?=.*? .*?\/ ?>|br|hr|input|!--|wbr)[a-z]+.*?>|<([a-z]+).*?<\/\1>/i);p=typeof e=="string"?e.trim():e;try{if(typeof e=="object"&&!d(e.tagName))i.appendChild(e);else if(typeof e=="string"&&u.test(p))i.innerHTML=p;else if(document.querySelectorAll(p).length){var c=document.querySelector(p),f=c.outerHTML.trim();i.appendChild(c),c.style.display="",d(f)||this.tempId.push(p)}else h=ht(p)}catch{h=ht(p)}var g=void 0;if(!d(h)){var v=this.element.id+o+"_template";g=h({},this,"template",v,this.isStringTemplate,void 0,void 0,this.root)}!d(g)&&g.length>0&&[].slice.call(g).forEach(function(C){d(C.tagName)||(C.style.display=""),i.appendChild(C)})}else if(a==="Input"){var c=this.createElement("input");r.id?c.id=r.id:c.id=Ve("tbr-ipt"),i.appendChild(c),n.appendTo(c)}this.add(i,Al);var m=i.firstElementChild;d(m)||(m.setAttribute("tabindex",d(m.getAttribute("tabIndex"))?"-1":this.getDataTabindex(m)),m.setAttribute("data-tabindex",d(m.getAttribute("tabIndex"))?"-1":this.getDataTabindex(m))),this.tbarEle.push(i)},t.prototype.buttonRendering=function(e,i){var r=this.createElement("button",{className:yy});r.setAttribute("type","button");var o=e.text,a,n;e.id?r.id=e.id:r.id=Ve("e-tbr-btn");var s=this.createElement("span",{className:"e-tbar-btn-text"});o?(s.innerHTML=this.enableHtmlSanitizer?pt.sanitize(o):o,r.appendChild(s),r.classList.add("e-tbtn-txt")):this.add(i,"e-tbtn-align"),(e.prefixIcon||e.suffixIcon)&&(e.prefixIcon&&e.suffixIcon||e.prefixIcon?(a=e.prefixIcon+" e-icons",n="Left"):(a=e.suffixIcon+" e-icons",n="Right"));var h=new Xi({iconCss:a,iconPosition:n});return h.createElement=this.createElement,h.appendTo(r),e.width&&de(r,{width:ee(e.width)}),r},t.prototype.renderSubComponent=function(e,i){var r,o=this.createElement("div",{className:Oe}),a=this.createElement("div",{innerHTML:this.enableHtmlSanitizer&&!d(e.tooltipText)?pt.sanitize(e.tooltipText):e.tooltipText});if(this.tbarEle||(this.tbarEle=[]),e.htmlAttributes&&this.setAttr(e.htmlAttributes,o),e.tooltipText&&o.setAttribute("title",a.textContent),e.cssClass&&(o.className=o.className+" "+e.cssClass),e.template)this.templateRender(e.template,o,e,i);else switch(e.type){case"Button":r=this.buttonRendering(e,o),r.setAttribute("tabindex",d(e.tabIndex)?"-1":e.tabIndex.toString()),r.setAttribute("data-tabindex",d(e.tabIndex)?"-1":e.tabIndex.toString()),r.setAttribute("aria-label",e.text||e.tooltipText),r.setAttribute("aria-disabled","false"),o.appendChild(r),o.addEventListener("click",this.itemClick.bind(this));break;case"Separator":this.add(o,Ee);break}if(e.showTextOn){var n=e.showTextOn;n==="Toolbar"?(this.add(o,zl),this.add(o,"e-tbtn-align")):n==="Overflow"&&this.add(o,Oa)}if(e.overflow){var s=e.overflow;s==="Show"?this.add(o,Nt):s==="Hide"&&(o.classList.contains(Ee)||this.add(o,lo))}return e.overflow!=="Show"&&e.showAlwaysInPopup&&!o.classList.contains(Ee)&&(this.add(o,Aa),this.popupPriCount++),e.disabled&&this.add(o,tt),e.visible===!1&&this.add(o,Ut),o},t.prototype.getDataTabindex=function(e){return d(e.getAttribute("data-tabindex"))?"-1":e.getAttribute("data-tabindex")},t.prototype.itemClick=function(e){this.activeEleSwitch(e.currentTarget)},t.prototype.activeEleSwitch=function(e){this.activeEleRemove(e.firstElementChild),this.activeEle.focus()},t.prototype.activeEleRemove=function(e){var i=this.element.querySelector("."+Oe+":not(."+tt+" ):not(."+Ee+" ):not(."+Ut+" )");if(d(this.activeEle)||(this.activeEle.setAttribute("tabindex",this.getDataTabindex(this.activeEle)),i&&i.removeAttribute("tabindex"),i=this.activeEle),this.activeEle=e,this.getDataTabindex(this.activeEle)==="-1")if(d(this.trgtEle)&&!e.parentElement.classList.contains(Al)){if(!d(this.element.querySelector(".e-hor-nav"))&&this.element.querySelector(".e-hor-nav").classList.contains("e-nav-active")){this.updateTabIndex("0");var r=this.getDataTabindex(i)==="-1"?"0":this.getDataTabindex(i);i.setAttribute("tabindex",r)}else this.updateTabIndex("-1");e.removeAttribute("tabindex")}else{var o=parseInt(this.getDataTabindex(this.activeEle),10)+1;this.activeEle.setAttribute("tabindex",o.toString())}},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.getModuleName=function(){return"toolbar"},t.prototype.itemsRerender=function(e){this.items=this.tbarItemsCol,(this.isReact||this.isAngular)&&this.clearTemplate(),this.destroyMode(),this.destroyItems(),this.items=e,this.tbarItemsCol=this.items,this.renderItems(),this.renderOverflowMode(),this.isReact&&this.renderReactTemplates()},t.prototype.resize=function(){var e=this.element;this.tbResize=!0,this.tbarAlign&&this.itemPositioning(),this.popObj&&this.overflowMode==="Popup"&&this.popObj.hide();var i=this.checkOverflow(e,e.getElementsByClassName(we)[0]);if(!i){this.destroyScroll();var r=e.querySelector("."+we);d(r)||(this.remove(r,kl),this.tbarAlign&&this.add(r,Dt))}i&&this.scrollModule&&this.offsetWid===e.offsetWidth||((this.offsetWid>e.offsetWidth||i)&&this.renderOverflowMode(),this.popObj&&(this.overflowMode==="Extended"&&(this.popObj.width=this.getToolbarPopupWidth(this.element)),this.tbarAlign&&this.removePositioning(),this.popupRefresh(this.popObj.element,!1),this.tbarAlign&&this.refreshPositioning()),this.element.querySelector("."+xa)&&(this.scrollStep=this.element.querySelector("."+xa).offsetWidth),this.offsetWid=e.offsetWidth,this.tbResize=!1,this.separator())},t.prototype.orientationChange=function(){var e=this;setTimeout(function(){e.resize()},500)},t.prototype.extendedOpen=function(){var e=this.element.querySelector("."+ho);this.overflowMode==="Extended"&&e&&(this.isExtendedOpen=e.classList.contains(xl))},t.prototype.updateHideEleTabIndex=function(e,i,r,o,a){r&&(o=a.indexOf(e));for(var n=a[++o];n;){var s=this.eleContains(n);if(!s){var h=n.firstElementChild.getAttribute("data-tabindex");i&&h==="-1"?n.firstElementChild.setAttribute("tabindex","0"):h!==n.firstElementChild.getAttribute("tabindex")&&n.firstElementChild.setAttribute("tabindex",h);break}n=a[++o]}},t.prototype.clearToolbarTemplate=function(e){if(this.registeredTemplate&&this.registeredTemplate.template)for(var i=this.registeredTemplate,r=0;r<i.template.length;r++){var o=i.template[parseInt(r.toString(),10)].rootNodes[0],a=ce(o,"."+Oe);if(!d(a)&&a===e){this.clearTemplate(["template"],[i.template[parseInt(r.toString(),10)]]);break}}else if(this.portals&&this.portals.length>0)for(var n=this.portals,r=0;r<n.length;r++){var s=n[parseInt(r.toString(),10)],a=ce(s.containerInfo,"."+Oe);if(!d(a)&&a===e){this.clearTemplate(["template"],r);break}}},t.prototype.onPropertyChanged=function(e,i){var r=this.element;this.extendedOpen();for(var o=0,a=Object.keys(e);o<a.length;o++){var n=a[o];switch(n){case"items":if(e.items instanceof Array&&i.items instanceof Array)this.itemsRerender(e.items);else for(var s=Object.keys(e.items),h=0;h<s.length;h++){var p=parseInt(Object.keys(e.items)[parseInt(h.toString(),10)],10),u=Object.keys(e.items[parseInt(p.toString(),10)])[0],c=Object(e.items[parseInt(p.toString(),10)])[""+u];if(this.tbarAlign||u==="align"){this.refresh(),this.trigger("created");break}var f=u==="showAlwaysInPopup"&&!c,g=u==="overflow"&&this.popupPriCount!==0;(f||this.items[parseInt(p.toString(),10)].showAlwaysInPopup&&g)&&--this.popupPriCount,d(this.scrollModule)&&this.destroyMode();var v=[].slice.call(me("."+we+" ."+Oe,r));this.isReact&&this.items[parseInt(p.toString(),10)].template&&this.clearToolbarTemplate(v[parseInt(p.toString(),10)]),X(v[parseInt(p.toString(),10)]),this.tbarEle.splice(p,1),this.addItems([this.items[parseInt(p.toString(),10)]],p),this.items.splice(p,1),this.items[parseInt(p.toString(),10)].template&&this.tbarEle.splice(this.items.length,1)}break;case"width":de(r,{width:ee(e.width)}),this.refreshOverflow();break;case"height":de(this.element,{height:ee(e.height)});break;case"overflowMode":this.destroyMode(),this.renderOverflowMode(),this.enableRtl&&this.add(r,Ft),this.refreshOverflow();break;case"enableRtl":e.enableRtl?this.add(r,Ft):this.remove(r,Ft),d(this.scrollModule)||(e.enableRtl?this.add(this.scrollModule.element,Ft):this.remove(this.scrollModule.element,Ft)),d(this.popObj)||(e.enableRtl?this.add(this.popObj.element,Ft):this.remove(this.popObj.element,Ft)),this.tbarAlign&&this.itemPositioning();break;case"scrollStep":this.scrollModule&&(this.scrollModule.scrollStep=this.scrollStep);break;case"enableCollision":this.popObj&&(this.popObj.collision={Y:this.enableCollision?"flip":"none"});break;case"cssClass":i.cssClass&&G([this.element],i.cssClass.split(" ")),e.cssClass&&W([this.element],e.cssClass.split(" "));break;case"allowKeyboard":this.unwireKeyboardEvent(),e.allowKeyboard&&this.wireKeyboardEvent();break}}},t.prototype.hideItem=function(e,i){var r=typeof e=="object",o=e,a;if(!(!r&&d(o))){var n=[].slice.call(me("."+Oe,this.element));if(r)a=e;else if(this.tbarEle[parseInt(o.toString(),10)]){var s=[].slice.call(me("."+Oe,this.element));a=s[parseInt(o.toString(),10)]}a&&(i?(a.classList.add(Ut),a.classList.contains(Ee)||(d(a.firstElementChild.getAttribute("tabindex"))||a.firstElementChild.getAttribute("tabindex")!=="-1")&&this.updateHideEleTabIndex(a,i,r,o,n)):(a.classList.remove(Ut),a.classList.contains(Ee)||this.updateHideEleTabIndex(a,i,r,o,n)),this.refreshOverflow())}},je([qi([],Sy)],t.prototype,"items",void 0),je([T("auto")],t.prototype,"width",void 0),je([T("auto")],t.prototype,"height",void 0),je([T("")],t.prototype,"cssClass",void 0),je([T("Scrollable")],t.prototype,"overflowMode",void 0),je([T()],t.prototype,"scrollStep",void 0),je([T(!0)],t.prototype,"enableCollision",void 0),je([T(!0)],t.prototype,"enableHtmlSanitizer",void 0),je([T(!0)],t.prototype,"allowKeyboard",void 0),je([Y()],t.prototype,"clicked",void 0),je([Y()],t.prototype,"created",void 0),je([Y()],t.prototype,"destroyed",void 0),je([Y()],t.prototype,"beforeCreate",void 0),t=je([Qe],t),t}(ct),Ny=function(){function l(t){this.defToolbarItems=[],this.toolbarHeight=46,this.currToolbar="",this.preventZoomBtn=!1,this.currentToolbar="main",this.selFhdColor="#42a5f5",this.preventEnableDisableUr=!1,this.isAspectRatio=!0,this.isFrameToolbar=!1,this.presetColors={custom:["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},this.isSlider=!1,this.currentQuality=1,this.imageQuality="highest",this.parent=t,this.addEventListener(),this.initLocale()}return l.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},l.prototype.addEventListener=function(){this.parent.on("toolbar",this.toolbar,this),this.parent.on("destroyed",this.destroy,this)},l.prototype.removeEventListener=function(){this.parent.off("toolbar",this.toolbar),this.parent.off("destroyed",this.destroy)},l.prototype.initLocale=function(){this.defaultLocale={Crop:"Crop",ZoomIn:"Zoom In",ZoomOut:"Zoom Out",Undo:"Undo",Redo:"Redo",Transform:"Transform",Annotation:"Annotation",Finetune:"Finetune",Brightness:"Brightness",Contrast:"Contrast",Hue:"Hue",Saturation:"Saturation",Opacity:"Opacity",Blur:"Blur",Sharpen:"Sharpen",Exposure:"Exposure",Filter:"Filter",Default:"Default",Chrome:"Chrome",Cold:"Cold",Warm:"Warm",Grayscale:"Grayscale",BlackAndWhite:"Black and White",Sepia:"Sepia",Invert:"Invert",Text:"Add Text",Pen:"Pen",Reset:"Reset",Save:"Save",Select:"Select",RotateLeft:"Rotate Left",RotateRight:"Rotate Right",HorizontalFlip:"Horizontal Flip",VerticalFlip:"Vertical Flip",OK:"Apply",Cancel:"Discard",FillColor:"Fill Color",StrokeColor:"Stroke Color",StrokeWidth:"Stroke Width",FontFamily:"Font Family",FontStyle:"Font Style",FontSize:"Font Size",FontColor:"Font Color",Pan:"Pan",Move:"Move",Load:"Load",Custom:"Custom",Square:"Square",Circle:"Circle",Ellipse:"Ellipse",Rectangle:"Rectangle",Line:"Line",Arrow:"Arrow",Path:"Path",Bold:"Bold",Italic:"Italic",BoldItalic:"Bold Italic",XSmall:"X-Small",Small:"Small",Medium:"Medium",Large:"Large",XLarge:"X-Large",ABC:"ABC",Browse:"Browse",Duplicate:"Duplicate",Remove:"Remove",EditText:"Edit Text",Start:"Start",End:"End",Bar:"Bar",ArrowSolid:"Arrow Solid",CircleSolid:"Circle Solid",SquareSolid:"Square Solid",None:"None",CropAndTransform:"Crop and Transform",CropSelection:"Crop Selection",Image:"Add Image",Transparency:"Transparency",Height:"Height",Width:"Width",AspectRatio:"Maintain aspect ratio",W:"W",H:"H",DragText:"Drag and drop your image here or",DropText:"Drop your image here or",BrowseText:"Browse here...",SupportText:"Supports:",Frame:"Frame",Mat:"Mat",Bevel:"Bevel",Inset:"Inset",Hook:"Hook",Color:"Color",Size:"Size",Offset:"Offset",Radius:"Radius",Amount:"Amount",Resize:"Resize",0:"0%",20:"20%",40:"40%",60:"60%",80:"80%",100:"100%",1:"1",2:"2",3:"3",4:"4",5:"5",Border:"Border",Solid:"Solid",Dashed:"Dashed",Dotted:"Dotted",GradientColor:"Gradient Color",ConfirmDialogHeader:"Confirm Save Changes",ConfirmDialogContent:"Do you want to save the changes you made to the image?",AlertDialogHeader:"Unsupported file",AlertDialogContent:"The selected file is unsupported.",MinMaxSize:"with file size between",MinMaxSizeAlert:"File size between",MinSize:"with minimum file size of",MinSizeAlert:"A minimum file size of",MaxSize:"with maximum file size of",MaxSizeAlert:"A maximum file size of",To:"to",Bytes:"bytes",Yes:"Yes",No:"No",ImageErrorDialogHeader:"Image Selection Error",ImageErrorDialogContent:"Please select only one image to open.",Straighten:"Straighten",NoOutline:"No outline",DlgOK:"OK",SaveAs:"Save As",ImageName:"Image name",Format:"Format",Quality:"Quality",Download:"Download",Close:"Close",ImageSize:"Image Size",QualityInfo:"The image quality option is only available for JPEG format",Good:"Good",Great:"Great",Highest:"Highest",BringForward:"Bring Forward",SendBackward:"Send Backward",SendToBack:"Send to Back",BringToFront:"Bring to Front",ZOrder:"Z-Order",Redact:"Redact",Pixelate:"Pixelate",BorderRadius:"Border Radius",TextOutlineColor:"Outline Color",TextOutlineWidth:"Outline Width",PixelSize:"Pixel Size",And:"and"},this.l10n=new Mi("image-editor",this.defaultLocale,this.parent.locale)},l.prototype.toolbar=function(t){var e=this.parent;switch(this.updatePrivateVariables(),t.prop){case"create-toolbar":this.createToolbar();break;case"create-contextual-toolbar":this.createContextualToolbar();break;case"update-toolbar-items":this.updateToolbarItems();break;case"refresh-toolbar":this.refreshToolbar(t.value.type,t.value.isApplyBtn,t.value.isCropping,t.value.isZooming,t.value.cType);break;case"renderQAT":this.renderQAT(t.value.isPenEdit);break;case"enable-disable-btns":this.enableDisableTbrBtn();break;case"init-main-toolbar":this.initMainToolbar(t.value.isApplyBtn,t.value.isDevice,t.value.isOkBtn,t.value.isResize,t.value.isFrame,t.value.isMainToolbar);break;case"create-bottom-toolbar":this.createBottomToolbar();break;case"refresh-main-toolbar":this.refreshMainToolbar();break;case"create-qa-toolbar":this.createQuickAccessToolbar();break;case"destroy-qa-toolbar":this.destroyQuickAccessToolbar();break;case"zoom-up-handler":this.zoomBtnMouseUpHandler();break;case"refresh-dropdown-btn":this.refreshDropDownBtn(t.value.isDisabled);break;case"close-contextual-toolbar":this.closeContextualToolbar();break;case"destroy-bottom-toolbar":this.destroyBottomToolbar();break;case"destroy-top-toolbar":this.destroyTopToolbar();break;case"destroySubComponents":this.destroySubComponents();break;case"setLocale":this.l10n.setLocale(t.value.locale);break;case"setPreventZoomBtn":this.preventZoomBtn=t.value.isPrevent;break;case"getToolbarHeight":t.value.obj.toolbarHeight=this.toolbarHeight;break;case"setToolbarHeight":(d(e.toolbar)||e.toolbar&&e.toolbar.length>0&&e.toolbar.indexOf("Open")>-1)&&(this.toolbarHeight=t.value.height);break;case"setCurrentToolbar":this.currentToolbar=t.value.type;break;case"setSelectedFreehandColor":this.selFhdColor=t.value.color;break;case"setInitialAdjustmentValue":e.initialAdjustmentValue=t.value.value;break;case"getCanvasFilter":t.value.obj.canvasFilter=e.canvasFilter;break;case"getDefToolbarItems":t.value.obj.defToolbarItems=this.defToolbarItems;break;case"getPenStroke":this.getPenStroke(t.value.value);break;case"performDefToolbarClickAction":this.performDefTbrClick(t.value.type,t.value.isContextualToolbar,t.value.isDisabledAdjustment,t.value.isDisabledFilter,t.value.isFilterFinetune);break;case"setTempFilterProperties":e.setTempFilterProperties();break;case"refreshSlider":this.refreshSlider();break;case"getCurrAdjustmentValue":e.getCurrAdjustmentValue(t.value.type);break;case"setCurrAdjustmentValue":e.setCurrAdjustmentValue(t.value.type,t.value.value);break;case"refreshShapeDrawing":this.refreshShapeDrawing();break;case"setEnableDisableUndoRedo":this.preventEnableDisableUr=t.value.isPrevent;break;case"reset":this.reset();break;case"getLocaleText":t.value.obj.value=this.l10n.getConstant(t.value.obj.key);break;case"initResizeToolbar":this.initResizeToolbar();break;case"getFrameToolbar":t.value.obj.bool=this.isFrameToolbar;break;case"resizeClick":this.resizeClick();break;case"frameToolbarClick":this.frameToolbarClick();break;case"performCropTransformClick":this.performCropTransformClick(t.value.shape,t.value.isTransform);break;case"duplicateShape":this.duplicateShape(t.value.isPreventUndoRedo,!0);break;case"editText":this.editText();break;case"setInitialSize":this.initialSize=Number(t.value.value);break;case"widthPress":this.widthPress(t.value.e);break;case"heightPress":this.heightPress(t.value.e);break;case"widthAspectRatio":this.widthAspectRatio(t.value.e);break;case"heightAspectRatio":this.heightAspectRatio(t.value.e);break;case"cancelPan":this.cancelPan();break;case"zoomInBtnMouseDownHandler":this.zoomInBtnMouseDownHandler(t.value.event);break;case"zoomOutBtnMouseDownHandler":this.zoomOutBtnMouseDownHandler(t.value.event);break;case"drawDashedLine":this.drawDashedLine(t.value.context);break;case"saveDialogClosed":this.saveDialogClosed(t.value.id);break;case"getIndex":this.getIndex(t.value.item);break;case"getRectRadius":this.getRectRadius(t.value.text);break;case"applyPreviewFilter":this.applyPreviewFilter();break;case"renderSlider":this.renderSlider(t.value.type,t.value.isSelect);break;case"zoomInBtnClickHandler":this.zoomInBtnClickHandler(t.value.e);break;case"zoomOutBtnClickHandler":this.zoomOutBtnClickHandler(t.value.e);break;case"getAdjustmentToolbarItem":this.getAdjustmentToolbarItem();break;case"getFilterToolbarItem":this.getFilterToolbarItem();break;case"renderCropBtn":this.renderCropBtn();break}},l.prototype.updatePrivateVariables=function(){var t=this.parent;this.inMemoryCanvas=t.inMemoryCanvas,t.lowerCanvas&&(this.lowerContext=t.lowerCanvas.getContext("2d")),t.upperCanvas&&(this.upperContext=t.upperCanvas.getContext("2d")),this.inMemoryCanvas&&(this.inMemoryContext=this.inMemoryCanvas.getContext("2d"))},l.prototype.reset=function(){var t=this.parent;this.toolbarHeight=46,t.prevCurrSelectionPoint=null,this.zoomBtnHold=null,this.currToolbar="",t.cxtTbarHeight=null,this.currentToolbar="main",this.selFhdColor="#42a5f5",t.currentFilter="",this.preventZoomBtn=t.isCropToolbar=this.preventEnableDisableUr=this.isFrameToolbar=!1,t.initialAdjustmentValue=t.canvasFilter="brightness(1) contrast(100%) hue-rotate(0deg) saturate(100%) opacity(1) blur(0px) sepia(0%) grayscale(0%) invert(0%)",t.tempStraighten=0,t.isStraightening=!1},l.prototype.destroyTopToolbar=function(){var t=this.parent,e=document.getElementById(t.element.id+"_toolbar");this.isToolbar()&&e&&e.classList.contains("e-control")&&Q(e,"toolbar").destroy()},l.prototype.destroyBottomToolbar=function(){var t=this.parent,e=document.getElementById(t.element.id+"_bottomToolbar");e&&e.classList.contains("e-control")&&Q(e,"toolbar").destroy()},l.prototype.isToolbar=function(){var t=this.parent;return d(t.toolbar)||t.toolbar&&t.toolbar.length>0||!d(t.toolbarTemplate)},l.prototype.createToolbar=function(){var t=this,e=this.parent,i=e.element.id;if(d(e.toolbar)||e.toolbar&&e.toolbar.length>0){e.element.appendChild(e.createElement("div",{id:i+"_toolbarArea",className:"e-toolbar-area"}));var r={cssClass:"e-image-upload",align:"Left",type:"Input",tooltipText:this.l10n.getConstant("Browse"),template:new Li({allowedExtensions:e.uploadSettings.allowedExtensions,multiple:!1})};d(this.defToolbarItems)&&(this.defToolbarItems=[]),this.defToolbarItems.push(r);var o=document.getElementById(i+"_toolbarArea"),a=e.createElement("div",{id:i+"_toolbar"});o.appendChild(a);var n=[{cssClass:"e-image-upload",align:"Left",type:"Input",tooltipText:this.l10n.getConstant("Browse"),template:new Li({allowedExtensions:e.uploadSettings.allowedExtensions,multiple:!1,selected:function(){var u=document.getElementById(i+"_toolbar"),c=document.getElementById(i+"_bottomToolbar");e.disabled||(S.isDevice?(t.defToolbarItems.length>0&&u&&Q(u,"toolbar").destroy(),c&&Q(c,"toolbar").destroy(),t.initMainToolbar(!1,S.isDevice,null),t.createBottomToolbar()):(t.defToolbarItems.length>0&&u&&Q(u,"toolbar").destroy(),t.initMainToolbar(!1,!1,null)))}})}],s=new dt({items:n,width:"100%",created:function(){e.trigger("toolbarCreated",{toolbarType:"main"})},clicked:this.defToolbarClicked.bind(this)});s.appendTo("#"+i+"_toolbar"),this.createLeftToolbarControls();var h=document.getElementById(i+"_toolbar");if(a&&(this.toolbarHeight=h.clientHeight,e.toolbar&&e.toolbar.length>0&&e.toolbar.indexOf("Open")===-1)){var p=Q(document.getElementById(e.element.id+"_toolbar"),"toolbar");p&&(p.destroy(),document.getElementById(e.element.id+"_toolbar").innerHTML="")}}else this.toolbarHeight=0},l.prototype.createContextualToolbar=function(){var t=this.parent,e=t.element.id;if(d(t.toolbar)||t.toolbar&&t.toolbar.length>0){var i=t.createElement("div",{id:e+"_contextualToolbarArea",className:"e-contextual-toolbar-wrapper e-hide"});i.style.position="absolute",t.element.appendChild(i);var r=document.getElementById(e+"_contextualToolbarArea"),o=t.createElement("div",{id:e+"_contextualToolbar"});r.appendChild(o)}},l.prototype.createBottomToolbar=function(){var t=this.parent,e=t.element.id;if(t.element.querySelector("#"+e+"_bottomToolbarArea")&&t.element.querySelector("#"+e+"_bottomToolbarArea").remove(),d(t.toolbar)||t.toolbar&&t.toolbar.length>0){if(t.element.appendChild(t.createElement("div",{id:e+"_bottomToolbarArea",className:"e-bottom-toolbar"})),!t.toolbarTemplate){var i=document.getElementById(e+"_bottomToolbarArea"),r=t.createElement("div",{id:e+"_bottomToolbar"});i.appendChild(r)}this.initBottomToolbar()}},l.prototype.createQuickAccessToolbar=function(){var t=this.parent,e=t.element.id;if(t.showQuickAccessToolbar){var i={cssClass:"e-image-upload",align:"Left",type:"Input",tooltipText:this.l10n.getConstant("Browse"),template:new Li({allowedExtensions:t.uploadSettings.allowedExtensions,multiple:!1})};d(this.defToolbarItems)&&(this.defToolbarItems=[]),this.defToolbarItems.push(i);var r=document.getElementById(e+"_quickAccessToolbarArea"),o=t.createElement("div",{id:e+"_quickAccessToolbar"});r.appendChild(o);var a=new dt({clicked:this.defToolbarClicked.bind(this)});a.appendTo("#"+e+"_quickAccessToolbar")}},l.prototype.initMainToolbar=function(t,e,i,r,o,a,n){var s=this,h=this.parent,p=h.element.id;if(this.isToolbar()){var u=this.getLeftToolbarItem(i,r),c=this.getRightToolbarItem(i,a,n),f=this.getMainToolbarItem(t,o,n),g=this.getZoomToolbarItem();e?o||n?this.defToolbarItems=f:this.defToolbarItems=u.concat(c):this.defToolbarItems=u.concat(f,c,g);var v={toolbarType:"main",toolbarItems:this.defToolbarItems};if(h.trigger("toolbarUpdating",v),this.defToolbarItems=v.toolbarItems,this.defToolbarItems.length>0){var m=new dt({width:"100%",items:this.defToolbarItems,clicked:this.defToolbarClicked.bind(this),created:function(){e||s.renderAnnotationBtn(),s.wireZoomBtnEvents(),h.trigger("toolbarCreated",{toolbarType:"main"})}});if(e&&o||e&&n?m.appendTo("#"+p+"_bottomToolbar"):m.appendTo("#"+p+"_toolbar"),this.createLeftToolbarControls(),this.enableDisableTbrBtn(),this.isToolbar()&&document.getElementById(p+"_toolbar")){var C=Q(p+"_toolbar","toolbar");C.refreshOverflow()}}}},l.prototype.initBottomToolbar=function(){var t=this,e=this.parent,i=e.element.id;if(d(e.toolbar)||e.toolbar&&e.toolbar.length>0){var r=this.getMainToolbarItem(),o={toolbarType:"bottom-toolbar",toolbarItems:r};e.trigger("toolbarUpdating",o),r=o.toolbarItems;var a=new dt({items:r,width:"100%",created:function(){t.renderAnnotationBtn(),t.renderCropBtn(),t.renderTransformBtn(),e.trigger("toolbarCreated",{toolbarType:"main"})},clicked:this.defToolbarClicked.bind(this)});if(a.appendTo("#"+i+"_bottomToolbar"),this.defToolbarItems.length>0&&document.getElementById(i+"_bottomToolbar")){var n=Q(i+"_bottomToolbar","toolbar");n.refreshOverflow()}}},l.prototype.getLeftToolbarItem=function(t,e){var i=this.parent,r=i.element.id,o=[];(!t||e)&&(d(i.toolbar)||i.toolbar&&i.toolbar.indexOf("Open")>-1?(o.push({id:r+"_upload",cssClass:"e-image-upload",align:"Left",type:"Input",template:new Li({allowedExtensions:i.uploadSettings.allowedExtensions,multiple:!1})}),o.push({visible:!1,cssClass:"e-image-position e-btn e-flat",tooltipText:this.l10n.getConstant("Browse"),align:"Left"})):S.isDevice&&i.toolbar&&i.toolbar.indexOf("Open")===-1&&(o.push({visible:!1,id:r+"_upload",cssClass:"e-image-upload",align:"Left",type:"Input",template:new Li({allowedExtensions:i.uploadSettings.allowedExtensions,multiple:!1})}),o.push({visible:!1,cssClass:"e-image-position e-btn e-flat",tooltipText:this.l10n.getConstant("Browse"),align:"Left"}))),i.allowUndoRedo&&!e&&((d(i.toolbar)||i.toolbar&&i.toolbar.indexOf("Undo")>-1)&&o.push({id:r+"_undo",prefixIcon:"e-icons e-undo",cssClass:"top-icon e-undo",tooltipText:this.l10n.getConstant("Undo"),align:"Left"}),(d(i.toolbar)||i.toolbar&&i.toolbar.indexOf("Redo")>-1)&&o.push({id:r+"_redo",prefixIcon:"e-icons e-redo",cssClass:"top-icon e-redo",tooltipText:this.l10n.getConstant("Redo"),align:"Left"})),!this.preventZoomBtn&&(i.zoomSettings.zoomTrigger&ze.Toolbar)===ze.Toolbar&&!e&&((d(i.toolbar)||i.toolbar&&i.toolbar.indexOf("ZoomOut")>-1)&&o.push({id:r+"_zoomOut",prefixIcon:"e-icons e-zoom-out",cssClass:"top-icon e-dec-zoom",tooltipText:this.l10n.getConstant("ZoomOut"),align:"Left"}),(d(i.toolbar)||i.toolbar&&i.toolbar.indexOf("ZoomIn")>-1)&&o.push({id:r+"_zoomIn",prefixIcon:"e-icons e-zoom-in",cssClass:"top-icon e-inc-zoom",tooltipText:this.l10n.getConstant("ZoomIn"),align:"Left"}));for(var a=this.processToolbar("left"),n=0,s=a.length;n<s;n++)o.push(a[n]);return o},l.prototype.getRightToolbarItem=function(t,e,i){var r=this.parent,o=r.element.id,a=[];(t||i)&&(a.push({id:o+"_ok",prefixIcon:"e-icons e-check",cssClass:"top-icon e-tick",tooltipText:this.l10n.getConstant("OK"),align:"Right",tabIndex:0}),a.push({id:o+"_cancel",prefixIcon:"e-icons e-close",cssClass:"top-icon e-save",tooltipText:this.l10n.getConstant("Cancel"),align:"Right"})),(e||!S.isDevice)&&(d(r.toolbar)||r.toolbar&&r.toolbar.indexOf("Reset")>-1)&&a.push({id:o+"_reset",prefixIcon:"e-icons e-btn-reset",cssClass:"top-icon e-img-reset",tooltipText:this.l10n.getConstant("Reset"),align:"Right"}),t||(d(r.toolbar)||r.toolbar&&r.toolbar.indexOf("Save")>-1)&&a.push({id:o+"_save",prefixIcon:"e-icons e-btn-save",cssClass:"e-caret-hide top-icon e-save",tooltipText:this.l10n.getConstant("Save"),align:"Right"});for(var n=this.processToolbar("right"),s=0,h=n.length;s<h;s++)a.push(n[s]);return a},l.prototype.getMainToolbarItem=function(t,e,i){var r=this.parent,o=r.element.id,a=[];e?((d(r.toolbar)||!d(r.toolbar)&&r.toolbar.indexOf("None")>-1||r.toolbar.indexOf("Frame")>-1)&&a.push({id:o+"_none",prefixIcon:"e-icons e-frame-none",cssClass:"top-icon e-frame-none",tooltipText:this.l10n.getConstant("None"),align:"Center"}),(d(r.toolbar)||!d(r.toolbar)&&r.toolbar.indexOf("Mat")>-1||r.toolbar.indexOf("Frame")>-1)&&a.push({id:o+"_mat",prefixIcon:"e-icons e-frame-mat",cssClass:"top-icon e-frame-mat",tooltipText:this.l10n.getConstant("Mat"),align:"Center"}),(d(r.toolbar)||!d(r.toolbar)&&r.toolbar.indexOf("Bevel")>-1||r.toolbar.indexOf("Frame")>-1)&&a.push({id:o+"_bevel",prefixIcon:"e-icons e-frame-bevel",cssClass:"top-icon e-frame-bevel",tooltipText:this.l10n.getConstant("Bevel"),align:"Center"}),(d(r.toolbar)||!d(r.toolbar)&&r.toolbar.indexOf("Line")>-1||r.toolbar.indexOf("Frame")>-1)&&a.push({id:o+"_line",prefixIcon:"e-icons e-frame-line",cssClass:"top-icon e-frame-line",tooltipText:this.l10n.getConstant("Line"),align:"Center"}),(d(r.toolbar)||!d(r.toolbar)&&r.toolbar.indexOf("Inset")>-1||r.toolbar.indexOf("Frame")>-1)&&a.push({id:o+"_inset",prefixIcon:"e-icons e-frame-inset",cssClass:"top-icon e-frame-inset",tooltipText:this.l10n.getConstant("Inset"),align:"Center"}),(d(r.toolbar)||!d(r.toolbar)&&r.toolbar.indexOf("Hook")>-1||r.toolbar.indexOf("Frame")>-1)&&a.push({id:o+"_hook",prefixIcon:"e-icons e-frame-hook",cssClass:"top-icon e-frame-hook",tooltipText:this.l10n.getConstant("Hook"),align:"Center"})):i?(a.push({id:o+"_redactBlur",prefixIcon:"e-icons e-tint",cssClass:"top-icon e-opacity",tooltipText:this.l10n.getConstant("Blur"),align:"Center"}),a.push({id:o+"_pixelate",prefixIcon:"e-icons e-opacity",cssClass:"top-icon e-opacity",tooltipText:this.l10n.getConstant("Pixelate"),align:"Center"}),a.push({id:o+"_duplicate",prefixIcon:"e-icons e-order",cssClass:"top-icon e-order",tooltipText:this.l10n.getConstant("Duplicate"),align:"Center"}),a.push({id:o+"_remove",prefixIcon:"e-icons e-trash",cssClass:"top-icon e-trash",tooltipText:this.l10n.getConstant("Remove"),align:"Center"})):((d(r.toolbar)||r.toolbar&&r.toolbar.indexOf("Crop")>-1)&&a.push({id:o+"_cropTransform",prefixIcon:"e-icons e-crop",cssClass:"top-icon e-crop",tooltipText:this.l10n.getConstant("CropAndTransform"),align:"Center"}),(d(r.toolbar)||r.toolbar&&r.toolbar.indexOf("Annotate")>-1)&&a.push({id:o+"_annotation",tooltipText:this.l10n.getConstant("Annotation"),align:"Center",template:'<button id="'+o+'_annotationBtn"></button>'}),(d(r.toolbar)||r.toolbar&&r.toolbar.indexOf("Finetune")>-1)&&a.push({id:o+"_adjustment",prefixIcon:"e-icons e-adjustment",cssClass:"top-icon e-adjustment",tooltipText:this.l10n.getConstant("Finetune"),align:"Center"}),(d(r.toolbar)||r.toolbar&&r.toolbar.indexOf("Filter")>-1)&&a.push({id:o+"_filter",prefixIcon:"e-icons e-filters",cssClass:"top-icon e-filters",tooltipText:this.l10n.getConstant("Filter"),align:"Center"}),(d(r.toolbar)||!d(r.toolbar)&&r.toolbar.indexOf("Frame")>-1)&&a.push({id:o+"_frame",prefixIcon:"e-icons e-border-frame",cssClass:"top-icon e-border-frame",tooltipText:this.l10n.getConstant("Frame"),align:"Center"}),(d(r.toolbar)||!d(r.toolbar)&&r.toolbar.indexOf("Resize")>-1)&&a.push({id:o+"_resize",prefixIcon:"e-icons e-resize",cssClass:"top-icon e-resize",tooltipText:this.l10n.getConstant("Resize"),align:"Center"}),(d(r.toolbar)||!d(r.toolbar)&&r.toolbar.indexOf("Redact")>-1)&&a.push({id:o+"_redact",prefixIcon:"e-icons e-redact",cssClass:"top-icon e-opacity",tooltipText:this.l10n.getConstant("Redact"),align:"Center"}));for(var n=this.processToolbar("center"),s=0,h=n.length;s<h;s++)a.push(n[s]);return t&&(a.push({id:o+"_ok",prefixIcon:"e-icons e-check",cssClass:"top-icon e-tick",tooltipText:this.l10n.getConstant("OK"),align:"Right",tabIndex:0}),a.push({id:o+"_cancel",prefixIcon:"e-icons e-close",cssClass:"top-icon e-save",tooltipText:this.l10n.getConstant("Cancel"),align:"Right"})),a},l.prototype.getZoomToolbarItem=function(){var t=[];return t},l.prototype.updateContextualToolbar=function(t,e,i){var r=this.parent,o=r.element.id,a=r.element.querySelector("#"+o+"_toolbarArea"),n=r.element.querySelector("#"+o+"_contextualToolbarArea");if(n){if(n.classList.remove("e-hide"),n.style.left=a.offsetLeft+"px",t==="filter"){var s=document.getElementById(o+"_toolbar");s&&this.defToolbarItems.length>0&&Q(s,"toolbar").destroy(),S.isDevice?this.initMainToolbar(!1,!0,!0):this.initMainToolbar(!0,null,null),this.refreshSlider(),this.initFilterToolbarItem()}else{var h=document.querySelector("#"+o+"_contextualToolbar");h.classList.contains("e-control")&&Q(h,"toolbar").destroy(),this.refreshSlider(),t==="frame"?this.initFrameToolbarItem():this.renderSlider(e,i)}if(r.toolbarTemplate?this.toolbarHeight=r.element.querySelector("#"+o+"_toolbarArea").clientHeight:r.element.querySelector("#"+o+"_toolbar")&&(this.toolbarHeight=r.element.querySelector("#"+o+"_toolbar").clientHeight),r.toolbarHeight=this.toolbarHeight,S.isDevice){var p=n.offsetHeight+1,u=r.element.querySelector("#"+o+"_customizeWrapper");this.isFrameToolbar&&u&&(p=u.offsetHeight+2);var c=r.element.querySelector("#"+o+"_canvasWrapper").offsetHeight;if(n.style.top=this.toolbarHeight+1+c-p+"px",e==="straighten"){r.isStraightening=!0;var h=r.element.querySelector("#"+o+"_contextualToolbarArea");h.style.position==="absolute"&&(h.style.position="",r.element.insertBefore(h,r.element.querySelector("#"+o+"_bottomToolbarArea")),r.update(),i&&r.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:this.getCropTextContent(document.getElementById(o+"_cropBtn")).toLowerCase(),startX:null,startY:null,width:null,height:null}}))}}else n.style.top=this.toolbarHeight+1+"px"}},l.prototype.processToolbar=function(t){var e=this.parent,i=[];if(e.toolbar)for(var r=0,o=e.toolbar.length;r<o;r++)typeof e.toolbar[r]=="object"&&(d(e.toolbar[r].align)?t==="left"&&i.push(e.toolbar[r]):e.toolbar[r].align.toLowerCase()===t&&i.push(e.toolbar[r]));return i},l.prototype.processSubToolbar=function(t){var e=[];if(t)for(var i=0,r=t.length;i<r;i++)typeof t[i]=="object"&&(t[i].align="Center",e.push(t[i]));return e},l.prototype.wireZoomBtnEvents=function(){var t=document.querySelector("#"+this.parent.element.id+"_zoomIn"),e=document.querySelector("#"+this.parent.element.id+"_zoomOut");t&&(t.addEventListener("mousedown",this.zoomInBtnMouseDownHandler.bind(this)),t.addEventListener("mouseup",this.zoomBtnMouseUpHandler.bind(this)),t.addEventListener("click",this.zoomInBtnClickHandler.bind(this))),e&&(e.addEventListener("mousedown",this.zoomOutBtnMouseDownHandler.bind(this)),e.addEventListener("mouseup",this.zoomBtnMouseUpHandler.bind(this)),e.addEventListener("click",this.zoomOutBtnClickHandler.bind(this)))},l.prototype.widthPress=function(t){if(t.keyCode===109){t.preventDefault();return}},l.prototype.heightPress=function(t){if(t.keyCode===109){t.preventDefault();return}},l.prototype.widthAspectRatio=function(t){if(!(t.keyCode===109||t.keyCode===9)){var e=this.parent,i=e.element.id,r=e.element.querySelector("#"+i+"_resizeHeight"),o=e.element.querySelector("#"+i+"_resizeWidth"),a=e.element.querySelector("#"+i+"_aspectratio"),n=e.img.destWidth,s=e.img.destHeight,h=parseFloat(r.value),p=h/(s/n),u=p%1>=.5||p%1<=-.5?Math.round(p):p<0?Math.ceil(p):Math.floor(p),c=Q(o,"numerictextbox"),f=Q(o,"numerictextbox");a&&(u!=null&&!isNaN(u)?d(c.value)?(c.placeholder=u+" px",o.placeholder=u.toString()+" px"):(c.value=u,o.value=u.toString()+" px"):d(c.value)?(c.placeholder="0 px",o.placeholder="0 px",d(f.value)&&!d(f.placeholder)&&(c.placeholder=""+e.img.srcWidth,o.placeholder=""+e.img.srcWidth)):(c.value=0,o.value="0 px"))}},l.prototype.heightAspectRatio=function(t){if(!(t.keyCode===109||t.keyCode===9)){var e=this.parent,i=e.element.id,r=e.element.querySelector("#"+i+"_resizeHeight"),o=e.element.querySelector("#"+i+"_resizeWidth"),a=e.element.querySelector("#"+i+"_aspectratio"),n=e.img.destWidth,s=e.img.destHeight,h=parseFloat(o.value),p=h/(n/s),u=p%1>=.5||p%1<=-.5?Math.round(p):p<0?Math.ceil(p):Math.floor(p),c=Q(r,"numerictextbox"),f=Q(o,"numerictextbox");a&&(isNaN(u)?d(c.value)?(c.placeholder="0 px",r.placeholder="0 px",d(f.value)&&!d(f.placeholder)&&(c.placeholder=""+e.img.srcHeight,r.placeholder=""+e.img.srcHeight)):(c.value=0,r.value="0 px"):d(c.value)?(c.placeholder=u+" px",r.placeholder=u.toString()+" px"):(c.value=u,r.value=u.toString()+" px"))}},l.prototype.getResizeToolbarItem=function(){var t=this.parent,e=t.element.id,i=!!(t.aspectWidth&&t.aspectHeight),r=this.parent.transform.degree%90===0&&this.parent.transform.degree%180!==0?Math.ceil(this.parent.img.srcHeight).toString():Math.ceil(this.parent.img.srcWidth).toString(),o=this.parent.transform.degree%90===0&&this.parent.transform.degree%180!==0?Math.ceil(this.parent.img.srcWidth).toString():Math.ceil(this.parent.img.srcHeight).toString(),a=[],n=document.createElement("span");n.innerHTML=this.l10n.getConstant("W"),a.push({id:e+"_width",cssClass:"e-ie-resize-width",template:n,align:"Center"}),a.push({id:e+"_resizeWidth",prefixIcon:"e-icons e-anti-clock-wise",tooltipText:this.l10n.getConstant("Width"),align:"Center",type:"Input",template:new Yi({width:75,htmlAttributes:{maxLength:"4"},showSpinButton:!1,value:i?t.aspectWidth:null,placeholder:i?null:r,format:"###.## px"})});var s=document.createElement("span");return s.innerHTML=this.l10n.getConstant("H"),a.push({id:e+"_height",cssClass:"e-ie-resize-height",template:s,align:"Center"}),a.push({id:e+"_resizeHeight",prefixIcon:"e-icons e-clock-wise",tooltipText:this.l10n.getConstant("Height"),align:"Center",type:"Input",template:new Yi({width:75,htmlAttributes:{maxLength:"4"},showSpinButton:!1,value:i?t.aspectHeight:null,placeholder:i?null:o,format:"###.## px"})}),this.isAspectRatio?(a.push({id:e+"_nonaspectratio",prefixIcon:"e-icons e-unlock",align:"Center",tooltipText:this.l10n.getConstant("AspectRatio"),type:"Button"}),this.isAspectRatio=!1):(a.push({id:e+"_aspectratio",prefixIcon:"e-icons e-lock",align:"Center",tooltipText:this.l10n.getConstant("AspectRatio"),type:"Button",tabIndex:0}),this.isAspectRatio=!0),S.isDevice||(a.push({id:e+"_ok",prefixIcon:"e-icons e-check",cssClass:"top-icon e-tick",tooltipText:this.l10n.getConstant("OK"),align:"Right",tabIndex:0}),a.push({id:e+"_cancel",prefixIcon:"e-icons e-close",cssClass:"top-icon e-save",tooltipText:this.l10n.getConstant("Cancel"),align:"Right"})),a},l.prototype.initResizeToolbar=function(){var t=this,e=this.parent,i=e.element.id,r=this.getLeftToolbarItem(!1,!0),o=this.getRightToolbarItem(),a=this.getResizeToolbarItem(),n=this.getZoomToolbarItem();S.isDevice?this.defToolbarItems=a:this.defToolbarItems=r.concat(n,a,o);var s={toolbarType:"resize",toolbarItems:this.defToolbarItems};e.trigger("toolbarUpdating",s),this.defToolbarItems=s.toolbarItems;var h=new dt({width:"100%",items:this.defToolbarItems,clicked:this.defToolbarClicked.bind(this),created:function(){t.wireResizeBtnEvents(),e.trigger("toolbarCreated",{toolbarType:"shapes"}),S.isDevice?t.defToolbarItems.length>0&&!d(document.getElementById(i+"_bottomToolbar"))&&h.refreshOverflow():(t.createLeftToolbarControls(),t.defToolbarItems.length>0&&!d(document.getElementById(i+"_toolbar"))&&h.refreshOverflow())}});S.isDevice?h.appendTo("#"+i+"_bottomToolbar"):h.appendTo("#"+i+"_toolbar"),e.isResize=!1,this.enableDisableTbrBtn(),e.isResize=!0,e.notify("transform",{prop:"disableZoomOutBtn",value:{isZoomOut:!0}})},l.prototype.wireResizeBtnEvents=function(){var t=this.parent,e=t.element.id,i=t.element.querySelector("#"+e+"_resizeHeight"),r=t.element.querySelector("#"+e+"_resizeWidth");d(i)||(i.addEventListener("keydown",this.widthPress.bind(this)),r.addEventListener("keyup",this.heightAspectRatio.bind(this))),d(r)||(r.addEventListener("keydown",this.heightPress.bind(this)),i.addEventListener("keyup",this.widthAspectRatio.bind(this)))},l.prototype.enableDisableTbrBtn=function(){var t=this.parent,e=t.element.id;if(!this.preventEnableDisableUr){var i={appliedUndoRedoColl:[]};t.notify("undo-redo",{prop:"getAppliedUndoRedoColl",value:{obj:i}});var r={undoRedoStep:null};t.notify("undo-redo",{prop:"getUndoRedoStep",value:{obj:r}});var o=t.element.querySelector("#"+e+"_undo");o&&r.undoRedoStep===0?(o.classList.add("e-disabled"),o.parentElement.classList.add("e-overlay")):o&&r.undoRedoStep>0&&(o.classList.remove("e-disabled"),o.parentElement.classList.remove("e-overlay"));var a=t.element.querySelector("#"+e+"_redo");a&&r.undoRedoStep===i.appliedUndoRedoColl.length?(a.classList.add("e-disabled"),a.parentElement.classList.add("e-overlay")):(a&&r.undoRedoStep===0&&i.appliedUndoRedoColl.length>0||a&&r.undoRedoStep>0)&&(a.classList.remove("e-disabled"),a.parentElement.classList.remove("e-overlay"))}var n=document.querySelector("#"+e+"_zoomIn");n&&t.zoomSettings.zoomFactor>=t.zoomSettings.maxZoomFactor?(n.classList.add("e-disabled"),n.parentElement.classList.add("e-overlay")):n&&(n.classList.remove("e-disabled"),n.parentElement.classList.remove("e-overlay"));var s=document.querySelector("#"+e+"_zoomOut");s&&t.zoomSettings.zoomFactor<=t.zoomSettings.minZoomFactor?(s.classList.add("e-disabled"),s.parentElement.classList.add("e-overlay")):s&&(s.classList.remove("e-disabled"),s.parentElement.classList.remove("e-overlay"));var h=document.querySelector("#"+e+"_frame");h&&(t.currSelectionPoint&&t.currSelectionPoint.shape==="crop-circle"||t.isCircleCrop)?h.classList.add("e-overlay"):h&&h.classList.remove("e-overlay");var p=document.querySelector("#"+e+"_aspectratio");p&&(t.currSelectionPoint&&t.currSelectionPoint.shape==="crop-circle"||t.isCircleCrop)?p.classList.add("e-overlay"):p&&p.classList.remove("e-overlay")},l.prototype.createLeftToolbarControls=function(){var t=this.parent,e=t.element.id;if(this.defToolbarItems!==void 0&&this.defToolbarItems.length>0&&document.getElementById(e+"_toolbar")){var i=document.getElementById(e+"_toolbar").querySelector(".e-image-upload");if(i){var r=i.getElementsByTagName("input")[0],o=i.getElementsByTagName("button")[0];o.className="e-tbar-btn e-tbtn-txt top-icon",o.innerHTML="",o.title=this.l10n.getConstant("Browse"),o.appendChild(t.createElement("span",{className:"e-btn-icon e-icons e-upload-icon e-icon-left"})),r.onchange=this.fileSelect.bind(this,r)}}},l.prototype.fileSelect=function(t,e){var i=this.parent,r=t.files[0].type.split("/")[1],o=this.parent.getExtensionArray(),a=(r==="jpg"||r==="jpeg")&&(i.uploadSettings.allowedExtensions.indexOf("jpg")>-1||i.uploadSettings.allowedExtensions.indexOf("jpeg")>-1);this.fileName=t.files[0].name.split(".")[0];var n=t.files[0].size;this.parent.notify("toolbar",{prop:"setInitialSize",value:{value:t.files[0].size}}),(o.indexOf(r)>-1||a||r.indexOf("svg")>-1&&o.indexOf("svg")>-1)&&(!this.parent.uploadSettings.minFileSize||n>this.parent.uploadSettings.minFileSize)&&(!this.parent.uploadSettings.maxFileSize||n<this.parent.uploadSettings.maxFileSize)?this.parent.notify("draw",{prop:"fileSelect",value:{inputElement:t,args:e}}):(this.parent.isImageLoaded||(this.destroyTopToolbar(),this.createToolbar(),S.isDevice&&this.destroyBottomToolbar()),this.parent.showDialogPopup("unsupported",!(o.indexOf(r)>-1||a||r.indexOf("svg")>-1&&o.indexOf("svg")>-1)))},l.prototype.triggerTbarClickEvent=function(t){var e={item:t.item,originalEvent:t.event};this.parent.trigger("toolbarItemClicked",e)},l.prototype.renderAnnotationBtn=function(t){var e=this,i=this.parent,r=!1,o=[],a=i.element.id,n=["Ellipse","Arrow","Line","Rectangle","Pen","Path","Text","Image"];if(i.toolbar){for(var s=0;s<n.length;s++)if(i.toolbar.indexOf(n[s])!==-1){r=!0;break}}(d(i.toolbar)||!r||i.toolbar&&i.toolbar.indexOf("Pen")>-1)&&o.push({text:this.l10n.getConstant("Pen"),id:"pen",iconCss:"e-icons e-free-pen"}),(d(i.toolbar)||!r||i.toolbar&&i.toolbar.indexOf("Line")>-1)&&o.push({text:this.l10n.getConstant("Line"),id:"line",iconCss:"e-icons e-line"}),(d(i.toolbar)||!r||i.toolbar&&i.toolbar.indexOf("Rectangle")>-1)&&o.push({text:this.l10n.getConstant("Rectangle"),id:"rectangle",iconCss:"e-icons e-rectangle"}),(d(i.toolbar)||!r||i.toolbar&&i.toolbar.indexOf("Ellipse")>-1)&&o.push({text:this.l10n.getConstant("Ellipse"),id:"ellipse",iconCss:"e-icons e-circle"}),(d(i.toolbar)||!r||i.toolbar&&i.toolbar.indexOf("Arrow")>-1)&&o.push({text:this.l10n.getConstant("Arrow"),id:"arrow",iconCss:"e-icons e-arrow-right-up"}),(d(i.toolbar)||!r||i.toolbar&&i.toolbar.indexOf("Path")>-1)&&o.push({text:this.l10n.getConstant("Path"),id:"path",iconCss:"e-icons e-critical-path"}),(d(i.toolbar)||!r||i.toolbar&&i.toolbar.indexOf("Text")>-1)&&o.push({text:this.l10n.getConstant("Text"),id:"text",iconCss:"e-icons e-add-text"}),(d(i.toolbar)||!r||i.toolbar&&i.toolbar.indexOf("Image")>-1)&&o.push({text:this.l10n.getConstant("Image"),id:"image",iconCss:"e-icons e-image"});var h={freehandDrawSelectedId:null};i.notify("freehand-draw",{prop:"getFreehandDrawSelectedId",onPropertyChange:!1,value:{obj:h}});var p=S.isDevice?"#"+a+"_bottomToolbar #"+a:"#"+a;this.enableDisableCloneBtn(p,h);var u=t?this.getCurrentShapeIcon(i.activeObj.shape):"e-annotation",c=new De({items:o,iconCss:"e-icons "+u,cssClass:"e-image-popup",open:function(f){(i.currObjType.isFiltered||i.currObjType.isRedact)&&(i.okBtn(),i.element.querySelector("#"+a+"_annotationBtn").click()),S.isDevice&&(f.element.parentElement.style.top=c.element.getBoundingClientRect().top-f.element.parentElement.offsetHeight+"px"),i.activeObj.shape?document.getElementById(i.activeObj.shape).classList.add("e-selected"):i.togglePen&&document.getElementById("pen").classList.add("e-selected")},select:function(f){i.noPushUndo=!1,e.triggerTbarClickEvent(f),i.okBtn();var g=!1,v;i.activeObj.shape!==void 0&&(v=i.activeObj.shape.split("-")),(v===void 0&&i.currObjType.isCustomCrop||v!==void 0&&v[0]==="crop")&&(g=!0),i.currObjType.isCustomCrop=!1,(g||i.togglePan)&&(i.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),e.upperContext.clearRect(0,0,i.upperCanvas.width,i.upperCanvas.height),e.refreshToolbar("main"));var m={currentFreehandDrawIndex:null};i.notify("freehand-draw",{prop:"getCurrentFreehandDrawIndex",value:{obj:m}});var C={shapeSettingsObj:{}},M,I,N=["ellipse","rectangle","text","image"],O;c.iconCss="e-icons "+e.getCurrentShapeIcon(f.item.id),i.notify("draw",{prop:"updateTempObjColl"}),i.notify("draw",{prop:"updateTempPointColl"});var x={penStrokeWidth:2};switch(f.item.id){case"pen":i.notify("freehand-draw",{prop:"getPenStrokeWidth",onPropertyChange:!1,value:{obj:x}}),i.notify("draw",{prop:"setTempStrokeWidth",value:{strokeWidth:x.penStrokeWidth}}),i.drawingShape=null,i.notify("draw",{prop:"setTempFreehandCounter",value:{tempFreehandCounter:i.freehandCounter}}),i.notify("draw",{prop:"setTempCurrentFreehandDrawIndex",value:{tempCurrentFreehandDrawIndex:m.currentFreehandDrawIndex}}),e.currentToolbar="pen",i.freeHandDraw(!0),i.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:C}}),M=C.shapeSettingsObj,i.notify("freehand-draw",{prop:"getPenStrokeWidth",onPropertyChange:!1,value:{obj:x}}),M.strokeWidth=x.penStrokeWidth,M.type=bt.FreehandDraw,I={cancel:!1,action:"insert",previousShapeSettings:M,currentShapeSettings:M},i.notify("freehand-draw",{prop:"triggerShapeChanging",value:{shapeChangingArgs:I}});break;case"text":e.currentToolbar="text",i.drawingShape=f.item.id,e.currentToolbar="text",e.setInitialShapeSettings(f),i.notify("selection",{prop:"annotate",value:{shape:f.item.id}}),i.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"text",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}});break;case"image":i.drawingShape=null,e.currentToolbar="shapes",i.element.querySelector("#"+a+"_fileUpload").click();break;case"ellipse":case"arrow":case"line":case"rectangle":case"path":i.drawingShape=f.item.id,e.currentToolbar="shapes",e.setInitialShapeSettings(f),i.notify("selection",{prop:"annotate",value:{shape:f.item.id}}),i.notify("toolbar",{prop:"refresh-toolbar",onPropertyChange:!1,value:{type:"shapes",isApplyBtn:null,isCropping:null,isZooming:null,cType:null}}),i.notify("selection",{prop:"updatePrevShapeSettings",onPropertyChange:!1,value:{obj:C}}),M=C.shapeSettingsObj,O=N.indexOf(e.parent.activeObj.shape)===-1,I={cancel:!1,action:"insert",previousShapeSettings:M,currentShapeSettings:M,allowShapeOverflow:O},i.trigger("shapeChanging",I),i.editCompleteArgs=I,i.notify("shape",{prop:"updateShapeChangeEventArgs",value:{shapeSettings:I.currentShapeSettings}});break}e.updateToolbarItems();var D=i.togglePen;f.item.id==="pen"&&(i.togglePen=!1),i.notify("draw",{prop:"redrawDownScale"}),i.togglePen=D}});c.appendTo("#"+a+"_annotationBtn")},l.prototype.enableDisableCloneBtn=function(t,e){var i=this.parent,r=!1,o=Math.floor(i.activeObj.activePoint.width);i.activeObj.shape&&i.activeObj.shape==="text"&&i.activeObj.textSettings.fontSize===11&&(o===55||i.activeObj.textSettings.bold&&o===58)&&Math.floor(i.activeObj.activePoint.height)===11&&(r=!0);var a=document.querySelector(t+"_duplicate"),n=document.querySelector(t+"_remove"),s=document.querySelector(t+"_editText"),h=document.querySelector(t+"_zOrderBtn");r||i.activeObj.activePoint.width===0&&i.activeObj.activePoint.height===0&&(d(i.activeObj.pointColl)||i.activeObj.pointColl&&i.activeObj.pointColl.length===0)&&d(e.freehandDrawSelectedId)?(a&&a.classList.add("e-overlay"),n&&n.classList.add("e-overlay"),s&&s.classList.add("e-overlay"),h&&h.classList.add("e-overlay")):(a&&a.classList.remove("e-overlay"),n&&n.classList.remove("e-overlay"),s&&s.classList.remove("e-overlay"),h&&h.classList.remove("e-overlay")),h&&(i.shapeColl.length===0||e.freehandDrawSelectedId&&i.shapeColl.length===1)&&h.classList.add("e-overlay")},l.prototype.renderStraightenSlider=function(){var t=this.parent,e=t.element.id;if((d(t.toolbar)||t.toolbar&&t.toolbar.indexOf("Straightening")>-1)&&t.element.querySelector("#"+e+"_straightenSlider")){var i=this.createSlider(-45,45,t.cropObj.straighten,"straighten");i.appendTo("#"+e+"_straightenSlider");var r=i.element.querySelector(".e-handle");r&&!S.isDevice&&(r.addEventListener("mousedown",function(o){o.preventDefault(),o.stopPropagation()}),r.addEventListener("touchstart",function(o){o.preventDefault(),o.stopPropagation()}))}},l.prototype.renderCropBtn=function(t){var e=this,i=this.parent,r=[],o=!1,a=["CustomSelection","CircleSelection","SquareSelection","RatioSelection"];if(i.toolbar){for(var n=0;n<a.length;n++)if(i.toolbar.indexOf(a[n])!==-1){o=!0;break}}(d(i.toolbar)||!o||i.toolbar&&i.toolbar.indexOf("CustomSelection")>-1)&&r.push({text:this.l10n.getConstant("Custom"),id:"custom",iconCss:"e-icons e-custom"}),(d(i.toolbar)||!o||i.toolbar&&i.toolbar.indexOf("CircleSelection")>-1)&&r.push({text:this.l10n.getConstant("Circle"),id:"circle",iconCss:"e-icons e-circle"}),(d(i.toolbar)||!o||i.toolbar&&i.toolbar.indexOf("SquareSelection")>-1)&&r.push({text:this.l10n.getConstant("Square"),id:"square",iconCss:"e-icons e-square"}),(d(i.toolbar)||!o||i.toolbar&&i.toolbar.indexOf("RatioSelection")>-1)&&(r.push({text:"2:3",id:"2:3",iconCss:"e-icons e-custom-f"}),r.push({text:"3:2",id:"3:2",iconCss:"e-icons e-custom-a"}),r.push({text:"3:4",id:"3:4",iconCss:"e-icons e-custom-g"}),r.push({text:"4:3",id:"4:3",iconCss:"e-icons e-custom-b"}),r.push({text:"4:5",id:"4:5",iconCss:"e-icons e-custom-h"}),r.push({text:"5:4",id:"5:4",iconCss:"e-icons e-custom-c"}),r.push({text:"5:7",id:"5:7",iconCss:"e-icons e-custom-i"}),r.push({text:"7:5",id:"7:5",iconCss:"e-icons e-custom-d"}),r.push({text:"9:16",id:"9:16",iconCss:"e-icons e-custom-j"}),r.push({text:"16:9",id:"16:9",iconCss:"e-icons e-custom-e"}));var s,h;t?(s=this.getCurrentShapeIcon(t),h=t):i.activeObj.shape&&(i.activeObj.activePoint.width!==0||i.activeObj.activePoint.height!==0)||i.activeObj.shape==="path"&&i.activeObj.pointColl.length>0?(s=this.getCurrentShapeIcon(i.activeObj.shape),h=i.activeObj.shape):i.currSelectionPoint?(s=this.getCurrentShapeIcon(i.currSelectionPoint.shape),h=i.currSelectionPoint.shape):(s=r[0].iconCss,h=r[0].id);var p=new De({open:function(u){if(i.togglePan&&e.cancelPan(),S.isDevice&&(u.element.parentElement.style.top=p.element.getBoundingClientRect().top-u.element.parentElement.offsetHeight+"px"),i.activeObj.shape&&i.activeObj.shape.split("-").length>1){var c=document.getElementById(i.activeObj.shape.split("-")[1]);c&&(c.classList.add("e-selected"),c.focus())}i.notify("transform",{prop:"disableZoomOutBtn",value:{isZoomOut:!0}})},items:r,select:function(u){e.triggerTbarClickEvent(u),e.cropSelect(u),p.iconCss="e-icons "+e.getCurrentShapeIcon("crop-"+u.item.id),p.content=S.isDevice?null:i.toPascalCase(u.item.id)},iconCss:"e-icons "+s,cssClass:"e-image-popup e-ie-crop-ddb-popup",content:S.isDevice?null:i.toPascalCase(h.replace("crop-",""))});p.appendTo("#"+i.element.id+"_cropBtn")},l.prototype.renderTransformBtn=function(){var t=this,e=this.parent,i=[];(d(e.toolbar)||e.toolbar&&e.toolbar.indexOf("RotateLeft")>-1)&&i.push({text:this.l10n.getConstant("RotateLeft"),id:"rotateleft",iconCss:"e-icons e-anti-clock-wise"}),(d(e.toolbar)||e.toolbar&&e.toolbar.indexOf("RotateRight")>-1)&&i.push({text:this.l10n.getConstant("RotateRight"),id:"rotateright",iconCss:"e-icons e-clock-wise"}),(d(e.toolbar)||e.toolbar&&e.toolbar.indexOf("FlipHorizontal")>-1)&&i.push({text:this.l10n.getConstant("HorizontalFlip"),id:"horizontalflip",iconCss:"e-icons e-horizontal-flip"}),(d(e.toolbar)||e.toolbar&&e.toolbar.indexOf("FlipVertical")>-1)&&i.push({text:this.l10n.getConstant("VerticalFlip"),id:"verticalflip",iconCss:"e-icons e-vertical-flip"});var r=new De({open:function(o){if(S.isDevice){var a=o.element.parentElement,n=a.offsetHeight;a.style.display="none",a.style.top=r.element.getBoundingClientRect().top-n+"px",a.style.display="block"}},items:i,select:function(o){t.triggerTbarClickEvent(o),e.transformSelect.bind(t)},iconCss:"e-icons e-transform",cssClass:"e-image-popup"});r.appendTo("#"+e.element.id+"_transformBtn")},l.prototype.saveDialogPopup=function(){var t=this,e=this.parent,i=e.element.id,r=["Good","Great","Highest"];e.element.appendChild(e.createElement("div",{id:i+"_saveDialog"}));var o=e.createElement("div",{id:i+"_dialogContent"});o.style.display="flex";var a=o.appendChild(e.createElement("div",{id:i+"_dialogImgContent",className:"e-ie-dlg-img-content"}));a.appendChild(e.createElement("canvas",{id:i+"_imgPic",className:"e-ie-img-dlg-canvas"}));var n=a.appendChild(e.createElement("div",{id:i+"_imageNameContainer",className:"e-ie-img-size"}));n.appendChild(e.createElement("span",{id:i+"_imageNameLabel",className:"e-ie-quality-info"}));var s=o.appendChild(e.createElement("div",{id:i+"_dialogRightContent",className:"e-ie-dlg-right-content"})),h=s.appendChild(e.createElement("div",{id:i+"_namediv",className:"e-ie-img-save-name"}));h.appendChild(e.createElement("span",{id:i+"_labelImgname",className:"e-ie-img-label-name",innerHTML:this.l10n.getConstant("ImageName")})),h.appendChild(e.createElement("input",{id:i+"_imgNametext",className:"e-ie-img-input",attrs:{type:"text"}}));var p=s.appendChild(e.createElement("div",{id:i+"_imgNamediv",className:"e-ie-img-save-dlg"}));p.appendChild(e.createElement("span",{id:i+"_labelname",className:"e-ie-img-label-name",innerHTML:this.l10n.getConstant("Format")})),p.appendChild(e.createElement("button",{id:i+"_saveDropdownbtn",attrs:{tabindex:"1"}}));var u=s.appendChild(e.createElement("div",{id:i+"_imgQualitydiv",className:"e-ie-img-quality-name"})),c=e.createElement("div",{id:i+"_qualityContainer"});c.appendChild(e.createElement("span",{id:i+"_qualityLabel",className:"e-ie-img-quality-label",innerHTML:this.l10n.getConstant("Quality")})),c.appendChild(e.createElement("span",{id:i+"_qualityInfo",className:"e-circle-info e-icons e-ie-quality-span",attrs:{title:this.l10n.getConstant("QualityInfo")}}));var f=c.appendChild(e.createElement("div",{id:i+"_imgsizeSpan",className:"e-ie-img-size-value-span"}));f.appendChild(e.createElement("span",{id:i+"_imgsizeValueSpan",className:""})),u.appendChild(c);var g=e.createElement("div",{id:i+"_qualityOptionContainer",className:"e-ie-quality-option-container"}),v=u.appendChild(e.createElement("div",{id:i+"_qualityButtonGroup",className:"e-btn-group"}));r.forEach(function(C){var M=document.createElement("input");M.type="radio",M.id=i+"_"+C.toLowerCase(),M.name="quality",M.value=C.toLowerCase();var I=document.createElement("label");I.className="e-btn",I.htmlFor=C.toLowerCase(),I.textContent=t.l10n.getConstant(C),v.appendChild(M),v.appendChild(I)}),g.appendChild(v),g.appendChild(e.createElement("div",{id:i+"_qualitySlider",className:"e-ie-img-quality-slider"})),g.appendChild(e.createElement("button",{id:i+"_qualitybuttonIcon",className:"e-ie-img-icon-button",attrs:{type:"button"}})),u.appendChild(g),S.isDevice&&s.appendChild(e.createElement("span",{id:i+"_qualitySize",className:"e-ie-img-quality-size"})),e.element.querySelector("#"+i+"_saveDialog").style.display="block",e.element.appendChild(o);var m=new Ao({target:e.element,header:this.l10n.getConstant("SaveAs"),closeOnEscape:!0,content:document.getElementById(i+"_dialogContent"),width:S.isDevice?"345px":"570px",isModal:!0,animationSettings:{effect:"Zoom"},beforeOpen:this.onBeforeopen(),close:this.saveDialogClosed.bind(this,i),cssClass:"e-ie-save-dialog",buttons:[{click:function(){m.hide()},buttonModel:{content:this.l10n.getConstant("Close"),cssClass:"e-save-cancel-btn"}},{click:function(){t.download(),m.hide(),t.isSlider=!1},buttonModel:{isPrimary:!0,content:this.l10n.getConstant("Download"),cssClass:"e-flat e-save-download-btn"}}]});m.appendTo("#"+i+"_saveDialog")},l.prototype.saveDialogClosed=function(t){Q(document.getElementById(t+"_saveDropdownbtn"),"dropdownbutton")&&Q(document.getElementById(t+"_saveDropdownbtn"),"dropdownbutton").destroy(),this.isSlider=!1,document.querySelector("#"+t+"_qualityButtonGroup")&&document.querySelector("#"+t+"_qualitySlider")&&(document.querySelector("#"+t+"_qualityButtonGroup").remove(),document.querySelector("#"+t+"_qualitySlider").remove(),document.querySelector("#"+t+"_imgsizeValueSpan").remove(),document.querySelector("#"+t+"_imageNameLabel").remove(),document.querySelector("#"+t+"_imgsizeSpan").remove()),document.getElementById(t+"_dialogContent").remove(),Q(document.getElementById(t+"_saveDialog"),"dialog").destroy(),document.getElementById(t+"_saveDialog").remove()},l.prototype.onBeforeopen=function(){var t=this,e=this.parent,i=e.element.id,r={canvas:null},o=[{id:"jpeg",text:"JPEG"},{id:"png",text:"PNG"},{id:"svg",text:"SVG"},{id:"webp",text:"WebP"}],a=new ey({placeholder:this.l10n.getConstant("ImageName")});a.appendTo("#"+i+"_imgNametext");var n=document.getElementById(i+"_imgQualitydiv"),s=document.getElementById(i+"_qualitySlider"),h=document.querySelector("#"+i+"_qualityButtonGroup"),p=document.querySelector("#"+i+"_qualitybuttonIcon"),u=document.querySelector("#"+i+"_imgsizeSpan"),c;S.isDevice?c=document.getElementById(i+"_qualitySize"):c=document.getElementById(i+"_imageNameLabel");var f={fileName:"",fileType:""};e.notify("draw",{prop:"getFileName",onPropertyChange:!1,value:{obj:f}}),this.fileType=f.fileType?f.fileType:"JPEG",e.notify("export",{prop:"exportToCanvas",value:{object:r}});var g=r.canvas,v=document.getElementById(i+"_imgPic");v.width=g.width,v.height=g.height;var m=new Xi({iconCss:"e-icons e-settings"});m.appendTo("#"+i+"_qualitybuttonIcon");var C=document.getElementById(i+"_saveDropdownbtn");if(C){var M=document.createElement("span");M.innerHTML=this.fileType==="Webp"?"Webp":this.fileType.toUpperCase(),C&&C.appendChild(M);var I=new De({items:o,open:function(O){S.isDevice&&(O.element.parentElement.style.top=I.element.getBoundingClientRect().top-O.element.parentElement.offsetHeight+"px");var x=M.innerHTML;x!==""&&O.element.querySelector('[aria-label = "'+x+'"]').classList.add("e-selected-btn")},select:function(O){u.style.display="none",t.fileType=M.innerHTML=O.item.text,O.item.id!=="jpeg"?(n.style.display="none",c.style.display="block",t.updateImageSize(1,r.canvas,t.fileType),s&&(t.isSlider&&Q(s,"slider").destroy(),s.style.display="none"),t.isSlider=!1):(n.style.display="block",G([h],"e-hide"),s.style.display="none",c.style.display="block",t.updateImageSize(d(t.currentQuality)?1:t.currentQuality,r.canvas,t.fileType),document.getElementById(i+"_"+t.imageQuality).checked=!0)}});I.appendTo("#"+i+"_saveDropdownbtn");var N=document.getElementById(i+"_imgNametext");N.value=this.fileName?this.fileName:f.fileName,f.fileType&&f.fileType.toUpperCase()!=="JPEG"&&(n.style.display="none",u.style.display="none"),S.isDevice?(document.getElementById(i+"_dialogImgContent").style.display="none",document.getElementById(i+"_dialogRightContent").style.width="100%",this.updateImageSize(1,r.canvas,this.fileType)):this.updateImageSize(1,r.canvas,this.fileType)}document.getElementById(i+"_"+this.imageQuality).checked=!0,h.addEventListener("click",this.qualityBtnClickHandler.bind(this)),p.addEventListener("click",this.qualityBtnClickHandler.bind(this))},l.prototype.qualityBtnClickHandler=function(t){var e=this,i=this.parent,r=i.element.id,o=t.target,a={fileName:""},n={canvas:null},s={Good:.8,Great:.9,Highest:1},h=document.querySelector("#"+r+"_qualityButtonGroup"),p=document.querySelector("#"+r+"_qualitySlider"),u=document.querySelector("#"+r+"_qualityOptionContainer"),c=document.querySelector("#"+r+"_imgsizeSpan"),f=document.querySelector("#"+r+"_imgsizeValueSpan");if(i.notify("draw",{prop:"getFileName",onPropertyChange:!1,value:{obj:a}}),i.notify("export",{prop:"exportToCanvas",value:{object:n}}),t.currentTarget.id===r+"_qualitybuttonIcon"&&!this.isSlider){W([h],"e-hide"),p.style.display="block",c.style.display="inline-block",u.style.display="flex";var g=new Mr({tooltip:{placement:"Before",isVisible:!0,format:"P0",showOn:"Focus"},min:.01,max:1,step:.01,value:this.currentQuality,type:"MinRange",width:S.isDevice?"80%":"190px",created:function(){e.updateImageSize(e.currentQuality,n.canvas,"jpeg"),f.innerHTML=Math.round(e.currentQuality*100).toString()},changed:function(v){e.currentQuality=v.value,f.innerHTML=Math.round(e.currentQuality*100).toString(),i.notify("export",{prop:"setImageQuality",value:{value:v.value}}),e.updateImageSize(v.value,n.canvas,"jpeg")}});g.appendTo("#"+r+"_qualitySlider"),g.element.parentElement.classList.add("e-ie-quality-slider"),this.isSlider=!0}else t.currentTarget.id===r+"_qualitybuttonIcon"&&this.isSlider?(Q(p,"slider").destroy(),p.style.display="none",c.style.display="none",G([h],"e-hide"),u.style.display="block",this.isSlider=!1):s.hasOwnProperty(o.textContent)&&!this.isSlider&&(t.target.previousElementSibling.checked=!0,this.currentQuality=s[o.textContent],this.imageQuality=o.textContent.toLowerCase(),this.updateImageSize(s[o.textContent],n.canvas,"jpeg"))},l.prototype.updateImageSize=function(t,e,i){var r,o=this.parent,a=o.element.id,n=document.getElementById(a+"_imgPic"),s=n.getContext("2d"),h;if(S.isDevice?h=document.getElementById(a+"_qualitySize"):h=document.getElementById(a+"_imageNameLabel"),i.toLowerCase()==="jpeg")e.toBlob((function(C){if(r=Math.floor(C.size/1024),r>1e3){var M=r/1024;h.innerHTML=this.l10n.getConstant("ImageSize")+": "+M.toFixed(2)+" MB",r=+M.toFixed(2)}else h.innerHTML=this.l10n.getConstant("ImageSize")+": "+r.toFixed(2)+" KB",r=+r.toFixed(2);if(S.isDevice)n.style.display="none";else{var I=new Image;I.src=URL.createObjectURL(C),I.onload=function(){s.drawImage(I,0,0),URL.revokeObjectURL(I.src)}}this.fileSize=r}).bind(this),"image/jpeg",t);else if(!d(i)&&(i.toLowerCase()==="png"||i.toLowerCase()==="webp")){var p="image/"+i.toLowerCase();s.drawImage(e,0,0),e.toBlob((function(C){if(r=Math.floor(C.size/1024),r>1e3){var M=r/1024;h.innerHTML=this.l10n.getConstant("ImageSize")+": "+M.toFixed(2)+" MB",r=+M.toFixed(2)}else h.innerHTML=this.l10n.getConstant("ImageSize")+": "+r.toFixed(2)+" KB",r=+r.toFixed(2);S.isDevice&&(n.style.display="none"),this.fileSize=r}).bind(this),p,1)}else if(!d(i)&&i.toLowerCase()==="svg"){s.drawImage(e,0,0);var u=e.toDataURL("image/svg+xml"),c=u.split(",")[1],f=c.length,g=f,v=Math.floor(g/1024);if(v>1e3){var m=v/1024;h.innerHTML=this.l10n.getConstant("ImageSize")+": "+m.toFixed(2)+" MB",v=+m.toFixed(2)}else h.innerHTML=this.l10n.getConstant("ImageSize")+": "+v.toFixed(2)+" KB",v=+v.toFixed(2);S.isDevice&&(n.style.display="none"),this.fileSize=v}else if(S.isDevice)n.style.display="none";else if(s.drawImage(e,0,0),this.initialSize>1e3){var m=this.initialSize/1048576;h.innerHTML=this.l10n.getConstant("ImageSize")+": "+m.toFixed(2)+" MB"}else h.innerHTML=this.l10n.getConstant("ImageSize")+": "+this.initialSize.toFixed(2)+" KB"},l.prototype.download=function(){var t=this.parent,e=t.element.id;if(this.fileType==="JPEG"&&this.isSlider){var i=Q(document.getElementById(e+"_qualitySlider"),"slider").value;t.notify("export",{prop:"setImageQuality",value:{value:i}})}else t.notify("export",{prop:"setImageQuality",value:{value:this.currentQuality}});var r=document.getElementById(e+"_imgNametext").value;t.export(this.fileType,r)},l.prototype.getCropTransformToolbarItem=function(){var t=this.parent,e=t.element.id,i=[];if(i.push({id:e+"_crop",tooltipText:this.l10n.getConstant("CropSelection"),align:"Center",template:'<button id="'+e+'_cropBtn"></button>'}),i.push({align:"Center",type:"Separator"}),(d(t.toolbar)||t.toolbar&&(t.toolbar.indexOf("Transform")>-1||t.toolbar.indexOf("RotateLeft")>-1))&&i.push({id:e+"_rotateLeft",prefixIcon:"e-icons e-anti-clock-wise",tooltipText:this.l10n.getConstant("RotateLeft"),align:"Center"}),(d(t.toolbar)||t.toolbar&&(t.toolbar.indexOf("Transform")>-1||t.toolbar.indexOf("RotateRight")>-1))&&i.push({id:e+"_rotateRight",prefixIcon:"e-icons e-clock-wise",tooltipText:this.l10n.getConstant("RotateRight"),align:"Center"}),i.length>2&&i.push({align:"Center",type:"Separator"}),(d(t.toolbar)||t.toolbar&&(t.toolbar.indexOf("Transform")>-1||t.toolbar.indexOf("HorizontalFlip")>-1))&&i.push({id:e+"_horizontalFlip",prefixIcon:"e-icons e-horizontal-flip",tooltipText:this.l10n.getConstant("HorizontalFlip"),align:"Center"}),(d(t.toolbar)||t.toolbar&&(t.toolbar.indexOf("Transform")>-1||t.toolbar.indexOf("VerticalFlip")>-1))&&i.push({id:e+"_verticalFlip",prefixIcon:"e-icons e-vertical-flip",tooltipText:this.l10n.getConstant("VerticalFlip"),align:"Center"}),(d(t.toolbar)||t.toolbar&&t.toolbar.indexOf("Straightening")>-1)&&!S.isDevice&&(i.push({align:"Center",type:"Separator"}),d(t.toolbar)||t.toolbar&&t.toolbar.indexOf("Straightening")>-1)){var r=document.createElement("span");r.innerHTML=this.l10n.getConstant("Straighten"),i.push({id:e+"_straightenSpan",cssClass:"e-ie-straighten-span",template:r,align:"Center"}),i.push({id:e+"_straighten",cssClass:"top-icon e-straighten",tooltipText:this.l10n.getConstant("Straighten"),align:"Center",type:"Input",template:'<div id="'+e+'_straightenSlider"></div>'});var o=document.createElement("span");o.innerHTML=t.transform.straighten.toString()+"&#176",i.push({id:e+"_straightenSpan",cssClass:"e-ie-straighten-value-span",template:o,align:"Center"})}return S.isDevice||(i.push({id:e+"_ok",prefixIcon:"e-icons e-check",cssClass:"top-icon e-tick",tooltipText:this.l10n.getConstant("OK"),align:"Right",tabIndex:0}),i.push({id:e+"_cancel",prefixIcon:"e-icons e-close",cssClass:"top-icon e-save",tooltipText:this.l10n.getConstant("Cancel"),align:"Right"})),i},l.prototype.getShapesToolbarItem=function(t){var e=this.parent,i=e.element.id,r=[];(d(e.toolbar)||e.toolbar)&&r.push({id:i+"_annotation",tooltipText:this.l10n.getConstant("Annotation"),align:"Center",template:'<button id="'+i+'_annotationBtn"></button>'}),t.indexOf("fillColor")>-1&&r.push({prefixIcon:"e-icons e-copy",id:i+"_fillcolor",cssClass:"top-icon e-fill",tooltipText:this.l10n.getConstant("FillColor"),align:"Center",type:"Input",template:'<button id="'+i+'_fillColorBtn"></button>'}),t.indexOf("strokeColor")>-1&&r.push({prefixIcon:"e-icons e-copy",id:i+"_strokecolor",cssClass:"top-icon e-stroke",tooltipText:this.l10n.getConstant("StrokeColor"),align:"Center",type:"Input",template:'<button id="'+i+'_borderColorBtn"></button>'}),t.indexOf("strokeWidth")>-1&&r.push({id:i+"_strokeWidth",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("StrokeWidth"),align:"Center",type:"Input",template:'<button id="'+i+'_borderWidthBtn"></button>'}),t.indexOf("start")>-1&&r.push({id:i+"_start",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("Start"),align:"Center",type:"Input",template:'<button id="'+i+'_startBtn"></button>'}),t.indexOf("borderRadius")>-1&&r.push({id:i+"_rectangleRadius",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("BorderRadius"),align:"Center",type:"Input",template:'<button id="'+i+'_rectangleRadiusBtn"></button>'}),t.indexOf("end")>-1&&r.push({id:i+"_end",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("End"),align:"Center",type:"Input",template:'<button id="'+i+'_endBtn"></button>'}),t.indexOf("flip")>-1&&(r.push({id:i+"_rotLeft",prefixIcon:"e-anti-clock-wise",tooltipText:this.l10n.getConstant("RotateLeft"),align:"Center"}),r.push({id:i+"_rotRight",prefixIcon:"e-clock-wise",tooltipText:this.l10n.getConstant("RotateRight"),align:"Center"}),r.push({id:i+"_hFlip",prefixIcon:"e-horizontal-flip",tooltipText:this.l10n.getConstant("HorizontalFlip"),align:"Center"}),r.push({id:i+"_vFlip",prefixIcon:"e-vertical-flip",tooltipText:this.l10n.getConstant("VerticalFlip"),align:"Center"})),t.indexOf("transparency")>-1&&(r.push({align:"Center",type:"Separator"}),r.push({id:i+"_transparency",prefixIcon:"e-opacity",tooltipText:this.l10n.getConstant("Opacity"),align:"Center"})),r.push({align:"Center",type:"Separator"}),t.indexOf("z-order")>-1&&r.push({id:i+"_zOrder",cssClass:"top-icon e-list-unordered-3",tooltipText:this.l10n.getConstant("ZOrder"),align:"Center",type:"Input",template:'<button id="'+i+'_zOrderBtn"></button>'}),t.indexOf("duplicate")>-1&&r.push({id:i+"_duplicate",prefixIcon:"e-icons e-order",cssClass:"top-icon e-order",tooltipText:this.l10n.getConstant("Duplicate"),align:"Center"}),t.indexOf("remove")>-1&&r.push({id:i+"_remove",prefixIcon:"e-icons e-trash",cssClass:"top-icon e-trash",tooltipText:this.l10n.getConstant("Remove"),align:"Center"}),t.indexOf("text")>-1&&r.push({id:i+"_editText",prefixIcon:"e-icons e-annotation-edit",cssClass:"top-icon e-annotation-edit",tooltipText:this.l10n.getConstant("EditText"),align:"Center"});for(var o=this.processSubToolbar(t),a=0,n=o.length;a<n;a++)r.push(o[a]);if(!S.isDevice){var s={shape:null};e.notify("selection",{prop:"getCurrentDrawingShape",value:{obj:s}}),s.shape!=="path"&&(r.push({id:i+"_ok",prefixIcon:"e-icons e-check",cssClass:"top-icon e-tick",tooltipText:this.l10n.getConstant("OK"),align:"Right",tabIndex:0}),r.push({id:i+"_cancel",prefixIcon:"e-icons e-close",cssClass:"top-icon e-save",tooltipText:this.l10n.getConstant("Cancel"),align:"Right"}))}return r},l.prototype.initCropTransformToolbar=function(t,e){var i=this,r=this.parent,o=r.element.id,a=this.getLeftToolbarItem(),n=this.getRightToolbarItem(),s=this.getCropTransformToolbarItem(),h=this.getZoomToolbarItem();S.isDevice?this.defToolbarItems=s:this.defToolbarItems=a.concat(h,s,n);var p={toolbarType:"crop-transform",toolbarItems:this.defToolbarItems};r.trigger("toolbarUpdating",p),this.defToolbarItems=p.toolbarItems;var u=new dt({width:"100%",items:this.defToolbarItems,clicked:this.defToolbarClicked.bind(this),created:function(){i.renderCropBtn(t),i.renderStraightenSlider(),i.wireZoomBtnEvents(),r.trigger("toolbarCreated",{toolbarType:"shapes"}),S.isDevice?i.defToolbarItems.length>0&&document.getElementById(o+"_bottomToolbar")&&(u.refreshOverflow(),u.refreshOverflow(),u.refreshOverflow()):(i.createLeftToolbarControls(),i.defToolbarItems.length>0&&document.getElementById(o+"_toolbar")&&u.refreshOverflow()),document.getElementById(o+"_cropBtn")&&d(e)&&(S.isDevice||r.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:i.getCropTextContent(document.getElementById(o+"_cropBtn")).toLowerCase(),startX:null,startY:null,width:null,height:null}}))}});S.isDevice?u.appendTo("#"+o+"_bottomToolbar"):u.appendTo("#"+o+"_toolbar");var c=r.element.querySelector("#"+o+"_straightenSlider");(d(r.toolbar)||r.toolbar&&r.toolbar.indexOf("Straightening")>-1)&&c&&c.parentElement.clientHeight>this.toolbarHeight&&(this.toolbarHeight=r.toolbarHeight=c.parentElement.clientHeight),this.enableDisableTbrBtn(),r.notify("transform",{prop:"disableZoomOutBtn",value:{isZoomOut:!0}})},l.prototype.getCropTextContent=function(t){if(t){var e={"e-custom":"Custom","e-circle":"Circle","e-square":"Square","e-custom-a":"3:2","e-custom-b":"4:3","e-custom-c":"5:4","e-custom-d":"7:5","e-custom-e":"16:9","e-custom-f":"2:3","e-custom-g":"3:4","e-custom-h":"4:5","e-custom-i":"5:7","e-custom-j":"9:16"},i=t.children[0].classList;for(var r in e)if(i.contains(r))return e[r]}return""},l.prototype.getCurrentShapeIcon=function(t){var e={rectangle:"e-rectangle",ellipse:"e-circle",line:"e-line",arrow:"e-arrow-right-up",path:"e-critical-path",text:"e-add-text",image:"e-image",pen:"e-free-pen","crop-custom":"e-custom","crop-circle":"e-circle","crop-square":"e-square","crop-3:2":"e-custom-a","crop-4:3":"e-custom-b","crop-5:4":"e-custom-c","crop-7:5":"e-custom-d","crop-16:9":"e-custom-e","crop-2:3":"e-custom-f","crop-3:4":"e-custom-g","crop-4:5":"e-custom-h","crop-5:7":"e-custom-i","crop-9:16":"e-custom-j"};return e[t]?e[t]:t&&t.indexOf("crop-")!==-1?"e-custom":"e-free-pen"},l.prototype.initShapesToolbarItem=function(t){var e=this,i=this.parent,r=i.element.id,o=this.getLeftToolbarItem(),a=this.getRightToolbarItem(),n=this.getShapesToolbarItem(t),s=this.getZoomToolbarItem();S.isDevice?this.defToolbarItems=n:this.defToolbarItems=o.concat(s,n,a);var h={toolbarType:i.activeObj.shape?i.activeObj.shape:"shapes",toolbarItems:this.defToolbarItems};i.trigger("toolbarUpdating",h),this.isToolbarString(h.toolbarItems)?(t=h.toolbarItems,this.excludeItems(h.toolbarItems)):this.defToolbarItems=h.toolbarItems;var p=new dt({width:"100%",items:this.defToolbarItems,clicked:this.defToolbarClicked.bind(this),created:function(){e.renderAnnotationBtn(!0),e.createRectangleRadius(t),e.createShapeColor(t),e.createShapeBtn(t),e.createZOrderBtn(t),i.activeObj.shape==="arrow"&&(t.some(function(u){return u.toLowerCase().indexOf("start")>-1})&&e.createStartBtn(),t.some(function(u){return u.toLowerCase().indexOf("end")>-1})&&e.createEndBtn()),e.wireZoomBtnEvents(),i.trigger("toolbarCreated",{toolbarType:"shapes"}),S.isDevice?e.defToolbarItems.length>0&&document.getElementById(r+"_bottomToolbar")&&(p.refreshOverflow(),p.refreshOverflow(),p.refreshOverflow()):(e.createLeftToolbarControls(),e.defToolbarItems.length>0&&document.getElementById(r+"_toolbar")&&p.refreshOverflow())}});S.isDevice?p.appendTo("#"+r+"_bottomToolbar"):p.appendTo("#"+r+"_toolbar"),this.enableDisableTbrBtn()},l.prototype.createRectangleRadius=function(t){var e=this,i=this.parent,r=i.element.id;if(t.indexOf("borderRadius")>-1){var o=[{id:"1",text:this.l10n.getConstant("0")},{id:"2",text:this.l10n.getConstant("20")},{id:"3",text:this.l10n.getConstant("40")},{id:"4",text:this.l10n.getConstant("60")},{id:"5",text:this.l10n.getConstant("80")},{id:"6",text:this.l10n.getConstant("100")}],a=document.getElementById(r+"_rectangleRadiusBtn"),n=document.createElement("span");n.innerHTML=this.l10n.getConstant(i.frameObj.radius.toString()),n.className="e-shape-rectangle-radius",a.appendChild(n);var s=new De({items:o,open:function(h){if(S.isDevice){var p=h.element.parentElement;p.style.top=s.element.getBoundingClientRect().top-p.offsetHeight+"px"}var u=s.element.childNodes[0].textContent;u!==""&&h.element.querySelector('[aria-label = "'+u+'"]').classList.add("e-selected-btn")},select:function(h){if(e.triggerTbarClickEvent(h),n.textContent=h.item.text,i.updateStrokeWidth(h.item.id,"radius"),S.isDevice){if(document.getElementById(r+"_bottomToolbar")){var p=Q(r+"_bottomToolbar","toolbar");p.refreshOverflow()}}else if(document.getElementById(r+"_toolbar")){var u=Q(r+"_toolbar","toolbar");u.refreshOverflow()}i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})}});s.appendTo("#"+r+"_rectangleRadiusBtn")}},l.prototype.beforeModeSwitch=function(t,e){this.popupLeft=t.element.offsetParent.style.left,t.mode==="Picker"?(e.showButtons=!0,e.dataBind(),t.element.querySelector(".e-apply").title=this.l10n.getConstant("Apply"),t.element.querySelector(".e-cancel").title=this.l10n.getConstant("Cancel"),t.element.querySelector(".e-mode-switch-btn").title=this.l10n.getConstant("StandardColors")):(e.showButtons=!1,e.dataBind(),t.element.querySelector(".e-mode-switch-btn").title=this.l10n.getConstant("MoreColors"))},l.prototype.createShapeColor=function(t){var e=this,i=this.parent,r=i.element.id;if(t.indexOf("fillColor")>-1){i.element.querySelector(".e-template.e-fill").appendChild(i.createElement("input",{id:r+"_shape_fill"}));var o=new Kt({modeSwitcher:!0,noColor:!0,value:"",inline:!0,showButtons:!1,mode:"Palette",cssClass:"e-shape-fill-color",beforeModeSwitch:function(h){return e.beforeModeSwitch(h,o)},presetColors:{custom:["","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},beforeTileRender:function(h){h.value===""&&h.element.classList.add("e-nocolor-item")},change:function(h){i.updateFillColor(h.value),h.currentValue.rgba===""?a.element.children[0].classList.add("e-nocolor-item"):(a.element.children[0].classList.remove("e-nocolor-item"),a.element.children[0].style.backgroundColor=h.currentValue.rgba),a.toggle(),i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})},onModeSwitch:function(h){S.isDevice&&(h.element.parentElement.parentElement.style.left=e.popupLeft,h.element.parentElement.parentElement.style.top=a.element.getBoundingClientRect().top-h.element.parentElement.parentElement.offsetHeight+"px")},beforeClose:function(){a.toggle()}},"#"+r+"_shape_fill"),a=new De({open:function(h){var p=h.element.parentElement;S.isDevice&&(p.style.top=a.element.getBoundingClientRect().top-p.offsetHeight+"px",window.innerWidth<=520&&(p.style.left=i.element.offsetLeft+"px"))},target:".e-shape-fill-color",iconCss:"e-dropdownbtn-preview",cssClass:"e-ie-ddb-popup"},"#"+r+"_fillColorBtn");o.inline=!0,o.value=o.getValue(o.value,"rgba"),i.element.querySelector(".e-fill.e-template .e-dropdownbtn-preview").classList.add("e-nocolor-item")}if(t.indexOf("strokeColor")>-1){i.element.querySelector(".e-template.e-stroke").appendChild(i.createElement("input",{id:r+"_shape_stroke"}));var n=new Kt({modeSwitcher:!0,noColor:!1,value:"#fff",inline:!0,showButtons:!1,mode:"Palette",cssClass:"e-shape-stroke-color",beforeModeSwitch:function(h){e.popupLeft=h.element.offsetParent.style.left,n.value=i.activeObj.strokeSettings.strokeColor!=="#fff"?i.activeObj.strokeSettings.strokeColor:"#008000ff",e.beforeModeSwitch(h,n)},presetColors:this.presetColors,change:function(h){i.updateStrokeColor(h.value),s.element.children[0].style.backgroundColor=h.currentValue.rgba,s.toggle(),i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})},onModeSwitch:function(h){S.isDevice&&(h.element.parentElement.parentElement.style.left=e.popupLeft,h.element.parentElement.parentElement.style.top=s.element.getBoundingClientRect().top-h.element.parentElement.parentElement.offsetHeight+"px")},beforeClose:function(){s.toggle()}},"#"+r+"_shape_stroke"),s=new De({open:function(h){var p=h.element.parentElement;S.isDevice&&(p.style.top=s.element.getBoundingClientRect().top-p.offsetHeight+"px",window.innerWidth<=520&&(p.style.left=i.element.offsetLeft+"px"))},target:".e-shape-stroke-color",iconCss:"e-dropdownbtn-preview",cssClass:"e-ie-ddb-popup"},"#"+r+"_borderColorBtn");n.inline=!0,n.value=n.getValue(n.value,"rgba"),i.element.querySelector(".e-stroke.e-template .e-dropdownbtn-preview").style.background="#fff"}},l.prototype.createShapeBtn=function(t){var e=this,i=this.parent,r=i.element.id;if(t.indexOf("strokeWidth")>-1){var o=[{id:"1",text:this.l10n.getConstant("XSmall")},{id:"2",text:this.l10n.getConstant("Small")},{id:"3",text:this.l10n.getConstant("Medium")},{id:"4",text:this.l10n.getConstant("Large")},{id:"5",text:this.l10n.getConstant("XLarge")}];i.activeObj.shape&&(i.activeObj.shape==="rectangle"||i.activeObj.shape==="ellipse")&&(o=[{id:"1",text:this.l10n.getConstant("NoOutline")},{id:"2",text:this.l10n.getConstant("XSmall")},{id:"3",text:this.l10n.getConstant("Small")},{id:"4",text:this.l10n.getConstant("Medium")},{id:"5",text:this.l10n.getConstant("Large")},{id:"6",text:this.l10n.getConstant("XLarge")}]);var a=document.getElementById(r+"_borderWidthBtn"),n=document.createElement("span");n.innerHTML=this.l10n.getConstant("XSmall"),n.className="e-shape-stroke-width",a.appendChild(n);var s=new De({items:o,open:function(h){S.isDevice&&(h.element.parentElement.style.top=s.element.getBoundingClientRect().top-h.element.parentElement.offsetHeight+"px");var p=n.innerHTML;p!==""&&h.element.querySelector('[aria-label = "'+p+'"]').classList.add("e-selected-btn")},select:function(h){if(e.triggerTbarClickEvent(h),n.textContent=h.item.text,i.updateStrokeWidth(h.item.id,"width",i.activeObj.shape),S.isDevice){if(document.getElementById(r+"_bottomToolbar")){var p=Q(r+"_bottomToolbar","toolbar");p.refreshOverflow()}}else if(document.getElementById(r+"_toolbar")){var u=Q(r+"_toolbar","toolbar");u.refreshOverflow()}i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})}});s.appendTo("#"+r+"_borderWidthBtn")}},l.prototype.createZOrderBtn=function(t){var e=this,i=this.parent,r=i.element.id;if(t.indexOf("z-order")>-1){var o=[{text:this.l10n.getConstant("BringForward"),id:"bringForward",iconCss:"e-icons e-bring-forward"},{text:this.l10n.getConstant("SendBackward"),id:"sendBackward",iconCss:"e-icons e-send-backward"},{text:this.l10n.getConstant("BringToFront"),id:"bringToFront",iconCss:"e-icons e-bring-to-front"},{text:this.l10n.getConstant("SendToBack"),id:"sendToBack",iconCss:"e-icons e-send-to-back"}],a=new De({items:o,iconCss:"e-icons e-layers",beforeOpen:function(n){document.getElementById(i.element.id+"_zOrderBtn").classList.contains("e-disabled")&&(n.cancel=!0);var s={freehandSelectedIndex:-1};i.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:s}});var h={order:null};i.notify("shape",{prop:"getHighestOrder",onPropertyChange:!1,value:{obj:h}});var p=i.activeObj.order?i.activeObj.order:i.getObjFromId(i.pointColl[s.freehandSelectedIndex].id).order;p&&p>=h.order?(n.items[0].disabled=!0,n.items[2].disabled=!0):(n.items[0].disabled=!1,n.items[2].disabled=!1),i.notify("shape",{prop:"getLowestOrder",onPropertyChange:!1,value:{obj:h}}),p&&p<=h.order?(n.items[1].disabled=!0,n.items[3].disabled=!0):(n.items[1].disabled=!1,n.items[3].disabled=!1)},open:function(n){S.isDevice&&(n.element.parentElement.style.top=a.element.getBoundingClientRect().top-n.element.parentElement.offsetHeight+"px")},select:function(n){e.triggerTbarClickEvent(n);var s={freehandDrawSelectedId:null};i.notify("freehand-draw",{prop:"getFreehandDrawSelectedId",onPropertyChange:!1,value:{obj:s}});var h=s.freehandDrawSelectedId?s.freehandDrawSelectedId:i.activeObj.currIndex;if(i.updateShapeOrder(h,n.item.id),S.isDevice){if(document.getElementById(r+"_bottomToolbar")){var p=Q(r+"_bottomToolbar","toolbar");p.refreshOverflow()}}else if(document.getElementById(r+"_toolbar")){var u=Q(r+"_toolbar","toolbar");u.refreshOverflow()}h.indexOf("shape")>-1?i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1}):h.indexOf("pen")>-1&&i.notify("undo-redo",{prop:"updateUndoRedoStack",value:{isPenDraw:!0}})}});a.appendTo("#"+r+"_zOrderBtn")}},l.prototype.createStartBtn=function(){var t=this,e=this.parent,i=e.element.id,r=[{id:"1",text:this.l10n.getConstant("None")},{id:"2",text:this.l10n.getConstant("Bar")},{id:"3",text:this.l10n.getConstant("Arrow")},{id:"4",text:this.l10n.getConstant("ArrowSolid")},{id:"5",text:this.l10n.getConstant("Circle")},{id:"6",text:this.l10n.getConstant("CircleSolid")},{id:"7",text:this.l10n.getConstant("Square")},{id:"8",text:this.l10n.getConstant("SquareSolid")}],o=document.getElementById(i+"_startBtn"),a=document.createElement("span");d(e.activeObj.start)&&(e.activeObj.start="none"),a.innerHTML=e.pascalToSplitWords(e.activeObj.start),a.className="e-shape-start",o.appendChild(a);var n=new De({items:r,open:function(s){S.isDevice&&(s.element.parentElement.style.top=n.element.getBoundingClientRect().top-s.element.parentElement.offsetHeight+"px");var h=a.innerHTML;h!==""&&s.element.querySelector('[aria-label = "'+h+'"]').classList.add("e-selected-btn")},select:function(s){var h={1:"none",2:"bar",3:"arrow",4:"arrowSolid",5:"circle",6:"circleSolid",7:"square",8:"squareSolid"};e.notify("selection",{prop:"setArrowShape",value:{type:"initial",shape:h[""+s.item.id]}}),t.triggerTbarClickEvent(s),a.textContent=s.item.text,e.updateArrow("startArrow",s.item.id),e.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})}});n.appendTo("#"+i+"_startBtn")},l.prototype.createEndBtn=function(){var t=this,e=this.parent,i=e.element.id,r=[{id:"1",text:this.l10n.getConstant("None")},{id:"2",text:this.l10n.getConstant("Bar")},{id:"3",text:this.l10n.getConstant("Arrow")},{id:"4",text:this.l10n.getConstant("ArrowSolid")},{id:"5",text:this.l10n.getConstant("Circle")},{id:"6",text:this.l10n.getConstant("CircleSolid")},{id:"7",text:this.l10n.getConstant("Square")},{id:"8",text:this.l10n.getConstant("SquareSolid")}],o=document.getElementById(i+"_endBtn"),a=document.createElement("span");d(e.activeObj.end)&&(e.activeObj.end="arrowSolid"),a.innerHTML=e.pascalToSplitWords(e.activeObj.end),a.className="e-shape-end",o.appendChild(a);var n=new De({items:r,open:function(s){S.isDevice&&(s.element.parentElement.style.top=n.element.getBoundingClientRect().top-s.element.parentElement.offsetHeight+"px");var h=a.innerHTML;h!==""&&s.element.querySelector('[aria-label = "'+h+'"]').classList.add("e-selected-btn")},select:function(s){var h={1:"none",2:"bar",3:"arrow",4:"arrowSolid",5:"circle",6:"circleSolid",7:"square",8:"squareSolid"};e.notify("selection",{prop:"setArrowShape",value:{type:"final",shape:h[""+s.item.id]}}),t.triggerTbarClickEvent(s),a.textContent=s.item.text,e.updateArrow("endArrow",s.item.id),e.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})}});n.appendTo("#"+i+"_endBtn")},l.prototype.getTextToolbarItem=function(t){var e=this.parent,i=e.element.id,r=[];(d(e.toolbar)||e.toolbar)&&r.push({id:i+"_annotation",tooltipText:this.l10n.getConstant("Annotation"),align:"Center",template:'<button id="'+i+'_annotationBtn"></button>'}),t.indexOf("fontFamily")>-1&&r.push({id:i+"_fontFamily",cssClass:"top-icon e-img-font-family",tooltipText:this.l10n.getConstant("FontFamily"),align:"Center",template:'<button id="'+i+'_fontFamilyBtn"></button>'}),t.indexOf("fontSize")>-1&&r.push({id:i+"_fontSize",cssClass:"top-icon e-img-font-size",tooltipText:this.l10n.getConstant("FontSize"),align:"Center",template:'<button id="'+i+'_fontSizeBtn"></button>'}),t.indexOf("fontColor")>-1&&r.push({cssClass:"top-icon e-text-font-color",id:i+"_text_strokecolor",tooltipText:this.l10n.getConstant("FontColor"),align:"Center",type:"Input",template:'<button id="'+i+'_fontColorBtn"></button>'}),t.indexOf("strokeColor")>-1&&r.push({cssClass:"top-icon e-stroke-text-font-color",id:i+"_stroke_text_color",tooltipText:this.l10n.getConstant("TextOutlineColor"),align:"Center",type:"Input",template:'<button id="'+i+'_strokeTextColorBtn"></button>'}),t.indexOf("fillColor")>-1&&r.push({cssClass:"top-icon e-text-background-color",id:i+"_text_backgroundcolor",tooltipText:this.l10n.getConstant("FillColor"),align:"Center",type:"Input",template:'<button id="'+i+'_bgColorBtn"></button>'}),t.indexOf("bold")>-1&&r.push({id:i+"_bold",prefixIcon:"e-icons e-bold",cssClass:"top-icon e-bold",tooltipText:this.l10n.getConstant("Bold"),align:"Center"}),t.indexOf("italic")>-1&&r.push({id:i+"_italic",prefixIcon:"e-icons e-italic",cssClass:"top-icon e-italic",tooltipText:this.l10n.getConstant("Italic"),align:"Center"}),t.indexOf("strokeWidth")>-1&&r.push({id:i+"_strokeWidth",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("TextOutlineWidth"),align:"Center",type:"Input",template:'<button id="'+i+'_borderWidthBtn"></button>'}),t.indexOf("transparency")>-1&&r.push({id:i+"_transparency",prefixIcon:"e-opacity",tooltipText:this.l10n.getConstant("Opacity"),align:"Center"}),r.push({align:"Center",type:"Separator"}),t.indexOf("z-order")>-1&&r.push({id:i+"_zOrder",cssClass:"top-icon e-list-unordered-3",tooltipText:this.l10n.getConstant("ZOrder"),align:"Center",type:"Input",template:'<button id="'+i+'_zOrderBtn"></button>'}),t.indexOf("duplicate")>-1&&r.push({id:i+"_duplicate",prefixIcon:"e-icons e-order",cssClass:"top-icon e-order",tooltipText:this.l10n.getConstant("Duplicate"),align:"Center",disabled:e.textArea.style.display==="block"||e.textArea.style.display==="inline-block"}),t.indexOf("remove")>-1&&r.push({id:i+"_remove",prefixIcon:"e-icons e-trash",cssClass:"top-icon e-trash",tooltipText:this.l10n.getConstant("Remove"),align:"Center",disabled:e.textArea.style.display==="block"||e.textArea.style.display==="inline-block"}),t.indexOf("text")>-1&&r.push({id:i+"_editText",prefixIcon:"e-icons e-annotation-edit",cssClass:"top-icon e-annotation-edit",tooltipText:this.l10n.getConstant("EditText"),align:"Center",disabled:e.textArea.style.display==="block"||e.textArea.style.display==="inline-block"});for(var o=this.processSubToolbar(t),a=0,n=o.length;a<n;a++)r.push(o[a]);return S.isDevice||(r.push({id:i+"_ok",prefixIcon:"e-icons e-check",cssClass:"top-icon e-tick",tooltipText:this.l10n.getConstant("OK"),align:"Right",tabIndex:0}),r.push({id:i+"_cancel",prefixIcon:"e-icons e-close",cssClass:"top-icon e-save",tooltipText:this.l10n.getConstant("Cancel"),align:"Right"})),r},l.prototype.getFontFamilyItems=function(){var t=this.parent,e=[];return t.fontFamily&&t.fontFamily.items&&t.fontFamily.items.length>0?e=t.fontFamily.items:S.isDevice?e=[{id:"arial",text:"ABC"},{id:"calibri",text:"ABC"},{id:"georgia",text:"ABC"},{id:"roboto",text:"ABC"},{id:"tahoma",text:"ABC"}]:e=[{id:"arial",text:"Arial"},{id:"calibri",text:"Calibri"},{id:"georgia",text:"Georgia"},{id:"roboto",text:"Roboto"},{id:"tahoma",text:"Tahoma"}],e},l.prototype.initTextToolbarItem=function(t){var e=this,i=this.parent,r=i.element.id,o=this.getLeftToolbarItem(),a=this.getRightToolbarItem(),n=this.getTextToolbarItem(t),s=this.getZoomToolbarItem();S.isDevice?this.defToolbarItems=n:this.defToolbarItems=o.concat(s,n,a);var h={toolbarType:"text",toolbarItems:this.defToolbarItems};i.trigger("toolbarUpdating",h),this.isToolbarString(h.toolbarItems)?(t=h.toolbarItems,this.excludeItems(h.toolbarItems)):this.defToolbarItems=h.toolbarItems;var p=new dt({width:"100%",items:this.defToolbarItems,clicked:this.defToolbarClicked.bind(this),created:function(){e.renderAnnotationBtn(!0),e.createTextColor(t),e.createStrokeTextColor(t),e.createShapeBtn(t),e.createBackgroundColor(t),e.createTextBtn(t),e.createZOrderBtn(t),e.wireZoomBtnEvents(),i.trigger("toolbarCreated",{toolbarType:"text"}),S.isDevice?e.defToolbarItems.length>0&&document.getElementById(r+"_bottomToolbar")&&(p.refreshOverflow(),p.refreshOverflow(),p.refreshOverflow()):(e.createLeftToolbarControls(),e.defToolbarItems.length>0&&document.getElementById(r+"_toolbar")&&p.refreshOverflow())}});S.isDevice?p.appendTo("#"+r+"_bottomToolbar"):p.appendTo("#"+r+"_toolbar"),this.enableDisableTbrBtn()},l.prototype.createTextColor=function(t){var e=this,i=this.parent,r=i.element.id;if(t.indexOf("fontColor")>-1&&i.element.querySelector(".e-template.e-text-font-color")){i.element.querySelector(".e-template.e-text-font-color").appendChild(i.createElement("input",{id:r+"_text_font"}));var o=new Kt({modeSwitcher:!0,noColor:!1,value:"#fff",inline:!0,showButtons:!1,mode:"Palette",cssClass:"e-text-fontt-color",beforeModeSwitch:function(n){e.popupLeft=n.element.offsetParent.style.left,o.value=i.activeObj.strokeSettings.strokeColor!=="#fff"?i.activeObj.strokeSettings.strokeColor:"#008000ff",e.beforeModeSwitch(n,o)},presetColors:this.presetColors,change:function(n){i.updateFontColor(n.value,"Text"),a.element.children[0].style.backgroundColor=n.currentValue.rgba,a.toggle(),(i.activeObj.activePoint.width!==0||i.activeObj.activePoint.height!==0)&&i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})},onModeSwitch:function(n){S.isDevice&&(n.element.parentElement.parentElement.style.left=e.popupLeft,n.element.parentElement.parentElement.style.top=a.element.getBoundingClientRect().top-n.element.parentElement.parentElement.offsetHeight+"px")},beforeClose:function(){a.toggle()}},"#"+r+"_text_font"),a=new De({open:function(n){var s=n.element.parentElement;S.isDevice&&(s.style.top=a.element.getBoundingClientRect().top-s.offsetHeight+"px",window.innerWidth<=520&&(s.style.left=i.element.offsetLeft+"px"))},target:".e-text-fontt-color",iconCss:"e-dropdownbtn-preview",cssClass:"e-ie-ddb-popup"},"#"+r+"_fontColorBtn");o.inline=!0,o.value=o.getValue(o.value,"rgba"),i.element.querySelector(".e-text-font-color.e-template .e-dropdownbtn-preview").style.background="#fff"}},l.prototype.createBackgroundColor=function(t){var e=this,i=this.parent,r=i.element.id;if(t.indexOf("fillColor")>-1&&i.element.querySelector(".e-template.e-text-background-color")){i.element.querySelector(".e-template.e-text-background-color").appendChild(i.createElement("input",{id:r+"_text_bgColor"}));var o=new Kt({modeSwitcher:!0,noColor:!0,value:"",inline:!0,showButtons:!1,mode:"Palette",cssClass:"e-text-fontt-color",beforeModeSwitch:function(n){e.popupLeft=n.element.offsetParent.style.left,e.beforeModeSwitch(n,o)},presetColors:{custom:["","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},beforeTileRender:function(n){n.value===""&&n.element.classList.add("e-nocolor-item")},change:function(n){i.updateFontColor(n.value,"Background"),n.currentValue.rgba===""?a.element.children[0].classList.add("e-nocolor-item"):(a.element.children[0].classList.remove("e-nocolor-item"),a.element.children[0].style.backgroundColor=n.currentValue.rgba),a.toggle(),(i.activeObj.activePoint.width!==0||i.activeObj.activePoint.height!==0)&&i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})},onModeSwitch:function(n){S.isDevice&&(n.element.parentElement.parentElement.style.left=e.popupLeft,n.element.parentElement.parentElement.style.top=a.element.getBoundingClientRect().top-n.element.parentElement.parentElement.offsetHeight+"px")},beforeClose:function(){a.toggle()}},"#"+r+"_text_bgColor"),a=new De({open:function(n){var s=n.element.parentElement;S.isDevice&&(s.style.top=a.element.getBoundingClientRect().top-s.offsetHeight+"px",window.innerWidth<=520&&(s.style.left=i.element.offsetLeft+"px"))},target:".e-text-fontt-color",iconCss:"e-dropdownbtn-preview",cssClass:"e-ie-ddb-popup"},"#"+r+"_bgColorBtn");o.inline=!0,o.value=o.getValue(o.value,"rgba"),i.element.querySelector(".e-text-background-color.e-template .e-dropdownbtn-preview").style.background="#fff"}},l.prototype.createStrokeTextColor=function(t){var e=this,i=this.parent,r=i.element.id;if(t.indexOf("strokeColor")>-1&&i.element.querySelector(".e-template.e-stroke-text-font-color")){i.element.querySelector(".e-template.e-stroke-text-font-color").appendChild(i.createElement("input",{id:r+"_stroke_text"}));var o=new Kt({modeSwitcher:!0,noColor:!0,value:"",inline:!0,showButtons:!1,mode:"Palette",cssClass:"e-text-fontt-color",beforeModeSwitch:function(n){e.popupLeft=n.element.offsetParent.style.left,e.beforeModeSwitch(n,o)},presetColors:{custom:["","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},beforeTileRender:function(n){n.value===""&&n.element.classList.add("e-nocolor-item")},change:function(n){i.updateStrokeTextColor(n.value),n.currentValue.rgba===""?a.element.children[0].classList.add("e-nocolor-item"):(a.element.children[0].classList.remove("e-nocolor-item"),a.element.children[0].style.backgroundColor=n.currentValue.rgba),a.toggle(),(i.activeObj.activePoint.width!==0||i.activeObj.activePoint.height!==0)&&i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})},onModeSwitch:function(n){S.isDevice&&(n.element.parentElement.parentElement.style.left=e.popupLeft,n.element.parentElement.parentElement.style.top=a.element.getBoundingClientRect().top-n.element.parentElement.parentElement.offsetHeight+"px")},beforeClose:function(){a.toggle()}},"#"+r+"_stroke_text"),a=new De({open:function(n){var s=n.element.parentElement;S.isDevice&&(s.style.top=a.element.getBoundingClientRect().top-s.offsetHeight+"px",window.innerWidth<=520&&(s.style.left=i.element.offsetLeft+"px"))},target:".e-text-fontt-color",iconCss:"e-dropdownbtn-preview",cssClass:"e-ie-ddb-popup"},"#"+r+"_strokeTextColorBtn");o.inline=!0,o.value=o.getValue(o.value,"rgba"),i.element.querySelector(".e-stroke-text-font-color.e-template .e-dropdownbtn-preview").style.background="#fff"}},l.prototype.createTextBtn=function(t){var e=this,i=this.parent,r=i.element.id;if(t.indexOf("fontFamily")>-1){var o=document.getElementById(r+"_fontFamilyBtn"),a=document.createElement("span");S.isDevice?(a.innerHTML="ABC",a.setAttribute("style","font-family: "+i.fontFamily.default.toLowerCase()+"'")):a.innerHTML=i.fontFamily.default,a.className="e-text-font-family",o&&o.appendChild(a);var n=new De({items:this.getFontFamilyItems(),cssClass:"e-font-family",createPopupOnClick:!0,beforeItemRender:function(c){c.element.setAttribute("style","font-family:"+c.element.id)},open:function(c){S.isDevice&&(c.element.parentElement.style.top=n.element.getBoundingClientRect().top-c.element.parentElement.offsetHeight+"px");var f;i.textArea.style.display==="block"||i.textArea.style.display==="inline-block"?f=i.textArea.style.fontFamily:f=i.activeObj.textSettings.fontFamily;var g=c.element.querySelector('[id *= "'+f.toLowerCase()+'"]');g&&g.classList.add("e-selected-btn")},select:function(c){e.triggerTbarClickEvent(c),a.textContent=c.item.text,S.isDevice&&a.setAttribute("style","font-family:"+c.item.id),i.updateFontFamily(c.item.id),i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1});var f=document.getElementById(i.element.id+"_toolbar");f&&f.classList.contains("e-control")&&Q(f,"toolbar").refreshOverflow()}});n.appendTo("#"+r+"_fontFamilyBtn")}if(t.indexOf("fontSize")>-1){var s=document.getElementById(r+"_fontSizeBtn"),h=document.createElement("span"),p=i.getFontSizes();h.innerHTML=p[0].text,h.className="e-text-font-size",s.appendChild(h);var u=new De({cssClass:"e-font-size",items:p,open:function(c){S.isDevice&&(c.element.parentElement.style.top=u.element.getBoundingClientRect().top-c.element.parentElement.offsetHeight+"px");var f=h.innerHTML;c.element.querySelector('[aria-label *= "'+f+'"]').classList.add("e-selected-btn")},select:function(c){e.triggerTbarClickEvent(c),h.textContent=c.item.text,i.updateFontSize(c.item.text),i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})}});u.appendTo("#"+r+"_fontSizeBtn")}},l.prototype.refreshToolbar=function(t,e,i,r,o,a,n){var s=this.parent,h=s.element.id;if(!(!s.isImageLoaded||s.isCropToolbar)){var p={},u,c;if(t!=="filter"&&t!=="color"){var f=document.getElementById(h+"_toolbar"),g=document.getElementById(h+"_customizeWrapper"),v=document.getElementById(h+"_bottomToolbar");if(g&&Q(g,"toolbar")&&this.defToolbarItems.length>0&&(Q(g,"toolbar").destroy(),g.innerHTML=""),f&&f.classList.contains("e-control")&&this.defToolbarItems.length>0&&(Q(f,"toolbar").destroy(),f.innerHTML=""),f&&(this.defToolbarItems.length>0||s.toolbar&&s.toolbar.length>0&&s.toolbar.indexOf("Open")===-1)){var m=Q(f,"toolbar");d(m)||(m.destroy(),document.getElementById(s.element.id+"_toolbar").innerHTML="")}v&&this.defToolbarItems.length>0&&v.className.indexOf("e-control")>-1&&(Q(v,"toolbar").destroy(),v.innerHTML="")}switch(this.refreshSlider(),document.querySelector(".e-slider-tooltip")&&document.querySelector(".e-slider-tooltip").remove(),this.isFrameToolbar=s.isCropTab=!1,t){case"main":S.isDevice?i?this.initMainToolbar(!1,!0,!0,!1,!1,!0):this.initMainToolbar(!1,!0,null,!1,!1,!0):(!S.isDevice||r)&&(r?this.initMainToolbar(e,S.isDevice,null):this.initMainToolbar(e,S.isDevice,null)),S.isDevice&&this.initBottomToolbar();break;case"shapes":if(s.isPublicMethod||(s.noPushUndo=!0),S.isDevice&&this.initMainToolbar(!1,!0,!0),s.activeObj.shape==="line"||s.activeObj.shape==="path"?p.toolbarItems=["strokeColor","strokeWidth","z-order","duplicate","remove"]:s.activeObj.shape==="arrow"?p.toolbarItems=["strokeColor","strokeWidth","start","end","z-order","duplicate","remove"]:s.activeObj.shape==="image"?p.toolbarItems=["flip","z-order","duplicate","remove","transparency"]:s.activeObj.shape==="rectangle"?p.toolbarItems=["fillColor","strokeColor","strokeWidth","borderRadius","z-order","duplicate","remove"]:p.toolbarItems=["fillColor","strokeColor","strokeWidth","z-order","duplicate","remove"],this.initShapesToolbarItem(p.toolbarItems),s.activeObj.shape==="image"){var C=y({},s.activeObj,{},!0);s.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),s.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),s.activeObj=C,s.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:s.activeObj,isCropRatio:null,points:null,isPreventDrag:!0}}),this.renderQAT(!1)}break;case"text":S.isDevice&&this.initMainToolbar(!1,!0,!0),p.toolbarItems=["fontFamily","fontSize","fontColor","fillColor","strokeColor","strokeWidth","bold","italic","z-order","duplicate","remove","text"],this.initTextToolbarItem(p.toolbarItems);break;case"pen":S.isDevice&&this.initMainToolbar(!1,!0,!0),p.toolbarItems=["strokeColor","strokeWidth","z-order","remove","transparency"],this.initPenToolbarItem(p.toolbarItems);break;case"adjustment":S.isDevice&&this.initMainToolbar(!1,!0,!0),this.initAdjustmentToolbarItem();break;case"filter":this.updateContextualToolbar(t);break;case"resize":(s.isCircleCrop||s.currSelectionPoint&&s.currSelectionPoint.shape==="crop-circle")&&(s.aspectHeight=s.aspectWidth,this.isAspectRatio=!1),this.initResizeToolbar(),S.isDevice&&this.initMainToolbar(!1,!0,!0,!0),u=s.element.querySelector("#"+h+"_aspectratio"),c=s.element.querySelector("#"+h+"_nonaspectratio"),s.aspectWidth&&s.aspectHeight&&(c?s.notify("transform",{prop:"resize",value:{width:s.aspectWidth,height:s.aspectHeight,isAspectRatio:!1}}):u&&s.notify("transform",{prop:"resize",value:{width:s.aspectWidth,height:null,isAspectRatio:!0}}));break;case"color":this.updateContextualToolbar(t,o);break;case"croptransform":d(n)&&(s.allowDownScale=!1,s.isCropTab=!0),S.isDevice&&this.initMainToolbar(!1,!0,!0),d(n)&&s.updateCropTransformItems(),this.initCropTransformToolbar(a,n),S.isDevice&&this.isToolbar()&&this.updateContextualToolbar("color","straighten",!0),s.isMaskImage&&this.refreshToolbar("main");break;case"frame":this.isFrameToolbar=!0,S.isDevice?(this.initMainToolbar(!1,!0,!0),this.initMainToolbar(!1,!0,!0,!1,!0)):this.initMainToolbar(!0,null,null,!1,!0);var M=s.element.querySelector("#"+h+"_"+s.frameObj.type);M&&M.classList.add("e-selected-btn"),s.frameObj.type!=="none"&&this.updateContextualToolbar(t,o),s.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}});break;case"redact":if(S.isDevice?(this.initMainToolbar(!1,!0,!0),this.initMainToolbar(!1,!0,!0,null,null,null,!0)):this.initMainToolbar(e,S.isDevice,null,null,null,null,!0),this.enableDisableTbrBtn(),s.activeObj.redactType==="blur"){var I=s.element.querySelector("#"+h+"_redactBlur");I&&I.classList.add("e-selected-btn")}else{var N=s.element.querySelector("#"+h+"_pixelate");N&&N.classList.add("e-selected-btn")}this.redactSlider(s.activeObj.redactType);break}this.refreshDropDownBtn(i),this.updateKBDNavigation(t),this.currToolbar=t}},l.prototype.updateRedactObj=function(){var t=this.parent,e=y([],t.objColl,[],!0);t.objColl=[];var i=y({},t.activeObj,{},!0);t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),t.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),t.objColl=e;for(var r=0;r<t.objColl.length;r++){var o=t.objColl[r];o.shape==="redact"&&(o.redactImage=t.createElement("canvas"),o.redactImage.width=o.activePoint.width,o.redactImage.height=o.activePoint.height,o.redactImage.getContext("2d").drawImage(t.lowerCanvas,o.activePoint.startX,o.activePoint.startY,o.activePoint.width,o.activePoint.height,0,0,o.redactImage.width,o.redactImage.height))}t.isCropTab=!1,t.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),t.isCropTab=!0,i&&t.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:i,isCropRatio:null,points:null,isPreventDrag:!0}});var a={panMove:null};t.notify("transform",{prop:"getPanMove",onPropertyChange:!1,value:{obj:a}}),a.panMove&&t.notify("transform",{prop:"drawPannedImage",onPropertyChange:!1,value:{xDiff:null,yDiff:null}})},l.prototype.updateKBDNavigation=function(t){var e=this.parent,i=e.element.id;if(!(!e.isKBDNavigation||this.currToolbar===t)&&this.isToolbar()){var r=e.element.querySelectorAll("#"+i+"_toolbar")[0],o=void 0,a;if(r){if(o=r.querySelector(".e-toolbar-center"),!o||!o.children[0])return;a=o.children[0].querySelector(".e-btn");var n=o.children[1];if(n&&(n=n.children[0]),n&&(n=n.children[0]),t==="resize"&&n&&(a=n),t==="filter"){var s=document.querySelector("#"+i+"_defaultCanvas");s&&setTimeout(function(){return s.focus()},50)}a&&(t==="main"?setTimeout(function(){return a.focus()},50):a.focus())}}},l.prototype.performCropTransformClick=function(t,e){var i=this.parent;d(e)&&(i.notify("draw",{prop:"setTempStraightenZoomDeg"}),i.tempStraighten=i.transform.straighten,(i.currObjType.isFiltered||i.currObjType.isRedact)&&i.okBtn(),i.isStraightening=!0),this.refreshToolbar("croptransform",null,null,null,null,t,e),d(e)&&(i.notify("draw",{prop:"setDestForStraighten"}),i.notify("draw",{prop:"setTempDestForStraighten"}))},l.prototype.getAdjustmentToolbarItem=function(){var t=[],e=this.parent,i=!1,r=e.element.id,o=["Brightness","Contrast","Hue","Saturation","Exposure","Opacity","Blur"];if(e.toolbar){for(var a=0;a<o.length;a++)if(e.toolbar.indexOf(o[a])!==-1){i=!0;break}}(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Brightness")>-1)&&t.push({id:r+"_brightness",prefixIcon:"e-icons e-brightness",cssClass:"top-icon e-brightness",tooltipText:this.l10n.getConstant("Brightness"),align:"Center"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Contrast")>-1)&&t.push({id:r+"_contrast",prefixIcon:"e-icons e-contrast",cssClass:"top-icon e-contrast",tooltipText:this.l10n.getConstant("Contrast"),align:"Center"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Hue")>-1)&&t.push({id:r+"_hue",prefixIcon:"e-icons e-fade",cssClass:"top-icon e-fade",tooltipText:this.l10n.getConstant("Hue"),align:"Center"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Saturation")>-1)&&t.push({id:r+"_saturation",prefixIcon:"e-icons e-saturation",cssClass:"top-icon e-saturation",tooltipText:this.l10n.getConstant("Saturation"),align:"Center"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Exposure")>-1)&&t.push({id:r+"_exposure",prefixIcon:"e-icons e-grain",cssClass:"top-icon e-grain",tooltipText:this.l10n.getConstant("Exposure"),align:"Center"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Opacity")>-1)&&t.push({id:r+"_opacity",prefixIcon:"e-icons e-opacity",cssClass:"top-icon e-opacity",tooltipText:this.l10n.getConstant("Opacity"),align:"Center"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Blur")>-1)&&t.push({id:r+"_blur",prefixIcon:"e-icons e-tint",cssClass:"top-icon e-tint",tooltipText:this.l10n.getConstant("Blur"),align:"Center"});for(var n=this.processToolbar("center"),a=0,s=n.length;a<s;a++)t.push(n[a]);return S.isDevice||(t.push({id:r+"_ok",prefixIcon:"e-icons e-check",cssClass:"top-icon e-tick",tooltipText:this.l10n.getConstant("OK"),align:"Right",tabIndex:0}),t.push({id:r+"_cancel",prefixIcon:"e-icons e-close",cssClass:"top-icon e-save",tooltipText:this.l10n.getConstant("Cancel"),align:"Right"})),t},l.prototype.getFrameToolbarItem=function(){var t=this.parent,e=t.element.id,i=[];return i.push({prefixIcon:"e-icons e-copy",id:e+"_frameColor",cssClass:"top-icon e-stroke",tooltipText:this.l10n.getConstant("Color"),align:"Center",type:"Input",template:"<span>"+this.l10n.getConstant("Color")+'</span><button id="'+e+'_frameColorBtn"></button>'}),i.push({prefixIcon:"e-icons e-copy",id:e+"_frameGradient",cssClass:"top-icon e-frame-stroke",tooltipText:this.l10n.getConstant("GradientColor"),align:"Center",type:"Input",template:"<span>"+this.l10n.getConstant("GradientColor")+'</span><button id="'+e+'_frameGradientColorBtn"></button>'}),i.push({id:e+"_frameSize",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("Size"),align:"Center",type:"Input",template:"<span>"+this.l10n.getConstant("Size")+'</span><button id="'+e+'_frameSizeBtn"></button>'}),(t.frameObj.type==="line"||t.frameObj.type==="inset"||t.frameObj.type==="hook")&&i.push({id:e+"_frameInset",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("Inset"),align:"Center",type:"Input",template:"<span>"+this.l10n.getConstant("Inset")+'</span><button id="'+e+'_frameInsetBtn"></button>'}),(t.frameObj.type==="line"||t.frameObj.type==="inset")&&i.push({id:e+"_frameOffset",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("Offset"),align:"Center",type:"Input",template:"<span>"+this.l10n.getConstant("Offset")+'</span><button id="'+e+'_frameOffsetBtn"></button>'}),t.frameObj.type==="line"&&(i.push({id:e+"_frameRadius",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("Radius"),align:"Center",type:"Input",template:"<span>"+this.l10n.getConstant("Radius")+'</span><button id="'+e+'_frameRadiusBtn"></button>'}),i.push({id:e+"_frameAmount",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("Amount"),align:"Center",type:"Input",template:"<span>"+this.l10n.getConstant("Amount")+'</span><button id="'+e+'_frameAmountBtn"></button>'}),i.push({id:e+"_frameBorder",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("Border"),align:"Center",type:"Input",template:"<span>"+this.l10n.getConstant("Border")+'</span><button id="'+e+'_frameBorderBtn"></button>'})),i},l.prototype.getFilterToolbarItem=function(){var t=[],e=this.parent,i=!1,r=e.element.id,o=["Default","Chrome","Cold","Warm","Grayscale","Sepia","Invert"];if(e.toolbar){for(var a=0;a<o.length;a++)if(e.toolbar.indexOf(o[a])!==-1){i=!0;break}}(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Default")>-1)&&t.push({id:r+"_default",prefixIcon:"e-icons e-none",cssClass:"top-icon e-none",tooltipText:this.l10n.getConstant("Default"),align:"Center",template:'<div class="filter-wrapper"><canvas id='+r+"_defaultCanvas tabindex=0></canvas><div><span>"+this.l10n.getConstant("Default")+"</span></div></div>"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Chrome")>-1)&&t.push({id:r+"_chrome",prefixIcon:"e-icons e-none",cssClass:"top-icon e-none",tooltipText:this.l10n.getConstant("Chrome"),align:"Center",template:'<div class="filter-wrapper"><canvas id='+r+"_chromeCanvas></canvas><div><span>"+this.l10n.getConstant("Chrome")+"</span></div></div>"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Cold")>-1)&&t.push({id:r+"_cold",prefixIcon:"e-icons e-none",cssClass:"top-icon e-none",tooltipText:this.l10n.getConstant("Cold"),align:"Center",template:'<div class="filter-wrapper"><canvas id='+r+"_coldCanvas></canvas><div><span>"+this.l10n.getConstant("Cold")+"</span></div></div>"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Warm")>-1)&&t.push({id:r+"_warm",prefixIcon:"e-icons e-none",cssClass:"top-icon e-none",tooltipText:this.l10n.getConstant("Warm"),align:"Center",template:'<div class="filter-wrapper"><canvas id='+r+"_warmCanvas></canvas><div><span>"+this.l10n.getConstant("Warm")+"</span></div></div>"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Grayscale")>-1)&&t.push({id:r+"_grayscale",prefixIcon:"e-icons e-none",cssClass:"top-icon e-none",tooltipText:this.l10n.getConstant("Grayscale"),align:"Center",template:'<div class="filter-wrapper"><canvas id='+r+"_grayscaleCanvas></canvas><div><span>"+this.l10n.getConstant("Grayscale")+"</span></div></div>"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Sepia")>-1)&&t.push({id:r+"_sepia",prefixIcon:"e-icons e-none",cssClass:"top-icon e-none",tooltipText:this.l10n.getConstant("Sepia"),align:"Center",template:'<div class="filter-wrapper"><canvas id='+r+"_sepiaCanvas></canvas><div><span>"+this.l10n.getConstant("Sepia")+"</span></div></div>"}),(d(e.toolbar)||!i||e.toolbar&&e.toolbar.indexOf("Invert")>-1)&&t.push({id:r+"_invert",prefixIcon:"e-icons e-none",cssClass:"top-icon e-none",tooltipText:this.l10n.getConstant("Invert"),align:"Center",template:'<div class="filter-wrapper"><canvas id='+r+"_invertCanvas></canvas><div><span>"+this.l10n.getConstant("Invert")+"</span></div></div>"});for(var n=this.processToolbar("center"),a=0,s=n.length;a<s;a++)t.push(n[a]);return t},l.prototype.getPenToolbarItem=function(t){var e=this.parent,i=e.element.id,r=[];(d(e.toolbar)||e.toolbar)&&r.push({id:i+"_annotation",tooltipText:this.l10n.getConstant("Annotation"),align:"Center",template:'<button id="'+i+'_annotationBtn"></button>'}),t.indexOf("strokeColor")>-1&&r.push({prefixIcon:"e-icons e-copy",id:i+"_pen_strokecolor",cssClass:"top-icon e-pen-stroke-color",tooltipText:this.l10n.getConstant("StrokeColor"),align:"Center",type:"Input",template:'<button id="'+i+'_penColorBtn"></button>'}),t.indexOf("strokeWidth")>-1&&r.push({prefixIcon:"e-icons e-copy",id:i+"_pen_strokewidth",cssClass:"top-icon e-size",tooltipText:this.l10n.getConstant("StrokeWidth"),align:"Center",type:"Input",template:'<button id="'+i+'_penStrokeWidth"></button>'}),r.push({align:"Center",type:"Separator"}),t.indexOf("z-order")>-1&&r.push({id:i+"_zOrder",cssClass:"top-icon e-list-unordered-3",tooltipText:this.l10n.getConstant("ZOrder"),align:"Center",type:"Input",template:'<button id="'+i+'_zOrderBtn"></button>'}),t.indexOf("remove")>-1&&r.push({id:i+"_remove",prefixIcon:"e-icons e-trash",cssClass:"top-icon e-trash",tooltipText:this.l10n.getConstant("Remove"),align:"Center"});for(var o=this.processSubToolbar(t),a=0,n=o.length;a<n;a++)r.push(o[a]);return S.isDevice||(r.push({id:i+"_ok",prefixIcon:"e-icons e-check",cssClass:"top-icon e-tick",tooltipText:this.l10n.getConstant("OK"),align:"Right",tabIndex:0}),r.push({id:i+"_cancel",prefixIcon:"e-icons e-close",cssClass:"top-icon e-save",tooltipText:this.l10n.getConstant("Cancel"),align:"Right"})),r},l.prototype.initPenToolbarItem=function(t){var e=this,i=this.parent,r=i.element.id,o=this.getLeftToolbarItem(),a=this.getRightToolbarItem(),n=this.getPenToolbarItem(t),s=this.getZoomToolbarItem();S.isDevice?this.defToolbarItems=n:this.defToolbarItems=o.concat(s,n,a);var h={toolbarType:"pen",toolbarItems:this.defToolbarItems};i.trigger("toolbarUpdating",h),this.isToolbarString(h.toolbarItems)?(t=h.toolbarItems,this.excludeItems(h.toolbarItems)):this.defToolbarItems=h.toolbarItems;var p=new dt({width:"100%",items:this.defToolbarItems,clicked:this.defToolbarClicked.bind(this),created:function(){e.renderAnnotationBtn(!0),e.createPenColor(t),e.createPenBtn(t),e.createZOrderBtn(t),e.wireZoomBtnEvents(),i.trigger("toolbarCreated",{toolbarType:"pen"}),S.isDevice?e.defToolbarItems.length>0&&document.getElementById(r+"_toolbar")&&(p.refreshOverflow(),p.refreshOverflow()):(e.createLeftToolbarControls(),e.defToolbarItems.length>0&&document.getElementById(r+"_toolbar")&&p.refreshOverflow())}});S.isDevice?p.appendTo("#"+r+"_bottomToolbar"):p.appendTo("#"+r+"_toolbar"),this.enableDisableTbrBtn()},l.prototype.createPenColor=function(t){var e=this,i=this.parent,r=i.element.id;if(t.indexOf("strokeColor")>-1){i.element.querySelector(".e-template.e-pen-stroke-color").appendChild(i.createElement("input",{id:r+"_pen_stroke"}));var o=i.activeObj.strokeSettings.strokeColor,a=new Kt({modeSwitcher:!1,value:"#fff",showButtons:!1,mode:"Palette",cssClass:"e-pen-color",change:function(p){i.updatePenStrokeColor(p.currentValue.hex),e.selFhdColor=p.currentValue.hex,n.element.children[0].style.backgroundColor=p.currentValue.rgba,n.toggle(),i.notify("undo-redo",{prop:"updateUndoRedoStack",value:{isPenDraw:!0}})}},"#"+r+"_pen_stroke"),n=new De({open:function(p){var u=p.element.parentElement;S.isDevice&&(u.style.top=n.element.getBoundingClientRect().top-u.offsetHeight+"px",window.innerWidth<=520&&(u.style.left=i.element.offsetLeft+"px"))},target:".e-pen-color",iconCss:"e-dropdownbtn-preview",cssClass:"e-ie-ddb-popup"},"#"+r+"_penColorBtn");a.inline=!0,a.value=a.getValue(i.activeObj.strokeSettings.strokeColor,"rgba"),a.value==="null"&&(a.value=o);var s={tempFreeHandDrawEditingStyles:null};i.notify("freehand-draw",{prop:"getTempFreeHandDrawEditingStyles",value:{obj:s}});var h={freehandSelectedIndex:null};i.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:h}}),!d(h.freehandSelectedIndex)&&h.freehandSelectedIndex>-1?i.element.querySelector(".e-pen-stroke-color.e-template .e-dropdownbtn-preview").style.background=this.selFhdColor==="#42a5f5"?s.tempFreeHandDrawEditingStyles.strokeColor:i.pointColl[h.freehandSelectedIndex].strokeColor:i.element.querySelector(".e-pen-stroke-color.e-template .e-dropdownbtn-preview").style.background=a.value}},l.prototype.createPenBtn=function(t){var e=this,i=this.parent,r=i.element.id,o=[{id:"1",text:this.l10n.getConstant("XSmall")},{id:"2",text:this.l10n.getConstant("Small")},{id:"3",text:this.l10n.getConstant("Medium")},{id:"4",text:this.l10n.getConstant("Large")},{id:"5",text:this.l10n.getConstant("XLarge")}];if(t.indexOf("strokeWidth")>-1){var a=document.getElementById(r+"_penStrokeWidth"),n=document.createElement("span"),s={freehandSelectedIndex:null};if(i.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:s}}),!d(s.freehandSelectedIndex)&&s.freehandSelectedIndex>-1)n.innerHTML=this.getPenStroke(i.pointColl[s.freehandSelectedIndex].strokeWidth);else{var h={penStrokeWidth:2};i.notify("freehand-draw",{prop:"getPenStrokeWidth",onPropertyChange:!1,value:{obj:h}}),h.penStrokeWidth?n.innerHTML=this.getPenStroke(h.penStrokeWidth):n.innerHTML=this.l10n.getConstant("Small")}n.className="e-pen-stroke-width",a.appendChild(n);var p=new De({items:o,open:function(u){S.isDevice&&(u.element.parentElement.style.top=p.element.getBoundingClientRect().top-u.element.parentElement.offsetHeight+"px");var c=n.innerHTML;u.element.querySelector('[aria-label = "'+c+'"]').classList.add("e-selected-btn")},select:function(u){if(e.triggerTbarClickEvent(u),n.textContent=u.item.text,i.updatePenStrokeWidth(u.item.id),S.isDevice){if(document.getElementById(r+"_bottomToolbar")){var c=Q(r+"_bottomToolbar","toolbar");c.refreshOverflow()}}else if(document.getElementById(r+"_toolbar")){var f=Q(r+"_toolbar","toolbar");f.refreshOverflow()}var g={penStrokeWidth:null};i.notify("freehand-draw",{prop:"getPenStrokeWidth",onPropertyChange:!1,value:{obj:g}}),i.notify("undo-redo",{prop:"updateUndoRedoStack",value:{isPenDraw:!0}}),i.notify("freehand-draw",{prop:"setPenStrokeWidth",onPropertyChange:!1,value:{value:g.penStrokeWidth}})}});p.appendTo("#"+r+"_penStrokeWidth")}},l.prototype.getPenStroke=function(t){var e="",i={1:this.l10n.getConstant("XSmall"),2:this.l10n.getConstant("Small"),3:this.l10n.getConstant("Medium"),4:this.l10n.getConstant("Large"),5:this.l10n.getConstant("XLarge")};return t>=1&&t<=5&&(e=i[t]),e},l.prototype.initAdjustmentToolbarItem=function(){var t=this,e=this.parent,i=e.element.id,r=this.getLeftToolbarItem(null),o=this.getRightToolbarItem(),a=this.getAdjustmentToolbarItem(),n=this.getZoomToolbarItem();S.isDevice?this.defToolbarItems=a:this.defToolbarItems=r.concat(n,a,o);var s={toolbarType:"finetune",toolbarItems:this.defToolbarItems};e.trigger("toolbarUpdating",s),this.defToolbarItems=s.toolbarItems;var h=new dt({width:"100%",items:this.defToolbarItems,clicked:this.defToolbarClicked.bind(this),created:function(){t.wireZoomBtnEvents(),S.isDevice||t.createLeftToolbarControls(),t.defToolbarItems.length>0&&document.getElementById(i+"_toolbar")&&h.refreshOverflow()}});S.isDevice?h.appendTo("#"+i+"_bottomToolbar"):h.appendTo("#"+i+"_toolbar"),this.enableDisableTbrBtn()},l.prototype.initFrameToolbarItem=function(){var t=this,e=this.parent,i=e.element.id,r=document.querySelector("#"+i+"_contextualToolbarArea"),o=document.querySelector("#"+i+"_frameWrapper");o?o.style.display="block":o=r.appendChild(e.createElement("div",{id:i+"_frameWrapper",className:"e-frame-wrapper",styles:"position: relative"})),o.appendChild(e.createElement("div",{id:i+"_customizeWrapper",styles:"position: absolute"}));var a=this.getFrameToolbarItem(),n={toolbarType:"frame",toolbarItems:a};e.trigger("toolbarUpdating",n),a=n.toolbarItems;var s=new dt({width:"100%",items:a,clicked:this.defToolbarClicked.bind(this),created:function(){t.createFrameColor(),t.createFrameSize();var h=e.frameObj.type;h==="line"&&t.createFrameRadius(),(h==="line"||h==="inset"||h==="hook")&&t.createFrameInset(),(h==="line"||h==="inset")&&t.createFrameOffset(),h==="line"&&(t.createFrameAmount(),t.createFrameBorder()),t.createFrameGradientColor(),S.isDevice?t.defToolbarItems.length>0&&document.getElementById(i+"_bottomToolbar")&&(s.refreshOverflow(),s.refreshOverflow(),s.refreshOverflow()):(t.createLeftToolbarControls(),t.defToolbarItems.length>0&&document.getElementById(i+"_toolbar")&&s.refreshOverflow()),e.element.querySelector("#"+i+"_"+h).focus()}});s.appendTo("#"+i+"_customizeWrapper")},l.prototype.createFrameGradientColor=function(){var t=this.parent,e,i={frameChangeEventArgs:null},r=t.element.id;t.element.querySelector(".e-template.e-frame-stroke").appendChild(t.createElement("input",{id:r+"_frame_gradient_fill"}));var o=new Kt({modeSwitcher:!1,noColor:!0,value:t.frameObj.gradientColor,showButtons:!1,mode:"Palette",cssClass:"e-frame-gradient-fill-color",change:function(n){e={type:t.toPascalCase(t.frameObj.type),color:t.frameObj.color,gradientColor:t.frameObj.gradientColor,size:t.frameObj.size,inset:t.frameObj.inset,offset:t.frameObj.offset,borderRadius:t.frameObj.radius,frameLineStyle:t.toPascalCase(t.frameObj.border),lineCount:t.frameObj.amount};var s=t.frameObj.gradientColor,h={currObj:{}};t.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:h}}),t.frameObj.gradientColor=n.currentValue.hex,t.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:e,obj:i}}),i.frameChangeEventArgs&&!i.frameChangeEventArgs.cancel?(t.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"frame",previousObj:h.currObj,previousObjColl:h.currObj.objColl,previousPointColl:h.currObj.pointColl,previousSelPointColl:h.currObj.selPointColl,previousCropObj:y({},t.cropObj,{},!0),previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),t.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),t.notify("draw",{prop:"redrawDownScale"}),n.currentValue.rgba===""?a.element.children[0].classList.add("e-nocolor-item"):(a.element.children[0].classList.remove("e-nocolor-item"),a.element.children[0].style.backgroundColor=n.currentValue.rgba),t.curFrameObjEvent={previousFrameSetting:i.frameChangeEventArgs.previousFrameSetting,currentFrameSetting:i.frameChangeEventArgs.currentFrameSetting},t.isFrameBtnClick=!0):t.frameObj.gradientColor=s,a.toggle()}},"#"+r+"_frame_gradient_fill"),a=new De({open:function(n){if(S.isDevice){var s=n.element.parentElement;s.style.top=a.element.getBoundingClientRect().top-s.offsetHeight+"px",window.innerWidth<=520&&(s.style.left=t.element.offsetLeft+"px")}},target:".e-frame-gradient-fill-color",iconCss:"e-dropdownbtn-preview",cssClass:"e-ie-ddb-popup"},"#"+r+"_frameGradientColorBtn");o.inline=!0,t.frameObj.gradientColor===""?t.element.querySelector(".e-frame-stroke.e-template .e-dropdownbtn-preview").classList.add("e-nocolor-item"):t.element.querySelector(".e-frame-stroke.e-template .e-dropdownbtn-preview").style.background=t.frameObj.gradientColor},l.prototype.createFrameColor=function(){var t=this.parent,e,i={frameChangeEventArgs:null},r=t.element.id;t.element.querySelector(".e-template.e-stroke").appendChild(t.createElement("input",{id:r+"_frame_fill"}));var o=new Kt({modeSwitcher:!1,value:t.frameObj.color,showButtons:!1,mode:"Palette",cssClass:"e-frame-fill-color",change:function(n){e={type:t.toPascalCase(t.frameObj.type),color:t.frameObj.color,gradientColor:t.frameObj.gradientColor,size:t.frameObj.size,inset:t.frameObj.inset,offset:t.frameObj.offset,borderRadius:t.frameObj.radius,frameLineStyle:t.toPascalCase(t.frameObj.border),lineCount:t.frameObj.amount};var s=t.frameObj.color,h={currObj:{}};t.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:h}}),t.frameObj.color=n.currentValue.hex,t.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:e,obj:i}}),i.frameChangeEventArgs&&!i.frameChangeEventArgs.cancel?(t.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"frame",previousObj:h.currObj,previousObjColl:h.currObj.objColl,previousPointColl:h.currObj.pointColl,previousSelPointColl:h.currObj.selPointColl,previousCropObj:y({},t.cropObj,{},!0),previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),t.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),t.notify("draw",{prop:"redrawDownScale"}),n.currentValue.rgba===""?a.element.children[0].classList.add("e-nocolor-item"):(a.element.children[0].classList.remove("e-nocolor-item"),a.element.children[0].style.backgroundColor=n.currentValue.rgba),t.curFrameObjEvent={previousFrameSetting:i.frameChangeEventArgs.previousFrameSetting,currentFrameSetting:i.frameChangeEventArgs.currentFrameSetting},t.isFrameBtnClick=!0):t.frameObj.color=s,a.toggle()}},"#"+r+"_frame_fill"),a=new De({open:function(n){if(S.isDevice){var s=n.element.parentElement;s.style.top=a.element.getBoundingClientRect().top-s.offsetHeight+"px",window.innerWidth<=520&&(s.style.left=t.element.offsetLeft+"px")}},target:".e-frame-fill-color",iconCss:"e-dropdownbtn-preview",cssClass:"e-ie-ddb-popup"},"#"+r+"_frameColorBtn");o.inline=!0,t.element.querySelector(".e-stroke.e-template .e-dropdownbtn-preview").style.background=t.frameObj.color},l.prototype.createFrameSize=function(){var t=this,e=this.parent,i,r={frameChangeEventArgs:null},o=e.element.id,a=[{id:"1",text:this.l10n.getConstant("20")},{id:"2",text:this.l10n.getConstant("40")},{id:"3",text:this.l10n.getConstant("60")},{id:"4",text:this.l10n.getConstant("80")},{id:"5",text:this.l10n.getConstant("100")}],n=document.getElementById(o+"_frameSizeBtn"),s=document.createElement("span");s.innerHTML=this.l10n.getConstant(e.frameObj.size.toString()),s.className="e-frame-stroke-width",n.appendChild(s);var h=new De({items:a,open:function(p){if(S.isDevice){var u=p.element.parentElement;u.style.top=h.element.getBoundingClientRect().top-u.offsetHeight+"px"}var c=h.element.childNodes[0].textContent;c!==""&&p.element.querySelector('[aria-label = "'+c+'"]').classList.add("e-selected-btn")},select:function(p){t.triggerTbarClickEvent(p),i={type:e.toPascalCase(e.frameObj.type),color:e.frameObj.color,gradientColor:e.frameObj.gradientColor,size:e.frameObj.size,inset:e.frameObj.inset,offset:e.frameObj.offset,borderRadius:e.frameObj.radius,frameLineStyle:e.toPascalCase(e.frameObj.border),lineCount:e.frameObj.amount};var u=e.frameObj.size,c={currObj:{}};if(e.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:c}}),e.frameObj.size=parseInt(p.item.text,10),e.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:i,obj:r}}),r.frameChangeEventArgs&&!r.frameChangeEventArgs.cancel?(e.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"frame",previousObj:c.currObj,previousObjColl:c.currObj.objColl,previousPointColl:c.currObj.pointColl,previousSelPointColl:c.currObj.selPointColl,previousCropObj:y({},e.cropObj,{},!0),previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),e.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),e.notify("draw",{prop:"redrawDownScale"}),h.content=p.item.text,e.curFrameObjEvent={previousFrameSetting:r.frameChangeEventArgs.previousFrameSetting,currentFrameSetting:r.frameChangeEventArgs.currentFrameSetting},e.isFrameBtnClick=!0):e.frameObj.size=u,S.isDevice){if(document.getElementById(o+"_bottomToolbar")){var f=Q(o+"_bottomToolbar","toolbar");f.refreshOverflow()}}else if(document.getElementById(o+"_toolbar")){var g=Q(o+"_toolbar","toolbar");g.refreshOverflow()}}});h.appendTo("#"+o+"_frameSizeBtn")},l.prototype.createFrameInset=function(){var t=this,e=this.parent,i,r={frameChangeEventArgs:null},o=e.element.id,a=[{id:"1",text:this.l10n.getConstant("20")},{id:"2",text:this.l10n.getConstant("40")},{id:"3",text:this.l10n.getConstant("60")},{id:"4",text:this.l10n.getConstant("80")},{id:"5",text:this.l10n.getConstant("100")}],n=document.getElementById(o+"_frameInsetBtn"),s=document.createElement("span");s.innerHTML=this.l10n.getConstant(e.frameObj.inset.toString()),s.className="e-frame-inset",n.appendChild(s);var h=new De({items:a,open:function(p){if(S.isDevice){var u=p.element.parentElement;u.style.top=h.element.getBoundingClientRect().top-u.offsetHeight+"px"}var c=h.element.childNodes[0].textContent;c!==""&&p.element.querySelector('[aria-label = "'+c+'"]').classList.add("e-selected-btn")},select:function(p){t.triggerTbarClickEvent(p),i={type:e.toPascalCase(e.frameObj.type),color:e.frameObj.color,gradientColor:e.frameObj.gradientColor,size:e.frameObj.size,inset:e.frameObj.inset,offset:e.frameObj.offset,borderRadius:e.frameObj.radius,frameLineStyle:e.toPascalCase(e.frameObj.border),lineCount:e.frameObj.amount};var u=e.frameObj.inset,c={currObj:{}};if(e.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:c}}),e.frameObj.inset=parseInt(p.item.text,10),e.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:i,obj:r}}),r.frameChangeEventArgs&&!r.frameChangeEventArgs.cancel?(e.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"frame",previousObj:c.currObj,previousObjColl:c.currObj.objColl,previousPointColl:c.currObj.pointColl,previousSelPointColl:c.currObj.selPointColl,previousCropObj:y({},e.cropObj,{},!0),previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),e.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),e.notify("draw",{prop:"redrawDownScale"}),h.content=p.item.text,e.curFrameObjEvent={previousFrameSetting:r.frameChangeEventArgs.previousFrameSetting,currentFrameSetting:r.frameChangeEventArgs.currentFrameSetting},e.isFrameBtnClick=!0):e.frameObj.inset=u,S.isDevice){if(document.getElementById(o+"_bottomToolbar")){var f=Q(o+"_bottomToolbar","toolbar");f.refreshOverflow()}}else if(document.getElementById(o+"_toolbar")){var g=Q(o+"_toolbar","toolbar");g.refreshOverflow()}}});h.appendTo("#"+o+"_frameInsetBtn")},l.prototype.createFrameOffset=function(){var t=this,e=this.parent,i,r={frameChangeEventArgs:null},o=e.element.id,a=[{id:"1",text:this.l10n.getConstant("20")},{id:"2",text:this.l10n.getConstant("40")},{id:"3",text:this.l10n.getConstant("60")},{id:"4",text:this.l10n.getConstant("80")},{id:"5",text:this.l10n.getConstant("100")}],n=document.getElementById(o+"_frameOffsetBtn"),s=document.createElement("span");s.innerHTML=this.l10n.getConstant(e.frameObj.offset.toString()),s.className="e-frame-offset",n.appendChild(s);var h=new De({items:a,open:function(p){if(S.isDevice){var u=p.element.parentElement;u.style.top=h.element.getBoundingClientRect().top-u.offsetHeight+"px"}var c=h.element.childNodes[0].textContent;c!==""&&p.element.querySelector('[aria-label = "'+c+'"]').classList.add("e-selected-btn")},select:function(p){t.triggerTbarClickEvent(p),i={type:e.toPascalCase(e.frameObj.type),color:e.frameObj.color,gradientColor:e.frameObj.gradientColor,size:e.frameObj.size,inset:e.frameObj.inset,offset:e.frameObj.offset,borderRadius:e.frameObj.radius,lineCount:e.frameObj.amount,frameLineStyle:e.toPascalCase(e.frameObj.border)};var u=e.frameObj.offset,c={currObj:{}};if(e.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:c}}),e.frameObj.offset=parseInt(p.item.text,10),e.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:i,obj:r}}),r.frameChangeEventArgs&&!r.frameChangeEventArgs.cancel?(e.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"frame",previousObj:c.currObj,previousObjColl:c.currObj.objColl,previousPointColl:c.currObj.pointColl,previousSelPointColl:c.currObj.selPointColl,previousCropObj:y({},e.cropObj,{},!0),previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),e.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),e.notify("draw",{prop:"redrawDownScale"}),h.content=p.item.text,e.curFrameObjEvent={previousFrameSetting:r.frameChangeEventArgs.previousFrameSetting,currentFrameSetting:r.frameChangeEventArgs.currentFrameSetting},e.isFrameBtnClick=!0):e.frameObj.offset=u,S.isDevice){if(document.getElementById(o+"_bottomToolbar")){var f=Q(o+"_bottomToolbar","toolbar");f.refreshOverflow()}}else if(document.getElementById(o+"_toolbar")){var g=Q(o+"_toolbar","toolbar");g.refreshOverflow()}}});h.appendTo("#"+o+"_frameOffsetBtn")},l.prototype.createFrameRadius=function(){var t=this,e=this.parent,i,r={frameChangeEventArgs:null},o=e.element.id,a=[{id:"1",text:this.l10n.getConstant("0")},{id:"2",text:this.l10n.getConstant("20")},{id:"3",text:this.l10n.getConstant("40")},{id:"4",text:this.l10n.getConstant("60")},{id:"5",text:this.l10n.getConstant("80")},{id:"6",text:this.l10n.getConstant("100")}],n=document.getElementById(o+"_frameRadiusBtn"),s=document.createElement("span");s.innerHTML=this.l10n.getConstant(e.frameObj.radius.toString()),s.className="e-frame-radius",n.appendChild(s);var h=new De({items:a,open:function(p){if(S.isDevice){var u=p.element.parentElement;u.style.top=h.element.getBoundingClientRect().top-u.offsetHeight+"px"}var c=h.element.childNodes[0].textContent;c!==""&&p.element.querySelector('[aria-label = "'+c+'"]').classList.add("e-selected-btn")},select:function(p){t.triggerTbarClickEvent(p),i={type:e.toPascalCase(e.frameObj.type),color:e.frameObj.color,gradientColor:e.frameObj.gradientColor,size:e.frameObj.size,inset:e.frameObj.inset,offset:e.frameObj.offset,borderRadius:e.frameObj.radius,frameLineStyle:e.toPascalCase(e.frameObj.border),lineCount:e.frameObj.amount};var u=e.frameObj.radius,c={currObj:{}};if(e.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:c}}),e.frameObj.radius=parseInt(p.item.text,10),e.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:i,obj:r}}),r.frameChangeEventArgs&&!r.frameChangeEventArgs.cancel?(e.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"frame",previousObj:c.currObj,previousObjColl:c.currObj.objColl,previousPointColl:c.currObj.pointColl,previousSelPointColl:c.currObj.selPointColl,previousCropObj:y({},e.cropObj,{},!0),previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),e.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),e.notify("draw",{prop:"redrawDownScale"}),h.content=p.item.text,e.curFrameObjEvent={previousFrameSetting:r.frameChangeEventArgs.previousFrameSetting,currentFrameSetting:r.frameChangeEventArgs.currentFrameSetting},e.isFrameBtnClick=!0):e.frameObj.radius=u,S.isDevice){if(document.getElementById(o+"_bottomToolbar")){var f=Q(o+"_bottomToolbar","toolbar");f.refreshOverflow()}}else if(document.getElementById(o+"_toolbar")){var g=Q(o+"_toolbar","toolbar");g.refreshOverflow()}}});h.appendTo("#"+o+"_frameRadiusBtn")},l.prototype.createFrameAmount=function(){var t=this,e=this.parent,i,r={frameChangeEventArgs:null},o=e.element.id,a=[{id:"1",text:this.l10n.getConstant("1")},{id:"2",text:this.l10n.getConstant("2")},{id:"3",text:this.l10n.getConstant("3")},{id:"4",text:this.l10n.getConstant("4")},{id:"5",text:this.l10n.getConstant("5")}],n=document.getElementById(o+"_frameAmountBtn"),s=document.createElement("span");s.innerHTML=this.l10n.getConstant(e.frameObj.amount.toString()),s.className="e-frame-amount",n.appendChild(s);var h=new De({items:a,open:function(p){if(S.isDevice){var u=p.element.parentElement;u.style.top=h.element.getBoundingClientRect().top-u.offsetHeight+"px"}var c=h.element.childNodes[0].textContent;c!==""&&p.element.querySelector('[aria-label = "'+c+'"]').classList.add("e-selected-btn")},select:function(p){t.triggerTbarClickEvent(p),i={type:e.toPascalCase(e.frameObj.type),color:e.frameObj.color,gradientColor:e.frameObj.gradientColor,size:e.frameObj.size,inset:e.frameObj.inset,offset:e.frameObj.offset,borderRadius:e.frameObj.radius,lineCount:e.frameObj.amount,frameLineStyle:e.toPascalCase(e.frameObj.border)};var u=e.frameObj.amount,c={currObj:{}};if(e.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:c}}),e.frameObj.amount=parseInt(p.item.text,10),e.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:i,obj:r}}),r.frameChangeEventArgs&&!r.frameChangeEventArgs.cancel?(e.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"frame",previousObj:c.currObj,previousObjColl:c.currObj.objColl,previousPointColl:c.currObj.pointColl,previousSelPointColl:c.currObj.selPointColl,previousCropObj:y({},e.cropObj,{},!0),previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),e.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),e.notify("draw",{prop:"redrawDownScale"}),h.content=p.item.text,e.curFrameObjEvent={previousFrameSetting:r.frameChangeEventArgs.previousFrameSetting,currentFrameSetting:r.frameChangeEventArgs.currentFrameSetting},e.isFrameBtnClick=!0):e.frameObj.amount=u,S.isDevice){if(document.getElementById(o+"_bottomToolbar")){var f=Q(o+"_bottomToolbar","toolbar");f.refreshOverflow()}}else if(document.getElementById(o+"_toolbar")){var g=Q(o+"_toolbar","toolbar");g.refreshOverflow()}}});h.appendTo("#"+o+"_frameAmountBtn")},l.prototype.createFrameBorder=function(){var t=this,e=this.parent,i,r={frameChangeEventArgs:null},o=e.element.id,a=[{id:"1",text:this.l10n.getConstant("Solid")},{id:"2",text:this.l10n.getConstant("Dashed")},{id:"3",text:this.l10n.getConstant("Dotted")}],n=document.getElementById(o+"_frameBorderBtn"),s=document.createElement("span");s.innerHTML=this.l10n.getConstant(e.toPascalCase(e.frameObj.border)),s.className="e-frame-border",n.appendChild(s);var h=new De({items:a,open:function(p){if(S.isDevice){var u=p.element.parentElement;u.style.top=h.element.getBoundingClientRect().top-u.offsetHeight+"px"}var c=h.element.childNodes[0].textContent;c!==""&&p.element.querySelector('[aria-label = "'+c+'"]').classList.add("e-selected-btn")},select:function(p){t.triggerTbarClickEvent(p),i={lineCount:e.frameObj.amount,color:e.frameObj.color,borderRadius:e.frameObj.radius,gradientColor:e.frameObj.gradientColor,size:e.frameObj.size,inset:e.frameObj.inset,offset:e.frameObj.offset,frameLineStyle:e.toPascalCase(e.frameObj.border),type:e.toPascalCase(e.frameObj.type)};var u=e.frameObj.border,c={currObj:{}};if(e.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:c}}),e.frameObj.border=p.item.text.toLowerCase(),e.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:i,obj:r}}),r.frameChangeEventArgs&&!r.frameChangeEventArgs.cancel?(e.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"frame",previousObj:c.currObj,previousObjColl:c.currObj.objColl,previousPointColl:c.currObj.pointColl,previousSelPointColl:c.currObj.selPointColl,previousCropObj:y({},e.cropObj,{},!0),previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),e.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),e.notify("draw",{prop:"redrawDownScale"}),h.content=p.item.text,e.curFrameObjEvent={previousFrameSetting:r.frameChangeEventArgs.previousFrameSetting,currentFrameSetting:r.frameChangeEventArgs.currentFrameSetting},e.isFrameBtnClick=!0):e.frameObj.border=u,S.isDevice){if(document.getElementById(o+"_bottomToolbar")){var f=Q(o+"_bottomToolbar","toolbar");f.refreshOverflow()}}else if(document.getElementById(o+"_toolbar")){var g=Q(o+"_toolbar","toolbar");g.refreshOverflow()}}});h.appendTo("#"+o+"_frameBorderBtn")},l.prototype.initFilterToolbarItem=function(){var t=this,e=this.parent,i=e.element.id,r=this.getFilterToolbarItem(),o={toolbarType:"filter",toolbarItems:r};e.trigger("toolbarUpdating",o),r=o.toolbarItems,document.querySelector("#"+i+"_contextualToolbar").classList.contains("e-control")&&Q(document.getElementById(i+"_contextualToolbar"),"toolbar").destroy();var a=new dt({width:"100%",items:r,clicked:this.contextualToolbarClicked.bind(this),created:function(){t.updatePrivateVariables(),t.createCanvasFilter(),e.currentFilter===""&&(e.currentFilter=i+"_default");var n=document.querySelector("#"+i+"_headWrapper");n&&(n.style.display="none");var s=document.getElementById(e.currentFilter+"Canvas");s&&s.parentElement.parentElement.classList.add("e-selected"),t.enableDisableTbrBtn(),a.refreshOverflow()}});a.appendTo("#"+i+"_contextualToolbar")},l.prototype.drawDashedLine=function(t){t.beginPath(),t.setLineDash([5]),t.rect(10,10,280,130),t.stroke(),t.closePath()},l.prototype.createCanvasFilter=function(){var t=this.parent;Bt(t.element),t.element.style.opacity="0.5";var e=t.getCurrentCanvasData();this.inMemoryCanvas.width=e.width,this.inMemoryCanvas.height=e.height,this.inMemoryContext.putImageData(e,0,0),this.updateFilterCanvas("_defaultCanvas","default"),this.updateFilterCanvas("_chromeCanvas","chrome"),this.updateFilterCanvas("_coldCanvas","cold"),this.updateFilterCanvas("_warmCanvas","warm"),this.updateFilterCanvas("_grayscaleCanvas","grayscale"),this.updateFilterCanvas("_sepiaCanvas","sepia"),this.updateFilterCanvas("_invertCanvas","invert"),gt(t.element),t.element.style.opacity="1",t.initialAdjustmentValue=this.lowerContext.filter},l.prototype.updateFilterCanvas=function(t,e){var i=this.parent,r=i.element.querySelector("#"+i.element.id+t);if(r){var o=r.getContext("2d");o=r.getContext("2d"),r.style.width="100px",r.style.height="100px",i.notify("filter",{prop:"updateAdj",value:{type:e,value:null,isPreview:!0,ctx:o}}),o.drawImage(this.inMemoryCanvas,0,0,300,150),i.isSafari&&i.notify("filter",{prop:"apply-filter",onPropertyChange:!1,value:{context:o}})}},l.prototype.getQuickAccessToolbarItem=function(t){var e=this.parent,i=e.element.id,r={cancel:!1,toolbarItems:[]},o=[];d(t)?(e.activeObj.shape==="image"&&o.push("Flip"),e.activeObj.shape!=="redact"&&o.push("BringToFront"),o.push("Clone"),o.push("Delete"),e.activeObj.shape==="text"&&o.push("EditText"),r.shape=e.toPascalCase(e.activeObj.shape)):t&&(o.push("BringToFront"),o.push("Delete"),r.shape="Freehand draw"),r.toolbarItems=y([],o,null,!0),e.trigger("quickAccessToolbarOpen",r);var a=[];if(r.cancel)a=[];else for(var n=0;n<r.toolbarItems.length;n++)switch(r.toolbarItems[n]){case"BringToFront":a.push({id:i+"_bringToFront",prefixIcon:"e-icons e-bring-to-front",tooltipText:this.l10n.getConstant("BringToFront"),align:"Left"});break;case"Clone":a.push({id:i+"_duplicate",prefixIcon:"e-icons e-order",cssClass:"top-icon e-order",tooltipText:this.l10n.getConstant("Duplicate"),align:"Left"});break;case"Delete":a.push({id:i+"_remove",prefixIcon:"e-icons e-trash",cssClass:"top-icon e-trash",tooltipText:this.l10n.getConstant("Remove"),align:"Left"});break;case"EditText":a.push({id:i+"_editText",prefixIcon:"e-icons e-annotation-edit",cssClass:"top-icon e-annotation-edit",tooltipText:this.l10n.getConstant("EditText"),align:"Left"});break;case"Flip":a.push({id:i+"_hFlip",prefixIcon:"e-icons e-horizontal-flip",tooltipText:this.l10n.getConstant("HorizontalFlip"),align:"Left"}),a.push({id:i+"_vFlip",prefixIcon:"e-icons e-vertical-flip",tooltipText:this.l10n.getConstant("VerticalFlip"),align:"Left"});break;default:a.push(r.toolbarItems[n]);break}return a},l.prototype.renderQAT=function(t){var e=this.parent,i=e.element.id;if(e.activeObj&&e.showQuickAccessToolbar){var r=document.getElementById(i+"_quickAccessToolbarArea");r&&(this.destroyQuickAccessToolbar(),r.style.display="block");var o=this.getQuickAccessToolbarItem(t);if(o.length===0)return;if(d(e.quickAccessToolbarTemplate)){var a=new dt({items:o,clicked:this.quickAccessToolbarClicked.bind(this)});a.appendTo("#"+i+"_quickAccessToolbar")}var n=this.toolbarHeight&&this.toolbarHeight!==0?this.toolbarHeight:r.clientHeight,s=e.element.querySelector("#"+i+"_headWrapper");if(d(t)&&(e.activeObj.activePoint.width!==0||e.activeObj.activePoint.height!==0||e.activeObj.shape&&e.activeObj.shape==="path"&&e.activeObj.pointColl.length>0)){var h={order:null};e.notify("shape",{prop:"getHighestOrder",onPropertyChange:!1,value:{obj:h}}),e.activeObj.order>h.order&&document.getElementById(e.element.id+"_bringToFront")?document.getElementById(e.element.id+"_bringToFront").classList.add("e-overlay"):document.getElementById(e.element.id+"_bringToFront")&&document.getElementById(e.element.id+"_bringToFront").classList.remove("e-overlay"),r.style.width="auto",e.activeObj.activePoint.width=Math.abs(e.activeObj.activePoint.width),e.activeObj.activePoint.height=Math.abs(e.activeObj.activePoint.height);var p=e.activeObj.activePoint.startX<e.activeObj.activePoint.endX?e.activeObj.activePoint.startX:e.activeObj.activePoint.endX,u=e.activeObj.activePoint.startY<e.activeObj.activePoint.endY?e.activeObj.activePoint.startY:e.activeObj.activePoint.endY,c=e.activeObj.activePoint.width;if(e.activeObj.rotatedAngle!==0&&e.activeObj.shape!=="arrow"){var f={activePoint:null};e.notify("shape",{prop:"getSquarePointForRotatedShape",onPropertyChange:!1,value:{obj:e.activeObj,object:f}});var g=f.activePoint;p=g.startX,u=g.startY,c=g.width}else if(e.activeObj.shape==="path"){var v=e.getSquarePointForPath(e.activeObj);p=v.startX,u=v.startY,c=v.width}if(r.style.left=p+c/2-o.length*25+"px",parseFloat(r.style.left)+r.clientWidth/2!==p+c/2){var m=p+c/2-(parseFloat(r.style.left)+r.clientWidth/2);r.style.left=parseFloat(r.style.left)+m+"px"}s&&(n=s.offsetHeight+n),u-(n+n/1.5)<e.img.destTop?(r.style.top=e.img.destTop+"px",s&&(r.style.top=(e.img.destTop<0?0:e.img.destTop)+s.offsetHeight+"px")):(n=this.toolbarHeight,r.style.top=u-(n+n/1.5)+"px")}else if(t){var C={freehandSelectedIndex:-1};e.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:C}});var h={order:null};e.notify("shape",{prop:"getHighestOrder",onPropertyChange:!1,value:{obj:h}}),e.getObjFromId(e.pointColl[C.freehandSelectedIndex].id).order>=h.order&&document.getElementById(e.element.id+"_bringToFront")?document.getElementById(e.element.id+"_bringToFront").classList.add("e-overlay"):document.getElementById(e.element.id+"_bringToFront")&&document.getElementById(e.element.id+"_bringToFront").classList.remove("e-overlay");var M={activePoint:null};e.notify("freehand-draw",{prop:"getSqPtFD",value:{idx:C.freehandSelectedIndex,obj:M}});var g=M.activePoint;r.style.width="auto",r.style.left=g.startX+g.width/2-o.length*24+"px",g.startY-(n+n/1.5)<e.img.destTop?r.style.top=e.img.destTop+"px":r.style.top=g.startY-(n+n/1.5)+"px"}else r.style.display="none";parseFloat(r.style.top)<0&&(r.style.top="0px")}},l.prototype.refreshDropDownBtn=function(t){if(!d(t)){var e=this.parent,i=e.element.id,r=document.querySelector("#"+i+"_annotationBtn");r&&(t?(r.classList.add("e-disabled"),r.parentElement.classList.add("e-overlay")):(r.classList.remove("e-disabled"),r.parentElement.classList.remove("e-overlay")),Q(r,"dropdown-btn").disabled=t);var o=document.querySelector("#"+i+"_transformBtn");o&&(t?(o.classList.add("e-disabled"),o.parentElement.classList.add("e-overlay")):(o.classList.remove("e-disabled"),o.parentElement.classList.remove("e-overlay")),Q(o,"dropdown-btn").disabled=t);var a=document.querySelector("#"+i+"_adjustment");a&&(t?(a.classList.add("e-disabled"),a.parentElement.classList.add("e-overlay")):(a.classList.remove("e-disabled"),a.parentElement.classList.remove("e-overlay")),Q(a,"btn").disabled=t);var n=document.querySelector("#"+i+"_filter");n&&(t?(n.classList.add("e-disabled"),n.parentElement.classList.add("e-overlay")):(n.classList.remove("e-disabled"),n.parentElement.classList.remove("e-overlay")),Q(n,"btn").disabled=t)}},l.prototype.cropSelect=function(t){var e=this.parent;e.isCropTab=!0,d(e.transform.cropZoomFactor)&&(e.transform.cropZoomFactor=e.transform.zoomFactor,e.notify("draw",{prop:"setTempZoomFactor",onPropertyChange:!1,value:{tempZoomFactor:e.transform.zoomFactor}})),e.transform.zoomFactor=e.transform.cropZoomFactor;var i=t.item.id;this.currentToolbar="crop",e.currSelectionPoint=null,e.notify("draw",{prop:"setIsCropSelect",value:{bool:!0}});var r={prevObj:null};e.notify("crop",{prop:"getPreviousCropCurrentObj",value:{obj:r}}),e.notify("draw",{prop:"select",onPropertyChange:!1,value:{type:i,startX:null,startY:null,width:null,height:null}}),e.notify("crop",{prop:"setPreviousCropCurrentObj",value:{obj:r.prevObj}}),this.enableDisableTbrBtn(),e.notify("transform",{prop:"disableZoomOutBtn",value:{isZoomOut:!0}})},l.prototype.quickAccessToolbarClicked=function(t,e){var i=this.parent,r=i.element.id;if(t.item){var o=null,a={prevActObj:null},n={tempObj:null};i.notify("draw",{prop:"getPrevActObj",onPropertyChange:!1,value:{obj:a}}),i.notify("selection",{prop:"getTempActObj",onPropertyChange:!1,value:{obj:n}}),n.tempObj.activePoint.height=Math.abs(n.tempObj.activePoint.height);var s={isNewPath:null},h=void 0;i.notify("draw",{prop:"getNewPath",value:{obj:s}});var p=t.item.id.replace(r+"_","").toLowerCase(),u=void 0,c=void 0,f={freehandSelectedIndex:null},g=void 0,v=void 0,m={order:null};switch(p){case"duplicate":i.element.querySelector("#"+r+"_duplicate").classList.contains("e-overlay")||(this.refreshSlider(),!s.isNewPath&&JSON.stringify(n.tempObj)===JSON.stringify(i.activeObj)&&(o=!0),this.duplicateShape(o));break;case"remove":i.element.querySelector("#"+r+"_remove").classList.contains("e-overlay")||(i.noPushUndo=!1,this.refreshSlider(),i.notify("selection",{prop:"deleteItem",onPropertyChange:!1}));break;case"edittext":i.element.querySelector("#"+r+"_editText").classList.contains("e-overlay")||this.editText();break;case"rotleft":case"rotright":u=i.element.querySelector("#"+r+"_rotLeft"),c=i.element.querySelector("#"+r+"_rotRight"),(u&&!u.classList.contains("e-disabled")||c&&!c.classList.contains("e-disabled"))&&i.rotateImage(t.item.id.replace(r+"_","").toLowerCase()),i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1});break;case"hflip":i.element.querySelector("#"+r+"_hFlip").classList.contains("e-disabled")||(h=i.activeObj.imageCanvas.getContext("2d"),i.horizontalFlip(h)),i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1});break;case"vflip":i.element.querySelector("#"+r+"_vFlip").classList.contains("e-disabled")||(h=i.activeObj.imageCanvas.getContext("2d"),i.verticalFlip(h)),i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1});break;case"bringtofront":if(!i.element.querySelector("#"+r+"_bringToFront").classList.contains("e-overlay")){if(i.notify("freehand-draw",{prop:"getFreehandSelectedIndex",onPropertyChange:!1,value:{obj:f}}),g=f.freehandSelectedIndex!==null?i.pointColl[f.freehandSelectedIndex].id:i.activeObj.currIndex,i.updateShapeOrder(g,p),v=!1,i.notify("shape",{prop:"getHighestOrder",onPropertyChange:!1,value:{obj:m}}),g.indexOf("pen")>-1){i.notify("shape",{prop:"updateShapeColl",onPropertyChange:!1});var C=i.getObjFromId(g).order;v=C>=m.order}else{var C=i.getObjFromId(g).order;v=C>m.order}v?document.getElementById(i.element.id+"_bringToFront").classList.add("e-overlay"):document.getElementById(i.element.id+"_bringToFront").classList.remove("e-overlay"),i.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})}break}(p==="duplicate"||p==="remove")&&i.notify("draw",{prop:"redrawDownScale"})}d(e)&&i.trigger("quickAccessToolbarItemClick",t)},l.prototype.editText=function(){var t=this.parent,e={x:t.activeObj.activePoint.startX,y:t.activeObj.activePoint.startY};if(this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.notify("selection",{prop:"setTempActObj",onPropertyChange:!1,value:{obj:y({},t.activeObj,{},!0)}}),t.notify("selection",{prop:"setInitialTextEdit",onPropertyChange:!1,value:{bool:!0}}),t.notify("draw",{prop:"setPrevActObj",onPropertyChange:!1,value:{prevActObj:y({},t.activeObj,{},!0)}}),t.activeObj.rotatedAngle!==0){var i={x:e.x,y:e.y};t.notify("shape",{prop:"getTextBoxPosition",onPropertyChange:!1,value:{obj:t.activeObj,object:i}}),e.x=i.x,e.y=i.y;var r={x:e.x,y:e.y};t.notify("shape",{prop:"setFlipState",onPropertyChange:!1,value:{x:e.x,y:e.y,obj:t.activeObj,object:r}}),e.x=r.x,e.y=r.y}var o=y({},t.activeObj,{},!0);t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),this.lowerContext.clearRect(0,0,t.upperCanvas.width,t.upperCanvas.height),t.notify("draw",{prop:"redrawImgWithObj",onPropertyChange:!1}),t.notify("draw",{prop:"redrawDownScale"}),t.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.lowerContext}}),t.notify("draw",{prop:"clearOuterCanvas",onPropertyChange:!1,value:{context:this.upperContext}}),t.activeObj=o,t.notify("shape",{prop:"renderTextArea",onPropertyChange:!1,value:{x:e.x,y:e.y,actObj:t.activeObj}}),d(t.activeObj.currIndex)&&t.notify("draw",{prop:"setShapeTextInsert",onPropertyChange:!1,value:{bool:!0}}),document.getElementById(t.element.id+"_quickAccessToolbarArea")&&(document.getElementById(t.element.id+"_quickAccessToolbarArea").style.display="none")},l.prototype.duplicateShape=function(t,e){var i=this.parent,r={activePoint:{startX:0,startY:0,endX:0,endY:0,width:0,height:0},flipObjColl:[],triangle:[],triangleRatio:[]};i.notify("selection",{prop:"setTempActObj",onPropertyChange:!1,value:{obj:r}});var o={prevActObj:null};i.notify("draw",{prop:"getPrevActObj",onPropertyChange:!1,value:{obj:o}});var a={isNewPath:null};i.notify("draw",{prop:"getNewPath",value:{obj:a}});var n,s=y({},i.activeObj,{},!0),h={order:null};i.notify("shape",{prop:"getHighestOrder",onPropertyChange:!1,value:{obj:h}}),s.order?(i.notify("shape",{prop:"updateShapeColl",onPropertyChange:!1}),s.order=h.order>s.order?h.order+1:s.order+1):(i.noPushUndo=!0,i.okBtn(),i.noPushUndo=!1,i.selectShape(s.currIndex),s.order=h.order>s.order?h.order+1:s.order+1),s.shape==="image"&&(n=y([],i.objColl,[],!0),i.notify("undo-redo",{prop:"updateUrObj",onPropertyChange:!1,value:{objColl:n}})),d(i.activeObj.currIndex)?i.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:t}}):o.prevActObj||e?(i.activeObj.currIndex=null,s.currIndex=null,i.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:t}})):i.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:!0}});var p=i.noPushUndo;if(i.noPushUndo=!1,i.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),i.noPushUndo=p,n=y([],i.objColl,[],!0),s.activePoint.startX+=10,s.activePoint.startY-=10,s.activePoint.endX+=10,s.activePoint.endY-=10,s.shape==="path")for(var u=0;u<s.pointColl.length;u++)s.pointColl[u].x+=10,s.pointColl[u].y-=10;else s.shape==="image"&&(s.imageCanvas=i.createElement("canvas"));var c={id:"shape_"+(i.objColl.length+1)};if(i.notify("shape",{prop:"getNewShapeId",onPropertyChange:!1,value:{obj:c}}),s.currIndex=c.id,i.activeObj=y({},s,{},!0),i.activeObj.shape==="image"){var f=y({},s.activePoint,{},!0),g={width:0,height:0};i.notify("transform",{prop:"calcMaxDimension",onPropertyChange:!1,value:{width:i.activeObj.imageElement.width,height:i.activeObj.imageElement.height,obj:g,isImgShape:null}}),i.activeObj.activePoint.width=g.width,i.activeObj.activePoint.height=g.height,i.activeObj.isHorImageFlip&&i.activeObj.isVerImageFlip?(i.activeObj.isHorImageFlip=i.activeObj.isVerImageFlip=!1,i.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:s.imageCanvas.getContext("2d"),isImgAnnotation:!0,isHFlip:!0,isVFlip:!0}}),i.activeObj.isHorImageFlip=i.activeObj.isVerImageFlip=!0):i.activeObj.isHorImageFlip?(i.activeObj.isHorImageFlip=!1,i.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:s.imageCanvas.getContext("2d"),isImgAnnotation:!0,isHFlip:!0,isVFlip:null}}),i.activeObj.isHorImageFlip=!0):i.activeObj.isVerImageFlip?(i.activeObj.isVerImageFlip=!1,i.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:s.imageCanvas.getContext("2d"),isImgAnnotation:!0,isHFlip:null,isVFlip:!0}}),i.activeObj.isVerImageFlip=!0):i.notify("draw",{prop:"downScaleImgCanvas",onPropertyChange:!1,value:{ctx:s.imageCanvas.getContext("2d"),isImgAnnotation:!0,isHFlip:null,isVFlip:null}}),i.activeObj.activePoint=f}(i.activeObj.shape==="line"||i.activeObj.shape==="arrow")&&i.notify("shape",{prop:"setPointCollForLineArrow",onPropertyChange:!1,value:{obj:i.activeObj}}),i.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:i.activeObj,isCropRatio:null,points:null,isPreventDrag:!0}}),i.notify("undo-redo",{prop:"updateUrObj",onPropertyChange:!1,value:{objColl:n}}),i.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:!0}}),i.noPushUndo=!1,i.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}}),i.noPushUndo=!0,i.notify("selection",{prop:"redrawShape",onPropertyChange:!1,value:{obj:i.objColl[i.objColl.length-1]}});var v=i.element.id,m=S.isDevice?"#"+v+"_bottomToolbar #"+v:"#"+v,C={freehandDrawSelectedId:null};i.notify("freehand-draw",{prop:"getFreehandDrawSelectedId",onPropertyChange:!1,value:{obj:C}}),this.enableDisableCloneBtn(m,C),this.renderQAT(),i.activeObj.shape&&i.activeObj.shape==="redact"&&this.redactSlider(i.activeObj.redactType)},l.prototype.defToolbarClicked=function(t){var e=this.parent,i=e.element.id,r=!1,o=!1;if(!this.isFrameToolbar&&e.element.querySelector(".e-contextual-toolbar-wrapper")){e.element.querySelector(".e-contextual-toolbar-wrapper").classList.contains("e-hide")||(r=o=!0);var a={bool:e.isStraightening};(!S.isDevice||S.isDevice&&!a.bool)&&e.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide")}if(t.item){var n=t.item.id.replace(i+"_","").toLowerCase();if(n==="duplicate"||n==="remove"||n==="edittext"||n==="hflip"||n==="vflip"||n==="rotleft"||n==="rotright")this.quickAccessToolbarClicked(t,!0),e.trigger("toolbarItemClicked",t);else{var s=!1,h=!1,p=document.querySelector("#"+i+"_adjustment");p&&p.classList.contains("e-disabled")&&(h=!0);var u=document.querySelector("#"+i+"_filter");u&&u.classList.contains("e-disabled")&&(s=!0),this.enableDisableTbrBtn(),this.performDefTbrClick(n,r,h,s,o),e.trigger("toolbarItemClicked",t),e.isStraightening&&e.notify("transform",{prop:"disableZoomOutBtn",value:{isZoomOut:!0}});var c=["undo","redo","cancel","aspectratio","nonaspectratio","save","duplicate","filter","frame","none","mat","bevel","line","inset","hook","resize","remove"];c.indexOf(n)!==-1&&e.notify("draw",{prop:"redrawDownScale"})}}},l.prototype.performDefTbrClick=function(t,e,i,r,o){var a=this.parent,n=a.element.id,s=a.element.querySelector("#"+n+"_zoomIn"),h=a.element.querySelector("#"+n+"_resizeHeight"),p=a.element.querySelector("#"+n+"_resizeWidth"),u=!1,c,f,g,v,m=!1,C=0,M,I=!1;if(a.activeObj.shape!==void 0&&(f=a.activeObj.shape.split("-")),(f===void 0&&a.currObjType.isCustomCrop||f!==void 0&&f[0]==="crop")&&(u=!0),!a.disabled){switch(t){case"pan":a.currObjType.isCustomCrop=a.currObjType.isFiltered=!1,a.currObjType.isRedact=!1,a.currObjType.isUndoAction&&a.notify("undo-redo",{prop:"refreshUrc",value:{bool:null}}),u&&(a.currObjType.isCustomCrop=!1,a.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.upperContext.clearRect(0,0,a.upperCanvas.width,a.upperCanvas.height),this.refreshToolbar("main")),a.togglePan?(this.cancelPan(),a.notify("transform",{prop:"setDisablePan",onPropertyChange:!1,value:{bool:!0}}),this.currentToolbar==="pen"&&a.freeHandDraw(!0)):(c=a.element.querySelector(".e-img-pan .e-btn"),c&&c.classList.add("e-selected-btn"),a.pan(!0),a.notify("transform",{prop:"setDisablePan",onPropertyChange:!1,value:{bool:!1}})),s&&a.zoomSettings.zoomFactor>=a.zoomSettings.maxZoomFactor?(s.classList.add("e-disabled"),s.parentElement.classList.add("e-overlay")):s&&(s.classList.remove("e-disabled"),s.parentElement.classList.remove("e-overlay")),this.refreshToolbar("main");break;case"cancel":a.currObjType.isRedact&&(a.currObjType.isRedact=!1),this.isFrameToolbar&&a.element.querySelector(".e-contextual-toolbar-wrapper")&&!a.element.querySelector(".e-contextual-toolbar-wrapper").classList.contains("e-hide")&&a.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide"),a.notify("draw",{prop:"performCancel",value:{isContextualToolbar:e,isFinalCancel:!0}});break;case"ok":S.isDevice&&this.isFrameToolbar&&a.element.querySelector(".e-contextual-toolbar-wrapper")&&!a.element.querySelector(".e-contextual-toolbar-wrapper").classList.contains("e-hide")&&a.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide"),a.okBtn(null,!0),a.drawingShape=null,this.refreshDropDownBtn(!1),this.currentToolbar="main",a.isStraightening=!1,a.notify("draw",{prop:"resetTempObjColl"}),a.notify("draw",{prop:"resetTempPointColl"});break;case"crop":a.notify("transform",{prop:"disableZoomOutBtn",value:{isZoomOut:!0}}),S.isDevice&&this.updateContextualToolbar("color","straighten");break;case"reset":a.reset(),this.imageHeight=null,this.imageWidth=null,a.aspectHeight=null,a.aspectWidth=null,this.isAspectRatio=!0,this.currentToolbar="main";break;case"undo":a.noPushUndo=!1,(a.togglePen||a.drawingShape)&&(a.okBtn(),a.drawingShape=null),a.notify("undo-redo",{prop:"call-undo"});break;case"redo":a.noPushUndo=!1,(a.togglePen||a.drawingShape)&&(a.okBtn(),a.drawingShape=null),a.notify("undo-redo",{prop:"call-redo"});break;case"aspectratio":(!a.isCircleCrop&&d(a.currSelectionPoint)||a.currSelectionPoint&&a.currSelectionPoint.shape!=="crop-circle")&&(Q(p,"numerictextbox").value?(a.aspectWidth=Q(p,"numerictextbox").value,a.aspectHeight=Q(h,"numerictextbox").value,a.notify("transform",{prop:"resize",value:{width:a.aspectWidth,height:null,isAspectRatio:!0}})):Q(h,"numerictextbox").value&&(a.aspectWidth=parseFloat(Q(p,"numerictextbox").placeholder),a.aspectHeight=Q(h,"numerictextbox").value,a.notify("transform",{prop:"resize",value:{width:a.aspectWidth,height:a.aspectHeight,isAspectRatio:!0}})),a.resizeSrc={startX:a.img.srcLeft,startY:a.img.srcTop,width:a.img.srcWidth,height:a.img.srcHeight},this.refreshToolbar("resize"));break;case"nonaspectratio":(Q(p,"numerictextbox").value||Q(h,"numerictextbox").value)&&(a.aspectWidth=Q(p,"numerictextbox").value?Q(p,"numerictextbox").value:parseFloat(Q(p,"numerictextbox").placeholder),a.aspectHeight=Q(h,"numerictextbox").value?Q(h,"numerictextbox").value:parseFloat(Q(h,"numerictextbox").placeholder),a.notify("transform",{prop:"resize",value:{width:a.aspectWidth,height:a.aspectHeight,isAspectRatio:!1}})),a.resizeSrc={startX:a.img.srcLeft,startY:a.img.srcTop,width:a.img.srcWidth,height:a.img.srcHeight},this.refreshToolbar("resize");break;case"resize":(a.currObjType.isFiltered||a.currObjType.isRedact)&&a.okBtn(),this.resizeClick();break;case"adjustment":i||((a.currObjType.isFiltered||a.currObjType.isRedact)&&a.okBtn(),this.refreshToolbar("adjustment"),a.setTempFilterProperties(),a.notify("draw",{prop:"updateFinetune"}),a.notify("filter",{prop:"setTempAdjVal"}),this.openSlider("brightness"));break;case"brightness":case"contrast":case"hue":case"saturation":case"opacity":case"blur":case"exposure":this.openSlider(t);break;case"filter":r||(Bt(a.element),this.refreshToolbar("filter"),a.setTempFilterProperties(),gt(a.element));break;case"default":case"chrome":case"cold":case"warm":case"grayscale":case"blackandwhite":case"sepia":case"invert":case"sharpen":a.currObjType.isFiltered=!0,a.notify("filter",{prop:"applyImageFilter",value:{option:t}});break;case"upload":o&&a.element.querySelector(".e-contextual-toolbar-wrapper").classList.remove("e-hide");break;case"bold":a.notify("selection",{prop:"setInitialTextEdit",value:{bool:!1}}),a.activeObj.textSettings.bold&&a.activeObj.textSettings.italic?a.notify("shape",{prop:"applyFontStyle",onPropertyChange:!1,value:{item:"italic"}}):a.activeObj.textSettings.bold&&!a.activeObj.textSettings.italic?a.notify("shape",{prop:"applyFontStyle",onPropertyChange:!1,value:{item:"default"}}):!a.activeObj.textSettings.bold&&a.activeObj.textSettings.italic?a.notify("shape",{prop:"applyFontStyle",onPropertyChange:!1,value:{item:"bolditalic"}}):!a.activeObj.textSettings.bold&&!a.activeObj.textSettings.italic&&a.notify("shape",{prop:"applyFontStyle",onPropertyChange:!1,value:{item:"bold"}}),a.element.querySelector("#"+n+"_bold").classList.contains("e-selected-btn")?a.element.querySelector("#"+n+"_bold").classList.remove("e-selected-btn"):a.element.querySelector("#"+n+"_bold").classList.add("e-selected-btn"),(a.activeObj.activePoint.width!==0||a.activeObj.activePoint.height!==0)&&a.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1});break;case"italic":a.notify("selection",{prop:"setInitialTextEdit",value:{bool:!1}}),a.activeObj.textSettings.bold&&a.activeObj.textSettings.italic?a.notify("shape",{prop:"applyFontStyle",onPropertyChange:!1,value:{item:"bold"}}):a.activeObj.textSettings.bold&&!a.activeObj.textSettings.italic?a.notify("shape",{prop:"applyFontStyle",onPropertyChange:!1,value:{item:"bolditalic"}}):!a.activeObj.textSettings.bold&&a.activeObj.textSettings.italic?a.notify("shape",{prop:"applyFontStyle",onPropertyChange:!1,value:{item:"default"}}):!a.activeObj.textSettings.bold&&!a.activeObj.textSettings.italic&&a.notify("shape",{prop:"applyFontStyle",onPropertyChange:!1,value:{item:"italic"}}),a.element.querySelector("#"+n+"_italic").classList.contains("e-selected-btn")?a.element.querySelector("#"+n+"_italic").classList.remove("e-selected-btn"):a.element.querySelector("#"+n+"_italic").classList.add("e-selected-btn"),(a.activeObj.activePoint.width!==0||a.activeObj.activePoint.height!==0)&&a.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1});break;case"croptransform":this.performCropTransformClick();break;case"rotateleft":case"rotateright":case"horizontalflip":case"verticalflip":a.transformSelect(t);for(var N=0;N<a.objColl.length;N++)if(a.objColl[N].shape==="redact"){I=!0;break}if(I)for(a.notify("draw",{prop:"setRedactStraighten",value:{bool:!0}}),M=y({},a.activeObj,{},!0);a.img.destLeft<0||a.img.destTop<0;)a.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),a.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-.125,zoomPoint:null,isResize:!1}}),C+=1;if(this.updateRedactObj(),I){if(C>0){a.isCropTab=!0;for(var N=0;N<C;N++)a.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),a.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:.125,zoomPoint:null,isResize:!1}});a.activeObj=M,a.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}})}a.notify("draw",{prop:"setRedactStraighten",value:{bool:!1}})}(t==="rotateleft"||t==="rotateright")&&(a.notify("draw",{prop:"resetStraightenDestPoints"}),a.notify("draw",{prop:"setDestForStraighten"})),a.notify("transform",{prop:"disableZoomOutBtn",value:{isZoomOut:!0}}),S.isDevice&&this.updateContextualToolbar("color","straighten"),g=t==="rotateleft"||t==="rotateright"?"rotate":"flip",v={action:g,actionEventArgs:a.editCompleteArgs},a.triggerEditCompleteEvent(v);break;case"save":a.noPushUndo=!1,a.okBtn(),a.drawingShape=null,this.saveDialogPopup();break;case"transparency":this.updateContextualToolbar("transparency","transparency");break;case"frame":this.frameToolbarClick();break;case"none":case"mat":case"bevel":case"line":case"inset":case"hook":this.unselectFrameBtn(),a.element.querySelector("#"+n+"_"+t)&&a.element.querySelector("#"+n+"_"+t).classList.add("e-selected-btn"),a.frameObj.type=t,a.frameObj.size=20,a.frameObj.inset=20,a.frameObj.radius=0,a.frameObj.amount=1,t==="inset"?a.frameObj.offset=60:a.frameObj.offset=20,this.refreshToolbar("frame"),a.notify("draw",{prop:"render-image",value:{isMouseWheel:null,isPreventClearRect:null,isFrame:!0}}),a.isFrameBtnClick=!0,a.curFrameObjEvent={previousFrameSetting:a.tempFrameObj,currentFrameSetting:a.frameObj},a.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:a.tempFrameObj,obj:{frameChangeEventArgs:null}}});break;case"redact":a.currObjType.isRedact=m=!0,a.drawingShape="redact",d(a.activeObj.redactBlur)&&(a.activeObj.redactBlur=20),d(a.activeObj.redactPixelate)&&(a.activeObj.redactPixelate=20),a.notify("selection",{prop:"annotate",value:{shape:"redact"}}),this.refreshToolbar("redact"),this.redactSlider(a.activeObj.redactType);break;case"pixelate":if(a.currObjType.isRedact=m=!0,a.drawingShape="redact",a.notify("selection",{prop:"annotate",value:{shape:"redact"}}),a.activeObj.redactType==="blur"&&this.updateRedactType("pixelate"),a.notify("shape",{prop:"setRedactType",onPropertyChange:!1,value:{redactType:"pixelate"}}),a.activeObj.redactType==="pixelate"){var O=a.element.querySelector("#"+n+"_pixelate"),x=a.element.querySelector("#"+n+"_redactBlur");O&&O.classList.add("e-selected-btn"),x&&x.classList.contains("e-selected-btn")&&x.classList.remove("e-selected-btn")}else{var x=a.element.querySelector("#"+n+"_redactBlur");x&&x.classList.add("e-selected-btn")}this.redactSlider(a.activeObj.redactType),(a.activeObj.activePoint.width!==0||a.activeObj.activePoint.height!==0)&&a.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:null,previousObjColl:null,previousPointColl:null,previousSelPointColl:null,previousCropObj:null,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}});break;case"redactblur":if(a.currObjType.isRedact=m=!0,a.drawingShape="redact",a.notify("selection",{prop:"annotate",value:{shape:"redact"}}),a.notify("shape",{prop:"setRedactType",onPropertyChange:!1,value:{redactType:"blur"}}),a.activeObj.redactType==="pixelate"&&this.updateRedactType("blur"),a.notify("shape",{prop:"setRedactType",onPropertyChange:!1,value:{redactType:"blur"}}),a.activeObj.redactType==="blur"){var x=a.element.querySelector("#"+n+"_redactBlur"),O=a.element.querySelector("#"+n+"_pixelate");x&&x.classList.add("e-selected-btn"),O&&O.classList.contains("e-selected-btn")&&O.classList.remove("e-selected-btn")}else{var O=a.element.querySelector("#"+n+"_pixelate");O&&O.classList.add("e-selected-btn")}this.redactSlider(a.activeObj.redactType),(a.activeObj.activePoint.width!==0||a.activeObj.activePoint.height!==0)&&a.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:null,previousObjColl:null,previousPointColl:null,previousSelPointColl:null,previousCropObj:null,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}});break}m&&(a.notify("draw",{prop:"updateTempObjColl"}),a.notify("draw",{prop:"updateTempPointColl"}))}},l.prototype.updateRedactType=function(t){var e=this.parent;e.activeObj.redactType=t,e.notify("shape",{prop:"setRedactType",value:{type:t}}),this.parent.objColl.push(e.activeObj),e.notify("selection",{prop:"redrawShape",value:{obj:e.objColl[e.objColl.length-1]}})},l.prototype.frameToolbarClick=function(){var t=this.parent,e=t.element.id,i=document.querySelector("#"+e+"_frame"),r,o,a;t.notify("draw",{prop:"updateCropSelection",onPropertyChange:!1}),(t.currObjType.isFiltered||t.currObjType.isRedact)&&t.okBtn(),i&&!i.classList.contains("e-overlay")&&(r=t.transform.zoomFactor,t.frameDestPoints=y({},t.img,{},!0),d(t.cxtTbarHeight)&&(o=y({},t.frameObj,{},!0),a=y({},t.tempFrameObj,{},!0),this.callFrameToolbar(),t.frameObj.type="mat",this.callFrameToolbar(),t.cxtTbarHeight=t.element.querySelector("#"+e+"_customizeWrapper").scrollHeight,t.frameObj=o,t.tempFrameObj=a),this.zoomToFrameRange(),t.tempFrameZoomLevel=r,S.isDevice?t.img.destTop-=t.cxtTbarHeight/2:t.img.destTop+=t.cxtTbarHeight/2,this.callFrameToolbar(),t.notify("draw",{prop:"triggerFrameChange",value:{prevFrameSettings:t.frameObj,obj:{frameChangeEventArgs:null}}}))},l.prototype.zoomToFrameRange=function(){var t=this.parent;this.isFrameToolbar=!1,t.notify("transform",{prop:"resetZoom",onPropertyChange:!1});for(var e=!0;e;){if(this.toolbarHeight+t.img.destTop>=this.toolbarHeight+t.cxtTbarHeight){e=!1;break}t.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-.1,zoomPoint:null,isResize:!0}})}this.isFrameToolbar=!0},l.prototype.resizeClick=function(){var t=this.parent;t.notify("draw",{prop:"updateCropSelection",onPropertyChange:!1}),t.upperCanvas.style.cursor="default",t.notify("transform",{prop:"updateResize",value:{bool:!1}}),this.isAspectRatio?this.isAspectRatio=!1:this.isAspectRatio=!0,t.isResize=!0,this.refreshToolbar("resize")},l.prototype.callFrameToolbar=function(){var t=this.parent;y(t.tempFrameObj,t.frameObj);var e={appliedUndoRedoColl:[]};if(t.notify("undo-redo",{prop:"getAppliedUndoRedoColl",value:{obj:e}}),e.appliedUndoRedoColl.length===0){var i={currObj:{}};t.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:i}}),t.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"frame",previousObj:i.currObj,previousObjColl:i.currObj.objColl,previousPointColl:i.currObj.pointColl,previousSelPointColl:i.currObj.selPointColl,previousCropObj:y({},t.cropObj,{},!0),previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}})}this.refreshToolbar("frame")},l.prototype.contextualToolbarClicked=function(t){var e=this.parent,i=e.element.querySelector(".e-contextual-toolbar-wrapper .e-toolbar-item.e-selected");i&&i.classList.remove("e-selected");var r=t.item.id.replace(e.element.id,"").split("_")[1],o={filter:e.toPascalCase(r),cancel:!1};e.trigger("imageFiltering",o),e.editCompleteArgs=o,!o.cancel&&(document.getElementById(t.item.id+"Canvas").parentElement.parentElement.classList.add("e-selected"),e.currObjType.isFiltered=!0,e.notify("filter",{prop:"applyImageFilter",value:{option:r.toLowerCase()}}),e.notify("draw",{prop:"redrawDownScale"}),e.currentFilter=t.item.id,this.enableDisableTbrBtn(),e.isFilterCanvasClick=!0,e.curFilterObjEvent=o)},l.prototype.refreshShapeDrawing=function(){var t=this.parent,e={shape:""};t.notify("selection",{prop:"getCurrentDrawingShape",onPropertyChange:!1,value:{obj:e}}),e.shape!==""&&(t.notify("selection",{prop:"setCurrentDrawingShape",onPropertyChange:!1,value:{value:""}}),t.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),this.refreshToolbar("main",!1))},l.prototype.zoomInBtnClickHandler=function(t){if(t){var e=this.parent;if((e.zoomSettings.zoomTrigger&ze.Toolbar)===ze.Toolbar){e.noPushUndo=!1,e.currObjType.isFiltered&&e.okBtn();var i=e.drawingShape;if(e.drawingShape){var r=e.activeObj.currIndex;e.noPushUndo=!0,e.okBtn(),e.noPushUndo=!1,e.drawingShape=null,r&&e.selectShape(r)}if(this.refreshShapeDrawing(),S.isDevice&&t.type==="touchstart"){if(!t.returnValue)return;t.preventDefault()}var o=document.querySelector("#"+e.element.id+"_zoomIn");b.trigger(o,"click");var a={bool:!1};e.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:a}}),a.bool&&(e.notify("freehand-draw",{prop:"applyFhd",onPropertyChange:!1}),this.destroyQuickAccessToolbar()),e.isZoomBtnClick=!0,this.applyPreviewFilter(),e.currObjType.isFiltered=!1,e.currObjType.isRedact=!1,e.togglePen&&(e.currObjType.isZoomed=!0,e.freeHandDraw(!1),e.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}})),e.notify("draw",{prop:"resetCurrentSelectionPoint"}),e.drawingShape=i,e.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:.1,zoomPoint:null,isResize:null}}),e.notify("draw",{prop:"redrawDownScale"}),(e.isCropTab||e.activeObj.shape)&&(e.notify("draw",{prop:"setStraightenActObj",value:{activeObj:null}}),e.notify("freehand-draw",{prop:"resetStraightenPoint"})),e.isStraightening&&(e.notify("draw",{prop:"resetStraightenDestPoints"}),e.notify("draw",{prop:"setDestForStraighten"}));var n={action:"zoom-in",actionEventArgs:e.editCompleteArgs};e.triggerEditCompleteEvent(n),S.isDevice&&o.focus()}}},l.prototype.zoomOutBtnClickHandler=function(t){if(t){var e=this.parent;if((e.zoomSettings.zoomTrigger&ze.Toolbar)===ze.Toolbar){e.noPushUndo=!1,e.currObjType.isFiltered&&e.okBtn();var i=e.drawingShape;if(e.drawingShape){var r=e.activeObj.currIndex;e.noPushUndo=!0,e.okBtn(),e.noPushUndo=!1,e.drawingShape=null,r&&e.selectShape(r)}if(this.refreshShapeDrawing(),S.isDevice&&t.type==="touchstart"){if(!t.returnValue)return;t.preventDefault()}var o=document.querySelector("#"+e.element.id+"_zoomOut");b.trigger(o,"click");var a={bool:!1};e.notify("selection",{prop:"getFreehandDrawEditing",onPropertyChange:!1,value:{obj:a}}),a.bool&&(e.notify("freehand-draw",{prop:"applyFhd",onPropertyChange:!1}),this.destroyQuickAccessToolbar()),e.isZoomBtnClick=!0,this.applyPreviewFilter(),e.currObjType.isFiltered=!1,e.currObjType.isRedact=!1,e.togglePen&&(e.currObjType.isZoomed=!0,e.freeHandDraw(!1),e.notify("undo-redo",{prop:"updateCurrUrc",value:{type:"ok"}})),e.notify("draw",{prop:"resetCurrentSelectionPoint"}),e.drawingShape=i,e.notify("transform",{prop:"zoomAction",onPropertyChange:!1,value:{zoomFactor:-.1,zoomPoint:null,isResize:null}}),e.notify("draw",{prop:"redrawDownScale"}),(e.isCropTab||e.activeObj.shape)&&(e.notify("draw",{prop:"setStraightenActObj",value:{activeObj:null}}),e.notify("freehand-draw",{prop:"resetStraightenPoint"})),e.isStraightening&&(e.notify("draw",{prop:"resetStraightenDestPoints"}),e.notify("draw",{prop:"setDestForStraighten"}));var n={action:"zoom-out",actionEventArgs:e.editCompleteArgs};e.triggerEditCompleteEvent(n),S.isDevice&&o.focus()}}},l.prototype.zoomInBtnMouseDownHandler=function(t){t.preventDefault(),this.zoomBtnHold=setInterval(this.zoomInBtnClickHandler.bind(this),250)},l.prototype.zoomOutBtnMouseDownHandler=function(t){t.preventDefault(),this.zoomBtnHold=setInterval(this.zoomOutBtnClickHandler.bind(this),250)},l.prototype.zoomBtnMouseUpHandler=function(){clearInterval(this.zoomBtnHold),this.zoomBtnHold=0},l.prototype.closeContextualToolbar=function(){var t=this.parent,e=t.element.id,i=!1,r={bool:t.isStraightening};return(!S.isDevice||S.isDevice&&!r.bool)&&(t.element.querySelector("#"+e+"_contextualToolbar")&&!t.element.querySelector("#"+e+"_contextualToolbar").parentElement.classList.contains("e-hide")||t.element.querySelector("#"+e+"_headWrapper")&&!t.element.querySelector("#"+e+"_headWrapper").parentElement.classList.contains("e-hide"))&&(t.element.querySelector(".e-contextual-toolbar-wrapper").classList.add("e-hide"),t.okBtn(),this.refreshMainToolbar(),i=!0),i},l.prototype.destroyQuickAccessToolbar=function(){var t=this.parent,e=t.element.id,i=document.getElementById(e+"_quickAccessToolbar");i&&i.classList.contains("e-control")&&Q(i,"toolbar").destroy();var r=document.getElementById(e+"_quickAccessToolbarArea");r&&(r.style.display="none")},l.prototype.renderSlider=function(t,e){var i=this.parent,r=i.element.id,o=document.querySelector("#"+r+"_contextualToolbarArea"),a=document.querySelector("#"+r+"_headWrapper"),n=document.querySelector("#"+r+"_labelWrapper");a&&(a.remove(),n.remove()),a=o.appendChild(i.createElement("div",{id:r+"_headWrapper",styles:"position: relative"})),t==="transparency"?n=a.appendChild(i.createElement("label",{id:r+"_labelWrapper",className:"e-ie-finetune-slider-label",styles:S.isDevice?"position: absolute; top: 31%; left: calc(50% - 150px); font-size: 15px; text-transform: capitalize; font-weight: 400;":"position: absolute; top: 31%; left: calc(50% - 220px); font-size: 15px; text-transform: capitalize; font-weight: 400;"})):n=a.appendChild(i.createElement("label",{id:r+"_labelWrapper",className:"e-ie-finetune-slider-label",styles:S.isDevice?"position: absolute; top: 31%; left: calc(50% - 160px); font-size: 15px; text-transform: capitalize; font-weight: 400;":"position: absolute; top: 25%; left: calc(50% - 226px); font-size: 15px; text-transform: capitalize; font-weight: 400;"})),n.textContent=this.l10n.getConstant(i.toPascalCase(t==="transparency"?"opacity":t));var s=a.appendChild(i.createElement("div",{id:r+"_sliderWrapper",className:"e-ie-finetune-slider-wrap",styles:"position: absolute"})),h=i.getCurrAdjustmentValue(t);e&&t==="straighten"&&S.isDevice&&(h=i.cropObj.straighten);var p,u,c;if(t==="brightness"||t==="contrast"||t==="saturation"||t==="exposure"?(i.finetuneSettings?t==="brightness"&&i.finetuneSettings.brightness?(p=i.finetuneSettings.brightness.min,u=i.finetuneSettings.brightness.max):t==="contrast"&&i.finetuneSettings.contrast?(p=i.finetuneSettings.contrast.min,u=i.finetuneSettings.contrast.max):t==="saturation"&&i.finetuneSettings.saturation?(p=i.finetuneSettings.saturation.min,u=i.finetuneSettings.saturation.max):t==="exposure"&&i.finetuneSettings.exposure?(p=i.finetuneSettings.exposure.min,u=i.finetuneSettings.exposure.max):(p=-100,u=100):(p=-100,u=100),c=this.createSlider(p,u,h,t)):t==="hue"||t==="blur"||t==="opacity"?(i.finetuneSettings?t==="hue"&&i.finetuneSettings.hue?(p=i.finetuneSettings.hue.min,u=i.finetuneSettings.hue.max):t==="blur"&&i.finetuneSettings.blur?(p=i.finetuneSettings.blur.min,u=i.finetuneSettings.blur.max):t==="opacity"&&i.finetuneSettings.opacity?(p=i.finetuneSettings.opacity.min,u=i.finetuneSettings.opacity.max):(p=0,u=100):(p=0,u=100),c=this.createSlider(p,u,h,t)):t==="transparency"?(p=0,u=100,c=this.createSlider(p,u,h,t)):t==="straighten"&&(p=-45,u=45,c=this.createSlider(p,u,h,t)),c.appendTo("#"+r+"_sliderWrapper"),s.style.left=(parseFloat(o.style.width)-parseFloat(c.width))/2+"px",t==="straighten"&&S.isDevice){var f=a.appendChild(i.createElement("label",{id:r+"_sLabelWrapper",className:"e-ie-straighten-value-span e-ie-finetune-value-span",styles:"position: absolute; top: 31%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;"}));f.innerHTML=i.transform.straighten.toString()+"&#176",s.parentElement.classList.add("e-straighten-slider")}t!=="straighten"&&(a.appendChild(i.createElement("label",{id:r+"_finetuneSpan",className:"e-ie-finetune-value-span",styles:S.isDevice?"position: absolute; top: 25%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;":"position: absolute; top: 25%; left: calc(50% + 190px); font-size: 15px; text-transform: capitalize; font-weight: 400;"})),s.parentElement.classList.add("e-finetune-slider"),t==="transparency"&&S.isDevice&&s.parentElement.classList.add("e-ie-device-transparency-slider"),this.updateFinetuneSpan(t))},l.prototype.createSlider=function(t,e,i,r){var o=this,a=this.parent,n=r==="straighten"?3:1;return new Mr({value:i,type:"MinRange",min:t,max:e,step:n,width:S.isDevice?"180px":r==="straighten"?"200px":"300px",cssClass:"e-slider",change:function(s){if(a.notify("selection",{prop:"setSliderActive",onPropertyChange:!1,value:{bool:!0}}),r==="transparency"){if(a.activeObj.shape){d(a.activeObj.imageRatio)&&a.notify("shape",{prop:"updImgRatioForActObj",onPropertyChange:!1}),a.notify("shape",{prop:"pushActItemIntoObj"});var h=y({},a.cropObj,{},!0),p={currObj:{}};a.notify("filter",{prop:"getCurrentObj",onPropertyChange:!1,value:{object:p}});var u=p.currObj;u.objColl=y([],a.objColl,[],!0),u.pointColl=y([],a.pointColl,[],!0),u.afterCropActions=y([],a.afterCropActions,[],!0);var c={selPointColl:null};a.notify("freehand-draw",{prop:"getSelPointColl",onPropertyChange:!1,value:{obj:c}}),u.selPointColl=y([],c.selPointColl,[],!0),a.objColl.pop(),a.activeObj.opacity=s.value/100,o.upperContext.clearRect(0,0,a.upperCanvas.width,a.upperCanvas.height),a.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate"}}),a.objColl.push(a.activeObj),a.notify("undo-redo",{prop:"updateUndoRedoColl",onPropertyChange:!1,value:{operation:"shapeTransform",previousObj:u,previousObjColl:u.objColl,previousPointColl:u.pointColl,previousSelPointColl:u.selPointColl,previousCropObj:h,previousText:null,currentText:null,previousFilter:null,isCircleCrop:null}}),a.notify("selection",{prop:"redrawShape",value:{obj:a.objColl[a.objColl.length-1]}}),o.updateFinetuneSpan(r)}}else r==="straighten"?a.setStraighten(s.value):(a.transform.zoomFactor&&a.transform.zoomFactor<0&&(a.isFinetuning=!0),a.notify("selection",{prop:"setSliding",value:{bool:!0}}),a.setCurrAdjustmentValue(r,s.value),o.updateFinetuneSpan(r),o.enableDisableTbrBtn(),a.isFinetuning=!1)},changed:function(){r!=="transparency"&&r!=="straighten"&&(a.notify("selection",{prop:"setSliding",value:{bool:!1}}),a.notify("draw",{prop:"redrawDownScale"})),a.notify("selection",{prop:"setSliderActive",onPropertyChange:!1,value:{bool:!1}}),r==="transparency"&&setTimeout(function(){a.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1}),a.element.querySelector("#"+a.element.id+"_transparency").click()},50)}})},l.prototype.updateFinetuneSpan=function(t){var e=this.parent,i=e.element.querySelector(".e-ie-finetune-value-span");if(i){var r={adjustmentLevel:null};e.notify("filter",{prop:"getAdjustmentLevel",onPropertyChange:!1,value:{obj:r}}),i.innerHTML=Math.round(r.adjustmentLevel[t]).toString()}},l.prototype.applyPreviewFilter=function(){var t=this.parent;(document.querySelector("#"+t.element.id+"_sliderWrapper")||t.currObjType.isFiltered)&&(t.initialAdjustmentValue=this.lowerContext.filter,t.canvasFilter=this.lowerContext.filter,t.currObjType.isFiltered=!1)},l.prototype.unselectBtn=function(){for(var t=this.parent,e=t.element.id,i=["#"+e+"_brightness","#"+e+"_contrast","#"+e+"_hue","#"+e+"_saturation","#"+e+"_opacity","#"+e+"_blur","#"+e+"_exposure"],r=0,o=i;r<o.length;r++){var a=o[r],n=document.querySelector(a);if(n&&n.classList.contains("e-selected-btn")){n.classList.remove("e-selected-btn");break}}},l.prototype.openSlider=function(t){this.unselectBtn(),this.parent.currObjType.isFiltered=!0,this.refreshToolbar("color",null,null,null,t),document.getElementById(this.parent.element.id+"_"+t).classList.add("e-selected-btn")},l.prototype.refreshSlider=function(){var t=this.parent.element.id,e=document.querySelector("#"+t+"_sliderWrapper"),i=document.querySelector(".e-slider"),r=document.querySelector("#"+t+"_headWrapper");r&&(r.style.display="none"),e&&i&&(i.ej2_instances[0].destroy(),e.remove())},l.prototype.unselectFrameBtn=function(){for(var t=this.parent,e=t.element.id,i=["#"+e+"_none","#"+e+"_mat","#"+e+"_line","#"+e+"_inset","#"+e+"_bevel","#"+e+"_hook"],r=0,o=i;r<o.length;r++){var a=o[r],n=document.querySelector(a);if(n.classList.contains("e-selected-btn")){n.classList.remove("e-selected-btn");break}}},l.prototype.updateToolbarItems=function(){var t=this.parent,e=t.element.id;if(t.isImageLoaded&&this.isToolbar()){var i=t.element.querySelector(".e-fill.e-template .e-dropdownbtn-preview"),r=t.element.querySelector(".e-stroke.e-template .e-dropdownbtn-preview"),o=t.element.querySelector(".e-text-font-color.e-template .e-dropdownbtn-preview"),a=t.element.querySelector(".e-stroke-text-font-color.e-template .e-dropdownbtn-preview"),n=t.element.querySelector(".e-text-background-color.e-template .e-dropdownbtn-preview"),s=t.element.querySelector(".e-pen-stroke-color.e-template .e-dropdownbtn-preview"),h=t.element.querySelector(".e-shape-stroke-width"),p=t.element.querySelector(".e-shape-rectangle-radius"),u=t.element.querySelector(".e-text-font-family"),c=t.element.querySelector(".e-text-font-size"),f=t.element.querySelector("#"+e+"_bold"),g=t.element.querySelector("#"+e+"_italic");if(t.activeObj.strokeSettings&&t.activeObj.textSettings){if(d(t.activeObj.strokeSettings.strokeWidth)&&(t.activeObj.strokeSettings.strokeWidth=2),d(t.activeObj.strokeSettings.outlineWidth)&&(t.activeObj.strokeSettings.outlineWidth=2),i){var v=t.activeObj.strokeSettings.fillColor;t.activeObj.strokeSettings.fillColor===""?i.classList.add("e-nocolor-item"):(i.classList.remove("e-nocolor-item"),i.style.background=v),document.querySelector("#"+e+"_shape_fill")&&(Q(e+"_shape_fill","colorpicker").value=v)}if(r){var v=t.activeObj.strokeSettings.strokeColor;r.style.background=v,document.querySelector("#"+e+"_shape_stroke")&&(Q(e+"_shape_stroke","colorpicker").value=v)}if(o){var v=t.activeObj.strokeSettings.strokeColor;o.style.background=v,document.querySelector("#"+e+"_text_font")&&(Q(e+"_text_font","colorpicker").value=v)}if(a){var v=t.activeObj.strokeSettings.outlineColor;/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$|^[a-zA-Z]+$/.test(t.activeObj.strokeSettings.outlineColor)?(a.classList.remove("e-nocolor-item"),a.style.background=v):a.classList.add("e-nocolor-item"),document.querySelector("#"+e+"_stroke_text")&&(Q(e+"_stroke_text","colorpicker").value=v)}if(n){var v=t.activeObj.strokeSettings.fillColor;t.activeObj.strokeSettings.fillColor===""||t.activeObj.strokeSettings.fillColor==="transparent"?n.classList.add("e-nocolor-item"):(n.classList.remove("e-nocolor-item"),n.style.background=v),document.querySelector("#"+e+"_text_bgColor")&&(Q(e+"_text_bgColor","colorpicker").value=v)}if(s){var v=t.activeObj.strokeSettings.strokeColor;s.style.background=v,document.querySelector("#"+e+"_pen_stroke")&&(Q(e+"_pen_stroke","colorpicker").value=v);var m={penOpacity:1};t.notify("freehand-draw",{prop:"getPenOpacity",onPropertyChange:!1,value:{obj:m}})}if(u&&(S.isDevice?u.setAttribute("style","font-family:"+t.activeObj.textSettings.fontFamily.toLowerCase()):u.textContent=t.activeObj.textSettings.fontFamily),c){for(var C=0;C<t.fontSizeColl.length;C++)if(parseInt(t.fontSizeColl[C].text,10)>=Math.round(t.activeObj.textSettings.fontSize)){c.textContent=(C+1).toString();break}else if(Math.round(t.activeObj.textSettings.fontSize)<parseInt(t.fontSizeColl[0].text,10)){c.textContent="1";break}else if(Math.round(t.activeObj.textSettings.fontSize)>parseInt(t.fontSizeColl[t.fontSizeColl.length-1].text,10)){c.textContent=(t.fontSizeColl.length-1+1).toString();break}}if(f&&(t.activeObj.textSettings.bold?f.classList.add("e-selected-btn"):f.classList.remove("e-selected-btn")),g&&(t.activeObj.textSettings.italic?g.classList.add("e-selected-btn"):g.classList.remove("e-selected-btn")),h){var M=t.activeObj.shape==="text"?t.activeObj.strokeSettings.outlineWidth:t.activeObj.strokeSettings.strokeWidth,I=Math.round(M).toString();h.textContent=this.getStrokeWidth(I)}if(p){var N=Math.round(t.activeObj.strokeSettings.radius).toString();p.textContent=this.getRectRadius(N)}}}},l.prototype.getStrokeWidth=function(t){var e,i=parseInt(t,10)/2;switch(i){case 0:e=this.l10n.getConstant("NoOutline");break;case 1:e=this.l10n.getConstant("XSmall");break;case 2:e=this.l10n.getConstant("Small");break;case 3:e=this.l10n.getConstant("Medium");break;case 4:e=this.l10n.getConstant("Large");break;case 5:e=this.l10n.getConstant("XLarge");break}return e},l.prototype.getRectRadius=function(t){var e,i=parseInt(t,10)/2;switch(i){case 0:e=this.l10n.getConstant("0");break;case 1:e=this.l10n.getConstant("20");break;case 2:e=this.l10n.getConstant("40");break;case 3:e=this.l10n.getConstant("60");break;case 4:e=this.l10n.getConstant("80");break;case 5:e=this.l10n.getConstant("100");break}return e},l.prototype.cancelPan=function(){var t=this.parent;t.notify("shape",{prop:"applyActObj",onPropertyChange:!1,value:{isMouseDown:!0}});var e=t.element.querySelector(".e-img-pan .e-btn");e&&e.classList.remove("e-selected-btn"),t.pan(!1)},l.prototype.refreshMainToolbar=function(){this.currToolbar!=="main"&&this.refreshToolbar("main")},l.prototype.destroySubComponents=function(){for(var t=this.parent,e=t.element.querySelectorAll("input.e-control"),i=t.element.querySelectorAll("button.e-control"),r=0,o=e.length;r<o;r++)e[r].classList.contains("e-color-picker")&&(Q(e[r],"color-picker").destroy(),X(te("input#"+e[r].id,t.element)));for(var r=0,o=i.length;r<o;r++)i[r].classList.contains("e-dropdown-btn")?(Q(i[r],"dropdown-btn").destroy(),X(te("button#"+i[r].id,t.element))):i[r].classList.contains("e-btn")&&(Q(i[r],"btn").destroy(),X(te("button#"+i[r].id,t.element)))},l.prototype.setInitialShapeSettings=function(t){var e=this.parent;e.notify("shape",{prop:"refreshActiveObj",onPropertyChange:!1}),e.currObjType.shape=t.item.id,e.activeObj.shape=e.currObjType.shape.toLowerCase(),e.currObjType.isDragging=e.currObjType.isCustomCrop=!1,e.activeObj.shapeDegree=e.transform.degree,e.activeObj.shapeFlip=e.transform.currFlipState,e.activeObj.textFlip=e.transform.currFlipState,e.activeObj.flipObjColl=[];var i={order:null};e.notify("shape",{prop:"getNewOrder",onPropertyChange:!1,value:{obj:i}}),e.activeObj.order=i.order},l.prototype.isToolbarString=function(t){for(var e=!1,i=0;i<t.length;i++)if(typeof t[i]=="string"){e=!0;break}return e},l.prototype.excludeItems=function(t){for(var e=[],i=0;i<t.length;i++){var r=this.getIndex(t[i]);r!==-1&&e.push(r)}for(var o=[],i=0;i<this.defToolbarItems.length;i++)this.defToolbarItems[i].align==="Center"&&!this.isSameIndex(e,i)&&this.defToolbarItems[i].id!==this.parent.element.id+"_annotation"&&o.push(i);for(var i=o.length-1;i>=0;i--)this.defToolbarItems.splice(o[i],1)},l.prototype.isSameIndex=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1},l.prototype.getIndex=function(t){var e=-1,i=!1;t==="rotateLeft"&&(t="rotLeft"),t==="rotateRight"&&(t="rotRight"),t==="horizontalFlip"&&(t="hflip"),t==="verticalFlip"&&(t="vflip"),t==="arrowStart"&&(t="start"),t==="arrowEnd"&&(t="end"),t==="fontColor"&&(t="strokeColor",i=!0);for(var r=0;r<this.defToolbarItems.length;r++){var o=this.defToolbarItems[r].id;if(o&&o.toLowerCase().indexOf(t.toLowerCase())!==-1){e=r;break}}return i&&(t="fontColor"),e},l.prototype.getModuleName=function(){return"toolbar-module"},l.prototype.redactSlider=function(t){var e=this.parent,i=e.element.id,r=e.element.querySelector("#"+i+"_toolbarArea"),o=e.element.querySelector("#"+i+"_contextualToolbarArea");if(o){o.classList.remove("e-hide"),o.style.left=r.offsetLeft+"px";var a=document.querySelector("#"+i+"_contextualToolbarArea"),n=document.querySelector("#"+i+"_headWrapper"),s=document.querySelector("#"+i+"_labelWrapper"),h=document.querySelector("#"+i+"_contextualToolbar");n&&(n.remove(),s.remove()),h&&(h.remove(),this.createContextualToolbar()),n=a.appendChild(e.createElement("div",{id:i+"_headWrapper",styles:"position: relative"})),s=n.appendChild(e.createElement("label",{id:i+"_labelWrapper",className:"e-ie-finetune-slider-label",styles:S.isDevice?"position: absolute; top: 31%; left: calc(50% - 160px); font-size: 15px; text-transform: capitalize; font-weight: 400;":"position: absolute; top: 25%; left: calc(50% - 226px); font-size: 15px; text-transform: capitalize; font-weight: 400;"}));var p=t==="blur"?this.l10n.getConstant("Blur"):this.l10n.getConstant("PixelSize");s.textContent=p;var u=n.appendChild(e.createElement("div",{id:i+"_sliderWrapper",className:"e-ie-finetune-slider-wrap",styles:"position: absolute"}));n.appendChild(e.createElement("label",{id:i+"_redactSpan",className:"e-ie-redact-value-span",styles:S.isDevice?"position: absolute; top: 30%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;":"position: absolute; top: 30%; left: calc(50% + 190px); font-size: 15px; text-transform: capitalize; font-weight: 400;"})),u.parentElement.classList.add("e-finetune-slider");var c=e.activeObj.redactType==="blur"?e.activeObj.redactBlur:e.activeObj.redactPixelate,f=new Mr({tooltip:{placement:"Before",isVisible:!0,showOn:"Focus"},min:10,max:100,step:1,value:c,type:"MinRange",width:S.isDevice?"130px":"300px",created:function(){e.element.querySelector(".e-ie-redact-value-span").innerText=c.toString()},change:function(C){e.element.querySelector(".e-ie-redact-value-span").innerText=C.value.toString(),e.activeObj.redactType==="blur"?e.activeObj.redactBlur=e.tempRedactBlur=C.value:e.activeObj.redactType==="pixelate"&&(e.activeObj.redactPixelate=e.tempRedactPixel=C.value),e.notify("draw",{prop:"drawObject",onPropertyChange:!1,value:{canvas:"duplicate",obj:e.activeObj,isCropRatio:null,points:null,isPreventDrag:!0,saveContext:null,isPreventSelection:!0}})},changed:function(){setTimeout(function(){e.notify("undo-redo",{prop:"updateUndoRedoStack",onPropertyChange:!1})},50)}});if(f.appendTo("#"+i+"_sliderWrapper"),S.isDevice){var g=o.offsetHeight+1,v=e.element.querySelector("#"+i+"_customizeWrapper");this.isFrameToolbar&&v&&(g=v.offsetHeight+2);var m=e.element.querySelector("#"+i+"_canvasWrapper").offsetHeight;o.style.top=this.toolbarHeight+1+m-g+"px"}}},l}();function Dy(l){if(l&&l.__esModule)return l;var t={};if(l!=null)for(var e in l)Object.prototype.hasOwnProperty.call(l,e)&&(t[""+e]=l[""+e]);return t.default=l,t}var Ui=Dy(sd),At=!(parseInt(Ui.version,10)>2),xt=At?Ui.default.default?Ui.default.default:Ui.default:Ui,wy=Ui.h,Bh=function(l){return At?xt.extend(l):xt.defineComponent(l)},Oy=Bh({name:"ComponentBase",data:function(){return{tagMapper:{},tagNameMapper:{},hasInjectedModules:!1,hasChildDirective:!1,childDirObjects:"",propKeys:{},isDecorator:!1}},created:function(){var l=this;if(this.ej2Instance&&(this.ej2Instances=this.isVue3?xt.toRaw(this.ej2Instance):this.ej2Instance),!!this.propKeys){for(var t=function(f){e.ej2Instances.addEventListener(f,function(g){l.$emit(f,g)})},e=this,i=0,r=this.propKeys;i<r.length;i++){var o=r[i];t(o)}var a=Z("$root.$options.provide",this),n=Z("$parent.$options.provide",this);if(n=d(n)?Z("$.parent.provides",this):n,this.hasInjectedModules&&!At){var s=[];a&&a.managed?(this.isDecorator=!0,s=this.getInjectedServices()||[]):a?s=a[this.ej2Instances.getModuleName()]||[]:n&&(s=this.getInjectedServices()||[]);for(var h=this.ej2Instances.getInjectedModules()||[],p=0,u=h;p<u.length;p++){var c=u[p];s.indexOf(c)===-1&&s.push(c)}this.ej2Instances.injectedModules=s}}},mounted:function(){var l=this.$el?this.$el.querySelectorAll("div.e-directive"):null;if(!At&&l)for(var t=0;t<l.length;t++){var e=l[parseInt(t.toString(),10)];e.parentElement&&e.parentElement.removeChild(e)}this.ej2Instances.isVue=!0,this.ej2Instances.isVue3=this.isVue3,this.ej2Instances.vueInstance=this,this.isVue3&&(this.ej2Instances.ej2Instances=this.ej2Instances,this.ej2Instances.referModels=this.models,this.setModelValue()),this.ej2Instances.appendTo(this.$el)},updated:function(){this.updated()},beforeDestroy:function(){this.destroyComponent()},beforeUnmount:function(){this.destroyComponent()},methods:{setModelValue:function(){if(!d(this.modelValue)||!d(this.$attrs.modelValue)){var l=this.models.toString().match(/checked|value/)||[],t=l[0];d(t)||(this.ej2Instances[""+t]=d(this.modelValue)?this.$attrs.modelValue:this.modelValue)}},updated:function(){if(this.isVue3&&this.setModelValue(),this.hasChildDirective){var l={};this.fetchChildPropValues(l);var t=JSON.stringify(l);this.childDirObjects!==t&&(this.childDirObjects=t,this.assignValueToWrapper(l,!1))}},getInjectedServices:function(){var l=[],t;if(this.$root&&this.isDecorator?t=Z("$root.$options.provide",this):this.$vnode?t=Z("$vnode.context.$options.provide",this):this.$parent&&(t=Z("$parent.$options.provide",this)),d(t)&&!d(this.$)&&(t=Z("$.parent.provides",this)),t){var e=t;if(typeof t=="function")if(t.managed){var i=t.managed,r=Object.keys(i),o=void 0;this.$root&&this.isDecorator?o=Object.keys(this.$root):this.$vnode?o=Object.keys(this.$vnode.context):this.$parent&&(o=Object.keys(this.$parent));for(var a=0;a<r.length;a++)for(var n=0;n<o.length;n++)o[parseInt(n.toString(),10)].indexOf(r[parseInt(a.toString(),10)])!==-1&&(this.$root&&this.isDecorator?i[r[parseInt(n.toString(),10)]]=this.$root[o[parseInt(a.toString(),10)]]:this.$vnode?i[r[parseInt(a.toString(),10)]]=this.$vnode.context[o[parseInt(n.toString(),10)]]:this.$parent&&(i[r[parseInt(a.toString(),10)]]=this.$parent[o[parseInt(n.toString(),10)]]),e=i)}else this.$vnode?e=this.$vnode.context.$options.provide():this.$parent&&(e=this.$parent.$options.provide());l=e[this.ej2Instances.getModuleName()]||[]}return this.isDecorator=!1,l},destroyComponent:function(){this.ej2Instances.destroy(),this.$el.style.visibility="hidden",this.clearTemplate()},destroyPortals:function(l){if(l){var t=Z("__vue__.$destroy",l);if(t)l.__vue__.$destroy();else if(!At&&l._vnode)try{xt.render(null,l)}catch{}l.innerHTML&&(l.innerHTML="")}},bindProperties:function(){for(var l={},t=0,e=this.propKeys;t<e.length;t++){var i=e[t];d(this[""+i])?this[0]&&!d(this[0][0])&&!d(this[0][0][""+i])&&(l[""+i]=this[0][0][""+i]):l[""+i]=this[""+i]}if(this.hasChildDirective&&this.fetchChildPropValues(l),this.hasInjectedModules){for(var r=this.getInjectedServices()||[],o=this.ej2Instances.getInjectedModules()||[],a=0,n=o;a<n.length;a++){var s=n[a];r.indexOf(s)===-1&&r.push(s)}this.ej2Instances.injectedModules=r}this.assignValueToWrapper(l)},assignValueToWrapper:function(l,t){this.ej2Instances.setProperties(y({},{},l,!0),d(t)?!0:t)},fetchChildPropValues:function(l){var t={};if(!this.isVue3)t=this.getDirectiveValues(this.$slots.default,this.tagMapper||{},this.tagNameMapper||{});else{var e=void 0;if(this[0]&&this[0][1].slots.default?e=this[0][1].slots.default():this&&this.$&&this.$.slots&&this.$.slots.default&&(e=this.$.slots.default()),e){for(var i=0;i<e.length;i++)if(e[parseInt(i.toString(),10)].type.methods||e[parseInt(i.toString(),10)].type==="e-seriescollection"){var r=e[parseInt(i.toString(),10)].type==="e-seriescollection"?"series-collection":e[parseInt(i.toString(),10)].type.methods.getTag().replace("e-",""),o=this.resolveArrayDirectives(e[parseInt(i.toString(),10)].children,r),a=r.split("-"),n=this.ej2Instances.getModuleName().toLowerCase(),s=a.length>1&&n.indexOf(a[0])>-1?a[1]:a[0];s=s.replace(n,""),s=this.tagNameMapper["e-"+r]?this.tagNameMapper["e-"+r].replace("e-",""):s,n==="splitter"&&s==="panes"?s="paneSettings":n==="bulletchart"&&s==="range"?s="ranges":n==="schedule"&&s==="header"&&(s="headerRows"),t[""+s]=o[""+r]}}else return}this.childDirObjects||(this.childDirObjects=JSON.stringify(t));for(var h=0,p=Object.keys(t);h<p.length;h++){var u=p[h];l[""+u]=t[""+u]}},resolveArrayDirectives:function(l,t){var e=[],i;e=l.default?l.default():l,e=e.flatMap(function(p){return Array.isArray(p.children)?p.children:p});var r={};r[""+t]=[];for(var o=function(p){var u={},c=p.type.methods?p.type.methods.getTag():t;if(p.children){var f=void 0;if(i=a.resolveComplexDirs(p.children,a.tagMapper["e-"+t],c),i.length)u=i;else for(var g=0;g<Object.keys(i).length;g++)f=Object.keys(i)[parseInt(g.toString(),10)],u[""+f]=i[""+f]}p.props&&Object.keys(p.props).forEach(function(v){var m=v.replace(/-[a-z]/g,function(C){return C[1].toUpperCase()});m&&(u[""+m]=p.props[""+v])}),/[s]\b/.test(c)&&i&&(!/[s]\b/.test(t)||i.length)?Array.isArray(u)?u.forEach(function(v){r[""+t].push(v)}):r[""+t].push(u):u&&Object.keys(u).length!==0&&r[""+t].push(u)},a=this,n=0,s=e;n<s.length;n++){var h=s[n];o(h)}return r},resolveComplexDirs:function(l,t,e){var i=[],r;i=l.default?l.default():l;for(var o={},a=function(u){var c=void 0,f=void 0;t[""+e]&&(c=Object.keys(t[""+e]),f=c.find(function(g){return t[""+e][""+g]===u.type.methods.getTag().replace(/[s]\b/,"")}),f=f||u.type.methods.getTag(),f=(n.tagNameMapper[""+f]?n.tagNameMapper[""+f]:f).replace("e-",""),n.ej2Instances.getModuleName().toLowerCase()==="diagram"&&f.indexOf("annotations")!==-1&&(f="annotations")),u.children&&(r=n.resolveComplexInnerDirs(u.children,t[""+e],u.type.methods.getTag()),o[""+f]||(o[""+f]=[]),r.length>1?o[""+f]=r:o[""+f].push(r)),u.props&&(u.props=n.getCamelCaseProps(u.props)),i.length>1?(o=Object.keys(o).length===0&&!o.length?[]:o,u.props&&o.push(u.props)):o=u.props?Object.assign(o,u.props):o},n=this,s=0,h=i;s<h.length;s++){var p=h[s];a(p)}return o},resolveComplexInnerDirs:function(l,t,e){var i=[];i=l.default?l.default():l;for(var r=i.length>1?[]:{},o=0,a=i;o<a.length;o++){var n=a[o],s=null,h=n.type.methods.getTag();h=(this.tagNameMapper[""+h]?this.tagNameMapper[""+h]:h).replace("e-",""),n.children&&(s=this.resolveMultilevelComplexInnerDirs(n.children,t[""+e],n.type.methods.getTag()),/[s]\b/.test(h)||i.length>1?/[s]\b/.test(h)?(r[""+h]=r[""+h]?r[""+h]:[],s.length?r[""+h]=s:r[""+h].push(s)):s&&!n.props&&r.push(s):r=s||r),n.props&&(n.props=this.getCamelCaseProps(n.props)),i.length>1&&n.props?s?(s=n.props?Object.assign(s,n.props):s,r.push(s)):r.length>=0?r.push(n.props):r=n.props?Object.assign(r,n.props):r:r=n.props?Object.assign(r,n.props):r}return r},resolveMultilevelComplexInnerDirs:function(l,t,e){var i=[];i=l.default?l.default():l;for(var r=i.length>1?[]:{},o=0,a=i;o<a.length;o++){var n=a[o],s=null,h=n.type.methods.getTag();h=(this.tagNameMapper[""+h]?this.tagNameMapper[""+h]:h).replace("e-",""),n.children&&(s=this.resolveComplexInnerDirs(n.children,t[""+e],n.type.methods.getTag())),n.props&&(n.props=this.getCamelCaseProps(n.props)),/[s]\b/.test(h)?(r[""+h]=r[""+h]?r[""+h]:[],s.length?r[""+h]=s:r[""+h].push(s),n.props&&r[""+h].push(n.props)):(r=s,r=n.props?Object.assign(r,n.props):r)}return r},getDirectiveValues:function(l,t,e){var i=Object.keys(t),r={};if(l)for(var o=0,a=l;o<a.length;o++){var n=a[o],s=n.componentOptions;if(s&&s.children&&this.getTagName(s)||n.tag==="e-seriescollection"&&n.children){var h=s?this.getTagName(s):n.tag;if(h=h==="e-seriescollection"?"e-seriesCollection":h,i.indexOf(h)!==-1){var p=e[""+h]?e[""+h]:h;r[p.replace("e-","")]=[];for(var u=s?s.children:n.children,c=0,f=u;c<f.length;c++){var g=f[c],v=this.getVNodeValue(g,t[""+h],e);Object.keys(v).length!==0&&r[p.replace("e-","")].push(v)}}}}return r},getMultiLevelDirValue:function(l,t,e){for(var i={},r=0,o=l;r<o.length;r++){var a=o[r],n=void 0,s=void 0;if(a.componentOptions?(n=this.getTagName(a.componentOptions),a.componentOptions.children&&(s=a.componentOptions.children)):(a.tag==="e-markersettings"||a.tag==="e-markersetting")&&a.children&&(n=a.tag==="e-markersettings"?"e-markerSettings":"e-markerSetting",s=a.children),n){var h=e[""+n]?e[""+n]:n;if(i[h.replace("e-","")]=[],s)for(var p=0,u=s;p<u.length;p++){var c=u[p],f=this.getVNodeValue(c,t[""+n],e);Object.keys(f).length!==0&&i[h.replace("e-","")].push(f)}}}return i},getVNodeValue:function(l,t,e){var i={};if(l.componentOptions||(l.tag==="e-markersettings"||l.tag==="e-markersetting")&&l.context){var r=void 0;l.componentOptions?r=this.getTagName(l.componentOptions):r=l.tag==="e-markersettings"?"e-markerSettings":"e-markerSetting";var o=l.data;typeof t=="string"&&r===t&&o?i=o.attrs?this.getCamelCaseProps(o.attrs):this.getCamelCaseProps(o):typeof t=="object"&&(l.componentOptions.children&&Object.keys(t).indexOf(r)!==-1?i=this.getMultiLevelDirValue(l.componentOptions.children,t[""+r],e):l.children&&Object.keys(t).indexOf(r)!==-1&&(r==="e-markersettings"||r==="e-markersetting")&&(i=this.getMultiLevelDirValue(l.children,t[""+r],e)),o&&o.attrs&&(i=y(i,this.getCamelCaseProps(o.attrs))))}return i},getCamelCaseProps:function(l){for(var t={},e=0,i=Object.keys(l);e<i.length;e++){var r=i[e];t[r.replace(/-[a-z]/g,function(o){return o[1].toUpperCase()})]=l[""+r]}return t},dataBind:function(){this.ej2Instances.dataBind()},setProperties:function(l,t){return this.ej2Instances.setProperties(l,t)},getTagName:function(l){var t=l.tag,e=l.Ctor;return!t&&e&&e.extendOptions&&e.extendOptions.methods&&e.extendOptions.methods.getTag&&(t=l.Ctor.extendOptions.methods.getTag()),t}}});function xy(l){if(l===void 0&&(l={}),l.props)for(var t=function(o){(l.newprops||(l.newprops={}))[""+o]={},(l.watch||(l.watch={}))[""+o]=function(a){this.ej2Instances[""+o]=a,this.dataBind&&l.name!=="DateRangePickerComponent"&&this.dataBind()}},e=0,i=l.props;e<i.length;e++){var r=i[e];t(r)}return[l.newprops,l.watch]}At||Od(xt.toRaw);var Vi=function(){return Vi=Object.assign||function(l){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(l[r]=t[r])}return l},Vi.apply(this,arguments)},Fl=Ef();function Ay(l,t){var e=this;return function(i,r,o,a,n){var s;if(r){var h=r.vueInstance&&r.vueInstance.plugins?{plugins:r.vueInstance.plugins}:{},p=r.vueInstance?r.vueInstance:n&&n.vueInstance?n.vueInstance:null,u=Ve("templateParentDiv"),c=Ve("templateDiv"),f=Ie("div",{id:u,innerHTML:'<div id="'+c+'"></div>'});if(document.body.appendChild(f),!At&&(typeof l=="string"||l.prototype&&l.prototype.CSPTemplate&&typeof l=="function")){var g=Py(r.vueInstance,l,n);if(g){var v=xt.createVNode({render:function(){return g[""+l]({data:i})}},h);if(f.innerHTML="",Ul(v,r.vueInstance,n),xt.render(v,f),s=f.childNodes,p){var m=p.templateCollection;m||(p.templateCollection={},m=p.templateCollection),o&&(m[""+o]||(m[""+o]=[]),m[""+o].push(f))}X(f)}else return X(f),Fl(l,t)(i)}else if(At)if(typeof l=="string"||l.prototype&&l.prototype.CSPTemplate&&typeof l=="function"){var ae=zy(r.vueInstance,l,n);if(ae){var E={},L=function(oe){oe.$parent&&L(oe.$parent),oe._provided&&Object.keys(oe._provided).length>0&&(E=Vi({},E,oe._provided))},k=r.vueInstance?r.vueInstance:n&&n.vueInstance?n.vueInstance:null;k&&L(k);var U=new xt({provide:Vi({},E),render:function(){return ae[""+l]({data:i})}});if(U.$mount("#"+c),s=f.childNodes,k){var m=k.templateCollection;m||(k.templateCollection={},m=k.templateCollection),o&&(m[""+o]||(m[""+o]=[]),m[""+o].push(s[0]))}X(f)}else return X(f),Fl(l,t)(i)}else{var C=l.call(e,{}),B=C.template,I=Z("template.propsData",C),R={data:{data:y(C.data||{},i)},parent:r.vueInstance};I&&(B=C.template.extends,R.propsData=I),typeof B!="function"&&(B=xt.extend(B)),B.options.setup&&(R.propsData=Object.assign(R.propsData||{},i));var $=new B(R);if($.$mount("#"+c),s=f.childNodes,R.parent=null,p){var m=p.templateCollection;m||(p.templateCollection={},m=p.templateCollection),o&&(m[""+o]||(m[""+o]=[]),m[""+o].push(s[0]))}X(f)}else{var C=l.call(e,{}),M=C,I=Z("template.propsData",C),N={data:{data:y(C.data||{},i)},parent:r.vueInstance};M.template||(M.template=M[Object.keys(M)[0]]);var O=void 0;if(M.template.extends)O=M.template.extends._context.components.template;else if(O=M.template._context.components[l.name],!O){var x=Object.keys(M.template._context.components)[0];O=M.template._context.components[""+x]}var D;if(I)O.setup?D=Object.assign({},I):D=Object.assign(O.data(),I);else if(O.setup?D=Object.assign({},N.data):D=Object.assign(O.data(),N.data),O.components)for(var A=Object.keys(O.components)||[],P=function(he){var pe=O.components[""+he];pe&&pe.data&&(pe.__data||(pe.__data=pe.data),pe.data=function(Te){return Object.assign(pe.__data.call(Te),N.data)})},V=0,q=A;V<q.length;V++){var re=q[V];P(re)}O.setup&&(h=Object.assign(h,i)),O.data=function(){return D};var v=xt.createVNode(O,h);if(f.innerHTML="",Ul(v,r.vueInstance,n),xt.render(v,f),s=f.childNodes,N.parent=null,p){var m=p.templateCollection;m||(p.templateCollection={},m=p.templateCollection),o&&(m[""+o]||(m[""+o]=[]),m[""+o].push(f))}X(f)}}return s||[]}}Pf({compile:Ay});function Ul(l,t,e){var i=t||(e&&e.vueInstance?e.vueInstance:null);if(i){l.appContext=i.$.appContext;var r={},o=function(a){a.$&&a.$.parent&&o(a.$.parent),a.provides&&Object.keys(a.provides).length>0&&(r=Vi({},r,a.provides))};o(i),l.appContext.provides&&(l.appContext.provides=Vi({},l.appContext.provides,r))}}function zy(l,t,e){if(!(!l&&!(e&&e.vueInstance))){var i=e&&e.vueInstance?e.vueInstance:l;return tn(i,t)}}function tn(l,t){if(l){var e=l.$slots,i=l.$scopedSlots,r=l.scopedSlots,o=l.children;if(i&&i[""+t])return i;if(e&&e.default)for(var a=e.default,n=0;n<a.length;n++){var s=tn(Rl(a[parseInt(n.toString(),10)]),t);if(s)return s}else{if(r&&r[""+t])return r;if(o)for(var n=0;n<o.length;n++){var s=tn(Rl(o[parseInt(n.toString(),10)]),t);if(s)return s}}}}function Rl(l){var t=l.componentOptions&&l.componentOptions.children?l.componentOptions:!l.data&&(l.tag==="e-markersettings"||l.tag==="e-markersetting")?l:l.data;return l.componentInstance?l.componentInstance:t}function Py(l,t,e){if(!(!l&&!(e&&e.vueInstance))){var i=e&&e.vueInstance?e.vueInstance.$slots:l.$slots;return Hh(i,t)}}function Hh(l,t){if(l&&l[""+t])return l;if(l&&l.default){var e=l.default();e=e.flatMap(function(o){return Array.isArray(o.children)?o.children:o});for(var i=0;i<e.length;i++){var r=Hh(e[parseInt(i.toString(),10)].children,t);if(r)return r}}}var Qh=["isLazyUpdate","plugins","allowUndoRedo","cssClass","disabled","enablePersistence","enableRtl","finetuneSettings","fontFamily","height","isReadOnly","locale","quickAccessToolbarTemplate","selectionSettings","showQuickAccessToolbar","theme","toolbar","toolbarTemplate","uploadSettings","width","zoomSettings","beforeSave","click","created","cropping","destroyed","editComplete","fileOpened","finetuneValueChanging","flipping","frameChange","imageFiltering","panning","quickAccessToolbarItemClick","quickAccessToolbarOpen","resizing","rotating","saved","selectionChanging","shapeChange","shapeChanging","toolbarCreated","toolbarItemClicked","toolbarUpdating","zooming"],Xh=[],Wh=xy({props:Qh}),Ey=Wh[0],Vh=Wh[1],Sn=Object.keys(Vh);Sn.push("modelchanged","update:modelValue");for(var La=0,Bl=Xh;La<Bl.length;La++){var Ly=Bl[La];Sn.push("update:"+Ly)}var ky=Bh({name:"ImageEditorComponent",mixins:[Oy],props:Ey,watch:Vh,emits:Sn,provide:function(){return{custom:this.custom}},data:function(){return{ej2Instances:new ny({}),propKeys:Qh,models:Xh,hasChildDirective:!1,hasInjectedModules:!1,tagMapper:{},tagNameMapper:{},isVue3:!At,templateCollection:{}}},created:function(){this.bindProperties(),this.ej2Instances._setProperties=this.ej2Instances.setProperties,this.ej2Instances.setProperties=this.setProperties,this.ej2Instances.clearTemplate=this.clearTemplate,this.updated=this.updated},render:function(l){var t=At?l:wy,e=null;return d(this.$slots.default)||(e=At?this.$slots.default:this.$slots.default()),t("div",e)},methods:{clearTemplate:function(l){if(l||(l=Object.keys(this.templateCollection||{})),l.length&&this.templateCollection)for(var t=0,e=l;t<e.length;t++){var i=e[t],r=this.templateCollection[i];if(r&&r.length){for(var o=0,a=r;o<a.length;o++){var n=a[o];this.destroyPortals(n)}delete this.templateCollection[i]}}},setProperties:function(l,t){var e=this;this.isVue3&&(this.models=this.models?this.models:this.ej2Instances.referModels),this.ej2Instances&&this.ej2Instances._setProperties&&this.ej2Instances._setProperties(l,t),l&&this.models&&this.models.length&&Object.keys(l).map(function(i){e.models.map(function(r){i===r&&!/datasource/i.test(i)&&(e.isVue3?e.ej2Instances.vueInstance.$emit("update:"+i,l[i]):(e.$emit("update:"+i,l[i]),e.$emit("modelchanged",l[i])))})})},custom:function(){this.updated()},apply:function(){return this.ej2Instances.apply()},applyImageFilter:function(l){return this.ej2Instances.applyImageFilter(l)},bringForward:function(l){return this.ej2Instances.bringForward(l)},bringToFront:function(l){return this.ej2Instances.bringToFront(l)},canRedo:function(){return this.ej2Instances.canRedo()},canUndo:function(){return this.ej2Instances.canUndo()},clearImage:function(){return this.ej2Instances.clearImage()},clearSelection:function(l){return this.ej2Instances.clearSelection(l)},cloneShape:function(l){return this.ej2Instances.cloneShape(l)},crop:function(){return this.ej2Instances.crop()},deleteRedact:function(l){return this.ej2Instances.deleteRedact(l)},deleteShape:function(l){return this.ej2Instances.deleteShape(l)},destroy:function(){return this.ej2Instances.destroy()},discard:function(){return this.ej2Instances.discard()},drawArrow:function(l,t,e,i,r,o,a,n,s){return this.ej2Instances.drawArrow(l,t,e,i,r,o,a,n,s)},drawEllipse:function(l,t,e,i,r,o,a,n,s){return this.ej2Instances.drawEllipse(l,t,e,i,r,o,a,n,s)},drawFrame:function(l,t,e,i,r,o,a,n,s){return this.ej2Instances.drawFrame(l,t,e,i,r,o,a,n,s)},drawImage:function(l,t,e,i,r,o,a,n,s){return this.ej2Instances.drawImage(l,t,e,i,r,o,a,n,s)},drawLine:function(l,t,e,i,r,o,a){return this.ej2Instances.drawLine(l,t,e,i,r,o,a)},drawPath:function(l,t,e,i){return this.ej2Instances.drawPath(l,t,e,i)},drawRectangle:function(l,t,e,i,r,o,a,n,s,h){return this.ej2Instances.drawRectangle(l,t,e,i,r,o,a,n,s,h)},drawRedact:function(l,t,e,i,r,o){return this.ej2Instances.drawRedact(l,t,e,i,r,o)},drawText:function(l,t,e,i,r,o,a,n,s,h,p,u,c,f){return this.ej2Instances.drawText(l,t,e,i,r,o,a,n,s,h,p,u,c,f)},enableShapeDrawing:function(l,t){return this.ej2Instances.enableShapeDrawing(l,t)},enableTextEditing:function(){return this.ej2Instances.enableTextEditing()},export:function(l,t,e){return this.ej2Instances.export(l,t,e)},finetuneImage:function(l,t){return this.ej2Instances.finetuneImage(l,t)},flip:function(l){return this.ej2Instances.flip(l)},freehandDraw:function(l){return this.ej2Instances.freehandDraw(l)},getImageData:function(l){return this.ej2Instances.getImageData(l)},getImageDimension:function(){return this.ej2Instances.getImageDimension()},getImageFilter:function(l){return this.ej2Instances.getImageFilter(l)},getRedacts:function(){return this.ej2Instances.getRedacts()},getShapeSetting:function(l){return this.ej2Instances.getShapeSetting(l)},getShapeSettings:function(){return this.ej2Instances.getShapeSettings()},initialize:function(){return this.ej2Instances.initialize()},open:function(l,t,e){return this.ej2Instances.open(l,t,e)},pan:function(l,t,e){return this.ej2Instances.pan(l,t,e)},redo:function(){return this.ej2Instances.redo()},reset:function(){return this.ej2Instances.reset()},resize:function(l,t,e){return this.ej2Instances.resize(l,t,e)},rotate:function(l){return this.ej2Instances.rotate(l)},select:function(l,t,e,i,r){return this.ej2Instances.select(l,t,e,i,r)},selectRedact:function(l){return this.ej2Instances.selectRedact(l)},selectShape:function(l){return this.ej2Instances.selectShape(l)},sendBackward:function(l){return this.ej2Instances.sendBackward(l)},sendToBack:function(l){return this.ej2Instances.sendToBack(l)},straightenImage:function(l){return this.ej2Instances.straightenImage(l)},triggerEditCompleteEvent:function(l){return this.ej2Instances.triggerEditCompleteEvent(l)},undo:function(){return this.ej2Instances.undo()},update:function(){return this.ej2Instances.update()},updateRedact:function(l,t){return this.ej2Instances.updateRedact(l,t)},updateShape:function(l,t){return this.ej2Instances.updateShape(l,t)},zoom:function(l,t){return this.ej2Instances.zoom(l,t)}}});const Yy=Wl({color:String,cycle:Boolean,delimiterIcon:{type:Wc,default:"$delimiter"},height:{type:[Number,String],default:500},hideDelimiters:Boolean,hideDelimiterBackground:Boolean,interval:{type:[Number,String],default:6e3,validator:l=>Number(l)>0},progress:[Boolean,String],verticalDelimiters:[Boolean,String],...id({continuous:!0,mandatory:"force",showArrows:!0})},"VCarousel"),Fy=Vl()({name:"VCarousel",props:Yy(),emits:{"update:modelValue":l=>!0},setup(l,t){let{slots:e}=t;const i=Vc(l,"modelValue"),{t:r}=qc(),o=gi();let a=-1;vi(i,s),vi(()=>l.interval,s),vi(()=>l.cycle,h=>{h?s():window.clearTimeout(a)}),on(n);function n(){!l.cycle||!o.value||(a=window.setTimeout(o.value.group.next,+l.interval>0?+l.interval:6e3))}function s(){window.clearTimeout(a),window.requestAnimationFrame(n)}return ql(()=>{const h=Pn.filterProps(l);return Je(Pn,br({ref:o},h,{modelValue:i.value,"onUpdate:modelValue":p=>i.value=p,class:["v-carousel",{"v-carousel--hide-delimiter-background":l.hideDelimiterBackground,"v-carousel--vertical-delimiters":l.verticalDelimiters},l.class],style:[{height:Gc(l.height)},l.style]}),{default:e.default,additional:p=>{let{group:u}=p;return Je(rn,null,[!l.hideDelimiters&&Je("div",{class:"v-carousel__controls",style:{left:l.verticalDelimiters==="left"&&l.verticalDelimiters?0:"auto",right:l.verticalDelimiters==="right"?0:"auto"}},[u.items.value.length>0&&Je(_c,{defaults:{VBtn:{color:l.color,icon:l.delimiterIcon,size:"x-small",variant:"text"}},scoped:!0},{default:()=>[u.items.value.map((c,f)=>{const g={id:`carousel-item-${c.id}`,"aria-label":r("$vuetify.carousel.ariaLabel.delimiter",f+1,u.items.value.length),class:["v-carousel__controls__item",u.isSelected(c.id)&&"v-btn--active"],onClick:()=>u.select(c.id,!0)};return e.item?e.item({props:g,item:c}):Je(yr,br(c,g),null)})]})]),l.progress&&Je(Zc,{class:"v-carousel__progress",color:typeof l.progress=="string"?l.progress:void 0,modelValue:(u.getItemIndex(i.value)+1)/u.items.value.length*100},null)])},prev:e.prev,next:e.next})}),{}}}),Uy=Wl({...od(),...rd()},"VCarouselItem"),Ry=Vl()({name:"VCarouselItem",inheritAttrs:!1,props:Uy(),setup(l,t){let{slots:e,attrs:i}=t;ql(()=>{const r=Fa.filterProps(l),o=En.filterProps(l);return Je(En,br({class:["v-carousel-item",l.class]},o),{default:()=>[Je(Fa,br(i,r),e)]})})}}),By={key:0,class:"mx-2"},Hy={key:1,class:"d-flex justify-center align-center mt-4"},lm={__name:"FichaCard",props:{show:Boolean,item:Object,isView:{type:Boolean,default:!1},linkView:String,images:{type:Array,default:()=>[]},pessoaObj:Object},emits:["close","confirmar"],setup(l,{emit:t}){const e=l,i=["RotateLeft","RotateRight","Crop","ZoomIn","ZoomOut"],r=Kc(),{$toast:o}=Jc();rf(`${r.public.docEditor}`);const a=`${r.public.managemant}/minio/tiff_para_png`,n=`${r.public.managemant}/minio/update_image`,s=gi(null),h=gi(e.show),p=gi(0),u=gi(!1),c=gi(!1),f=t,g=Hl(()=>e.images&&e.images.length>0?(Array.isArray(e.images[0]),e.images):e.linkView?[e.linkView]:[]),v=x=>{u.value=x.toolbarType==="crop-transform"},m=()=>{f("confirmar"),N()},C=async()=>{var x;try{const D=(x=s.value)==null?void 0:x.ej2Instances;if(!D)return;const A=D.getImageData(),P=document.createElement("canvas");P.width=A.width,P.height=A.height,P.getContext("2d").putImageData(A,0,0);const q=await new Promise(E=>P.toBlob(E,"image/png")),re=new FormData;re.append("cartorio_token",An("user-data").value.cartorio_token),re.append("path",g.value[0][p.value].path),re.append("file",q,`ficha_editada_${p.value}.png`);const{status:ae}=await zn(n,{method:"PUT",body:re},"$4omB3S9Tg3");ae.value==="success"&&o.success(`Ficha ${p.value+1} atualizada com sucesso!`)}catch(D){console.error(D),o.error("Erro ao atualizar a ficha")}},M=async x=>{var D;if(!(!x||!((D=s.value)!=null&&D.ej2Instances)))try{const A=s.value.ej2Instances,V=await(await fetch(x.url)).blob(),q=new File([V],"image.tiff",{type:V.type||"application/octet-stream"}),re=new FormData;re.append("tipo","ficha"),re.append("cartorio_token",An("user-data").value.cartorio_token),re.append("path",x.path),re.append("pessoa_token",e.pessoaObj.token),re.append("file",q);const{data:ae}=await zn(a,{method:"POST",body:re},"$yanMHqBuqW");await A.open(ae.value.msg)}catch(A){console.error("Erro ao carregar imagem:",A)}},I=async()=>{c&&g.value[0].length&&g.value[0][p.value]&&await M(g.value[0][p.value])};vi(()=>e.linkView,I,{immediate:!0}),vi(()=>e.images,I,{immediate:!0,deep:!0}),vi(p,async()=>await I()),on(async()=>{await Ya(),await I()});const N=()=>{h.value=!1,f("close")},O=async()=>{c.value=!c.value,c.value&&(await Ya(),await I())};return(x,D)=>(ri(),fr(ad,{persistent:"",modelValue:ot(h),"onUpdate:modelValue":D[1]||(D[1]=A=>ka(h)?h.value=A:null),"max-width":"1200"},{default:wt(()=>[Je($c,null,{default:wt(()=>[Je(ed,{class:"text-h5 d-flex justify-space-between align-center"},{default:wt(()=>[D[2]||(D[2]=Ql("span",null,"Ficha de Firma",-1)),ot(g)[0].length>1&&!ot(c)?(ri(),po("span",By,uo(ot(p)+1)+" / "+uo(ot(g)[0].length),1)):gr("",!0)]),_:1}),!ot(c)&&ot(g)[0].length>1?(ri(),fr(Fy,{key:0,modelValue:ot(p),"onUpdate:modelValue":D[0]||(D[0]=A=>ka(p)?p.value=A:null),"show-arrows":"hover","hide-delimiter-background":"",height:"750",width:"1000",class:"rounded-lg overflow-hidden"},{default:wt(()=>[(ri(!0),po(rn,null,Xl(ot(g)[0],(A,P)=>(ri(),fr(Ry,{key:P,value:P},{default:wt(()=>[Je(Fa,{src:A.url,cover:""},null,8,["src"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])):gr("",!0),ot(c)?(ri(),po("div",Hy,[Je(ot(ky),{height:"750px",width:"850px",ref_key:"imageEditorRef",ref:s,toolbar:i,toolbarUpdating:v},null,512)])):gr("",!0),Je(td,null,{default:wt(()=>[Je(yr,{style:{"background-color":"#429946",color:"white"},onClick:O,disabled:ot(u)},{default:wt(()=>[vr(uo(ot(c)?"Voltar ao carrossel":"Editar imagem"),1)]),_:1},8,["disabled"]),Je(yr,{style:{"background-color":"#429946",color:"white"},onClick:C,disabled:ot(u)},{default:wt(()=>D[3]||(D[3]=[vr("Salvar")])),_:1},8,["disabled"]),e.isView?gr("",!0):(ri(),fr(yr,{key:0,style:{"background-color":"#085a98",color:"white"},onClick:m},{default:wt(()=>D[4]||(D[4]=[vr("Reconhecer")])),_:1})),Je(yr,{style:{"background-color":"red",color:"white"},onClick:N},{default:wt(()=>D[5]||(D[5]=[vr("Voltar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{Mi as $,ai as A,jr as B,ct as C,Ke as D,b as E,Jy as F,qi as G,uy as H,me as I,S as J,Xf as K,bo as L,Or as M,Qe as N,Ri as O,T as P,ch as Q,cn as R,pt as S,Tr as T,at as U,vy as V,de as W,tm as X,dt as Y,ni as Z,lm as _,G as a,hf as a0,ue as a1,ne as a2,Gy as a3,em as a4,$l as a5,yo as a6,Bt as a7,gt as a8,Ky as a9,Mo as aa,Ss as ab,Ie as ac,Xi as ad,ey as ae,lt as af,$y as ag,Rt as ah,mr as ai,Yi as aj,De as ak,Ao as al,qa as am,ss as an,Kt as ao,rm as ap,im as aq,Zy as ar,qv as as,xy as at,Bh as au,Oy as av,At as aw,wy as ax,W as b,ce as c,X as d,sm as e,nm as f,Ve as g,Y as h,d as i,Pi as j,ge as k,te as l,Z as m,mi as n,y as o,Hn as p,st as q,rf as r,Ae as s,Qi as t,ht as u,Be as v,om as w,ee as x,am as y,it as z};
