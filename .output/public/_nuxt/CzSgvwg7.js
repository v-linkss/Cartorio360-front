import{_ as D,n as G,u as H,r,o as p,c as W,a as x,b as t,x as s,V as K,w as n,C as P,z as X,y as f,J as Z,d as _,v as y,K as V,G as b,p as j,e as Q,A as N}from"./B0_7dY_T.js";import{a as Y,u as ee}from"./CgJj6bVa.js";import{_ as ae}from"./CkMvr48y.js";import{V as oe}from"./wvpl2xdV.js";import{V as te,a as w}from"./Cu79RT_f.js";import"./CYgJiEkP.js";const O=v=>(j("data-v-69521f2a"),v=v(),Q(),v),se={class:"container-main"},ne={class:"container-form"},ie=O(()=>x("div",{class:"text"},"Log in",-1)),le=O(()=>x("a",{class:"text-decoration-none",rel:"noopener noreferrer",style:{color:"#429946"}}," Esqueceu a senha?",-1)),re=O(()=>x("div",{class:"background-image"},null,-1)),ce={__name:"index",setup(v){const $=G(),{$toast:U}=H(),c=r({senha:"",email:""}),h=r(!1),i=r(!1),C=r(!1),E=r(!1),S=r(!1),u=r(!1),k=()=>{C.value=!1,E.value=!1,u.value=!1,S.value=!1,i.value=!1},B=X(),A=`${B.public.managemant}/listarMenu`,J=B.public.auth,M=async()=>{const{data:o,status:e,error:a}=await ee(`${J}/login`,{method:"POST",body:{senha:c.value.senha,email:c.value.email}},"$iX10IJN3fa");return{data:o==null?void 0:o.value,status:e==null?void 0:e.value,error:a==null?void 0:a.value}},R=o=>{const e=N("user-data");e.value=JSON.stringify({nome:o.nome,usuario_id:o.id,cartorio_id:o.cartorios[0].cartorio_id,cartorio_nome:o.cartorios[0].cartorio_descricao,cartorio_token:o.cartorios[0].cartorio_token});const a=N("auth_token");a.value=o.token},T=o=>{var l,d,m;const e=(m=(d=(l=o==null?void 0:o.data)==null?void 0:l[0])==null?void 0:d.func_autentica_acesso_v1)==null?void 0:m[0],a=e==null?void 0:e.status_mensagem;if(!e){u.value=!0;return}switch(a){case"Esse email não está cadastrado no Durabil.":E.value=!0;break;case"Senha inválida.":C.value=!0;break;case"Seu cadastro está desativado. Entre em contato com o administrador da conta.":S.value=!0;break;default:u.value=!0;break}},z=async()=>{var l,d,m,I;const{data:o,status:e,error:a}=await M();if(e==="success"){const g=(I=(m=(d=(l=o==null?void 0:o[0])==null?void 0:l.func_autentica_acesso_v1)==null?void 0:d[0])==null?void 0:m.registro)==null?void 0:I[0];if(R(g),g.cartorios.length>1){$.push({path:"/login/tipo-perfil",query:{cartorios:JSON.stringify(g.cartorios)}});return}U.success("Login realizado com sucesso!");const{data:F,status:L}=await Y(A,{method:"POST",body:{perfil_descricao:g.cartorios[0].perfil_descricao}},"$ZtHWy4R1Ea");if(L.value==="success"){const q=N("menu-navbar");q.value=F.value,$.push({path:"/"})}}else e==="error"&&(a==null?void 0:a.statusCode)===500?u.value=!0:T(a)};return(o,e)=>(p(),W("div",se,[x("div",ne,[t(oe,{class:"image",width:300,height:"230",src:ae}),ie,t(K,{autofocus:"",autocomplete:"email",type:"email",modelValue:s(c).email,"onUpdate:modelValue":e[0]||(e[0]=a=>s(c).email=a),"persistent-hint":"",class:"input",density:"compact",placeholder:"Email","prepend-inner-icon":"mdi-email-outline",variant:"outlined"},null,8,["modelValue"]),t(K,{modelValue:s(c).senha,"onUpdate:modelValue":e[1]||(e[1]=a=>s(c).senha=a),class:"input","append-inner-icon":s(h)?"mdi-eye-off":"mdi-eye",type:s(h)?"text":"password",density:"compact",placeholder:"Senha","prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":e[2]||(e[2]=a=>h.value=!s(h))},null,8,["modelValue","append-inner-icon","type"]),t(te,{modelValue:s(i),"onUpdate:modelValue":e[4]||(e[4]=a=>P(i)?i.value=a:null),"max-width":"400",persistent:""},{activator:n(({props:a})=>[t(f,Z({block:"",rounded:"",class:"button mb-10 mt-4"},a,{onClick:z,modelValue:s(i),"onUpdate:modelValue":e[3]||(e[3]=l=>P(i)?i.value=l:null)}),{default:n(()=>[_(" Acessar ")]),_:2},1040,["modelValue"])]),default:n(()=>[s(C)?(p(),y(w,{key:0,text:"Senha inválida."},{actions:n(()=>[t(V),t(f,{onClick:k,style:{"background-color":"#429946",color:"white"}},{default:n(()=>[_(" OK ")]),_:1})]),_:1})):b("",!0),s(E)?(p(),y(w,{key:1,text:"Esse email não está cadastrado."},{actions:n(()=>[t(V),t(f,{onClick:k,style:{"background-color":"#429946",color:"white"}},{default:n(()=>[_(" OK ")]),_:1})]),_:1})):b("",!0),s(u)?(p(),y(w,{key:2,text:"Erro no sistema, fora do ar."},{actions:n(()=>[t(V),t(f,{onClick:k,style:{"background-color":"#429946",color:"white"}},{default:n(()=>[_(" OK ")]),_:1})]),_:1})):b("",!0),s(S)?(p(),y(w,{key:3,text:"Seu cadastro está desativado. Entre em contato com o administrador da conta."},{actions:n(()=>[t(V),t(f,{onClick:k,style:{"background-color":"#429946",color:"white"}},{default:n(()=>[_(" OK ")]),_:1})]),_:1})):b("",!0)]),_:1},8,["modelValue"]),le]),re]))}},ve=D(ce,[["__scopeId","data-v-69521f2a"]]);export{ve as default};
