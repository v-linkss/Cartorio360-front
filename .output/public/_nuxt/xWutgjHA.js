import{r as i,m as N,A as O,g as P,E as U,o as E,q as j,w as l,b as a,a as p,c1 as F,d as J,v as t,F as g,s as L}from"./Cwjuz0gi.js";import{c as M,r as W,u as Y}from"./Cywgjt0h.js";import{u as w}from"./DvPj8CwQ.js";import{a as z,d as H,V as G}from"./D8P2eLQa.js";import{V as K}from"./2utwVGDD.js";import{V as Q}from"./CHvkpzc3.js";import{V as X}from"./efGKukeH.js";import{V as Z}from"./CY4pCbZg.js";const ee=""+new URL("selo.D9mIBRmY.png",import.meta.url).href,ue={__name:"Selos",props:{show:Boolean,ato_token:String},emits:["close"],async setup($,{emit:S}){let m,_;const u=$,n=i(u.show),f=L(),y=i(N("user-data").value.cartorio_token).value,h=`${f.public.managemant}/listarSelos`,C=`${f.public.managemant}/reimprimirSelo`,R=`${f.public.managemant}/listarEscrevente`,V=i([]),c=i([]),d=O({escrevente:null}),T=S,B={escrevente:{required:M.withMessage("O campo é obrigatorio",W)}},v=Y(B,d),I=[{title:"Numero",value:"numero"},{title:"Referencia",value:"referencia"},{value:"actions"}];P(()=>u.show,o=>{n.value=o,o&&A()});const b=()=>{n.value=!1,T("close")},k=i([]),{data:x}=([m,_]=U(()=>w(R,{method:"POST",body:{cartorio_token:y}},"$V2ulT7DYvP")),m=await m,_(),m);k.value=x.value[0].func_json_escreventes;const q=async()=>{if(await v.value.$validate()){const o=c.value.map(r=>({selo_token:r})),e={escrevente_token:d.escrevente,ato_token:u.ato_token,selos:o},{data:s,error:se,status:D}=await w(`${C}`,{method:"POST",body:e},"$45J51uHTfa");if(D.value==="success"){const r=window.open("","_blank");r.document.open(),r.document.write(s.value[0].etiqueta),r.document.close(),b()}}},A=async()=>{const{data:o,error:e}=await w(`${h}`,{method:"POST",body:{ato_token:u.ato_token}},"$rLWIRtrfDz");o.value.selos===null?V.value=[]:V.value=o.value.selos};return(o,e)=>(E(),j(G,{persistent:"",modelValue:t(n),"onUpdate:modelValue":e[2]||(e[2]=s=>g(n)?n.value=s:null),"max-width":"500"},{default:l(()=>[a(z,null,{default:l(()=>[a(K,null,{default:l(()=>[a(Q,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:l(()=>[e[4]||(e[4]=p("h1",{class:"ml-4"},"Reimpressão de Selos",-1)),a(F,{class:"mt-4 mr-4",style:{color:"red"},onClick:b},{default:l(()=>e[3]||(e[3]=[J("mdi-close")])),_:1})]),_:1}),e[5]||(e[5]=p("hr",{class:"mb-5"},null,-1)),a(X,{class:"mb-5",label:"Tabelião/escrivão",modelValue:t(d).escrevente,"onUpdate:modelValue":e[0]||(e[0]=s=>t(d).escrevente=s),items:t(k),"item-title":"nome","item-value":"token",required:"","error-messages":t(v).escrevente.$errors.map(s=>s.$message),onBlur:t(v).escrevente.$touch,onInput:t(v).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"]),a(Z,{headers:I,items:t(V),"item-value":"token","show-select":"",modelValue:t(c),"onUpdate:modelValue":e[1]||(e[1]=s=>g(c)?c.value=s:null)},null,8,["items","modelValue"])]),_:1}),a(H,null,{default:l(()=>[p("div",null,[p("img",{src:ee,style:{cursor:"pointer"},onClick:q})])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{ee as _,ue as a};
