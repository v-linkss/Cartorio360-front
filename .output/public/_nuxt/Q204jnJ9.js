import{_ as e}from"./4de_rhUN.js";import{_ as a}from"./DJIqEjZF.js";import{n as t,r,D as o,F as s,G as l,o as n,A as i,w as u,x as c,H as d,b as m,a as p,t as v,q as f,I as _,s as g,C as h,K as b,L as y,c as k,J as x}from"./Cqiv77yc.js";import{u as V}from"./D0-0VRaN.js";import"./ujvleXxP.js";import{c as C,r as $,u as w,_ as j}from"./CnBBmU9u.js";import{_ as E,a as O,b as S,c as q}from"./CBYd86re.js";import{_ as A}from"./DmmIIbRx.js";import{_ as I}from"./ToPptOUL.js";import{V as P}from"./sftuTnbG.js";import{V as R}from"./B5iMDmra.js";import{V as T}from"./03NkGgWs.js";import{V as U}from"./DGrEsPnk.js";import"./oKXwpsuu.js";const B=p("h1",null,"Ordem de Serviço nº",-1),F={style:{color:"red","margin-left":"30px"}},L=p("h1",{class:"ml-5"},"Atos",-1),N=p("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:O,alt:"novo"},null,-1),D=[p("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:A,alt:"Reimprimir"},null,-1)],G=["onClick","title"],H=["disabled","onClick"],J={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:S,alt:"Visualizar",title:"Reativar"},M={key:1,src:q,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},z={__name:"criar-registro",async setup(O){var S,q,A,z;let K,Q;const{$toast:Y}=t(),W=c(),X=`${W.public.managemant}/createOrdensServico`,Z=`${W.public.managemant}/validarCpf`,ee=`${W.public.managemant}/listarAtos`,ae=r(o("user-data").value.cartorio_id),te=r(o("user-data").value.usuario_id),re=r(null==(S=o("user-service").value)?void 0:S.token).value||null,oe=r(o("user-data").value.cartorio_token).value;let se=r(!!(null==(q=o("user-service").value)?void 0:q.numero)),le=r(o("ordem-button").value),ne=!1;const ie=r(!1),ue=r([]),ce=s({nacionalidade:"brasileiro",apresentante_nome:null==(A=o("user-service").value)?void 0:A.apresentante_nome,apresentante_cpf:null==(z=o("user-service").value)?void 0:z.apresentante_cpf,documento:null}),de=[{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],me=[{title:"BRASILEIRO",value:"brasileiro"},{title:"ESTRANGEIRO",value:"estrangeiro"}],pe={apresentante_nome:{required:C.withMessage("O campo é obrigatorio",$)},apresentante_cpf:{required:C.withMessage("O campo é obrigatorio",$)}},ve=w(pe,ce);function fe(e){if(e)return e.replace(/[.\-]/g,"");e=null}function _e(){const e=o("user-service"),a=o("ordem-button");e.value=null,a.value=null}const{data:ge}=([K,Q]=l((()=>V(ee,{method:"POST",body:{cartorio_token:oe,ordemserv_token:re}},"$Q1qkHbHde0"))),K=await K,Q(),K);return ge.value.length>0?ue.value=ge.value:ue.value=[],(t,r)=>{const s=e,l=a,c=d("mask");return n(),i(P,{class:"mt-5"},{default:u((()=>[m(R,{class:"mb-5"},{default:u((()=>{var e;return[B,p("h1",F,v(null==(e=("useCookie"in t?t.useCookie:f(o))("user-service").value)?void 0:e.numero),1)]})),_:1}),m(R,null,{default:u((()=>[m(T,{md:"3"},{default:u((()=>[m(U,{label:"Nacionalidade",items:me,modelValue:f(ce).nacionalidade,"onUpdate:modelValue":r[0]||(r[0]=e=>f(ce).nacionalidade=e)},null,8,["modelValue"])])),_:1}),m(T,{md:"2"},{default:u((()=>["brasileiro"===f(ce).nacionalidade?_((n(),i(g,{key:0,autofocus:"",modelValue:f(ce).apresentante_cpf,"onUpdate:modelValue":r[1]||(r[1]=e=>f(ce).apresentante_cpf=e),label:"CPF",required:"","error-messages":f(ve).apresentante_cpf.$errors.map((e=>e.$message)),onBlur:f(ve).apresentante_cpf.$touch,onInput:r[2]||(r[2]=e=>async function(e){const a=fe(e);if(11===a.length&&!ne){ne=!0;const e={cpf:a};try{const{data:a,error:t,status:r}=await V(Z,{method:"POST",body:e},"$e6ybTA3ect");"error"===r.value&&500===t.value.statusCode?Y.error("Erro ao cadastrar pessoa, o CPF já está cadastrado."):!0===a.value.cpfValidation?(ce.apresentante_nome=a.value.nome,Y.success("Cpf autenticado com sucesso!")):!1===a.value.cpfValidation&&Y.error("Cpf não cadastrado!")}catch(t){console.error("Erro ao validar CPF:",t)}finally{ne=!1}}}(f(ce).apresentante_cpf))},null,8,["modelValue","error-messages","onBlur"])),[[c,"###.###.###-##"]]):(n(),i(g,{key:1,autofocus:"",modelValue:f(ce).apresentante_cpf,"onUpdate:modelValue":r[3]||(r[3]=e=>f(ce).apresentante_cpf=e),label:"Documento",required:"","error-messages":f(ve).apresentante_cpf.$errors.map((e=>e.$message)),onBlur:f(ve).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))])),_:1}),m(T,{md:"4"},{default:u((()=>[m(g,{modelValue:f(ce).apresentante_nome,"onUpdate:modelValue":r[4]||(r[4]=e=>f(ce).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":f(ve).apresentante_nome.$errors.map((e=>e.$message)),onInput:f(ve).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])])),_:1}),f(le)?(n(),i(T,{key:0},{default:u((()=>[p("div",null,[p("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:j,alt:"Salvar",onClick:r[5]||(r[5]=e=>async function(){const e={apresentante_cpf:fe(ce.apresentante_cpf),apresentante_nome:ce.apresentante_nome,user_id:te.value,cartorio_id:ae.value};if(await ve.value.$validate()){const{data:a,error:t,status:r}=await V(X,{method:"POST",body:e},"$omLGvLxYlw");if("error"===r.value&&500===t.value.statusCode)Y.error("Erro ao cadastrar ordem,erro no sistema.");else{Y.success("Ordem registrada com sucesso!"),se.value=!0,le.value=!1,o("ordem-button").value=le.value;const e=o("user-service");e.value=e.value=JSON.stringify({numero:a.value.numero,apresentante_cpf:a.value.apresentante_cpf,apresentante_nome:a.value.apresentante_nome,token:a.value.token})}}}())})])])),_:1})):h("",!0)])),_:1}),f(se)?(n(),i(R,{key:0,style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:u((()=>[L,m(s,{to:{path:"/ordens-servicos/criar-ato",query:{origem:"criar"}}},{default:u((()=>[N])),_:1}),m(x,{headers:de,items:f(ue),"item-key":"id"},{"item.actions":u((({item:e})=>[m(R,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:u((()=>[p("div",{onClick:r[6]||(r[6]=e=>{ie.value=!0}),title:"Reimprimir"},D),p("div",{class:y({disabled:!e.btn_editar}),onClick:a=>e.btn_editar?t.redirectToUpdate(e.id):null,title:e.btn_editar?"Editar":"Desabilitado"},[p("img",{style:b({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:E,alt:"Editar"},null,4)],10,G),p("div",{disabled:!e.btn_cancelar,onClick:a=>e.btn_cancelar?t.deleteEndereco(e):null,title:"Excluir"},[e.excluido?(n(),k("img",J)):(n(),k("img",M))],8,H)])),_:2},1024)])),_:1},8,["items"]),m(l,{show:f(ie),onClose:r[7]||(r[7]=e=>ie.value=!1)},null,8,["show"])])),_:1})):h("",!0),m(s,{to:"/ordens-servicos"},{default:u((()=>[p("img",{class:"btn-pointer mt-5",src:I,alt:"Sair",onClick:_e})])),_:1})])),_:1})}}};export{z as default};
