import{_ as L}from"./CfuT93-l.js";import{_ as W}from"./D0xK-2Gv.js";import{u as G,E as Q,r as l,D as k,F as J,G as X,o as H,c as Y,b as t,w as r,q as s,O as Z,a as i,x as ee,s as $,J as E,v as oe}from"./B9BlSW93.js";import{u as g}from"./DaDKih56.js";import{_ as te}from"./DCsXQasW.js";import{_ as se}from"./iq-OhJk-.js";import{_ as ae}from"./ToPptOUL.js";import{c as ne,r as re,u as le,V as ue,_ as ie}from"./BHkCgJAD.js";import{V}from"./D8teL0b5.js";import{V as m}from"./CkBJis6K.js";import"./CZbg9llB.js";const ce=i("h1",null,"Reconhecimento por Semelhança",-1),me=["onClick"],de=i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:se,alt:"Remover"},null,-1),_e=[de],pe=i("img",{class:"btn-pointer mt-10 mb-5",src:ae,alt:"Sair",style:{cursor:"pointer"}},null,-1),Ce={__name:"semelhanca",async setup(ve){let _,w;const q=G(),x=Q(),p=ee(),R=`${p.public.managemant}/listarEscrevente`,T=`${p.public.managemant}/pesquisarPessoas`,M=`${p.public.managemant}/atoReconhecimento`,O=`${p.public.managemant}/etiquetaReconhecimento`,v=l(k("user-data").value.cartorio_token),F=l(k("user-service").value.token).value||l(k("user-service").value).value,B=k("auth_token").value,y=l([]),f=l([]),P=l([]),d=l([]),b=l(!1),C=l(""),S=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],n=J({quantidade:1,escrevente:null,nome:null,documento:null}),A={escrevente:{required:ne.withMessage("O campo é obrigatorio",re)}},h=le(A,n),{data:D}=([_,w]=X(()=>g(R,{method:"POST",body:{cartorio_token:v}},"$iEFsIjdWdW")),_=await _,w(),_);P.value=D.value[0].func_json_escreventes;async function U(){try{const{data:a,error:e}=await g(T,{method:"POST",body:{cartorio_token:v.value,documento:n.documento,nome:n.nome}},"$uzKb8LPV3v");a.value.length>0?y.value=a.value:y.value=[]}catch(a){console.error("Erro na requisição",a)}}function j(a){a.length>0?d.value=a.map(e=>{const[c,u,o]=e.split("-");return{nome:c,documento:u==="null"?null:u,pessoa_token:o}}):console.log("Nenhum item selecionado")}function K(a){d.value=d.value.filter(e=>e.pessoa_token!==a.pessoa_token)}async function N(){if(await h.value.$validate()){const a=d.value.map(e=>({pessoa_token:e.pessoa_token}));try{const{data:e,error:c,status:u}=await g(M,{method:"POST",body:{pessoas:[a],cartorio_token:v.value,ordemserv_token:F,quantidade:n.quantidade,usuario_token:B,ato_tipo_token:"yXA3K"}},"$MulQmK1LAp");u.value==="success"&&e.value[0].status==="OK"?z(e.value[0].token):(b.value=!0,C.value=ato_token.value.status_mensagem||c.value.data.details)}catch(e){console.error("Erro na requisição",e)}}}async function z(a){try{const{data:e,error:c,status:u}=await g(O,{method:"POST",body:{ato_token:a,cartorio_token:v.value,escrevente_token:n.escrevente}},"$fMGlIlw995");if(u.value==="success"){const o=window.open("","_blank");o.document.open(),o.document.write(e.value[0].etiqueta),o.document.close()}}catch(e){console.error("Erro na requisição",e)}}const I=()=>{const a=x.query.origem||"criar",e=x.query.id;a==="atualizar"?q.push(`/ordens-servicos/atualizar/${e}`):q.push("/ordens-servicos/criar-registro")};return(a,e)=>{const c=L,u=W;return H(),Y(Z,null,[ce,t(V,{class:"mt-5"},{default:r(()=>[t(m,{cols:"5"},{default:r(()=>[t(ue,{label:"Tabelião/escrevente",modelValue:s(n).escrevente,"onUpdate:modelValue":e[0]||(e[0]=o=>s(n).escrevente=o),items:s(P),"item-title":"nome","item-value":"token",required:"","error-messages":s(h).escrevente.$errors.map(o=>o.$message),onBlur:s(h).escrevente.$touch,onInput:s(h).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1}),t(m,{cols:"2"},{default:r(()=>[t($,{label:"Quantidade",type:"number",modelValue:s(n).quantidade,"onUpdate:modelValue":e[1]||(e[1]=o=>s(n).quantidade=o)},null,8,["modelValue"])]),_:1})]),_:1}),t(V,null,{default:r(()=>[t(m,{cols:"3"},{default:r(()=>[t($,{label:"Documento",modelValue:s(n).documento,"onUpdate:modelValue":e[2]||(e[2]=o=>s(n).documento=o)},null,8,["modelValue"])]),_:1}),t(m,{cols:"4"},{default:r(()=>[t($,{label:"Pessoa",modelValue:s(n).nome,"onUpdate:modelValue":e[3]||(e[3]=o=>s(n).nome=o)},null,8,["modelValue"])]),_:1}),i("div",null,[i("img",{class:"btn-pointer mt-3",src:te,style:{width:"40px",cursor:"pointer"},onClick:U})])]),_:1}),t(V,null,{default:r(()=>[t(m,{class:"mr-10"},{default:r(()=>[t(E,{style:{height:"465px"},headers:S,items:s(y),"show-select":"",modelValue:s(f),"onUpdate:modelValue":e[4]||(e[4]=o=>oe(f)?f.value=o:null),"item-value":o=>`${o.nome}-${o.documento}-${o.token}`,onchange:j(s(f))},null,8,["items","modelValue","item-value","onchange"])]),_:1}),t(m,null,{default:r(()=>[t(E,{headers:S,items:s(d),style:{height:"465px"},"item-key":"id"},{"item.actions":r(({item:o})=>[i("div",{style:{display:"flex","justify-content":"flex-end"},onClick:fe=>K(o),title:"Remover"},_e,8,me)]),_:1},8,["items"])]),_:1})]),_:1}),t(V,null,{default:r(()=>[t(c,{onClick:I},{default:r(()=>[pe]),_:1}),i("div",null,[i("img",{class:"mt-10 mb-5 ml-10",onClick:N,style:{cursor:"pointer"},src:ie})])]),_:1}),t(u,{show:s(b),errorMessage:s(C),onClose:e[5]||(e[5]=o=>b.value=!1)},null,8,["show","errorMessage"])],64)}}};export{Ce as default};
