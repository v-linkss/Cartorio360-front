import{r as c,D as P,F as N,h as O,G as J,o as U,A as j,w as l,b as a,P as E,d as F,q as o,J as M,v as k,a as p,x as W}from"./JRZVNENn.js";import{u as _}from"./CNLSntai.js";import{_ as z}from"./DmmIIbRx.js";import{c as G,r as H,u as L}from"./hk-HKl0r.js";import{a as Y,d as K,V as Q}from"./BI1uuT1Y.js";import{V as X}from"./-p2TpwPa.js";import{V as Z}from"./CBVSBrcK.js";import{V as ee}from"./OEwzB406.js";const te=p("h1",{class:"ml-4"},"Reimpressão de Selos",-1),oe=p("hr",{class:"mb-5"},null,-1),de={__name:"Selos",props:{show:Boolean,ato_token:String},emits:["close"],async setup(g,{emit:$}){let i,V;const u=g,n=c(u.show),f=W(),S=c(P("user-data").value.cartorio_token).value,y=`${f.public.managemant}/listarSelos`,C=`${f.public.managemant}/reimprimirSelo`,T=`${f.public.managemant}/listarEscrevente`,w=c([]),m=c([]),d=N({escrevente:null}),x=$,B={escrevente:{required:G.withMessage("O campo é obrigatorio",H)}},v=L(B,d),I=[{title:"Numero",value:"numero"},{title:"Referencia",value:"referencia"},{value:"actions"}];O(()=>u.show,s=>{n.value=s,s&&A()});const b=()=>{n.value=!1,x("close")},h=c([]),{data:R}=([i,V]=J(()=>_(T,{method:"POST",body:{cartorio_token:S}},"$V2ulT7DYvP")),i=await i,V(),i);h.value=R.value[0].func_json_escreventes;const q=async()=>{if(await v.value.$validate()){const s=m.value.map(r=>({selo_token:r})),e={escrevente_token:d.escrevente,ato_token:u.ato_token,selos:s},{data:t,error:se,status:D}=await _(`${C}`,{method:"POST",body:e},"$45J51uHTfa");if(D.value==="success"){const r=window.open("","_blank");r.document.open(),r.document.write(t.value[0].etiqueta),r.document.close(),b()}}},A=async()=>{const{data:s,error:e}=await _(`${y}`,{method:"POST",body:{ato_token:u.ato_token}},"$rLWIRtrfDz");e.value||(w.value=s.value.selos)};return(s,e)=>(U(),j(Q,{persistent:"",modelValue:o(n),"onUpdate:modelValue":e[2]||(e[2]=t=>k(n)?n.value=t:null),"max-width":"500"},{default:l(()=>[a(Y,null,{default:l(()=>[a(X,null,{default:l(()=>[a(Z,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:l(()=>[te,a(E,{class:"mt-4 mr-4",style:{color:"red"},onClick:b},{default:l(()=>[F("mdi-close")]),_:1})]),_:1}),oe,a(ee,{class:"mb-5",label:"Tabelião/escrivão",modelValue:o(d).escrevente,"onUpdate:modelValue":e[0]||(e[0]=t=>o(d).escrevente=t),items:o(h),"item-title":"nome","item-value":"token",required:"","error-messages":o(v).escrevente.$errors.map(t=>t.$message),onBlur:o(v).escrevente.$touch,onInput:o(v).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"]),a(M,{headers:I,items:o(w),"item-value":"token","show-select":"",modelValue:o(m),"onUpdate:modelValue":e[1]||(e[1]=t=>k(m)?m.value=t:null)},null,8,["items","modelValue"])]),_:1}),a(K,null,{default:l(()=>[p("div",null,[p("img",{src:z,style:{cursor:"pointer"},onClick:q})])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{de as _};
