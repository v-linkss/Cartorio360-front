import{_ as te}from"./BCPjWN5z.js";import{_ as ae}from"./lq439Dzg.js";import{_ as oe}from"./BhPVsofN.js";import{_ as le}from"./BVz1G1IN.js";import{_ as re}from"./CY4LT1hE.js";import{_ as ne}from"./CywETeFI.js";import{_ as se}from"./CZ3_hR-c.js";import{_ as ie,a as ue}from"./DJvq3mCv.js";import{u as de,m as me,r as u,n as f,p as pe,q as ce,s as _e,v as ve,y as fe,w as s,A as ye,o as $,b as l,a as d,V as m,x as o,B as V,D as B,C as J,c as L}from"./D6HxAKSS.js";import{u as k}from"./CGetHDYL.js";import{f as x}from"./B0IxRygJ.js";import{V as be}from"./Dl_JLSFF.js";import{V as g}from"./Dd1jCU6O.js";import{V as i}from"./BzKfZaC2.js";import{V as A}from"./CZ0gqqPr.js";import{V as Ve}from"./BUvLeX5l.js";import"./ByDD0mpF.js";import"./B_CYYAZn.js";import"./88Ie11gh.js";import"./CE7Pe76y.js";import"./C83XBVZz.js";import"./DlWEgRRI.js";import"./tY0saAu0.js";import"./D3tOczwM.js";import"./Bspl52y-.js";import"./C6nHRQTP.js";const ke=["title","onClick"],xe=["onClick","title"],ge=["disabled","onClick"],he={key:0,style:{width:"30px",height:"30px"},src:ie,alt:"Visualizar",title:"Bloqueado"},we={key:1,src:ue,alt:"Cancelamento",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Cancelamento"},Qe={__name:"index",setup(Se){const h=ye(),{$toast:M}=de(),z=`${h.public.managemant}/listarUsuarios`,D=`${h.public.managemant}/listarOrdensServico`,F=`${h.public.managemant}/tipoAtos`,K=me(),w=u(f("auth_token").value)||null,y=u(f("user-data").value.cartorio_token)||null,_=u([]),U=u([]),N=u([]),Y=u(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),S=u(!1),C=u(!1),T=u(null),R=u(null),b=u(null),q=u({}),a=pe({numero:null,data_inicio:O(),data_fim:O(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,livro:null,folha:null,situacao:null,usuario_token:w.value,selo:null,ato_tipo_token:null,apresentante:null}),j=[{title:"Data Abertura",value:"dt_abertura",width:"100px"},{title:"Data Recebimento",value:"data",width:"100px"},{title:"Número",value:"numero",width:"10px"},{title:"Situação",value:"situacao",width:"115px"},{title:"CPF",value:"apresentante_cpf",width:"100px"},{title:"Apresentante",value:"apresentante_nome",width:"228px"},{title:"Usuario",value:"usuario_nome",width:"30px"},{title:"Valor",value:"valor",width:"50px"},{title:"A Receber",value:"valor_a_receber",width:"50px"},{value:"actions"}];function O(){const r=new Date,e=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0");return`${String(r.getDate()).padStart(2,"0")}-${n}-${e}`}function v(r){if(!r)return null;const[e,n,p]=r.split("/");return`${p}-${n}-${e}`}async function G(){const{data:r}=await k(z,{method:"POST",body:{cartorio_token:y.value}},"$pAAptWJdb1");U.value=r.value}async function W(){try{sessionStorage.setItem("pesquisaOS",JSON.stringify(a));const{data:r,error:e}=await k(D,{method:"POST",body:{cartorio_token:y.value,numero:a.numero||null,data_inicio:v(a.data_inicio)||null,data_fim:v(a.data_fim)||null,data_lavratura_inicio:v(a.data_lavratura_inicio)||null,data_lavratura_fim:v(a.data_lavratura_fim)||null,protocolo:a.protocolo||null,livro:a.livro||null,folha:a.folha||null,situacao:a.situacao||null,usuario_token:a.usuario_token,selo:a.selo||null,ato_tipo_token:a.ato_tipo_token,apresentante:a.apresentante||null}},"$IO02J210Z9");r.value.length>0?_.value=r.value.map(n=>({...n,data:n.data?x(n.data,"dd/mm/yyyy"):null,dt_abertura:n.dt_abertura?x(n.dt_abertura,"dd/mm/yyyy"):null})):(_.value=[],M.error("Não existe Ordem de Serviço Registrada!"))}catch(r){console.error("Erro na requisição",r)}}async function Z(){const{data:r,error:e}=await k(F,{method:"POST",body:{cartorio_token:y.value,usuario_token:w.value}},"$YgUhKRJlsV");N.value=r.value}const E=async()=>{try{const r=O(),e=sessionStorage.getItem("pesquisaOS"),n=JSON.parse(e),{data:p,error:P}=await k(D,{method:"POST",body:{cartorio_token:y.value,usuario_token:n.usuario_token||w.value,data_fim:v(n==null?void 0:n.data_fim)||r,data_inicio:v(n==null?void 0:n.data_inicio)||r}},"$xKnfARCL4G");p.value.length>0?_.value=p.value.map(c=>({...c,data:x(c.data,"dd/mm/yyyy"),dt_abertura:x(c.dt_abertura,"dd/mm/yyyy")})):_.value=[]}catch(r){console.error("Erro ao buscar serviços",r)}};function H(r){b.value=r.numero,R.value=r.token,C.value=!0}function Q(r){const e=f("user-service"),n=_.value.find(p=>p.id===r);e.value=e.value=JSON.stringify({id:n.id,token:n.token}),K.push({path:`/os/atualizar/${r}`})}function X(r,e){b.value=r,q.value={token:e.token,numero:e.numero,valor:e.valor,valor_pago:e.valor_pago},S.value=!0}const ee=()=>{const r=f("user-service"),e=f("ordem-button");r.value=null,T.value=!0,e.value=T.value};return ce(()=>{_e(async()=>{const r=sessionStorage.getItem("pesquisaOS");if(r){const e=JSON.parse(r);Object.assign(a,e)}await E()})}),G(),Z(),(r,e)=>{const n=te,p=ae,P=oe,c=ve("mask");return $(),fe(be,{class:"mt-5",style:{width:"100%"}},{default:s(()=>[l(g,{class:"mb-5"},{default:s(()=>[e[16]||(e[16]=d("h1",null,"Ordens de Serviço",-1)),l(n,{to:"/os/criar-registro"},{default:s(()=>[d("img",{style:{width:"60px",height:"60px",cursor:"pointer","margin-left":"70px"},src:le,alt:"novo",onClick:ee})]),_:1})]),_:1}),l(g,{style:{"margin-bottom":"-35px"}},{default:s(()=>[l(i,null,{default:s(()=>[l(m,{modelValue:o(a).numero,"onUpdate:modelValue":e[0]||(e[0]=t=>o(a).numero=t),label:"Número"},null,8,["modelValue"])]),_:1}),l(i,null,{default:s(()=>[V(l(m,{modelValue:o(a).data_inicio,"onUpdate:modelValue":e[1]||(e[1]=t=>o(a).data_inicio=t),label:"Abertura de",placeholder:"dd/mm/yyyy",style:{width:"150px"}},null,8,["modelValue"]),[[c,"##/##/####"]])]),_:1}),l(i,null,{default:s(()=>[V(l(m,{modelValue:o(a).data_fim,"onUpdate:modelValue":e[2]||(e[2]=t=>o(a).data_fim=t),label:"Abertura até",placeholder:"dd/mm/yyyy",style:{width:"150px"}},null,8,["modelValue"]),[[c,"##/##/####"]])]),_:1}),l(i,null,{default:s(()=>[V(l(m,{modelValue:o(a).data_lavratura_inicio,"onUpdate:modelValue":e[3]||(e[3]=t=>o(a).data_lavratura_inicio=t),label:"Lavratura de",placeholder:"dd/mm/yyyy",style:{width:"150px"}},null,8,["modelValue"]),[[c,"##/##/####"]])]),_:1}),l(i,null,{default:s(()=>[V(l(m,{modelValue:o(a).data_lavratura_fim,"onUpdate:modelValue":e[4]||(e[4]=t=>o(a).data_lavratura_fim=t),label:"Lavratura até",placeholder:"dd/mm/yyyy",style:{width:"150px"}},null,8,["modelValue"]),[[c,"##/##/####"]])]),_:1}),l(i,null,{default:s(()=>[l(m,{modelValue:o(a).protocolo,"onUpdate:modelValue":e[5]||(e[5]=t=>o(a).protocolo=t),label:"Protocolo"},null,8,["modelValue"])]),_:1}),l(i,{md:"1"},{default:s(()=>[l(m,{modelValue:o(a).livro,"onUpdate:modelValue":e[6]||(e[6]=t=>o(a).livro=t),label:"Livro"},null,8,["modelValue"])]),_:1}),l(i,{md:"1"},{default:s(()=>[l(m,{modelValue:o(a).folha,"onUpdate:modelValue":e[7]||(e[7]=t=>o(a).folha=t),label:"Folha"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,null,{default:s(()=>[l(i,{md:"3"},{default:s(()=>[l(A,{modelValue:o(a).situacao,"onUpdate:modelValue":e[8]||(e[8]=t=>o(a).situacao=t),items:o(Y),label:"Situação"},null,8,["modelValue","items"])]),_:1}),l(i,{md:"2"},{default:s(()=>[l(A,{items:o(U),modelValue:o(a).usuario_token,"onUpdate:modelValue":e[9]||(e[9]=t=>o(a).usuario_token=t),"item-title":"user_nome","item-value":"user_token",label:"Usuario"},null,8,["items","modelValue"])]),_:1}),l(i,{md:"1"},{default:s(()=>[l(m,{modelValue:o(a).selo,"onUpdate:modelValue":e[10]||(e[10]=t=>o(a).selo=t),label:"Selo"},null,8,["modelValue"])]),_:1}),l(i,{md:"3"},{default:s(()=>[l(A,{modelValue:o(a).ato_tipo_token,"onUpdate:modelValue":e[11]||(e[11]=t=>o(a).ato_tipo_token=t),items:o(N),"item-title":"descricao","item-value":"token",label:"Serviço"},null,8,["modelValue","items"])]),_:1}),l(i,{md:"2"},{default:s(()=>[l(m,{modelValue:o(a).apresentante,"onUpdate:modelValue":e[12]||(e[12]=t=>o(a).apresentante=t),label:"Apresentante"},null,8,["modelValue"])]),_:1}),l(i,null,{default:s(()=>[d("div",null,[d("img",{onClick:W,style:{width:"40px",height:"40px",cursor:"pointer"},src:re,alt:"Pesquisar"})])]),_:1})]),_:1}),e[17]||(e[17]=d("hr",{class:"mt-5 mb-5"},null,-1)),l(Ve,{headers:j,style:{"min-width":"1230px","font-size":"12px"},items:o(_),"item-key":"id"},{"item.actions":s(({item:t})=>[l(g,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:s(()=>[d("div",{class:J({disabled:!t.btn_receber}),title:t.btn_receber?"Receber":"Bloqueado",onClick:I=>t.btn_receber?X(t.numero,t):null},[d("img",{style:B({cursor:t.btn_receber?"pointer":"default",width:"30px",height:"30px"}),src:ne,alt:"Receber"},null,4)],10,ke),d("div",{class:J({disabled:!t.btn_editar}),onClick:I=>t.btn_editar?Q(t.id):null,title:t.btn_editar?"Editar":"Bloqueado"},[d("img",{style:B({cursor:t.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:se,alt:"Editar"},null,4)],10,xe),d("div",{disabled:!t.btn_cancelar,onClick:I=>t.btn_cancelar?H(t):null,title:"Cancelamento"},[t.excluido?($(),L("img",he)):($(),L("img",we))],8,ge)]),_:2},1024)]),_:1},8,["items"]),l(p,{show:o(S),numero_os:o(b),ordem:o(q),onClose:e[13]||(e[13]=t=>S.value=!1),onRefreshValue:e[14]||(e[14]=t=>E())},null,8,["show","numero_os","ordem"]),l(P,{show:o(C),numero_os:o(b),ordemserv_token:o(R),onClose:e[15]||(e[15]=t=>C.value=!1)},null,8,["show","numero_os","ordemserv_token"])]),_:1})}}};export{Qe as default};
