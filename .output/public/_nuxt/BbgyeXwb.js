import{_ as ae}from"./Dzw-yQhD.js";import{_ as ne}from"./D68RzA0-.js";import{_ as re}from"./BuOdRB94.js";import{_ as le}from"./Ck87YZap.js";import{_ as E}from"./Q6c3O_pS.js";import{_ as ie,b as ue}from"./BP1uhy__.js";import{C as me,H as ce,u as de,r as l,m as k,D as pe,I as ve,c as fe,b as t,w as n,v as s,F as _e,s as ke,o as ge,V as C,a as i,A as R,d as O}from"./CnZnip3R.js";import{V as g,u as V}from"./RdZ81Mlz.js";import{V as u}from"./DR6f3S7u.js";import{V as Ve}from"./B5RqK_ue.js";import{V as z}from"./yGIfVQdX.js";import"./C1hIzA3b.js";import"./BB9a9WaY.js";import"./Bvpo_k9Q.js";import"./BoWrVCko.js";import"./CB5CdGIZ.js";import"./BuuZcKr8.js";import"./ButH2dF6.js";import"./ChPRMqFO.js";import"./ChGlvUuE.js";import"./B9Kv3FaV.js";import"./Bet7kl9r.js";import"./CdP3NN9a.js";const ye=["onClick"],he=["onClick"],Le={__name:"semelhanca",props:{ato_token:{type:String,required:!0}},emits:["ato-created"],async setup(I,{emit:A}){let p,q;const j=I,B=A,$=me(),P=ce(),v=ke(),{$toast:D}=de(),N=`${v.public.managemant}/listarEscrevente`,U=`${v.public.managemant}/pesquisarPessoas`,K=`${v.public.managemant}/atoReconhecimento`,L=`${v.public.managemant}/etiquetaReconhecimento`,f=l(k("user-data").value.cartorio_token),W=l(k("user-service").value.token).value||l(k("user-service").value).value,Q=k("auth_token").value,y=l([]),F=l([]),m=l([]),h=l(!1),b=l(!1),w=l(!1),x=l(null),M=l(""),S=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],r=pe({quantidade:1,escrevente:null,nome:null,documento:null}),{data:G}=([p,q]=ve(()=>V(N,{method:"POST",body:{cartorio_token:f}},"$iEFsIjdWdW")),p=await p,q(),p);F.value=G.value[0].func_json_escreventes;async function H(){try{const{data:o,error:e}=await V(U,{method:"POST",body:{cartorio_token:f.value,documento:r.documento,nome:r.nome}},"$uzKb8LPV3v");o.value.length>0?(y.value=o.value,B("ato-created")):y.value=[]}catch(o){console.error("Erro na requisição",o)}}const J=()=>{b.value=!0};function X(o){m.value.push(o)}const Y=o=>{x.value=o,w.value=!0};function Z(o){m.value=m.value.filter(e=>e.token!==o.token)}async function ee(){if(!r.escrevente){D.error("Por favor selecione um Escrevente");return}const o=m.value.map(e=>({pessoa_token:e.token}));try{const{data:e,error:_,status:c}=await V(K,{method:"POST",body:{pessoas:o,cartorio_token:f.value,ordemserv_token:W,quantidade:r.quantidade,usuario_token:Q,ato_tipo_token:j.ato_token}},"$MulQmK1LAp");c.value==="success"&&e.value[0].status==="OK"?te(e.value[0].token):(h.value=!0,M.value=ato_token.value.status_mensagem||_.value.data.details)}catch(e){console.error("Erro na requisição",e)}}async function te(o){try{const{data:e,error:_,status:c}=await V(L,{method:"POST",body:{ato_token:o,cartorio_token:f.value,escrevente_token:r.escrevente}},"$fMGlIlw995");if(c.value==="success"){T();const d=window.open("","_blank");d.document.open(),d.document.write(e.value[0].etiqueta),d.document.close()}}catch(e){console.error("Erro na requisição",e)}}const T=()=>{const o=P.query.origem||"criar",e=P.query.id;o==="atualizar"?$.push(`/os/atualizar/${e}`):$.push("/os/criar-registro")};return(o,e)=>{const _=ae,c=ne,d=re,oe=le;return ge(),fe(_e,null,[t(g,{class:"mt-5"},{default:n(()=>[t(u,{cols:"5"},{default:n(()=>[t(Ve,{label:"Tabelião/escrevente",modelValue:s(r).escrevente,"onUpdate:modelValue":e[0]||(e[0]=a=>s(r).escrevente=a),items:s(F),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),t(u,{cols:"2"},{default:n(()=>[t(C,{label:"Quantidade",type:"number",modelValue:s(r).quantidade,"onUpdate:modelValue":e[1]||(e[1]=a=>s(r).quantidade=a)},null,8,["modelValue"])]),_:1})]),_:1}),t(g,null,{default:n(()=>[t(u,{cols:"3"},{default:n(()=>[t(C,{label:"Documento",modelValue:s(r).documento,"onUpdate:modelValue":e[2]||(e[2]=a=>s(r).documento=a)},null,8,["modelValue"])]),_:1}),t(u,{cols:"4"},{default:n(()=>[t(C,{label:"Pessoa",modelValue:s(r).nome,"onUpdate:modelValue":e[3]||(e[3]=a=>s(r).nome=a)},null,8,["modelValue"])]),_:1}),i("div",null,[i("img",{class:"btn-pointer mt-3",src:E,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:H})]),i("div",null,[i("img",{class:"btn-pointer mt-3 ml-2",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:J})])]),_:1}),t(g,null,{default:n(()=>[t(u,{class:"mr-10"},{default:n(()=>[t(z,{style:{height:"465px"},headers:S,items:s(y)},{"item.actions":n(({item:a})=>[i("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:se=>Y(a),title:"Visualizar Ficha"},e[8]||(e[8]=[i("img",{style:{width:"30px",height:"30px"},src:E,alt:"Visualizar"},null,-1)]),8,ye)]),_:1},8,["items"])]),_:1}),t(u,null,{default:n(()=>[t(z,{headers:S,items:s(m),style:{height:"465px"},"item-key":"id"},{"item.actions":n(({item:a})=>[i("div",{style:{display:"flex","justify-content":"flex-end"},onClick:se=>Z(a),title:"Remover"},e[9]||(e[9]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ue,alt:"Remover"},null,-1)]),8,he)]),_:1},8,["items"])]),_:1})]),_:1}),t(_,{show:s(b),onClose:e[4]||(e[4]=a=>b.value=!1)},null,8,["show"]),t(c,{show:s(w),item:s(x),onConfirmar:e[5]||(e[5]=a=>X(s(x))),onClose:e[6]||(e[6]=a=>w.value=!1)},null,8,["show","item"]),t(g,null,{default:n(()=>[t(d,{onClick:T},{default:n(()=>[t(R,{size:"large",color:"red"},{default:n(()=>e[10]||(e[10]=[O("Voltar")])),_:1})]),_:1}),t(R,{class:"ml-5",onClick:ee,size:"large",color:"green"},{default:n(()=>e[11]||(e[11]=[O("Salvar")])),_:1})]),_:1}),t(oe,{show:s(h),errorMessage:s(M),onClose:e[7]||(e[7]=a=>h.value=!1)},null,8,["show","errorMessage"])],64)}}};export{Le as default};
