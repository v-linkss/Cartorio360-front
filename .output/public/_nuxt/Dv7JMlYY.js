import{_ as ce}from"./Bo9pNvqg.js";import{u as re,n as le,q as Y,r as n,s as me,o as B,v as ue,w as t,b as e,x as a,V as ie,y as L,d as q,z as Z,A as J,B as Q,a as d,c as G,C as ae,t as ne,D as Re,E as je,F as Fe,G as Ne,H as Pe,I as $e,h as Le,J as Ve}from"./pH1cEkPx.js";import{u as x}from"./eWX9kTq8.js";import{V as O}from"./BLTi9DZL.js";import{V as D}from"./CteO4WHa.js";import{V as se}from"./DQyD-MfE.js";import{V as pe}from"./CQxgEUuj.js";import{_ as Ge,V as He,a as te,b as Je,c as oe}from"./BDZt7hi8.js";import{_ as We,a as Ke,b as Xe,T as Qe,W as Ye,S as Ze,r as Ae,D as Ee,c as Te,d as et,e as tt}from"./D_RHaJbL.js";import{_ as ve}from"./9cWuJMPg.js";import{_ as de,V as ge,a as ye,b as he,c as ze}from"./dxgrBTyy.js";import{V as xe,a as _e,b as ot,c as at,d as st}from"./CJT3vion.js";import{V as rt}from"./DjRMAYTd.js";import{_ as lt}from"./B0w3qwmY.js";import{V as we}from"./cjM-qLlW.js";import{_ as Ce}from"./DfjuBLsA.js";import{c as nt,r as it,u as ct}from"./CFUR3JHY.js";import"./BXGXbKpp.js";import"./BjjqCE1y.js";import"./B41zg6Ji.js";import"./CtcKWZ5I.js";const ut={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(K){const r=K,{$toast:f}=re(),p=Z(),y=le(),i=Y(),V=`${p.public.managemant}/updateAtos`,S=n(r.item_situacoes),E=me({dt_abertura:r.item_dados[0].dt_abertura||null,status:r.item_dados[0].status||null,mne:r.item_dados[0].mne||null});async function j(){const{data:h,error:v,status:T}=await x(`${V}/${i.query.ato_id}`,{method:"PUT",body:{status:E.status,mne:E.mne,dt_abertura:E.dt_abertura}},"$EIT5jtTUdX");T.value==="success"&&f.success("Ato Atualizado com sucesso")}const U=()=>{const h=i.query.origem||"criar",v=i.query.id;h==="atualizar"?y.push(`/os/atualizar/${v}`):y.push("/os/criar-registro")};return(h,v)=>{const T=ce;return B(),ue(pe,null,{default:t(()=>[e(O,{class:"mt-5"},{default:t(()=>[e(D,{cols:"3"},{default:t(()=>[e(se,{label:"Situação",modelValue:a(E).status,"onUpdate:modelValue":v[0]||(v[0]=u=>a(E).status=u),items:a(S),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(D,{cols:"5"},{default:t(()=>[e(ie,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:a(E).mne,"onUpdate:modelValue":v[1]||(v[1]=u=>a(E).mne=u)},null,8,["modelValue"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(D,{cols:"2"},{default:t(()=>[e(ie,{modelValue:a(E).dt_abertura,"onUpdate:modelValue":v[2]||(v[2]=u=>a(E).dt_abertura=u),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(O,{class:"mb-3"},{default:t(()=>[e(T,{onClick:U},{default:t(()=>[e(L,{size:"large",color:"red"},{default:t(()=>[q("Voltar")]),_:1})]),_:1}),e(L,{class:"ml-10",onClick:j,size:"large",color:"green"},{default:t(()=>[q("Atualizar")]),_:1})]),_:1})]),_:1})}}},dt=["onClick"],mt=d("img",{style:{width:"30px",height:"30px"},src:ve,alt:"Visualizar"},null,-1),pt=[mt],_t=["onClick"],ft=d("img",{style:{width:"30px",height:"30px"},src:ze,alt:"Visualizar"},null,-1),vt=[ft],gt=["onClick"],yt={key:0,style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar",title:"Reativar"},ht={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},bt=["onClick"],$t=d("img",{style:{width:"30px",height:"30px"},src:Xe,alt:"Visualizar"},null,-1),xt=[$t],kt={__name:"Partes",async setup(K){let r,f;const p=le(),y=Y(),i=Z(),{$toast:V}=re(),S=`${i.public.managemant}/pesquisarPessoas`,E=`${i.public.managemant}/listarPapeis`,j=`${i.public.managemant}/getLinkTipo`,U=`${i.public.managemant}/createAtosPessoa`,h=`${i.public.managemant}/updateAtosPessoa`,v=`${i.public.managemant}/getAtosPessoaById`,T=n(J("user-data").value.cartorio_token),u=n([]),w=n([]),R=n([]),g=n(!1),F=n(!1),I=n(!1),k=n(!1),m=n(null),z=n(null),l=n(null),_=n(null),b=n(null),o=n("xkyaA"),c=n(null),A=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],s=me({papeis:null,nome:null,pessoa:null,documento:null}),{data:P}=([r,f]=Q(()=>x(E,{method:"POST",body:{tipo_ato_token:"xkyaA"}},"$acoiTIUp00")),r=await r,f(),r);R.value=P.value;const N=async()=>{const{data:C}=await x(`${v}/${y.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),W=(fe=>fe.map(X=>({...X,pessoa:{...X.pessoa,documento:X.pessoa.doc_identificacao},papel:{...X.partes_tipos}})))(C.value);w.value=W};N();async function H(){try{const{data:C,error:$}=await x(S,{method:"POST",body:{cartorio_token:T.value,documento:s.documento,nome:s.nome}},"$pr30MyPXfY");C.value.length>0?(u.value=C.value,s.pessoa=u.value[0]):u.value=[]}catch(C){console.error("Erro na requisição",C)}}const ke=()=>{F.value=!0},Oe=async()=>{await N()},qe=async()=>{await N()},De=async()=>{const C={pessoa:s.pessoa,papel:R.value.find(ee=>ee.id===s.papeis),representante:{nome:null}},$=await x(`${v}/${y.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const ee of $.data.value)if(ee.pessoa_id===s.pessoa.id&&ee.ato_id===Number(y.query.ato_id)&&ee.tipo_parte_id===s.papeis){V.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:W,error:fe,status:X}=await x(U,{method:"POST",body:{ato_id:y.query.ato_id,pessoa_id:s.pessoa.id,tipo_parte_id:s.papeis,user_id:J("user-data").value.usuario_id}},"$18isAgOJxG");X.value==="success"&&(C.id=W.value.id,V.success("Pessoa Registrada com Sucesso!"),w.value.push(C))},Me=async C=>{I.value=!0,c.value=null;const{data:$}=await x(`${j}`,{method:"POST",body:{id:C.pessoa.id,tipo:"ficha"}},"$hmDzSF3F61");$.value&&$.value.link?c.value=`data:image/jpeg;base64,${$.value.link}`:c.value=null},Se=C=>{const $=w.value.filter(W=>W.pessoa.id!==C.pessoa.id).map(W=>({id:W.pessoa.id,nome:W.pessoa.nome}));l.value=C.id,m.value=$,g.value=!0,z.value=C.pessoa.nome,b.value=C.pessoa.id},Ue=C=>{k.value=!0,_.value=C.id,z.value=C.pessoa.nome};async function Be(C){C.excluido=!C.excluido;try{await x(`${h}/${C.id}`,{method:"PUT",body:JSON.stringify({excluido:C.excluido})},"$l09I6nLRfk")}catch($){console.error("Erro ao excluir pessoa:",$)}}const Ie=()=>{const C=y.query.origem||"criar",$=y.query.id;C==="atualizar"?p.push(`/os/atualizar/${$}`):p.push("/os/criar-registro")};return(C,$)=>{const W=Ge,fe=We,X=Ke,ee=ce;return B(),ue(pe,null,{default:t(()=>[e(O,{class:"mt-5"},{default:t(()=>[e(D,{cols:"3"},{default:t(()=>[e(ie,{label:"Documento",modelValue:a(s).documento,"onUpdate:modelValue":$[0]||($[0]=M=>a(s).documento=M)},null,8,["modelValue"])]),_:1}),e(D,{cols:"4"},{default:t(()=>[e(ie,{label:"Pessoa",modelValue:a(s).nome,"onUpdate:modelValue":$[1]||($[1]=M=>a(s).nome=M)},null,8,["modelValue"])]),_:1}),d("div",null,[d("img",{class:"mt-1",src:ve,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:H})]),d("div",null,[d("img",{class:"mt-1 ml-2",src:de,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ke})])]),_:1}),e(O,null,{default:t(()=>[e(D,{cols:"4"},{default:t(()=>[e(se,{label:"Selecione a Pessoa",modelValue:a(s).pessoa,"onUpdate:modelValue":$[2]||($[2]=M=>a(s).pessoa=M),items:a(u),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(D,{cols:"3"},{default:t(()=>[e(se,{label:"Papel",modelValue:a(s).papeis,"onUpdate:modelValue":$[3]||($[3]=M=>a(s).papeis=M),items:a(R),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),d("div",null,[d("img",{class:"mt-1",src:de,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:De})])]),_:1}),e(O,null,{default:t(()=>[e(D,null,{default:t(()=>[e(ge,{style:{height:"465px"},headers:A,items:a(w)},{"item.actions":t(({item:M})=>[e(O,null,{default:t(()=>[d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:be=>Me(M),title:"Visualizar Ficha"},pt,8,dt),d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:be=>Ue(M),class:"mr-2",title:"Alterar Papel"},vt,8,_t),d("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:be=>Be(M),title:"Deletar Pessoa"},[M.excluido?(B(),G("img",yt)):(B(),G("img",ht))],8,gt),d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:be=>Se(M),title:"Selecionar Representante"},xt,8,bt)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(W,{show:a(F),onClose:$[4]||($[4]=M=>F.value=!1)},null,8,["show"]),e(fe,{representante_nome:a(z),representantes:a(m),ato_id:a(l),show:a(g),onClose:$[5]||($[5]=M=>g.value=!1),onUpdateRepresentante:qe},null,8,["representante_nome","representantes","ato_id","show"]),e(X,{representante_nome:a(z),ato_token:a(o),ato_id:a(_),show:a(k),onClose:$[6]||($[6]=M=>k.value=!1),onUpdatePapel:Oe},null,8,["representante_nome","ato_token","ato_id","show"]),e(xe,{modelValue:a(I),"onUpdate:modelValue":$[8]||($[8]=M=>ae(I)?I.value=M:null),width:"600"},{default:t(()=>[e(_e,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(rt,{src:a(c)},null,8,["src"]),e(L,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:$[7]||($[7]=M=>I.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(O,null,{default:t(()=>[e(ee,{onClick:Ie},{default:t(()=>[e(L,{size:"large",color:"red"},{default:t(()=>[q("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},Vt=d("label",null,"Valor",-1),wt={style:{width:"800px","font-weight":"500"}},Ct=["onClick"],Pt=d("img",{style:{width:"30px",height:"30px"},src:ve,alt:"Visualizar"},null,-1),At=[Pt],Et=["onClick"],Tt=d("img",{style:{width:"30px",height:"30px"},src:ze,alt:"Editar"},null,-1),zt=[Tt],Ot=["onClick"],qt={key:0,style:{width:"30px",height:"30px"},src:ye,alt:"Reativar",title:"Reativar"},Dt={key:1,src:he,alt:"Excluir",style:{width:"30px",height:"30px"},title:"Excluir"},Mt=d("label",null,"Valor",-1),St={__name:"Bens",async setup(K){let r,f;const p=le(),y=Y(),i=Z(),{$toast:V}=re(),S=`${i.public.managemant}/atos_bens`,E=`${i.public.managemant}/atos_bens`,j=`${i.public.managemant}/atos_bens`,U=`${i.public.managemant}/listarTipoBens`,h=n(J("user-data").value.cartorio_token),v=n(J("user-data").value.usuario_id).value,T=n([]),u=n([]),w=n(!1),R=[{title:"Descrição",align:"start",key:"descricao"},{title:"Valor",align:"end",key:"valor_mercado"},{align:"end",value:"actions"}],g=me({vlr_alienacao:null,descricao:null,tipo_id:null,tiposBens:[]}),F=async()=>{if(!g.vlr_alienacao&&!g.descricao){V.error("Os campos Descrição e Valor são Obrigatorios!");return}const{data:b,status:o}=await x(`${S}`,{method:"POST",body:{descricao:g.descricao,tipo_id:g.tipo_id,valor_mercado:g.vlr_alienacao,user_id:v,ato_id:Number.parseInt(y.query.ato_id),token:y.query.ato_token_edit}},"$aGIwRtPn6M");o.value==="success"&&(V.success("Bem registrado com sucesso!"),T.value.push(b.value),Object.assign(g,{vlr_alienacao:null,descricao:null,tipo_id:null}))},I=async b=>{const{status:o}=await x(`${E}/${b}`,{method:"PUT",body:{descricao:u.value.descricao,tipo_id:u.value.tipo_id,valor_mercado:u.value.valor_mercado}},"$4hUMyAQlzU");o.value==="success"&&(V.success("Bem Atualizado com sucesso!"),w.value=!1)},k=b=>{const o=T.value.find(c=>c.id===b);o&&(u.value=o,w.value=!0)},{data:m}=([r,f]=Q(()=>x(`${U}`,{method:"POST",body:{cartorio_token:h.value,imoveis:!1}},"$da802I2H8c")),r=await r,f(),r);g.tiposBens=m.value;const{data:z}=([r,f]=Q(()=>x(`${j}/${y.query.ato_id}`,{method:"GET"},"$iXfJJrO35d")),r=await r,f(),r);T.value=z.value;async function l(b){b.excluido=!b.excluido;try{await x(`${E}/${b.id}`,{method:"PUT",body:JSON.stringify({excluido:b.excluido})},"$PGKHfsa7Pl")}catch(o){console.error("Erro ao excluir pessoa:",o)}}const _=()=>{const b=y.query.origem||"criar",o=y.query.id;b==="atualizar"?p.push(`/os/atualizar/${o}`):p.push("/os/criar-registro")};return(b,o)=>{const c=lt,A=ce;return B(),ue(pe,null,{default:t(()=>[e(D,{class:"mt-5",cols:"12"},{default:t(()=>[e(we,{label:"Descrição",modelValue:a(g).descricao,"onUpdate:modelValue":o[0]||(o[0]=s=>a(g).descricao=s)},null,8,["modelValue"])]),_:1}),e(O,{class:"ml-1 mb-3"},{default:t(()=>[e(D,{class:"mt-6",cols:"8"},{default:t(()=>[e(se,{label:"Selecione o Tipo",items:a(g).tiposBens,modelValue:a(g).tipo_id,"onUpdate:modelValue":o[1]||(o[1]=s=>a(g).tipo_id=s),"item-title":"descricao","item-value":"id"},null,8,["items","modelValue"])]),_:1}),e(D,{class:"ml-5",cols:"3"},{default:t(()=>[Vt,e(c,{modelValue:a(g).vlr_alienacao,"onUpdate:modelValue":o[2]||(o[2]=s=>a(g).vlr_alienacao=s)},null,8,["modelValue"])]),_:1}),d("div",null,[d("img",{class:"mt-7 ml-4",src:de,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:F})])]),_:1}),e(O,null,{default:t(()=>[e(D,null,{default:t(()=>[e(ge,{style:{height:"465px"},headers:R,items:a(T)},{"item.descricao":t(({item:s})=>[d("h3",wt,ne(s.descricao),1)]),"item.actions":t(({item:s})=>[e(O,{style:{"margin-top":"-8px"},justify:"end"},{default:t(()=>[d("div",{style:{cursor:"pointer"},class:"mr-2",onClick:P=>b.redirectToFicha(s),title:"Visualizar Ficha"},At,8,Ct),d("div",{style:{cursor:"pointer"},class:"mr-2",onClick:P=>k(s.id),title:"Alterar Papel"},zt,8,Et),d("div",{style:{cursor:"pointer"},class:"mr-2",onClick:P=>l(s),title:"Deletar Pessoa"},[s.excluido?(B(),G("img",qt)):(B(),G("img",Dt))],8,Ot)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(xe,{modelValue:a(w),"onUpdate:modelValue":o[8]||(o[8]=s=>ae(w)?w.value=s:null),"max-width":"600px"},{default:t(()=>[e(_e,null,{default:t(()=>[e(ot,{style:{color:"green"}},{default:t(()=>[q("Atualizar Bem")]),_:1}),e(at,null,{default:t(()=>[e(D,{class:"mt-1",cols:"12"},{default:t(()=>[e(we,{label:"Descrição",modelValue:a(u).descricao,"onUpdate:modelValue":o[3]||(o[3]=s=>a(u).descricao=s)},null,8,["modelValue"])]),_:1}),e(O,null,{default:t(()=>[e(D,{class:"mt-6 ml-3",cols:"8"},{default:t(()=>[e(se,{label:"Selecione o Tipo",items:a(g).tiposBens,modelValue:a(u).tipo_id,"onUpdate:modelValue":o[4]||(o[4]=s=>a(u).tipo_id=s),"item-title":"descricao","item-value":"id"},null,8,["items","modelValue"])]),_:1}),e(D,{class:"ml-5",cols:"3"},{default:t(()=>[Mt,e(c,{modelValue:a(u).valor_mercado,"onUpdate:modelValue":o[5]||(o[5]=s=>a(u).valor_mercado=s)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(st,null,{default:t(()=>[e(Re),e(L,{color:"green",text:"",onClick:o[6]||(o[6]=s=>w.value=!1)},{default:t(()=>[q("Cancelar")]),_:1}),e(L,{color:"green",text:"",onClick:o[7]||(o[7]=s=>I(a(u).id))},{default:t(()=>[q("Salvar")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(O,null,{default:t(()=>[e(A,{onClick:_},{default:t(()=>[e(L,{size:"large",color:"red"},{default:t(()=>[q("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},Ut={key:0,class:"loading-overlay"},Bt="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",It={__name:"Minuta",emits:["page","doc"],setup(K,{emit:r}){je("DocumentEditorContainer",[Qe,Ye,Ze]);const f=Z(),{$toast:p}=re(),y=le(),i=Y(),V=r;Ae(`${f.public.docEditor}`);const S=`${f.public.managemant}/download`,E=`${f.public.managemant}/atos/files`,j=`${f.public.managemant}/subitituirModelo`,U=`${f.public.managemant}/upload`,h=n(null),v=n(!1),T=n("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),u=n(!1),w=async o=>{try{const c=await fetch(o);if(!c.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await c.blob()}catch(c){return console.error(c),p.error("Erro ao carregar o documento inicial."),null}},R=async()=>{try{const{data:o}=await x(`${E}/${i.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return o.value.link_ato}catch(o){console.error("Erro ao carregar o documento:",o),p.error(o)}},g=async()=>{u.value=!0;try{const o=await R(),{data:c,status:A}=await x(S,{method:"POST",body:{bucket:"qvgjz",path:o}},"$dvNFfvmIJC"),s=c.value,P=await w(s);if(P){const N=new FileReader;N.onload=()=>{const H=N.result;h.value.ej2Instances.documentEditor.open(H),V("doc",H)},N.readAsText(P)}}catch{p.error("Erro ao carregar o documento.")}finally{u.value=!1}},F=async()=>{const o=h.value.ej2Instances.documentEditor;console.log(o);const c=await o.saveAsBlob("Sfdt"),A=new FileReader;A.onload=()=>{const s=A.result,N=h.value.ej2Instances.documentEditor.pageCount;V("page",N),V("doc",s)},A.readAsText(c)},I=async()=>{u.value=!0;try{const c=await h.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),A=new FormData;A.append("file",c,"anexo.sfdt"),A.append("cartorio_token",J("user-data").value.cartorio_token),A.append("token",i.query.ato_token_edit),A.append("tipo","ato_minuta");const{data:s,status:P}=await x(U,{method:"POST",body:A},"$xv11VtUdMy");if(P.value==="success"){p.success("Documento enviado!");const H=h.value.ej2Instances.documentEditor.pageCount;F(),V("page",H)}else p.error("Erro ao enviar documento para o sistema.")}catch(o){p.error("Erro ao salvar documento."),console.error(o)}finally{u.value=!1}},k=()=>{v.value=!1,m()},m=async()=>{_(!0);try{await z(),_(!0);const{data:o,status:c}=await x(j,{method:"POST",body:{ato_token:i.query.ato_token_edit}},"$zyzWHTXTBW");o.value&&l(o.value)}catch(o){console.error("Erro ao gerar a minuta:",o),p.error("Ocorreu um erro ao gerar a minuta.")}finally{_(!1)}},z=async()=>{try{const{data:o}=await x(S,{method:"POST",body:{bucket:"qvgjz",path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),c=await w(o.value);if(c){const A=new FileReader;A.onload=()=>{const s=A.result;h.value.ej2Instances.documentEditor.open(s),V("doc",s)},A.readAsText(c)}}catch(o){console.error("Erro ao carregar o modelo de minuta:",o),p.error("Falha ao carregar o modelo de minuta.")}},l=o=>{const c=h.value.ej2Instances.documentEditor,A=s=>{for(const[P,N]of Object.entries(s))if(/^<<.+>>$/.test(P))try{c.search.findAll(P),c.search.searchResults.length>0&&c.search.searchResults.replaceAll(N)}catch(H){console.error(`Erro ao substituir o marcador ${P}:`,H)}else if(P==="partes"&&Array.isArray(N)&&N.length>0)for(const H of N)typeof H=="object"&&A(H)};A(o)},_=o=>{u.value=o},b=()=>{const o=i.query.origem||"criar",c=i.query.id;o==="atualizar"?y.push(`/os/atualizar/${c}`):y.push("/os/criar-registro")};return Fe(async()=>{await g(),F()}),(o,c)=>{const A=ce,s=Te;return B(),G($e,null,[e(a(Ee),{height:"900px",ref_key:"documentEditorContainer",ref:h,serviceUrl:Bt,enableToolbar:!0,enableWordExport:!0},null,512),a(u)?(B(),G("div",Ut,[e(Ne,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):Pe("",!0),e(O,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e(A,{class:"mr-4"},{default:t(()=>[e(L,{size:"large",onClick:b,color:"red"},{default:t(()=>[q("Voltar")]),_:1})]),_:1}),e(L,{size:"large",color:"green",onClick:I,disabled:a(u)},{default:t(()=>[q("Atualizar")]),_:1},8,["disabled"]),e(L,{class:"ml-4",size:"large",color:"blue",onClick:c[0]||(c[0]=P=>v.value=!0)},{default:t(()=>[q("Gerar Minuta")]),_:1})]),_:1}),e(s,{onConfirm:k,condMessage:a(T),show:a(v),onClose:c[1]||(c[1]=P=>v.value=!1)},null,8,["condMessage","show"])],64)}}},Rt={class:"d-flex align-center justify-center"},jt=["innerHTML"],Ft={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},setup(K){const r=K,f=Z();Ae(`${f.public.docEditor}`);const{$toast:p}=re(),y=le(),i=Y(),V=`${f.public.managemant}/download`,S=`${f.public.managemant}/atos/files`,E=`${f.public.managemant}/lavrarAto`,j=n("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),U=n(!1),h=n(null),v=n(null),T=n(null),u=async k=>{try{const m=await fetch(k);if(!m.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await m.blob()}catch(m){return console.error(m),p.error("Erro ao carregar o documento inicial."),null}},w=async()=>{try{const{data:k}=await x(`${S}/${i.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return k.value.link_ato}catch(k){console.error("Erro ao carregar o documento:",k),p.error(k)}},R=async()=>{try{const k=await w(),{data:m,status:z}=await x(V,{method:"POST",body:{bucket:"qvgjz",path:k}},"$7ljqltMqa0"),l=m.value,_=await u(l);if(_){const b=new FileReader;b.onload=()=>{const o=b.result;T.value.ej2Instances.documentEditor.open(o),console.log("asdfdsf")},b.readAsText(_)}}catch{p.error("Erro ao carregar o documento.")}};R();const g=async()=>{try{const{data:k,status:m}=await x(E,{method:"POST",body:{ato_token:i.query.ato_token_edit,qtd_paginas:r.pages}},"$OWxZSQkyX8");m.value==="success"?(h.value=k.value,v.value=k.value[0].selo,p.success("Ato lavrado com sucesso!")):p.error("Falha ao lavrar o ato.")}catch{p.error("Erro ao conectar com o servidor.")}},F=()=>{U.value=!1,g()},I=()=>{const k=i.query.origem||"criar",m=i.query.id;k==="atualizar"?y.push(`/os/atualizar/${m}`):y.push("/os/criar-registro")};return Le(()=>r.document,(k,m)=>{R()}),(k,m)=>{const z=Te;return B(),G($e,null,[e(O,null,{default:t(()=>[e(D,null,{default:t(()=>[e(a(Ee),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:T,height:"850px",width:"850px"},null,512)]),_:1}),e(D,null,{default:t(()=>[d("div",Rt,[d("div",null,[d("img",{onClick:m[0]||(m[0]=l=>U.value=!0),class:"ml-15",style:{height:"40px",width:"40px",cursor:"pointer","margin-top":"350px"},src:et}),a(h)?(B(),ue(_e,{key:0,width:"360px",class:"mr-16"},{default:t(()=>[e(O,null,{default:t(()=>[e(D,null,{default:t(()=>[e(Ve,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[q(" Livro: "+ne(a(h)[0].livro_numero),1)]),_:1})]),_:1}),e(D,null,{default:t(()=>[e(Ve,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[q(" Folhas : "+ne(a(h)[0].pagina_inicial)+" Á "+ne(a(h)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),d("div",{style:{border:"1px solid black","border-radius":"8px","padding-bottom":"20px","margin-top":"-10px"},class:"ml-2 mb-2 mr-2",innerHTML:a(v)},null,8,jt)]),_:1})):Pe("",!0)])])]),_:1})]),_:1}),q(" "+ne(r.pages)+" ",1),e(L,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:I},{default:t(()=>[q("Voltar")]),_:1}),e(z,{show:a(U),condMessage:a(j),onClose:m[1]||(m[1]=l=>U.value=!1),onConfirm:F},null,8,["show","condMessage"])],64)}}},Nt=["onClick"],Lt={key:0,style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar",title:"Reativar"},Gt={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ht={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(K){let r,f;const p=le(),y=Y(),i=Z(),{$toast:V}=re(),S=`${i.public.managemant}/listarEscrevente`;`${i.public.managemant}`;const E=`${i.public.managemant}/createAtosObservacao`,j=`${i.public.managemant}/updateAtosObservacao`,U=`${i.public.managemant}/getAtosObservacaoById`,h=n(J("user-data").value.cartorio_token),v=n([]),T=n([]),u=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],w=me({observacao:""}),R={observacao:{required:nt.withMessage("O campo é obrigatório",it)}},g=ct(R,w),{data:F}=([r,f]=Q(()=>x(`${U}/${y.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),r=await r,f(),r);v.value=F.value.map(l=>({...l,created:Ce(l.created,"dd/mm/yyyy hh:mm")}));async function I(){if(w.observacao.trim()===""){V.error("O campo de observação está vazio.");return}if(await g.value.$validate()){const{data:l,error:_,status:b}=await x(E,{method:"POST",body:{ato_id:y.query.ato_id,observacao:w.observacao,user_id:J("user-data").value.usuario_id}},"$gnHMo4uCXD");b.value==="success"&&(v.value.push({created:Ce(l.value.created,"dd/mm/yyyy hh:mm"),observacao:l.value.observacao,id:l.value.id,escrevente:J("user-data").value.nome}),w.observacao="",V.success("Observação registrada com sucesso"))}else V.error("Preencha os campos obrigatórios.")}async function k(l){l.excluido=!l.excluido;try{await x(`${j}/${l.id}`,{method:"PUT",body:JSON.stringify({excluido:l.excluido})},"$sP9AKdd3Ky")}catch(_){console.error("Erro ao excluir observação:",_)}}const{data:m}=([r,f]=Q(()=>x(S,{method:"POST",body:{cartorio_token:h}},"$HL9pndqGh0")),r=await r,f(),r);T.value=m.value[0].func_json_escreventes;const z=()=>{const l=y.query.origem||"criar",_=y.query.id;l==="atualizar"?p.push(`/os/atualizar/${_}`):p.push("/os/criar-registro")};return(l,_)=>{const b=ce;return B(),ue(pe,null,{default:t(()=>[e(O,{class:"mt-5"},{default:t(()=>[e(ie,{label:"Observação",modelValue:w.observacao,"onUpdate:modelValue":_[0]||(_[0]=o=>w.observacao=o),required:"","error-messages":a(g).observacao.$errors.length>0?a(g).observacao.$errors.map(o=>o.$message):[],onBlur:a(g).observacao.$touch,onInput:a(g).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),d("div",null,[d("img",{class:"btn-pointer ml-2",src:de,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:I})])]),_:1}),e(O,null,{default:t(()=>[e(D,null,{default:t(()=>[e(ge,{style:{height:"465px"},headers:u,items:v.value},{"item.actions":t(({item:o})=>[d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:c=>k(o),title:"Deletar Observação"},[o.excluido?(B(),G("img",Lt)):(B(),G("img",Gt))],8,Nt)]),_:1},8,["items"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(b,{onClick:z},{default:t(()=>[e(L,{size:"large",color:"red"},{default:t(()=>[q("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},Jt=d("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:tt,alt:"Escanear"},null,-1),Wt=[Jt],Kt=d("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:de,alt:"Criar"},null,-1),Xt=[Kt],Qt=["onClick"],Yt=d("img",{style:{width:"30px",height:"30px"},src:ve,alt:"Visualizar"},null,-1),Zt=[Yt],eo=["onClick"],to={key:0,style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar",title:"Reativar"},oo={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},ao={__name:"Anexos",async setup(K){let r,f;const p=Z(),{$toast:y}=re(),i=le(),V=Y(),S=`${p.public.biometria}/run-scanner`,E=`${p.public.managemant}/atos_anexos`,j=`${p.public.managemant}/atos_anexos`,U=`${p.public.managemant}/atos_anexos`,h=n(!1),v=n([]),T=me({descricao:""}),u=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:w}=([r,f]=Q(()=>x(`${U}/${V.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),r=await r,f(),r);v.value=w.value;async function R(){try{await g(),await F()}catch(l){console.error("Erro ao executar scanner ou listar arquivos:",l)}}async function g(){try{const{data:l}=await x(S,{method:"GET"},"$KttjFhHivJ")}catch(l){y.error("Erro ao acionar o scanner:",l)}}async function F(){try{const{data:l,status:_}=await x("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:V.query.ato_token_edit,cartorio_token:J("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(l){console.error("Erro ao enviar o arquivo:",l)}}const I=async()=>{h.value=!0},k=async()=>{const{data:l,error:_,status:b}=await x(E,{method:"POST",body:{ato_id:V.query.ato_id,descricao:T.descricao,user_id:J("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");b.value==="success"&&(y.success("Anexo registrado com sucesso!"),v.value.push(l.value))};async function m(l){l.excluido=!l.excluido;try{await x(`${j}/${l.id}`,{method:"PUT",body:JSON.stringify({excluido:l.excluido})},"$cdoFBGO0Ti")}catch(_){console.error("Erro ao excluir pessoa:",_)}}const z=()=>{const l=V.query.origem||"criar",_=V.query.id;l==="atualizar"?i.push(`/os/atualizar/${_}`):i.push("/os/criar-registro")};return(l,_)=>{const b=ce;return B(),ue(pe,null,{default:t(()=>[e(O,null,{default:t(()=>[e(D,{cols:"5"},{default:t(()=>[e(ie,{modelValue:a(T).descricao,"onUpdate:modelValue":_[0]||(_[0]=o=>a(T).descricao=o),label:"Descrição"},null,8,["modelValue"])]),_:1}),d("div",{onClick:R,title:"Escanear"},Wt),d("div",{onClick:k,title:"Criar"},Xt)]),_:1}),e(ge,{headers:u,items:a(v),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:o})=>[e(O,null,{default:t(()=>[d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:c=>I(o),title:"Visualizar Anexo"},Zt,8,Qt),d("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:c=>m(o),title:"Deletar Pessoa"},[o.excluido?(B(),G("img",to)):(B(),G("img",oo))],8,eo)]),_:2},1024)]),_:1},8,["items"]),e(xe,{modelValue:a(h),"onUpdate:modelValue":_[2]||(_[2]=o=>ae(h)?h.value=o:null),width:"600"},{default:t(()=>[e(_e,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(L,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:_[1]||(_[1]=o=>h.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(b,{onClick:z},{default:t(()=>[e(L,{size:"large",color:"red"},{default:t(()=>[q("Voltar")]),_:1})]),_:1})]),_:1})}}},so={class:"mb-10"},ro=d("h1",null,"Ordem de Serviço nº",-1),lo={style:{color:"red","margin-left":"30px"}},Eo={__name:"[id]",async setup(K){let r,f;const p=n(null),y=n(null),i=n(null),V=Z(),S=Y(),E=`${V.public.managemant}/listarSituacoes`,j=`${V.public.managemant}/getAtos`,U=n(J("user-data").value.cartorio_token),h=S.query.id?{ato_token:"xkyaA"}:{cartorio_token:U},v=n([]),T=n([]),u=n("PROCURAÇÕES"),w=n("PROCURAÇÃO");async function R(){try{const{data:m}=await x(`${j}/${S.query.ato_id}`,{method:"GET"},"$j0JpHHj7PB");T.value=m.value}catch(m){console.log(m)}}[r,f]=Q(()=>R()),await r,f();const{data:g,status:F}=([r,f]=Q(()=>x(E,{method:"POST",body:h},"$mGbp7gAEjS")),r=await r,f(),r);v.value=g.value;const I=m=>{p.value=m},k=m=>{y.value=m};return(m,z)=>{const l=ut,_=kt,b=St,o=It,c=Ft,A=Ht,s=ao;return B(),G($e,null,[d("div",so,[e(O,{class:"mb-5 mt-5"},{default:t(()=>[ro,d("h1",lo,ne(a(S).query.numero_os),1)]),_:1}),e(O,null,{default:t(()=>[e(D,{md:"6"},{default:t(()=>[e(se,{class:"mr-5",modelValue:a(u),"onUpdate:modelValue":z[0]||(z[0]=P=>ae(u)?u.value=P:null),disabled:""},null,8,["modelValue"])]),_:1}),e(D,{md:"6"},{default:t(()=>[e(se,{modelValue:a(w),"onUpdate:modelValue":z[1]||(z[1]=P=>ae(w)?w.value=P:null),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),e(_e,{width:"1300"},{default:t(()=>[e(He,{modelValue:a(i),"onUpdate:modelValue":z[2]||(z[2]=P=>ae(i)?i.value=P:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(te,{value:"dados"},{default:t(()=>[q("Dados")]),_:1}),e(te,{value:"partes"},{default:t(()=>[q("Partes")]),_:1}),e(te,{value:"bens"},{default:t(()=>[q("Bens")]),_:1}),e(te,{value:"minuta"},{default:t(()=>[q("Minuta")]),_:1}),e(te,{value:"livro"},{default:t(()=>[q("Livro")]),_:1}),e(te,{value:"observacao"},{default:t(()=>[q("Observações")]),_:1}),e(te,{value:"anexo"},{default:t(()=>[q("Anexos")]),_:1})]),_:1},8,["modelValue"]),e(Je,{modelValue:a(i),"onUpdate:modelValue":z[3]||(z[3]=P=>ae(i)?i.value=P:null)},{default:t(()=>[e(oe,{value:"dados"},{default:t(()=>[e(l,{item_dados:a(T),item_situacoes:a(v)},null,8,["item_dados","item_situacoes"])]),_:1}),e(oe,{value:"partes"},{default:t(()=>[e(_)]),_:1}),e(oe,{value:"bens"},{default:t(()=>[e(b)]),_:1}),e(oe,{value:"minuta"},{default:t(()=>[e(o,{onPage:I,onDoc:k})]),_:1}),e(oe,{value:"livro"},{default:t(()=>[e(c,{pages:a(p),document:a(y)},null,8,["pages","document"])]),_:1}),e(oe,{value:"observacao"},{default:t(()=>[e(A)]),_:1}),e(oe,{value:"anexo"},{default:t(()=>[e(s)]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}};export{Eo as default};
