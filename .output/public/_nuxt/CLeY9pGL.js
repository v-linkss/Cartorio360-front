import{_ as x}from"./DHSjxsvY.js";import{_ as q}from"./WJq2v01r.js";import{_ as A}from"./DKc7VncS.js";import{u as B,z as I,r as l,m as u,A as z,n as P,B as J,q as M,w as i,s as F,o as Y,b as s,a as r,V as j,x as g,y as p,C as H}from"./C2pfL-cR.js";import{u as k}from"./DiDuqZQn.js";import{V as L}from"./53ZbGIHG.js";import{V as _}from"./DC7Mye3y.js";import{V as c}from"./BgOPswnU.js";import{V as C}from"./DeNpNCyi.js";import{V as W}from"./DrwXdEpv.js";import"./CmzoKilT.js";import"./nGQkR870.js";import"./DHFX2WeY.js";import"./BOrfsbZK.js";const X=["title","onClick"],G=["onClick","title"],K=["onClick"],pa={__name:"index",setup(Q){const v=F(),{$toast:d}=B(),y=`${v.public.managemant}/listarUsuarios`,V=`${v.public.managemant}/listarCaixas`,h=I();l(u("auth_token").value);const f=l(u("user-data").value.cartorio_token)||null,b=l([]),m=l([]),S=l(["PENDENTE","ENCERRADO","CANCELADO"]),N=l(null),D=l([]),o=z({data:w(),situacao:null,usuario_token:null}),$=[{title:"Data",value:"data"},{title:"Situação",value:"situacao"},{title:"Usuário",value:"usuario_nome"},{title:"Ações",value:"actions",sortable:!1}];function w(){const a=new Date,t=a.getFullYear(),e=String(a.getMonth()+1).padStart(2,"0"),n=String(a.getDate()).padStart(2,"0");return`${t}-${e}-${n}`}async function R(){try{const{data:a}=await k(y,{method:"POST",body:{cartorio_token:f.value}},"$iWNqbVflHd");b.value=a.value}catch(a){d.error("Erro ao buscar usuários."),console.error(a)}}async function O(){try{sessionStorage.setItem("pesquisaCaixas",JSON.stringify(o));const{data:a}=await k(V,{method:"POST",body:{cartorio_token:f.value,user_token:o.usuario_token,data:o.data||null,situacao:o.situacao}},"$XYvyo77vvU");a.value.length>0?m.value=a.value:(m.value=[],d.error("Não existe caixa registrada!"))}catch(a){d.error("Erro ao buscar caixas."),console.error(a)}}function T(a,t){N.value=a,console.log("Redirecionando para cancelamento",{numero:a,token:t})}function E(a){const t=u("user-service"),e=D.value.find(n=>n.id===a);t.value=JSON.stringify({id:e.id,token:e.token}),h.push({path:`/os/atualizar/${a}`})}function U(a){const t=u("caixa-service");t.value=JSON.stringify({caixa_token:a.token,usuario_nome:a.usuario_nome,data:a.data}),H("/caixas/caixasRecebimentoOs")}return P(()=>{J(async()=>{const a=sessionStorage.getItem("pesquisaCaixas");if(a){const t=JSON.parse(a);Object.assign(o,t)}await R()})}),(a,t)=>(Y(),M(L,{class:"mt-5"},{default:i(()=>[s(_,{class:"mb-5"},{default:i(()=>t[3]||(t[3]=[r("h1",null,"Caixas",-1)])),_:1}),s(_,null,{default:i(()=>[s(c,{cols:"2"},{default:i(()=>[s(j,{modelValue:o.data,"onUpdate:modelValue":t[0]||(t[0]=e=>o.data=e),type:"date",label:"Data"},null,8,["modelValue"])]),_:1}),s(c,{md:"3"},{default:i(()=>[s(C,{modelValue:o.situacao,"onUpdate:modelValue":t[1]||(t[1]=e=>o.situacao=e),items:S.value,label:"Situação"},null,8,["modelValue","items"])]),_:1}),s(c,{md:"2"},{default:i(()=>[s(C,{items:b.value,modelValue:o.usuario_token,"onUpdate:modelValue":t[2]||(t[2]=e=>o.usuario_token=e),"item-title":"user_nome","item-value":"user_token",label:"Usuário"},null,8,["items","modelValue"])]),_:1}),s(c,null,{default:i(()=>[r("div",null,[r("img",{onClick:O,style:{width:"40px",height:"40px",cursor:"pointer"},src:x,alt:"Pesquisar"})])]),_:1})]),_:1}),t[5]||(t[5]=r("hr",{class:"mt-5 mb-5"},null,-1)),s(W,{headers:$,items:m.value,"item-key":"id"},{"item.actions":i(({item:e})=>[s(_,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:i(()=>[r("div",{class:p({disabled:!e.btn_receber}),title:e.btn_receber?"Receber":"Bloqueado",onClick:n=>e.btn_receber?U(e):null},[r("img",{style:g({cursor:e.btn_receber?"pointer":"default",width:"30px",height:"30px"}),src:q,alt:"Receber"},null,4)],10,X),r("div",{class:p({disabled:!e.btn_editar}),onClick:n=>e.btn_editar?E(e.id):null,title:e.btn_editar?"Editar":"Bloqueado"},[r("img",{style:g({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:A,alt:"Salvar"},null,4)],10,G),r("div",{class:p({disabled:!e.btn_cancelar}),onClick:n=>e.btn_cancelar?T(e.numero,e.token):null,title:"Cancelamento"},t[4]||(t[4]=[r("img",{style:{width:"30px",height:"30px"},src:x,alt:"Visualizar"},null,-1)]),10,K)]),_:2},1024)]),_:1},8,["items"])]),_:1}))}};export{pa as default};
