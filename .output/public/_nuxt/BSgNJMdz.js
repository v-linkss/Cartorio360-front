import{_ as oe}from"./B0Smkjfd.js";import{a as ae,_ as re}from"./CS3y5WT9.js";import{_ as se}from"./oMGUg6lR.js";import{_ as ne}from"./BVz1G1IN.js";import{_ as le}from"./C2wXVBaH.js";import{_ as ie}from"./CKaoJ7m9.js";import{_ as ue}from"./CeQA-iT-.js";import{c as I,r as S,u as pe}from"./BCTiy3FD.js";import{u as de}from"./CfRtBcXs.js";import{u as me,K as ce,D as _e,r as u,e as g,f as fe,y as z,m as ve,h as b,w as l,k as ge,o as h,b as s,a as n,t as ke,i as o,q as xe,s as w,x as C,v as Ve,V as $e,d as ye}from"./BFubt5K-.js";import{u as O}from"./DO0JiUxm.js";import{f as be}from"./D3GBDuUx.js";import{V as he}from"./B9P8d4Wk.js";import{V as k}from"./Cn46jq14.js";import{V as x}from"./CCJ0H2nG.js";import{V as we}from"./C1ZbU8qv.js";import{V as Ce}from"./0HI9nnWz.js";import"./BAz72YtY.js";import"./CGSGkCFE.js";import"./CJw_lHYf.js";import"./BcLYmS-Z.js";import"./kJoZuS00.js";import"./BjBE1yu7.js";import"./DS_gXmtl.js";import"./Q4Fj7ezm.js";import"./DXFSGs24.js";import"./BU3oJa_R.js";const Oe={style:{color:"red","margin-left":"30px"}},Te=["onClick"],Re=["onClick"],Ae=["onClick","title"],Ue=["onClick"],Ie=["title"],lt={__name:"[id]",async setup(Se){let i,c;const{redirectTo:T}=de(),{$toast:R}=me(),B=ce(),{id:d}=B.params,D=_e(),_=ge(),E=`${_.public.managemant}/updateOrdensServico`,N=`${_.public.managemant}/getOrdensServicoById`,P=`${_.public.managemant}/listarAtos`,q=`${_.public.managemant}/updateAtos`,F=u(g("user-data").value.cartorio_id),M=u(g("user-data").value.usuario_id),G=u(g("user-service").value.token).value||null,K=u(g("user-data").value.cartorio_token).value,V=u([]),$=u(!1),A=u(null),m=u(null),r=fe({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),L=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],W=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],X={apresentante_nome:{required:I.withMessage("O campo é obrigatorio",S)},apresentante_cpf:{required:I.withMessage("O campo é obrigatorio",S)}},p=pe(X,r);function Y(a){if(a)return a.replace(/[.\-]/g,"");a=null}const Z=a=>{A.value=a,$.value=!0},j=a=>{T({item:a,id:d,numeroOs:m.value,origem:"vizualizar"})},H=a=>{T({item:a,id:d,numeroOs:m.value,origem:"atualizar"})};async function J(){const a={apresentante_cpf:Y(r.apresentante_cpf),apresentante_nome:r.apresentante_nome,user_id:M.value,cartorio_id:F.value},{error:t,status:v}=await O(`${E}/${d}`,{method:"PUT",body:a},"$Fud06ay483");v.value==="error"&&t.value.statusCode===500?R.error("Erro ao cadastrar ordem,erro no sistema."):(R.success("Ordem Atualizada com sucesso!"),D.push({path:"/os/lista"}))}const{data:f}=([i,c]=z(()=>O(`${N}/${d}`,{method:"GET"},"$wPUkUpDvPf")),i=await i,c(),i);m.value=f.value.numero,r.nacionalidade=f.value.estrangeiro,r.apresentante_cpf=f.value.apresentante_cpf,r.apresentante_nome=f.value.apresentante_nome;const{data:U}=([i,c]=z(()=>O(P,{method:"POST",body:{cartorio_token:K,ordemserv_token:G}},"$YXZ55K3IUf")),i=await i,c(),i);async function Q(a){a.excluido=!a.excluido;try{await be(`${q}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(t){console.error("Erro ao excluir pessoa:",t)}}return U.value.length>0?V.value=U.value:V.value=[],(a,t)=>{const v=oe,ee=re,te=ve("mask");return h(),b(he,{class:"mt-5"},{default:l(()=>[s(k,{class:"mb-5"},{default:l(()=>[t[6]||(t[6]=n("h1",null,"Ordem de Serviço nº",-1)),n("h1",Oe,ke(o(m)),1)]),_:1}),s(k,null,{default:l(()=>[s(x,{md:"3"},{default:l(()=>[s(we,{label:"Nacionalidade",items:W,modelValue:o(r).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>o(r).nacionalidade=e)},null,8,["modelValue"])]),_:1}),s(x,{md:"2"},{default:l(()=>[o(r).nacionalidade==="brasileiro"?xe((h(),b(w,{key:0,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>o(r).apresentante_cpf=e),label:"CPF",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch,onInput:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[te,"###.###.###-##"]]):(h(),b(w,{key:1,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>o(r).apresentante_cpf=e),label:"Documento",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),s(x,{md:"4"},{default:l(()=>[s(w,{modelValue:o(r).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>o(r).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":o(p).apresentante_nome.$errors.map(e=>e.$message),onInput:o(p).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),s(x,null,{default:l(()=>[n("div",null,[n("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:se,alt:"Salvar",onClick:t[4]||(t[4]=e=>J())})])]),_:1})]),_:1}),s(k,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:l(()=>[t[10]||(t[10]=n("h1",{class:"ml-5"},"Atos",-1)),s(v,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:o(d),numeroOs:o(m)}}},{default:l(()=>t[7]||(t[7]=[n("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:ne,alt:"novo"},null,-1)])),_:1},8,["to"]),s(Ce,{headers:L,items:o(V),"item-key":"id"},{"item.actions":l(({item:e})=>[s(k,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:l(()=>[n("div",{onClick:y=>j(e),title:"Visualizar"},t[8]||(t[8]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:le,alt:"Visualizar"},null,-1)]),8,Te),n("div",{onClick:y=>Z(e.token),title:"Reimprimir"},t[9]||(t[9]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ae,alt:"Reimprimir"},null,-1)]),8,Re),n("div",{class:Ve({disabled:!e.btn_editar}),onClick:y=>e.btn_editar?H({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,rota:e.rota}):null,title:e.btn_editar?"Editar":"Desabilitado"},[n("img",{style:C({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ie,alt:"Editar"},null,4)],10,Ae),n("div",{onClick:y=>e.btn_cancelar?Q(e):null,title:"Excluir",style:C({cursor:e.btn_cancelar?"pointer":"not-allowed"})},[n("img",{style:C({width:"30px",height:"30px",cursor:e.btn_cancelar?"pointer":"not-allowed",opacity:e.btn_cancelar?"1":"0.5"}),src:ue,alt:"Cancelar",title:e.btn_cancelar?"Cancelar":"Não permitido"},null,12,Ie)],12,Ue)]),_:2},1024)]),_:1},8,["items"]),s(ee,{show:o($),ato_token:o(A),onClose:t[5]||(t[5]=e=>$.value=!1)},null,8,["show","ato_token"])]),_:1}),s(v,{to:"/os/lista"},{default:l(()=>[s($e,{size:"large",color:"red"},{default:l(()=>t[11]||(t[11]=[ye("Voltar")])),_:1})]),_:1})]),_:1})}}};export{lt as default};
