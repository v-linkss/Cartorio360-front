import{_ as no}from"./DNqkLck6.js";import{_ as ro,a as io}from"./Dw55uekJ.js";import{_ as uo}from"./Daj1NuDQ.js";import{_ as mo}from"./C7c9nufs.js";import{_ as z}from"./CzTVSLYn.js";import{_ as po}from"./BXWRW_0h.js";import{_ as co,a as _o}from"./DJvq3mCv.js";import{_ as vo,u as fo,r,e as C,f as yo,g as Vo,n as ko,h as bo,c as U,b as s,w as n,a as u,i as l,j as go,k as $o,F as ho,l as xo,o as V,m as f,V as d,p as wo,q as Ao}from"./53wtz2vB.js";import{u as So}from"./CLSJ4FAw.js";import{u as k}from"./DEp3O3ub.js";import{f as b}from"./B0IxRygJ.js";import{f as Co}from"./J-B_IgMN.js";import{V as Uo}from"./CesdksN3.js";import{V as Do}from"./BUpEVBD4.js";import{V as D}from"./CQ4VLSVb.js";import{V as i}from"./ByL2bqCk.js";import{V as O}from"./1RGlw7YC.js";import"./BaNYGi72.js";import"./DpF8eg4y.js";import"./Q2QVRxWJ.js";import"./75KM1rpg.js";import"./DM0JP4YN.js";import"./D9mhfAR6.js";import"./gfUWorQE.js";import"./BVz1G1IN.js";import"./BEP5wVTu.js";import"./CH6M0IgO.js";import"./C7dhR3QW.js";const Oo={style:{width:"1300px",margin:"0 auto"}},Po={style:{display:"flex",gap:"4px","justify-content":"center"}},To=["onClick"],No=["onClick"],Eo=["onClick","title"],Mo=["onClick"],Io={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:co,alt:"Visualizar",title:"Reativar"},Ro={key:1,src:_o,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},qo={__name:"index",setup(zo){const _=xo(),{$toast:F}=fo(),L=`${_.public.managemant}/listarUsuarios`,j=`${_.public.managemant}/listar_tipo_atos`;`${_.public.managemant}`;const B=`${_.public.managemant}/updateAtos`,P=`${_.public.managemant}/pesquisaAtos`,{redirectTo:T}=So(),g=r(C("auth_token").value)||null,$=r(C("user-data").value.cartorio_token)||null,h=r(!1),y=r([]),N=r([]),E=r([]),H=r(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),M=r(!1),x=r(!1),J=r(""),W=r(null),Y=r({}),w=r(!1),I=r(null),A=r(null),t=yo({numero:null,data_inicio:R(),data_fim:R(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:g.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),Q=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:e=>e.protocolo?`${e.id}
${e.protocolo}`:`${e.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:e=>e.dt_abertura?`${e.dt_abertura}
${e.apresentante_cpf}`:`${e.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:e=>e.dt_lavratura?`${e.dt_lavratura}
${e.apresentante_nome}`:`${e.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:e=>e.situacao?`${e.situacao}
${e.ato_servico}`:`${e.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function R(){const e=new Date,o=e.getFullYear(),p=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${p}-${o}`}function c(e){if(!e)return null;const[o,p,m]=e.split("/");return`${m}-${p}-${o}`}async function q(){const e=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(e),{data:p}=await k(P,{method:"POST",body:{cartorio_token:C("user-data").value.cartorio_token,usuario_token:o.usuario_token||g.value,data_fim:c(o==null?void 0:o.data_fim),data_inicio:c(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");p.value.length>0&&(y.value=p.value.map(m=>({...m,dt_lavratura:m.dt_lavratura?b(m.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:b(m.dt_abertura,"dd/mm/yyyy")})))}async function X(){const{data:e}=await k(L,{method:"POST",body:{cartorio_token:$.value}},"$hvipqUJYtS");N.value=e.value}async function Z(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(t));const{data:e}=await k(P,{method:"POST",body:{cartorio_token:$.value,numero:t.numero||null,data_inicio:c(t.data_inicio)||null,data_fim:c(t.data_fim)||null,data_lavratura_inicio:c(t.data_lavratura_inicio)||null,data_lavratura_fim:c(t.data_lavratura_fim)||null,protocolo:t.protocolo||null,livro:t.livro||null,folha:t.folha||null,situacao:t.situacao||null,usuario_token:t.usuario_token,selo:t.selo||null,ato_tipo_token:t.ato_tipo_token,parte:t.parte||null}},"$OjamgBH6nj");e.value.length>0?y.value=e.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?b(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?b(o.dt_abertura,"dd/mm/yyyy"):null})):(y.value=[],F.error("Não existe ato Registrado!"))}catch(e){console.error("Erro na requisição",e)}}const G=e=>{T({item:e,id,numeroOs:e.numero_os,origem:"vizualizar-lista"})};async function K(){const{data:e,error:o}=await k(j,{method:"POST",body:{cartorio_token:$.value,usuario_token:g.value,tipo_retorno:"servico_ato"}},"$QxIfw0Zxe4");E.value=e.value}const oo=e=>{I.value=e,w.value=!0};async function eo(e){e.excluido=!e.excluido;try{await Co(`${B}/${e.id}`,{method:"PUT",body:{excluido:e.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}const ao=async()=>{A.value&&(await cancelaAto(A.value),A.value=null),x.value=!1},to=e=>{T({item:e,id:e.id,numeroOs:e.numero_os,origem:"atualizar-lista"})};return Vo(()=>{ko(async()=>{const e=sessionStorage.getItem("pesquisaAto");if(e){const o=JSON.parse(e);Object.assign(t,o)}await q()})}),X(),K(),(e,o)=>{const p=no,m=ro,lo=uo,so=mo,v=bo("mask");return V(),U(ho,null,[s(Uo,{class:"mt-5"},{default:n(()=>[s(D,{class:"mb-5"},{default:n(()=>o[19]||(o[19]=[u("h1",null,"Atos",-1)])),_:1}),s(D,null,{default:n(()=>[s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(t).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=a=>l(t).data_inicio=a),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(t).data_fim,"onUpdate:modelValue":o[1]||(o[1]=a=>l(t).data_fim=a),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(t).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=a=>l(t).data_lavratura_inicio=a),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(t).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=a=>l(t).data_lavratura_fim=a),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[v,"##/##/####"]])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(t).numero,"onUpdate:modelValue":o[4]||(o[4]=a=>l(t).numero=a),label:"N° OS"},null,8,["modelValue"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(t).selo,"onUpdate:modelValue":o[5]||(o[5]=a=>l(t).selo=a),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),s(D,null,{default:n(()=>[s(i,{cols:"2"},{default:n(()=>[s(d,{modelValue:l(t).protocolo,"onUpdate:modelValue":o[6]||(o[6]=a=>l(t).protocolo=a),label:"Protocolo"},null,8,["modelValue"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[f(s(d,{modelValue:l(t).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=a=>l(t).apresentante_cpf=a),label:"CPF",dense:""},null,8,["modelValue"]),[[v,"###.###.###-##"]])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(d,{modelValue:l(t).parte,"onUpdate:modelValue":o[8]||(o[8]=a=>l(t).parte=a),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(O,{modelValue:l(t).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=a=>l(t).ato_tipo_token=a),items:l(E),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),s(i,{cols:"2"},{default:n(()=>[s(O,{items:l(N),modelValue:l(t).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=a=>l(t).usuario_token=a),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),s(i,{cols:"3"},{default:n(()=>[s(O,{modelValue:l(t).situacao,"onUpdate:modelValue":o[11]||(o[11]=a=>l(t).situacao=a),items:l(H),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),s(i,{cols:"1"},{default:n(()=>[s(d,{modelValue:l(t).livro,"onUpdate:modelValue":o[12]||(o[12]=a=>l(t).livro=a),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"1"},{default:n(()=>[s(d,{modelValue:l(t).folha,"onUpdate:modelValue":o[13]||(o[13]=a=>l(t).folha=a),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),s(i,null,{default:n(()=>[u("div",null,[u("img",{onClick:Z,style:{width:"40px",height:"40px",cursor:"pointer"},src:z,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),u("div",Oo,[o[22]||(o[22]=u("hr",{class:"mt-5 mb-5"},null,-1)),s(Do,{headers:Q,items:l(y),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":n(({item:a})=>[u("div",Po,[u("div",{onClick:S=>G({id:a.id,tipo:`${a.tipo_servico} - ${a.tipo_ato}`,token:a.token,tipo_token:a.tipo_token,rota:a.rota,numero_os:a.numero_os}),title:"Visualizar"},o[20]||(o[20]=[u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:z,alt:"Visualizar"},null,-1)]),8,To),u("div",{onClick:S=>oo(a.token),title:"Reimprimir"},o[21]||(o[21]=[u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:io,alt:"Reimprimir"},null,-1)]),8,No),u("div",{class:wo({disabled:!a.btn_editar}),onClick:S=>a.btn_editar?to({id:a.id,tipo:`${a.tipo_servico} - ${a.tipo_ato}`,token:a.token,tipo_token:a.tipo_token,rota:a.rota,numero_os:a.numero_os}):null,title:a.btn_editar?"Editar":"Desabilitado"},[u("img",{style:Ao({cursor:a.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:po,alt:"Editar"},null,4)],10,Eo),u("div",{onClick:S=>eo(a),title:"Excluir"},[a.excluido?(V(),U("img",Io)):(V(),U("img",Ro))],8,Mo)])]),_:1},8,["items"])]),l(h)?(V(),go(p,{key:0,show:l(h),servicos:e.dadosData.servicos||[],tiposAtos:e.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=a=>h.value=!1),onUpdateAto:e.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):$o("",!0),s(m,{show:l(w),ato_token:l(I),onClose:o[15]||(o[15]=a=>w.value=!1)},null,8,["show","ato_token"]),s(lo,{show:l(M),numero_os:l(W),ordem:l(Y),onClose:o[16]||(o[16]=a=>M.value=!1),onRefreshValue:o[17]||(o[17]=a=>q())},null,8,["show","numero_os","ordem"]),s(so,{show:l(x),condMessage:l(J),onClose:o[18]||(o[18]=a=>x.value=!1),onConfirm:ao},null,8,["show","condMessage"])],64)}}},ve=vo(qo,[["__scopeId","data-v-bec7e757"]]);export{ve as default};
