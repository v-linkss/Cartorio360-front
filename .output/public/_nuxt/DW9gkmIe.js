import{_ as uo}from"./BQpsr73C.js";import{_ as mo}from"./DFJyD5SB.js";import{_ as po,a as _o}from"./Db_1UjQ7.js";import{_ as co}from"./Bg2D3hwc.js";import{_ as vo}from"./Q6jsdRDs.js";import{_ as fo}from"./BVz1G1IN.js";import{_ as J}from"./CoNu1dlU.js";import{_ as yo}from"./vrqv6k1J.js";import{_ as ko,a as Vo}from"./DJvq3mCv.js";import{_ as bo,u as go,m as ho,r as i,n as V,p as xo,q as So,s as $o,v as Ao,c as C,b as s,w as r,a as d,x as l,y as wo,z as Co,F as Oo,A as Do,o as S,B as b,V as m,C as Uo,D as To}from"./B3CWS20p.js";import{u as g}from"./LD0J6Q1I.js";import{f as v}from"./B0IxRygJ.js";import{f as No}from"./BppRTRtR.js";import{V as qo}from"./BjG_Q5fV.js";import{V as Eo}from"./e3NevvNt.js";import{V as O}from"./Bv9c7jYJ.js";import{V as u}from"./zC0Mf6NK.js";import{V as D}from"./QjMBemGt.js";import"./Dmx4dsn4.js";import"./sCmgXVmG.js";import"./C98KKlSb.js";import"./DSUMHbqS.js";import"./BwKMvsgO.js";import"./BRf0CzwJ.js";import"./B1yehevT.js";import"./BYiHxiEQ.js";import"./D7KBJxLo.js";const Po={style:{width:"1580px",margin:"0 auto"}},Io={style:{display:"flex",gap:"4px","justify-content":"center"}},zo=["onClick"],Ro=["onClick"],Fo=["onClick","title"],Mo=["disabled","onClick"],Lo={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:ko,alt:"Visualizar",title:"Reativar"},Bo={key:1,src:Vo,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Jo={__name:"index",setup(jo){const f=Do(),{$toast:j}=go(),Y=`${f.public.managemant}/listarUsuarios`,H=`${f.public.managemant}/listarOrdensServico`,Q=`${f.public.managemant}/tipoAtos`,W=`${f.public.managemant}/updateAtos`,U=`${f.public.managemant}/pesquisaAtos`,T=ho(),$=i(V("auth_token").value)||null,h=i(V("user-data").value.cartorio_token)||null,A=i(!1),N=i([]),_=i([]),q=i([]),E=i([]),X=i(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),P=i(!1),I=i(!1),z=i(null),Z=i(null),R=i(null),G=i({}),F=i(!1),K=i(null),a=xo({numero:null,data_inicio:x(),data_fim:x(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,livro:null,folha:null,situacao:null,usuario_token:$.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),oo=[{title:"ID",value:"id"},{title:"Data Abertura",value:"dt_abertura"},{title:"Data lavratura",value:"dt_lavratura"},{title:"N° OS",value:"numero_os"},{title:"Protocolo",value:"protocolo"},{title:"Apresentante",value:"apresentante_nome"},{title:"CPF",value:"apresentante_cpf"},{title:"Tipo Serviço",value:"ato_servico"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function x(){const e=new Date,o=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${n}-${o}`}function c(e){if(!e)return null;const[o,n,p]=e.split("/");return`${p}-${n}-${o}`}async function M(){x();const e=sessionStorage.getItem("pesquisaOS");JSON.parse(e);const{data:o}=await g(U,{method:"POST",body:{cartorio_token:V("user-data").value.cartorio_token}},"$1U9Iv6Es1X");o.value.length>0&&(_.value=o.value.map(n=>({...n,data:v(n.data,"dd/mm/yyyy"),dt_abertura:v(n.dt_abertura,"dd/mm/yyyy")})))}async function eo(){const{data:e}=await g(Y,{method:"POST",body:{cartorio_token:h.value}},"$hvipqUJYtS");q.value=e.value}async function to(){try{sessionStorage.setItem("pesquisaOS",JSON.stringify(a));const{data:e,error:o}=await g(U,{method:"POST",body:{cartorio_token:h.value,numero:a.numero||null,data_inicio:c(a.data_inicio)||null,data_fim:c(a.data_fim)||null,data_lavratura_inicio:c(a.data_lavratura_inicio)||null,data_lavratura_fim:c(a.data_lavratura_fim)||null,protocolo:a.protocolo||null,livro:a.livro||null,folha:a.folha||null,situacao:a.situacao||null,usuario_token:a.usuario_token,selo:a.selo||null,ato_tipo_token:a.ato_tipo_token,apresentante:a.apresentante||null}},"$OjamgBH6nj");_.value.length>0?_.value=_.value.map(n=>({...n,data:n.data?v(n.data,"dd/mm/yyyy"):null,dt_abertura:n.dt_abertura?v(n.dt_abertura,"dd/mm/yyyy"):null})):(_.value=[],j.error("Não existe ato Registrado!"))}catch(e){console.error("Erro na requisição",e)}}const ao=e=>{T.push({path:`/fontes/atos/atos-com-bem/atualizar/${e.id}`,query:{origem:"vizualizar",id:e.id,ato_id:e.id,tipo_ato_token:e.tipo_token,tipo_ato:e.tipo,ato_token_edit:e.token,numero_os:e.numero_os,usa_imoveis:e.usa_imoveis}})};async function lo(){const{data:e,error:o}=await g(Q,{method:"POST",body:{cartorio_token:h.value,usuario_token:$.value}},"$QxIfw0Zxe4");E.value=e.value}const L=async()=>{try{const e=x(),o=sessionStorage.getItem("pesquisaOS"),n=JSON.parse(o),{data:p,error:B}=await g(H,{method:"POST",body:{cartorio_token:h.value,usuario_token:n.usuario_token||$.value,data_fim:c(n==null?void 0:n.data_fim)||e,data_inicio:c(n==null?void 0:n.data_inicio)||e}},"$ceiptlfDNO");p.value.length>0?N.value=p.value.map(y=>({...y,data:v(y.data,"dd/mm/yyyy"),dt_abertura:v(y.dt_abertura,"dd/mm/yyyy")})):N.value=[]}catch(e){console.error("Erro ao buscar serviços",e)}};async function so(e){e.excluido=!e.excluido;try{await No(`${W}/${e.id}`,{method:"PUT",body:{excluido:e.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}const no=e=>{(e.usa_imoveis||!e.usa_imoveis)&&T.push({path:`/fontes/atos/atos-com-bem/atualizar/${e.id}`,query:{origem:"atualizar",id:e.id,ato_id:e.id,tipo_ato_token:e.tipo_token,tipo_ato:e.tipo,ato_token_edit:e.token,numero_os:e.numero_os,usa_imoveis:e.usa_imoveis}})},ro=()=>{const e=V("user-service"),o=V("ordem-button");e.value=null,z.value=!0,o.value=z.value};return So(()=>{$o(async()=>{const e=sessionStorage.getItem("pesquisaOS");if(e){const o=JSON.parse(e);Object.assign(a,o)}await L(),await M()})}),eo(),lo(),M(),(e,o)=>{const n=uo,p=mo,B=po,y=co,io=vo,k=Ao("mask");return S(),C(Oo,null,[s(qo,{class:"mt-5"},{default:r(()=>[s(O,{class:"mb-5"},{default:r(()=>[o[19]||(o[19]=d("h1",null,"Atos",-1)),s(n,{to:"/os/criar-registro"},{default:r(()=>[d("img",{style:{width:"60px",height:"60px",cursor:"pointer","margin-left":"70px"},src:fo,alt:"novo",onClick:ro})]),_:1})]),_:1}),s(O,null,{default:r(()=>[s(u,{cols:"2"},{default:r(()=>[b(s(m,{modelValue:l(a).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=t=>l(a).data_inicio=t),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[k,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:r(()=>[b(s(m,{modelValue:l(a).data_fim,"onUpdate:modelValue":o[1]||(o[1]=t=>l(a).data_fim=t),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[k,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:r(()=>[b(s(m,{modelValue:l(a).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=t=>l(a).data_lavratura_inicio=t),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[k,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:r(()=>[b(s(m,{modelValue:l(a).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=t=>l(a).data_lavratura_fim=t),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[k,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:r(()=>[b(s(m,{modelValue:l(a).apresentante_cpf,"onUpdate:modelValue":o[4]||(o[4]=t=>l(a).apresentante_cpf=t),label:"CPF",dense:""},null,8,["modelValue"]),[[k,"###.###.###-##"]])]),_:1}),s(u,{cols:"2"},{default:r(()=>[s(m,{modelValue:l(a).selo,"onUpdate:modelValue":o[5]||(o[5]=t=>l(a).selo=t),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),s(O,null,{default:r(()=>[s(u,{cols:"2"},{default:r(()=>[s(m,{modelValue:l(a).numero,"onUpdate:modelValue":o[6]||(o[6]=t=>l(a).numero=t),label:"N° OS"},null,8,["modelValue"])]),_:1}),s(u,{cols:"2"},{default:r(()=>[s(m,{modelValue:l(a).protocolo,"onUpdate:modelValue":o[7]||(o[7]=t=>l(a).protocolo=t),label:"Protocolo"},null,8,["modelValue"])]),_:1}),s(u,{cols:"3"},{default:r(()=>[s(m,{modelValue:l(a).apresentante,"onUpdate:modelValue":o[8]||(o[8]=t=>l(a).apresentante=t),label:"Apresentante",dense:""},null,8,["modelValue"])]),_:1}),s(u,{cols:"3"},{default:r(()=>[s(D,{modelValue:l(a).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=t=>l(a).ato_tipo_token=t),items:l(E),"item-title":"descricao","item-value":"token",label:"Tipo Serviço",dense:""},null,8,["modelValue","items"])]),_:1}),s(u,{cols:"2"},{default:r(()=>[s(D,{items:l(q),modelValue:l(a).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=t=>l(a).usuario_token=t),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),s(u,{cols:"3"},{default:r(()=>[s(D,{modelValue:l(a).situacao,"onUpdate:modelValue":o[11]||(o[11]=t=>l(a).situacao=t),items:l(X),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),s(u,{cols:"1"},{default:r(()=>[s(m,{modelValue:l(a).livro,"onUpdate:modelValue":o[12]||(o[12]=t=>l(a).livro=t),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),s(u,{cols:"1"},{default:r(()=>[s(m,{modelValue:l(a).folha,"onUpdate:modelValue":o[13]||(o[13]=t=>l(a).folha=t),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),s(u,null,{default:r(()=>[d("div",null,[d("img",{onClick:to,style:{width:"40px",height:"40px",cursor:"pointer"},src:J,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),d("div",Po,[o[22]||(o[22]=d("hr",{class:"mt-5 mb-5"},null,-1)),s(Eo,{headers:oo,items:l(_),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":r(({item:t})=>[d("div",Io,[d("div",{onClick:w=>ao(t),title:"Visualizar"},o[20]||(o[20]=[d("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:J,alt:"Visualizar"},null,-1)]),8,zo),d("div",{onClick:w=>e.redirectToModalReimprimir(t.token),title:"Reimprimir"},o[21]||(o[21]=[d("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:_o,alt:"Reimprimir"},null,-1)]),8,Ro),d("div",{class:Uo({disabled:!t.btn_editar}),onClick:w=>t.btn_editar?no({id:t.id,tipo:t.tipo,token:t.token,tipo_token:t.tipo_token,usa_imoveis:t.usa_imoveis}):null,title:t.btn_editar?"Editar":"Desabilitado"},[d("img",{style:To({cursor:t.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:yo,alt:"Editar"},null,4)],10,Fo),d("div",{disabled:!t.btn_cancelar,onClick:w=>t.btn_cancelar?so(t):null,title:"Excluir"},[t.excluido?(S(),C("img",Lo)):(S(),C("img",Bo))],8,Mo)])]),_:1},8,["items"])]),l(A)?(S(),wo(p,{key:0,show:l(A),servicos:e.dadosData.servicos||[],tiposAtos:e.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=t=>A.value=!1),onUpdateAto:e.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):Co("",!0),s(B,{show:l(F),ato_token:l(K),onClose:o[15]||(o[15]=t=>F.value=!1)},null,8,["show","ato_token"]),s(y,{show:l(P),numero_os:l(R),ordem:l(G),onClose:o[16]||(o[16]=t=>P.value=!1),onRefreshValue:o[17]||(o[17]=t=>L())},null,8,["show","numero_os","ordem"]),s(io,{show:l(I),numero_os:l(R),ordemserv_token:l(Z),onClose:o[18]||(o[18]=t=>I.value=!1)},null,8,["show","numero_os","ordemserv_token"])],64)}}},Ve=bo(Jo,[["__scopeId","data-v-30b0f6a0"]]);export{Ve as default};
