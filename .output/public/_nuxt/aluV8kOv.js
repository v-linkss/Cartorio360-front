import{_ as mo}from"./drrGwx-L.js";import{_ as po,a as _o}from"./BaUI3Tro.js";import{_ as vo}from"./By0eghwA.js";import{_ as fo}from"./Be1Mo6ei.js";import{_ as L}from"./CLrm4IrV.js";import{_ as yo}from"./Duc-MU2K.js";import{_ as ko,u as Vo,r as u,m as g,n as bo,p as $o,q as go,s as ho,c as D,b as r,w as s,a as n,v as l,x as xo,y as wo,F as Ao,z as Co,o as h,A as V,V as c,B as So,C as Do}from"./C5AD4oDh.js";import{_ as Uo}from"./cVqCVnh_.js";import{_ as Oo,a as To}from"./DJvq3mCv.js";import{u as Po}from"./Dv-l0ugp.js";import{u as _}from"./C141XRkM.js";import{f as x}from"./B0IxRygJ.js";import{f as Eo}from"./DkhC_ATn.js";import{V as No}from"./DEvWNVwG.js";import{V as qo}from"./gqcryAln.js";import{V as U}from"./DgARkL2p.js";import{V as i}from"./D_KLStyr.js";import{V as O}from"./BI2onaNb.js";import"./DiXrMPJ9.js";import"./BbWF70Xe.js";import"./Dq7e0D3j.js";import"./DUGk-3mS.js";import"./LUqnwA8e.js";import"./IpEFah36.js";import"./CyXHrDie.js";import"./BVz1G1IN.js";import"./B5rmz9rS.js";import"./py4Zkmkc.js";import"./GPO_sOd4.js";const Ro=""+new URL("btn_cancela_lavratura.DGZVG9h_.png",import.meta.url).href,Mo={style:{width:"1300px",margin:"0 auto"}},zo={style:{display:"flex",gap:"4px","justify-content":"center"}},Io=["onClick"],Fo=["onClick"],Lo=["onClick","title"],Bo=["disabled","onClick"],Jo=["onClick"],Ho=["onClick"],jo={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:Oo,alt:"Visualizar",title:"Reativar"},Go={key:1,src:To,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Xo={__name:"index",setup(Yo){const p=Co(),{$toast:f}=Vo(),B=`${p.public.managemant}/listarUsuarios`,J=`${p.public.managemant}/listar_tipo_atos`,H=`${p.public.managemant}/cancela_lavratura`,j=`${p.public.biometria}/run-scanner?format=pdf`,G=`${p.public.envioDoc}/upload`,X=`${p.public.managemant}/updateAtos`,T=`${p.public.managemant}/pesquisaAtos`,{redirectTo:P}=Po(),b=u(g("auth_token").value)||null,w=u(g("user-data").value.cartorio_token)||null,A=u(!1),$=u([]),E=u([]),N=u([]),Y=u(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),q=u(!1),C=u(!1),R=u(""),W=u(null),Z=u({}),S=u(!1),M=u(null),e=bo({numero:null,data_inicio:z(),data_fim:z(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,parte:null,livro:null,folha:null,situacao:null,usuario_token:b.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),K=[{title:"ID/Protocolo",key:"protocoloId",width:"70px",value:a=>a.protocolo?`${a.id}
${a.protocolo}`:`${a.id}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Abertura/CPF",key:"aberturaCpf",value:a=>a.dt_abertura?`${a.dt_abertura}
${a.apresentante_cpf}`:`${a.apresentante_cpf}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Data lavratura/Parte",key:"lavraturaNome",value:a=>a.dt_lavratura?`${a.dt_lavratura}
${a.apresentante_nome}`:`${a.apresentante_nome}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"N° OS",value:"numero_os"},{title:"Usuario",value:"usuario_nome"},{title:"Situação/Serviço",key:"situacaoServico",value:a=>a.situacao?`${a.situacao}
${a.ato_servico}`:`${a.ato_servico}`,cellProps:{style:{whiteSpace:"pre-line",lineHeight:"2"}}},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function z(){const a=new Date,o=a.getFullYear(),d=String(a.getMonth()+1).padStart(2,"0");return`${String(a.getDate()).padStart(2,"0")}-${d}-${o}`}function v(a){if(!a)return null;const[o,d,m]=a.split("/");return`${m}-${d}-${o}`}async function I(){const a=sessionStorage.getItem("pesquisaAto"),o=JSON.parse(a),{data:d}=await _(T,{method:"POST",body:{cartorio_token:g("user-data").value.cartorio_token,usuario_token:o.usuario_token||b.value,data_fim:v(o==null?void 0:o.data_fim),data_inicio:v(o==null?void 0:o.data_inicio)}},"$1U9Iv6Es1X");d.value.length>0&&($.value=d.value.map(m=>({...m,dt_lavratura:m.dt_lavratura?x(m.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:x(m.dt_abertura,"dd/mm/yyyy")})))}async function Q(){const{data:a}=await _(B,{method:"POST",body:{cartorio_token:w.value}},"$hvipqUJYtS");E.value=a.value}async function oo(){try{sessionStorage.setItem("pesquisaAto",JSON.stringify(e));const{data:a}=await _(T,{method:"POST",body:{cartorio_token:w.value,numero:e.numero||null,data_inicio:v(e.data_inicio)||null,data_fim:v(e.data_fim)||null,data_lavratura_inicio:v(e.data_lavratura_inicio)||null,data_lavratura_fim:v(e.data_lavratura_fim)||null,protocolo:e.protocolo||null,livro:e.livro||null,folha:e.folha||null,situacao:e.situacao||null,usuario_token:e.usuario_token,selo:e.selo||null,ato_tipo_token:e.ato_tipo_token,parte:e.parte||null}},"$OjamgBH6nj");a.value.length>0?$.value=a.value.map(o=>({...o,dt_lavratura:o.dt_lavratura?x(o.dt_lavratura,"dd/mm/yyyy hh:mm"):null,dt_abertura:o.dt_abertura?x(o.dt_abertura,"dd/mm/yyyy"):null})):($.value=[],f.error("Não existe ato Registrado!"))}catch(a){console.error("Erro na requisição",a)}}const ao=a=>{P({item:a,id:a.id,numeroOs:a.numero_os,origem:"vizualizar-lista"})};async function to(){const{data:a,error:o}=await _(J,{method:"POST",body:{cartorio_token:w.value,usuario_token:b.value,tipo_retorno:"servico_ato"}},"$QxIfw0Zxe4");N.value=a.value}const eo=a=>{M.value=a,S.value=!0};async function lo(a){a.excluido=!a.excluido;try{await Eo(`${X}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}const F=async a=>{const{data:o,status:d}=await _(H,{method:"POST",body:{ato_token:a,user_token:b.value,cancelar_selo:!1}},"$ceiptlfDNO");d.value==="success"&&o.value[0].status==="OK"?f.success("Lavratura cancelada com sucesso!"):o.value[0].status==="ERRO"&&(C.value=!0,R.value=o.value[0].status_mensagem)},ro=a=>{P({item:a,id:a.id,numeroOs:a.numero_os,origem:"atualizar-lista"})},so=async a=>{try{await io(),await no(a)}catch(o){console.error("Erro ao executar scanner ou listar arquivos:",o)}};async function no(a){try{const{status:o,data:d}=await _(G,{method:"POST",body:{tipo:"ato_livro",token:a,cartorio_token:g("user-data").value.cartorio_token}},"$zTNfED00Fu");o.value==="success"&&f.success("Arquivo enviado com sucesso!")}catch(o){f.error(o),console.error("Erro ao enviar o arquivo:",o)}}async function io(){try{const{data:a}=await _(j,{method:"GET"},"$hJse5XXJsY")}catch(a){f.error("Erro ao acionar o scanner:",a)}}return $o(()=>{go(async()=>{const a=sessionStorage.getItem("pesquisaAto");if(a){const o=JSON.parse(a);Object.assign(e,o)}await I()})}),Q(),to(),(a,o)=>{const d=mo,m=po,uo=vo,co=fo,y=ho("mask");return h(),D(Ao,null,[r(No,{class:"mt-5"},{default:s(()=>[r(U,{class:"mb-5"},{default:s(()=>o[19]||(o[19]=[n("h1",null,"Atos",-1)])),_:1}),r(U,null,{default:s(()=>[r(i,{cols:"2"},{default:s(()=>[V(r(c,{modelValue:l(e).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=t=>l(e).data_inicio=t),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),r(i,{cols:"2"},{default:s(()=>[V(r(c,{modelValue:l(e).data_fim,"onUpdate:modelValue":o[1]||(o[1]=t=>l(e).data_fim=t),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),r(i,{cols:"2"},{default:s(()=>[V(r(c,{modelValue:l(e).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=t=>l(e).data_lavratura_inicio=t),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),r(i,{cols:"2"},{default:s(()=>[V(r(c,{modelValue:l(e).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=t=>l(e).data_lavratura_fim=t),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),r(i,{cols:"2"},{default:s(()=>[r(c,{modelValue:l(e).numero,"onUpdate:modelValue":o[4]||(o[4]=t=>l(e).numero=t),label:"N° OS"},null,8,["modelValue"])]),_:1}),r(i,{cols:"2"},{default:s(()=>[r(c,{modelValue:l(e).selo,"onUpdate:modelValue":o[5]||(o[5]=t=>l(e).selo=t),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),r(U,null,{default:s(()=>[r(i,{cols:"2"},{default:s(()=>[r(c,{modelValue:l(e).protocolo,"onUpdate:modelValue":o[6]||(o[6]=t=>l(e).protocolo=t),label:"Protocolo"},null,8,["modelValue"])]),_:1}),r(i,{cols:"2"},{default:s(()=>[V(r(c,{modelValue:l(e).apresentante_cpf,"onUpdate:modelValue":o[7]||(o[7]=t=>l(e).apresentante_cpf=t),label:"CPF",dense:""},null,8,["modelValue"]),[[y,"###.###.###-##"]])]),_:1}),r(i,{cols:"3"},{default:s(()=>[r(c,{modelValue:l(e).parte,"onUpdate:modelValue":o[8]||(o[8]=t=>l(e).parte=t),label:"Parte",dense:""},null,8,["modelValue"])]),_:1}),r(i,{cols:"3"},{default:s(()=>[r(O,{modelValue:l(e).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=t=>l(e).ato_tipo_token=t),items:l(N),"item-value":"token","item-title":"descricao",label:"Tipo Serviço","menu-props":{maxWidth:"680px",width:"680px"},dense:""},null,8,["modelValue","items"])]),_:1}),r(i,{cols:"2"},{default:s(()=>[r(O,{items:l(E),modelValue:l(e).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=t=>l(e).usuario_token=t),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),r(i,{cols:"3"},{default:s(()=>[r(O,{modelValue:l(e).situacao,"onUpdate:modelValue":o[11]||(o[11]=t=>l(e).situacao=t),items:l(Y),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),r(i,{cols:"1"},{default:s(()=>[r(c,{modelValue:l(e).livro,"onUpdate:modelValue":o[12]||(o[12]=t=>l(e).livro=t),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),r(i,{cols:"1"},{default:s(()=>[r(c,{modelValue:l(e).folha,"onUpdate:modelValue":o[13]||(o[13]=t=>l(e).folha=t),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),r(i,null,{default:s(()=>[n("div",null,[n("img",{onClick:oo,style:{width:"40px",height:"40px",cursor:"pointer"},src:L,alt:"Pesquisar"})])]),_:1})]),_:1})]),_:1}),n("div",Mo,[o[24]||(o[24]=n("hr",{class:"mt-5 mb-5"},null,-1)),r(qo,{headers:K,items:l($),style:{"font-size":"12px"},"item-key":"id"},{"item.actions":s(({item:t})=>[n("div",zo,[n("div",{onClick:k=>ao({id:t.id,tipo:`${t.tipo_servico} - ${t.tipo_ato}`,token:t.token,tipo_token:t.tipo_token,rota:t.rota,numero_os:t.numero_os}),title:"Visualizar"},o[20]||(o[20]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:L,alt:"Visualizar"},null,-1)]),8,Io),n("div",{onClick:k=>eo(t.token),title:"Reimprimir"},o[21]||(o[21]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:_o,alt:"Reimprimir"},null,-1)]),8,Fo),n("div",{class:So({disabled:!t.btn_editar}),onClick:k=>t.btn_editar?ro({id:t.id,tipo:`${t.tipo_servico} - ${t.tipo_ato}`,token:t.token,tipo_token:t.tipo_token,rota:t.rota,numero_os:t.numero_os}):null,title:t.btn_editar?"Editar":"Desabilitado"},[n("img",{style:Do({cursor:t.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:yo,alt:"Editar"},null,4)],10,Lo),n("div",{disabled:!t.btn_cancelar,onClick:k=>t.btn_cancelar?F(t.token):null,title:"Excluir"},o[22]||(o[22]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:Ro,alt:"Cancelar",title:"Cancelar"},null,-1)]),8,Bo),n("div",{onClick:k=>so(t.token)},o[23]||(o[23]=[n("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:Uo,alt:"escanear",title:"escanear"},null,-1)]),8,Jo),n("div",{onClick:k=>lo(t),title:"Excluir"},[t.excluido?(h(),D("img",jo)):(h(),D("img",Go))],8,Ho)])]),_:1},8,["items"])]),l(A)?(h(),xo(d,{key:0,show:l(A),servicos:a.dadosData.servicos||[],tiposAtos:a.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=t=>A.value=!1),onUpdateAto:a.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):wo("",!0),r(m,{show:l(S),ato_token:l(M),onClose:o[15]||(o[15]=t=>S.value=!1)},null,8,["show","ato_token"]),r(uo,{show:l(q),numero_os:l(W),ordem:l(Z),onClose:o[16]||(o[16]=t=>q.value=!1),onRefreshValue:o[17]||(o[17]=t=>I())},null,8,["show","numero_os","ordem"]),r(co,{show:l(C),condMessage:l(R),onClose:o[18]||(o[18]=t=>C.value=!1),onConfirm:F},null,8,["show","condMessage"])],64)}}},wa=ko(Xo,[["__scopeId","data-v-2a2b968a"]]);export{wa as default};
