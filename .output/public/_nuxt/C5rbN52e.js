import{_ as se}from"./D2vJ64Ox.js";import{n as ee,u as te,m as oe,r as d,q as ce,o as M,v as re,w as t,b as e,x as o,B as Z,z as J,d as B,A as ae,p as X,s as le,a as g,c as W,y as xe,D as Re,E as Fe,G as Ue,C as $e,F as ke,g as Ie,H as be,t as ne}from"./CNAiVaQm.js";import{u as b}from"./-ksdFIuP.js";import{V as P}from"./4QjTaRBk.js";import{V as O}from"./nC4QlDlf.js";import{V as me}from"./CVYrSSd-.js";import{V as ue}from"./DqvlQ722.js";import{_ as Be,d as Ne}from"./D4LNZrlm.js";import{_ as Le,a as Ge,b as He,T as Je,W as Ke,S as We,r as we,D as Ce,c as Ee,d as Xe,e as Ye}from"./Doq9lZMC.js";import{_ as pe}from"./CbW2FJx7.js";import{_ as ie,V as fe,a as Qe,b as _e,c as ve}from"./paxI6nei.js";import{V as Ve,a as ye}from"./BC3latsD.js";import{c as Ze,r as et,u as tt}from"./CPhUGWrC.js";import{_ as he}from"./CdP3NN9a.js";const Ot={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(Y){const m=Y,{$toast:h}=ee(),f=ae(),x=te(),c=oe(),k=`${f.public.managemant}/updateAtos`,F=d(m.item_situacoes),C=ce({dt_abertura:m.item_dados[0].dt_abertura||null,status:m.item_dados[0].status||null,mne:m.item_dados[0].mne||null});async function N(){const{data:_,error:i,status:A}=await b(`${k}/${c.query.ato_id}`,{method:"PUT",body:{status:C.status,mne:C.mne,dt_abertura:C.dt_abertura}},"$EIT5jtTUdX");A.value==="success"&&h.success("Ato Atualizado com sucesso")}const z=()=>{const _=c.query.origem||"criar",i=c.query.id;_==="atualizar"?x.push(`/os/atualizar/${i}`):x.push("/os/criar-registro")};return(_,i)=>{const A=se;return M(),re(ue,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(O,{cols:"3"},{default:t(()=>[e(me,{label:"Situação",modelValue:o(C).status,"onUpdate:modelValue":i[0]||(i[0]=w=>o(C).status=w),items:o(F),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(O,{cols:"5"},{default:t(()=>[e(Z,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:o(C).mne,"onUpdate:modelValue":i[1]||(i[1]=w=>o(C).mne=w)},null,8,["modelValue"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(O,{cols:"2"},{default:t(()=>[e(Z,{modelValue:o(C).dt_abertura,"onUpdate:modelValue":i[2]||(i[2]=w=>o(C).dt_abertura=w),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(P,{class:"mb-3"},{default:t(()=>[e(A,{onClick:z},{default:t(()=>[e(J,{size:"large",color:"red"},{default:t(()=>i[3]||(i[3]=[B("Voltar")])),_:1})]),_:1}),e(J,{class:"ml-10",onClick:N,size:"large",color:"green"},{default:t(()=>i[4]||(i[4]=[B("Atualizar")])),_:1})]),_:1})]),_:1})}}},ot=["onClick"],at=["onClick"],st=["onClick"],rt={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},nt={key:1,src:ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},lt=["onClick"],Mt={__name:"Partes",async setup(Y){let m,h;const f=te(),x=oe(),c=ae(),{$toast:k}=ee(),F=`${c.public.managemant}/pesquisarPessoas`,C=`${c.public.managemant}/listarPapeis`,N=`${c.public.managemant}/getLinkTipo`,z=`${c.public.managemant}/createAtosPessoa`,_=`${c.public.managemant}/updateAtosPessoa`,i=`${c.public.managemant}/getAtosPessoaById`,A=`${c.public.managemant}/download`,w=d(X("user-data").value.cartorio_token),V=d([]),D=d([]),q=d([]),U=d(!1),L=d(!1),p=d(!1),v=d(!1),G=d(null),s=d(null),r=d(null),T=d(null),a=d(null),l=d("xkyaA"),$=d(null),S=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],u=ce({papeis:null,nome:null,pessoa:null,documento:null}),{data:j}=([m,h]=le(()=>b(C,{method:"POST",body:{tipo_ato_token:"xkyaA"}},"$acoiTIUp00")),m=await m,h(),m);q.value=j.value;const R=async()=>{const{data:y}=await b(`${i}/${x.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),I=(Q=>Q.map(H=>({...H,pessoa:{...H.pessoa,documento:H.pessoa.doc_identificacao},papel:{...H.partes_tipos}})))(y.value);D.value=I};R();async function ge(){try{const{data:y,error:n}=await b(F,{method:"POST",body:{cartorio_token:w.value,documento:u.documento,nome:u.nome}},"$pr30MyPXfY");y.value.length>0?(V.value=y.value,u.pessoa=V.value[0]):V.value=[]}catch(y){console.error("Erro na requisição",y)}}const Pe=()=>{L.value=!0},Ae=async()=>{await R()},Te=async()=>{await R()},qe=async()=>{const y={pessoa:u.pessoa,papel:q.value.find(K=>K.id===u.papeis),representante:{nome:null}},n=await b(`${i}/${x.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const K of n.data.value)if(K.pessoa_id===u.pessoa.id&&K.ato_id===Number(x.query.ato_id)&&K.tipo_parte_id===u.papeis){k.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:I,error:Q,status:H}=await b(z,{method:"POST",body:{ato_id:x.query.ato_id,pessoa_id:u.pessoa.id,tipo_parte_id:u.papeis,user_id:X("user-data").value.usuario_id}},"$18isAgOJxG");H.value==="success"&&(y.id=I.value.id,k.success("Pessoa Registrada com Sucesso!"),D.value.push(y))},ze=async y=>{var K;if(p.value=!0,$.value=null,!y.pessoa.id)return;const{data:n}=await b(N,{method:"POST",body:{tipo:"ficha",id:y.pessoa.id}},"$hmDzSF3F61");if(!((K=n.value)!=null&&K.link))return;const{data:I}=await b(A,{method:"POST",body:{bucket:"qvgjz",path:n.value.link}},"$l09I6nLRfk"),Q=n.value.link,H=I.value;/\.(tr7|tiff)$/i.test(Q)?$.value=H:fotoRender.value=`data:image/jpeg;base64,${H}`},Oe=y=>{const n=D.value.filter(I=>I.pessoa.id!==y.pessoa.id).map(I=>({id:I.pessoa.id,nome:I.pessoa.nome}));r.value=y.id,G.value=n,U.value=!0,s.value=y.pessoa.nome,a.value=y.pessoa.id},Me=y=>{v.value=!0,T.value=y.id,s.value=y.pessoa.nome};async function De(y){y.excluido=!y.excluido;try{await b(`${_}/${y.id}`,{method:"PUT",body:JSON.stringify({excluido:y.excluido})},"$PUt0nEhmBF")}catch(n){console.error("Erro ao excluir pessoa:",n)}}const Se=()=>{const y=x.query.origem||"criar",n=x.query.id;y==="atualizar"?f.push(`/os/atualizar/${n}`):f.push("/os/criar-registro")};return(y,n)=>{const I=Be,Q=Ge,H=He,K=Ne,je=se;return M(),re(ue,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(O,{cols:"3"},{default:t(()=>[e(Z,{label:"Documento",modelValue:o(u).documento,"onUpdate:modelValue":n[0]||(n[0]=E=>o(u).documento=E)},null,8,["modelValue"])]),_:1}),e(O,{cols:"4"},{default:t(()=>[e(Z,{label:"Pessoa",modelValue:o(u).nome,"onUpdate:modelValue":n[1]||(n[1]=E=>o(u).nome=E)},null,8,["modelValue"])]),_:1}),g("div",null,[g("img",{class:"mt-1",src:pe,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:ge})]),g("div",null,[g("img",{class:"mt-1 ml-2",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Pe})])]),_:1}),e(P,null,{default:t(()=>[e(O,{cols:"4"},{default:t(()=>[e(me,{label:"Selecione a Pessoa",modelValue:o(u).pessoa,"onUpdate:modelValue":n[2]||(n[2]=E=>o(u).pessoa=E),items:o(V),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(O,{cols:"3"},{default:t(()=>[e(me,{label:"Papel",modelValue:o(u).papeis,"onUpdate:modelValue":n[3]||(n[3]=E=>o(u).papeis=E),items:o(q),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),g("div",null,[g("img",{class:"mt-1",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:qe})])]),_:1}),e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(fe,{style:{height:"465px"},headers:S,items:o(D)},{"item.actions":t(({item:E})=>[e(P,null,{default:t(()=>[g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:de=>ze(E),title:"Visualizar Ficha"},n[9]||(n[9]=[g("img",{style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar"},null,-1)]),8,ot),g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:de=>Me(E),class:"mr-2",title:"Alterar Papel"},n[10]||(n[10]=[g("img",{style:{width:"30px",height:"30px"},src:Qe,alt:"Visualizar"},null,-1)]),8,at),g("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:de=>De(E),title:"Deletar Pessoa"},[E.excluido?(M(),W("img",rt)):(M(),W("img",nt))],8,st),g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:de=>Oe(E),title:"Selecionar Representante"},n[11]||(n[11]=[g("img",{style:{width:"30px",height:"30px"},src:Le,alt:"Visualizar"},null,-1)]),8,lt)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(I,{show:o(L),onClose:n[4]||(n[4]=E=>L.value=!1)},null,8,["show"]),e(Q,{representante_nome:o(s),representantes:o(G),ato_id:o(r),show:o(U),onClose:n[5]||(n[5]=E=>U.value=!1),onUpdateRepresentante:Te},null,8,["representante_nome","representantes","ato_id","show"]),e(H,{representante_nome:o(s),ato_token:o(l),ato_id:o(T),show:o(v),onClose:n[6]||(n[6]=E=>v.value=!1),onUpdatePapel:Ae},null,8,["representante_nome","ato_token","ato_id","show"]),e(Ve,{modelValue:o(p),"onUpdate:modelValue":n[8]||(n[8]=E=>xe(p)?p.value=E:null),width:"600"},{default:t(()=>[e(ye,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(K,{"tiff-url":o($)},null,8,["tiff-url"]),e(J,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:n[7]||(n[7]=E=>p.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(P,null,{default:t(()=>[e(je,{onClick:Se},{default:t(()=>[e(J,{size:"large",color:"red"},{default:t(()=>n[12]||(n[12]=[B("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},it={key:0,class:"loading-overlay"},ct="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Dt={__name:"Minuta",emits:["page","doc"],setup(Y,{emit:m}){Re("DocumentEditorContainer",[Je,Ke,We]);const h=ae(),{$toast:f}=ee(),x=te(),c=oe(),k=m;we(`${h.public.docEditor}`);const F=`${h.public.managemant}/download`,C=`${h.public.managemant}/atos/files`,N=`${h.public.managemant}/subitituirModelo`,z=`${h.public.managemant}/upload`,_=d(null),i=d(!1),A=d("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),w=d(!1),V=async a=>{try{const l=await fetch(a);if(!l.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await l.blob()}catch(l){return console.error(l),f.error("Erro ao carregar o documento inicial."),null}},D=async()=>{try{const{data:a}=await b(`${C}/${c.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return a.value.link_ato}catch(a){console.error("Erro ao carregar o documento:",a),f.error(a)}},q=async()=>{w.value=!0;try{const a=await D(),{data:l,status:$}=await b(F,{method:"POST",body:{bucket:"qvgjz",path:a}},"$dvNFfvmIJC"),S=l.value,u=await V(S);if(u){const j=new FileReader;j.onload=()=>{const R=j.result;_.value.ej2Instances.documentEditor.open(R),k("doc",R)},j.readAsText(u)}}catch{f.error("Erro ao carregar o documento.")}finally{w.value=!1}},U=async()=>{const l=await _.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),$=new FileReader;$.onload=()=>{const S=$.result,j=_.value.ej2Instances.documentEditor.pageCount;k("page",j),k("doc",S)},$.readAsText(l)},L=async()=>{w.value=!0;try{const l=await _.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),$=new FormData;$.append("file",l,"anexo.sfdt"),$.append("cartorio_token",X("user-data").value.cartorio_token),$.append("token",c.query.ato_token_edit),$.append("tipo","ato_minuta");const{data:S,status:u}=await b(z,{method:"POST",body:$},"$xv11VtUdMy");if(u.value==="success"){f.success("Documento enviado!");const R=_.value.ej2Instances.documentEditor.pageCount;U(),k("page",R)}else f.error("Erro ao enviar documento para o sistema.")}catch(a){f.error("Erro ao salvar documento."),console.error(a)}finally{w.value=!1}},p=()=>{i.value=!1,v()},v=async()=>{r(!0);try{await G(),r(!0);const{data:a,status:l}=await b(N,{method:"POST",body:{ato_token:c.query.ato_token_edit}},"$zyzWHTXTBW");a.value&&s(a.value)}catch(a){console.error("Erro ao gerar a minuta:",a),f.error("Ocorreu um erro ao gerar a minuta.")}finally{r(!1)}},G=async()=>{try{const{data:a}=await b(F,{method:"POST",body:{bucket:"qvgjz",path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),l=await V(a.value);if(l){const $=new FileReader;$.onload=()=>{const S=$.result;_.value.ej2Instances.documentEditor.open(S),k("doc",S)},$.readAsText(l)}}catch(a){console.error("Erro ao carregar o modelo de minuta:",a),f.error("Falha ao carregar o modelo de minuta.")}},s=a=>{const l=_.value.ej2Instances.documentEditor,$=S=>{for(const[u,j]of Object.entries(S))if(/^<<.+>>$/.test(u))try{l.search.findAll(u),l.search.searchResults.length>0&&l.search.searchResults.replaceAll(j)}catch(R){console.error(`Erro ao substituir o marcador ${u}:`,R)}else if(u==="partes"&&Array.isArray(j)&&j.length>0)for(const R of j)typeof R=="object"&&$(R)};$(a)},r=a=>{w.value=a},T=()=>{const a=c.query.origem||"criar",l=c.query.id;a==="atualizar"?x.push(`/os/atualizar/${l}`):x.push("/os/criar-registro")};return Fe(async()=>{await q(),U()}),(a,l)=>{const $=se,S=Ee;return M(),W(ke,null,[e(o(Ce),{height:"900px",ref_key:"documentEditorContainer",ref:_,serviceUrl:ct,enableToolbar:!0,enableWordExport:!0},null,512),o(w)?(M(),W("div",it,[e(Ue,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):$e("",!0),e(P,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e($,{class:"mr-4"},{default:t(()=>[e(J,{size:"large",onClick:T,color:"red"},{default:t(()=>l[2]||(l[2]=[B("Voltar")])),_:1})]),_:1}),e(J,{size:"large",color:"green",onClick:L,disabled:o(w)},{default:t(()=>l[3]||(l[3]=[B("Atualizar")])),_:1},8,["disabled"]),e(J,{class:"ml-4",size:"large",color:"blue",onClick:l[0]||(l[0]=u=>i.value=!0)},{default:t(()=>l[4]||(l[4]=[B("Gerar Minuta")])),_:1})]),_:1}),e(S,{onConfirm:p,condMessage:o(A),show:o(i),onClose:l[1]||(l[1]=u=>i.value=!1)},null,8,["condMessage","show"])],64)}}},ut={class:"d-flex align-center justify-center"},dt=["innerHTML"],St={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},setup(Y){const m=Y,h=ae();we(`${h.public.docEditor}`);const{$toast:f}=ee(),x=te(),c=oe(),k=`${h.public.managemant}/download`,F=`${h.public.managemant}/atos/files`,C=`${h.public.managemant}/lavrarAto`,N=d("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),z=d(!1),_=d(null),i=d(null),A=d(null),w=async p=>{try{const v=await fetch(p);if(!v.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await v.blob()}catch(v){return console.error(v),f.error("Erro ao carregar o documento inicial."),null}},V=async()=>{try{const{data:p}=await b(`${F}/${c.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return p.value.link_ato}catch(p){console.error("Erro ao carregar o documento:",p),f.error(p)}},D=async()=>{try{const p=await V(),{data:v,status:G}=await b(k,{method:"POST",body:{bucket:"qvgjz",path:p}},"$7ljqltMqa0"),s=v.value,r=await w(s);if(r){const T=new FileReader;T.onload=()=>{const a=T.result;A.value.ej2Instances.documentEditor.open(a)},T.readAsText(r)}}catch{f.error("Erro ao carregar o documento.")}};D();const q=async()=>{try{const{data:p,status:v}=await b(C,{method:"POST",body:{ato_token:c.query.ato_token_edit,qtd_paginas:m.pages}},"$OWxZSQkyX8");v.value==="success"?(_.value=p.value,i.value=p.value[0].selo,f.success("Ato lavrado com sucesso!")):f.error("Falha ao lavrar o ato.")}catch{f.error("Erro ao conectar com o servidor.")}},U=()=>{z.value=!1,q()},L=()=>{const p=c.query.origem||"criar",v=c.query.id;p==="atualizar"?x.push(`/os/atualizar/${v}`):x.push("/os/criar-registro")};return Ie(()=>m.document,(p,v)=>{D()}),(p,v)=>{const G=Ee;return M(),W(ke,null,[e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(o(Ce),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:A,height:"850px",width:"850px"},null,512)]),_:1}),e(O,null,{default:t(()=>[g("div",ut,[g("div",null,[g("img",{onClick:v[0]||(v[0]=s=>z.value=!0),class:"ml-15",style:{height:"40px",width:"40px",cursor:"pointer","margin-top":"350px"},src:Xe}),o(_)?(M(),re(ye,{key:0,width:"360px",class:"mr-16"},{default:t(()=>[e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(be,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[B(" Livro: "+ne(o(_)[0].livro_numero),1)]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(be,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[B(" Folhas : "+ne(o(_)[0].pagina_inicial)+" Á "+ne(o(_)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),g("div",{style:{border:"1px solid black","border-radius":"8px","padding-bottom":"20px","margin-top":"-10px"},class:"ml-2 mb-2 mr-2",innerHTML:o(i)},null,8,dt)]),_:1})):$e("",!0)])])]),_:1})]),_:1}),B(" "+ne(m.pages)+" ",1),e(J,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:L},{default:t(()=>v[2]||(v[2]=[B("Voltar")])),_:1}),e(G,{show:o(z),condMessage:o(N),onClose:v[1]||(v[1]=s=>z.value=!1),onConfirm:U},null,8,["show","condMessage"])],64)}}},mt=["onClick"],pt={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},ft={key:1,src:ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},jt={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(Y){let m,h;const f=te(),x=oe(),c=ae(),{$toast:k}=ee(),F=`${c.public.managemant}/listarEscrevente`;`${c.public.managemant}`;const C=`${c.public.managemant}/createAtosObservacao`,N=`${c.public.managemant}/updateAtosObservacao`,z=`${c.public.managemant}/getAtosObservacaoById`,_=d(X("user-data").value.cartorio_token),i=d([]),A=d([]),w=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],V=ce({observacao:""}),D={observacao:{required:Ze.withMessage("O campo é obrigatório",et)}},q=tt(D,V),{data:U}=([m,h]=le(()=>b(`${z}/${x.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),m=await m,h(),m);i.value=U.value.map(s=>({...s,created:he(s.created,"dd/mm/yyyy hh:mm")}));async function L(){if(V.observacao.trim()===""){k.error("O campo de observação está vazio.");return}if(await q.value.$validate()){const{data:s,error:r,status:T}=await b(C,{method:"POST",body:{ato_id:x.query.ato_id,observacao:V.observacao,user_id:X("user-data").value.usuario_id}},"$gnHMo4uCXD");T.value==="success"&&(i.value.push({created:he(s.value.created,"dd/mm/yyyy hh:mm"),observacao:s.value.observacao,id:s.value.id,escrevente:X("user-data").value.nome}),V.observacao="",k.success("Observação registrada com sucesso"))}else k.error("Preencha os campos obrigatórios.")}async function p(s){s.excluido=!s.excluido;try{await b(`${N}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$sP9AKdd3Ky")}catch(r){console.error("Erro ao excluir observação:",r)}}const{data:v}=([m,h]=le(()=>b(F,{method:"POST",body:{cartorio_token:_}},"$HL9pndqGh0")),m=await m,h(),m);A.value=v.value[0].func_json_escreventes;const G=()=>{const s=x.query.origem||"criar",r=x.query.id;s==="atualizar"?f.push(`/os/atualizar/${r}`):f.push("/os/criar-registro")};return(s,r)=>{const T=se;return M(),re(ue,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(Z,{label:"Observação",modelValue:V.observacao,"onUpdate:modelValue":r[0]||(r[0]=a=>V.observacao=a),required:"","error-messages":o(q).observacao.$errors.length>0?o(q).observacao.$errors.map(a=>a.$message):[],onBlur:o(q).observacao.$touch,onInput:o(q).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),g("div",null,[g("img",{class:"btn-pointer ml-2",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:L})])]),_:1}),e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(fe,{style:{height:"465px"},headers:w,items:i.value},{"item.actions":t(({item:a})=>[g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:l=>p(a),title:"Deletar Observação"},[a.excluido?(M(),W("img",pt)):(M(),W("img",ft))],8,mt)]),_:1},8,["items"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(T,{onClick:G},{default:t(()=>[e(J,{size:"large",color:"red"},{default:t(()=>r[1]||(r[1]=[B("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},_t=["onClick"],vt=["onClick"],yt={key:0,style:{width:"30px",height:"30px"},src:_e,alt:"Visualizar",title:"Reativar"},gt={key:1,src:ve,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Rt={__name:"Anexos",async setup(Y){let m,h;const f=ae(),{$toast:x}=ee(),c=te(),k=oe(),F=`${f.public.biometria}/run-scanner`,C=`${f.public.managemant}/atos_anexos`,N=`${f.public.managemant}/atos_anexos`,z=`${f.public.managemant}/atos_anexos`,_=d(!1),i=d([]),A=ce({descricao:""}),w=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:V}=([m,h]=le(()=>b(`${z}/${k.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),m=await m,h(),m);i.value=V.value;async function D(){try{await q(),await U()}catch(s){console.error("Erro ao executar scanner ou listar arquivos:",s)}}async function q(){try{const{data:s}=await b(F,{method:"GET"},"$KttjFhHivJ")}catch(s){x.error("Erro ao acionar o scanner:",s)}}async function U(){try{const{data:s,status:r}=await b("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:k.query.ato_token_edit,cartorio_token:X("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(s){console.error("Erro ao enviar o arquivo:",s)}}const L=async()=>{_.value=!0},p=async()=>{const{data:s,error:r,status:T}=await b(C,{method:"POST",body:{ato_id:k.query.ato_id,descricao:A.descricao,user_id:X("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");T.value==="success"&&(x.success("Anexo registrado com sucesso!"),i.value.push(s.value))};async function v(s){s.excluido=!s.excluido;try{await b(`${N}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$cdoFBGO0Ti")}catch(r){console.error("Erro ao excluir pessoa:",r)}}const G=()=>{const s=k.query.origem||"criar",r=k.query.id;s==="atualizar"?c.push(`/os/atualizar/${r}`):c.push("/os/criar-registro")};return(s,r)=>{const T=se;return M(),re(ue,null,{default:t(()=>[e(P,null,{default:t(()=>[e(O,{cols:"5"},{default:t(()=>[e(Z,{modelValue:o(A).descricao,"onUpdate:modelValue":r[0]||(r[0]=a=>o(A).descricao=a),label:"Descrição"},null,8,["modelValue"])]),_:1}),g("div",{onClick:D,title:"Escanear"},r[3]||(r[3]=[g("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ye,alt:"Escanear"},null,-1)])),g("div",{onClick:p,title:"Criar"},r[4]||(r[4]=[g("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ie,alt:"Criar"},null,-1)]))]),_:1}),e(fe,{headers:w,items:o(i),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:a})=>[e(P,null,{default:t(()=>[g("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:l=>L(a),title:"Visualizar Anexo"},r[5]||(r[5]=[g("img",{style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar"},null,-1)]),8,_t),g("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:l=>v(a),title:"Deletar Pessoa"},[a.excluido?(M(),W("img",yt)):(M(),W("img",gt))],8,vt)]),_:2},1024)]),_:1},8,["items"]),e(Ve,{modelValue:o(_),"onUpdate:modelValue":r[2]||(r[2]=a=>xe(_)?_.value=a:null),width:"600"},{default:t(()=>[e(ye,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(J,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:r[1]||(r[1]=a=>_.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(T,{onClick:G},{default:t(()=>[e(J,{size:"large",color:"red"},{default:t(()=>r[6]||(r[6]=[B("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Ot as _,Mt as a,Dt as b,St as c,jt as d,Rt as e};
