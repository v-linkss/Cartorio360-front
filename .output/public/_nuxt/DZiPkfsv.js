import{_ as te}from"./gZBbaLrE.js";import{_ as oe,a as ae}from"./C6B8e8o8.js";import{_ as se}from"./C_ar_oGM.js";import{_ as re}from"./BVz1G1IN.js";import{_ as ne}from"./Ds1k55_2.js";import{_ as ie}from"./CJWoGetl.js";import{_ as le,a as ue}from"./DJvq3mCv.js";import{c as T,r as E,u as pe}from"./Bni1fX-8.js";import{m as de,J as me,G as ce,r as u,u as k,H as _e,n as U,M as fe,p as w,w as n,q as ve,o as c,b as r,a as i,t as ge,s as a,N as ke,V as C,D as he,C as xe,c as B,v as $e,d as ye}from"./BOL4noSq.js";import{u as O}from"./TzX8YZO0.js";import{f as Ve}from"./_dXWBzjd.js";import{V as be}from"./Cl_P9YfM.js";import{V as h}from"./bqpzMvxx.js";import{V as x}from"./DQU5PUT0.js";import{V as we}from"./BRVU7TxM.js";import{V as Ce}from"./C5FAYfot.js";import"./CPO4BRHb.js";import"./D6ANBwFC.js";import"./DgnvD5-t.js";import"./BTXPcqnv.js";import"./BAkrviJb.js";import"./BuYEFpRz.js";const Oe={style:{color:"red","margin-left":"30px"}},Re=["onClick"],ze=["onClick"],Ae=["onClick","title"],Te=["disabled","onClick"],Ee={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:le,alt:"Visualizar",title:"Reativar"},Ue={key:1,src:ue,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},at={__name:"[id]",async setup(Be){let l,_;const{$toast:R}=de(),I=me(),{id:d}=I.params,$=ce(),f=ve(),S=`${f.public.managemant}/updateOrdensServico`,q=`${f.public.managemant}/getOrdensServicoById`,D=`${f.public.managemant}/listarAtos`,N=`${f.public.managemant}/updateAtos`,P=u(k("user-data").value.cartorio_id),F=u(k("user-data").value.usuario_id),M=u(k("user-service").value.token).value||null,G=u(k("user-data").value.cartorio_token).value,y=u([]),V=u(!1),z=u(null),m=u(null),s=_e({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),L=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],H=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],J={apresentante_nome:{required:T.withMessage("O campo é obrigatorio",E)},apresentante_cpf:{required:T.withMessage("O campo é obrigatorio",E)}},p=pe(J,s);function K(e){if(e)return e.replace(/[.\-]/g,"");e=null}const W=e=>{z.value=e,V.value=!0},X=e=>{(e.rota==="/fontes/atos/ato-com-bem/geral"||e.rota==="/fontes/atos/ato-sem-bem/geral")&&$.push({path:`/fontes/atos/atos-com-bem/atualizar/${e.id}`,query:{origem:"vizualizar",id:d,ato_id:e.id,tipo_ato_token:e.tipo_token,tipo_ato:e.tipo,ato_token_edit:e.token,numero_os:m.value,usa_imoveis:e.usa_imoveis}})},Y=e=>{(e.usa_imoveis||!e.usa_imoveis)&&$.push({path:`/fontes/atos/atos-com-bem/atualizar/${e.id}`,query:{origem:"atualizar",id:d,ato_id:e.id,tipo_ato_token:e.tipo_token,tipo_ato:e.tipo,ato_token_edit:e.token,numero_os:m.value,usa_imoveis:e.usa_imoveis}})};async function Z(){const e={apresentante_cpf:K(s.apresentante_cpf),apresentante_nome:s.apresentante_nome,user_id:F.value,cartorio_id:P.value},{error:o,status:g}=await O(`${S}/${d}`,{method:"PUT",body:e},"$Fud06ay483");g.value==="error"&&o.value.statusCode===500?R.error("Erro ao cadastrar ordem,erro no sistema."):(R.success("Ordem Atualizada com sucesso!"),$.push({path:"/os/lista"}))}const{data:v}=([l,_]=U(()=>O(`${q}/${d}`,{method:"GET"},"$wPUkUpDvPf")),l=await l,_(),l);m.value=v.value.numero,s.nacionalidade=v.value.estrangeiro,s.apresentante_cpf=v.value.apresentante_cpf,s.apresentante_nome=v.value.apresentante_nome;const{data:A}=([l,_]=U(()=>O(D,{method:"POST",body:{cartorio_token:G,ordemserv_token:M}},"$YXZ55K3IUf")),l=await l,_(),l);async function j(e){e.excluido=!e.excluido;try{await Ve(`${N}/${e.id}`,{method:"PUT",body:{excluido:e.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}return A.value.length>0?y.value=A.value:y.value=[],(e,o)=>{const g=te,Q=ae,ee=fe("mask");return c(),w(be,{class:"mt-5"},{default:n(()=>[r(h,{class:"mb-5"},{default:n(()=>[o[6]||(o[6]=i("h1",null,"Ordem de Serviço nº",-1)),i("h1",Oe,ge(a(m)),1)]),_:1}),r(h,null,{default:n(()=>[r(x,{md:"3"},{default:n(()=>[r(we,{label:"Nacionalidade",items:H,modelValue:a(s).nacionalidade,"onUpdate:modelValue":o[0]||(o[0]=t=>a(s).nacionalidade=t)},null,8,["modelValue"])]),_:1}),r(x,{md:"2"},{default:n(()=>[a(s).nacionalidade==="brasileiro"?ke((c(),w(C,{key:0,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":o[1]||(o[1]=t=>a(s).apresentante_cpf=t),label:"CPF",required:"","error-messages":a(p).apresentante_cpf.$errors.map(t=>t.$message),onBlur:a(p).apresentante_cpf.$touch,onInput:a(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[ee,"###.###.###-##"]]):(c(),w(C,{key:1,autofocus:"",modelValue:a(s).apresentante_cpf,"onUpdate:modelValue":o[2]||(o[2]=t=>a(s).apresentante_cpf=t),label:"Documento",required:"","error-messages":a(p).apresentante_cpf.$errors.map(t=>t.$message),onBlur:a(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),r(x,{md:"4"},{default:n(()=>[r(C,{modelValue:a(s).apresentante_nome,"onUpdate:modelValue":o[3]||(o[3]=t=>a(s).apresentante_nome=t),label:"Nome Apresentante",required:"","error-messages":a(p).apresentante_nome.$errors.map(t=>t.$message),onInput:a(p).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),r(x,null,{default:n(()=>[i("div",null,[i("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:se,alt:"Salvar",onClick:o[4]||(o[4]=t=>Z())})])]),_:1})]),_:1}),r(h,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:n(()=>[o[10]||(o[10]=i("h1",{class:"ml-5"},"Atos",-1)),r(g,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:a(d),numeroOs:a(m)}}},{default:n(()=>o[7]||(o[7]=[i("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:re,alt:"novo"},null,-1)])),_:1},8,["to"]),r(Ce,{headers:L,items:a(y),"item-key":"id"},{"item.actions":n(({item:t})=>[r(h,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:n(()=>[i("div",{onClick:b=>X(t),title:"Visualizar"},o[8]||(o[8]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ne,alt:"Visualizar"},null,-1)]),8,Re),i("div",{onClick:b=>W(t.token),title:"Reimprimir"},o[9]||(o[9]=[i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:oe,alt:"Reimprimir"},null,-1)]),8,ze),i("div",{class:xe({disabled:!t.btn_editar}),onClick:b=>t.btn_editar?Y({id:t.id,tipo:t.tipo,token:t.token,tipo_token:t.tipo_token,usa_imoveis:t.usa_imoveis}):null,title:t.btn_editar?"Editar":"Desabilitado"},[i("img",{style:he({cursor:t.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ie,alt:"Editar"},null,4)],10,Ae),i("div",{disabled:!t.btn_cancelar,onClick:b=>t.btn_cancelar?j(t):null,title:"Excluir"},[t.excluido?(c(),B("img",Ee)):(c(),B("img",Ue))],8,Te)]),_:2},1024)]),_:1},8,["items"]),r(Q,{show:a(V),ato_token:a(z),onClose:o[5]||(o[5]=t=>V.value=!1)},null,8,["show","ato_token"])]),_:1}),r(g,{to:"/os/lista"},{default:n(()=>[r($e,{size:"large",color:"red"},{default:n(()=>o[11]||(o[11]=[ye("Voltar")])),_:1})]),_:1})]),_:1})}}};export{at as default};
