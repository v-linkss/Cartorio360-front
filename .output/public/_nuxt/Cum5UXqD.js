import{_ as de}from"./BkTsOGem.js";import{_ as pe}from"./sm0KJD1I.js";import{_ as ve}from"./iGIXUYSA.js";import{_ as _e}from"./c7_pipCl.js";import{_ as fe}from"./Z8DPDcMW.js";import{_ as K}from"./BihiicVG.js";import{_ as ke}from"./BVz1G1IN.js";import{_ as he}from"./CmSeCXGh.js";import{a as ye}from"./DJvq3mCv.js";import{D as ge,K as be,u as Ve,r as l,e as k,f as we,y as Pe,c as z,b as t,w as n,i as o,h as xe,p as $e,F as Ce,k as qe,o as x,s as A,a as u,V as Se,d as I}from"./D4TTT1W7.js";import{u as p}from"./Ba190K0z.js";import{V as $}from"./DoZUecvV.js";import{V as v}from"./DTcHBAHn.js";import{V as Fe}from"./CZlWN4e9.js";import{V as U}from"./CBi5QAL_.js";import"./ATtIF7Il.js";import"./Bh8r6zQW.js";import"./DXNOO1nm.js";import"./E275jeRz.js";import"./B0IxRygJ.js";import"./ptg-bBee.js";import"./fyJ3kSFX.js";import"./BCk1WnHR.js";import"./JWDELa0v.js";import"./Mp0mmPmH.js";import"./Cb5yafDH.js";import"./C7tTJSUT.js";import"./LlIE0_mp.js";import"./b-1g2mL4.js";import"./DcuHBYR4.js";import"./BCWf-ZzB.js";import"./CGxorNHl.js";import"./CxtQ8Mey.js";const Te=["onClick"],ze={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:K,alt:"Possui Ficha",title:"Possui Ficha"},Ae={key:1,style:{width:"30px",height:"30px",cursor:"pointer"},src:he,alt:"Visualizar",title:"Não Possui Ficha"},Me=["onClick"],vt={__name:"semelhanca",props:{ato_token:{type:String,required:!0}},emits:["ato-created"],async setup(L,{emit:W}){var D;let h,M;const Q=L,Z=W,O=ge(),R=be(),c=qe(),{$toast:G}=Ve(),H=`${c.public.managemant}/listarEscrevente`,Y=`${c.public.managemant}/pesquisarPessoas`,J=`${c.public.managemant}/atoReconhecimento`,X=`${c.public.managemant}/etiquetaReconhecimento`,ee=`${c.public.managemant}/download`,te=`${c.public.envioDoc}/print`,y=l(k("user-data").value.cartorio_token),oe=l(k("user-service").value.token).value||l(k("user-service").value).value,ae=k("auth_token").value,C=l(!1),q=l([]),E=l([]),_=l([]),g=l(!1),S=l(!1),b=l(!1),V=l(null),N=l(null),F=l(""),B=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],r=we({quantidade:1,escrevente:null,nome:null,documento:null}),{data:j}=([h,M]=Pe(()=>p(H,{method:"POST",body:{cartorio_token:y}},"$iEFsIjdWdW")),h=await h,M(),h);E.value=Array.isArray(j.value)&&((D=j.value[0])==null?void 0:D.func_json_escreventes)||[];async function se(){try{const{data:a,error:e}=await p(Y,{method:"POST",body:{cartorio_token:y.value,documento:r.documento,nome:r.nome}},"$uzKb8LPV3v");a.value.length>0?(q.value=a.value,Z("ato-created")):q.value=[]}catch(a){console.error("Erro na requisição",a)}}const ne=()=>{S.value=!0};function re(a){_.value.push(a)}const le=async a=>{V.value=a,b.value=!0;const{data:e}=await p(ee,{method:"POST",body:{bucket:k("user-data").value.cartorio_token,path:a.link_ficha}},"$MulQmK1LAp");N.value=e.value};function ie(a){_.value=_.value.filter(e=>e.token!==a.token)}async function ue(){var i,d,P,s;if(!r.escrevente){G.error("Por favor selecione um Escrevente");return}if(C.value)return;C.value=!0;const a=_.value.map(T=>({pessoa_token:T.token})),{data:e,error:m,status:f}=await p(J,{method:"POST",body:{pessoas:a,cartorio_token:y.value,ordemserv_token:oe,quantidade:r.quantidade,usuario_token:ae,ato_tipo_token:Q.ato_token}},"$fMGlIlw995");f.value==="success"&&Array.isArray(e.value)&&((i=e.value[0])==null?void 0:i.status)==="OK"?ce(e.value[0].token):(w(),g.value=!0,F.value=Array.isArray(e.value)&&((d=e.value[0])==null?void 0:d.status_mensagem)||((s=(P=m==null?void 0:m.value)==null?void 0:P.data)==null?void 0:s.details)||"Não foi possível concluir o reconhecimento")}async function ce(a){const{data:e,error:m,status:f}=await p(X,{method:"POST",body:{ato_token:a,cartorio_token:y.value,escrevente_token:r.escrevente}},"$oSnYNRtP6Z");if(f.value==="success"){if(e.value[0].tipo_etiqueta==="html"){const i=window.open("","_blank");i.document.open(),i.document.write(e.value[0].etiqueta),i.document.close()}else if(e.value[0].tipo_etiqueta==="zpl"){const{status:i,error:d}=await p(`${te}`,{method:"POST",body:{zpl:atob(e.value[0].etiqueta)}},"$BtUyHn78O6");if(i.value!=="success"){g.value=!0,F.value=d.value.data.message;return}}w()}}const me=()=>{g.value=!1,w()},w=()=>{const a=R.query.origem||"criar",e=R.query.id;a==="atualizar"?O.push(`/os/atualizar/${e}`):O.push("/os/criar-registro")};return(a,e)=>{const m=de,f=pe,i=ve,d=_e,P=fe;return x(),z(Ce,null,[t($,{class:"mt-5"},{default:n(()=>[t(v,{cols:"5"},{default:n(()=>[t(Fe,{label:"Tabelião/escrevente",modelValue:o(r).escrevente,"onUpdate:modelValue":e[0]||(e[0]=s=>o(r).escrevente=s),items:o(E),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),t(v,{cols:"2"},{default:n(()=>[t(A,{label:"Quantidade",type:"number",modelValue:o(r).quantidade,"onUpdate:modelValue":e[1]||(e[1]=s=>o(r).quantidade=s)},null,8,["modelValue"])]),_:1})]),_:1}),t($,null,{default:n(()=>[t(v,{cols:"3"},{default:n(()=>[t(A,{label:"Documento",modelValue:o(r).documento,"onUpdate:modelValue":e[2]||(e[2]=s=>o(r).documento=s)},null,8,["modelValue"])]),_:1}),t(v,{cols:"4"},{default:n(()=>[t(A,{label:"Pessoa",modelValue:o(r).nome,"onUpdate:modelValue":e[3]||(e[3]=s=>o(r).nome=s)},null,8,["modelValue"])]),_:1}),u("div",null,[u("img",{class:"btn-pointer mt-3",src:K,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:se})]),u("div",null,[u("img",{class:"btn-pointer mt-3 ml-2",src:ke,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ne})])]),_:1}),t($,null,{default:n(()=>[t(v,{class:"mr-10"},{default:n(()=>[t(U,{style:{height:"465px"},headers:B,items:o(q)},{"item.actions":n(({item:s})=>[u("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:T=>le(s),title:"Visualizar Ficha"},[s.link_ficha?(x(),z("img",ze)):(x(),z("img",Ae))],8,Te)]),_:1},8,["items"])]),_:1}),t(v,null,{default:n(()=>[t(U,{headers:B,items:o(_),style:{height:"465px"},"item-key":"id"},{"item.actions":n(({item:s})=>[u("div",{style:{display:"flex","justify-content":"flex-end"},onClick:T=>ie(s),title:"Remover"},e[7]||(e[7]=[u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ye,alt:"Remover"},null,-1)]),8,Me)]),_:1},8,["items"])]),_:1})]),_:1}),t(m,{show:o(S),onClose:e[4]||(e[4]=s=>S.value=!1)},null,8,["show"]),o(b)?(x(),xe(f,{key:0,show:o(b),item:o(V),"pessoa-obj":o(V),"link-view":o(N),onConfirmar:e[5]||(e[5]=s=>re(o(V))),onClose:e[6]||(e[6]=s=>b.value=!1)},null,8,["show","item","pessoa-obj","link-view"])):$e("",!0),t($,null,{default:n(()=>[t(i,{onClick:w},{default:n(()=>[t(Se,{size:"large",color:"red"},{default:n(()=>e[8]||(e[8]=[I("Voltar")])),_:1})]),_:1}),t(d,{class:"ml-5",disabled:o(C),onSave:ue,size:"large",color:"green"},{default:n(()=>e[9]||(e[9]=[I("Salvar ")])),_:1},8,["disabled"])]),_:1}),t(P,{show:o(g),errorMessage:o(F),onClose:me},null,8,["show","errorMessage"])],64)}}};export{vt as default};
