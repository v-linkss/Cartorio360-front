import{_ as oe}from"./CHwAms-4.js";import{c as me,r as pe,u as _e}from"./KO9WoVyc.js";import{g as ze,m as Z,M as Q,u as X,r as i,n as C,p as ae,E as te,o as A,y as Y,w as o,b as e,x as t,V as K,G as J,d as F,A as H,I as Me,a as f,c as U,z as ve,O as De,P as Re,F as be,Q as he,t as se}from"./PZ6vFRau.js";import{u as h}from"./DSRPzvMc.js";import{V as M}from"./Bana2MuW.js";import{V as I}from"./wu0ZmgYG.js";import{V as re}from"./DyMvAb8F.js";import{V as le}from"./C21uc_Qx.js";import{_ as Ie}from"./-GeyQmTy.js";import{_ as je,a as Ne,b as Be,T as Ue,W as Fe,D as ke,c as Le,e as We,f as Ge,d as Je}from"./DcHVq5tG.js";import{_ as Ye,r as xe}from"./B2Tgk6XV.js";import{_ as de}from"./CcvMvOX0.js";import{_ as ne}from"./BVz1G1IN.js";import{_ as Ke}from"./DfqwPXGJ.js";import{_ as fe,a as ge}from"./DJvq3mCv.js";import{V as ye}from"./C5ajm9ti.js";import{_ as Ze}from"./C6HhXNnj.js";import{V as Qe}from"./BIV7A5IA.js";import{f as Xe}from"./B0IxRygJ.js";const It={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_tipo_id:{type:Number}},emits:["saved"],async setup(L,{emit:y}){let g,_;const b=L;ze(()=>b.ato_tipo_id,r=>{$.value={id:r}});const V=y,k=Z(),P=Q(),j=H(),{$toast:B}=X(),W=`${j.public.managemant}/listarSituacoes`,S=`${j.public.managemant}/createAtos`;`${j.public.managemant}`;const E=i(C("user-data").value.cartorio_token),x=i(C("user-service").value.id).value||i(C("user-service").value).value,N=i([]),$=i(b.ato_tipo_id?{id:b.ato_tipo_id}:null),v=ae({dt_abertura:null,status:"EM EDIÇÃO",mne:null}),T={status:{required:me.withMessage("O campo é obrigatorio",pe)}},w=_e(T,v);async function D(){if(await w.value.$validate()){const{data:r,error:a,status:d}=await h(S,{method:"POST",body:{ato_tipo_id:$.value.id,cartorio_id:C("user-data").value.cartorio_id,ordemserv_id:x,status:v.status,dt_abertura:v.dt_abertura,mne:v.mne,user_id:C("user-data").value.usuario_id,user_alteracao_id:C("user-data").value.usuario_id}},"$9ZmTYsLk0K");d.value==="success"&&(B.success("Ato registrado com sucesso!"),V("saved",{id:r.value.id,token:r.value.token}))}else B.error("Preencha os campos obrigatorios.")}const{data:R}=([g,_]=te(()=>h(W,{method:"POST",body:{cartorio_token:E.value}},"$hyq5YcBEjF")),g=await g,_(),g);N.value=R.value;const u=()=>{const r=P.query.origem||"criar",a=P.query.id;r==="atualizar"?k.push(`/os/atualizar/${a}`):k.push("/os/criar-registro")};return(r,a)=>{const d=oe;return A(),Y(le,null,{default:o(()=>[e(M,{class:"mt-5"},{default:o(()=>[e(I,{cols:"3"},{default:o(()=>[e(re,{label:"Situação",modelValue:t(v).status,"onUpdate:modelValue":a[0]||(a[0]=m=>t(v).status=m),items:t(N),"item-title":"descricao","item-value":"descricao",required:"","error-messages":t(w).status.$errors.map(m=>m.$message),onBlur:t(w).status.$touch,onInput:t(w).status.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1})]),_:1}),e(M,null,{default:o(()=>[e(I,{cols:"5"},{default:o(()=>[e(K,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:t(v).mne,"onUpdate:modelValue":a[1]||(a[1]=m=>t(v).mne=m)},null,8,["modelValue"])]),_:1})]),_:1}),e(M,null,{default:o(()=>[e(I,{cols:"2"},{default:o(()=>[e(K,{modelValue:t(v).dt_abertura,"onUpdate:modelValue":a[2]||(a[2]=m=>t(v).dt_abertura=m),type:"date",label:"Data Lavratura",disabled:"",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(M,{class:"mb-3"},{default:o(()=>[e(d,{onClick:u},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>a[3]||(a[3]=[F("Voltar")])),_:1})]),_:1}),e(J,{class:"ml-10",onClick:D,size:"large",color:"green"},{default:o(()=>a[4]||(a[4]=[F("Salvar")])),_:1})]),_:1})]),_:1})}}},He=["onClick"],et=["onClick"],tt=["onClick"],ot={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},at={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},st=["onClick"],jt={__name:"Partes",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},async setup(L){let y,g;const _=L,b=Z(),V=Q(),k=H(),{$toast:P}=X(),j=`${k.public.managemant}/pesquisarPessoas`,B=`${k.public.managemant}/listarPapeis`,W=`${k.public.managemant}/download`,S=`${k.public.managemant}/createAtosPessoa`,E=`${k.public.managemant}/getAtosPessoaById`,x=`${k.public.managemant}/updateAtosPessoa`,N=i(C("user-data").value.cartorio_token),$=i([]),v=i({}),T=i([]),w=i([]),D=i(!1),R=i(!1),u=i(!1),r=i(!1),a=i(null),d=i(null),m=i(null),l=i(null);i(null);const p=i(null),q=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome",width:"30%"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome",width:"25%"},{value:"actions"}],s=ae({papeis:null,nome:null,pessoa:null,documento:null});Me(()=>{var c;return((c=s.pessoa)==null?void 0:c.link_ficha)||!1});const{data:G}=([y,g]=te(()=>h(B,{method:"POST",body:{tipo_ato_token:_.ato_token}},"$fFKndZhA4W")),y=await y,g(),y);w.value=G.value;async function ee(){try{const{data:c,error:n}=await h(j,{method:"POST",body:{cartorio_token:N.value,documento:s.documento,nome:s.nome}},"$o3ZL1rvYrY");c.value.length>0?($.value=c.value,s.pessoa=$.value[0]):$.value=[]}catch(c){console.error("Erro na requisição",c)}}const $e=()=>{R.value=!0},we=c=>{T.value=T.value.map(n=>n.id===m.value?{...n,papel:{...n.papel,descricao:c}}:n)},Ce=c=>{const n=T.value.find(O=>O.pessoa.id===l.value);n.representante.nome=c},Ve=async()=>{const c={pessoa:s.pessoa,papel:w.value.find(O=>O.id===s.papeis),representante:{nome:null}},n=await h(`${E}/${_.ato_id}`,{method:"GET"},"$kXSxUa4grs");for(const O of n.data.value)if(O.pessoa_id===s.pessoa.id&&O.ato_id===_.ato_id&&O.tipo_parte_id===s.papeis){P.error("Pessoa Já Registrada Com Esse Papel!");return}try{const{data:O,error:ie,status:ue}=await h(S,{method:"POST",body:{ato_id:Number(_.ato_id),pessoa_id:s.pessoa.id,tipo_parte_id:s.papeis,user_id:Number(C("user-data").value.usuario_id)}},"$So3qnQu7ek");ue.value==="success"?(c.id=O.value.id,P.success("Pessoa Registrada com Sucesso!"),T.value.push(c)):P.error(ie.value.message)}catch{P.error("Erro no servidor. Tente novamente.")}},Pe=async c=>{u.value=!0;const{data:n}=await h(W,{method:"POST",body:{bucket:C("user-data").value.cartorio_token,path:c.pessoa.link_ficha}},"$Q3kbIwtd9t");p.value=n.value,v.value=c.pessoa},Ee=c=>{const n=T.value.filter(O=>O.pessoa.id!==c.pessoa.id).map(O=>({id:O.pessoa.id,nome:O.pessoa.nome}));m.value=c.id,a.value=n,D.value=!0,d.value=c.pessoa.nome,l.value=c.pessoa.id},Ae=c=>{m.value=c.id,r.value=!0,d.value=c.pessoa.nome};async function Se(c){c.excluido=!c.excluido;try{await h(`${x}/${m.value}`,{method:"PUT",body:JSON.stringify({excluido:c.excluido})},"$9xStKwGd7o")}catch(n){console.error("Erro ao excluir pessoa:",n)}}const qe=()=>{const c=V.query.origem||"criar",n=V.query.id;c==="atualizar"?b.push(`/os/atualizar/${n}`):b.push("/os/criar-registro")};return(c,n)=>{const O=Ie,ie=Ne,ue=Be,Te=Ye,Oe=oe;return A(),Y(le,null,{default:o(()=>[e(M,{class:"mt-5"},{default:o(()=>[e(I,{cols:"3"},{default:o(()=>[e(K,{label:"Documento",modelValue:t(s).documento,"onUpdate:modelValue":n[0]||(n[0]=z=>t(s).documento=z)},null,8,["modelValue"])]),_:1}),e(I,{cols:"4"},{default:o(()=>[e(K,{label:"Pessoa",modelValue:t(s).nome,"onUpdate:modelValue":n[1]||(n[1]=z=>t(s).nome=z)},null,8,["modelValue"])]),_:1}),f("div",null,[f("img",{class:"mt-3",src:de,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:ee})]),f("div",null,[f("img",{class:"mt-3 ml-2",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:$e})])]),_:1}),e(M,null,{default:o(()=>[e(I,{cols:"4"},{default:o(()=>[e(re,{label:"Selecione a Pessoa",modelValue:t(s).pessoa,"onUpdate:modelValue":n[2]||(n[2]=z=>t(s).pessoa=z),items:t($),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(I,{cols:"3"},{default:o(()=>[e(re,{label:"Papel",modelValue:t(s).papeis,"onUpdate:modelValue":n[3]||(n[3]=z=>t(s).papeis=z),items:t(w),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),f("div",null,[f("img",{class:"mt-3",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Ve})])]),_:1}),e(M,null,{default:o(()=>[e(I,null,{default:o(()=>[e(ye,{style:{height:"465px"},headers:q,items:t(T)},{"item.actions":o(({item:z})=>[e(M,null,{default:o(()=>[f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>Pe(z),title:"Visualizar Ficha"},n[8]||(n[8]=[f("img",{style:{width:"30px",height:"30px"},src:de,alt:"Visualizar"},null,-1)]),8,He),f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Ae(z),class:"mr-2",title:"Alterar Papel"},n[9]||(n[9]=[f("img",{style:{width:"30px",height:"30px"},src:Ke,alt:"Visualizar"},null,-1)]),8,et),f("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Se(z),title:"Deletar Pessoa"},[z.excluido?(A(),U("img",ot)):(A(),U("img",at))],8,tt),f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>Ee(z),title:"Selecionar Representante"},n[10]||(n[10]=[f("img",{style:{width:"30px",height:"30px"},src:je,alt:"Visualizar"},null,-1)]),8,st)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(O,{show:t(R),onClose:n[4]||(n[4]=z=>R.value=!1)},null,8,["show"]),e(ie,{representante_nome:t(d),representantes:t(a),ato_id:t(m),show:t(D),onClose:n[5]||(n[5]=z=>D.value=!1),onUpdateRepresentante:Ce},null,8,["representante_nome","representantes","ato_id","show"]),e(ue,{representante_nome:t(d),ato_token:_.ato_token,ato_id:t(m),show:t(r),onClose:n[6]||(n[6]=z=>r.value=!1),onUpdatePapel:we},null,8,["representante_nome","ato_token","ato_id","show"]),t(u)?(A(),Y(Te,{key:0,show:t(u),"link-view":t(p),"pessoa-obj":t(v),"is-view":!0,onClose:n[7]||(n[7]=z=>u.value=!1)},null,8,["show","link-view","pessoa-obj"])):ve("",!0),e(M,null,{default:o(()=>[e(Oe,{onClick:qe},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>n[11]||(n[11]=[F("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},rt={key:0,class:"loading-overlay"},nt="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Nt={__name:"Minuta",props:{ato_token:{type:String,required:!0}},emits:["page","doc"],setup(L,{emit:y}){const g=L;De("DocumentEditorContainer",[Ue,Fe]);const _=H(),{$toast:b}=X(),V=Z(),k=Q(),P=y;xe(`${_.public.docEditor}`);const j=`${_.public.managemant}/upload`,B=`${_.public.managemant}/subitituirModelo`,W=`${_.public.managemant}/download`,S=i(null),E=i(!1),x=async u=>{try{const r=await fetch(u);if(!r.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await r.blob()}catch(r){return console.error(r),null}},N=async()=>{const r=await S.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),a=new FileReader;a.onload=()=>{const d=a.result;P("doc",d)},a.readAsText(r)},$=async()=>{E.value=!0;try{const r=await S.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),a=new FormData;a.append("file",r,"anexo.docx"),a.append("cartorio_token",C("user-data").value.cartorio_token),a.append("token",g.ato_token),a.append("tipo","ato_minuta");const{data:d,status:m}=await h(j,{method:"POST",body:a},"$071xxdqs20");if(m.value==="success"){b.success("Documento enviado!");const p=S.value.ej2Instances.documentEditor.pageCount;N(),P("page",p)}else b.error("Erro ao enviar documento para o sistema.")}catch(u){b.error("Erro ao salvar documento."),console.error(u)}finally{E.value=!1}},v=async()=>{D(!0);try{await T(),D(!0);const{data:u,status:r}=await h(B,{method:"POST",body:{ato_token:g.ato_token}},"$0ktpWliD4l");u.value&&w(u.value)}catch(u){console.error("Erro ao gerar a minuta:",u),b.error("Ocorreu um erro ao gerar a minuta.")}finally{D(!1)}},T=async()=>{try{const{data:u}=await h(W,{method:"POST",body:{bucket:C("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$jXVvQjEE6u"),r=await x(u.value);if(r){const a=new FileReader;a.onload=()=>{const d=a.result;S.value.ej2Instances.documentEditor.open(d),P("doc",d)},a.readAsText(r)}}catch(u){console.error("Erro ao carregar o modelo de minuta:",u),b.error("Falha ao carregar o modelo de minuta.")}},w=u=>{const r=S.value.ej2Instances.documentEditor,a=d=>{for(const[m,l]of Object.entries(d))if(/^<<.+>>$/.test(m))try{r.search.findAll(m),r.search.searchResults.length>0&&r.search.searchResults.replaceAll(l)}catch(p){console.error(`Erro ao substituir o marcador ${m}:`,p)}else if(m==="partes"&&Array.isArray(l)&&l.length>0)for(const p of l)typeof p=="object"&&a(p)};a(u)},D=u=>{E.value=u},R=()=>{const u=k.query.origem||"criar",r=k.query.id;u==="atualizar"?V.push(`/os/atualizar/${r}`):V.push("/os/criar-registro")};return(u,r)=>{const a=oe;return A(),U(be,null,[e(t(ke),{height:"900px",ref_key:"documentEditorContainer",ref:S,serviceUrl:nt,enableToolbar:!0,enableWordExport:!0},null,512),t(E)?(A(),U("div",rt,[e(Re,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):ve("",!0),e(M,{class:"ml-4 mt-4 mb-4"},{default:o(()=>[e(a,{class:"mr-4"},{default:o(()=>[e(J,{size:"large",onClick:R,color:"red"},{default:o(()=>r[0]||(r[0]=[F("Voltar")])),_:1})]),_:1}),e(J,{size:"large",color:"green",onClick:$,disabled:t(E)},{default:o(()=>r[1]||(r[1]=[F("Salvar")])),_:1},8,["disabled"]),e(J,{class:"ml-4",size:"large",color:"blue",onClick:v},{default:o(()=>r[2]||(r[2]=[F("Gerar Minuta")])),_:1})]),_:1})],64)}}},lt=["innerHTML"],Bt={__name:"Livro",props:{ato_token:{type:String,required:!0},pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(L){let y,g;const _=L,b=H();xe(`${b.public.docEditor}`);const{$toast:V}=X(),k=Z(),P=Q(),j=`${b.public.managemant}/listarEscrevente`,B=`${b.public.managemant}/lavrarAto`,W=`${b.public.managemant}/ato_calcular`,S=i("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),E=i(!1),x=i(null),N=i(null),$=i(null),v=i(C("user-data").value.cartorio_token),T=C("auth_token").value,w=i([]),D=i({}),R=ae({escrevente:null}),u=async()=>{const{data:q,status:s}=await h(B,{method:"POST",body:{ato_token:_.ato_token,qtd_paginas:_.pages,escrevente_token:R.escrevente,usuario_token:T,cartorio_token:v}},"$ZKnVBNYxp9");if(s.value==="success"){if(q.value[0].tipo_etiqueta==="html")x.value=q.value,N.value=q.value[0].selo;else if(q.value[0].tipo_etiqueta==="zpl"){const{status:G}=await h(`${imprimeZplSelo}`,{method:"POST",body:{zpl:q.value[0].selo}},"$XouuxOFIWh");if(G.value!=="success"){V.error("Não foi possivel fazer a impressao da etiqueta");return}}V.success("Ato lavrado com sucesso!")}else V.error("Falha ao lavrar o ato.")},r=async()=>{const{data:q,status:s}=await h(W,{method:"POST",body:{ato_token:_.ato_token,cartorio_token:v.value,quantidade:1,usuario_token:T,escrevente_token:R.escrevente,qtd_paginas:_.pages}},"$R51FaaSzOI");s.value==="success"?D.value=q.value[0]:V.error("Falha ao calcular o ato.")},a=async()=>{E.value=!1,await u()},d=async()=>{E.value=!0,await r()},{data:m}=([y,g]=te(()=>h(j,{method:"POST",body:{cartorio_token:v}},"$JCPnpnnRzP")),y=await y,g(),y);w.value=m.value[0].func_json_escreventes;const l=function(){$.value.ej2Instances.documentEditor.open(_.document)},p=()=>{const q=P.query.origem||"criar",s=P.query.id;q==="atualizar"?k.push(`/os/atualizar/${s}`):k.push("/os/criar-registro")};return(q,s)=>{const G=Ze;return A(),U(be,null,[e(M,null,{default:o(()=>[e(I,null,{default:o(()=>[(A(),Y(t(ke),{restrictEditing:!0,enableToolbar:!1,created:_.document?l:null,ref_key:"documentEditorContainer",ref:$,height:"850px",width:"850px",key:_.document},null,8,["created"]))]),_:1}),e(I,null,{default:o(()=>[e(re,{class:"mt-15",label:"Tabelião/escrevente",modelValue:t(R).escrevente,"onUpdate:modelValue":s[0]||(s[0]=ee=>t(R).escrevente=ee),items:t(w),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),f("div",null,[f("div",null,[f("img",{onClick:s[1]||(s[1]=ee=>d()),class:"ml-2",style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Le}),t(x)?(A(),Y(Qe,{key:0,class:"mr-16"},{default:o(()=>[e(M,{"no-gutters":""},{default:o(()=>[e(I,null,{default:o(()=>[e(he,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:o(()=>[e(I,null,{default:o(()=>[F(" Livro: "+se(t(x)[0].livro_numero),1)]),_:1}),e(I,null,{default:o(()=>[F(" Protocolo: "+se(t(x)[0].protocolo?t(x)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),e(I,null,{default:o(()=>[e(he,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:o(()=>[F(" Folhas : "+se(t(x)[0].pagina_inicial)+" A "+se(t(x)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),f("div",{innerHTML:t(N)},null,8,lt)]),_:1})):ve("",!0)])])]),_:1})]),_:1}),e(J,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:p},{default:o(()=>s[3]||(s[3]=[F("Voltar")])),_:1}),e(G,{show:t(E),condMessage:t(S),valor:t(D),onClose:s[2]||(s[2]=ee=>E.value=!1),onConfirm:a},null,8,["show","condMessage","valor"])],64)}}},it=["onClick"],ut={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},ct={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ut={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(L){let y,g;const _=L,b=Z(),V=Q(),k=H(),{$toast:P}=X(),j=`${k.public.managemant}/listarEscrevente`,B=`${k.public.managemant}/getAtosTiposByToken`,W=`${k.public.managemant}/atos_observacao`,S=`${k.public.managemant}/atos_observacao`,E=i(C("user-data").value.cartorio_token),x=i([]),N=i([]),$=[{title:"Data",align:"start",key:"data"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],v=ae({observacao:null}),T={observacao:{required:me.withMessage("O campo é obrigatorio",pe)}},w=_e(T,v);[y,g]=te(()=>h(`${B}/${_.ato_token}`,{method:"GET"},"$aJM1TL1buW")),y=await y,g();async function D(){if(await w.value.$validate()){const{data:a,error:d,status:m}=await h(W,{method:"POST",body:{ato_id:_.ato_id,observacao:v.observacao,user_id:C("user-data").value.usuario_id}},"$dMg99jeUNP");m.value==="success"&&(x.value.push({data:Xe(a.value.created,"dd/mm/yyyy hh:mm"),observacao:a.value.observacao,id:a.value.id,escrevente:C("user-data").value.nome}),P.success("Observação registrada com sucesso"))}else P.error("Preencha os campos obrigatorios.")}async function R(a){a.excluido=!a.excluido;try{await h(`${S}/${a.id}`,{method:"PUT",body:JSON.stringify({excluido:a.excluido})},"$B6PdRx8Gp4")}catch(d){console.error("Erro ao excluir observacao:",d)}}const{data:u}=([y,g]=te(()=>h(j,{method:"POST",body:{cartorio_token:E}},"$xFHPGua26S")),y=await y,g(),y);N.value=u.value[0].func_json_escreventes;const r=()=>{const a=V.query.origem||"criar",d=V.query.id;a==="atualizar"?b.push(`/os/atualizar/${d}`):b.push("/os/criar-registro")};return(a,d)=>{const m=oe;return A(),Y(le,null,{default:o(()=>[e(M,{class:"mt-5"},{default:o(()=>[e(K,{label:"Observação",modelValue:t(v).observacao,"onUpdate:modelValue":d[0]||(d[0]=l=>t(v).observacao=l),required:"","error-messages":t(w).observacao.$errors.map(l=>l.$message),onBlur:t(w).observacao.$touch,onInput:t(w).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),f("div",null,[f("img",{class:"btn-pointer ml-2",src:ne,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:D})])]),_:1}),e(M,null,{default:o(()=>[e(I,null,{default:o(()=>[e(ye,{style:{height:"465px"},headers:$,items:t(x)},{"item.actions":o(({item:l})=>[f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:p=>R(l),title:"Deletar Observação"},[l.excluido?(A(),U("img",ut)):(A(),U("img",ct))],8,it)]),_:1},8,["items"])]),_:1})]),_:1}),e(M,null,{default:o(()=>[e(m,{onClick:r},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>d[1]||(d[1]=[F("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},dt={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:We,alt:"Criar"},mt={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ge,alt:"Criar"},pt={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Je,alt:"Criar"},_t=["onClick"],vt=["onClick"],ft=["onClick"],gt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},yt={key:1,src:ge,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ft={__name:"Anexos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},setup(L){const y=L,g=H(),{$toast:_}=X(),b=Z(),V=Q(),k=`${g.public.biometria}/run-scanner`,P=`${g.public.managemant}/atos_anexos`,j=`${g.public.managemant}/atos_anexos`,B=`${g.public.managemant}/download`;`${g.public.managemant}`,`${g.public.managemant}`;const W=i(!1),S=i(null),E=i([]);C("pessoa_token");const x=ae({descricao:"",fileEvent:null}),N={descricao:{required:me.withMessage("O campo é obrigatório",pe)}},$=_e(N,x,{$autoDirty:!0}),v=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}];async function T(){try{await w(),await D()}catch(l){console.error("Erro ao executar scanner ou listar arquivos:",l)}}async function w(){try{const{data:l}=await h(k,{method:"GET"},"$WazoKp68Tw")}catch(l){_.error("Erro ao acionar o scanner:",l)}}async function D(){try{const{data:l,status:p}=await h("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:V.query.ato_token_edit,cartorio_token:C("user-data").value.cartorio_token}},"$03Wxiia3aI")}catch(l){console.error("Erro ao enviar o arquivo:",l)}}const R=async()=>{W.value=!0};function u(l){return l?!0:(console.error("Erro: Nenhum arquivo foi selecionado!"),S.value=!1,!1)}const r=async()=>{if($.value.$touch(),!$.value.$invalid&&u(x.fileEvent)){const{data:l,error:p,status:q}=await h(P,{method:"POST",body:{ato_id:y.ato_id,descricao:x.descricao,user_id:C("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$WyW0hasRPI");q.value==="success"&&(_.success("Anexo registrado com sucesso!"),E.value.push(l.value))}};async function a(l){l.excluido=!l.excluido;try{await h(`${j}/${l.id}`,{method:"PUT",body:JSON.stringify({excluido:l.excluido})},"$Y3y6TjqbSV")}catch(p){console.error("Erro ao excluir pessoa:",p)}}async function d(l){try{const p=await h(`${B}`,{method:"POST",body:{bucket:C("user-data").value.cartorio_token,path:l.link}},"$bkXJSi7s76"),s=await(await fetch(p.data.value)).blob(),G=URL.createObjectURL(s);window.open(G,"_blank")}catch(p){console.error("Erro ao excluir pessoa:",p)}}const m=()=>{const l=V.query.origem||"criar",p=V.query.id;l==="atualizar"?b.push(`/os/atualizar/${p}`):b.push("/os/criar-registro")};return(l,p)=>{const q=oe;return A(),Y(le,null,{default:o(()=>[e(M,null,{default:o(()=>[e(I,{cols:"5",class:"mt-2"},{default:o(()=>[e(K,{modelValue:t(x).descricao,"onUpdate:modelValue":[p[0]||(p[0]=s=>t(x).descricao=s),t($).descricao.$touch],"error-messages":t($).descricao.$errors.map(s=>s.$message),onBlur:t($).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"])]),_:1}),f("div",{onClick:T,title:"Criar",style:{"padding-right":"10px"}},[t(S)===!1?(A(),U("img",dt)):t(S)===!0?(A(),U("img",mt)):(A(),U("img",pt))]),f("div",{onClick:r,title:"Criar"},p[1]||(p[1]=[f("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:ne,alt:"Escanear"},null,-1)]))]),_:1}),e(ye,{headers:v,items:t(E),style:{height:"465px","max-width":"600px"}},{"item.actions":o(({item:s})=>[e(M,null,{default:o(()=>[f("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:G=>R(s),title:"Visualizar Anexo"},[f("img",{style:{width:"30px",height:"30px"},onClick:G=>d(s),src:de,alt:"Visualizar"},null,8,vt)],8,_t),f("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:G=>a(s),title:"Deletar Pessoa"},[s.excluido?(A(),U("img",gt)):(A(),U("img",yt))],8,ft)]),_:2},1024)]),_:1},8,["items"]),e(q,{onClick:m},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>p[2]||(p[2]=[F("Voltar")])),_:1})]),_:1})]),_:1})}}};export{It as _,jt as a,Nt as b,Bt as c,Ut as d,Ft as e};
