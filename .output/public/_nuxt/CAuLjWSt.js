import{_ as q}from"./CZeTZmue.js";import{P as A,Q as N,R as E,b as e,S as I,T as G,U as B,W as D,X as F,A as L,Y as j,Z as J,$ as h,F as M,a0 as W,u as Y,e as P,f as z,r as H,m as Q,h as X,w as t,k as Z,o as $,a as u,q as O,s as w,i,c as K,d as T,a1 as ee,t as ae,p as oe}from"./czsslhLh.js";import{V as te}from"./BiVaMwpv.js";import{V as b}from"./CZhpwwnu.js";import{V as r}from"./CpY2pdlu.js";import{V as x}from"./BEWMfxr-.js";import{m as le,V as U,a as se,b as ne}from"./crmYuR1w.js";const re=A({...le({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),p=N()({name:"VRadio",props:re(),setup(s,y){let{slots:m}=y;return E(()=>e(U,I(s,{class:["v-radio",s.class],style:s.style,type:"radio"}),m)),{}}}),ie=A({height:{type:[Number,String],default:"auto"},...G(),...B(se(),["multiple"]),trueIcon:{type:D,default:"$radioOn"},falseIcon:{type:D,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),de=N()({name:"VRadioGroup",inheritAttrs:!1,props:ie(),emits:{"update:modelValue":s=>!0},setup(s,y){let{attrs:m,slots:v}=y;const R=F(),V=L(()=>s.id||`radio-group-${R}`),o=j(s,"modelValue");return E(()=>{const[_,g]=J(m),C=h.filterProps(s),S=U.filterProps(s),l=v.label?v.label({label:s.label,props:{for:V.value}}):s.label;return e(h,I({class:["v-radio-group",s.class],style:s.style},_,C,{modelValue:o.value,"onUpdate:modelValue":a=>o.value=a,id:V.value}),{...v,default:a=>{let{id:n,messagesId:c,isDisabled:d,isReadonly:k}=a;return e(M,null,[l&&e(W,{id:n.value},{default:()=>[l]}),e(ne,I(S,{id:n.value,"aria-describedby":c.value,defaultsTarget:"VRadio",trueIcon:s.trueIcon,falseIcon:s.falseIcon,type:s.type,disabled:d.value,readonly:k.value,"aria-labelledby":l?n.value:void 0,multiple:!1},g,{modelValue:o.value,"onUpdate:modelValue":f=>o.value=f}),v)])}})}),{}}}),ue={class:"mb-6"},ce={class:"mb-6"},me={class:"mb-4"},fe={key:0,class:"mt-6"},pe={class:"bg-success text-white pa-4 mb-4 rounded"},ve={class:"bg-grey-lighten-4 pa-4 rounded"},Se={__name:"censec",setup(s){const y=Z(),{$toast:m}=Y(),v=`${y.public.auth}/service/gerencia/integra_censec`,V=P("auth_token").value,o=z({data_inicial:g(),data_final:g(),validar:null,file_name:""}),_=H(null);function g(){const l=new Date,a=l.getFullYear(),n=String(l.getMonth()+1).padStart(2,"0");return`${String(l.getDate()).padStart(2,"0")}-${n}-${a}`}function C(l){if(!l)return null;const[a,n,c]=l.split("/");return`${c}-${n}-${a}`}const S=async()=>{if(!o.validar){m.warning("Selecione um tipo de validação antes de enviar!");return}try{const l=await fetch(`${v}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${V}`},body:JSON.stringify({cartorio_token:P("user-data").value.cartorio_token,data_inicial:C(o.data_inicial),data_final:C(o.data_final),validar:o.validar,file_name:o.file_name})});if(!l.ok)throw new Error(`Erro ao gerar dados (HTTP ${l.status})`);if(o.validar==="ATOS"){const a=await l.text(),n=window.open("","_blank");n?(n.document.open(),n.document.write(a),n.document.close()):m.warning("Não foi possível abrir a nova aba (bloqueador de pop-up?).")}else{if(!o.file_name){m.warning("Digite o nome do arquivo!");return}const a=await l.blob(),n=l.headers.get("Content-Disposition"),c=n&&n.match(/filename="(.+)"/),d=c?c[1]:`${o.file_name}.json`,k=window.URL.createObjectURL(a),f=document.createElement("a");f.href=k,f.download=d,document.body.appendChild(f),f.click(),f.remove(),window.URL.revokeObjectURL(k),m.success("Arquivo baixado com sucesso!")}}catch(l){console.error(l),m.error("Erro ao processar a requisição.")}};return(l,a)=>{const n=q,c=Q("mask");return $(),X(te,{class:"mt-5"},{default:t(()=>[e(b,{class:"mb-10"},{default:t(()=>a[4]||(a[4]=[u("h1",null,"Integrações Centrais",-1)])),_:1}),u("div",null,[u("div",ue,[a[5]||(a[5]=u("h3",{class:"text-h6 mb-2"},"Período de Consulta",-1)),e(b,null,{default:t(()=>[e(r,{cols:"12",md:"2"},{default:t(()=>[O(e(w,{modelValue:i(o).data_inicial,"onUpdate:modelValue":a[0]||(a[0]=d=>i(o).data_inicial=d),label:"Data Inicio",placeholder:"dd/mm/yyyy"},null,8,["modelValue"]),[[c,"##/##/####"]])]),_:1}),e(r,{cols:"12",md:"2"},{default:t(()=>[O(e(w,{modelValue:i(o).data_final,"onUpdate:modelValue":a[1]||(a[1]=d=>i(o).data_final=d),label:"Data Fim",placeholder:"dd/mm/yyyy"},null,8,["modelValue"]),[[c,"##/##/####"]])]),_:1})]),_:1})]),e(x,{class:"my-6"}),u("div",ce,[e(b,null,{default:t(()=>[e(r,{cols:"12",sm:"6",md:"4"}),e(r,{cols:"12",sm:"6",md:"4"},{default:t(()=>a[6]||(a[6]=[u("h3",{class:"text-h6 mb-4"},"Gerar Arquivo",-1)])),_:1})]),_:1}),e(de,{modelValue:i(o).validar,"onUpdate:modelValue":a[2]||(a[2]=d=>i(o).validar=d),class:"mt-2"},{default:t(()=>[e(b,null,{default:t(()=>[e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:t(()=>[e(p,{label:"VALIDAR ATOS",value:"ATOS",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:t(()=>[e(p,{label:"CESDI",value:"CESDI",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:t(()=>[e(p,{label:"CEP",value:"CEP",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:t(()=>[e(p,{label:"RCTO",value:"RCTO",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:t(()=>[e(p,{label:"CCN",value:"CCN",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:t(()=>[e(p,{label:"CTP",value:"CTP",color:"primary"})]),_:1}),e(r,{cols:"12",sm:"6",md:"4",lg:"2-4"},{default:t(()=>[e(p,{label:"DOI",value:"DOI",color:"primary"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e(x,{class:"my-6"}),u("div",me,[a[7]||(a[7]=u("h3",{class:"text-h6 mb-4"},"Arquivo",-1)),e(b,{align:"center"},{default:t(()=>[e(r,{cols:"12",md:"8"},{default:t(()=>[e(w,{label:"Nome do arquivo",modelValue:i(o).file_name,"onUpdate:modelValue":a[3]||(a[3]=d=>i(o).file_name=d),disabled:!i(o).validar||i(o).validar==="ATOS"},null,8,["modelValue","disabled"])]),_:1}),e(r,{cols:"12",md:"4",class:"d-flex justify-end"},{default:t(()=>[e(n,{text:"Enviar",onSave:S,class:"px-8"})]),_:1})]),_:1})])]),i(_)?($(),K("div",fe,[u("div",pe,[e(ee,{class:"mr-2"},{default:t(()=>a[8]||(a[8]=[T("mdi-check-circle")])),_:1}),a[9]||(a[9]=T(" Dados CENSEC Retornados "))]),u("div",ve,[u("pre",null,ae(JSON.stringify(i(_),null,2)),1)])])):oe("",!0)]),_:1})}}};export{Se as default};
