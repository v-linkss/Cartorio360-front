import{_ as Z,a as ee,u as ae}from"./B-4QaJQ5.js";import{_ as oe,C as te,u as se,r as i,z as le,j as p,w as s,l as re,o as g,b as o,a as R,V as N,i as r,A as b,v as m,P as ie,d,L as w,k as x,t as ne,e as U}from"./C3EzsdaB.js";import{f as B}from"./CQuHdUfB.js";import{u as K}from"./Baqe95jG.js";import{V as ue}from"./Cs3frXH_.js";import{V as de}from"./mXMVbKbw.js";import{V as j}from"./Dz_zOZgi.js";import{V as q}from"./Bo8LH7j2.js";import{V as _,a as ce,b as me,c as fe}from"./CtgG7iLN.js";import{V as ve}from"./CoaXqZL9.js";import"./BfoMKKm1.js";import"./o_hRetb8.js";const pe={__name:"index",setup(ge){const D=te(),{$toast:V}=se(),E=i({senha:"",email:""});i(!1);const c=i(!1),$=i(!1),O=i(!1),P=i(!1),k=i(!1),f=i(!1),C=i("");i(""),i(""),i(!1);const h=()=>{$.value=!1,O.value=!1,k.value=!1,P.value=!1,c.value=!1},T=re(),L=`${T.public.auth}/service/gerencia/listarMenu`,z=T.public.auth,A=T.public.managemant,v=i(!1),S=i(""),F=async()=>{const{data:t,status:e,error:l}=await B(`${z}/login`,{method:"POST",body:{senha:E.value.senha,email:E.value.email}});return{data:t==null?void 0:t.value,status:e==null?void 0:e.value,error:l==null?void 0:l.value}},W=t=>{const e=U("user-data");e.value=JSON.stringify({nome:t.nome,usuario_id:t.id,cartorio_id:t.cartorios[0].cartorio_id,cartorio_nome:t.cartorios[0].cartorio_descricao,cartorio_token:t.cartorios[0].cartorio_token});const l=U("auth_token");l.value=t.token},I=t=>{var a,n,u;const e=(u=(n=(a=t==null?void 0:t.data)==null?void 0:a[0])==null?void 0:n.func_autentica_acesso_v1)==null?void 0:u[0],l=e==null?void 0:e.status_mensagem;if(!e){k.value=!0;return}switch(l){case"Esse email não está cadastrado no Durabil.":O.value=!0;break;case"Senha inválida.":$.value=!0;break;case"Seu cadastro está desativado. Entre em contato com o administrador da conta.":P.value=!0;break;default:k.value=!0;break}},J=async()=>{var a,n,u,M;const{data:t,status:e,error:l}=await F();if(e==="success"){const y=(M=(u=(n=(a=t==null?void 0:t[0])==null?void 0:a.func_autentica_acesso_v1)==null?void 0:n[0])==null?void 0:u.registro)==null?void 0:M[0];if(ae().cartorioInfos=y,W(y),y.cartorios.length>1){D.push({path:"/login/tipo-perfil"});return}V.success("Login realizado com sucesso!");const{data:H,status:Q}=await B(L,{method:"POST",body:{usuario_id:y.id,perfil_descricao:y.cartorios[0].perfil_descricao}});if(Q.value==="success"){const X=U("menu-navbar");X.value=H.value,D.push({path:"/"})}}else e==="error"&&(l==null?void 0:l.statusCode)===500?k.value=!0:I(l)},Y=async()=>{var a,n,u;const{data:t,status:e,error:l}=await K(`${A}/recupera_senha`,{method:"POST",body:{email:C.value,acao:"gerar"}},"$6PqqSha0mY");e.value==="success"?(V.success(t.value.message||"Código enviado"),v.value=!0):V.error(((u=(n=(a=l.value)==null?void 0:a.data)==null?void 0:n.menssage)==null?void 0:u.details)||"Erro desconhecido")},G=async()=>{var a,n,u;const{data:t,status:e,error:l}=await K(`${A}/verifica_codigo_recuperacao`,{method:"POST",body:{email:C.value,code:S.value}},"$CjDuMrRaWR");e.value==="success"?(V.success(t.value.message||"Código verificado com sucesso"),f.value=!1):V.error(((u=(n=(a=l.value)==null?void 0:a.data)==null?void 0:n.menssage)==null?void 0:u.details)||"Código inválido")};return(t,e)=>{const l=le("center");return g(),p(ue,{style:{"background-color":"#0a063b"}},{default:s(()=>[o(ve,{cols:"5",class:"d-flex align-center justify-center"},{default:s(()=>[o(de,{style:{"max-width":"650px"}},{default:s(()=>[o(l,null,{default:s(()=>[o(j,{style:{"margin-bottom":"30px"},width:400,height:330,src:Z})]),_:1}),e[14]||(e[14]=R("div",{class:"text"},"Login",-1)),o(N,{autofocus:"",autocomplete:"email",type:"email",modelValue:r(E).email,"onUpdate:modelValue":e[0]||(e[0]=a=>r(E).email=a),"persistent-hint":"",class:"input mb-5",style:{"background-color":"aliceblue"},"hide-details":"",density:"compact",placeholder:"Email","prepend-inner-icon":"mdi-email-outline",variant:"outlined"},null,8,["modelValue"]),o(q,{modelValue:r(c),"onUpdate:modelValue":e[2]||(e[2]=a=>b(c)?c.value=a:null),"max-width":"400",persistent:""},{activator:s(({props:a})=>[o(m,ie({rounded:"",class:"mb-10 mt-4 ml-1"},a,{color:"primary",onClick:J,modelValue:r(c),"onUpdate:modelValue":e[1]||(e[1]=n=>b(c)?c.value=n:null),block:""}),{default:s(()=>e[9]||(e[9]=[d(" Acessar ")])),_:2},1040,["modelValue"])]),default:s(()=>[r($)?(g(),p(_,{key:0,text:"Senha inválida."},{actions:s(()=>[o(w),o(m,{onClick:h,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[10]||(e[10]=[d(" OK ")])),_:1})]),_:1})):x("",!0),r(O)?(g(),p(_,{key:1,text:"Esse email não está cadastrado."},{actions:s(()=>[o(w),o(m,{onClick:h,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[11]||(e[11]=[d(" OK ")])),_:1})]),_:1})):x("",!0),r(k)?(g(),p(_,{key:2,text:"Erro no sistema, fora do ar."},{actions:s(()=>[o(w),o(m,{onClick:h,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[12]||(e[12]=[d(" OK ")])),_:1})]),_:1})):x("",!0),r(P)?(g(),p(_,{key:3,text:"Seu cadastro está desativado. Entre em contato com o administrador da conta."},{actions:s(()=>[o(w),o(m,{onClick:h,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[13]||(e[13]=[d(" OK ")])),_:1})]),_:1})):x("",!0)]),_:1},8,["modelValue"]),R("div",null,[R("a",{class:"text-decoration-none",rel:"noopener noreferrer",style:{color:"white","margin-left":"10px"},onClick:e[3]||(e[3]=a=>f.value=!0)}," Esqueceu a senha? ")])]),_:1})]),_:1}),o(j,{src:ee,cover:""}),o(q,{modelValue:r(f),"onUpdate:modelValue":e[8]||(e[8]=a=>b(f)?f.value=a:null),"max-width":"500"},{default:s(()=>[o(_,null,{default:s(()=>[o(ce,null,{default:s(()=>e[15]||(e[15]=[d("Recuperar senha")])),_:1}),o(me,null,{default:s(()=>[e[16]||(e[16]=d(" ' ")),o(N,{modelValue:r(C),"onUpdate:modelValue":e[4]||(e[4]=a=>b(C)?C.value=a:null),readonly:r(v),type:"email",label:"Digite seu email","prepend-inner-icon":"mdi-email-outline"},null,8,["modelValue","readonly"]),r(v)?(g(),p(N,{key:0,modelValue:r(S),"onUpdate:modelValue":e[5]||(e[5]=a=>b(S)?S.value=a:null),label:"Código de verificação","prepend-inner-icon":"mdi-numeric"},null,8,["modelValue"])):x("",!0)]),_:1}),e[18]||(e[18]=d("' ")),o(fe,null,{default:s(()=>[o(w),o(m,{class:"bg-green text-white",onClick:e[6]||(e[6]=a=>r(v)?G():Y())},{default:s(()=>[d(ne(r(v)?"Confirmar":"Enviar"),1)]),_:1}),o(m,{class:"bg-red text-white",onClick:e[7]||(e[7]=a=>{f.value=!1,v.value=!1})},{default:s(()=>e[17]||(e[17]=[d(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Oe=oe(pe,[["__scopeId","data-v-2afb789f"]]);export{Oe as default};
