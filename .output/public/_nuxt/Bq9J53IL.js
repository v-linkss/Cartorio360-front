import{_ as le}from"./DbFvZTU7.js";import{_ as ne,a as ie}from"./CZQsysPE.js";import{v as ue,r as i,E as o,H as de,I as ce,o as m,n as g,w as l,z as me,J as pe,b as n,a as u,t as _e,u as a,K as ve,x as O,D as L,M as fe,N as ge,c as M,L as be,A as he,d as Ve}from"./CFcBe-yA.js";import{u as S}from"./CDwlmSQU.js";import"./CdzR0sAs.js";import{_ as ke}from"./37abXc2X.js";import{_ as ye,a as Ce}from"./CrE-eFFQ.js";import{_ as xe,a as $e}from"./qu7Wfn_m.js";import{c as H,r as J,u as we}from"./DqTKjiDo.js";import{V as Oe}from"./DwUsCwiJ.js";import{V}from"./Cx_6yMhL.js";import{V as k}from"./CbgXJoUh.js";import{V as Se}from"./vK6uN0iN.js";import"./BPEHqanc.js";import"./Bf4Xil6f.js";const De=u("h1",null,"Ordem de Serviço nº ",-1),Ee={style:{color:"red","margin-left":"30px"}},Ne=u("h1",{class:"ml-5"},"Atos",-1),Re=u("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:ye,alt:"novo"},null,-1),Te=u("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ie,alt:"Reimprimir"},null,-1),Be=[Te],Ae=["onClick","title"],Fe=["disabled","onClick"],qe={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:$e,alt:"Visualizar",title:"Reativar"},Ie={key:1,src:Ce,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},aa={__name:"criar-registro",async setup(Pe){var B,A,F,q,I,P,U;let b,D;const{$toast:_}=ue(),y=me(),j=`${y.public.managemant}/createOrdensServico`,G=`${y.public.managemant}/validarCpf`,K=`${y.public.managemant}/listarAtos`,W=i(o("user-data").value.cartorio_id),X=i(o("user-data").value.usuario_id),Q=i((B=o("user-service").value)==null?void 0:B.token).value||null,Y=i(o("user-data").value.cartorio_token).value,E=i((A=o("user-service").value)==null?void 0:A.numero),h=i((F=o("user-service").value)==null?void 0:F.isDisabled);let N=i(!!((q=o("user-service").value)!=null&&q.numero)),C=i(o("ordem-button").value),x=!1;const $=i(!1),w=i([]),r=de({nacionalidade:((I=o("user-service").value)==null?void 0:I.estrangeiro)||!1,apresentante_nome:(P=o("user-service").value)==null?void 0:P.apresentante_nome,apresentante_cpf:(U=o("user-service").value)==null?void 0:U.apresentante_cpf}),v=i(!1),Z=[{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],ee=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],ae={apresentante_nome:{required:H.withMessage("O campo é obrigatorio",J)},apresentante_cpf:{required:H.withMessage("O campo é obrigatorio",J)}},c=we(ae,r);function R(s){if(s)return s.replace(/[.\-]/g,"");s=null}function te(){const s=o("user-service"),t=o("ordem-button");s.value=null,t.value=null}const oe=()=>{$.value=!0};async function re(){const s={apresentante_cpf:R(r.apresentante_cpf),apresentante_nome:r.apresentante_nome,user_id:X.value,cartorio_id:W.value,estrangeiro:r.nacionalidade};if(await c.value.$validate()){const{data:t,error:p,status:d}=await S(j,{method:"POST",body:s},"$HqnOwnLBio");if(d.value==="error"&&p.value.statusCode===500)_.error("Erro ao cadastrar ordem,erro no sistema.");else{_.success("Ordem registrada com sucesso!"),N.value=!0,C.value=!1,E.value=t.value.numero;const f=o("ordem-button");f.value=C.value;const e=o("user-service");e.value=e.value=JSON.stringify({numero:t.value.numero,id:t.value.id,apresentante_cpf:t.value.apresentante_cpf,apresentante_nome:t.value.apresentante_nome,estrangeiro:t.value.estrangeiro,token:t.value.token,isDisabled:!0}),v.value=!0}}}async function se(s){const t=R(s);if(t.length===11&&!x){x=!0;const p={cpf:t};try{const{data:d,error:f,status:e}=await S(G,{method:"POST",body:p},"$DfuVr7OuaN");e.value==="error"&&f.value.statusCode===500?_.error("Erro ao cadastrar pessoa, o CPF já está cadastrado."):d.value.cpfValidation===!0?(r.apresentante_nome=d.value.nome,_.success("Cpf autenticado com sucesso!")):d.value.cpfValidation===!1&&_.error("Cpf não cadastrado!")}catch(d){console.error("Erro ao validar CPF:",d)}finally{x=!1}}}const{data:T}=([b,D]=ce(()=>S(K,{method:"POST",body:{cartorio_token:Y,ordemserv_token:Q}},"$bJ1XcDsWLH")),b=await b,D(),b);return T.value.length>0?w.value=T.value:w.value=[],(s,t)=>{const p=le,d=ne,f=pe("mask");return m(),g(Oe,{class:"mt-5"},{default:l(()=>[n(V,{class:"mb-5"},{default:l(()=>{var e;return[De,u("h1",Ee,_e(a(E)||((e=("useCookie"in s?s.useCookie:a(o))("user-service").value)==null?void 0:e.numero)),1)]}),_:1}),n(V,null,{default:l(()=>[n(k,{md:"3"},{default:l(()=>[n(Se,{label:"Nacionalidade",items:ee,modelValue:a(r).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>a(r).nacionalidade=e),disabled:a(h)||a(v)},null,8,["modelValue","disabled"])]),_:1}),n(k,{md:"2"},{default:l(()=>[a(r).nacionalidade===!1?ve((m(),g(O,{key:0,autofocus:"",modelValue:a(r).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>a(r).apresentante_cpf=e),label:"CPF",required:"","error-messages":a(c).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(c).apresentante_cpf.$touch,onInput:t[2]||(t[2]=e=>se(a(r).apresentante_cpf)),disabled:a(h)||a(v)},null,8,["modelValue","error-messages","onBlur","disabled"])),[[f,"###.###.###-##"]]):(m(),g(O,{key:1,autofocus:"",modelValue:a(r).apresentante_cpf,"onUpdate:modelValue":t[3]||(t[3]=e=>a(r).apresentante_cpf=e),label:"Documento",required:"","error-messages":a(c).apresentante_cpf.$errors.map(e=>e.$message),onBlur:a(c).apresentante_cpf.$touch,disabled:a(h)||a(v)},null,8,["modelValue","error-messages","onBlur","disabled"]))]),_:1}),n(k,{md:"4"},{default:l(()=>[n(O,{modelValue:a(r).apresentante_nome,"onUpdate:modelValue":t[4]||(t[4]=e=>a(r).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":a(c).apresentante_nome.$errors.map(e=>e.$message),onInput:a(c).apresentante_nome.$touch,disabled:a(h)||a(v)},null,8,["modelValue","error-messages","onInput","disabled"])]),_:1}),a(C)?(m(),g(k,{key:0},{default:l(()=>[u("div",null,[u("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:ke,alt:"Salvar",onClick:t[5]||(t[5]=e=>re())})])]),_:1})):L("",!0)]),_:1}),a(N)?(m(),g(V,{key:0,style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:l(()=>[Ne,n(p,{to:{path:"/os/criar-ato",query:{origem:"criar"}}},{default:l(()=>[Re]),_:1}),n(be,{headers:Z,items:a(w),"item-key":"id"},{"item.actions":l(({item:e})=>[n(V,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:l(()=>[u("div",{onClick:t[6]||(t[6]=z=>oe()),title:"Reimprimir"},Be),u("div",{class:ge({disabled:!e.btn_editar}),onClick:z=>e.btn_editar?s.redirectToUpdate(e.id):null,title:e.btn_editar?"Editar":"Desabilitado"},[u("img",{style:fe({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:xe,alt:"Editar"},null,4)],10,Ae),u("div",{disabled:!e.btn_cancelar,onClick:z=>e.btn_cancelar?s.deleteEndereco(e):null,title:"Excluir"},[e.excluido?(m(),M("img",qe)):(m(),M("img",Ie))],8,Fe)]),_:2},1024)]),_:1},8,["items"]),n(d,{show:a($),onClose:t[7]||(t[7]=e=>$.value=!1)},null,8,["show"])]),_:1})):L("",!0),n(p,{to:"/os/lista"},{default:l(()=>[n(he,{size:"large",color:"red",onClick:te},{default:l(()=>[Ve("Voltar")]),_:1})]),_:1})]),_:1})}}};export{aa as default};
