import{_ as X}from"./D5mCQR8p.js";import{n as ee,q as te,u as ae,r as l,A as q,s as oe,B as Z,o as _,v as w,w as a,b as e,x as t,V as Y,y as W,d as D,z as se,a as d,C as ue,c as G,D as Q,E as Ee,F as Oe,I as M}from"./DzzstydT.js";import{u as k}from"./Bftbo3xK.js";import{c as ve,r as fe,u as ge}from"./aGVAPUeD.js";import{V as C}from"./C4PLOs_7.js";import{V as F}from"./D1UnOdqG.js";import{V as ie}from"./DLJolKcC.js";import{V as re}from"./jnWAYyfk.js";import{_ as ze}from"./BNxvhN6M.js";import{_ as Re,a as Ue,b as De,c as Be,d as Ie,e as Ne}from"./DNzMQX9g.js";import{_ as ce}from"./Dtn0WEdU.js";import{_ as H,a as de}from"./HBU26js5.js";import{_ as pe,a as Me}from"./BINKDG73.js";import{V as ye,a as me}from"./9HXe_a2c.js";import{_ as Fe}from"./DfjuBLsA.js";import{V as je,a as J,b as Le,c as K}from"./Bg_NBlKt.js";import"./zRqxYRKE.js";const We={__name:"Dados",props:{ato_token:{type:String,required:!0}},emits:["saved"],async setup(j,{emit:v}){let n,f;const A=j,T=v,p=ee(),m=te(),E=se(),{$toast:V}=ae(),B=`${E.public.managemant}/listarSituacoes`,z=`${E.public.managemant}/createAtos`,P=`${E.public.managemant}/getAtosTiposByToken`,$=l(q("user-data").value.cartorio_token),L=l(q("user-service").value.id).value||l(q("user-service").value).value,S=l([]),i=oe({dt_abertura:null,status:null,mne:null}),O={status:{required:ve.withMessage("O campo é obrigatorio",fe)}},x=ge(O,i),{data:R}=([n,f]=Z(()=>k(`${P}/${A.ato_token}`,{method:"GET"},"$9ZmTYsLk0K")),n=await n,f(),n);async function s(){if(await x.value.$validate()){const{data:r,error:c,status:N}=await k(z,{method:"POST",body:{ato_tipo_id:R.value.id,cartorio_id:q("user-data").value.cartorio_id,ordemserv_id:L,status:i.status,dt_abertura:i.dt_abertura,mne:i.mne,user_id:q("user-data").value.usuario_id,user_alteracao_id:q("user-data").value.usuario_id}},"$hyq5YcBEjF");N.value==="success"&&(V.success("Situação registrada com sucesso"),T("saved",{id:r.value.id,token:r.value.token}))}else V.error("Preencha os campos obrigatorios.")}const{data:g}=([n,f]=Z(()=>k(B,{method:"POST",body:{cartorio_token:$.value}},"$S3qwbpImEh")),n=await n,f(),n);S.value=g.value;const I=()=>{const r=m.query.origem||"criar",c=m.query.id;r==="atualizar"?p.push(`/os/atualizar/${c}`):p.push("/os/criar-registro")};return(r,c)=>{const N=X;return _(),w(re,null,{default:a(()=>[e(C,{class:"mt-5"},{default:a(()=>[e(F,{cols:"3"},{default:a(()=>[e(ie,{label:"Situação",modelValue:t(i).status,"onUpdate:modelValue":c[0]||(c[0]=y=>t(i).status=y),items:t(S),"item-title":"descricao","item-value":"descricao",required:"","error-messages":t(x).status.$errors.map(y=>y.$message),onBlur:t(x).status.$touch,onInput:t(x).status.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1})]),_:1}),e(C,null,{default:a(()=>[e(F,{cols:"5"},{default:a(()=>[e(Y,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:t(i).mne,"onUpdate:modelValue":c[1]||(c[1]=y=>t(i).mne=y)},null,8,["modelValue"])]),_:1})]),_:1}),e(C,null,{default:a(()=>[e(F,{cols:"2"},{default:a(()=>[e(Y,{modelValue:t(i).dt_abertura,"onUpdate:modelValue":c[2]||(c[2]=y=>t(i).dt_abertura=y),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(C,{class:"mb-3"},{default:a(()=>[e(N,{onClick:I},{default:a(()=>[e(W,{size:"large",color:"red"},{default:a(()=>[D("Voltar")]),_:1})]),_:1}),e(W,{class:"ml-10",onClick:s,size:"large",color:"green"},{default:a(()=>[D("Salvar")]),_:1})]),_:1})]),_:1})}}},Ge=["onClick"],Je=d("img",{style:{width:"30px",height:"30px"},src:ce,alt:"Visualizar"},null,-1),Ke=[Je],Ye=["onClick"],Ze=d("img",{style:{width:"30px",height:"30px"},src:Me,alt:"Visualizar"},null,-1),Qe=[Ze],He=["onClick"],Xe={key:0,style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar",title:"Reativar"},et={key:1,src:de,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},tt=["onClick"],at=d("img",{style:{width:"30px",height:"30px"},src:De,alt:"Visualizar"},null,-1),ot=[at],st={__name:"Partes",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},async setup(j){let v,n;const f=j,A=ee(),T=te(),p=se(),{$toast:m}=ae(),E=`${p.public.managemant}/pesquisarPessoas`,V=`${p.public.managemant}/listarPapeis`,B=`${p.public.managemant}/getLinkTipo`,z=`${p.public.managemant}/createAtosPessoa`,P=`${p.public.managemant}/getAtosPessoaById`,$=`${p.public.managemant}/updateAtosPessoa`,L=l(q("user-data").value.cartorio_token),S=l([]),i=l([]),O=l([]),x=l(!1),R=l(!1),s=l(!1),g=l(!1),I=l(null),r=l(null),c=l(null),N=l(null),y=l(null),_e=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],b=oe({papeis:null,nome:null,pessoa:null,documento:null}),{data:he}=([v,n]=Z(()=>k(V,{method:"POST",body:{tipo_ato_token:f.ato_token}},"$fFKndZhA4W")),v=await v,n(),v);O.value=he.value,console.log(`###############
`,O.value);async function xe(){try{const{data:u,error:o}=await k(E,{method:"POST",body:{cartorio_token:L.value,documento:b.documento,nome:b.nome}},"$o3ZL1rvYrY");u.value.length>0?(S.value=u.value,b.pessoa=S.value[0]):S.value=[]}catch(u){console.error("Erro na requisição",u)}}const ke=()=>{R.value=!0},be=u=>{const o=i.value.find(U=>U.papel.id===b.papeis);o.papel.descricao=u},$e=u=>{const o=i.value.find(U=>U.pessoa.id===N.value);o.representante.nome=u},Ve=async()=>{const u={pessoa:b.pessoa,papel:O.value.find(o=>o.id===b.papeis),representante:{nome:null}};await k(`${P}/${f.ato_id}`,{method:"GET"},"$kXSxUa4grs");try{const{data:o,error:U,status:le}=await k(z,{method:"POST",body:{ato_id:f.ato_id,pessoa_id:b.pessoa.id,tipo_parte_id:b.papeis,user_id:q("user-data").value.usuario_id}},"$So3qnQu7ek");le.value==="success"?(c.value=o.value.id,m.success("Pessoa Registrada com Sucesso!"),i.value.push(u)):m.error(o.details)}catch(o){console.error("Erro ao criar representante:",o),m.error("Erro no servidor. Tente novamente.")}},Pe=async u=>{s.value=!0,y.value=null;const{data:o}=await k(`${B}`,{method:"POST",body:{id:u.pessoa.id,tipo:"ficha"}},"$Q3kbIwtd9t");o.value&&o.value.link?y.value=`data:image/jpeg;base64,${o.value.link}`:y.value=null},we=u=>{const o=i.value.filter(U=>U.pessoa.id!==u.pessoa.id).map(U=>({id:U.pessoa.id,nome:U.pessoa.nome}));I.value=o,x.value=!0,r.value=u.pessoa.nome,N.value=u.pessoa.id},Ce=u=>{g.value=!0,r.value=u.pessoa.nome};async function Ae(u){u.excluido=!u.excluido;try{await k(`${$}/${c.value}`,{method:"PUT",body:JSON.stringify({excluido:u.excluido})},"$9xStKwGd7o")}catch(o){console.error("Erro ao excluir pessoa:",o)}}const Te=()=>{const u=T.query.origem||"criar",o=T.query.id;u==="atualizar"?A.push(`/os/atualizar/${o}`):A.push("/os/criar-registro")};return(u,o)=>{const U=ze,le=Re,Se=Ue,qe=X;return _(),w(re,null,{default:a(()=>[e(C,{class:"mt-5"},{default:a(()=>[e(F,{cols:"3"},{default:a(()=>[e(Y,{label:"Documento",modelValue:t(b).documento,"onUpdate:modelValue":o[0]||(o[0]=h=>t(b).documento=h)},null,8,["modelValue"])]),_:1}),e(F,{cols:"4"},{default:a(()=>[e(Y,{label:"Pessoa",modelValue:t(b).nome,"onUpdate:modelValue":o[1]||(o[1]=h=>t(b).nome=h)},null,8,["modelValue"])]),_:1}),d("div",null,[d("img",{class:"mt-3",src:ce,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:xe})]),d("div",null,[d("img",{class:"mt-3 ml-2",src:H,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ke})])]),_:1}),e(C,null,{default:a(()=>[e(F,{cols:"4"},{default:a(()=>[e(ie,{label:"Selecione a Pessoa",modelValue:t(b).pessoa,"onUpdate:modelValue":o[2]||(o[2]=h=>t(b).pessoa=h),items:t(S),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(F,{cols:"3"},{default:a(()=>[e(ie,{label:"Papel",modelValue:t(b).papeis,"onUpdate:modelValue":o[3]||(o[3]=h=>t(b).papeis=h),items:t(O),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),d("div",null,[d("img",{class:"mt-3",src:H,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Ve})])]),_:1}),e(C,null,{default:a(()=>[e(F,null,{default:a(()=>[e(ue,{style:{height:"465px"},headers:_e,items:t(i)},{"item.actions":a(({item:h})=>[e(C,null,{default:a(()=>[d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ne=>Pe(h),title:"Visualizar Ficha"},Ke,8,Ge),d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ne=>Ce(h),class:"mr-2",title:"Alterar Papel"},Qe,8,Ye),d("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ne=>Ae(h),title:"Deletar Pessoa"},[h.excluido?(_(),G("img",Xe)):(_(),G("img",et))],8,He),d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ne=>we(h),title:"Selecionar Representante"},ot,8,tt)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(U,{show:t(R),onClose:o[4]||(o[4]=h=>R.value=!1)},null,8,["show"]),e(le,{representante_nome:t(r),representantes:t(I),ato_id:t(c),show:t(x),onClose:o[5]||(o[5]=h=>x.value=!1),onUpdateRepresentante:$e},null,8,["representante_nome","representantes","ato_id","show"]),e(Se,{representante_nome:t(r),ato_token:f.ato_token,ato_id:t(c),show:t(g),onClose:o[6]||(o[6]=h=>g.value=!1),onUpdatePapel:be},null,8,["representante_nome","ato_token","ato_id","show"]),e(ye,{modelValue:t(s),"onUpdate:modelValue":o[8]||(o[8]=h=>Q(s)?s.value=h:null),width:"600"},{default:a(()=>[e(me,{"max-width":"600",title:"Ficha"},{default:a(()=>[e(Ee,{src:t(y)},null,8,["src"]),e(W,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:o[7]||(o[7]=h=>s.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(C,null,{default:a(()=>[e(qe,{onClick:Te},{default:a(()=>[e(W,{size:"large",color:"red"},{default:a(()=>[D("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},rt=["onClick"],lt={key:0,style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar",title:"Reativar"},nt={key:1,src:de,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},it={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(j){let v,n;const f=j,A=ee(),T=te(),p=se(),{$toast:m}=ae(),E=`${p.public.managemant}/listarEscrevente`,V=`${p.public.managemant}/getAtosTiposByToken`,B=`${p.public.managemant}/createAtosObservacao`,z=`${p.public.managemant}/updateAtosObservacao`,P=l(q("user-data").value.cartorio_token),$=l([]),L=l([]),S=[{title:"Data",align:"start",key:"data"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],i=oe({observacao:null}),O={observacao:{required:ve.withMessage("O campo é obrigatorio",fe)}},x=ge(O,i);[v,n]=Z(()=>k(`${V}/${f.ato_token}`,{method:"GET"},"$aJM1TL1buW")),v=await v,n();async function R(){if(await x.value.$validate()){const{data:r,error:c,status:N}=await k(B,{method:"POST",body:{ato_id:f.ato_id,observacao:i.observacao,user_id:q("user-data").value.usuario_id}},"$dMg99jeUNP");N.value==="success"&&($.value.push({data:Fe(r.value.created,"dd/mm/yyyy"),observacao:r.value.observacao,id:r.value.id,escrevente:q("user-data").value.nome}),m.success("Observação registrada com sucesso"))}else m.error("Preencha os campos obrigatorios.")}async function s(r){r.excluido=!r.excluido;try{await k(`${z}/${r.id}`,{method:"PUT",body:JSON.stringify({excluido:r.excluido})},"$B6PdRx8Gp4")}catch(c){console.error("Erro ao excluir observacao:",c)}}const{data:g}=([v,n]=Z(()=>k(E,{method:"POST",body:{cartorio_token:P}},"$xFHPGua26S")),v=await v,n(),v);L.value=g.value[0].func_json_escreventes;const I=()=>{const r=T.query.origem||"criar",c=T.query.id;r==="atualizar"?A.push(`/os/atualizar/${c}`):A.push("/os/criar-registro")};return(r,c)=>{const N=X;return _(),w(re,null,{default:a(()=>[e(C,{class:"mt-5"},{default:a(()=>[e(Y,{label:"Observação",modelValue:t(i).observacao,"onUpdate:modelValue":c[0]||(c[0]=y=>t(i).observacao=y),required:"","error-messages":t(x).observacao.$errors.map(y=>y.$message),onBlur:t(x).observacao.$touch,onInput:t(x).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),d("div",null,[d("img",{class:"btn-pointer ml-2",src:H,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:R})])]),_:1}),e(C,null,{default:a(()=>[e(F,null,{default:a(()=>[e(ue,{style:{height:"465px"},headers:S,items:t($)},{"item.actions":a(({item:y})=>[d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:_e=>s(y),title:"Deletar Observação"},[y.excluido?(_(),G("img",lt)):(_(),G("img",nt))],8,rt)]),_:1},8,["items"])]),_:1})]),_:1}),e(C,null,{default:a(()=>[e(N,{onClick:I},{default:a(()=>[e(W,{size:"large",color:"red"},{default:a(()=>[D("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},ut=d("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Be,alt:"Escanear"},null,-1),ct=[ut],dt=d("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:H,alt:"Criar"},null,-1),pt=[dt],mt=["onClick"],_t=d("img",{style:{width:"30px",height:"30px"},src:ce,alt:"Visualizar"},null,-1),vt=[_t],ft=["onClick"],gt={key:0,style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar",title:"Reativar"},yt={key:1,src:de,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},ht={__name:"Anexos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},setup(j){const v=j,n=se(),{$toast:f}=ae(),A=ee(),T=te(),p=`${n.public.biometria}/run-scanner`,m=`${n.public.managemant}/atos_anexos`,E=`${n.public.managemant}/atos_anexos`,V=l(!1),B=l([]),z=oe({descricao:""}),P=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}];async function $(){try{await L(),await S()}catch(s){console.error("Erro ao executar scanner ou listar arquivos:",s)}}async function L(){try{const{data:s}=await k(p,{method:"GET"},"$WazoKp68Tw")}catch(s){f.error("Erro ao acionar o scanner:",s)}}async function S(){try{const{data:s,status:g}=await k("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:v.ato_token,cartorio_token:q("user-data").value.cartorio_token}},"$03Wxiia3aI")}catch(s){console.error("Erro ao enviar o arquivo:",s)}}const i=async()=>{V.value=!0},O=async()=>{const{data:s,error:g,status:I}=await k(m,{method:"POST",body:{ato_id:v.ato_id,descricao:z.descricao,user_id:q("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$D2PdkmlmwW");I.value==="success"&&(f.success("Anexo registrado com sucesso!"),B.value.push(s.value))};async function x(s){s.excluido=!s.excluido;try{await k(`${E}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$WyW0hasRPI")}catch(g){console.error("Erro ao excluir pessoa:",g)}}const R=()=>{const s=T.query.origem||"criar",g=T.query.id;s==="atualizar"?A.push(`/os/atualizar/${g}`):A.push("/os/criar-registro")};return(s,g)=>{const I=X;return _(),w(re,null,{default:a(()=>[e(C,null,{default:a(()=>[e(F,{cols:"5"},{default:a(()=>[e(Y,{modelValue:t(z).descricao,"onUpdate:modelValue":g[0]||(g[0]=r=>t(z).descricao=r),label:"Descrição"},null,8,["modelValue"])]),_:1}),d("div",{onClick:$,title:"Escanear"},ct),d("div",{onClick:O,title:"Criar"},pt)]),_:1}),e(ue,{headers:P,items:t(B),style:{height:"465px","max-width":"600px"}},{"item.actions":a(({item:r})=>[e(C,null,{default:a(()=>[d("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:c=>i(r),title:"Visualizar Anexo"},vt,8,mt),d("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:c=>x(r),title:"Deletar Pessoa"},[r.excluido?(_(),G("img",gt)):(_(),G("img",yt))],8,ft)]),_:2},1024)]),_:1},8,["items"]),e(ye,{modelValue:t(V),"onUpdate:modelValue":g[2]||(g[2]=r=>Q(V)?V.value=r:null),width:"600"},{default:a(()=>[e(me,{"max-width":"600",title:"Anexo"},{default:a(()=>[e(W,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:g[1]||(g[1]=r=>V.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(I,{onClick:R},{default:a(()=>[e(W,{size:"large",color:"red"},{default:a(()=>[D("Voltar")]),_:1})]),_:1})]),_:1})}}},xt=d("h1",{class:"mb-2"},"Procuração",-1),Bt={__name:"procuracao",props:{ato_token:{type:String,required:!0}},setup(j){const v=j,n=l(null),f=l(null),A=l(null),T=l(null),p=l(null),m=l(!1),E=l(v.ato_token),V=({id:P,token:$})=>{n.value=P,f.value=$,m.value=!0},B=P=>{A.value=P},z=P=>{T.value=P};return(P,$)=>{const L=We,S=st,i=Ie,O=Ne,x=it,R=ht;return _(),G(Oe,null,[xt,e(me,{width:"1300"},{default:a(()=>[e(je,{modelValue:t(p),"onUpdate:modelValue":$[0]||($[0]=s=>Q(p)?p.value=s:null),"bg-color":"#f5f2f2"},{default:a(()=>[e(J,{value:"dados"},{default:a(()=>[D("Dados")]),_:1}),t(m)?(_(),w(J,{key:0,value:"partes"},{default:a(()=>[D("Partes")]),_:1})):M("",!0),t(m)?(_(),w(J,{key:1,value:"minuta"},{default:a(()=>[D("Minuta")]),_:1})):M("",!0),t(m)?(_(),w(J,{key:2,value:"livro"},{default:a(()=>[D("Livro")]),_:1})):M("",!0),t(m)?(_(),w(J,{key:3,value:"observacao"},{default:a(()=>[D("Observações")]),_:1})):M("",!0),t(m)?(_(),w(J,{key:4,value:"anexo"},{default:a(()=>[D("Anexos")]),_:1})):M("",!0)]),_:1},8,["modelValue"]),e(Le,{modelValue:t(p),"onUpdate:modelValue":$[1]||($[1]=s=>Q(p)?p.value=s:null)},{default:a(()=>[e(K,{value:"dados"},{default:a(()=>[e(L,{onSaved:V,ato_token:t(E)},null,8,["ato_token"])]),_:1}),t(m)?(_(),w(K,{key:0,value:"partes"},{default:a(()=>[e(S,{ato_token:t(E),ato_id:t(n)},null,8,["ato_token","ato_id"])]),_:1})):M("",!0),t(m)?(_(),w(K,{key:1,value:"minuta"},{default:a(()=>[e(i,{onPage:B,onDoc:z,ato_token:t(f)},null,8,["ato_token"])]),_:1})):M("",!0),t(m)?(_(),w(K,{key:2,value:"livro"},{default:a(()=>[e(O,{pages:t(A),ato_token:t(f),document:t(T)},null,8,["pages","ato_token","document"])]),_:1})):M("",!0),t(m)?(_(),w(K,{key:3,value:"observacao"},{default:a(()=>[e(x,{ato_id:t(n)},null,8,["ato_id"])]),_:1})):M("",!0),t(m)?(_(),w(K,{key:4,value:"anexo"},{default:a(()=>[e(R,{ato_token:t(f),ato_id:t(n)},null,8,["ato_token","ato_id"])]),_:1})):M("",!0)]),_:1},8,["modelValue"])]),_:1})],64)}}};export{Bt as default};
