import{_ as oe}from"./D41r9H7V.js";import{_ as se}from"./DMQnYlt2.js";import{_ as ae}from"./C6D3N22C.js";import{_ as ne}from"./BqCIKuQf.js";import{u as re,E as le,n as ie,r as l,D as k,F as ue,G as ce,o as me,c as de,b as t,w as n,q as s,O as pe,a as i,x as _e,s as C,J as M,y as O,d as R}from"./DJDMOApe.js";import{u as h}from"./Knr5SS5N.js";import{_ as S}from"./DCsXQasW.js";import{_ as ve,a as fe}from"./CrE-eFFQ.js";import{V as g}from"./-Vx2wZgF.js";import{V as c}from"./BV9jjDcA.js";import{V as ke}from"./CGOxH47i.js";import"./DpxNcycv.js";import"./DOIAcov5.js";import"./BhFeXlTk.js";const he=i("h1",null,"Reconhecimento por Autencidade",-1),ge=["onClick"],ye=i("img",{style:{width:"30px",height:"30px"},src:S,alt:"Visualizar"},null,-1),Ve=[ye],we=["onClick"],xe=i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:fe,alt:"Remover"},null,-1),be=[xe],Ue={__name:"autencidade",props:{ato_token:{type:String,required:!0}},async setup(z){let p,q;const B=z,$=re(),P=le(),_=_e(),{$toast:U}=ie(),j=`${_.public.managemant}/listarEscrevente`,D=`${_.public.managemant}/pesquisarPessoas`,N=`${_.public.managemant}/atoReconhecimento`,I=`${_.public.managemant}/etiquetaAutenticidade`,v=l(k("user-data").value.cartorio_token),K=l(k("user-service").value.token).value||l(k("user-service").value).value,L=k("auth_token").value,y=l([]),E=l([]),m=l([]),V=l(!1),w=l(!1),x=l(!1),b=l(null),T=l(""),A=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],r=ue({quantidade:1,escrevente:null,nome:null,documento:null}),{data:Q}=([p,q]=ce(()=>h(j,{method:"POST",body:{cartorio_token:v}},"$qpB20nOlUE")),p=await p,q(),p);E.value=Q.value[0].func_json_escreventes;async function Z(){try{const{data:o,error:e}=await h(D,{method:"POST",body:{cartorio_token:v.value,documento:r.documento,nome:r.nome}},"$CfpM9wZnUE");o.value.length>0?y.value=o.value:y.value=[]}catch(o){console.error("Erro na requisição",o)}}const G=()=>{w.value=!0};function H(o){m.value.push(o)}const J=o=>{b.value=o,x.value=!0};function W(o){m.value=m.value.filter(e=>e.token!==o.token)}async function X(){if(!r.escrevente){U.error("Por favor selecione um Escrevente");return}try{const o=m.value.map(u=>({pessoa_token:u.token})),{data:e,error:f,status:d}=await h(N,{method:"POST",body:{pessoas:o,cartorio_token:v.value,ordemserv_token:K,quantidade:r.quantidade,usuario_token:L,ato_tipo_token:B.ato_token}},"$LrKAtpxZwH");d.value==="success"&&e.value[0].status==="OK"?(Y(e.value[0].token),F()):(V.value=!0,T.value=ato_token.value.status_mensagem||f.value.data.details)}catch(o){console.error("Erro na requisição",o)}}async function Y(o){try{const{data:e,error:f,status:d}=await h(I,{method:"POST",body:{ato_token:o,cartorio_token:v.value,escrevente_token:r.escrevente}},"$EE94jKo1pQ");if(d.value==="success"){const u=window.open("","_blank");u.document.open(),u.document.write(e.value[0].etiqueta),u.document.close()}}catch(e){console.error("Erro na requisição",e)}}const F=()=>{const o=P.query.origem||"criar",e=P.query.id;o==="atualizar"?$.push(`/ordens-servicos/atualizar/${e}`):$.push("/ordens-servicos/criar-registro")};return(o,e)=>{const f=oe,d=se,u=ae,ee=ne;return me(),de(pe,null,[he,t(g,{class:"mt-5"},{default:n(()=>[t(c,{cols:"5"},{default:n(()=>[t(ke,{label:"Tabelião/escrevente",modelValue:s(r).escrevente,"onUpdate:modelValue":e[0]||(e[0]=a=>s(r).escrevente=a),items:s(E),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),t(c,{cols:"2"},{default:n(()=>[t(C,{label:"Quantidade",type:"number",modelValue:s(r).quantidade,"onUpdate:modelValue":e[1]||(e[1]=a=>s(r).quantidade=a)},null,8,["modelValue"])]),_:1})]),_:1}),t(g,null,{default:n(()=>[t(c,{cols:"3"},{default:n(()=>[t(C,{label:"Documento",modelValue:s(r).documento,"onUpdate:modelValue":e[2]||(e[2]=a=>s(r).documento=a)},null,8,["modelValue"])]),_:1}),t(c,{cols:"4"},{default:n(()=>[t(C,{label:"Pessoa",modelValue:s(r).nome,"onUpdate:modelValue":e[3]||(e[3]=a=>s(r).nome=a)},null,8,["modelValue"])]),_:1}),i("div",null,[i("img",{class:"btn-pointer mt-3",src:S,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:Z})]),i("div",null,[i("img",{class:"btn-pointer mt-3 ml-2",src:ve,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:G})])]),_:1}),t(g,null,{default:n(()=>[t(c,{class:"mr-10"},{default:n(()=>[t(M,{style:{height:"465px"},headers:A,items:s(y)},{"item.actions":n(({item:a})=>[i("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:te=>J(a),title:"Visualizar Ficha"},Ve,8,ge)]),_:1},8,["items"])]),_:1}),t(c,null,{default:n(()=>[t(M,{headers:A,items:s(m),style:{height:"465px"},"item-key":"id"},{"item.actions":n(({item:a})=>[i("div",{style:{display:"flex","justify-content":"flex-end"},onClick:te=>W(a),title:"Remover"},be,8,we)]),_:1},8,["items"])]),_:1})]),_:1}),t(f,{show:s(w),onClose:e[4]||(e[4]=a=>w.value=!1)},null,8,["show"]),t(d,{show:s(x),item:s(b),onConfirmar:e[5]||(e[5]=a=>H(s(b))),onClose:e[6]||(e[6]=a=>x.value=!1)},null,8,["show","item"]),t(u,{show:s(V),errorMessage:s(T),onClose:e[7]||(e[7]=a=>V.value=!1)},null,8,["show","errorMessage"]),t(g,null,{default:n(()=>[t(ee,{onClick:F},{default:n(()=>[t(O,{size:"large",color:"red"},{default:n(()=>[R("Voltar")]),_:1})]),_:1}),t(O,{class:"ml-5",onClick:X,size:"large",color:"green"},{default:n(()=>[R("Salvar")]),_:1})]),_:1})],64)}}};export{Ue as default};
