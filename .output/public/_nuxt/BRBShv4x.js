import{_ as I}from"./BfiQV2E-.js";import{_ as R}from"./BkJdG2Ga.js";import{c as P,r as j,u as U}from"./BH5f4Ujg.js";import{_ as W,C as F,J,r as n,e as d,f as K,s as L,j as Q,w as i,l as D,o as G,b as a,a as h,i as t,V as H,v as x,d as y}from"./BdfFPx8Y.js";import{f}from"./CeNA3c-Z.js";import{V as X}from"./CGsHFiRu.js";import{V as Y}from"./DQHurBaM.js";import{V as Z}from"./CGlT5mid.js";import{V as ee}from"./Bnx7YOid.js";import"./B70ncqLB.js";import"./DxNoGhrY.js";import"./BcPFnN4M.js";import"./DEmy_mD_.js";import"./ZcLS7Bn9.js";import"./By-7vp6c.js";import"./CZ5e7LDq.js";import"./vgTmHLsU.js";const te={style:{width:"600px","margin-top":"10px"}},oe={style:{width:"180px","margin-top":"20px"}},ae={__name:"autenticacao",props:{ato_token:{type:String,required:!0}},async setup($){let c,k;const C=$,g=F(),V=J(),p=D(),A=`${p.public.auth}/service/gerencia/listarEscrevente`,v=n(d("user-data").value.cartorio_token).value,B=n(d("user-service").value.token).value||n(d("user-service").value).value,T=d("auth_token").value,M=`${p.public.auth}/service/gerencia/atoAutentica`,N=`${p.public.auth}/service/gerencia/etiquetaAutentica`,_=n(!1),w=n(""),s=K({escrevente:null,quantidade:1}),b=n([]),{data:O}=([c,k]=L(()=>f(A,{method:"POST",body:{cartorio_token:v}})),c=await c,k(),c);b.value=O.value[0].func_json_escreventes;const S={escrevente:{required:P.withMessage("O campo é obrigatorio",j)}},m=U(S,s),z=async()=>{if(await m.value.$validate()){const{data:o,status:e,error:u}=await f(M,{method:"POST",body:{usuario_token:T,cartorio_token:v,quantidade:Number(s.quantidade),ordemserv_token:B,ato_tipo_token:C.ato_token}});e.value==="success"&&o.value.status==="OK"?E(o.value.token):(_.value=!0,w.value=o.value.status_mensagem||u.value.data.details)}},E=async o=>{const{data:e,status:u}=await f(N,{method:"POST",body:{escrevente_token:s.escrevente,cartorio_token:v,ato_token:o}});if(u.value==="success"){q();const l=window.open("","_blank");l.document.open(),l.document.write(e.value.etiqueta),l.document.close()}},q=()=>{const o=V.query.origem||"criar",e=V.query.id;o==="atualizar"?g.push(`/os/atualizar/${e}`):g.push("/os/criar-registro")};return(o,e)=>{const u=I,l=R;return G(),Q(X,{class:"mt-10"},{default:i(()=>[a(ee,null,{default:i(()=>[h("div",te,[a(Y,{label:"Tabelião/escrivão",modelValue:t(s).escrevente,"onUpdate:modelValue":e[0]||(e[0]=r=>t(s).escrevente=r),items:t(b),"item-title":"nome","item-value":"token",required:"","error-messages":t(m).escrevente.$errors.map(r=>r.$message),onBlur:t(m).escrevente.$touch,onInput:t(m).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),h("div",oe,[a(H,{type:"number",label:"Quantidade",modelValue:t(s).quantidade,"onUpdate:modelValue":e[1]||(e[1]=r=>t(s).quantidade=r)},null,8,["modelValue"])]),a(Z,{class:"mb-3 mt-2"},{default:i(()=>[a(u,{onClick:q},{default:i(()=>[a(x,{class:"ml-4",size:"large",color:"red"},{default:i(()=>e[3]||(e[3]=[y("Voltar")])),_:1})]),_:1}),a(x,{class:"ml-4",size:"large",color:"green",onClick:z},{default:i(()=>e[4]||(e[4]=[y("Salvar")])),_:1})]),_:1})]),_:1}),a(l,{show:t(_),errorMessage:t(w),onClose:e[2]||(e[2]=r=>_.value=!1)},null,8,["show","errorMessage"])]),_:1})}}},be=W(ae,[["__scopeId","data-v-af5726e1"]]);export{be as default};
