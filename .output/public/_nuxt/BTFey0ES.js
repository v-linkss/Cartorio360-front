import{_ as ce}from"./DDQL2I7D.js";import{_ as me}from"./D3b8EIli.js";import{_ as de}from"./fiuSTN_D.js";import{_ as pe}from"./B6rPUtol.js";import{_ as U}from"./BD_mv71E.js";import{_ as ve}from"./BVz1G1IN.js";import{_ as fe}from"./D8QLx9df.js";import{a as _e}from"./DJvq3mCv.js";import{D as ke,K as he,u as ye,r as l,e as k,f as ge,y as Ve,c as C,b as t,w as r,i as a,h as be,p as we,F as xe,k as Pe,o as b,s as S,a as c,V as B,d as D}from"./DAXHVUaZ.js";import{u as p}from"./7hVpA9Md.js";import{V as w}from"./C1zAWlGE.js";import{V as v}from"./Dff3iLlp.js";import{V as $e}from"./C3lof1z9.js";import{V as I}from"./BTmyphrO.js";import"./D054h1-_.js";import"./CRaz55ka.js";import"./BJyKOuq_.js";import"./CaHR_Vwl.js";import"./B0IxRygJ.js";import"./BetmC9as.js";import"./CwJ1E9XA.js";import"./D3AH7Ov6.js";import"./5KnsWSUG.js";import"./CyT4IHjo.js";import"./CCc6I9Xp.js";import"./DVhNtvur.js";import"./Cwnh_cnW.js";import"./DY9t0h-3.js";import"./1XTS2bvA.js";import"./CdfrKI56.js";import"./CD_Flf9A.js";import"./DyQi_j7U.js";const qe=["onClick"],Ce={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:U,alt:"Possui Ficha",title:"Possui Ficha"},Se={key:1,style:{width:"30px",height:"30px",cursor:"pointer"},src:fe,alt:"Visualizar",title:"Não Possui Ficha"},Fe=["onClick"],ut={__name:"semelhanca",props:{ato_token:{type:String,required:!0}},emits:["ato-created"],async setup(K,{emit:L}){var j;let h,F;const W=K,Q=L,T=ke(),z=he(),m=Pe(),{$toast:A}=ye(),Z=`${m.public.managemant}/listarEscrevente`,G=`${m.public.managemant}/pesquisarPessoas`,H=`${m.public.managemant}/atoReconhecimento`,Y=`${m.public.managemant}/etiquetaReconhecimento`,J=`${m.public.managemant}/download`,X=`${m.public.envioDoc}/print`,y=l(k("user-data").value.cartorio_token),ee=l(k("user-service").value.token).value||l(k("user-service").value).value,te=k("auth_token").value,x=l([]),M=l([]),f=l([]),P=l(!1),$=l(!1),g=l(!1),V=l(null),O=l(null),R=l(""),E=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],n=ge({quantidade:1,escrevente:null,nome:null,documento:null}),{data:N}=([h,F]=Ve(()=>p(Z,{method:"POST",body:{cartorio_token:y}},"$iEFsIjdWdW")),h=await h,F(),h);M.value=Array.isArray(N.value)&&((j=N.value[0])==null?void 0:j.func_json_escreventes)||[];async function oe(){try{const{data:s,error:e}=await p(G,{method:"POST",body:{cartorio_token:y.value,documento:n.documento,nome:n.nome}},"$uzKb8LPV3v");s.value.length>0?(x.value=s.value,Q("ato-created")):x.value=[]}catch(s){console.error("Erro na requisição",s)}}const ae=()=>{$.value=!0};function se(s){f.value.push(s)}const re=async s=>{V.value=s,g.value=!0;const{data:e}=await p(J,{method:"POST",body:{bucket:k("user-data").value.cartorio_token,path:s.link_ficha}},"$MulQmK1LAp");O.value=e.value};function ne(s){f.value=f.value.filter(e=>e.token!==s.token)}async function le(){var e,_,d,u;if(!n.escrevente){A.error("Por favor selecione um Escrevente");return}const s=f.value.map(i=>({pessoa_token:i.token}));try{const{data:i,error:o,status:q}=await p(H,{method:"POST",body:{pessoas:s,cartorio_token:y.value,ordemserv_token:ee,quantidade:n.quantidade,usuario_token:te,ato_tipo_token:W.ato_token}},"$fMGlIlw995");q.value==="success"&&Array.isArray(i.value)&&((e=i.value[0])==null?void 0:e.status)==="OK"?ie(i.value[0].token):(P.value=!0,R.value=Array.isArray(i.value)&&((_=i.value[0])==null?void 0:_.status_mensagem)||((u=(d=o==null?void 0:o.value)==null?void 0:d.data)==null?void 0:u.details)||"Não foi possível concluir o reconhecimento")}catch(i){console.error("Erro na requisição",i)}}async function ie(s){try{const{data:e,error:_,status:d}=await p(Y,{method:"POST",body:{ato_token:s,cartorio_token:y.value,escrevente_token:n.escrevente}},"$oSnYNRtP6Z");if(d.value==="success"){if(e.value[0].tipo_etiqueta==="html"){const u=window.open("","_blank");u.document.open(),u.document.write(e.value[0].etiqueta),u.document.close()}else if(e.value[0].tipo_etiqueta==="zpl"){const{status:u}=await p(`${X}`,{method:"POST",body:{zpl:atob(e.value[0].etiqueta)}},"$BtUyHn78O6");if(u.value!=="success"){A.error("Não foi possivel fazer a impressao da etiqueta");return}}}}catch(e){console.error("Erro na requisição",e)}}const ue=()=>{const s=z.query.origem||"criar",e=z.query.id;s==="atualizar"?T.push(`/os/atualizar/${e}`):T.push("/os/criar-registro")};return(s,e)=>{const _=ce,d=me,u=de,i=pe;return b(),C(xe,null,[t(w,{class:"mt-5"},{default:r(()=>[t(v,{cols:"5"},{default:r(()=>[t($e,{label:"Tabelião/escrevente",modelValue:a(n).escrevente,"onUpdate:modelValue":e[0]||(e[0]=o=>a(n).escrevente=o),items:a(M),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"])]),_:1}),t(v,{cols:"2"},{default:r(()=>[t(S,{label:"Quantidade",type:"number",modelValue:a(n).quantidade,"onUpdate:modelValue":e[1]||(e[1]=o=>a(n).quantidade=o)},null,8,["modelValue"])]),_:1})]),_:1}),t(w,null,{default:r(()=>[t(v,{cols:"3"},{default:r(()=>[t(S,{label:"Documento",modelValue:a(n).documento,"onUpdate:modelValue":e[2]||(e[2]=o=>a(n).documento=o)},null,8,["modelValue"])]),_:1}),t(v,{cols:"4"},{default:r(()=>[t(S,{label:"Pessoa",modelValue:a(n).nome,"onUpdate:modelValue":e[3]||(e[3]=o=>a(n).nome=o)},null,8,["modelValue"])]),_:1}),c("div",null,[c("img",{class:"btn-pointer mt-3",src:U,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:oe})]),c("div",null,[c("img",{class:"btn-pointer mt-3 ml-2",src:ve,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ae})])]),_:1}),t(w,null,{default:r(()=>[t(v,{class:"mr-10"},{default:r(()=>[t(I,{style:{height:"465px"},headers:E,items:a(x)},{"item.actions":r(({item:o})=>[c("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:q=>re(o),title:"Visualizar Ficha"},[o.link_ficha?(b(),C("img",Ce)):(b(),C("img",Se))],8,qe)]),_:1},8,["items"])]),_:1}),t(v,null,{default:r(()=>[t(I,{headers:E,items:a(f),style:{height:"465px"},"item-key":"id"},{"item.actions":r(({item:o})=>[c("div",{style:{display:"flex","justify-content":"flex-end"},onClick:q=>ne(o),title:"Remover"},e[8]||(e[8]=[c("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:_e,alt:"Remover"},null,-1)]),8,Fe)]),_:1},8,["items"])]),_:1})]),_:1}),t(_,{show:a($),onClose:e[4]||(e[4]=o=>$.value=!1)},null,8,["show"]),a(g)?(b(),be(d,{key:0,show:a(g),item:a(V),"pessoa-obj":a(V),"link-view":a(O),onConfirmar:e[5]||(e[5]=o=>se(a(V))),onClose:e[6]||(e[6]=o=>g.value=!1)},null,8,["show","item","pessoa-obj","link-view"])):we("",!0),t(w,null,{default:r(()=>[t(u,{onClick:ue},{default:r(()=>[t(B,{size:"large",color:"red"},{default:r(()=>e[9]||(e[9]=[D("Voltar")])),_:1})]),_:1}),t(B,{class:"ml-5",onClick:le,size:"large",color:"green"},{default:r(()=>e[10]||(e[10]=[D("Salvar")])),_:1})]),_:1}),t(i,{show:a(P),errorMessage:a(R),onClose:e[7]||(e[7]=o=>P.value=!1)},null,8,["show","errorMessage"])],64)}}};export{ut as default};
