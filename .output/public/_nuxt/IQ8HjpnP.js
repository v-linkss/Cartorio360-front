import{r as f,E as h,p as D,c as $,s as l,C as L,J as T,b as t,w as r,F as B,A as F,m as N,o as _,O,V as p,z as E,d as y,v as P,t as R}from"./BMpR6Kkb.js";import{u as V}from"./DJReksQT.js";import{f as U}from"./B0IxRygJ.js";import{V as A}from"./DhKTmLgc.js";import{V as J}from"./CHOcgw8N.js";import{V as c}from"./CXAsmq6V.js";import{V as j}from"./xmymZw8t.js";import{b as Y}from"./CCechfrJ.js";import"./De3NQz9Z.js";import"./Cw171fNm.js";import"./DIcDdim7.js";const se={__name:"index",setup(G){const n=F(),b=`${n.public.managemant}/lista_selos_transmitir`,g=`${n.public.managemant}/integra_selos`,C=`${n.public.ws}/enviar_ato`;`${n.public.managemant}`;const u=f([]),v=f([]),d=f(!1),a=h({data_utilizacao:"",descricao:"",numero:""}),w=[{title:"Data",value:"data_utilizacao"},{title:"Descrição",value:"descricao"},{title:"Número",value:"numero"}],S=async()=>{d.value=!0;try{const{data:s,error:e,status:o}=await V(b,{method:"POST",body:{cartorio_token:N("user-data").value.cartorio_token}},"$Xe0bfknJZY");o.value==="success"?v.value=Array.isArray(s.value)?s.value.map(i=>({...i,data_utilizacao:i.data_utilizacao?U(i.data_utilizacao,"dd/mm/yyyy hh:mm"):null})):[]:console.error(e)}catch(s){console.error("Erro ao buscar selos:",s)}finally{d.value=!1}},k=async()=>{const s=u.value.map(m=>({selo_token:m})),{data:e,error:o,status:i}=await V(g,{method:"POST",body:s},"$Bhrd8mFcH5");if(i.value==="success"){const m=e.value,{data:H,error:M,status:x}=await V(C,{method:"POST",body:{user:"56415451472",pass:"Ra961206",xmlData:m}},"$QOGY8cy73o");x.value==="success"&&($toast.success("Selos enviados com sucesso"),closeModal())}},z=D(()=>v.value.filter(s=>(!a.data_utilizacao||s.data_utilizacao.toLowerCase().includes(a.data_utilizacao.toLowerCase()))&&(!a.numero||s.numero.toLowerCase().includes(a.numero.toLowerCase()))&&(!a.descricao||s.descricao.toLowerCase().includes(a.descricao.toLowerCase()))));return S(),(s,e)=>(_(),$(B,null,[l(d)?(_(),L(O,{key:0,class:"d-flex justify-center align-center",indeterminate:"",size:"64",style:{position:"absolute",top:"40%",left:"50%"}})):T("",!0),t(A,{class:"mt-5"},{default:r(()=>[t(J,{class:"d-flex align-center"},{default:r(()=>[t(c,{cols:"12",md:"2"},{default:r(()=>[t(p,{modelValue:l(a).data_utilizacao,"onUpdate:modelValue":e[0]||(e[0]=o=>l(a).data_utilizacao=o),label:"Data",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12",md:"3"},{default:r(()=>[t(p,{modelValue:l(a).descricao,"onUpdate:modelValue":e[1]||(e[1]=o=>l(a).descricao=o),label:"Descrição",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12",md:"2"},{default:r(()=>[t(p,{modelValue:l(a).numero,"onUpdate:modelValue":e[2]||(e[2]=o=>l(a).numero=o),label:"Número",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),_:1}),t(c,{cols:"12",md:"5",class:"d-flex justify-end mb-2"},{default:r(()=>[t(E,{color:"green",size:"large",onClick:k},{default:r(()=>e[4]||(e[4]=[y("Enviar Selos")])),_:1})]),_:1})]),_:1}),t(j,{"show-select":"",density:"compact",headers:w,items:l(z),"item-key":"token","item-value":"token",modelValue:l(u),"onUpdate:modelValue":e[3]||(e[3]=o=>P(u)?u.value=o:null)},{"item.situacao":r(({item:o})=>[t(Y,{color:"green","text-color":"white",outlined:""},{default:r(()=>[y(R(o.situacao),1)]),_:2},1024)]),_:1},8,["items","modelValue"])]),_:1})],64))}};export{se as default};
