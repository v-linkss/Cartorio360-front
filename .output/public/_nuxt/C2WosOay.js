import{_ as te}from"./ss2_RW0M.js";import{c as de,r as me,u as pe}from"./CwqmgFxG.js";import{K as ze,e as X,J as Z,u as H,r as n,f as P,g as oe,v as ee,o as S,k as K,w as o,b as e,j as t,V as Y,x as J,d as L,m as Q,z as Me,a as v,c as F,l as _e,M as De,N as Re,F as he,O as ye,t as ae}from"./Dc3bVwLU.js";import{u as b}from"./rRdfW6gD.js";import{V as R}from"./D7_8OK8h.js";import{V as I}from"./zahdRQZJ.js";import{V as se}from"./Wu_SI8SW.js";import{V as ne}from"./DhmjNzHN.js";import{_ as je,b as Ie,c as Ne,a as Be}from"./CZKrFFzh.js";import{_ as Ue,a as Fe,b as Le,T as We,W as Ge,D as be,c as Je}from"./DMilzqPy.js";import{_ as Ke,r as ke}from"./C16iRCsm.js";import{_ as ue}from"./PNDdkz7t.js";import{_ as re}from"./BVz1G1IN.js";import{_ as Ye}from"./DekSNnBl.js";import{_ as ve,a as fe}from"./DJvq3mCv.js";import{V as ge}from"./CDih33Kh.js";import{_ as Xe}from"./WOHjd9_D.js";import{V as Ze}from"./BPmYyagF.js";import{f as He}from"./B0IxRygJ.js";const jt={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_tipo_id:{type:Number}},emits:["saved"],async setup(W,{emit:y}){let f,h;const k=W;ze(()=>k.ato_tipo_id,g=>{w.value={id:g}});const A=y,x=X(),V=Z(),B=Q(),{$toast:T}=H(),N=`${B.public.managemant}/listarSituacoes`,j=`${B.public.managemant}/createAtos`;`${B.public.managemant}`;const q=n(P("user-data").value.cartorio_token),O=n(P("user-service").value.id).value||n(P("user-service").value).value,U=n([]),w=n(k.ato_tipo_id?{id:k.ato_tipo_id}:null),_=oe({dt_abertura:null,status:"EM EDIÇÃO",mne:null}),z={status:{required:de.withMessage("O campo é obrigatorio",me)}},s=pe(z,_);async function l(){if(await s.value.$validate()){const{data:g,error:r,status:p}=await b(j,{method:"POST",body:{ato_tipo_id:w.value.id,cartorio_id:P("user-data").value.cartorio_id,ordemserv_id:O,status:_.status,dt_abertura:_.dt_abertura,mne:_.mne,user_id:P("user-data").value.usuario_id,user_alteracao_id:P("user-data").value.usuario_id}},"$9ZmTYsLk0K");p.value==="success"&&(T.success("Ato registrado com sucesso!"),A("saved",{id:g.value.id,token:g.value.token}))}else T.error("Preencha os campos obrigatorios.")}const{data:d}=([f,h]=ee(()=>b(N,{method:"POST",body:{cartorio_token:q.value}},"$hyq5YcBEjF")),f=await f,h(),f);U.value=d.value;const E=()=>{const g=V.query.origem||"criar",r=V.query.id;g==="atualizar"?x.push(`/os/atualizar/${r}`):x.push("/os/criar-registro")};return(g,r)=>{const p=te;return S(),K(ne,null,{default:o(()=>[e(R,{class:"mt-5"},{default:o(()=>[e(I,{cols:"3"},{default:o(()=>[e(se,{label:"Situação",modelValue:t(_).status,"onUpdate:modelValue":r[0]||(r[0]=$=>t(_).status=$),items:t(U),"item-title":"descricao","item-value":"descricao",required:"","error-messages":t(s).status.$errors.map($=>$.$message),onBlur:t(s).status.$touch,onInput:t(s).status.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1})]),_:1}),e(R,null,{default:o(()=>[e(I,{cols:"5"},{default:o(()=>[e(Y,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:t(_).mne,"onUpdate:modelValue":r[1]||(r[1]=$=>t(_).mne=$)},null,8,["modelValue"])]),_:1})]),_:1}),e(R,null,{default:o(()=>[e(I,{cols:"2"},{default:o(()=>[e(Y,{modelValue:t(_).dt_abertura,"onUpdate:modelValue":r[2]||(r[2]=$=>t(_).dt_abertura=$),type:"date",label:"Data Lavratura",disabled:"",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(R,{class:"mb-3"},{default:o(()=>[e(p,{onClick:E},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>r[3]||(r[3]=[L("Voltar")])),_:1})]),_:1}),e(J,{class:"ml-10",onClick:l,size:"large",color:"green"},{default:o(()=>r[4]||(r[4]=[L("Salvar")])),_:1})]),_:1})]),_:1})}}},Qe=["onClick"],et=["onClick"],tt=["onClick"],ot={key:0,style:{width:"30px",height:"30px"},src:ve,alt:"Visualizar",title:"Reativar"},at={key:1,src:fe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},st=["onClick"],It={__name:"Partes",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},async setup(W){let y,f;const h=W,k=X(),A=Z(),x=Q(),{$toast:V}=H(),B=`${x.public.managemant}/pesquisarPessoas`,T=`${x.public.managemant}/listarPapeis`,N=`${x.public.managemant}/download`,j=`${x.public.managemant}/createAtosPessoa`,q=`${x.public.managemant}/getAtosPessoaById`,O=`${x.public.managemant}/updateAtosPessoa`,U=n(P("user-data").value.cartorio_token),w=n([]),_=n({}),z=n([]),s=n([]),l=n(!1),d=n(!1),E=n(!1),g=n(!1),r=n(null),p=n(null),$=n(null),i=n(null);n(null);const m=n(null),C=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome",width:"400px"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],u=oe({papeis:null,nome:null,pessoa:null,documento:null});Me(()=>{var c;return((c=u.pessoa)==null?void 0:c.link_ficha)||!1});const{data:G}=([y,f]=ee(()=>b(T,{method:"POST",body:{tipo_ato_token:h.ato_token}},"$fFKndZhA4W")),y=await y,f(),y);s.value=G.value;async function xe(){try{const{data:c,error:a}=await b(B,{method:"POST",body:{cartorio_token:U.value,documento:u.documento,nome:u.nome}},"$o3ZL1rvYrY");c.value.length>0?(w.value=c.value,u.pessoa=w.value[0]):w.value=[]}catch(c){console.error("Erro na requisição",c)}}const $e=()=>{d.value=!0},we=c=>{z.value=z.value.map(a=>a.id===$.value?{...a,papel:{...a.papel,descricao:c}}:a)},Ce=c=>{const a=z.value.find(M=>M.pessoa.id===i.value);a.representante.nome=c},Ve=async()=>{const c={pessoa:u.pessoa,papel:s.value.find(M=>M.id===u.papeis),representante:{nome:null}},a=await b(`${q}/${h.ato_id}`,{method:"GET"},"$kXSxUa4grs");for(const M of a.data.value)if(M.pessoa_id===u.pessoa.id&&M.ato_id===h.ato_id&&M.tipo_parte_id===u.papeis){V.error("Pessoa Já Registrada Com Esse Papel!");return}try{const{data:M,error:le,status:ie}=await b(j,{method:"POST",body:{ato_id:Number(h.ato_id),pessoa_id:u.pessoa.id,tipo_parte_id:u.papeis,user_id:Number(P("user-data").value.usuario_id)}},"$So3qnQu7ek");ie.value==="success"?(c.id=M.value.id,V.success("Pessoa Registrada com Sucesso!"),z.value.push(c)):V.error(le.value.message)}catch{V.error("Erro no servidor. Tente novamente.")}},Ee=async c=>{E.value=!0;const{data:a}=await b(N,{method:"POST",body:{bucket:P("user-data").value.cartorio_token,path:c.pessoa.link_ficha}},"$Q3kbIwtd9t");m.value=a.value,_.value=c.pessoa},Pe=c=>{const a=z.value.filter(M=>M.pessoa.id!==c.pessoa.id).map(M=>({id:M.pessoa.id,nome:M.pessoa.nome}));$.value=c.id,r.value=a,l.value=!0,p.value=c.pessoa.nome,i.value=c.pessoa.id},Ae=c=>{$.value=c.id,g.value=!0,p.value=c.pessoa.nome};async function Se(c){c.excluido=!c.excluido;try{await b(`${O}/${$.value}`,{method:"PUT",body:JSON.stringify({excluido:c.excluido})},"$9xStKwGd7o")}catch(a){console.error("Erro ao excluir pessoa:",a)}}const qe=()=>{const c=A.query.origem||"criar",a=A.query.id;c==="atualizar"?k.push(`/os/atualizar/${a}`):k.push("/os/criar-registro")};return(c,a)=>{const M=je,le=Fe,ie=Le,Te=Ke,Oe=te;return S(),K(ne,null,{default:o(()=>[e(R,{class:"mt-5"},{default:o(()=>[e(I,{cols:"3"},{default:o(()=>[e(Y,{label:"Documento",modelValue:t(u).documento,"onUpdate:modelValue":a[0]||(a[0]=D=>t(u).documento=D)},null,8,["modelValue"])]),_:1}),e(I,{cols:"4"},{default:o(()=>[e(Y,{label:"Pessoa",modelValue:t(u).nome,"onUpdate:modelValue":a[1]||(a[1]=D=>t(u).nome=D)},null,8,["modelValue"])]),_:1}),v("div",null,[v("img",{class:"mt-3",src:ue,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:xe})]),v("div",null,[v("img",{class:"mt-3 ml-2",src:re,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:$e})])]),_:1}),e(R,null,{default:o(()=>[e(I,{cols:"4"},{default:o(()=>[e(se,{label:"Selecione a Pessoa",modelValue:t(u).pessoa,"onUpdate:modelValue":a[2]||(a[2]=D=>t(u).pessoa=D),items:t(w),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(I,{cols:"3"},{default:o(()=>[e(se,{label:"Papel",modelValue:t(u).papeis,"onUpdate:modelValue":a[3]||(a[3]=D=>t(u).papeis=D),items:t(s),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),v("div",null,[v("img",{class:"mt-3",src:re,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Ve})])]),_:1}),e(R,null,{default:o(()=>[e(I,null,{default:o(()=>[e(ge,{style:{height:"465px"},headers:C,items:t(z)},{"item.actions":o(({item:D})=>[e(R,null,{default:o(()=>[v("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>Ee(D),title:"Visualizar Ficha"},a[8]||(a[8]=[v("img",{style:{width:"30px",height:"30px"},src:ue,alt:"Visualizar"},null,-1)]),8,Qe),v("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Ae(D),class:"mr-2",title:"Alterar Papel"},a[9]||(a[9]=[v("img",{style:{width:"30px",height:"30px"},src:Ye,alt:"Visualizar"},null,-1)]),8,et),v("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ce=>Se(D),title:"Deletar Pessoa"},[D.excluido?(S(),F("img",ot)):(S(),F("img",at))],8,tt),v("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ce=>Pe(D),title:"Selecionar Representante"},a[10]||(a[10]=[v("img",{style:{width:"30px",height:"30px"},src:Ue,alt:"Visualizar"},null,-1)]),8,st)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(M,{show:t(d),onClose:a[4]||(a[4]=D=>d.value=!1)},null,8,["show"]),e(le,{representante_nome:t(p),representantes:t(r),ato_id:t($),show:t(l),onClose:a[5]||(a[5]=D=>l.value=!1),onUpdateRepresentante:Ce},null,8,["representante_nome","representantes","ato_id","show"]),e(ie,{representante_nome:t(p),ato_token:h.ato_token,ato_id:t($),show:t(g),onClose:a[6]||(a[6]=D=>g.value=!1),onUpdatePapel:we},null,8,["representante_nome","ato_token","ato_id","show"]),t(E)?(S(),K(Te,{key:0,show:t(E),"link-view":t(m),"pessoa-obj":t(_),"is-view":!0,onClose:a[7]||(a[7]=D=>E.value=!1)},null,8,["show","link-view","pessoa-obj"])):_e("",!0),e(R,null,{default:o(()=>[e(Oe,{onClick:qe},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>a[11]||(a[11]=[L("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},rt={key:0,class:"loading-overlay"},nt="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",Nt={__name:"Minuta",props:{ato_token:{type:String,required:!0}},emits:["page","doc"],setup(W,{emit:y}){const f=W;De("DocumentEditorContainer",[We,Ge]);const h=Q(),{$toast:k}=H(),A=X(),x=Z(),V=y;ke(`${h.public.docEditor}`);const B=`${h.public.managemant}/upload`,T=n(null),N=n(!1),j=async()=>{const l=await T.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),d=new FileReader;d.onload=()=>{const E=d.result;V("doc",E)},d.readAsText(l)},q=async()=>{N.value=!0;try{const l=await T.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),d=new FormData;d.append("file",l,"anexo.docx"),d.append("cartorio_token",P("user-data").value.cartorio_token),d.append("token",f.ato_token),d.append("tipo","ato_minuta");const{data:E,status:g}=await b(B,{method:"POST",body:d},"$071xxdqs20");if(g.value==="success"){k.success("Documento enviado!");const p=T.value.ej2Instances.documentEditor.pageCount;j(),V("page",p)}else k.error("Erro ao enviar documento para o sistema.")}catch(s){k.error("Erro ao salvar documento."),console.error(s)}finally{N.value=!1}},O=async()=>{_(!0);try{await U(),_(!0);const{data:s,status:l}=await b(substituirModelo,{method:"POST",body:{ato_token:f.ato_token}},"$0ktpWliD4l");s.value&&w(s.value)}catch(s){console.error("Erro ao gerar a minuta:",s),k.error("Ocorreu um erro ao gerar a minuta.")}finally{_(!1)}},U=async()=>{try{const{data:s}=await b(baixarDocumento,{method:"POST",body:{bucket:P("user-data").value.cartorio_token,path:"provider/modeloAto.sfdt"}},"$jXVvQjEE6u"),l=await fetchBlobFromMinIO(s.value);if(l){const d=new FileReader;d.onload=()=>{const E=d.result;T.value.ej2Instances.documentEditor.open(E),V("doc",E)},d.readAsText(l)}}catch(s){console.error("Erro ao carregar o modelo de minuta:",s),k.error("Falha ao carregar o modelo de minuta.")}},w=s=>{const l=T.value.ej2Instances.documentEditor,d=E=>{for(const[g,r]of Object.entries(E))if(/^<<.+>>$/.test(g))try{l.search.findAll(g),l.search.searchResults.length>0&&l.search.searchResults.replaceAll(r)}catch(p){console.error(`Erro ao substituir o marcador ${g}:`,p)}else if(g==="partes"&&Array.isArray(r)&&r.length>0)for(const p of r)typeof p=="object"&&d(p)};d(s)},_=s=>{N.value=s},z=()=>{const s=x.query.origem||"criar",l=x.query.id;s==="atualizar"?A.push(`/os/atualizar/${l}`):A.push("/os/criar-registro")};return(s,l)=>{const d=te;return S(),F(he,null,[e(t(be),{height:"900px",ref_key:"documentEditorContainer",ref:T,serviceUrl:nt,enableToolbar:!0,enableWordExport:!0},null,512),t(N)?(S(),F("div",rt,[e(Re,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):_e("",!0),e(R,{class:"ml-4 mt-4 mb-4"},{default:o(()=>[e(d,{class:"mr-4"},{default:o(()=>[e(J,{size:"large",onClick:z,color:"red"},{default:o(()=>l[0]||(l[0]=[L("Voltar")])),_:1})]),_:1}),e(J,{size:"large",color:"green",onClick:q,disabled:t(N)},{default:o(()=>l[1]||(l[1]=[L("Salvar")])),_:1},8,["disabled"]),e(J,{class:"ml-4",size:"large",color:"blue",onClick:O},{default:o(()=>l[2]||(l[2]=[L("Gerar Minuta")])),_:1})]),_:1})],64)}}},lt=["innerHTML"],Bt={__name:"Livro",props:{ato_token:{type:String,required:!0},pages:{type:Number,required:!0},document:{type:String,required:!0}},async setup(W){let y,f;const h=W,k=Q();ke(`${k.public.docEditor}`);const{$toast:A}=H(),x=X(),V=Z(),B=`${k.public.managemant}/listarEscrevente`,T=`${k.public.managemant}/lavrarAto`,N=n("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),j=n(!1),q=n(null),O=n(null),U=n(null),w=n(P("user-data").value.cartorio_token),_=P("auth_token").value,z=n([]),s=n({}),l=oe({escrevente:null}),d=async()=>{try{const{data:m,status:C}=await b(T,{method:"POST",body:{ato_token:h.ato_token,qtd_paginas:h.pages,escrevente_token:l.escrevente,usuario_token:_,cartorio_token:w}},"$ZKnVBNYxp9");C.value==="success"?(q.value=m.value,O.value=m.value[0].selo,A.success("Ato lavrado com sucesso!")):A.error("Falha ao lavrar o ato.")}catch{A.error("Erro ao conectar com o servidor.")}},E=async()=>{const{data:m,status:C}=await b(calculaAto,{method:"POST",body:{ato_token:V.query.ato_token_edit,cartorio_token:w,quantidade:1,usuario_token:_,escrevente_token:l.escrevente,qtd_paginas:h.pages}},"$XouuxOFIWh");C.value==="success"?s.value=m.value[0]:A.error("Falha ao calcular o ato.")},g=async()=>{j.value=!1,await d()},r=async()=>{j.value=!0,await E()},{data:p}=([y,f]=ee(()=>b(B,{method:"POST",body:{cartorio_token:w}},"$R51FaaSzOI")),y=await y,f(),y);z.value=p.value[0].func_json_escreventes;const $=function(){U.value.ej2Instances.documentEditor.open(h.document)},i=()=>{const m=V.query.origem||"criar",C=V.query.id;m==="atualizar"?x.push(`/os/atualizar/${C}`):x.push("/os/criar-registro")};return(m,C)=>{const u=Xe;return S(),F(he,null,[e(R,null,{default:o(()=>[e(I,null,{default:o(()=>[(S(),K(t(be),{restrictEditing:!0,enableToolbar:!1,created:h.document?$:null,ref_key:"documentEditorContainer",ref:U,height:"850px",width:"850px",key:h.document},null,8,["created"]))]),_:1}),e(I,null,{default:o(()=>[e(se,{class:"mt-15",label:"Tabelião/escrevente",modelValue:t(l).escrevente,"onUpdate:modelValue":C[0]||(C[0]=G=>t(l).escrevente=G),items:t(z),"item-title":"nome","item-value":"token",required:""},null,8,["modelValue","items"]),v("div",null,[v("div",null,[v("img",{onClick:C[1]||(C[1]=G=>r()),class:"ml-2",style:{height:"80px",width:"80px",cursor:"pointer","margin-top":"40px"},src:Je}),t(q)?(S(),K(Ze,{key:0,class:"mr-16"},{default:o(()=>[e(R,{"no-gutters":""},{default:o(()=>[e(I,null,{default:o(()=>[e(ye,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:o(()=>[e(I,null,{default:o(()=>[L(" Livro: "+ae(t(q)[0].livro_numero),1)]),_:1}),e(I,null,{default:o(()=>[L(" Protocolo: "+ae(t(q)[0].protocolo?t(q)[0].protocolo:null),1)]),_:1})]),_:1})]),_:1}),e(I,null,{default:o(()=>[e(ye,{style:{"font-weight":"bold"},class:"pa-2 ma-2 mt-3"},{default:o(()=>[L(" Folhas : "+ae(t(q)[0].pagina_inicial)+" A "+ae(t(q)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),v("div",{innerHTML:t(O)},null,8,lt)]),_:1})):_e("",!0)])])]),_:1})]),_:1}),e(J,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:i},{default:o(()=>C[3]||(C[3]=[L("Voltar")])),_:1}),e(u,{show:t(j),condMessage:t(N),valor:t(s),onClose:C[2]||(C[2]=G=>j.value=!1),onConfirm:g},null,8,["show","condMessage","valor"])],64)}}},it=["onClick"],ct={key:0,style:{width:"30px",height:"30px"},src:ve,alt:"Visualizar",title:"Reativar"},ut={key:1,src:fe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ut={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(W){let y,f;const h=W,k=X(),A=Z(),x=Q(),{$toast:V}=H(),B=`${x.public.managemant}/listarEscrevente`,T=`${x.public.managemant}/getAtosTiposByToken`,N=`${x.public.managemant}/atos_observacao`,j=`${x.public.managemant}/atos_observacao`,q=n(P("user-data").value.cartorio_token),O=n([]),U=n([]),w=[{title:"Data",align:"start",key:"data"},{title:"Escrevente",align:"start",key:"escrevente"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],_=oe({observacao:null}),z={observacao:{required:de.withMessage("O campo é obrigatorio",me)}},s=pe(z,_);[y,f]=ee(()=>b(`${T}/${h.ato_token}`,{method:"GET"},"$aJM1TL1buW")),y=await y,f();async function l(){if(await s.value.$validate()){const{data:r,error:p,status:$}=await b(N,{method:"POST",body:{ato_id:h.ato_id,observacao:_.observacao,user_id:P("user-data").value.usuario_id}},"$dMg99jeUNP");$.value==="success"&&(O.value.push({data:He(r.value.created,"dd/mm/yyyy hh:mm"),observacao:r.value.observacao,id:r.value.id,escrevente:P("user-data").value.nome}),V.success("Observação registrada com sucesso"))}else V.error("Preencha os campos obrigatorios.")}async function d(r){r.excluido=!r.excluido;try{await b(`${j}/${r.id}`,{method:"PUT",body:JSON.stringify({excluido:r.excluido})},"$B6PdRx8Gp4")}catch(p){console.error("Erro ao excluir observacao:",p)}}const{data:E}=([y,f]=ee(()=>b(B,{method:"POST",body:{cartorio_token:q}},"$xFHPGua26S")),y=await y,f(),y);U.value=E.value[0].func_json_escreventes;const g=()=>{const r=A.query.origem||"criar",p=A.query.id;r==="atualizar"?k.push(`/os/atualizar/${p}`):k.push("/os/criar-registro")};return(r,p)=>{const $=te;return S(),K(ne,null,{default:o(()=>[e(R,{class:"mt-5"},{default:o(()=>[e(Y,{label:"Observação",modelValue:t(_).observacao,"onUpdate:modelValue":p[0]||(p[0]=i=>t(_).observacao=i),required:"","error-messages":t(s).observacao.$errors.map(i=>i.$message),onBlur:t(s).observacao.$touch,onInput:t(s).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),v("div",null,[v("img",{class:"btn-pointer ml-2",src:re,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:l})])]),_:1}),e(R,null,{default:o(()=>[e(I,null,{default:o(()=>[e(ge,{style:{height:"465px"},headers:w,items:t(O)},{"item.actions":o(({item:i})=>[v("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:m=>d(i),title:"Deletar Observação"},[i.excluido?(S(),F("img",ct)):(S(),F("img",ut))],8,it)]),_:1},8,["items"])]),_:1})]),_:1}),e(R,null,{default:o(()=>[e($,{onClick:g},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>p[1]||(p[1]=[L("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},dt={key:0,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ie,alt:"Criar"},mt={key:1,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ne,alt:"Criar"},pt={key:2,class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:Be,alt:"Criar"},_t=["onClick"],vt=["onClick"],ft=["onClick"],gt={key:0,style:{width:"30px",height:"30px"},src:ve,alt:"Visualizar",title:"Reativar"},yt={key:1,src:fe,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ft={__name:"Anexos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0}},setup(W){const y=W,f=Q(),{$toast:h}=H(),k=X(),A=Z(),x=`${f.public.biometria}/run-scanner`,V=`${f.public.managemant}/atos_anexos`,B=`${f.public.managemant}/atos_anexos`,T=`${f.public.managemant}/download`;`${f.public.managemant}`,`${f.public.managemant}`;const N=n(!1),j=n(null),q=n([]);P("pessoa_token");const O=oe({descricao:"",fileEvent:null}),U={descricao:{required:de.withMessage("O campo é obrigatório",me)}},w=pe(U,O,{$autoDirty:!0}),_=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}];async function z(){try{await s(),await l()}catch(i){console.error("Erro ao executar scanner ou listar arquivos:",i)}}async function s(){try{const{data:i}=await b(x,{method:"GET"},"$WazoKp68Tw")}catch(i){h.error("Erro ao acionar o scanner:",i)}}async function l(){try{const{data:i,status:m}=await b("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:A.query.ato_token_edit,cartorio_token:P("user-data").value.cartorio_token}},"$03Wxiia3aI")}catch(i){console.error("Erro ao enviar o arquivo:",i)}}const d=async()=>{N.value=!0};function E(i){return i?!0:(console.error("Erro: Nenhum arquivo foi selecionado!"),j.value=!1,!1)}const g=async()=>{if(w.value.$touch(),!w.value.$invalid&&E(O.fileEvent)){const{data:i,error:m,status:C}=await b(V,{method:"POST",body:{ato_id:y.ato_id,descricao:O.descricao,user_id:P("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$WyW0hasRPI");C.value==="success"&&(h.success("Anexo registrado com sucesso!"),q.value.push(i.value))}};async function r(i){i.excluido=!i.excluido;try{await b(`${B}/${i.id}`,{method:"PUT",body:JSON.stringify({excluido:i.excluido})},"$Y3y6TjqbSV")}catch(m){console.error("Erro ao excluir pessoa:",m)}}async function p(i){try{const m=await b(`${T}`,{method:"POST",body:{bucket:P("user-data").value.cartorio_token,path:i.link}},"$bkXJSi7s76"),u=await(await fetch(m.data.value)).blob(),G=URL.createObjectURL(u);window.open(G,"_blank")}catch(m){console.error("Erro ao excluir pessoa:",m)}}const $=()=>{const i=A.query.origem||"criar",m=A.query.id;i==="atualizar"?k.push(`/os/atualizar/${m}`):k.push("/os/criar-registro")};return(i,m)=>{const C=te;return S(),K(ne,null,{default:o(()=>[e(R,null,{default:o(()=>[e(I,{cols:"5",class:"mt-2"},{default:o(()=>[e(Y,{modelValue:t(O).descricao,"onUpdate:modelValue":[m[0]||(m[0]=u=>t(O).descricao=u),t(w).descricao.$touch],"error-messages":t(w).descricao.$errors.map(u=>u.$message),onBlur:t(w).descricao.$touch,required:"",label:"Descrição"},null,8,["modelValue","error-messages","onBlur","onUpdate:modelValue"])]),_:1}),v("div",{onClick:z,title:"Criar",style:{"padding-right":"10px"}},[t(j)===!1?(S(),F("img",dt)):t(j)===!0?(S(),F("img",mt)):(S(),F("img",pt))]),v("div",{onClick:g,title:"Criar"},m[1]||(m[1]=[v("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:re,alt:"Escanear"},null,-1)]))]),_:1}),e(ge,{headers:_,items:t(q),style:{height:"465px","max-width":"600px"}},{"item.actions":o(({item:u})=>[e(R,null,{default:o(()=>[v("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:G=>d(u),title:"Visualizar Anexo"},[v("img",{style:{width:"30px",height:"30px"},onClick:G=>p(u),src:ue,alt:"Visualizar"},null,8,vt)],8,_t),v("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:G=>r(u),title:"Deletar Pessoa"},[u.excluido?(S(),F("img",gt)):(S(),F("img",yt))],8,ft)]),_:2},1024)]),_:1},8,["items"]),e(C,{onClick:$},{default:o(()=>[e(J,{size:"large",color:"red"},{default:o(()=>m[2]||(m[2]=[L("Voltar")])),_:1})]),_:1})]),_:1})}}};export{jt as _,It as a,Nt as b,Bt as c,Ut as d,Ft as e};
