import{r as e,D as a,F as s,h as t,G as o,o as l,A as r,w as n,b as u,P as m,d as i,q as c,J as d,v,a as p,x as f}from"./Cqiv77yc.js";import{u as _}from"./D0-0VRaN.js";import{_ as b}from"./DmmIIbRx.js";import{c as h,r as k,u as w}from"./CnBBmU9u.js";import{a as V,d as $,V as g}from"./oKXwpsuu.js";import{V as j}from"./sftuTnbG.js";import{V as y}from"./B5iMDmra.js";import{V as S}from"./DGrEsPnk.js";const T=p("h1",{class:"ml-4"},"Reimpressão de Selos",-1),P=p("hr",{class:"mb-5"},null,-1),q={__name:"Selos",props:{show:Boolean,ato_token:String},emits:["close"],async setup(q,{emit:O}){let x,B;const D=q,I=e(D.show),R=f(),U=e(a("user-data").value.cartorio_token).value,C=`${R.public.managemant}/listarSelos`,J=`${R.public.managemant}/reimprimirSelo`,z=`${R.public.managemant}/listarEscrevente`,A=e([]),E=e([]),F=s({escrevente:null}),G=O,H={escrevente:{required:h.withMessage("O campo é obrigatorio",k)}},L=w(H,F),M=[{title:"Numero",value:"numero"},{title:"Referencia",value:"referencia"},{value:"actions"}];t((()=>D.show),(e=>{I.value=e,e&&Q()}));const N=()=>{I.value=!1,G("close")},W=e([]),{data:Y}=([x,B]=o((()=>_(z,{method:"POST",body:{cartorio_token:U}},"$V2ulT7DYvP"))),x=await x,B(),x);W.value=Y.value[0].func_json_escreventes;const K=async()=>{if(await L.value.$validate()){const e=E.value.map((e=>({selo_token:e}))),a={escrevente_token:F.escrevente,ato_token:D.ato_token,selos:e},{data:s,error:t,status:o}=await _(`${J}`,{method:"POST",body:a},"$45J51uHTfa");if("success"===o.value){const e=window.open("","_blank");e.document.open(),e.document.write(s.value[0].etiqueta),e.document.close(),N()}}},Q=async()=>{const{data:e,error:a}=await _(`${C}`,{method:"POST",body:{ato_token:D.ato_token}},"$rLWIRtrfDz");a.value||(A.value=e.value.selos)};return(e,a)=>(l(),r(g,{persistent:"",modelValue:c(I),"onUpdate:modelValue":a[2]||(a[2]=e=>v(I)?I.value=e:null),"max-width":"500"},{default:n((()=>[u(V,null,{default:n((()=>[u(j,null,{default:n((()=>[u(y,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:n((()=>[T,u(m,{class:"mt-4 mr-4",style:{color:"red"},onClick:N},{default:n((()=>[i("mdi-close")])),_:1})])),_:1}),P,u(S,{class:"mb-5",label:"Tabelião/escrivão",modelValue:c(F).escrevente,"onUpdate:modelValue":a[0]||(a[0]=e=>c(F).escrevente=e),items:c(W),"item-title":"nome","item-value":"token",required:"","error-messages":c(L).escrevente.$errors.map((e=>e.$message)),onBlur:c(L).escrevente.$touch,onInput:c(L).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"]),u(d,{headers:M,items:c(A),"item-value":"token","show-select":"",modelValue:c(E),"onUpdate:modelValue":a[1]||(a[1]=e=>v(E)?E.value=e:null)},null,8,["items","modelValue"])])),_:1}),u($,null,{default:n((()=>[p("div",null,[p("img",{src:b,style:{cursor:"pointer"},onClick:K})])])),_:1})])),_:1})])),_:1},8,["modelValue"]))}};export{q as _};
