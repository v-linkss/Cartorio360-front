import{_ as oe}from"./CUkK3I4g.js";import{a as ae,_ as re}from"./CB1ATgzw.js";import{_ as se}from"./hqVmkmeP.js";import{_ as ne}from"./BVz1G1IN.js";import{_ as le}from"./DIAdC4EX.js";import{_ as ie}from"./ssBe4qYe.js";import{_ as ue,a as pe}from"./DJvq3mCv.js";import{c as U,r as B,u as de}from"./D_2vOfWt.js";import{u as me}from"./BUxYSy8-.js";import{u as ce,J as _e,C as fe,r as u,e as k,f as ve,s as I,h as ge,j as b,w as n,l as ke,o as c,b as s,a as l,t as he,i as o,m as xe,V as w,q as $e,p as ye,c as S,v as Ve,d as be}from"./CQuBOsNg.js";import{u as C}from"./BmoeFm2G.js";import{f as we}from"./DP0vfqlT.js";import{V as Ce}from"./DUzjHVQl.js";import{V as h}from"./Chx0Tj9q.js";import{V as x}from"./Dyz-Ed-H.js";import{V as Oe}from"./XfnsRPsj.js";import{V as Te}from"./L4ABCn0h.js";import"./CqREEPpR.js";import"./DdDSVdjN.js";import"./aXru670M.js";import"./7020qKcT.js";import"./BJVN5Rf1.js";import"./BBWz33tm.js";import"./Dc8aqalp.js";import"./D8Ey4nSy.js";const Re={style:{color:"red","margin-left":"30px"}},Ae=["onClick"],Ue=["onClick"],Be=["onClick","title"],Ie=["onClick"],Se={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:ue,alt:"Cancelar",title:"Cancelado"},ze={key:1,src:pe,alt:"Cancelado",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"not-allowed",opacity:"0.5"},title:"Não permitido cancelar"},it={__name:"[id]",async setup(Ee){let i,_;const{redirectTo:O}=me(),{$toast:T}=ce(),z=_e(),{id:d}=z.params,E=fe(),f=ke(),N=`${f.public.managemant}/updateOrdensServico`,P=`${f.public.managemant}/getOrdensServicoById`,q=`${f.public.managemant}/listarAtos`,D=`${f.public.managemant}/updateAtos`,F=u(k("user-data").value.cartorio_id),M=u(k("user-data").value.usuario_id),G=u(k("user-service").value.token).value||null,L=u(k("user-data").value.cartorio_token).value,$=u([]),y=u(!1),R=u(null),m=u(null),r=ve({nacionalidade:"brasileiro",apresentante_nome:null,apresentante_cpf:null,documento:null}),j=[{title:"ID",value:"id"},{title:"Protocolo",value:"protocolo"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Valor",value:"valor"},{title:"Tipo",value:"tipo"},{value:"actions"}],J=[{title:"BRASILEIRO",value:!1},{title:"ESTRANGEIRO",value:!0}],K={apresentante_nome:{required:U.withMessage("O campo é obrigatorio",B)},apresentante_cpf:{required:U.withMessage("O campo é obrigatorio",B)}},p=de(K,r);function W(a){if(a)return a.replace(/[.\-]/g,"");a=null}const X=a=>{R.value=a,y.value=!0},Y=a=>{O({item:a,id:d,numeroOs:m.value,origem:"vizualizar"})},Z=a=>{O({item:a,id:d,numeroOs:m.value,origem:"atualizar"})};async function H(){const a={apresentante_cpf:W(r.apresentante_cpf),apresentante_nome:r.apresentante_nome,user_id:M.value,cartorio_id:F.value},{error:t,status:g}=await C(`${N}/${d}`,{method:"PUT",body:a},"$Fud06ay483");g.value==="error"&&t.value.statusCode===500?T.error("Erro ao cadastrar ordem,erro no sistema."):(T.success("Ordem Atualizada com sucesso!"),E.push({path:"/os/lista"}))}const{data:v}=([i,_]=I(()=>C(`${P}/${d}`,{method:"GET"},"$wPUkUpDvPf")),i=await i,_(),i);m.value=v.value.numero,r.nacionalidade=v.value.estrangeiro,r.apresentante_cpf=v.value.apresentante_cpf,r.apresentante_nome=v.value.apresentante_nome;const{data:A}=([i,_]=I(()=>C(q,{method:"POST",body:{cartorio_token:L,ordemserv_token:G}},"$YXZ55K3IUf")),i=await i,_(),i);async function Q(a){a.excluido=!a.excluido;try{await we(`${D}/${a.id}`,{method:"PUT",body:{excluido:a.excluido}})}catch(t){console.error("Erro ao excluir pessoa:",t)}}return A.value.length>0?$.value=A.value:$.value=[],(a,t)=>{const g=oe,ee=re,te=ge("mask");return c(),b(Ce,{class:"mt-5"},{default:n(()=>[s(h,{class:"mb-5"},{default:n(()=>[t[6]||(t[6]=l("h1",null,"Ordem de Serviço nº",-1)),l("h1",Re,he(o(m)),1)]),_:1}),s(h,null,{default:n(()=>[s(x,{md:"3"},{default:n(()=>[s(Oe,{label:"Nacionalidade",items:J,modelValue:o(r).nacionalidade,"onUpdate:modelValue":t[0]||(t[0]=e=>o(r).nacionalidade=e)},null,8,["modelValue"])]),_:1}),s(x,{md:"2"},{default:n(()=>[o(r).nacionalidade==="brasileiro"?xe((c(),b(w,{key:0,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[1]||(t[1]=e=>o(r).apresentante_cpf=e),label:"CPF",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch,onInput:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])),[[te,"###.###.###-##"]]):(c(),b(w,{key:1,autofocus:"",modelValue:o(r).apresentante_cpf,"onUpdate:modelValue":t[2]||(t[2]=e=>o(r).apresentante_cpf=e),label:"Documento",required:"","error-messages":o(p).apresentante_cpf.$errors.map(e=>e.$message),onBlur:o(p).apresentante_cpf.$touch},null,8,["modelValue","error-messages","onBlur"]))]),_:1}),s(x,{md:"4"},{default:n(()=>[s(w,{modelValue:o(r).apresentante_nome,"onUpdate:modelValue":t[3]||(t[3]=e=>o(r).apresentante_nome=e),label:"Nome Apresentante",required:"","error-messages":o(p).apresentante_nome.$errors.map(e=>e.$message),onInput:o(p).apresentante_nome.$touch},null,8,["modelValue","error-messages","onInput"])]),_:1}),s(x,null,{default:n(()=>[l("div",null,[l("img",{style:{width:"40px",height:"40px",cursor:"pointer"},src:se,alt:"Salvar",onClick:t[4]||(t[4]=e=>H())})])]),_:1})]),_:1}),s(h,{style:{display:"flex","margin-bottom":"10px",gap:"2rem"}},{default:n(()=>[t[10]||(t[10]=l("h1",{class:"ml-5"},"Atos",-1)),s(g,{to:{path:"/os/criar-ato",query:{origem:"atualizar",id:o(d),numeroOs:o(m)}}},{default:n(()=>t[7]||(t[7]=[l("img",{style:{width:"45px",height:"45px",cursor:"pointer"},src:ne,alt:"novo"},null,-1)])),_:1},8,["to"]),s(Te,{headers:j,items:o($),"item-key":"id"},{"item.actions":n(({item:e})=>[s(h,{style:{display:"flex",gap:"2px","margin-top":"-5px"}},{default:n(()=>[l("div",{onClick:V=>Y(e),title:"Visualizar"},t[8]||(t[8]=[l("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:le,alt:"Visualizar"},null,-1)]),8,Ae),l("div",{onClick:V=>X(e.token),title:"Reimprimir"},t[9]||(t[9]=[l("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ae,alt:"Reimprimir"},null,-1)]),8,Ue),l("div",{class:ye({disabled:!e.btn_editar}),onClick:V=>e.btn_editar?Z({id:e.id,tipo:e.tipo,token:e.token,tipo_token:e.tipo_token,rota:e.rota}):null,title:e.btn_editar?"Editar":"Desabilitado"},[l("img",{style:$e({cursor:e.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ie,alt:"Editar"},null,4)],10,Be),l("div",{onClick:V=>e.btn_cancelar?Q(e):null,title:"Excluir"},[e.btn_cancelar?(c(),S("img",Se)):(c(),S("img",ze))],8,Ie)]),_:2},1024)]),_:1},8,["items"]),s(ee,{show:o(y),ato_token:o(R),onClose:t[5]||(t[5]=e=>y.value=!1)},null,8,["show","ato_token"])]),_:1}),s(g,{to:"/os/lista"},{default:n(()=>[s(Ve,{size:"large",color:"red"},{default:n(()=>t[11]||(t[11]=[be("Voltar")])),_:1})]),_:1})]),_:1})}}};export{it as default};
