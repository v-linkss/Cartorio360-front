import{_ as mo}from"./BB5g5H0c.js";import{_ as po}from"./gRonRht6.js";import{_ as _o,a as co}from"./CGgQMpH8.js";import{_ as vo}from"./kn_-dDtu.js";import{_ as fo}from"./F5UWsY7J.js";import{_ as yo}from"./BVz1G1IN.js";import{_ as B}from"./2oziMKHg.js";import{_ as ko}from"./CqJRgiLh.js";import{_ as Vo,a as bo}from"./DJvq3mCv.js";import{_ as go,u as ho,m as xo,r as i,n as k,p as $o,q as Ao,s as So,v as wo,x as j,y as Co,o as h,w as n,b as s,a as d,z as V,V as m,A as l,B as Do,C as Oo,c as J,D as Uo}from"./D2uGBfno.js";import{u as b}from"./DqOM1bED.js";import{f as x}from"./B0IxRygJ.js";import{f as To}from"./l-wIl2Kx.js";import{V as C}from"./CRVYtyGn.js";import{V as u}from"./CpiuKkFR.js";import{V as D}from"./XGU8fkCI.js";import{V as No}from"./Dm-E1S2y.js";import{V as Eo}from"./CXo5kPoz.js";import"./CVJPmcj0.js";import"./8lICIRtx.js";import"./C_ZRys4f.js";import"./vOHzmBp0.js";import"./Yj1LSECv.js";import"./DjbW8UzK.js";import"./4YJDhSw9.js";import"./CRj4qXtZ.js";import"./DJ2XdKg4.js";const Po={style:{display:"flex",gap:"4px","justify-content":"center"}},qo=["onClick"],Io=["onClick"],Ro=["onClick","title"],zo=["disabled","onClick"],Mo={key:0,style:{width:"30px",height:"30px",cursor:"pointer"},src:Vo,alt:"Visualizar",title:"Reativar"},Fo={key:1,src:bo,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px",cursor:"pointer"},title:"Excluir"},Lo={__name:"index",setup(Bo){const v=Co(),{$toast:Y}=ho(),H=`${v.public.managemant}/listarUsuarios`,Q=`${v.public.managemant}/listarOrdensServico`,W=`${v.public.managemant}/tipoAtos`,X=`${v.public.managemant}/updateAtos`,O=`${v.public.managemant}/pesquisaAtos`,U=xo(),$=i(k("auth_token").value)||null,g=i(k("user-data").value.cartorio_token)||null,A=i(!1),T=i([]),_=i([]),N=i([]),E=i([]),Z=i(["PENDENTE","EM ANDAMENTO","CONCLUÍDA","LAVRADA"]),P=i(!1),q=i(!1),I=i(null),G=i(null),R=i(null),K=i({}),z=i(!1),oo=i(null),a=$o({numero:null,data_inicio:S(),data_fim:S(),data_lavratura_inicio:null,data_lavratura_fim:null,protocolo:null,livro:null,folha:null,situacao:null,usuario_token:$.value,selo:null,ato_tipo_token:null,apresentante_cpf:null,apresentante_nome:null,valor:null}),eo=[{title:"ID",value:"id"},{title:"Data Abertura",value:"dt_abertura"},{title:"Data lavratura",value:"dt_lavratura"},{title:"N° OS",value:"numero_os"},{title:"Protocolo",value:"protocolo"},{title:"Apresentante",value:"apresentante_nome"},{title:"CPF",value:"apresentante_cpf"},{title:"Tipo Serviço",value:"ato_servico"},{title:"Usuario",value:"usuario_nome"},{title:"Situação",value:"situacao"},{title:"Livro",value:"livro_numero"},{title:"Folha",value:"folha"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];function S(){const e=new Date,o=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${r}-${o}`}function c(e){if(!e)return null;const[o,r,p]=e.split("/");return`${p}-${r}-${o}`}async function M(){const{data:e}=await b(O,{method:"POST",body:{cartorio_token:k("user-data").value.cartorio_token}},"$1U9Iv6Es1X");_.value=e.value}async function to(){const{data:e}=await b(H,{method:"POST",body:{cartorio_token:g.value}},"$hvipqUJYtS");N.value=e.value}async function ao(){try{sessionStorage.setItem("pesquisaOS",JSON.stringify(a));const{data:e,error:o}=await b(O,{method:"POST",body:{cartorio_token:g.value,numero:a.numero||null,data_inicio:c(a.data_inicio)||null,data_fim:c(a.data_fim)||null,data_lavratura_inicio:c(a.data_lavratura_inicio)||null,data_lavratura_fim:c(a.data_lavratura_fim)||null,protocolo:a.protocolo||null,livro:a.livro||null,folha:a.folha||null,situacao:a.situacao||null,usuario_token:a.usuario_token,selo:a.selo||null,ato_tipo_token:a.ato_tipo_token,apresentante:a.apresentante||null}},"$OjamgBH6nj");_.value.length>0?_.value=_.value.map(r=>({...r,data:r.data?x(r.data,"dd/mm/yyyy"):null,dt_abertura:r.dt_abertura?x(r.dt_abertura,"dd/mm/yyyy"):null})):(_.value=[],Y.error("Não existe ato Registrado!"))}catch(e){console.error("Erro na requisição",e)}}const lo=e=>{U.push({path:`/fontes/atos/atos-com-bem/atualizar/${e.id}`,query:{origem:"vizualizar",id:e.id,ato_id:e.id,tipo_ato_token:e.tipo_token,tipo_ato:e.tipo,ato_token_edit:e.token,numero_os:e.numero_os,usa_imoveis:e.usa_imoveis}})};async function so(){const{data:e,error:o}=await b(W,{method:"POST",body:{cartorio_token:g.value,usuario_token:$.value}},"$QxIfw0Zxe4");E.value=e.value}const F=async()=>{try{const e=S(),o=sessionStorage.getItem("pesquisaOS"),r=JSON.parse(o),{data:p,error:L}=await b(Q,{method:"POST",body:{cartorio_token:g.value,usuario_token:r.usuario_token||$.value,data_fim:c(r==null?void 0:r.data_fim)||e,data_inicio:c(r==null?void 0:r.data_inicio)||e}},"$ceiptlfDNO");p.value.length>0?T.value=p.value.map(f=>({...f,data:x(f.data,"dd/mm/yyyy"),dt_abertura:x(f.dt_abertura,"dd/mm/yyyy")})):T.value=[]}catch(e){console.error("Erro ao buscar serviços",e)}};async function no(e){e.excluido=!e.excluido;try{await To(`${X}/${e.id}`,{method:"PUT",body:{excluido:e.excluido}})}catch(o){console.error("Erro ao excluir pessoa:",o)}}const ro=e=>{(e.usa_imoveis||!e.usa_imoveis)&&U.push({path:`/fontes/atos/atos-com-bem/atualizar/${e.id}`,query:{origem:"atualizar",id:e.id,ato_id:e.id,tipo_ato_token:e.tipo_token,tipo_ato:e.tipo,ato_token_edit:e.token,numero_os:e.numero_os,usa_imoveis:e.usa_imoveis}})},io=()=>{const e=k("user-service"),o=k("ordem-button");e.value=null,I.value=!0,o.value=I.value};return Ao(()=>{So(async()=>{const e=sessionStorage.getItem("pesquisaOS");if(e){const o=JSON.parse(e);Object.assign(a,o)}await F(),await M()})}),to(),so(),M(),(e,o)=>{const r=mo,p=po,L=co,f=vo,uo=fo,y=wo("mask");return h(),j(Eo,{class:"mt-5",style:{width:"100%"}},{default:n(()=>[s(C,{class:"mb-5"},{default:n(()=>[o[19]||(o[19]=d("h1",null,"Atos",-1)),s(r,{to:"/os/criar-registro"},{default:n(()=>[d("img",{style:{width:"60px",height:"60px",cursor:"pointer","margin-left":"70px"},src:yo,alt:"novo",onClick:io})]),_:1})]),_:1}),s(C,null,{default:n(()=>[s(u,{cols:"2"},{default:n(()=>[V(s(m,{modelValue:l(a).data_inicio,"onUpdate:modelValue":o[0]||(o[0]=t=>l(a).data_inicio=t),label:"Abertura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:n(()=>[V(s(m,{modelValue:l(a).data_fim,"onUpdate:modelValue":o[1]||(o[1]=t=>l(a).data_fim=t),label:"Abertura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:n(()=>[V(s(m,{modelValue:l(a).data_lavratura_inicio,"onUpdate:modelValue":o[2]||(o[2]=t=>l(a).data_lavratura_inicio=t),label:"Lavratura de",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:n(()=>[V(s(m,{modelValue:l(a).data_lavratura_fim,"onUpdate:modelValue":o[3]||(o[3]=t=>l(a).data_lavratura_fim=t),label:"Lavratura até",placeholder:"dd/mm/yyyy",dense:""},null,8,["modelValue"]),[[y,"##/##/####"]])]),_:1}),s(u,{cols:"2"},{default:n(()=>[V(s(m,{modelValue:l(a).apresentante_cpf,"onUpdate:modelValue":o[4]||(o[4]=t=>l(a).apresentante_cpf=t),label:"CPF",dense:""},null,8,["modelValue"]),[[y,"###.###.###-##"]])]),_:1}),s(u,{cols:"2"},{default:n(()=>[s(m,{modelValue:l(a).selo,"onUpdate:modelValue":o[5]||(o[5]=t=>l(a).selo=t),label:"Selo",dense:""},null,8,["modelValue"])]),_:1})]),_:1}),s(C,null,{default:n(()=>[s(u,{cols:"2"},{default:n(()=>[s(m,{modelValue:l(a).numero,"onUpdate:modelValue":o[6]||(o[6]=t=>l(a).numero=t),label:"N° OS"},null,8,["modelValue"])]),_:1}),s(u,{cols:"2"},{default:n(()=>[s(m,{modelValue:l(a).protocolo,"onUpdate:modelValue":o[7]||(o[7]=t=>l(a).protocolo=t),label:"Protocolo"},null,8,["modelValue"])]),_:1}),s(u,{cols:"3"},{default:n(()=>[s(m,{modelValue:l(a).apresentante,"onUpdate:modelValue":o[8]||(o[8]=t=>l(a).apresentante=t),label:"Apresentante",dense:""},null,8,["modelValue"])]),_:1}),s(u,{cols:"3"},{default:n(()=>[s(D,{modelValue:l(a).ato_tipo_token,"onUpdate:modelValue":o[9]||(o[9]=t=>l(a).ato_tipo_token=t),items:l(E),"item-title":"descricao","item-value":"token",label:"Tipo Serviço",dense:""},null,8,["modelValue","items"])]),_:1}),s(u,{cols:"2"},{default:n(()=>[s(D,{items:l(N),modelValue:l(a).usuario_token,"onUpdate:modelValue":o[10]||(o[10]=t=>l(a).usuario_token=t),"item-title":"user_nome","item-value":"user_token",label:"Usuário",dense:""},null,8,["items","modelValue"])]),_:1}),s(u,{cols:"3"},{default:n(()=>[s(D,{modelValue:l(a).situacao,"onUpdate:modelValue":o[11]||(o[11]=t=>l(a).situacao=t),items:l(Z),label:"Situação",dense:""},null,8,["modelValue","items"])]),_:1}),s(u,{cols:"1"},{default:n(()=>[s(m,{modelValue:l(a).livro,"onUpdate:modelValue":o[12]||(o[12]=t=>l(a).livro=t),label:"Livro",dense:""},null,8,["modelValue"])]),_:1}),s(u,{cols:"1"},{default:n(()=>[s(m,{modelValue:l(a).folha,"onUpdate:modelValue":o[13]||(o[13]=t=>l(a).folha=t),label:"Folha",dense:""},null,8,["modelValue"])]),_:1}),s(u,null,{default:n(()=>[d("div",null,[d("img",{onClick:ao,style:{width:"40px",height:"40px",cursor:"pointer"},src:B,alt:"Pesquisar"})])]),_:1})]),_:1}),o[22]||(o[22]=d("hr",{class:"mt-5 mb-5"},null,-1)),s(No,{headers:eo,items:l(_),"item-key":"id"},{"item.actions":n(({item:t})=>[d("div",Po,[d("div",{onClick:w=>lo(t),title:"Visualizar"},o[20]||(o[20]=[d("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:B,alt:"Visualizar"},null,-1)]),8,qo),d("div",{onClick:w=>e.redirectToModalReimprimir(t.token),title:"Reimprimir"},o[21]||(o[21]=[d("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:_o,alt:"Reimprimir"},null,-1)]),8,Io),d("div",{class:Do({disabled:!t.btn_editar}),onClick:w=>t.btn_editar?ro({id:t.id,tipo:t.tipo,token:t.token,tipo_token:t.tipo_token,usa_imoveis:t.usa_imoveis}):null,title:t.btn_editar?"Editar":"Desabilitado"},[d("img",{style:Oo({cursor:t.btn_editar?"pointer":"default",width:"30px",height:"30px"}),src:ko,alt:"Editar"},null,4)],10,Ro),d("div",{disabled:!t.btn_cancelar,onClick:w=>t.btn_cancelar?no(t):null,title:"Excluir"},[t.excluido?(h(),J("img",Mo)):(h(),J("img",Fo))],8,zo)])]),_:1},8,["items"]),l(A)?(h(),j(p,{key:0,show:l(A),servicos:e.dadosData.servicos||[],tiposAtos:e.dadosData.tiposAtos||[],onClose:o[14]||(o[14]=t=>A.value=!1),onUpdateAto:e.handleUpdateAto},null,8,["show","servicos","tiposAtos","onUpdateAto"])):Uo("",!0),s(L,{show:l(z),ato_token:l(oo),onClose:o[15]||(o[15]=t=>z.value=!1)},null,8,["show","ato_token"]),s(f,{show:l(P),numero_os:l(R),ordem:l(K),onClose:o[16]||(o[16]=t=>P.value=!1),onRefreshValue:o[17]||(o[17]=t=>F())},null,8,["show","numero_os","ordem"]),s(uo,{show:l(q),numero_os:l(R),ordemserv_token:l(G),onClose:o[18]||(o[18]=t=>q.value=!1)},null,8,["show","numero_os","ordemserv_token"])]),_:1})}}},ye=go(Lo,[["__scopeId","data-v-6ef57df6"]]);export{ye as default};
