import{_ as X}from"./C2UxiK3A.js";import{a as h,d as $,V as E}from"./B6LS7lpe.js";import{V as N}from"./DsLYeT_F.js";import{V as C,u as _}from"./Cvp2CtMV.js";import{r as A,g as Q,o as j,G as q,w as r,b as a,a as m,A as B,d as w,v as n,x as O,u as ee,m as G,D as oe,t as H,V as I,s as le,bx as ae}from"./6WvddAsj.js";import{_ as re}from"./BVz1G1IN.js";import{V as te}from"./BXM1UxqR.js";import{V as se}from"./BuW5Dw_U.js";const ne={__name:"ModalRecebimentoCond",props:{show:Boolean,faltaReceber:Number},emits:["close","confirmar"],setup(x,{emit:k}){const o=x,v=A(o.show),p=k;Q(()=>o.show,V=>{v.value=V});const b=()=>{p("confirmar"),c()},c=()=>{v.value=!1,p("close")};return(V,s)=>(j(),q(E,{persistent:"",modelValue:n(v),"onUpdate:modelValue":s[0]||(s[0]=R=>O(v)?v.value=R:null),"max-width":"650"},{default:r(()=>[a(h,null,{default:r(()=>[a(N,null,{default:r(()=>[a(C,{class:"mb-5 mt-1 ml-2"},{default:r(()=>s[1]||(s[1]=[m("h1",null,"Confirmação de Recebimento",-1)])),_:1}),a(C,{class:"ml-2"},{default:r(()=>s[2]||(s[2]=[m("p",null," O valor recebido é menor que o valor da OS, confirma o recebimento parcial? ",-1)])),_:1})]),_:1}),a($,null,{default:r(()=>[a(B,{style:{"background-color":"#429946",color:"white"},onClick:b},{default:r(()=>s[3]||(s[3]=[w("Confirmar")])),_:1}),a(B,{style:{"background-color":"red",color:"white"},onClick:c},{default:r(()=>s[4]||(s[4]=[w("Cancelar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAABJhJREFUeJztW81v3EQcfTM73ZU3C1GF4NJAG+UGSKgSjZAgfwCFHnMpiAMSyckHGim2FAl8cSRvFFopApEixIW/APFx48IKCS5wQOKGGpqWAx/SqhslMY6HS1PZg+0de2fsSdN3m/HM6Ofn37zxPI8JNMO27Y5lWcuEkKsAngcwNabLHoBfOOefd7vdm57nhTrjIzoHX1tbOxdF0VcAXqg4xM+Msdd937+jMq4ktBFg23an2+3+gOo3f4yfLMt6SVcmUB2DAoBlWcuY/OYB4OL+/v47CsbJBNM1MCHkjWSZc/41gOV+v79b1G91dXWGEHITwKuJ6jcBfKg+So0ZAOBZoTz25gGg3+/vMsaWhern1IWVhk4CesmCzM0fw/f920LVY0oiyoBOAk4Exq4CjuNcAXANwCWMX8NNwR6AH+M4/mBjY+PLooatoouu664D+AjABQBtZeHpRxvALCHk6sLCwpnBYPBtXsPcDLj/5L/QEV3diOP4Sl4mFGnANU3x1A5K6bt514reA14Uyi8HQfC9mpD0wnGcVwB8l6i6lNe2KANSy9hJuXkACIJgIFTlLqOnfhl8REDTATSNU0+A9G7QcRyuM5CmcOozoIgA6d2b6eCci7vLBygiYAkPAQmc89uU0qW861KeoOM4OwCeOS5HUXRhc3NzR0F8yrCysnKeMXYrUfV7EATnx/WT1YBRssAY6+U1bAqdTkd827sn068SAZRS4wiIokiMaZTZUEAlAo6OjowjIOOhSBEg9R5ACBlxzpPlXAIcx3kNwDYADmApCIJv6mgXx3GPkJSkqcsAzvlIKBdlwMcAzgGY4Zxv19VOfCiEEKVTICUolNIil3YmEcTTNbZLxRTHsToRLJkBjUBrBlBKU4MVaUCDSDnWhJA9mU6yUyA1GOfcOHs8juPUQxGzNg+VpgA0fqmZAKmYtIqgiVNAjOmRCOoUQQiOsQkQH4pSDYjj2HgCIMTUarXUEcAYO3EimPHQMiFFwOHhoSgoxmVAhi6pE8F2u238FBBFMAxDdRkwGo2MJwBCTNPT0+oI2NraOgTwb6Kq7XmeMecFbNvuADiTqAplj9WVscVTjA6HQ2OyoNfrVTJDgBIEiOvqmC1xrQjDUD8B4puVScZohiGqngD83xQxhoAMQ1RqCQQm0ACTjNGqhigwwRQwaUcoegGoQwRN2hFW3QkCD8kqAGEfILsTBCYQQZMzADpE0HBjtJIhCpTLAGON0aqGKDCBBsAsT6CSIQpMQEDBFHhwqKLoZIbKdmIsTYvgEoDdcSczVLabRASlT4lRSlNfiJHjCdz/elv0DU95u6qGKFAiAww3RisZokA5DfhbqJr1PK/xY3aLi4stALPJuiiK/pHtL30DU1NTO0gvhU8dHBxcd133rOwYquG67tm5ubkbAJ5MVN8bDoe3ZMco9eeo4zifAni7TJ8G8EkQBEWimkKpFGaMvQfgr9Ih1Yc/W63W+2U6lCLA9/07hJDLAP4oFVY9uMs5v7y+vl4qtsK/xrIwGAzuzs/Pf8YYCznnTxBCHofGX3DH4ADArwC2CSFvBUHwW9kB/gMs68lWOHHFdwAAAABJRU5ErkJggg==",ie={style:{color:"red","margin-left":"18px"}},ue={style:{"max-width":"180px"}},de=["onClick"],ce={style:{display:"flex","justify-content":"flex-start"}},Oe={__name:"Ordem",props:{show:Boolean,ordem:{type:Object,required:!0}},emits:["close"],setup(x,{emit:k}){const o=x,v=k,{$toast:p}=ee(),b=A(o.show),c=A(!1),V=le(),s=`${V.public.managemant}/listarFormasReceb`,R=`${V.public.managemant}/receberOs`,J=G("auth_token").value,y=A([]),F=A(null),g=A([]),M=A([]),i=oe({descricao:null,forma:null,valor:""}),Y=[{title:"Forma",value:"forma"},{title:"Valor",value:"valor"},{value:"actions"}],u=A(0),K=()=>{u.value=d(o.ordem.valor-o.ordem.valor_pago)};Q(()=>o.show,l=>{b.value=l,l&&K()});const S=()=>{b.value=!1,Object.assign(i,{forma:null,descricao:null,valor:""}),g.value=[],v("close")},L=()=>{F.value=Number(o.ordem.valor),c.value=!0},U=async()=>{try{const l={ordemserv_token:o.ordem.token,usuario_token:J,recebimentos:[M.value]};console.log(l);const{data:e}=await _(R,{method:"POST",body:JSON.stringify(l)},"$vhMIR8Sr2p");e.value[0].status==="OK"?(p.success(`${e.value[0].status}: Valores Recebidos com Sucesso!`),g.value=[],S()):p.error(e.value[0].status_mensagem)}catch(l){p.error(l)}},T=()=>{o.ordem.valor=d(o.ordem.valor),o.ordem.valor_pago=d(o.ordem.valor_pago),u.value=d(u.value)},d=l=>Number(parseFloat(l).toFixed(2)),W=async()=>{try{const e={cartorio_token:G("user-data").value.cartorio_token},{data:f}=await _(s,{method:"POST",body:JSON.stringify(e)},"$eiMzO5y6Bb");y.value=ae(f.value)}catch(l){console.error("Erro ao carregar formas de pagamento:",l)}},z=()=>{const l=y.value.find(f=>f.token===i.forma);if(!l)return p.error("Por favor, selecione uma forma.");const e=D(i.valor);g.value.push({forma:i.forma,descricao:l.descricao,valor:e}),M.value.push({forma_receb_token:i.forma,valor:e}),o.ordem.valor_pago=d(o.ordem.valor_pago+e),o.ordem.valor=d(o.ordem.valor-e),u.value=d(u.value-e),Object.assign(i,{forma:null,valor:"0.00"}),T()},P=l=>{const e=g.value.indexOf(l);if(e!==-1){g.value.splice(e,1),M.value.splice(e,1);const f=D(l.valor);o.ordem.valor_pago=d(o.ordem.valor_pago-f),u.value=d(u.value+f)}T()},D=l=>Number(l.toString().replace(/,/g,""));return W(),(l,e)=>{const f=X,Z=ne;return j(),q(E,{persistent:"",modelValue:n(b),"onUpdate:modelValue":e[7]||(e[7]=t=>O(b)?b.value=t:null),"max-width":"650"},{default:r(()=>[a(h,null,{default:r(()=>[a(N,null,{default:r(()=>[a(C,{class:"mb-5 mt-1 ml-2"},{default:r(()=>[e[8]||(e[8]=m("h1",null,"Ordem de Serviço nº",-1)),m("h1",ie,H(o.ordem.numero),1)]),_:1}),a(N,null,{default:r(()=>[a(C,null,{default:r(()=>[a(I,{class:"mr-5",label:"Recebido",modelValue:o.ordem.valor_pago,"onUpdate:modelValue":e[0]||(e[0]=t=>o.ordem.valor_pago=t),readonly:"",style:{"font-weight":"bold",cursor:"default","pointer-events":"none"}},null,8,["modelValue"]),a(I,{label:"Falta Receber",modelValue:n(u),"onUpdate:modelValue":e[1]||(e[1]=t=>O(u)?u.value=t:null),readonly:"",style:{"font-weight":"bold",cursor:"default","pointer-events":"none"}},null,8,["modelValue"])]),_:1}),a(C,null,{default:r(()=>[a(te,{class:"mb-5 mr-5",label:"Forma",modelValue:n(i).forma,"onUpdate:modelValue":e[2]||(e[2]=t=>n(i).forma=t),items:n(y),"item-title":"descricao","item-value":"token"},null,8,["modelValue","items"]),m("div",ue,[a(f,{modelValue:n(i).valor,"onUpdate:modelValue":e[3]||(e[3]=t=>n(i).valor=t)},null,8,["modelValue"])]),m("div",null,[m("img",{src:re,class:"ml-5",style:{cursor:"pointer",height:"40px",width:"40px"},onClick:z})])]),_:1})]),_:1}),e[10]||(e[10]=m("hr",{class:"mb-5"},null,-1)),a(se,{headers:Y,items:n(g),"item-value":"token"},{"item.forma":r(({item:t})=>[w(H(t.descricao),1)]),"item.actions":r(({item:t})=>[m("div",{style:{display:"flex","justify-content":"flex-end"},onClick:fe=>P(t),title:"Remover"},e[9]||(e[9]=[m("img",{src:me,style:{width:"30px",height:"30px",cursor:"pointer"},alt:"Remover"},null,-1)]),8,de)]),_:1},8,["items"])]),_:1}),m("div",ce,[a(B,{class:"ml-8",size:"large",onClick:S,color:"red"},{default:r(()=>e[11]||(e[11]=[w("Voltar")])),_:1}),a(B,{size:"large",class:"ml-6 mb-6",color:"green",onClick:e[4]||(e[4]=t=>o.ordem.valor>0?L():U())},{default:r(()=>e[12]||(e[12]=[w(" Salvar ")])),_:1})])]),_:1}),a(Z,{modelValue:n(c),"onUpdate:modelValue":e[5]||(e[5]=t=>O(c)?c.value=t:null),faltaReceber:n(F),onClose:e[6]||(e[6]=t=>c.value=!1),onConfirmar:U},null,8,["modelValue","faltaReceber"])]),_:1},8,["modelValue"])}}};export{Oe as _};
