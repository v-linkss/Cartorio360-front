import{_ as re}from"./NfGI4c2C.js";import{u as te,n as ae,q as W,r as i,s as ce,o as U,v as ne,w as t,b as e,x as a,V as Z,y as F,d as T,z as K,A as L,B as ee,a as p,c as N,C as Y,D as Ue,E as Ie,F as Re,G as $e,H as ve,h as je,I as be,t as oe}from"./BWp26XiA.js";import{u as b}from"./Dza4VQPZ.js";import{V as E}from"./BXDwYriJ.js";import{V as O}from"./Cej0_fg3.js";import{V as se}from"./CDtMEycU.js";import{V as ue}from"./BjUUrmEq.js";import{_ as Fe,V as Be,a as X,b as Ne,c as Q}from"./aOapf0X9.js";import{_ as Le,a as Ge,b as He,T as Je,W as We,S as Ke,r as ke,D as we,c as Xe,d as Qe,e as Ye}from"./Dlny-kOl.js";import{_ as fe}from"./D6JuZ3ST.js";import{_ as ie,V as ge,a as ye,b as he,c as Ze}from"./DMDVqZtv.js";import{V as Ve,a as de}from"./BIvjekgT.js";import{V as et}from"./CL1qbLii.js";import{_ as xe}from"./DfjuBLsA.js";import{c as tt,r as at,u as ot}from"./BZSWoGfM.js";import"./CWtsZuXR.js";import"./DA2zxhso.js";import"./BctQa-7Q.js";import"./B5gqmf5E.js";const st={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(G){const l=G,{$toast:v}=te(),_=K(),y=ae(),n=W(),$=`${_.public.managemant}/updateAtos`,D=i(l.item_situacoes),V=ce({dt_abertura:l.item_dados[0].dt_abertura||null,status:l.item_dados[0].status||null,mne:l.item_dados[0].mne||null});async function I(){const{data:f,error:d,status:C}=await b(`${$}/${n.query.ato_id}`,{method:"PUT",body:{status:V.status,mne:V.mne,dt_abertura:V.dt_abertura}},"$EIT5jtTUdX");C.value==="success"&&v.success("Ato Atualizado com sucesso")}const z=()=>{const f=n.query.origem||"criar",d=n.query.id;f==="atualizar"?y.push(`/os/atualizar/${d}`):y.push("/os/criar-registro")};return(f,d)=>{const C=re;return U(),ne(ue,null,{default:t(()=>[e(E,{class:"mt-5"},{default:t(()=>[e(O,{cols:"3"},{default:t(()=>[e(se,{label:"Situação",modelValue:a(V).status,"onUpdate:modelValue":d[0]||(d[0]=k=>a(V).status=k),items:a(D),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(E,null,{default:t(()=>[e(O,{cols:"5"},{default:t(()=>[e(Z,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:a(V).mne,"onUpdate:modelValue":d[1]||(d[1]=k=>a(V).mne=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:t(()=>[e(O,{cols:"2"},{default:t(()=>[e(Z,{modelValue:a(V).dt_abertura,"onUpdate:modelValue":d[2]||(d[2]=k=>a(V).dt_abertura=k),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(E,{class:"mb-3"},{default:t(()=>[e(C,{onClick:z},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[T("Voltar")]),_:1})]),_:1}),e(F,{class:"ml-10",onClick:I,size:"large",color:"green"},{default:t(()=>[T("Atualizar")]),_:1})]),_:1})]),_:1})}}},rt=["onClick"],nt=p("img",{style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar"},null,-1),lt=[nt],it=["onClick"],ct=p("img",{style:{width:"30px",height:"30px"},src:Ze,alt:"Visualizar"},null,-1),ut=[ct],dt=["onClick"],mt={key:0,style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar",title:"Reativar"},pt={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},_t=["onClick"],vt=p("img",{style:{width:"30px",height:"30px"},src:He,alt:"Visualizar"},null,-1),ft=[vt],gt={__name:"Partes",async setup(G){let l,v;const _=ae(),y=W(),n=K(),{$toast:$}=te(),D=`${n.public.managemant}/pesquisarPessoas`,V=`${n.public.managemant}/listarPapeis`,I=`${n.public.managemant}/getLinkTipo`,z=`${n.public.managemant}/createAtosPessoa`,f=`${n.public.managemant}/updateAtosPessoa`,d=`${n.public.managemant}/getAtosPessoaById`,C=i(L("user-data").value.cartorio_token),k=i([]),P=i([]),S=i([]),q=i(!1),R=i(!1),M=i(!1),o=i(!1),s=i(null),c=i(null),r=i(null),u=i(null),w=i(null),h=i("xkyaA"),j=i(null),me=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],x=ce({papeis:null,nome:null,pessoa:null,documento:null}),{data:Pe}=([l,v]=ee(()=>b(V,{method:"POST",body:{tipo_ato_token:"xkyaA"}},"$acoiTIUp00")),l=await l,v(),l);S.value=Pe.value;const pe=async()=>{const{data:g}=await b(`${d}/${y.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),B=(le=>le.map(H=>({...H,pessoa:{...H.pessoa,documento:H.pessoa.doc_identificacao},papel:{...H.partes_tipos}})))(g.value);P.value=B};pe();async function Ce(){try{const{data:g,error:m}=await b(D,{method:"POST",body:{cartorio_token:C.value,documento:x.documento,nome:x.nome}},"$pr30MyPXfY");g.value.length>0?(k.value=g.value,x.pessoa=k.value[0]):k.value=[]}catch(g){console.error("Erro na requisição",g)}}const Ae=()=>{R.value=!0},Ee=async()=>{await pe()},Te=async()=>{await pe()},qe=async()=>{const g={pessoa:x.pessoa,papel:S.value.find(J=>J.id===x.papeis),representante:{nome:null}},m=await b(`${d}/${y.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const J of m.data.value)if(J.pessoa_id===x.pessoa.id&&J.ato_id===Number(y.query.ato_id)&&J.tipo_parte_id===x.papeis){$.error("Pessoa Já Registrada Com Esse Papel!");return}const{data:B,error:le,status:H}=await b(z,{method:"POST",body:{ato_id:y.query.ato_id,pessoa_id:x.pessoa.id,tipo_parte_id:x.papeis,user_id:L("user-data").value.usuario_id}},"$18isAgOJxG");H.value==="success"&&(g.id=B.value.id,$.success("Pessoa Registrada com Sucesso!"),P.value.push(g))},ze=async g=>{M.value=!0,j.value=null;const{data:m}=await b(`${I}`,{method:"POST",body:{id:g.pessoa.id,tipo:"ficha"}},"$hmDzSF3F61");m.value&&m.value.link?j.value=`data:image/jpeg;base64,${m.value.link}`:j.value=null},Oe=g=>{const m=P.value.filter(B=>B.pessoa.id!==g.pessoa.id).map(B=>({id:B.pessoa.id,nome:B.pessoa.nome}));r.value=g.id,s.value=m,q.value=!0,c.value=g.pessoa.nome,w.value=g.pessoa.id},De=g=>{o.value=!0,u.value=g.id,c.value=g.pessoa.nome};async function Se(g){g.excluido=!g.excluido;try{await b(`${f}/${g.id}`,{method:"PUT",body:JSON.stringify({excluido:g.excluido})},"$l09I6nLRfk")}catch(m){console.error("Erro ao excluir pessoa:",m)}}const Me=()=>{const g=y.query.origem||"criar",m=y.query.id;g==="atualizar"?_.push(`/os/atualizar/${m}`):_.push("/os/criar-registro")};return(g,m)=>{const B=Fe,le=Le,H=Ge,J=re;return U(),ne(ue,null,{default:t(()=>[e(E,{class:"mt-5"},{default:t(()=>[e(O,{cols:"3"},{default:t(()=>[e(Z,{label:"Documento",modelValue:a(x).documento,"onUpdate:modelValue":m[0]||(m[0]=A=>a(x).documento=A)},null,8,["modelValue"])]),_:1}),e(O,{cols:"4"},{default:t(()=>[e(Z,{label:"Pessoa",modelValue:a(x).nome,"onUpdate:modelValue":m[1]||(m[1]=A=>a(x).nome=A)},null,8,["modelValue"])]),_:1}),p("div",null,[p("img",{class:"mt-1",src:fe,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:Ce})]),p("div",null,[p("img",{class:"mt-1 ml-2",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Ae})])]),_:1}),e(E,null,{default:t(()=>[e(O,{cols:"4"},{default:t(()=>[e(se,{label:"Selecione a Pessoa",modelValue:a(x).pessoa,"onUpdate:modelValue":m[2]||(m[2]=A=>a(x).pessoa=A),items:a(k),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(O,{cols:"3"},{default:t(()=>[e(se,{label:"Papel",modelValue:a(x).papeis,"onUpdate:modelValue":m[3]||(m[3]=A=>a(x).papeis=A),items:a(S),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),p("div",null,[p("img",{class:"mt-1",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:qe})])]),_:1}),e(E,null,{default:t(()=>[e(O,null,{default:t(()=>[e(ge,{style:{height:"465px"},headers:me,items:a(P)},{"item.actions":t(({item:A})=>[e(E,null,{default:t(()=>[p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:_e=>ze(A),title:"Visualizar Ficha"},lt,8,rt),p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:_e=>De(A),class:"mr-2",title:"Alterar Papel"},ut,8,it),p("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:_e=>Se(A),title:"Deletar Pessoa"},[A.excluido?(U(),N("img",mt)):(U(),N("img",pt))],8,dt),p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:_e=>Oe(A),title:"Selecionar Representante"},ft,8,_t)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(B,{show:a(R),onClose:m[4]||(m[4]=A=>R.value=!1)},null,8,["show"]),e(le,{representante_nome:a(c),representantes:a(s),ato_id:a(r),show:a(q),onClose:m[5]||(m[5]=A=>q.value=!1),onUpdateRepresentante:Te},null,8,["representante_nome","representantes","ato_id","show"]),e(H,{representante_nome:a(c),ato_token:a(h),ato_id:a(u),show:a(o),onClose:m[6]||(m[6]=A=>o.value=!1),onUpdatePapel:Ee},null,8,["representante_nome","ato_token","ato_id","show"]),e(Ve,{modelValue:a(M),"onUpdate:modelValue":m[8]||(m[8]=A=>Y(M)?M.value=A:null),width:"600"},{default:t(()=>[e(de,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(et,{src:a(j)},null,8,["src"]),e(F,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:m[7]||(m[7]=A=>M.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(E,null,{default:t(()=>[e(J,{onClick:Me},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[T("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},yt={key:0,class:"loading-overlay"},ht="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",bt={__name:"Minuta",emits:["page","doc"],setup(G,{emit:l}){Ue("DocumentEditorContainer",[Je,We,Ke]);const v=K(),{$toast:_}=te(),y=ae(),n=W(),$=l;ke(`${v.public.docEditor}`);const D=`${v.public.managemant}/download`,V=`${v.public.managemant}/atos/files`,I=`${v.public.managemant}/subitituirModelo`,z=`${v.public.managemant}/upload`,f=i(null),d=i(!1),C=async o=>{try{const s=await fetch(o);if(!s.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await s.blob()}catch(s){return console.error(s),_.error("Erro ao carregar o documento inicial."),null}},k=async()=>{try{const{data:o}=await b(`${V}/${n.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return o.value.link_ato}catch(o){console.error("Erro ao carregar o documento:",o),_.error(o)}},P=async()=>{d.value=!0;try{const o=await k(),{data:s,status:c}=await b(D,{method:"POST",body:{bucket:"qvgjz",path:o}},"$dvNFfvmIJC"),r=s.value,u=await C(r);if(u){const w=new FileReader;w.onload=()=>{const h=w.result;f.value.ej2Instances.documentEditor.open(h),$("doc",h)},w.readAsText(u)}}catch{_.error("Erro ao carregar o documento.")}finally{d.value=!1}},S=async()=>{const o=f.value.ej2Instances.documentEditor;console.log(o);const s=await o.saveAsBlob("Sfdt"),c=new FileReader;c.onload=()=>{const r=c.result,w=f.value.ej2Instances.documentEditor.pageCount;$("page",w),$("doc",r)},c.readAsText(s)},q=async()=>{d.value=!0;try{const s=await f.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),c=new FormData;c.append("file",s,"anexo.sfdt"),c.append("cartorio_token",L("user-data").value.cartorio_token),c.append("token",n.query.ato_token_edit),c.append("tipo","ato_minuta");const{data:r,status:u}=await b(z,{method:"POST",body:c},"$xv11VtUdMy");if(u.value==="success"){_.success("Documento enviado!");const h=f.value.ej2Instances.documentEditor.pageCount;S(),$("page",h)}else _.error("Erro ao enviar documento para o sistema.")}catch(o){_.error("Erro ao salvar documento."),console.error(o)}finally{d.value=!1}},R=async()=>{const{data:o,status:s}=await b(I,{method:"POST",body:{ato_token:n.query.ato_token_edit}},"$zyzWHTXTBW"),c=o.value;console.log(c)},M=()=>{const o=n.query.origem||"criar",s=n.query.id;o==="atualizar"?y.push(`/os/atualizar/${s}`):y.push("/os/criar-registro")};return Ie(async()=>{await P(),S()}),(o,s)=>{const c=re;return U(),N(ve,null,[e(a(we),{height:"900px",ref_key:"documentEditorContainer",ref:f,serviceUrl:ht,enableToolbar:!0,enableWordExport:!0},null,512),a(d)?(U(),N("div",yt,[e(Re,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):$e("",!0),e(E,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e(c,{class:"mr-4"},{default:t(()=>[e(F,{size:"large",onClick:M,color:"red"},{default:t(()=>[T("Voltar")]),_:1})]),_:1}),e(F,{size:"large",color:"green",onClick:q,disabled:a(d)},{default:t(()=>[T("Atualizar")]),_:1},8,["disabled"]),e(F,{class:"ml-4",size:"large",color:"blue",onClick:R},{default:t(()=>[T("Gerar Minuta")]),_:1})]),_:1})],64)}}},xt={class:"d-flex align-center justify-center"},$t=["innerHTML"],kt={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},setup(G){const l=G,v=K();ke(`${v.public.docEditor}`);const{$toast:_}=te(),y=ae(),n=W(),$=`${v.public.managemant}/download`,D=`${v.public.managemant}/atos/files`,V=`${v.public.managemant}/lavrarAto`,I=i("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),z=i(!1),f=i(null),d=i(null),C=i(null),k=async o=>{try{const s=await fetch(o);if(!s.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await s.blob()}catch(s){return console.error(s),_.error("Erro ao carregar o documento inicial."),null}},P=async()=>{try{const{data:o}=await b(`${D}/${n.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return o.value.link_ato}catch(o){console.error("Erro ao carregar o documento:",o),_.error(o)}},S=async()=>{try{const o=await P(),{data:s,status:c}=await b($,{method:"POST",body:{bucket:"qvgjz",path:o}},"$7ljqltMqa0"),r=s.value,u=await k(r);if(u){const w=new FileReader;w.onload=()=>{const h=w.result;C.value.ej2Instances.documentEditor.open(h),console.log("asdfdsf")},w.readAsText(u)}}catch{_.error("Erro ao carregar o documento.")}};S();const q=async()=>{try{const{data:o,status:s}=await b(V,{method:"POST",body:{ato_token:n.query.ato_token_edit,qtd_paginas:l.pages}},"$OWxZSQkyX8");s.value==="success"?(f.value=o.value,d.value=o.value[0].selo,_.success("Ato lavrado com sucesso!")):_.error("Falha ao lavrar o ato.")}catch{_.error("Erro ao conectar com o servidor.")}},R=()=>{z.value=!1,q()},M=()=>{const o=n.query.origem||"criar",s=n.query.id;o==="atualizar"?y.push(`/os/atualizar/${s}`):y.push("/os/criar-registro")};return je(()=>l.document,(o,s)=>{S()}),(o,s)=>{const c=Qe;return U(),N(ve,null,[e(E,null,{default:t(()=>[e(O,null,{default:t(()=>[e(a(we),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:C,height:"850px",width:"850px"},null,512)]),_:1}),e(O,null,{default:t(()=>[p("div",xt,[p("div",null,[p("img",{onClick:s[0]||(s[0]=r=>z.value=!0),class:"ml-15",style:{height:"40px",width:"40px",cursor:"pointer","margin-top":"350px"},src:Xe}),a(f)?(U(),ne(de,{key:0,width:"360px",class:"mr-16"},{default:t(()=>[e(E,null,{default:t(()=>[e(O,null,{default:t(()=>[e(be,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[T(" Livro: "+oe(a(f)[0].livro_numero),1)]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(be,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[T(" Folhas : "+oe(a(f)[0].pagina_inicial)+" Á "+oe(a(f)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),p("div",{style:{border:"1px solid black","border-radius":"8px","padding-bottom":"20px","margin-top":"-10px"},class:"ml-2 mb-2 mr-2",innerHTML:a(d)},null,8,$t)]),_:1})):$e("",!0)])])]),_:1})]),_:1}),T(" "+oe(l.pages)+" ",1),e(F,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:M},{default:t(()=>[T("Voltar")]),_:1}),e(c,{show:a(z),condMessage:a(I),onClose:s[1]||(s[1]=r=>z.value=!1),onConfirm:R},null,8,["show","condMessage"])],64)}}},wt=["onClick"],Vt={key:0,style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar",title:"Reativar"},Pt={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ct={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(G){let l,v;const _=ae(),y=W(),n=K(),{$toast:$}=te(),D=`${n.public.managemant}/listarEscrevente`;`${n.public.managemant}`;const V=`${n.public.managemant}/createAtosObservacao`,I=`${n.public.managemant}/updateAtosObservacao`,z=`${n.public.managemant}/getAtosObservacaoById`,f=i(L("user-data").value.cartorio_token),d=i([]),C=i([]),k=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],P=ce({observacao:""}),S={observacao:{required:tt.withMessage("O campo é obrigatório",at)}},q=ot(S,P),{data:R}=([l,v]=ee(()=>b(`${z}/${y.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),l=await l,v(),l);d.value=R.value.map(r=>({...r,created:xe(r.created,"dd/mm/yyyy hh:mm")}));async function M(){if(P.observacao.trim()===""){$.error("O campo de observação está vazio.");return}if(await q.value.$validate()){const{data:r,error:u,status:w}=await b(V,{method:"POST",body:{ato_id:y.query.ato_id,observacao:P.observacao,user_id:L("user-data").value.usuario_id}},"$gnHMo4uCXD");w.value==="success"&&(d.value.push({created:xe(r.value.created,"dd/mm/yyyy hh:mm"),observacao:r.value.observacao,id:r.value.id,escrevente:L("user-data").value.nome}),P.observacao="",$.success("Observação registrada com sucesso"))}else $.error("Preencha os campos obrigatórios.")}async function o(r){r.excluido=!r.excluido;try{await b(`${I}/${r.id}`,{method:"PUT",body:JSON.stringify({excluido:r.excluido})},"$sP9AKdd3Ky")}catch(u){console.error("Erro ao excluir observação:",u)}}const{data:s}=([l,v]=ee(()=>b(D,{method:"POST",body:{cartorio_token:f}},"$HL9pndqGh0")),l=await l,v(),l);C.value=s.value[0].func_json_escreventes;const c=()=>{const r=y.query.origem||"criar",u=y.query.id;r==="atualizar"?_.push(`/os/atualizar/${u}`):_.push("/os/criar-registro")};return(r,u)=>{const w=re;return U(),ne(ue,null,{default:t(()=>[e(E,{class:"mt-5"},{default:t(()=>[e(Z,{label:"Observação",modelValue:P.observacao,"onUpdate:modelValue":u[0]||(u[0]=h=>P.observacao=h),required:"","error-messages":a(q).observacao.$errors.length>0?a(q).observacao.$errors.map(h=>h.$message):[],onBlur:a(q).observacao.$touch,onInput:a(q).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),p("div",null,[p("img",{class:"btn-pointer ml-2",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:M})])]),_:1}),e(E,null,{default:t(()=>[e(O,null,{default:t(()=>[e(ge,{style:{height:"465px"},headers:k,items:d.value},{"item.actions":t(({item:h})=>[p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:j=>o(h),title:"Deletar Observação"},[h.excluido?(U(),N("img",Vt)):(U(),N("img",Pt))],8,wt)]),_:1},8,["items"])]),_:1})]),_:1}),e(E,null,{default:t(()=>[e(w,{onClick:c},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[T("Voltar")]),_:1})]),_:1})]),_:1})]),_:1})}}},At=p("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ye,alt:"Escanear"},null,-1),Et=[At],Tt=p("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ie,alt:"Criar"},null,-1),qt=[Tt],zt=["onClick"],Ot=p("img",{style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar"},null,-1),Dt=[Ot],St=["onClick"],Mt={key:0,style:{width:"30px",height:"30px"},src:ye,alt:"Visualizar",title:"Reativar"},Ut={key:1,src:he,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},It={__name:"Anexos",async setup(G){let l,v;const _=K(),{$toast:y}=te(),n=ae(),$=W(),D=`${_.public.biometria}/run-scanner`,V=`${_.public.managemant}/atos_anexos`,I=`${_.public.managemant}/atos_anexos`,z=`${_.public.managemant}/atos_anexos`,f=i(!1),d=i([]),C=ce({descricao:""}),k=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:P}=([l,v]=ee(()=>b(`${z}/${$.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),l=await l,v(),l);d.value=P.value;async function S(){try{await q(),await R()}catch(r){console.error("Erro ao executar scanner ou listar arquivos:",r)}}async function q(){try{const{data:r}=await b(D,{method:"GET"},"$KttjFhHivJ")}catch(r){y.error("Erro ao acionar o scanner:",r)}}async function R(){try{const{data:r,status:u}=await b("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:$.query.ato_token_edit,cartorio_token:L("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(r){console.error("Erro ao enviar o arquivo:",r)}}const M=async()=>{f.value=!0},o=async()=>{const{data:r,error:u,status:w}=await b(V,{method:"POST",body:{ato_id:$.query.ato_id,descricao:C.descricao,user_id:L("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");w.value==="success"&&(y.success("Anexo registrado com sucesso!"),d.value.push(r.value))};async function s(r){r.excluido=!r.excluido;try{await b(`${I}/${r.id}`,{method:"PUT",body:JSON.stringify({excluido:r.excluido})},"$cdoFBGO0Ti")}catch(u){console.error("Erro ao excluir pessoa:",u)}}const c=()=>{const r=$.query.origem||"criar",u=$.query.id;r==="atualizar"?n.push(`/os/atualizar/${u}`):n.push("/os/criar-registro")};return(r,u)=>{const w=re;return U(),ne(ue,null,{default:t(()=>[e(E,null,{default:t(()=>[e(O,{cols:"5"},{default:t(()=>[e(Z,{modelValue:a(C).descricao,"onUpdate:modelValue":u[0]||(u[0]=h=>a(C).descricao=h),label:"Descrição"},null,8,["modelValue"])]),_:1}),p("div",{onClick:S,title:"Escanear"},Et),p("div",{onClick:o,title:"Criar"},qt)]),_:1}),e(ge,{headers:k,items:a(d),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:h})=>[e(E,null,{default:t(()=>[p("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:j=>M(h),title:"Visualizar Anexo"},Dt,8,zt),p("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:j=>s(h),title:"Deletar Pessoa"},[h.excluido?(U(),N("img",Mt)):(U(),N("img",Ut))],8,St)]),_:2},1024)]),_:1},8,["items"]),e(Ve,{modelValue:a(f),"onUpdate:modelValue":u[2]||(u[2]=h=>Y(f)?f.value=h:null),width:"600"},{default:t(()=>[e(de,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(F,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:u[1]||(u[1]=h=>f.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(w,{onClick:c},{default:t(()=>[e(F,{size:"large",color:"red"},{default:t(()=>[T("Voltar")]),_:1})]),_:1})]),_:1})}}},Rt={class:"mb-10"},jt=p("h1",null,"Ordem de Serviço nº",-1),Ft={style:{color:"red","margin-left":"30px"}},la={__name:"[id]",async setup(G){let l,v;const _=i(null),y=i(null),n=i(null),$=K(),D=W(),V=`${$.public.managemant}/listarSituacoes`,I=`${$.public.managemant}/getAtos`,z=i(L("user-data").value.cartorio_token),f=D.query.id?{ato_token:"xkyaA"}:{cartorio_token:z},d=i([]),C=i([]),k=i("PROCURAÇÕES"),P=i("PROCURAÇÃO");async function S(){try{const{data:s}=await b(`${I}/${D.query.ato_id}`,{method:"GET"},"$j0JpHHj7PB");C.value=s.value}catch(s){console.log(s)}}[l,v]=ee(()=>S()),await l,v();const{data:q,status:R}=([l,v]=ee(()=>b(V,{method:"POST",body:f},"$mGbp7gAEjS")),l=await l,v(),l);d.value=q.value;const M=s=>{_.value=s},o=s=>{y.value=s};return(s,c)=>{const r=st,u=gt,w=bt,h=kt,j=Ct,me=It;return U(),N(ve,null,[p("div",Rt,[e(E,{class:"mb-5 mt-5"},{default:t(()=>[jt,p("h1",Ft,oe(a(D).query.numero_os),1)]),_:1}),e(E,null,{default:t(()=>[e(O,{md:"6"},{default:t(()=>[e(se,{class:"mr-5",modelValue:a(k),"onUpdate:modelValue":c[0]||(c[0]=x=>Y(k)?k.value=x:null),disabled:""},null,8,["modelValue"])]),_:1}),e(O,{md:"6"},{default:t(()=>[e(se,{modelValue:a(P),"onUpdate:modelValue":c[1]||(c[1]=x=>Y(P)?P.value=x:null),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),e(de,{width:"1300"},{default:t(()=>[e(Be,{modelValue:a(n),"onUpdate:modelValue":c[2]||(c[2]=x=>Y(n)?n.value=x:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(X,{value:"dados"},{default:t(()=>[T("Dados")]),_:1}),e(X,{value:"partes"},{default:t(()=>[T("Partes")]),_:1}),e(X,{value:"minuta"},{default:t(()=>[T("Minuta")]),_:1}),e(X,{value:"livro"},{default:t(()=>[T("Livro")]),_:1}),e(X,{value:"observacao"},{default:t(()=>[T("Observações")]),_:1}),e(X,{value:"anexo"},{default:t(()=>[T("Anexos")]),_:1})]),_:1},8,["modelValue"]),e(Ne,{modelValue:a(n),"onUpdate:modelValue":c[3]||(c[3]=x=>Y(n)?n.value=x:null)},{default:t(()=>[e(Q,{value:"dados"},{default:t(()=>[e(r,{item_dados:a(C),item_situacoes:a(d)},null,8,["item_dados","item_situacoes"])]),_:1}),e(Q,{value:"partes"},{default:t(()=>[e(u)]),_:1}),e(Q,{value:"minuta"},{default:t(()=>[e(w,{onPage:M,onDoc:o})]),_:1}),e(Q,{value:"livro"},{default:t(()=>[e(h,{pages:a(_),document:a(y)},null,8,["pages","document"])]),_:1}),e(Q,{value:"observacao"},{default:t(()=>[e(j)]),_:1}),e(Q,{value:"anexo"},{default:t(()=>[e(me)]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}};export{la as default};
