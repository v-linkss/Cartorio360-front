import{_ as Ve}from"./2aiAhEy3.js";import{_ as be}from"./t6hM0QM7.js";import{c as de,r as me,u as Ce}from"./DvqlM6v7.js";import{D as ge,u as ye,r as n,m as ee,A as $e,E as ie,n as Ue,v as a,o as k,c as ne,b as e,L as Ie,q as M,w as t,V as v,a as m,H as N,d as S,s as ke,F as h,g as Te,I as pe}from"./BdiXWuYW.js";import{u as $}from"./B9UJ37QS.js";import{V as y}from"./CRmxHBvb.js";import{V as i}from"./CffPtzwX.js";import{V as qe}from"./BnHOX6NM.js";import{V as U}from"./BWQu0GxJ.js";import{V as re}from"./D0UArRp6.js";import{_ as Be,d as Me,V as Se,a as ce,b as ze,c as _e}from"./gVnKh9hp.js";import{b as Oe}from"./CMV_F4kW.js";import{_ as fe}from"./DcPdNccw.js";import{_ as ve,a as Ae,b as De,c as Ne}from"./Bnv_6PzL.js";import{V as Re}from"./B5kKtZX8.js";import{V as Pe,a as xe}from"./NzW0ynT-.js";const Ee={key:0,class:"d-flex justify-center"},Fe={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal"],async setup(R,{emit:E}){let p,_;const V=R,b=E,g=ge(),f=ke(),{$toast:I}=ye(),{id:z}=g.params,c=`${f.public.managemant}/atos_bens`,F=`${f.public.managemant}/atos_bens`;`${f.public.managemant}`;const j=`${f.public.managemant}/registro_imoveis`,P=`${f.public.managemant}/natureza_imoveis`,le=`${f.public.managemant}/tipo_logradouros`,O=`${f.public.managemant}/situacao_imoveis`,L=`${f.public.managemant}/listarCidades`,H=`${f.public.managemant}/listarTipoBens`,Y=n(ee("user-data").value.cartorio_token),T=n(ee("user-data").value.usuario_id).value;n([]),n([]);const A=n([]),G=n([]),W=n([]),Q=n([]),D=n([]),X=n([]);n(!1);const u=n(!0),s=$e({vlr_alienacao:null,tabvalores_tipo_regimovel_id:null,registro_cartorio:null,registro_matricula:null,registro_matricula_letra:null,tabvalores_nat_imovel_id:null,cib:null,end_cidade_id:null,end_quadra:null,end_lote:null,tabvalores_tipologradouro_id:null,end_logradouro:null,end_logradouro_numero:null,end_bairro:null,end_cep:null,end_complemento:null,tipo_id:null,descricao:null,inscricao_estadual:null,tabvalores_situacao_imoveis_id:null,tipo_id:null,vlr_alienacao:null,vlr_mercado:null,valor_mercado:"0.00",aliq_itbi:null,vlr_itbi:null,user_id:T,ato_id:Number(g.query.ato_id)||Number(V.ato_id)}),J={descricao:{required:de.withMessage("O campo é obrigatório",me)},tipo_id:{required:de.withMessage("O campo é obrigatório",me)}},K=Ce(J,s),ae=async()=>{if(!await K.value.$validate()){I.error("Preencha todos os campos obrigatórios!");return}const{status:o}=await $(`${c}`,{method:"POST",body:s},"$0Mdv6RF9cH");o.value==="success"&&(I.success("Imovel criado com sucesso!"),b("saved"))},{data:oe}=([p,_]=ie(()=>$(`${H}`,{method:"POST",body:{cartorio_token:Y.value,imoveis:!0}},"$H1S2cTYpdB")),p=await p,_(),p);if(X.value=oe.value,V.isUpdate===!0){const{data:x}=([p,_]=ie(()=>$(`${F}/${V.imovel_id}`,{method:"GET"},"$jHrIlABk8l")),p=await p,_(),p);console.log(x.value)}async function te(){try{const[x,o,w,r,l]=await Promise.all([$fetch(P),$fetch(j),$fetch(O),$fetch(le),$fetch(L)]);G.value=x,A.value=o,D.value=w,W.value=r,Q.value=l}catch(x){console.error("Erro ao carregar os dados de imoveis pessoa:",x)}finally{u.value=!1}}const se=()=>{b("close-modal")};return Ue(()=>{z||V.ato_id?te():u.value=!1}),(x,o)=>{const w=Ve,r=be;return a(u)?(k(),ne("div",Ee,[e(Ie,{indeterminate:"",class:"loading-spinner",size:"64"})])):(k(),M(re,{key:1},{default:t(()=>[e(y,null,{default:t(()=>[e(i,{class:"mt-5",cols:"12"},{default:t(()=>[e(qe,{label:"Descrição",modelValue:a(s).descricao,"onUpdate:modelValue":o[0]||(o[0]=l=>a(s).descricao=l),"error-messages":a(K).descricao.$errors.map(l=>l.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(i,{cols:"3"},{default:t(()=>[e(U,{label:"Tipo de Registro",modelValue:a(s).tabvalores_tipo_regimovel_id,"onUpdate:modelValue":o[1]||(o[1]=l=>a(s).tabvalores_tipo_regimovel_id=l),items:a(A),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[e(v,{label:"Cartório",modelValue:a(s).registro_cartorio,"onUpdate:modelValue":o[2]||(o[2]=l=>a(s).registro_cartorio=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[e(v,{label:"Matricula",modelValue:a(s).registro_matricula,"onUpdate:modelValue":o[3]||(o[3]=l=>a(s).registro_matricula=l)},null,8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(v,{label:"Letra",modelValue:a(s).registro_matricula_letra,"onUpdate:modelValue":o[4]||(o[4]=l=>a(s).registro_matricula_letra=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[e(U,{label:"Natureza",modelValue:a(s).tabvalores_nat_imovel_id,"onUpdate:modelValue":o[5]||(o[5]=l=>a(s).tabvalores_nat_imovel_id=l),items:a(G),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"1"},{default:t(()=>[e(v,{label:"CIB",modelValue:a(s).cib,"onUpdate:modelValue":o[6]||(o[6]=l=>a(s).cib=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(i,{cols:"3"},{default:t(()=>[e(U,{label:"Cidade",modelValue:a(s).end_cidade_id,"onUpdate:modelValue":o[7]||(o[7]=l=>a(s).end_cidade_id=l),items:a(Q),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[e(v,{label:"Quadra",modelValue:a(s).end_quadra,"onUpdate:modelValue":o[8]||(o[8]=l=>a(s).end_quadra=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[e(v,{label:"Lote",modelValue:a(s).end_lote,"onUpdate:modelValue":o[9]||(o[9]=l=>a(s).end_lote=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"4"},{default:t(()=>[e(U,{label:"Logradouro",modelValue:a(s).tabvalores_tipologradouro_id,"onUpdate:modelValue":o[10]||(o[10]=l=>a(s).tabvalores_tipologradouro_id=l),items:a(W),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"1"},{default:t(()=>[e(v,{label:"N*",modelValue:a(s).end_logradouro_numero,"onUpdate:modelValue":o[11]||(o[11]=l=>a(s).end_logradouro_numero=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(i,null,{default:t(()=>[e(v,{label:"Bairro",modelValue:a(s).end_bairro,"onUpdate:modelValue":o[12]||(o[12]=l=>a(s).end_bairro=l)},null,8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(v,{label:"CEP",modelValue:a(s).end_cep,"onUpdate:modelValue":o[13]||(o[13]=l=>a(s).end_cep=l)},null,8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(v,{label:"Complemento",modelValue:a(s).end_complemento,"onUpdate:modelValue":o[14]||(o[14]=l=>a(s).end_complemento=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"3"},{default:t(()=>[e(U,{modelValue:a(s).tipo_id,"onUpdate:modelValue":o[15]||(o[15]=l=>a(s).tipo_id=l),items:a(X),label:"Tipo de imovel","item-title":"descricao","item-value":"id","error-messages":a(K).tipo_id.$errors.map(l=>l.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(i,{cols:"3"},{default:t(()=>[e(v,{label:"Inscrição Municipal"})]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(i,{class:"mt-6",cols:"4"},{default:t(()=>[e(U,{label:"Situação",items:a(D),"item-title":"descricao","item-value":"id"},null,8,["items"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[o[21]||(o[21]=m("label",null,"Valor Alienação",-1)),e(w,{label:"Valor Alienação",modelValue:a(s).vlr_alienacao,"onUpdate:modelValue":o[16]||(o[16]=l=>a(s).vlr_alienacao=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[o[22]||(o[22]=m("label",null,"Valor Avaliação",-1)),e(w,{label:"Valor Avaliação",modelValue:a(s).vlr_avaliacao,"onUpdate:modelValue":o[17]||(o[17]=l=>a(s).vlr_avaliacao=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"2"},{default:t(()=>[o[23]||(o[23]=m("label",null,"Valor Mercado",-1)),e(w,{label:"Valor Mercado",modelValue:a(s).vlr_mercado,"onUpdate:modelValue":o[18]||(o[18]=l=>a(s).vlr_mercado=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"1"},{default:t(()=>[o[24]||(o[24]=m("label",null,"%ITB",-1)),e(w,{label:"%ITB",modelValue:a(s).aliq_itbi,"onUpdate:modelValue":o[19]||(o[19]=l=>a(s).aliq_itbi=l)},null,8,["modelValue"])]),_:1}),e(i,{cols:"1"},{default:t(()=>[o[25]||(o[25]=m("label",null,"Valor ITB",-1)),e(w,{label:"Valor ITB",modelValue:a(s).vlr_itbi,"onUpdate:modelValue":o[20]||(o[20]=l=>a(s).vlr_itbi=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(y,{class:"mt-10"},{default:t(()=>[e(r,{onClick:se},{default:t(()=>[e(N,{size:"large",color:"red"},{default:t(()=>o[26]||(o[26]=[S("Voltar")])),_:1})]),_:1}),R.isUpdate?(k(),M(N,{key:0,class:"ml-5",size:"large",color:"green"},{default:t(()=>o[27]||(o[27]=[S("Atualizar")])),_:1})):(k(),M(N,{key:1,class:"ml-5",size:"large",color:"green",onClick:ae},{default:t(()=>o[28]||(o[28]=[S("Salvar")])),_:1}))]),_:1})]),_:1}))}}},je=["onClick"],Le=["onClick"],He=["onClick"],Ye={key:0,style:{width:"30px",height:"30px"},src:De,alt:"Visualizar",title:"Reativar"},Ge={key:1,src:Ne,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},We={__name:"Partes",emits:["saved","close-modal"],async setup(R,{emit:E}){let p,_;const V=E,b=ge(),g=ke(),{$toast:f}=ye(),I=`${g.public.managemant}/pesquisarPessoas`,z=`${g.public.managemant}/listarPapeis`,c=`${g.public.managemant}/getLinkTipo`,F=`${g.public.managemant}/bens_pessoa`;`${g.public.managemant}`;const j=`${g.public.managemant}/getAtosPessoaById`,P=`${g.public.managemant}/download`,le=n(ee("user-data").value.cartorio_token),O=n([]),L=n([]),H=n([]),Y=n(!1),T=n(!1),A=n(!1),G=n(null),W=n(null),Q=n(b.query.tipo_ato_token),D=n(null),X=[{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"%",align:"start",key:"percentual.percentual"},{value:"actions"}],u=$e({papeis:null,percentual:null,pessoa:null,documento:null}),{data:s}=([p,_]=ie(()=>$(z,{method:"POST",body:{tipo_ato_token:b.query.tipo_ato_token}},"$X6FDd5A6WK")),p=await p,_(),p);H.value=s.value;const J=async()=>{const{data:r}=await $(`${j}/${b.query.ato_id}`,{method:"GET"},"$Dyv7lSgcqT"),q=(B=>B.map(C=>({...C,pessoa:{...C.pessoa,documento:C.pessoa.doc_identificacao},papel:{...C.partes_tipos}})))(r.value);L.value=q};J();async function K(){try{const{data:r}=await $(I,{method:"POST",body:{cartorio_token:le.value,documento:u.documento,nome:u.nome}},"$Ir36YwSBFY");r.value.length>0?(O.value=r.value,u.pessoa=O.value[0]):O.value=[]}catch(r){console.error("Erro na requisição",r)}}const ae=()=>{Y.value=!0},oe=async()=>{await J()},te=async()=>{const r={pessoa:u.pessoa,papel:H.value.find(B=>B.id===u.papeis),percentual:u.percentual},{data:l,status:q}=await $(F,{method:"POST",body:{ato_id:Number(b.query.ato_id),pessoa_id:u.pessoa.id,tipo_parte_id:u.papeis,user_id:ee("user-data").value.usuario_id,percentual:u.percentual}},"$z4QOGPyvCc");q.value==="success"&&(r.id=l.value.id,f.success("Pessoa Registrada com Sucesso!"),L.value.push(r))},se=async r=>{var Z;if(T.value=!0,D.value=null,!r.pessoa.id)return;const{data:l}=await $(c,{method:"POST",body:{tipo:"ficha",id:r.pessoa.id}},"$XYnqHmowsR");if(!((Z=l.value)!=null&&Z.link))return;const{data:q}=await $(P,{method:"POST",body:{bucket:"qvgjz",path:l.value.link}},"$63DgHOk5hC"),B=l.value.link,C=q.value;/\.(tr7|tiff)$/i.test(B)?D.value=C:fotoRender.value=`data:image/jpeg;base64,${C}`},x=r=>{A.value=!0,W.value=r.id,G.value=r.pessoa.nome};async function o(r){r.excluido=!r.excluido;try{await $(`${pessoasUpdate}/${r.id}`,{method:"PUT",body:JSON.stringify({excluido:r.excluido})},"$3fKfAn4Pra")}catch(l){console.error("Erro ao excluir pessoa:",l)}}const w=()=>{V("close-modal")};return(r,l)=>{const q=Ve,B=Be,C=Oe,Z=Me,we=be;return k(),M(re,null,{default:t(()=>[e(y,null,{default:t(()=>[e(i,{cols:"3"},{default:t(()=>[e(v,{label:"Documento",modelValue:a(u).documento,"onUpdate:modelValue":l[0]||(l[0]=d=>a(u).documento=d)},null,8,["modelValue"])]),_:1}),e(i,{cols:"4"},{default:t(()=>[e(v,{label:"Pessoa",modelValue:a(u).nome,"onUpdate:modelValue":l[1]||(l[1]=d=>a(u).nome=d)},null,8,["modelValue"])]),_:1}),m("div",null,[m("img",{class:"mt-1",src:fe,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:K})]),m("div",null,[m("img",{class:"mt-1 ml-2",src:ve,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:ae})])]),_:1}),e(y,null,{default:t(()=>[e(i,{class:"mt-6",cols:"4"},{default:t(()=>[e(U,{label:"Selecione a Pessoa",modelValue:a(u).pessoa,"onUpdate:modelValue":l[2]||(l[2]=d=>a(u).pessoa=d),items:a(O),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(i,{class:"mt-6",cols:"3"},{default:t(()=>[e(U,{label:"Papel",modelValue:a(u).papeis,"onUpdate:modelValue":l[3]||(l[3]=d=>a(u).papeis=d),items:a(H),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"1"},{default:t(()=>[l[9]||(l[9]=m("label",null,"%",-1)),e(q,{modelValue:a(u).percentual,"onUpdate:modelValue":l[4]||(l[4]=d=>a(u).percentual=d)},null,8,["modelValue"])]),_:1}),m("div",null,[m("img",{class:"mt-7",src:ve,style:{width:"40px",cursor:"pointer"},title:"Criar Imovel",onClick:te})])]),_:1}),e(y,null,{default:t(()=>[e(i,null,{default:t(()=>[e(Re,{style:{height:"385px"},headers:X,items:a(L)},{"item.actions":t(({item:d})=>[e(y,null,{default:t(()=>[m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:ue=>se(d),title:"Visualizar Ficha"},l[10]||(l[10]=[m("img",{style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar"},null,-1)]),8,je),m("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ue=>x(d),class:"mr-2",title:"Alterar Papel"},l[11]||(l[11]=[m("img",{style:{width:"30px",height:"30px"},src:Ae,alt:"Visualizar"},null,-1)]),8,Le),m("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:ue=>o(d),title:"Deletar Pessoa"},[d.excluido?(k(),ne("img",Ye)):(k(),ne("img",Ge))],8,He)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(B,{show:a(Y),onClose:l[5]||(l[5]=d=>Y.value=!1)},null,8,["show"]),e(C,{representante_nome:a(G),ato_token:a(Q),ato_id:a(W),show:a(A),onClose:l[6]||(l[6]=d=>A.value=!1),onUpdatePapel:oe},null,8,["representante_nome","ato_token","ato_id","show"]),e(Pe,{modelValue:a(T),"onUpdate:modelValue":l[8]||(l[8]=d=>h(T)?T.value=d:null),width:"600"},{default:t(()=>[e(xe,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(Z,{"tiff-url":a(D)},null,8,["tiff-url"]),e(N,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:l[7]||(l[7]=d=>T.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(y,{class:"mt-5"},{default:t(()=>[e(we,{onClick:w},{default:t(()=>[e(N,{size:"large",color:"red"},{default:t(()=>l[12]||(l[12]=[S("Voltar")])),_:1})]),_:1}),e(N,{class:"ml-5",size:"large",color:"green"},{default:t(()=>l[13]||(l[13]=[S("Salvar")])),_:1})]),_:1})]),_:1})}}},dl={__name:"Cadastro",props:{show:Boolean},emits:["close"],setup(R,{emit:E}){const p=R,_=n("dados"),V=n(p.show),b=n(!1),g=E;Te(()=>p.show,z=>{V.value=z});const f=()=>{b.value=!0},I=()=>{V.value=!1,b.value=!1,g("close")};return(z,c)=>{const F=Fe,j=We;return k(),M(Pe,{persistent:"",modelValue:a(V),"onUpdate:modelValue":c[2]||(c[2]=P=>h(V)?V.value=P:null),"max-width":"1000"},{default:t(()=>[e(xe,null,{default:t(()=>[e(re,null,{default:t(()=>[c[5]||(c[5]=m("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Cadastro de imoveis ",-1)),e(Se,{modelValue:a(_),"onUpdate:modelValue":c[0]||(c[0]=P=>h(_)?_.value=P:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(ce,{value:"dados"},{default:t(()=>c[3]||(c[3]=[S("Dados")])),_:1}),a(b)?(k(),M(ce,{key:0,value:"partes"},{default:t(()=>c[4]||(c[4]=[S("Partes")])),_:1})):pe("",!0)]),_:1},8,["modelValue"]),e(ze,{modelValue:a(_),"onUpdate:modelValue":c[1]||(c[1]=P=>h(_)?_.value=P:null)},{default:t(()=>[e(_e,{value:"dados"},{default:t(()=>[e(F,{onSaved:f,onCloseModal:I})]),_:1}),e(_e,{value:"partes"},{default:t(()=>[a(b)?(k(),M(j,{key:0,onCloseModal:I})):pe("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{Fe as _,We as a,dl as b};
