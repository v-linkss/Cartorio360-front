import{_ as I}from"./CZYVWUg6.js";import{_ as D}from"./XdZusVCH.js";import{_ as F}from"./Cgrydu_W.js";import{u as L,m as p,r as s,n as M,p as U,q as C,c as q,b as t,w as n,F as E,s as j,o as G,a as r,t as V,v as g,V as k,x as H,y,z as J,d as K,A as Q}from"./D20DkuN4.js";import{V as W}from"./CHSYu0OH.js";import{V as v}from"./DMrr2Sgb.js";import{V as w}from"./D6EXtm0U.js";import{V as X}from"./DxAPWWrU.js";import"./CXXCIeC6.js";import"./Cs0qACZ9.js";import"./itHe4y2w.js";import"./Nif8ni3S.js";import"./BVz1G1IN.js";import"./BElGUO6U.js";import"./BClZPtNY.js";import"./DXypsCRb.js";import"./-AgELsd7.js";const Y=["title","onClick"],Z=["onClick"],xe={__name:"index",setup(ee){const h=j(),{$toast:_}=L(),A=`${h.public.managemant}/listarOSCaixas`,N=p("caixa-service").value.usuario_nome,O=p("caixa-service").value.data,f=s([]),l=s(""),u=s(""),b=s({}),x=s(null),i=s(!1),R=()=>{Q("/caixas/lista")},S=[{title:"Data Recebimento",value:"data"},{title:"Número",value:"numero"},{title:"Situação",value:"situacao"},{title:"CPF",value:"apresentante_cpf"},{title:"Apresentante",value:"apresentante_nome"},{title:"Usuário",value:"usuario_nome"},{title:"Valor",value:"valor"},{title:"Ações",value:"actions"}];async function T(){try{const a=await $fetch(A,{method:"POST",body:{caixa_token:p("caixa-service").value.caixa_token}});a&&Array.isArray(a)?f.value=a:(_.error("Nenhum dado retornado da API."),console.error("Nenhum dado retornado da API."))}catch(a){const e=a.message||"Erro ao buscar dados da API. Tente novamente.";_.error(e),console.error(e)}}M(()=>{T()});const $=U(()=>f.value.filter(a=>{const e=a.numero?a.numero.toString().toLowerCase():"",c=a.apresentante_nome?a.apresentante_nome.toLowerCase():"",m=e.includes(l.value.toLowerCase()),d=c.includes(u.value.toLowerCase());return m&&d}));function z(a,e){console.log("Cancelando OS:",{numero:a,token:e})}function B(a,e){x.value=a,b.value={token:e.token,numero:e.numero,valor:e.valor,valor_pago:e.valor_pago},i.value=!0}return(a,e)=>{const c=I,m=C("v-cols"),d=C("v-rows");return G(),q(E,null,[t(W,{class:"mt-5"},{default:n(()=>[t(v,{class:"mb-5"},{default:n(()=>[r("h1",null,"Recebimento de Ordens de Serviço - Caixa "+V(g(O))+" - "+V(g(N)),1)]),_:1}),t(v,null,{default:n(()=>[t(w,{cols:"2"},{default:n(()=>[t(k,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value=o),type:"text",label:"Número"},null,8,["modelValue"])]),_:1}),t(w,{md:"3"},{default:n(()=>[t(k,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=o=>u.value=o),label:"Apresentante"},null,8,["modelValue"])]),_:1})]),_:1}),e[4]||(e[4]=r("hr",{class:"mt-5 mb-5"},null,-1)),t(X,{headers:S,items:$.value,"item-key":"id"},{"item.actions":n(({item:o})=>[t(v,{style:{display:"flex",gap:"10px","margin-top":"-5px"}},{default:n(()=>[r("div",{class:y({disabled:!o.btn_receber}),title:o.btn_receber?"Receber":"Bloqueado",onClick:P=>o.btn_receber?B(o.numero,o):null},[r("img",{style:H({cursor:o.btn_receber?"pointer":"default",width:"30px",height:"30px"}),src:D,alt:"Receber"},null,4)],10,Y),r("div",{class:y({disabled:!o.btn_cancelar}),onClick:P=>o.btn_cancelar?z(o.numero,o.token):null,title:"Cancelamento"},e[3]||(e[3]=[r("img",{style:{width:"30px",height:"30px"},src:F,alt:"Visualizar",title:"Visualizar"},null,-1)]),10,Z)]),_:2},1024)]),_:1},8,["items"]),t(c,{show:i.value,numero_os:x.value,ordem:b.value,onClose:e[2]||(e[2]=o=>i.value=!1)},null,8,["show","numero_os","ordem"])]),_:1}),t(d,null,{default:n(()=>[t(m,null,{default:n(()=>[t(J,{class:"ml-8",size:"large",onClick:R,color:"red"},{default:n(()=>e[5]||(e[5]=[K("Voltar ")])),_:1})]),_:1})]),_:1})],64)}}};export{xe as default};
