import{_ as L}from"./COGwOujT.js";import{a as M,b as P,c as z,d as D,V as U}from"./lVeJXQlF.js";import{r as l,h as K,o as w,A as B,w as o,b as a,d as C,c as A,t as X,y as j,q as t,v as G,_ as J,u as Q,E as W,D as h,F as H,G as Y,x as Z,a as f,s as ee,p as te,e as ae}from"./BoJ9xM4o.js";import{u as y}from"./CCXJQ4oz.js";import{_ as oe}from"./ToPptOUL.js";import{c as se,r as ne,u as re,V as ue,_ as le}from"./D7WB7FKE.js";import{V as ie}from"./ebszuf39.js";import{V as ce}from"./vN-BWfmu.js";const de={key:0},me={key:1},_e={__name:"ErrorModalCard",props:{show:Boolean,errorMessage:String},emits:["close"],setup(n,{emit:i}){const m=n,r=l(m.show),g=i;K(()=>m.show,k=>{r.value=k});const _=()=>{r.value=!1,g("close")};return(k,c)=>(w(),B(U,{persistent:"",modelValue:t(r),"onUpdate:modelValue":c[0]||(c[0]=b=>G(r)?r.value=b:null),per:"","max-width":"500"},{default:o(()=>[a(M,null,{default:o(()=>[a(P,{class:"text-h5"},{default:o(()=>[C("Erro na Requisição")]),_:1}),a(z,null,{default:o(()=>[n.errorMessage?(w(),A("div",de,X(n.errorMessage),1)):(w(),A("div",me,"Ocorreu um erro inesperado."))]),_:1}),a(D,null,{default:o(()=>[a(j,{style:{"background-color":"#429946",color:"white"},onClick:_},{default:o(()=>[C("OK")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},pe=n=>(te("data-v-118f8b41"),n=n(),ae(),n),ve={style:{width:"600px","margin-top":"10px"}},fe={style:{width:"180px","margin-top":"20px"}},ge=pe(()=>f("img",{class:"btn-pointer mt-10 mb-5",src:oe,alt:"Sair"},null,-1)),ke={__name:"autenticacao",async setup(n){let i,m;const r=Q(),g=W(),_=Z(),k=`${_.public.managemant}/listarEscrevente`,c=l(h("user-data").value.cartorio_token).value,b=l(h("user-service").value.token).value||l(h("user-service").value).value,S=h("auth_token").value,E=`${_.public.managemant}/atoAutentica`,I=`${_.public.managemant}/etiquetaAutentica`,x=l(!1),$=l(""),u=H({escrevente:null,quantidade:1}),q=l([]),{data:O}=([i,m]=Y(()=>y(k,{method:"POST",body:{cartorio_token:c}},"$nXL9eJBhI7")),i=await i,m(),i);q.value=O.value[0].func_json_escreventes;const T={escrevente:{required:se.withMessage("O campo é obrigatorio",ne)}},V=re(T,u),R=async()=>{if(await V.value.$validate()){const{data:s,status:e,error:p}=await y(E,{method:"POST",body:{usuario_token:S,cartorio_token:c,quantidade:Number(u.quantidade),ordemserv_token:b,ato_tipo_token:"bFsdV"}},"$dpfLzAlO85");e.value==="success"&&s.value.status==="OK"?N(s.value.token):(console.log(s.value.status_mensagem),x.value=!0,$.value=s.value.status_mensagem||p.value.data.details)}},N=async s=>{const{data:e,status:p}=await y(I,{method:"POST",body:{escrevente_token:u.escrevente,cartorio_token:c,ato_token:s}},"$fPnSl9XMLA");if(p.value==="success"){const v=window.open("","_blank");v.document.open(),v.document.write(e.value.etiqueta),v.document.close()}},F=()=>{const s=g.query.origem||"criar",e=g.query.id;s==="atualizar"?r.push(`/ordens-servicos/atualizar/${e}`):r.push("/ordens-servicos/criar-registro")};return(s,e)=>{const p=L,v=_e;return w(),B(M,{class:"mt-10",title:"Autenticação"},{default:o(()=>[a(ce,null,{default:o(()=>[f("div",ve,[a(ue,{label:"Tabelião/escrivão",modelValue:t(u).escrevente,"onUpdate:modelValue":e[0]||(e[0]=d=>t(u).escrevente=d),items:t(q),"item-title":"nome","item-value":"token",required:"","error-messages":t(V).escrevente.$errors.map(d=>d.$message),onBlur:t(V).escrevente.$touch,onInput:t(V).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),f("div",fe,[a(ee,{type:"number",label:"Quantidade",modelValue:t(u).quantidade,"onUpdate:modelValue":e[1]||(e[1]=d=>t(u).quantidade=d)},null,8,["modelValue"])]),a(ie,null,{default:o(()=>[f("div",null,[a(p,{onClick:F},{default:o(()=>[ge]),_:1})]),f("img",{class:"btn-pointer mt-10",src:le,onClick:R})]),_:1})]),_:1}),a(v,{show:t(x),errorMessage:t($),onClose:e[2]||(e[2]=d=>x.value=!1)},null,8,["show","errorMessage"])]),_:1})}}},Ce=J(ke,[["__scopeId","data-v-118f8b41"]]);export{Ce as default};
