import{_ as se}from"./DzodBXVr.js";import{u as ee,B as te,G as oe,r as d,C as ce,o as M,E as re,w as t,b as e,v as o,V as Z,z as J,d as B,s as ae,m as W,H as le,a as y,c as X,I as xe,L as Re,n as Fe,M as Ie,K as $e,F as ke,g as Ue,N as be,t as ne}from"./2k1OG2be.js";import{u as h}from"./BfC1W_vO.js";import{V as P}from"./CJG1SXhp.js";import{V as O}from"./CQWWYt0l.js";import{V as me}from"./B2iGOswU.js";import{V as ue}from"./CDrJLU9K.js";import{_ as Be,d as Ne}from"./ByWsuFV9.js";import{_ as Le,a as Ge,b as He,T as Je,W as Ke,S as We,r as we,D as Ce,c as Ee,d as Xe,e as Ye}from"./BqZuGtCh.js";import{_ as pe}from"./DuZSbDVd.js";import{_ as ie}from"./BVz1G1IN.js";import{_ as Qe,a as fe,b as _e}from"./BmSnlvkJ.js";import{V as ve}from"./BSaZDp9i.js";import{V as Ve,a as ge}from"./DYLGoNUO.js";import{c as Ze,r as et,u as tt}from"./D5AURBFW.js";import{_ as he}from"./CdP3NN9a.js";const Dt={__name:"Dados",props:{item_dados:{type:Array,required:!0},item_situacoes:{type:Array,required:!0}},setup(Y){const m=Y,{$toast:x}=ee(),f=ae(),b=te(),u=oe(),k=`${f.public.managemant}/updateAtos`,F=d(m.item_situacoes),C=ce({dt_abertura:m.item_dados[0].dt_abertura||null,status:m.item_dados[0].status||null,mne:m.item_dados[0].mne||null});async function N(){const{data:_,error:c,status:A}=await h(`${k}/${u.query.ato_id}`,{method:"PUT",body:{status:C.status,mne:C.mne,dt_abertura:C.dt_abertura}},"$EIT5jtTUdX");A.value==="success"&&x.success("Ato Atualizado com sucesso")}const z=()=>{const _=u.query.origem||"criar",c=u.query.id;_==="atualizar"?b.push(`/os/atualizar/${c}`):b.push("/os/criar-registro")};return(_,c)=>{const A=se;return M(),re(ue,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(O,{cols:"3"},{default:t(()=>[e(me,{label:"Situação",modelValue:o(C).status,"onUpdate:modelValue":c[0]||(c[0]=w=>o(C).status=w),items:o(F),"item-title":"descricao","item-value":"descricao",required:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(O,{cols:"5"},{default:t(()=>[e(Z,{label:"MNE - Matrícula Notoria Eletrônica",modelValue:o(C).mne,"onUpdate:modelValue":c[1]||(c[1]=w=>o(C).mne=w)},null,8,["modelValue"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(O,{cols:"2"},{default:t(()=>[e(Z,{modelValue:o(C).dt_abertura,"onUpdate:modelValue":c[2]||(c[2]=w=>o(C).dt_abertura=w),type:"date",label:"Data Lavratura",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(P,{class:"mb-3"},{default:t(()=>[e(A,{onClick:z},{default:t(()=>[e(J,{size:"large",color:"red"},{default:t(()=>c[3]||(c[3]=[B("Voltar")])),_:1})]),_:1}),e(J,{class:"ml-10",onClick:N,size:"large",color:"green"},{default:t(()=>c[4]||(c[4]=[B("Atualizar")])),_:1})]),_:1})]),_:1})}}},ot=["onClick"],at=["onClick"],st=["onClick"],rt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},nt={key:1,src:_e,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},lt=["onClick"],St={__name:"Partes",async setup(Y){let m,x;const f=te(),b=oe(),u=ae(),{$toast:k}=ee(),F=`${u.public.managemant}/pesquisarPessoas`,C=`${u.public.managemant}/listarPapeis`,N=`${u.public.managemant}/getLinkTipo`,z=`${u.public.managemant}/createAtosPessoa`,_=`${u.public.managemant}/updateAtosPessoa`,c=`${u.public.managemant}/getAtosPessoaById`,A=`${u.public.managemant}/download`,w=d(W("user-data").value.cartorio_token),V=d([]),D=d([]),T=d([]),I=d(!1),L=d(!1),p=d(!1),v=d(!1),G=d(null),s=d(null),r=d(null),q=d(null),a=d(null),l=d(b.query.tipo_ato_token),$=d(null),S=[{title:"Documento",align:"start",key:"pessoa.documento"},{title:"Pessoa",align:"start",key:"pessoa.nome"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"Representante",align:"start",key:"representante.nome"},{value:"actions"}],i=ce({papeis:null,nome:null,pessoa:null,documento:null}),{data:j}=([m,x]=le(()=>h(C,{method:"POST",body:{tipo_ato_token:b.query.tipo_ato_token}},"$acoiTIUp00")),m=await m,x(),m);T.value=j.value;const R=async()=>{const{data:g}=await h(`${c}/${b.query.ato_id}`,{method:"GET"},"$ypnU9hCpVn"),U=(Q=>Q.map(H=>({...H,pessoa:{...H.pessoa,documento:H.pessoa.doc_identificacao},papel:{...H.partes_tipos}})))(g.value);D.value=U};R();async function ye(){try{const{data:g,error:n}=await h(F,{method:"POST",body:{cartorio_token:w.value,documento:i.documento,nome:i.nome}},"$pr30MyPXfY");g.value.length>0?(V.value=g.value,i.pessoa=V.value[0]):V.value=[]}catch(g){console.error("Erro na requisição",g)}}const Pe=()=>{L.value=!0},Ae=async()=>{await R()},qe=async()=>{await R()},Te=async()=>{const g={pessoa:i.pessoa,papel:T.value.find(K=>K.id===i.papeis),representante:{nome:null}},n=await h(`${c}/${b.query.ato_id}`,{method:"GET"},"$scHdIvxj2D");for(const K of n.data.value)if(K.pessoa_id===i.pessoa.id&&K.ato_id===Number(b.query.ato_id)&&K.tipo_parte_id===i.papeis){k.error("Pessoa Já Registrada Com Esse Papel!");return}console.log({ato_id:b.query.ato_id,pessoa_id:i.pessoa.id,tipo_parte_id:i.papeis,user_id:W("user-data").value.usuario_id});const{data:U,error:Q,status:H}=await h(z,{method:"POST",body:{ato_id:b.query.ato_id,pessoa_id:i.pessoa.id,tipo_parte_id:i.papeis,user_id:W("user-data").value.usuario_id}},"$18isAgOJxG");H.value==="success"&&(g.id=U.value.id,k.success("Pessoa Registrada com Sucesso!"),D.value.push(g))},ze=async g=>{var K;if(p.value=!0,$.value=null,!g.pessoa.id)return;const{data:n}=await h(N,{method:"POST",body:{tipo:"ficha",id:g.pessoa.id}},"$hmDzSF3F61");if(!((K=n.value)!=null&&K.link))return;const{data:U}=await h(A,{method:"POST",body:{bucket:"qvgjz",path:n.value.link}},"$l09I6nLRfk"),Q=n.value.link,H=U.value;/\.(tr7|tiff)$/i.test(Q)?$.value=H:fotoRender.value=`data:image/jpeg;base64,${H}`},Oe=g=>{const n=D.value.filter(U=>U.pessoa.id!==g.pessoa.id).map(U=>({id:U.pessoa.id,nome:U.pessoa.nome}));r.value=g.id,G.value=n,I.value=!0,s.value=g.pessoa.nome,a.value=g.pessoa.id},Me=g=>{v.value=!0,q.value=g.id,s.value=g.pessoa.nome};async function De(g){g.excluido=!g.excluido;try{await h(`${_}/${g.id}`,{method:"PUT",body:JSON.stringify({excluido:g.excluido})},"$PUt0nEhmBF")}catch(n){console.error("Erro ao excluir pessoa:",n)}}const Se=()=>{const g=b.query.origem||"criar",n=b.query.id;g==="atualizar"?f.push(`/os/atualizar/${n}`):f.push("/os/criar-registro")};return(g,n)=>{const U=Be,Q=Ge,H=He,K=Ne,je=se;return M(),re(ue,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(O,{cols:"3"},{default:t(()=>[e(Z,{label:"Documento",modelValue:o(i).documento,"onUpdate:modelValue":n[0]||(n[0]=E=>o(i).documento=E)},null,8,["modelValue"])]),_:1}),e(O,{cols:"4"},{default:t(()=>[e(Z,{label:"Pessoa",modelValue:o(i).nome,"onUpdate:modelValue":n[1]||(n[1]=E=>o(i).nome=E)},null,8,["modelValue"])]),_:1}),y("div",null,[y("img",{class:"mt-1",src:pe,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:ye})]),y("div",null,[y("img",{class:"mt-1 ml-2",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:Pe})])]),_:1}),e(P,null,{default:t(()=>[e(O,{cols:"4"},{default:t(()=>[e(me,{label:"Selecione a Pessoa",modelValue:o(i).pessoa,"onUpdate:modelValue":n[2]||(n[2]=E=>o(i).pessoa=E),items:o(V),"item-title":"nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(O,{cols:"3"},{default:t(()=>[e(me,{label:"Papel",modelValue:o(i).papeis,"onUpdate:modelValue":n[3]||(n[3]=E=>o(i).papeis=E),items:o(T),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),y("div",null,[y("img",{class:"mt-1",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Representante",onClick:Te})])]),_:1}),e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(ve,{style:{height:"465px"},headers:S,items:o(D)},{"item.actions":t(({item:E})=>[e(P,null,{default:t(()=>[y("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:de=>ze(E),title:"Visualizar Ficha"},n[9]||(n[9]=[y("img",{style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar"},null,-1)]),8,ot),y("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:de=>Me(E),class:"mr-2",title:"Alterar Papel"},n[10]||(n[10]=[y("img",{style:{width:"30px",height:"30px"},src:Qe,alt:"Visualizar"},null,-1)]),8,at),y("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:de=>De(E),title:"Deletar Pessoa"},[E.excluido?(M(),X("img",rt)):(M(),X("img",nt))],8,st),y("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:de=>Oe(E),title:"Selecionar Representante"},n[11]||(n[11]=[y("img",{style:{width:"30px",height:"30px"},src:Le,alt:"Visualizar"},null,-1)]),8,lt)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(U,{show:o(L),onClose:n[4]||(n[4]=E=>L.value=!1)},null,8,["show"]),e(Q,{representante_nome:o(s),representantes:o(G),ato_id:o(r),show:o(I),onClose:n[5]||(n[5]=E=>I.value=!1),onUpdateRepresentante:qe},null,8,["representante_nome","representantes","ato_id","show"]),e(H,{representante_nome:o(s),ato_token:o(l),ato_id:o(q),show:o(v),onClose:n[6]||(n[6]=E=>v.value=!1),onUpdatePapel:Ae},null,8,["representante_nome","ato_token","ato_id","show"]),e(Ve,{modelValue:o(p),"onUpdate:modelValue":n[8]||(n[8]=E=>xe(p)?p.value=E:null),width:"600"},{default:t(()=>[e(ge,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(K,{"tiff-url":o($)},null,8,["tiff-url"]),e(J,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:n[7]||(n[7]=E=>p.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(P,null,{default:t(()=>[e(je,{onClick:Se},{default:t(()=>[e(J,{size:"large",color:"red"},{default:t(()=>n[12]||(n[12]=[B("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},it={key:0,class:"loading-overlay"},ct="https://ej2services.syncfusion.com/production/web-services/api/documenteditor/",jt={__name:"Minuta",emits:["page","doc"],setup(Y,{emit:m}){Re("DocumentEditorContainer",[Je,Ke,We]);const x=ae(),{$toast:f}=ee(),b=te(),u=oe(),k=m;we(`${x.public.docEditor}`);const F=`${x.public.managemant}/download`,C=`${x.public.managemant}/atos/files`,N=`${x.public.managemant}/subitituirModelo`,z=`${x.public.managemant}/upload`,_=d(null),c=d(!1),A=d("Ao executar a geração, a minuta atual será substituída e não poderá ser recuperada.Confirma ?"),w=d(!1),V=async a=>{try{const l=await fetch(a);if(!l.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await l.blob()}catch(l){return console.error(l),f.error("Erro ao carregar o documento inicial."),null}},D=async()=>{try{const{data:a}=await h(`${C}/${u.query.ato_token_edit}`,{method:"GET"},"$5jxI4TvFse");return a.value.link_ato}catch(a){console.error("Erro ao carregar o documento:",a),f.error(a)}},T=async()=>{w.value=!0;try{const a=await D(),{data:l,status:$}=await h(F,{method:"POST",body:{bucket:"qvgjz",path:a}},"$dvNFfvmIJC"),S=l.value,i=await V(S);if(i){const j=new FileReader;j.onload=()=>{const R=j.result;_.value.ej2Instances.documentEditor.open(R),k("doc",R)},j.readAsText(i)}}catch{f.error("Erro ao carregar o documento.")}finally{w.value=!1}},I=async()=>{const l=await _.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),$=new FileReader;$.onload=()=>{const S=$.result,j=_.value.ej2Instances.documentEditor.pageCount;k("page",j),k("doc",S)},$.readAsText(l)},L=async()=>{w.value=!0;try{const l=await _.value.ej2Instances.documentEditor.saveAsBlob("Sfdt"),$=new FormData;$.append("file",l,"anexo.sfdt"),$.append("cartorio_token",W("user-data").value.cartorio_token),$.append("token",u.query.ato_token_edit),$.append("tipo","ato_minuta");const{data:S,status:i}=await h(z,{method:"POST",body:$},"$xv11VtUdMy");if(i.value==="success"){f.success("Documento enviado!");const R=_.value.ej2Instances.documentEditor.pageCount;I(),k("page",R)}else f.error("Erro ao enviar documento para o sistema.")}catch(a){f.error("Erro ao salvar documento."),console.error(a)}finally{w.value=!1}},p=()=>{c.value=!1,v()},v=async()=>{r(!0);try{await G(),r(!0);const{data:a,status:l}=await h(N,{method:"POST",body:{ato_token:u.query.ato_token_edit}},"$zyzWHTXTBW");a.value&&s(a.value)}catch(a){console.error("Erro ao gerar a minuta:",a),f.error("Ocorreu um erro ao gerar a minuta.")}finally{r(!1)}},G=async()=>{try{const{data:a}=await h(F,{method:"POST",body:{bucket:"qvgjz",path:"provider/modeloAto.sfdt"}},"$KreLE0Ys81"),l=await V(a.value);if(l){const $=new FileReader;$.onload=()=>{const S=$.result;_.value.ej2Instances.documentEditor.open(S),k("doc",S)},$.readAsText(l)}}catch(a){console.error("Erro ao carregar o modelo de minuta:",a),f.error("Falha ao carregar o modelo de minuta.")}},s=a=>{const l=_.value.ej2Instances.documentEditor,$=S=>{for(const[i,j]of Object.entries(S))if(/^<<.+>>$/.test(i))try{l.search.findAll(i),l.search.searchResults.length>0&&l.search.searchResults.replaceAll(j)}catch(R){console.error(`Erro ao substituir o marcador ${i}:`,R)}else if(i==="partes"&&Array.isArray(j)&&j.length>0)for(const R of j)typeof R=="object"&&$(R)};$(a)},r=a=>{w.value=a},q=()=>{const a=u.query.origem||"criar",l=u.query.id;a==="atualizar"?b.push(`/os/atualizar/${l}`):b.push("/os/criar-registro")};return Fe(async()=>{await T(),I()}),(a,l)=>{const $=se,S=Ee;return M(),X(ke,null,[e(o(Ce),{height:"900px",ref_key:"documentEditorContainer",ref:_,serviceUrl:ct,enableToolbar:!0,enableWordExport:!0},null,512),o(w)?(M(),X("div",it,[e(Ie,{indeterminate:"",color:"white",size:"60",class:"loading-spinner"})])):$e("",!0),e(P,{class:"ml-4 mt-4 mb-4"},{default:t(()=>[e($,{class:"mr-4"},{default:t(()=>[e(J,{size:"large",onClick:q,color:"red"},{default:t(()=>l[2]||(l[2]=[B("Voltar")])),_:1})]),_:1}),e(J,{size:"large",color:"green",onClick:L,disabled:o(w)},{default:t(()=>l[3]||(l[3]=[B("Atualizar")])),_:1},8,["disabled"]),e(J,{class:"ml-4",size:"large",color:"blue",onClick:l[0]||(l[0]=i=>c.value=!0)},{default:t(()=>l[4]||(l[4]=[B("Gerar Minuta")])),_:1})]),_:1}),e(S,{onConfirm:p,condMessage:o(A),show:o(c),onClose:l[1]||(l[1]=i=>c.value=!1)},null,8,["condMessage","show"])],64)}}},ut={class:"d-flex align-center justify-center"},dt=["innerHTML"],Rt={__name:"Livro",props:{pages:{type:Number,required:!0},document:{type:String,required:!0}},setup(Y){const m=Y,x=ae();we(`${x.public.docEditor}`);const{$toast:f}=ee(),b=te(),u=oe(),k=`${x.public.managemant}/download`,F=`${x.public.managemant}/atos/files`,C=`${x.public.managemant}/lavrarAto`,N=d("Ao lavrar esse ato, a operação não poderá ser desfeita. Confirma ?"),z=d(!1),_=d(null),c=d(null),A=d(null),w=async p=>{try{const v=await fetch(p);if(!v.ok)throw new Error("Erro ao baixar o arquivo do MinIO.");return await v.blob()}catch(v){return console.error(v),f.error("Erro ao carregar o documento inicial."),null}},V=async()=>{try{const{data:p}=await h(`${F}/${u.query.ato_token_edit}`,{method:"GET"},"$FnEbAJEARP");return p.value.link_ato}catch(p){console.error("Erro ao carregar o documento:",p),f.error(p)}},D=async()=>{try{const p=await V(),{data:v,status:G}=await h(k,{method:"POST",body:{bucket:"qvgjz",path:p}},"$7ljqltMqa0"),s=v.value,r=await w(s);if(r){const q=new FileReader;q.onload=()=>{const a=q.result;A.value.ej2Instances.documentEditor.open(a)},q.readAsText(r)}}catch{f.error("Erro ao carregar o documento.")}};D();const T=async()=>{try{const{data:p,status:v}=await h(C,{method:"POST",body:{ato_token:u.query.ato_token_edit,qtd_paginas:m.pages}},"$OWxZSQkyX8");v.value==="success"?(_.value=p.value,c.value=p.value[0].selo,f.success("Ato lavrado com sucesso!")):f.error("Falha ao lavrar o ato.")}catch{f.error("Erro ao conectar com o servidor.")}},I=()=>{z.value=!1,T()},L=()=>{const p=u.query.origem||"criar",v=u.query.id;p==="atualizar"?b.push(`/os/atualizar/${v}`):b.push("/os/criar-registro")};return Ue(()=>m.document,(p,v)=>{D()}),(p,v)=>{const G=Ee;return M(),X(ke,null,[e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(o(Ce),{restrictEditing:!0,enableToolbar:!1,ref_key:"documentEditorContainer",ref:A,height:"850px",width:"850px"},null,512)]),_:1}),e(O,null,{default:t(()=>[y("div",ut,[y("div",null,[y("img",{onClick:v[0]||(v[0]=s=>z.value=!0),class:"ml-15",style:{height:"40px",width:"40px",cursor:"pointer","margin-top":"350px"},src:Xe}),o(_)?(M(),re(ge,{key:0,width:"360px",class:"mr-16"},{default:t(()=>[e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(be,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[B(" Livro: "+ne(o(_)[0].livro_numero),1)]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(be,{style:{"font-weight":"bold"},class:"pa-2 ma-2"},{default:t(()=>[B(" Folhas : "+ne(o(_)[0].pagina_inicial)+" Á "+ne(o(_)[0].pagina_final),1)]),_:1})]),_:1})]),_:1}),y("div",{style:{border:"1px solid black","border-radius":"8px","padding-bottom":"20px","margin-top":"-10px"},class:"ml-2 mb-2 mr-2",innerHTML:o(c)},null,8,dt)]),_:1})):$e("",!0)])])]),_:1})]),_:1}),B(" "+ne(m.pages)+" ",1),e(J,{class:"mt-5 ml-7 mb-5",color:"red",size:"large",onClick:L},{default:t(()=>v[2]||(v[2]=[B("Voltar")])),_:1}),e(G,{show:o(z),condMessage:o(N),onClose:v[1]||(v[1]=s=>z.value=!1),onConfirm:I},null,8,["show","condMessage"])],64)}}},mt=["onClick"],pt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},ft={key:1,src:_e,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Ft={__name:"Observacao",props:{ato_id:{type:Number,required:!0}},async setup(Y){let m,x;const f=te(),b=oe(),u=ae(),{$toast:k}=ee(),F=`${u.public.managemant}/listarEscrevente`;`${u.public.managemant}`;const C=`${u.public.managemant}/createAtosObservacao`,N=`${u.public.managemant}/updateAtosObservacao`,z=`${u.public.managemant}/getAtosObservacaoById`,_=d(W("user-data").value.cartorio_token),c=d([]),A=d([]),w=[{title:"Data",align:"start",key:"created"},{title:"Escrevente",align:"start",key:"users.nome"},{title:"Observação",align:"start",key:"observacao"},{value:"actions"}],V=ce({observacao:""}),D={observacao:{required:Ze.withMessage("O campo é obrigatório",et)}},T=tt(D,V),{data:I}=([m,x]=le(()=>h(`${z}/${b.query.ato_id}`,{method:"GET"},"$HyzoO40swN")),m=await m,x(),m);c.value=I.value.map(s=>({...s,created:he(s.created,"dd/mm/yyyy hh:mm")}));async function L(){if(V.observacao.trim()===""){k.error("O campo de observação está vazio.");return}if(await T.value.$validate()){const{data:s,error:r,status:q}=await h(C,{method:"POST",body:{ato_id:b.query.ato_id,observacao:V.observacao,user_id:W("user-data").value.usuario_id}},"$gnHMo4uCXD");q.value==="success"&&(c.value.push({created:he(s.value.created,"dd/mm/yyyy hh:mm"),observacao:s.value.observacao,id:s.value.id,escrevente:W("user-data").value.nome}),V.observacao="",k.success("Observação registrada com sucesso"))}else k.error("Preencha os campos obrigatórios.")}async function p(s){s.excluido=!s.excluido;try{await h(`${N}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$sP9AKdd3Ky")}catch(r){console.error("Erro ao excluir observação:",r)}}const{data:v}=([m,x]=le(()=>h(F,{method:"POST",body:{cartorio_token:_}},"$HL9pndqGh0")),m=await m,x(),m);A.value=v.value[0].func_json_escreventes;const G=()=>{const s=b.query.origem||"criar",r=b.query.id;s==="atualizar"?f.push(`/os/atualizar/${r}`):f.push("/os/criar-registro")};return(s,r)=>{const q=se;return M(),re(ue,null,{default:t(()=>[e(P,{class:"mt-5"},{default:t(()=>[e(Z,{label:"Observação",modelValue:V.observacao,"onUpdate:modelValue":r[0]||(r[0]=a=>V.observacao=a),required:"","error-messages":o(T).observacao.$errors.length>0?o(T).observacao.$errors.map(a=>a.$message):[],onBlur:o(T).observacao.$touch,onInput:o(T).observacao.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),y("div",null,[y("img",{class:"btn-pointer ml-2",src:ie,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:L})])]),_:1}),e(P,null,{default:t(()=>[e(O,null,{default:t(()=>[e(ve,{style:{height:"465px"},headers:w,items:c.value},{"item.actions":t(({item:a})=>[y("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:l=>p(a),title:"Deletar Observação"},[a.excluido?(M(),X("img",pt)):(M(),X("img",ft))],8,mt)]),_:1},8,["items"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(q,{onClick:G},{default:t(()=>[e(J,{size:"large",color:"red"},{default:t(()=>r[1]||(r[1]=[B("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},_t=["onClick"],vt=["onClick"],gt={key:0,style:{width:"30px",height:"30px"},src:fe,alt:"Visualizar",title:"Reativar"},yt={key:1,src:_e,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},It={__name:"Anexos",async setup(Y){let m,x;const f=ae(),{$toast:b}=ee(),u=te(),k=oe(),F=`${f.public.biometria}/run-scanner`,C=`${f.public.managemant}/atos_anexos`,N=`${f.public.managemant}/atos_anexos`,z=`${f.public.managemant}/atos_anexos`,_=d(!1),c=d([]),A=ce({descricao:""}),w=[{title:"Documento",key:"descricao"},{text:"Ações",value:"actions"}],{data:V}=([m,x]=le(()=>h(`${z}/${k.query.ato_id}`,{method:"GET"},"$AOZpbz65MA")),m=await m,x(),m);c.value=V.value;async function D(){try{await T(),await I()}catch(s){console.error("Erro ao executar scanner ou listar arquivos:",s)}}async function T(){try{const{data:s}=await h(F,{method:"GET"},"$KttjFhHivJ")}catch(s){b.error("Erro ao acionar o scanner:",s)}}async function I(){try{const{data:s,status:r}=await h("http://localhost:3500/uploadAnexo",{method:"POST",body:{tipo:"ato_translado",token:k.query.ato_token_edit,cartorio_token:W("user-data").value.cartorio_token}},"$TqQrsgxUkd")}catch(s){console.error("Erro ao enviar o arquivo:",s)}}const L=async()=>{_.value=!0},p=async()=>{const{data:s,error:r,status:q}=await h(C,{method:"POST",body:{ato_id:k.query.ato_id,descricao:A.descricao,user_id:W("user-data").value.usuario_id,link:"sdfsdfsdf"}},"$KDhIYzGKzM");q.value==="success"&&(b.success("Anexo registrado com sucesso!"),c.value.push(s.value))};async function v(s){s.excluido=!s.excluido;try{await h(`${N}/${s.id}`,{method:"PUT",body:JSON.stringify({excluido:s.excluido})},"$cdoFBGO0Ti")}catch(r){console.error("Erro ao excluir pessoa:",r)}}const G=()=>{const s=k.query.origem||"criar",r=k.query.id;s==="atualizar"?u.push(`/os/atualizar/${r}`):u.push("/os/criar-registro")};return(s,r)=>{const q=se;return M(),re(ue,null,{default:t(()=>[e(P,null,{default:t(()=>[e(O,{cols:"5"},{default:t(()=>[e(Z,{modelValue:o(A).descricao,"onUpdate:modelValue":r[0]||(r[0]=a=>o(A).descricao=a),label:"Descrição"},null,8,["modelValue"])]),_:1}),y("div",{onClick:D,title:"Escanear"},r[3]||(r[3]=[y("img",{class:"mt-3",style:{width:"40px",height:"40px",cursor:"pointer"},src:Ye,alt:"Escanear"},null,-1)])),y("div",{onClick:p,title:"Criar"},r[4]||(r[4]=[y("img",{class:"mt-3 ml-2",style:{width:"40px",height:"40px",cursor:"pointer"},src:ie,alt:"Criar"},null,-1)]))]),_:1}),e(ve,{headers:w,items:o(c),style:{height:"465px","max-width":"600px"}},{"item.actions":t(({item:a})=>[e(P,null,{default:t(()=>[y("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:l=>L(a),title:"Visualizar Anexo"},r[5]||(r[5]=[y("img",{style:{width:"30px",height:"30px"},src:pe,alt:"Visualizar"},null,-1)]),8,_t),y("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:l=>v(a),title:"Deletar Pessoa"},[a.excluido?(M(),X("img",gt)):(M(),X("img",yt))],8,vt)]),_:2},1024)]),_:1},8,["items"]),e(Ve,{modelValue:o(_),"onUpdate:modelValue":r[2]||(r[2]=a=>xe(_)?_.value=a:null),width:"600"},{default:t(()=>[e(ge,{"max-width":"600",title:"Anexo"},{default:t(()=>[e(J,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:r[1]||(r[1]=a=>_.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(q,{onClick:G},{default:t(()=>[e(J,{size:"large",color:"red"},{default:t(()=>r[6]||(r[6]=[B("Voltar")])),_:1})]),_:1})]),_:1})}}};export{Dt as _,St as a,jt as b,Rt as c,Ft as d,It as e};
