import{V as fe,c as qe}from"./D7huH3Pb.js";import{V as ue}from"./B1O2iFOg.js";import{a as xe,V as ie}from"./CWCqhEgV.js";import{V as ge}from"./C8KtqoLr.js";import{J as be,u as Ve,r as m,e as ae,f as re,y as ne,g as ve,l as Ie,i as o,o as k,c as R,b as e,N as Pe,h as N,w as t,s as h,a as M,t as Ue,p as Q,V as W,d as O,k as $e,m as Oe,q as Ee,j as de}from"./DJCFfwgB.js";import{_ as ye}from"./D0FLhsRU.js";import{_ as ke}from"./C-LBNgBT.js";import{_ as ze}from"./CoC8yCvH.js";import{c as j,r as D,u as Ce}from"./Ddg9OYEk.js";import{u as S}from"./Bl1gDYRN.js";import{V as q}from"./CO-Ycd8f.js";import{V as f}from"./CnrwGq8P.js";import{V as Be}from"./BsUM2GJ3.js";import{V as Z}from"./e1DzKJZ8.js";import{V as he}from"./C4GcvwP1.js";import{c as Ne}from"./C-RF9tUe.js";import{_ as Ae}from"./BVz1G1IN.js";import{_ as je}from"./2QFdcvNX.js";import{_ as Re}from"./xmmNEeSr.js";import{_ as Le,a as De}from"./DJvq3mCv.js";import{V as Fe}from"./DvtyLVxu.js";const Ge={key:0,class:"d-flex justify-center"},He={key:0,class:"text-error text-caption mt-1"},Me={__name:"Dados",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(B,{emit:A}){let n,p;const v=B,I=A,U=be(),u=$e(),{$toast:w}=Ve(),{id:y}=U.params,$=`${u.public.managemant}/atos_bens`,E=`${u.public.managemant}/atos_bens`,T=`${u.public.managemant}/atos_bens`,V=`${u.public.managemant}/registro_imoveis`,F=`${u.public.managemant}/natureza_imoveis`,G=`${u.public.managemant}/tipo_logradouros`,x=`${u.public.managemant}/situacao_imoveis`,g=`${u.public.managemant}/listarCidades`,z=`${u.public.managemant}/listarTipoBens`,P=m(ae("user-data").value.cartorio_token),H=m(ae("user-data").value.usuario_id).value,X=m([]),K=m([]),me=m([]),ee=m([]),te=m([]),C=m([]),Y=m(!0),i=re({tabvalores_tipo_regimovel_id:null,registro_cartorio:null,registro_matricula:null,matricula_letra:null,tabvalores_nat_imovel_id:null,cib:null,sem_recebimento:!1,tabvalores_tipologradouro_id:null,tipo_id:null,descricao:null,inscricao_estadual:null,tabvalores_situacao_imoveis_id:null,vlr_avaliacao:null,vlr_mercado:null,valor_mercado:"0.00",aliq_itbi:null,vlr_itbi:null,vlr_pago_dinheiro:null,user_id:H,ato_id:Number(U.query.ato_id)||Number(v.ato_id)}),le=re({...i}),J={descricao:{required:j.withMessage("O campo é obrigatório",D)},tipo_id:{required:j.withMessage("O campo é obrigatório",D)},registro_matricula:{required:j.withMessage("O campo é obrigatório",D)},inscricao_estadual:{required:j.withMessage("O campo é obrigatório",D)},vlr_avaliacao:{required:j.withMessage("O campo é obrigatório",D),notZero:j.withMessage("O valor não pode ser zero",c=>!!c&&Number(c.toString().replace(/,/g,""))>0)}},d=Ce(J,i),se=async()=>{var s,r,oe,we;if(!await d.value.$validate()){w.error("Preencha todos os campos obrigatórios!");return}if(Number((i.vlr_pago_dinheiro||"0").toString().replace(/,/g,""))===0&&!i.sem_recebimento){w.error("É obrigatório marcar a declaração quando não houver recebimento em espécie.");return}const _={...i,vlr_avaliacao:(s=i.vlr_avaliacao)==null?void 0:s.replace(/,/g,""),vlr_mercado:(r=i.vlr_mercado)==null?void 0:r.replace(/,/g,""),aliq_itbi:(oe=i.aliq_itbi)==null?void 0:oe.replace(/,/g,""),vlr_itbi:(we=i.vlr_itbi)==null?void 0:we.replace(/,/g,"")},{data:l,status:b}=await S(`${$}`,{method:"POST",body:_},"$0Mdv6RF9cH");b.value==="success"&&(w.success("Imovel criado com sucesso!"),I("saved",{id:l.value.id,token:l.value.token,ato_id:l.value.ato_id}))},{data:ce}=([n,p]=ne(()=>S(`${z}`,{method:"POST",body:{cartorio_token:P.value,imoveis:!0}},"$H1S2cTYpdB")),n=await n,p(),n);if(C.value=ce.value,v.isUpdate===!0){const{data:c}=([n,p]=ne(()=>S(`${E}/${v.imovel_id}`,{method:"GET"},"$jHrIlABk8l")),n=await n,p(),n);c.value&&Object.keys(i).forEach(a=>{c.value[a]!==void 0&&(i[a]=c.value[a])}),Object.assign(le,i)}async function L(){try{const[c,a,_,l,b]=await Promise.all([$fetch(F),$fetch(V),$fetch(x),$fetch(G),$fetch(g)]);K.value=c,X.value=a,te.value=_,me.value=l,ee.value=b}catch(c){console.error("Erro ao carregar os dados de imoveis pessoa:",c)}finally{Y.value=!1}}const pe=async c=>{const a={};if(Object.keys(i).forEach(l=>{i[l]!==le[l]&&(a[l]=i[l])}),["vlr_avaliacao","vlr_mercado","aliq_itbi","vlr_itbi"].forEach(l=>{var b;a[l]&&(a[l]=(b=a[l])==null?void 0:b.toString().replace(/,/g,""))}),Object.keys(a).length===0)return;const{status:_}=await S(`${T}/${c}`,{method:"PUT",body:a},"$BZjXR26AL9");_.value==="success"&&(w.success("Imovel Atualizado com sucesso!"),I("close-modal"))},_e=()=>{I("close-modal"),I("refresh-list")};return ve([()=>i.vlr_avaliacao?i.vlr_avaliacao.replace(/,/g,""):"0",()=>i.aliq_itbi?i.aliq_itbi.replace(/,/g,""):"0"],([c,a])=>{i.vlr_itbi=(Number(c)*Number(a)/100).toFixed(2)}),Ie(()=>{y||v.ato_id?L():Y.value=!1}),(c,a)=>{const _=ye,l=ke,b=ze;return o(Y)?(k(),R("div",Ge,[e(Pe,{indeterminate:"",class:"loading-spinner",size:"64"})])):(k(),N(ue,{key:1},{default:t(()=>[e(q,null,{default:t(()=>[e(f,{class:"mt-2",cols:"12"},{default:t(()=>[e(Be,{label:"Descrição",modelValue:o(i).descricao,"onUpdate:modelValue":a[0]||(a[0]=s=>o(i).descricao=s),"error-messages":o(d).descricao.$errors.map(s=>s.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,{cols:"3"},{default:t(()=>[e(Z,{label:"Tipo de Registro",modelValue:o(i).tabvalores_tipo_regimovel_id,"onUpdate:modelValue":a[1]||(a[1]=s=>o(i).tabvalores_tipo_regimovel_id=s),items:o(X),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[e(h,{label:"Cartório",modelValue:o(i).registro_cartorio,"onUpdate:modelValue":a[2]||(a[2]=s=>o(i).registro_cartorio=s)},null,8,["modelValue"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[e(h,{label:"Matricula",modelValue:o(i).registro_matricula,"onUpdate:modelValue":a[3]||(a[3]=s=>o(i).registro_matricula=s),"error-messages":o(d).registro_matricula.$errors.map(s=>s.$message)},null,8,["modelValue","error-messages"])]),_:1}),e(f,null,{default:t(()=>[e(h,{label:"Letra",modelValue:o(i).matricula_letra,"onUpdate:modelValue":a[4]||(a[4]=s=>o(i).matricula_letra=s)},null,8,["modelValue"])]),_:1}),e(f,{cols:"4"},{default:t(()=>[e(Z,{label:"Natureza",modelValue:o(i).tabvalores_nat_imovel_id,"onUpdate:modelValue":a[5]||(a[5]=s=>o(i).tabvalores_nat_imovel_id=s),items:o(K),"item-title":"descricao","item-value":"id"},null,8,["modelValue","items"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,{cols:"2"},{default:t(()=>[e(h,{label:"CIB",modelValue:o(i).cib,"onUpdate:modelValue":a[6]||(a[6]=s=>o(i).cib=s)},null,8,["modelValue"])]),_:1}),e(f,{cols:"3"},{default:t(()=>[e(Z,{modelValue:o(i).tipo_id,"onUpdate:modelValue":a[7]||(a[7]=s=>o(i).tipo_id=s),items:o(C),label:"Tipo de imovel","item-title":"descricao","item-value":"id","error-messages":o(d).tipo_id.$errors.map(s=>s.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(f,{cols:"3"},{default:t(()=>[e(h,{label:"Inscrição Municipal",modelValue:o(i).inscricao_estadual,"onUpdate:modelValue":a[8]||(a[8]=s=>o(i).inscricao_estadual=s),"error-messages":o(d).inscricao_estadual.$errors.map(s=>s.$message)},null,8,["modelValue","error-messages"])]),_:1}),e(f,{cols:"4"},{default:t(()=>[e(Z,{label:"Situação",items:o(te),"item-title":"descricao","item-value":"id",modelValue:o(i).tabvalores_situacao_imoveis_id,"onUpdate:modelValue":a[9]||(a[9]=s=>o(i).tabvalores_situacao_imoveis_id=s)},null,8,["items","modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,{cols:"2"},{default:t(()=>{var s;return[a[17]||(a[17]=M("label",null,"Valor Avaliação",-1)),e(_,{label:"Valor Avaliação",modelValue:o(i).vlr_avaliacao,"onUpdate:modelValue":a[10]||(a[10]=r=>o(i).vlr_avaliacao=r)},null,8,["modelValue"]),o(d).vlr_avaliacao.$error?(k(),R("div",He,Ue((s=o(d).vlr_avaliacao.$errors[0])==null?void 0:s.$message),1)):Q("",!0)]}),_:1}),e(f,{cols:"2"},{default:t(()=>[a[18]||(a[18]=M("label",null,"Valor Mercado",-1)),e(_,{label:"Valor Mercado",modelValue:o(i).vlr_mercado,"onUpdate:modelValue":a[11]||(a[11]=s=>o(i).vlr_mercado=s)},null,8,["modelValue"])]),_:1}),e(f,{cols:"1"},{default:t(()=>[a[19]||(a[19]=M("label",null,"%ITB",-1)),e(_,{label:"%ITB",modelValue:o(i).aliq_itbi,"onUpdate:modelValue":a[12]||(a[12]=s=>o(i).aliq_itbi=s)},null,8,["modelValue"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[a[20]||(a[20]=M("label",null,"Valor ITB",-1)),e(_,{label:"Valor ITB",modelValue:o(i).vlr_itbi,"onUpdate:modelValue":a[13]||(a[13]=s=>o(i).vlr_itbi=s)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[a[21]||(a[21]=M("label",null,"Valor Recebido em R$",-1)),e(_,{label:"Valor Recebido em R$",modelValue:o(i).vlr_pago_dinheiro,"onUpdate:modelValue":a[14]||(a[14]=s=>o(i).vlr_pago_dinheiro=s),style:{width:"160px"}},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(he,{modelValue:o(i).sem_recebimento,"onUpdate:modelValue":a[15]||(a[15]=s=>o(i).sem_recebimento=s),label:"Não houve recebimento em R$"},null,8,["modelValue"])]),_:1})]),_:1}),e(q,{class:"mt-10"},{default:t(()=>[e(l,{onClick:_e},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>a[22]||(a[22]=[O("Voltar")])),_:1})]),_:1}),B.isUpdate?(k(),N(W,{key:0,class:"ml-5",size:"large",color:"green",onClick:a[16]||(a[16]=s=>pe(v.imovel_id))},{default:t(()=>a[23]||(a[23]=[O("Atualizar")])),_:1})):(k(),N(b,{key:1,class:"ml-5",onSave:se},{default:t(()=>a[24]||(a[24]=[O(" Salvar ")])),_:1}))]),_:1})]),_:1}))}}},Ye={key:0,class:"d-flex justify-center"},Se={__name:"Enderecos",props:{ato_token:{type:String,required:!0},ato_id:{type:Number,required:!0},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(B,{emit:A}){let n,p;const v=B,I=A,U=be(),u=$e(),{$toast:w}=Ve(),{id:y}=U.params,$=`${u.public.managemant}/atos_bens`,E=`${u.public.managemant}/atos_bens`,T=`${u.public.managemant}/registro_imoveis`,V=`${u.public.managemant}/natureza_imoveis`,F=`${u.public.managemant}/tipo_logradouros`,G=`${u.public.managemant}/situacao_imoveis`,x=`${u.public.auth}/service/gerencia/cep`,g=`${u.public.managemant}/listarCidades`,z=`${u.public.managemant}/listarTipoBens`,P=m(ae("user-data").value.cartorio_token),H=m(ae("user-data").value.usuario_id).value,K=ae("auth_token").value,me=m(!1),ee=m([]),te=m([]),C=m([]),Y=m([]),i=m([]),le=m([]),J=m(!0),d=re({end_cidade_id:null,end_quadra:null,end_lote:null,tabvalores_tipologradouro_id:null,end_logradouro:null,end_logradouro_numero:null,end_bairro:null,end_cep:null,end_complemento:null,user_id:H,ato_id:Number(U.query.ato_id)||Number(v.ato_id)}),se=re({...d}),ce={end_logradouro_numero:{required:j.withMessage("",D)},end_cep:{required:j.withMessage("O campo é obrigatório",D)},end_bairro:{required:j.withMessage("O campo é obrigatório",D)},end_cidade_id:{required:j.withMessage("O campo é obrigatório",D)},tabvalores_tipologradouro_id:{required:j.withMessage("O campo é obrigatório",D)}},L=Ce(ce,d),{data:pe}=([n,p]=ne(()=>S(`${z}`,{method:"POST",body:{cartorio_token:P.value,imoveis:!0}},"$W62VZQp5Tx")),n=await n,p(),n);if(le.value=pe.value,v.isUpdate===!0){const{data:_}=([n,p]=ne(()=>S(`${$}/${v.imovel_id}`,{method:"GET"},"$uGMUgsxHFk")),n=await n,p(),n);_.value&&Object.keys(d).forEach(l=>{_.value[l]!==void 0&&(d[l]=_.value[l])}),Object.assign(se,d)}async function _e(){try{const[_,l,b,s,r]=await Promise.all([$fetch(V),$fetch(T),$fetch(G),$fetch(F),$fetch(g)]);te.value=_,ee.value=l,i.value=b,C.value=s,Y.value=r}catch(_){console.error("Erro ao carregar os dados de imoveis pessoa:",_)}finally{J.value=!1}}const c=async _=>{if(me.value=!0,!v.isUpdate&&!await L.value.$validate()){w.error("Preencha todos os campos obrigatórios!");return}const l={};if(Object.keys(d).forEach(s=>{d[s]!==se[s]&&(l[s]=d[s])}),Object.keys(l).length===0)return;const{status:b}=await S(`${E}/${_}`,{method:"PUT",body:l},"$JWP9Pf1MfJ");b.value==="success"&&w.success("Imovel Atualizado com sucesso!")},a=()=>{I("close-modal"),I("refresh-list")};return ve(()=>d.end_cep,async _=>{if(_&&_.length===8)try{const{data:l,error:b}=await S(`${x}/${_}`,{headers:{Authorization:K}},"$b99zbpjYFS");if(b.value){console.error("Erro ao buscar CEP:",b.value),w.error("Erro ao buscar CEP no servidor.");return}if(l.value.logradouro&&l.value.bairro&&l.value.localidade&&l.value.uf){d.end_logradouro=l.value.logradouro,d.end_bairro=l.value.bairro,d.end_complemento=l.value.complemento;let s=`${l.value.localidade}/${l.value.uf}`.toUpperCase();const r=Y.value.find(oe=>oe.descricao===s);r?d.end_cidade_id=r.id:w.error("Cidade não encontrada na lista!")}else w.error("CEP não retornou dados válidos!")}catch(l){console.error("Erro inesperado:",l),w.error("Erro inesperado. Verifique sua conexão.")}}),Ie(()=>{y||v.ato_id||v.imovel_id?_e():J.value=!1}),(_,l)=>{const b=ke,s=Oe("mask");return o(J)?(k(),R("div",Ye,[e(Pe,{indeterminate:"",class:"loading-spinner",size:"64"})])):(k(),N(ue,{key:1,style:{height:"500px"},class:"mt-2"},{default:t(()=>[e(q,null,{default:t(()=>[e(f,{cols:"2"},{default:t(()=>[Ee(e(h,{label:"CEP",modelValue:o(d).end_cep,"onUpdate:modelValue":l[0]||(l[0]=r=>o(d).end_cep=r),modelModifiers:{trim:!0},"error-messages":o(L).end_cep.$errors.map(r=>r.$message)},null,8,["modelValue","error-messages"]),[[s,"########"]])]),_:1}),e(f,{cols:"5"},{default:t(()=>[e(Z,{label:"Cidade",modelValue:o(d).end_cidade_id,"onUpdate:modelValue":l[1]||(l[1]=r=>o(d).end_cidade_id=r),items:o(Y),"item-title":"descricao","item-value":"id","error-messages":o(L).end_cidade_id.$errors.map(r=>r.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[e(h,{label:"Quadra",modelValue:o(d).end_quadra,"onUpdate:modelValue":l[2]||(l[2]=r=>o(d).end_quadra=r)},null,8,["modelValue"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[e(h,{label:"Lote",modelValue:o(d).end_lote,"onUpdate:modelValue":l[3]||(l[3]=r=>o(d).end_lote=r)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,{cols:"4"},{default:t(()=>[e(Z,{label:"Tipo de Logradouro",modelValue:o(d).tabvalores_tipologradouro_id,"onUpdate:modelValue":l[4]||(l[4]=r=>o(d).tabvalores_tipologradouro_id=r),items:o(C),"item-title":"descricao","item-value":"id","error-messages":o(L).tabvalores_tipologradouro_id.$errors.map(r=>r.$message)},null,8,["modelValue","items","error-messages"])]),_:1}),e(f,{cols:"6"},{default:t(()=>[e(h,{label:"Logradouro",modelValue:o(d).end_logradouro,"onUpdate:modelValue":l[5]||(l[5]=r=>o(d).end_logradouro=r)},null,8,["modelValue"])]),_:1}),e(f,{cols:"1"},{default:t(()=>[e(h,{label:"N*",modelValue:o(d).end_logradouro_numero,"onUpdate:modelValue":l[6]||(l[6]=r=>o(d).end_logradouro_numero=r),"error-messages":o(L).end_logradouro_numero.$errors.map(r=>r.$message)},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,{cols:"6"},{default:t(()=>[e(h,{label:"Bairro",modelValue:o(d).end_bairro,"onUpdate:modelValue":l[7]||(l[7]=r=>o(d).end_bairro=r),"error-messages":o(L).end_bairro.$errors.map(r=>r.$message)},null,8,["modelValue","error-messages"])]),_:1}),e(f,{cols:"5"},{default:t(()=>[e(h,{label:"Complemento",modelValue:o(d).end_complemento,"onUpdate:modelValue":l[8]||(l[8]=r=>o(d).end_complemento=r)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,{class:"mt-10 justify-start"},{default:t(()=>[e(b,{onClick:a},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>l[11]||(l[11]=[O("Voltar")])),_:1})]),_:1}),B.isUpdate?(k(),N(W,{key:0,class:"ml-5",size:"large",color:"green",onClick:l[9]||(l[9]=r=>c(v.imovel_id))},{default:t(()=>l[12]||(l[12]=[O("Atualizar")])),_:1})):(k(),N(W,{key:1,class:"ml-5",size:"large",color:"green",onClick:l[10]||(l[10]=r=>c(v.imovel_id))},{default:t(()=>l[13]||(l[13]=[O("Salvar")])),_:1}))]),_:1})]),_:1}))}}},Je={class:"ml-4"},Qe={__name:"Partes",props:{show:Boolean,ato_token:String,ato_id:Number,partes_imovel:Object},emits:["close","update-imovel"],setup(B,{emit:A}){const n=B,p=m(n.show),v=be(),I=$e(),{$toast:U}=Ve(),u=`${I.public.managemant}/bens_pessoa`,w=`${I.public.managemant}/listarPapeis`,y=m([]),$=re({percentual:null,tipo_parte_id:null}),E=m({}),T=A;ve(()=>n.show,async x=>{p.value=x,x&&(await F(),$.tipo_parte_id=n.partes_imovel.papel.descricao||null,$.percentual=n.partes_imovel.percentual.replace(/,/g,"")||null,E.value={tipo_parte_id:$.tipo_parte_id,percentual:$.percentual.replace(/,/g,"")})});const V=()=>{$.tipo_parte_id=null,$.percentual=null,p.value=!1,T("close")},F=async()=>{const{data:x}=await S(w,{method:"POST",body:{tipo_ato_token:v.query.tipo_ato_token}},"$IjSu4kwy4b");y.value=x.value},G=async()=>{const x={};Object.keys($).forEach(z=>{let P=$[z];z==="tipo_parte_id"&&P&&(P=P.id),P!==E.value[z]&&(x[z]=P)}),x.percentual&&(x.percentual=x.percentual.toString().replace(/,/g,""));const{status:g}=await S(`${u}/${n.partes_imovel.id}`,{method:"PUT",body:x},"$QkvGl1R6ZY");g.value==="success"&&(U.success("Parte Atualizada com Sucesso!"),T("update-imovel",x),V())};return(x,g)=>{const z=ye;return k(),N(ge,{persistent:"",modelValue:o(p),"onUpdate:modelValue":g[2]||(g[2]=P=>de(p)?p.value=P:null),"max-width":"800"},{default:t(()=>[e(fe,null,{default:t(()=>[e(ue,null,{default:t(()=>[e(q,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:t(()=>[M("h1",Je," Altere o papel para: "+Ue(n.partes_imovel.pessoa.nome),1)]),_:1}),g[4]||(g[4]=M("hr",{class:"mb-5"},null,-1)),e(q,null,{default:t(()=>[e(f,{cols:"8"},{default:t(()=>[e(Z,{class:"mt-6",label:"Selecione o Papel",modelValue:o($).tipo_parte_id,"onUpdate:modelValue":g[0]||(g[0]=P=>o($).tipo_parte_id=P),items:o(y),"item-title":"descricao","item-value":"descricao","return-object":""},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"2"},{default:t(()=>[g[3]||(g[3]=M("label",null,"%",-1)),e(z,{modelValue:o($).percentual,"onUpdate:modelValue":g[1]||(g[1]=P=>o($).percentual=P)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(qe,null,{default:t(()=>[e(W,{style:{"background-color":"red",color:"white"},onClick:V},{default:t(()=>g[5]||(g[5]=[O("Voltar")])),_:1}),e(W,{style:{"background-color":"green",color:"white"},onClick:G},{default:t(()=>g[6]||(g[6]=[O("Salvar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Ze=["onClick"],We=["onClick"],Xe=["onClick"],Ke={key:0,style:{width:"30px",height:"30px"},src:Le,alt:"Visualizar",title:"Reativar"},eo={key:1,src:De,alt:"Excluir",class:"trash-icon",style:{width:"30px",height:"30px"},title:"Excluir"},Te={__name:"Partes",props:{ato_token:{type:String},ato_token_selected:{type:String},ato_id:{type:Number},isUpdate:{type:Boolean},imovel_id:{type:Number}},emits:["saved","close-modal","refresh-list"],async setup(B,{emit:A}){let n,p;const v=B,I=A,U=be(),u=$e(),{$toast:w}=Ve(),y=`${u.public.managemant}/partes_atos`,$=`${u.public.managemant}/listarPapeis`,E=`${u.public.managemant}/getLinkTipo`,T=`${u.public.managemant}/bens_pessoa`,V=`${u.public.managemant}/bens_pessoa`,F=`${u.public.managemant}/bens_pessoa`,G=`${u.public.managemant}/download`,x=m(null),g=m([]),z=m([]),P=m([]),H=m(!1),X=m(!1),K=m(null),me=m(U.query.tipo_ato_token),ee=m(null),te=[{title:"Pessoa",align:"start",key:"pessoa.nome",width:"50%"},{title:"Papel",align:"start",key:"papel.descricao"},{title:"%",align:"start",key:"percentual"},{value:"actions"}],C=re({papeis:null,percentual:null}),{data:Y}=([n,p]=ne(()=>S($,{method:"POST",body:{rotina:"PARTE_IMOVEL"}},"$X6FDd5A6WK")),n=await n,p(),n);P.value=Y.value;const i=async()=>{const{data:c}=await S(`${V}/${v.imovel_id}`,{method:"GET"},"$Dyv7lSgcqT"),_=(l=>l.map(b=>({...b,pessoa:{...b.pessoa,documento:b.pessoa.doc_identificacao},papel:{...b.partes_tipos}})))(c.value);z.value=_};i();const le=async()=>{await i()},{data:J,status:d}=([n,p]=ne(()=>S(y,{method:"POST",body:{ato_token:v.ato_token||U.query.ato_token_edit}},"$Ir36YwSBFY")),n=await n,p(),n);g.value=J.value&&Object.keys(J.value).length===0?[]:J.value;const se=async()=>{const c={pessoa:{nome:C.pessoa.pessoa_nome},papel:P.value.find(l=>l.id===C.papeis),percentual:C.percentual},{data:a,status:_}=await S(T,{method:"POST",body:{bem_id:v.imovel_id,ato_id:Number(U.query.ato_id),pessoa_id:C.pessoa.pessoa_id,tipo_parte_id:C.papeis,user_id:ae("user-data").value.usuario_id,percentual:C.percentual.replace(/,/g,"")}},"$z4QOGPyvCc");_.value==="success"&&(c.id=a.value.id,w.success("Pessoa Registrada com Sucesso!"),z.value.push(c))},ce=async c=>{var s;if(H.value=!0,ee.value=null,!c.pessoa.id)return;const{data:a}=await S(E,{method:"POST",body:{tipo:"ficha",id:c.pessoa.id}},"$XYnqHmowsR");if(!((s=a.value)!=null&&s.link))return;const{data:_}=await S(G,{method:"POST",body:{bucket:ae("user-data").value.cartorio_token,path:a.value.link}},"$63DgHOk5hC"),l=a.value.link,b=_.value;/\.(tr7|tiff)$/i.test(l)?ee.value=b:fotoRender.value=`data:image/jpeg;base64,${b}`},L=c=>{X.value=!0,x.value=c,K.value=c.id};async function pe(c){c.excluido=!c.excluido;try{await S(`${F}/${c.id}`,{method:"PUT",body:JSON.stringify({excluido:c.excluido})},"$3fKfAn4Pra")}catch(a){console.error("Erro ao excluir pessoa:",a)}}const _e=()=>{I("close-modal"),I("refresh-list")};return(c,a)=>{const _=ye,l=Qe,b=Ne,s=ke;return k(),N(ue,{style:{height:"500px"}},{default:t(()=>[e(q,null,{default:t(()=>[e(f,{class:"mt-6",cols:"4"},{default:t(()=>[e(Z,{label:"Selecione a Pessoa",modelValue:o(C).pessoa,"onUpdate:modelValue":a[0]||(a[0]=r=>o(C).pessoa=r),items:o(g),"item-title":"pessoa_nome","item-value":"id","return-object":"",required:""},null,8,["modelValue","items"])]),_:1}),e(f,{class:"mt-6",cols:"3"},{default:t(()=>[e(Z,{label:"Papel",modelValue:o(C).papeis,"onUpdate:modelValue":a[1]||(a[1]=r=>o(C).papeis=r),items:o(P),"item-title":"descricao","item-value":"id",required:""},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"1"},{default:t(()=>[a[6]||(a[6]=M("label",null,"%",-1)),e(_,{modelValue:o(C).percentual,"onUpdate:modelValue":a[2]||(a[2]=r=>o(C).percentual=r)},null,8,["modelValue"])]),_:1}),M("div",null,[M("img",{class:"mt-7",src:Ae,style:{width:"40px",cursor:"pointer"},title:"Criar Imovel",onClick:se})])]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(Fe,{style:{height:"350px"},headers:te,items:o(z)},{"item.actions":t(({item:r})=>[e(q,null,{default:t(()=>[M("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},class:"mr-2",onClick:oe=>ce(r),title:"Visualizar Ficha"},a[7]||(a[7]=[M("img",{style:{width:"30px",height:"30px"},src:je,alt:"Visualizar"},null,-1)]),8,Ze),M("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:oe=>L(r),class:"mr-2",title:"Alterar Papel"},a[8]||(a[8]=[M("img",{style:{width:"30px",height:"30px"},src:Re,alt:"Visualizar"},null,-1)]),8,We),M("div",{class:"mr-2",style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:oe=>pe(r),title:"Deletar Pessoa"},[r.excluido?(k(),R("img",Ke)):(k(),R("img",eo))],8,Xe)]),_:2},1024)]),_:1},8,["items"])]),_:1})]),_:1}),e(l,{partes_imovel:o(x),ato_token:o(me),ato_id:o(K),show:o(X),onClose:a[3]||(a[3]=r=>X.value=!1),onUpdateImovel:le},null,8,["partes_imovel","ato_token","ato_id","show"]),e(ge,{modelValue:o(H),"onUpdate:modelValue":a[5]||(a[5]=r=>de(H)?H.value=r:null),width:"600"},{default:t(()=>[e(fe,{"max-width":"600",title:"Ficha"},{default:t(()=>[e(b,{"tiff-url":o(ee)},null,8,["tiff-url"]),e(W,{class:"ms-auto mt-3 mb-3",text:"Fechar",size:"large",color:"red",onClick:a[4]||(a[4]=r=>H.value=!1)})]),_:1})]),_:1},8,["modelValue"]),e(q,{class:"mt-5"},{default:t(()=>[e(s,{onClick:_e},{default:t(()=>[e(W,{size:"large",color:"red"},{default:t(()=>a[9]||(a[9]=[O("Voltar")])),_:1})]),_:1})]),_:1})]),_:1})}}},oo={key:0},ao={key:1},to={key:2},Mo={__name:"Cadastro",props:{show:Boolean,imovel_id:Number,ato_token:String,ato_id:Number,ato_token_selected:String},emits:["close","refresh"],setup(B,{emit:A}){const n=B,p=m("dados"),v=m(n.show),I=m(null),U=m(null),u=m(!1),w=A;ve(()=>n.show,T=>{v.value=T});const y=T=>{u.value=!0,U.value=T.ato_id,I.value=T.id},$=()=>{v.value=!1,u.value=!1,w("close")},E=()=>{w("refresh")};return(T,V)=>{const F=Me,G=Se,x=Te;return k(),N(ge,{persistent:"",modelValue:o(v),"onUpdate:modelValue":V[1]||(V[1]=g=>de(v)?v.value=g:null),"max-width":"1000"},{default:t(()=>[e(fe,{style:{height:"650px"}},{default:t(()=>[e(ue,null,{default:t(()=>[V[5]||(V[5]=M("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Cadastro de imoveis ",-1)),e(xe,{modelValue:o(p),"onUpdate:modelValue":V[0]||(V[0]=g=>de(p)?p.value=g:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(ie,{value:"dados"},{default:t(()=>V[2]||(V[2]=[O("Dados")])),_:1}),o(u)?(k(),N(ie,{key:0,value:"enderecos"},{default:t(()=>V[3]||(V[3]=[O("Endereco")])),_:1})):Q("",!0),o(u)?(k(),N(ie,{key:1,value:"partes"},{default:t(()=>V[4]||(V[4]=[O("Partes")])),_:1})):Q("",!0)]),_:1},8,["modelValue"]),o(p)==="dados"?(k(),R("div",oo,[e(F,{onRefreshList:E,ato_id:n.ato_id,onSaved:y,onCloseModal:$},null,8,["ato_id"])])):Q("",!0),o(p)==="enderecos"&&o(u)?(k(),R("div",ao,[e(G,{onRefreshList:E,isUpdate:!1,ato_id:o(U),ato_token:n.ato_token,imovel_id:o(I),onCloseModal:$},null,8,["ato_id","ato_token","imovel_id"])])):Q("",!0),o(p)==="partes"&&o(u)?(k(),R("div",to,[e(x,{onRefreshList:E,imovel_id:o(I),ato_token:n.ato_token,ato_id:n.ato_id,ato_token_selected:n.ato_token_selected,onCloseModal:$},null,8,["imovel_id","ato_token","ato_id","ato_token_selected"])])):Q("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},lo={key:0},so={key:1},io={key:2},So={__name:"Atualizar",props:{show:Boolean,imovel_id:Number,ato_token_selected:String},emits:["close","refresh"],setup(B,{emit:A}){const n=B,p=m("dados"),v=m(n.show),I=A;ve(()=>n.show,w=>{v.value=w});const U=()=>{v.value=!1,I("close")},u=()=>{I("refresh")};return(w,y)=>{const $=Me,E=Se,T=Te;return k(),N(ge,{persistent:"",modelValue:o(v),"onUpdate:modelValue":y[1]||(y[1]=V=>de(v)?v.value=V:null),"max-width":"1000"},{default:t(()=>[e(fe,{style:{height:"650px"}},{default:t(()=>[e(ue,null,{default:t(()=>[y[5]||(y[5]=M("h1",{style:{"background-color":"#f5f2f2",color:"#525050",padding:"10px 0px 0px 20px"}}," Atualizar imovel ",-1)),e(xe,{modelValue:o(p),"onUpdate:modelValue":y[0]||(y[0]=V=>de(p)?p.value=V:null),"bg-color":"#f5f2f2"},{default:t(()=>[e(ie,{value:"dados"},{default:t(()=>y[2]||(y[2]=[O("Dados")])),_:1}),e(ie,{value:"enderecos"},{default:t(()=>y[3]||(y[3]=[O("Endereço")])),_:1}),e(ie,{value:"partes"},{default:t(()=>y[4]||(y[4]=[O("Partes")])),_:1})]),_:1},8,["modelValue"]),o(p)==="dados"?(k(),R("div",lo,[e($,{onRefreshList:u,isUpdate:!0,imovel_id:n.imovel_id,onCloseModal:U},null,8,["imovel_id"])])):Q("",!0),o(p)==="enderecos"?(k(),R("div",so,[e(E,{onRefreshList:u,isUpdate:!0,imovel_id:n.imovel_id,onCloseModal:U},null,8,["imovel_id"])])):Q("",!0),o(p)==="partes"?(k(),R("div",io,[e(T,{imovel_id:n.imovel_id,ato_token_selected:n.ato_token_selected,onCloseModal:U},null,8,["imovel_id","ato_token_selected"])])):Q("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{Mo as _,So as a};
