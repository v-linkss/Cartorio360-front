import{r as m,n as N,p as O,g as P,H as U,o as M,y as j,w as l,b as a,a as f,X as E,d as H,x as t,M as g,A as J}from"./BPizYgB5.js";import{c as L,r as W,u as Y}from"./Vtb-KpiN.js";import{u as w}from"./Dqk3rEyG.js";import{V as z,c as F}from"./C3JYGKVl.js";import{V as X}from"./BDeleqxk.js";import{V as G}from"./DGRZkbeD.js";import{V as K}from"./Dg4DipYH.js";import{V as Q}from"./pQhNd3Ul.js";import{V as Z}from"./D7s1cb1R.js";const ee=""+new URL("selo.D9mIBRmY.png",import.meta.url).href,ce={__name:"Selos",props:{show:Boolean,ato_token:String},emits:["close"],async setup($,{emit:y}){let c,_;const d=$,n=m(d.show),p=J(),S=m(N("user-data").value.cartorio_token).value,h=`${p.public.managemant}/listarSelos`,C=`${p.public.managemant}/reimprimirSelo`,R=`${p.public.managemant}/listarEscrevente`;`${p.public.envioDoc}`;const V=m([]),r=m([]),b=m([]),i=O({escrevente:null}),T=y,x={escrevente:{required:L.withMessage("O campo é obrigatorio",W)}},v=Y(x,i),B=[{title:"Numero",value:"numero"},{title:"Referencia",value:"referencia"},{value:"actions"}];P(()=>d.show,s=>{n.value=s,s&&A()});const k=()=>{n.value=!1,i.escrevente=null,r.value=null,T("close")},{data:I}=([c,_]=U(()=>w(R,{method:"POST",body:{cartorio_token:S}},"$V2ulT7DYvP")),c=await c,_(),c);b.value=I.value[0].func_json_escreventes;const D=async()=>{if(await v.value.$validate()){const s=r.value.map(u=>({selo_token:u})),e={escrevente_token:i.escrevente,ato_token:d.ato_token,selos:s},{data:o,error:oe,status:q}=await w(`${C}`,{method:"POST",body:e},"$45J51uHTfa");if(q.value==="success"){const u=window.open("","_blank");u.document.open(),u.document.write(o.value[0].etiqueta),u.document.close(),k()}}},A=async()=>{const{data:s,error:e}=await w(`${h}`,{method:"POST",body:{ato_token:d.ato_token}},"$rLWIRtrfDz");s.value.selos===null?V.value=[]:V.value=s.value.selos};return(s,e)=>(M(),j(Z,{persistent:"",modelValue:t(n),"onUpdate:modelValue":e[2]||(e[2]=o=>g(n)?n.value=o:null),"max-width":"500"},{default:l(()=>[a(z,null,{default:l(()=>[a(X,null,{default:l(()=>[a(G,{class:"mt-1 mb-3",style:{"justify-content":"space-between"}},{default:l(()=>[e[4]||(e[4]=f("h1",{class:"ml-4"},"Reimpressão de Selos",-1)),a(E,{class:"mt-4 mr-4",style:{color:"red"},onClick:k},{default:l(()=>e[3]||(e[3]=[H("mdi-close")])),_:1})]),_:1}),e[5]||(e[5]=f("hr",{class:"mb-5"},null,-1)),a(K,{class:"mb-5",label:"Tabelião/escrivão",modelValue:t(i).escrevente,"onUpdate:modelValue":e[0]||(e[0]=o=>t(i).escrevente=o),items:t(b),"item-title":"nome","item-value":"token",required:"","error-messages":t(v).escrevente.$errors.map(o=>o.$message),onBlur:t(v).escrevente.$touch,onInput:t(v).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"]),a(Q,{headers:B,items:t(V),"item-value":"token","show-select":"",modelValue:t(r),"onUpdate:modelValue":e[1]||(e[1]=o=>g(r)?r.value=o:null)},null,8,["items","modelValue"])]),_:1}),a(F,null,{default:l(()=>[f("div",null,[f("img",{src:ee,style:{cursor:"pointer"},onClick:D})])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{ce as _,ee as a};
