import{_ as ae,a as oe,u as te}from"./BLRDClbm.js";import{_ as se,C as le,u as ne,r as u,z as re,j as g,w as s,l as ie,o as V,b as o,a as R,V as O,i as l,A as w,v as m,P as ue,d,L as x,k as _,t as M,e as A}from"./B5Cx9rgB.js";import{f as I}from"./m4eWvj9w.js";import{u as L}from"./BWNZFg0z.js";import{V as de}from"./CayDjz4d.js";import{V as ce}from"./D708q0sp.js";import{V as j}from"./C-KeilOI.js";import{V as z}from"./DBPE1kaV.js";import{V as E,a as me,b as pe,c as fe}from"./Ck7MbFX4.js";import{V as ve}from"./CoNcj0UZ.js";import"./_e-yvbHY.js";import"./BtSPXjaV.js";const ge={__name:"index",setup(Ve){const D=le(),{$toast:y}=ne(),p=u({senha:"",email:""}),S=u(!1),c=u(!1),T=u(!1),N=u(!1),P=u(!1),k=u(!1),f=u(!1),C=u(""),h=()=>{T.value=!1,N.value=!1,k.value=!1,P.value=!1,c.value=!1},U=ie(),F=`${U.public.auth}/service/gerencia/listarMenu`,J=U.public.auth,B=U.public.managemant,v=u(!1),$=u(""),W=async()=>{const{data:t,status:e,error:n}=await I(`${J}/login`,{method:"POST",body:{senha:p.value.senha,email:p.value.email}});return{data:t==null?void 0:t.value,status:e==null?void 0:e.value,error:n==null?void 0:n.value}},q=t=>{const e=A("user-data");e.value=JSON.stringify({nome:t.nome,usuario_id:t.id,cartorio_id:t.cartorios[0].cartorio_id,cartorio_nome:t.cartorios[0].cartorio_descricao,cartorio_token:t.cartorios[0].cartorio_token});const n=A("auth_token");n.value=t.token},H=t=>{var a,r,i;const e=(i=(r=(a=t==null?void 0:t.data)==null?void 0:a[0])==null?void 0:r.func_autentica_acesso_v1)==null?void 0:i[0],n=e==null?void 0:e.status_mensagem;if(!e){k.value=!0;return}switch(n){case"Esse email não está cadastrado no Durabil.":N.value=!0;break;case"Senha inválida.":T.value=!0;break;case"Seu cadastro está desativado. Entre em contato com o administrador da conta.":P.value=!0;break;default:k.value=!0;break}},X=async()=>{var a,r,i,K;const{data:t,status:e,error:n}=await W();if(e==="success"){const b=(K=(i=(r=(a=t==null?void 0:t[0])==null?void 0:a.func_autentica_acesso_v1)==null?void 0:r[0])==null?void 0:i.registro)==null?void 0:K[0];if(te().cartorioInfos=b,q(b),b.cartorios.length>1){D.push({path:"/login/tipo-perfil"});return}y.success("Login realizado com sucesso!");const{data:Q,status:Y}=await I(F,{method:"POST",body:{usuario_id:b.id,perfil_descricao:b.cartorios[0].perfil_descricao}});if(Y.value==="success"){const ee=A("menu-navbar");ee.value=Q.value,D.push({path:"/"})}}else e==="error"&&(n==null?void 0:n.statusCode)===500?k.value=!0:H(n)},Z=async()=>{var a,r,i;const{data:t,status:e,error:n}=await L(`${B}/recupera_senha`,{method:"POST",body:{email:C.value,acao:"gerar"}},"$iX10IJN3fa");e.value==="success"?(y.success(t.value.message||"Código enviado"),v.value=!0):y.error(((i=(r=(a=n.value)==null?void 0:a.data)==null?void 0:r.menssage)==null?void 0:i.details)||"Erro desconhecido")},G=async()=>{var a,r,i;const{data:t,status:e,error:n}=await L(`${B}/verifica_codigo_recuperacao`,{method:"POST",body:{email:C.value,code:$.value}},"$ZtHWy4R1Ea");e.value==="success"?(y.success(t.value.message||"Código verificado com sucesso"),f.value=!1):y.error(((i=(r=(a=n.value)==null?void 0:a.data)==null?void 0:r.menssage)==null?void 0:i.details)||"Código inválido")};return(t,e)=>{const n=re("center");return V(),g(de,{style:{"background-color":"#0a063b"}},{default:s(()=>[o(ve,{cols:"5",class:"d-flex align-center justify-center"},{default:s(()=>[o(ce,{style:{"max-width":"650px"}},{default:s(()=>[o(n,null,{default:s(()=>[o(j,{style:{"margin-bottom":"30px"},width:400,height:330,src:ae})]),_:1}),e[16]||(e[16]=R("div",{class:"text"},"Login",-1)),o(O,{autofocus:"",autocomplete:"email",type:"email",modelValue:l(p).email,"onUpdate:modelValue":e[0]||(e[0]=a=>l(p).email=a),"persistent-hint":"",class:"input mb-5",style:{"background-color":"aliceblue"},"hide-details":"",density:"compact",placeholder:"Email","prepend-inner-icon":"mdi-email-outline",variant:"outlined"},null,8,["modelValue"]),o(O,{modelValue:l(p).senha,"onUpdate:modelValue":e[1]||(e[1]=a=>l(p).senha=a),class:"input","append-inner-icon":l(S)?"mdi-eye-off":"mdi-eye",type:l(S)?"text":"password",density:"compact",style:{"background-color":"aliceblue"},"hide-details":"",placeholder:"Senha","prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":e[2]||(e[2]=a=>S.value=!l(S))},null,8,["modelValue","append-inner-icon","type"]),o(z,{modelValue:l(c),"onUpdate:modelValue":e[4]||(e[4]=a=>w(c)?c.value=a:null),"max-width":"400",persistent:""},{activator:s(({props:a})=>[o(m,ue({rounded:"",class:"mb-10 mt-4 ml-1"},a,{color:"primary",onClick:X,modelValue:l(c),"onUpdate:modelValue":e[3]||(e[3]=r=>w(c)?c.value=r:null),block:""}),{default:s(()=>e[11]||(e[11]=[d(" Acessar ")])),_:2},1040,["modelValue"])]),default:s(()=>[l(T)?(V(),g(E,{key:0,text:"Senha inválida."},{actions:s(()=>[o(x),o(m,{onClick:h,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[12]||(e[12]=[d(" OK ")])),_:1})]),_:1})):_("",!0),l(N)?(V(),g(E,{key:1,text:"Esse email não está cadastrado."},{actions:s(()=>[o(x),o(m,{onClick:h,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[13]||(e[13]=[d(" OK ")])),_:1})]),_:1})):_("",!0),l(k)?(V(),g(E,{key:2,text:"Erro no sistema, fora do ar."},{actions:s(()=>[o(x),o(m,{onClick:h,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[14]||(e[14]=[d(" OK ")])),_:1})]),_:1})):_("",!0),l(P)?(V(),g(E,{key:3,text:"Seu cadastro está desativado. Entre em contato com o administrador da conta."},{actions:s(()=>[o(x),o(m,{onClick:h,style:{"background-color":"#429946",color:"white"}},{default:s(()=>e[15]||(e[15]=[d(" OK ")])),_:1})]),_:1})):_("",!0)]),_:1},8,["modelValue"]),R("div",null,[R("a",{class:"text-decoration-none",rel:"noopener noreferrer",style:{color:"white","margin-left":"10px"},onClick:e[5]||(e[5]=a=>f.value=!0)}," Esqueceu a senha? ")])]),_:1})]),_:1}),o(j,{src:oe,cover:""}),o(z,{modelValue:l(f),"onUpdate:modelValue":e[10]||(e[10]=a=>w(f)?f.value=a:null),"max-width":"500"},{default:s(()=>[o(E,null,{default:s(()=>[o(me,null,{default:s(()=>e[17]||(e[17]=[d("Recuperar senha")])),_:1}),o(pe,null,{default:s(()=>[e[18]||(e[18]=d(" ' ")),o(O,{modelValue:l(C),"onUpdate:modelValue":e[6]||(e[6]=a=>w(C)?C.value=a:null),readonly:l(v),type:"email",label:"Digite seu email","prepend-inner-icon":"mdi-email-outline"},null,8,["modelValue","readonly"]),l(v)?(V(),g(O,{key:0,modelValue:l($),"onUpdate:modelValue":e[7]||(e[7]=a=>w($)?$.value=a:null),label:"Código de verificação","prepend-inner-icon":"mdi-numeric"},null,8,["modelValue"])):_("",!0)]),_:1}),e[20]||(e[20]=d("' ")),o(fe,null,{default:s(()=>[o(x),d(" "+M(l(v))+" ",1),o(m,{color:"primary",onClick:e[8]||(e[8]=a=>l(v)?G():Z())},{default:s(()=>[d(M(l(v)?"Confirmar":"Enviar"),1)]),_:1}),o(m,{color:"secondary",onClick:e[9]||(e[9]=a=>f.value=!1)},{default:s(()=>e[19]||(e[19]=[d("Cancelar")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Te=se(ge,[["__scopeId","data-v-c22e1a09"]]);export{Te as default};
