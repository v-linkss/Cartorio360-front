import{_ as te,a as se}from"./MBQle6zP.js";import{_ as ae}from"./Ca_Xhbd5.js";import{_ as ne}from"./j5WDG2nq.js";import{u as re,E as le,r as l,D as k,F as ie,G as ue,o as ce,c as me,b as t,w as r,q as s,O as de,a as i,x as pe,s as x,J as O}from"./BUVVZfhT.js";import{u as g}from"./DRXdnPS6.js";import{_ as T}from"./DCsXQasW.js";import{_ as _e,a as ve}from"./CrE-eFFQ.js";import{_ as fe}from"./ToPptOUL.js";import{c as he,r as ke,u as ge,V as ye,_ as $e}from"./PV7ygOIe.js";import{V as y}from"./EISkJB2m.js";import{V as u}from"./Cj63iFGI.js";import"./XW0z3Brk.js";import"./CG-Cg3Kq.js";import"./BYw93oFs.js";const Ve=i("h1",null,"Reconhecimento por Semelhança",-1),be=["onClick"],we=i("img",{style:{width:"30px",height:"30px"},src:T,alt:"Visualizar"},null,-1),qe=[we],xe=["onClick"],Ce=i("img",{style:{width:"30px",height:"30px",cursor:"pointer"},src:ve,alt:"Remover"},null,-1),Pe=[Ce],Me=i("img",{class:"btn-pointer mt-10 mb-5",src:fe,alt:"Sair",style:{cursor:"pointer"}},null,-1),Le={__name:"semelhanca",props:{ato_token:{type:String,required:!0}},async setup(I){let p,C;const B=I,P=re(),M=le(),_=pe(),j=`${_.public.managemant}/listarEscrevente`,z=`${_.public.managemant}/pesquisarPessoas`,D=`${_.public.managemant}/atoReconhecimento`,A=`${_.public.managemant}/etiquetaReconhecimento`,v=l(k("user-data").value.cartorio_token),U=l(k("user-service").value.token).value||l(k("user-service").value).value,K=k("auth_token").value,$=l([]),S=l([]),F=l([]),c=l([]),V=l(!1),b=l(!1),w=l(!1),q=l(null),R=l(""),E=[{title:"Documento",align:"start",key:"documento"},{title:"Pessoa",align:"start",key:"nome"},{value:"actions"}],n=ie({quantidade:1,escrevente:null,nome:null,documento:null}),L={escrevente:{required:he.withMessage("O campo é obrigatorio",ke)}},f=ge(L,n),{data:N}=([p,C]=ue(()=>g(j,{method:"POST",body:{cartorio_token:v}},"$iEFsIjdWdW")),p=await p,C(),p);F.value=N.value[0].func_json_escreventes;async function W(){try{const{data:o,error:e}=await g(z,{method:"POST",body:{cartorio_token:v.value,documento:n.documento,nome:n.nome}},"$uzKb8LPV3v");o.value.length>0?$.value=o.value:$.value=[]}catch(o){console.error("Erro na requisição",o)}}const G=()=>{b.value=!0};function Q(o){c.value.push(o)}const J=o=>{q.value=o,w.value=!0};function H(o){c.value=c.value.filter(e=>e.pessoa_token!==o.pessoa_token),S.value=S.value.filter(e=>e!==`${o.nome}-${o.documento}-${o.pessoa_token}`)}async function X(){if(await f.value.$validate()){const o=c.value.map(e=>({pessoa_token:e.pessoa_token}));try{const{data:e,error:h,status:m}=await g(D,{method:"POST",body:{pessoas:o,cartorio_token:v.value,ordemserv_token:U,quantidade:n.quantidade,usuario_token:K,ato_tipo_token:B.ato_token}},"$MulQmK1LAp");m.value==="success"&&e.value[0].status==="OK"?Y(e.value[0].token):(V.value=!0,R.value=ato_token.value.status_mensagem||h.value.data.details)}catch(e){console.error("Erro na requisição",e)}}}async function Y(o){try{const{data:e,error:h,status:m}=await g(A,{method:"POST",body:{ato_token:o,cartorio_token:v.value,escrevente_token:n.escrevente}},"$fMGlIlw995");if(m.value==="success"){const d=window.open("","_blank");d.document.open(),d.document.write(e.value[0].etiqueta),d.document.close()}}catch(e){console.error("Erro na requisição",e)}}const Z=()=>{const o=M.query.origem||"criar",e=M.query.id;o==="atualizar"?P.push(`/ordens-servicos/atualizar/${e}`):P.push("/ordens-servicos/criar-registro")};return(o,e)=>{const h=te,m=se,d=ae,ee=ne;return ce(),me(de,null,[Ve,t(y,{class:"mt-5"},{default:r(()=>[t(u,{cols:"5"},{default:r(()=>[t(ye,{label:"Tabelião/escrevente",modelValue:s(n).escrevente,"onUpdate:modelValue":e[0]||(e[0]=a=>s(n).escrevente=a),items:s(F),"item-title":"nome","item-value":"token",required:"","error-messages":s(f).escrevente.$errors.map(a=>a.$message),onBlur:s(f).escrevente.$touch,onInput:s(f).escrevente.$touch},null,8,["modelValue","items","error-messages","onBlur","onInput"])]),_:1}),t(u,{cols:"2"},{default:r(()=>[t(x,{label:"Quantidade",type:"number",modelValue:s(n).quantidade,"onUpdate:modelValue":e[1]||(e[1]=a=>s(n).quantidade=a)},null,8,["modelValue"])]),_:1})]),_:1}),t(y,null,{default:r(()=>[t(u,{cols:"3"},{default:r(()=>[t(x,{label:"Documento",modelValue:s(n).documento,"onUpdate:modelValue":e[2]||(e[2]=a=>s(n).documento=a)},null,8,["modelValue"])]),_:1}),t(u,{cols:"4"},{default:r(()=>[t(x,{label:"Pessoa",modelValue:s(n).nome,"onUpdate:modelValue":e[3]||(e[3]=a=>s(n).nome=a)},null,8,["modelValue"])]),_:1}),i("div",null,[i("img",{class:"btn-pointer mt-3",src:T,style:{width:"40px",cursor:"pointer"},title:"Pesquisar Pessoa",onClick:W})]),i("div",null,[i("img",{class:"btn-pointer mt-3 ml-2",src:_e,style:{width:"40px",cursor:"pointer"},title:"Criar Pessoa",onClick:G})])]),_:1}),t(y,null,{default:r(()=>[t(u,{class:"mr-10"},{default:r(()=>[t(O,{style:{height:"465px"},headers:E,items:s($)},{"item.actions":r(({item:a})=>[i("div",{style:{display:"flex",cursor:"pointer","justify-content":"flex-end"},onClick:oe=>J(a),title:"Visualizar Ficha"},qe,8,be)]),_:1},8,["items"])]),_:1}),t(u,null,{default:r(()=>[t(O,{headers:E,items:s(c),style:{height:"465px"},"item-key":"id"},{"item.actions":r(({item:a})=>[i("div",{style:{display:"flex","justify-content":"flex-end"},onClick:oe=>H(a),title:"Remover"},Pe,8,xe)]),_:1},8,["items"])]),_:1})]),_:1}),t(h,{show:s(b),onClose:e[4]||(e[4]=a=>b.value=!1)},null,8,["show"]),t(m,{show:s(w),item:s(q),onConfirmar:e[5]||(e[5]=a=>Q(s(q))),onClose:e[6]||(e[6]=a=>w.value=!1)},null,8,["show","item"]),t(y,null,{default:r(()=>[t(d,{onClick:Z},{default:r(()=>[Me]),_:1}),i("div",null,[i("img",{class:"mt-10 mb-5 ml-10",onClick:X,style:{cursor:"pointer"},src:$e})])]),_:1}),t(ee,{show:s(V),errorMessage:s(R),onClose:e[7]||(e[7]=a=>V.value=!1)},null,8,["show","errorMessage"])],64)}}};export{Le as default};
