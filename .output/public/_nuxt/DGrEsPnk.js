import{S as e,bc as l,bd as a,ax as t,be as u,bf as n,X as o,$ as s,r as i,a1 as v,at as r,M as c,bg as p,am as d,bh as m,bi as f,bj as h,h as y,ad as b,aR as g,a3 as k,s as x,b as w,N as V,bk as S,z as C,bl as _,bm as A,bn as D,bo as I,aX as P,P as F,bp as M,bq as R,aT as T,d as E,br as O,az as K,bs as U,bt as z}from"./Cqiv77yc.js";const B=e({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...l({filterKeys:["title"]}),...a(),...t(u({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...n({transition:!1})},"VAutocomplete"),L=o()({name:"VAutocomplete",props:B(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,l){let{slots:a}=l;const{t:t}=s(),u=i(),n=v(!1),o=v(!0),B=v(!1),L=i(),N=i(),j=r(e,"menu"),q=c({get:()=>j.value,set:e=>{var l;j.value&&!e&&(null==(l=L.value)?void 0:l.Î¨openChildren)||(j.value=e)}}),X=v(-1),H=c((()=>{var e;return null==(e=u.value)?void 0:e.color})),$=c((()=>q.value?e.closeText:e.openText)),{items:G,transformIn:J,transformOut:Q}=p(e),{textColorClasses:W,textColorStyles:Y}=d(H),Z=r(e,"search",""),ee=r(e,"modelValue",[],(e=>J(null===e?[null]:U(e))),(l=>{const a=Q(l);return e.multiple?a:a[0]??null})),le=c((()=>"function"==typeof e.counterValue?e.counterValue(ee.value):"number"==typeof e.counterValue?e.counterValue:ee.value.length)),ae=m(),{filteredItems:te,getMatches:ue}=f(e,G,(()=>o.value?"":Z.value)),ne=c((()=>e.hideSelected?te.value.filter((e=>!ee.value.some((l=>l.value===e.value)))):te.value)),oe=c((()=>!(!e.chips&&!a.chip))),se=c((()=>oe.value||!!a.selection)),ie=c((()=>ee.value.map((e=>e.props.value)))),ve=c((()=>{var l;return(!0===e.autoSelectFirst||"exact"===e.autoSelectFirst&&Z.value===(null==(l=ne.value[0])?void 0:l.title))&&ne.value.length>0&&!o.value&&!B.value})),re=c((()=>e.hideNoData&&!ne.value.length||e.readonly||(null==ae?void 0:ae.isReadonly.value))),ce=i(),{onListScroll:pe,onListKeydown:de}=h(ce,u);function me(l){e.openOnClear&&(q.value=!0),Z.value=""}function fe(){re.value||(q.value=!0)}function he(e){re.value||(n.value&&(e.preventDefault(),e.stopPropagation()),q.value=!q.value)}function ye(l){var a,t,n;if(e.readonly||(null==ae?void 0:ae.isReadonly.value))return;const o=u.value.selectionStart,s=ee.value.length;if((X.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(q.value=!0),["Escape"].includes(l.key)&&(q.value=!1),ve.value&&["Enter","Tab"].includes(l.key)&&!ee.value.some((e=>{let{value:l}=e;return l===ne.value[0].value}))&&Se(ne.value[0]),"ArrowDown"===l.key&&ve.value&&(null==(a=ce.value)||a.focus("next")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&se.value&&ee.value.length>0&&!Z.value)return Se(ee.value[0],!1);if(~X.value){const e=X.value;Se(ee.value[X.value],!1),X.value=e>=s-1?s-2:e}else"Backspace"!==l.key||Z.value||(X.value=s-1)}if(e.multiple){if("ArrowLeft"===l.key){if(X.value<0&&o>0)return;const e=X.value>-1?X.value-1:s-1;ee.value[e]?X.value=e:(X.value=-1,u.value.setSelectionRange(null==(t=Z.value)?void 0:t.length,null==(n=Z.value)?void 0:n.length))}if("ArrowRight"===l.key){if(X.value<0)return;const e=X.value+1;ee.value[e]?X.value=e:(X.value=-1,u.value.setSelectionRange(0,0))}}}function be(e){if(z(u.value,":autofill")||z(u.value,":-webkit-autofill")){const l=G.value.find((l=>l.title===e.target.value));l&&Se(l)}}function ge(){var e;n.value&&(o.value=!0,null==(e=u.value)||e.focus())}function ke(e){n.value=!0,setTimeout((()=>{B.value=!0}))}function xe(e){B.value=!1}function we(l){null!=l&&(""!==l||e.multiple||se.value)||(ee.value=[])}const Ve=v(!1);function Se(l){let a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(l&&!l.props.disabled)if(e.multiple){const t=ee.value.findIndex((a=>e.valueComparator(a.value,l.value))),u=null==a?!~t:a;if(~t){const e=u?[...ee.value,l]:[...ee.value];e.splice(t,1),ee.value=e}else u&&(ee.value=[...ee.value,l]);e.clearOnSelect&&(Z.value="")}else{const e=!1!==a;ee.value=e?[l]:[],Z.value=e&&!se.value?l.title:"",b((()=>{q.value=!1,o.value=!0}))}}return y(n,((l,a)=>{var t;l!==a&&(l?(Ve.value=!0,Z.value=e.multiple||se.value?"":String((null==(t=ee.value.at(-1))?void 0:t.props.title)??""),o.value=!0,b((()=>Ve.value=!1))):(e.multiple||null!=Z.value||(ee.value=[]),q.value=!1,ee.value.some((e=>{let{title:l}=e;return l===Z.value}))||(Z.value=""),X.value=-1))})),y(Z,(e=>{n.value&&!Ve.value&&(e&&(q.value=!0),o.value=!e)})),y(q,(()=>{if(!e.hideSelected&&q.value&&ee.value.length){const e=ne.value.findIndex((e=>ee.value.some((l=>e.value===l.value))));g&&window.requestAnimationFrame((()=>{var l;e>=0&&(null==(l=N.value)||l.scrollToIndex(e))}))}})),y((()=>e.items),((e,l)=>{q.value||n.value&&!l.length&&e.length&&(q.value=!0)})),k((()=>{const l=!!(!e.hideNoData||ne.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),s=ee.value.length>0,i=x.filterProps(e);return w(x,C({ref:u},i,{modelValue:Z.value,"onUpdate:modelValue":[e=>Z.value=e,we],focused:n.value,"onUpdate:focused":e=>n.value=e,validationValue:ee.externalValue,counterValue:le.value,dirty:s,onChange:be,class:["v-autocomplete","v-autocomplete--"+(e.multiple?"multiple":"single"),{"v-autocomplete--active-menu":q.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!se.value,"v-autocomplete--selecting-index":X.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:s?void 0:e.placeholder,"onClick:clear":me,"onMousedown:control":fe,onKeydown:ye}),{...a,default:()=>w(V,null,[w(S,C({ref:L,modelValue:q.value,"onUpdate:modelValue":e=>q.value=e,activator:"parent",contentClass:"v-autocomplete__content",disabled:re.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ge},e.menuProps),{default:()=>[l&&w(_,C({ref:ce,selected:ie.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:e=>e.preventDefault(),onKeydown:de,onFocusin:ke,onFocusout:xe,onScrollPassive:pe,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var l,u,n;return[null==(l=a["prepend-item"])?void 0:l.call(a),!ne.value.length&&!e.hideNoData&&((null==(u=a["no-data"])?void 0:u.call(a))??w(A,{title:t(e.noDataText)},null)),w(D,{ref:N,renderless:!0,items:ne.value},{default:l=>{var t;let{item:u,index:n,itemRef:s}=l;const i=C(u.props,{ref:s,key:n,active:!(!ve.value||0!==n)||void 0,onClick:()=>Se(u,null)});return(null==(t=a.item)?void 0:t.call(a,{item:u,index:n,props:i}))??w(A,C(i,{role:"option"}),{prepend:l=>{let{isSelected:a}=l;return w(V,null,[e.multiple&&!e.hideSelected?w(I,{key:u.value,modelValue:a,ripple:!1,tabindex:"-1"},null):void 0,u.props.prependAvatar&&w(P,{image:u.props.prependAvatar},null),u.props.prependIcon&&w(F,{icon:u.props.prependIcon},null)])},title:()=>{var e,l;return o.value?u.title:function(e,l,a){if(null==l)return e;if(Array.isArray(l))throw new Error("Multiple matches is not implemented");return"number"==typeof l&&~l?w(V,null,[w("span",{class:"v-autocomplete__unmask"},[e.substr(0,l)]),w("span",{class:"v-autocomplete__mask"},[e.substr(l,a)]),w("span",{class:"v-autocomplete__unmask"},[e.substr(l+a)])]):e}(u.title,null==(e=ue(u))?void 0:e.title,(null==(l=Z.value)?void 0:l.length)??0)}})}}),null==(n=a["append-item"])?void 0:n.call(a)]}})]}),ee.value.map(((l,t)=>{function u(e){e.stopPropagation(),e.preventDefault(),Se(l,!1)}const n={"onClick:close":u,onKeydown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),u(e))},onMousedown(e){e.preventDefault(),e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},o=oe.value?!!a.chip:!!a.selection,s=o?M(oe.value?a.chip({item:l,index:t,props:n}):a.selection({item:l,index:t})):void 0;if(!o||s)return w("div",{key:l.value,class:["v-autocomplete__selection",t===X.value&&["v-autocomplete__selection--selected",W.value]],style:t===X.value?Y.value:{}},[oe.value?a.chip?w(T,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:l.title}}},{default:()=>[s]}):w(R,C({key:"chip",closable:e.closableChips,size:"small",text:l.title,disabled:l.props.disabled},n),null):s??w("span",{class:"v-autocomplete__selection-text"},[l.title,e.multiple&&t<ee.value.length-1&&w("span",{class:"v-autocomplete__selection-comma"},[E(",")])])])}))]),"append-inner":function(){for(var l,u=arguments.length,n=new Array(u),o=0;o<u;o++)n[o]=arguments[o];return w(V,null,[null==(l=a["append-inner"])?void 0:l.call(a,...n),e.menuIcon?w(F,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:he,onClick:O,"aria-label":t($.value),title:t($.value),tabindex:"-1"},null):void 0])}})})),K({isFocused:n,isPristine:o,menu:q,search:Z,filteredItems:te,select:Se},u)}});export{L as V};
